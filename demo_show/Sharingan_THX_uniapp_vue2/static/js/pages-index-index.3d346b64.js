(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"0508":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticStyle:{"font-size":"13px"}},[a("v-uni-view",{staticClass:"tab_option"},[a("v-uni-view",{staticClass:"tab_bar"},[a("v-uni-view",{staticClass:"tab_item",class:{active:"五档"===t.TimeTab},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ChangeTab("五档")}}},[t._v("五档")]),a("v-uni-view",{staticClass:"tab_item",class:{active:"明细"===t.TimeTab},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ChangeTab("明细")}}},[t._v("明细")]),a("v-uni-view",{staticClass:"tab_item",class:{active:"交易"===t.TimeTab},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ChangeTab("交易")}}},[t._v("交易")])],1)],1),"五档"===t.TimeTab?a("v-uni-view",{staticClass:"BuySell"},[a("v-uni-view",{staticClass:"SellContent"},[a("v-uni-view",{staticClass:"BuySellItem",staticStyle:{"background-color":"#f2fbf6"}},[a("v-uni-text",{staticStyle:{color:"#36af37"}},[t._v("大单")]),a("v-uni-text",{style:[{color:t.BuySellData.Max[1].Price.Color}]},[t._v(t._s(t.BuySellData.Max[1].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Max[1].Vol.Color}]},[t._v(t._s(t.BuySellData.Max[1].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("卖5")]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[4].Price.Color}]},[t._v(t._s(t.BuySellData.Sell[4].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[4].Vol.Color}]},[t._v(t._s(t.BuySellData.Sell[4].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("卖4")]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[3].Price.Color}]},[t._v(t._s(t.BuySellData.Sell[3].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[3].Vol.Color}]},[t._v(t._s(t.BuySellData.Sell[3].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("卖3")]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[2].Price.Color}]},[t._v(t._s(t.BuySellData.Sell[2].Price.Text))]),a("v-uni-text",{staticStyle:{"background-color":"rgb(204, 234, 204)"},style:[{color:t.BuySellData.Sell[2].Vol.Color}]},[t._v(t._s(t.BuySellData.Sell[2].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("卖2")]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[1].Price.Color}]},[t._v(t._s(t.BuySellData.Sell[1].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[1].Vol.Color}]},[t._v(t._s(t.BuySellData.Sell[1].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("卖1")]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[0].Price.Color}]},[t._v(t._s(t.BuySellData.Sell[0].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Sell[0].Vol.Color}]},[t._v(t._s(t.BuySellData.Sell[0].Vol.Text))])],1)],1),a("v-uni-view",{staticStyle:{"border-top":"1px solid #ccc",margin:"1px 0"}}),a("v-uni-view",{staticClass:"BuyContent"},[a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("买1")]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[0].Price.Color}]},[t._v(t._s(t.BuySellData.Buy[0].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[0].Vol.Color}]},[t._v(t._s(t.BuySellData.Buy[0].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("买2")]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[1].Price.Color}]},[t._v(t._s(t.BuySellData.Buy[1].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[1].Vol.Color}]},[t._v(t._s(t.BuySellData.Buy[1].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("买1")]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[2].Price.Color}]},[t._v(t._s(t.BuySellData.Buy[2].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[2].Vol.Color}]},[t._v(t._s(t.BuySellData.Buy[2].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("买1")]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[3].Price.Color}]},[t._v(t._s(t.BuySellData.Buy[3].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[3].Vol.Color}]},[t._v(t._s(t.BuySellData.Buy[3].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem"},[a("v-uni-text",[t._v("买1")]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[4].Price.Color}]},[t._v(t._s(t.BuySellData.Buy[4].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Buy[4].Vol.Color}]},[t._v(t._s(t.BuySellData.Buy[4].Vol.Text))])],1),a("v-uni-view",{staticClass:"BuySellItem",staticStyle:{"background-color":"#fff5f5"}},[a("v-uni-text",{staticStyle:{color:"#ec4e4e"}},[t._v("大单")]),a("v-uni-text",{style:[{color:t.BuySellData.Max[0].Price.Color}]},[t._v(t._s(t.BuySellData.Max[0].Price.Text))]),a("v-uni-text",{style:[{color:t.BuySellData.Max[0].Vol.Color}]},[t._v(t._s(t.BuySellData.Max[0].Vol.Text))])],1)],1)],1):t._e(),"明细"===t.TimeTab?a("v-uni-view",{staticClass:"Details"},[a("v-uni-view",[t._v("明细内容")])],1):t._e(),"交易"===t.TimeTab?a("v-uni-view",{staticClass:"Trade"},[a("v-uni-view",[t._v("交易内容")])],1):t._e()],1)},r=[]},"069c":function(t,e,a){"use strict";var i=a("c540"),r=a.n(i);r.a},"0bcc":function(t,e,a){"use strict";var i=a("4dc5"),r=a.n(i);r.a},1289:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".tab_bar[data-v-97834648]{flex:1;display:flex;justify-content:space-around}.tab_item[data-v-97834648]{padding:5px 0;cursor:pointer}.active[data-v-97834648]{color:#007aff;border-bottom:2px solid #007aff}.BuySellItem[data-v-97834648]{:nth-child(1){display:inline-block;width:26px}:nth-child(2){display:inline-block;width:36%;text-align:left;margin-left:10px}:nth-child(3){display:inline-block;width:30%;text-align:right}}",""]),t.exports=e},"14bc":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={name:"HQPeriodTabView",data:function(){return{AryTab:[{Name:"分时",ID:201,Command:{ChartName:"Minute",DayCount:1}},{Name:"日K",ID:100,Command:{ChartName:"KLine",Period:0}},{Name:"周K",ID:101,Command:{ChartName:"KLine",Period:1}},{Name:"月",ID:102,Command:{ChartName:"KLine",Period:2}},{Name:"五日",ID:205,Command:{ChartName:"Minute",DayCount:5}},{Name:"更多",ID:999}],SelectedTabID:201,ClickTabCallback:null,ClickSettingCallback:null}},mounted:function(){},methods:{ChangeTab:function(t){if(t&&this.ClickTabCallback){var e={TabItem:t,SelectedTabID:this.SelectedTabID};this.ClickTabCallback(e),this.SelectedTabID=e.SelectedTabID}},ClickSetting:function(){this.ClickSettingCallback&&this.ClickSettingCallback()},MoveSelectedTab:function(t){for(var e=null,a=0;a<this.AryTab.length;++a){var i=this.AryTab[a];if(i.ID==this.SelectedTabID){if(t>0){var r=a+1;r>=0&&r<this.AryTab.length&&(e=this.AryTab[r])}else if(t<0){r=a-1;r>=0&&r<this.AryTab.length&&(e=this.AryTab[r])}break}}e&&this.ChangeTab(e)}}}},"15ab":function(t,e,a){"use strict";var i=a("7658"),r=a("57e7");i("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},"16b9":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".button-container[data-v-358783c7]{display:flex;align-items:center}.toggle-button[data-v-358783c7]{margin-left:10px}.other-buttons[data-v-358783c7]{display:flex;overflow:hidden}",""]),t.exports=e},1851:function(t,e,a){"use strict";var i=a("8bdb"),r=a("84d6"),n=a("1cb5");i({target:"Array",proto:!0},{fill:r}),n("fill")},"1ea2":function(t,e,a){"use strict";var i=a("af9e"),r=a("1c06"),n=a("ada5"),o=a("5d6e"),s=Object.isExtensible,h=i((function(){s(1)}));t.exports=h||o?function(t){return!!r(t)&&((!o||"ArrayBuffer"!==n(t))&&(!s||s(t)))}:s},2030:function(t,e,a){"use strict";a.r(e);var i=a("dd6e"),r=a("4fdd");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"4041750d",null,!1,i["a"],void 0);e["default"]=s.exports},"20f3":function(t,e,a){"use strict";var i=a("8bdb"),r=a("5145");i({target:"Array",proto:!0,forced:r!==[].lastIndexOf},{lastIndexOf:r})},"219e":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"tab_option"},[i("v-uni-view",{staticClass:"tab_bar"},t._l(t.AryTab,(function(e){return i("v-uni-view",{key:e.ID,staticClass:"tab_item",class:{active:t.SelectedTabID===e.ID},on:{touchstart:function(a){arguments[0]=a=t.$handleEvent(a),t.ChangeTab(e)}}},[t._v(t._s(e.Name))])})),1),i("v-uni-view",[i("v-uni-image",{staticClass:"option_Icon",attrs:{src:a("df30"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ClickSetting.apply(void 0,arguments)}}})],1)],1)],1)},r=[]},"2aa0":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={data:function(){return{TimeTab:"五档",BuySellData:{Max:[{Price:{Text:"--",Color:"#000"},Vol:{Text:"--",Color:"#000"}},{Price:{Text:"--",Color:"#000"},Vol:{Text:"--",Color:"#000"}}],Buy:[{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}}],Sell:[{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}},{Price:{Text:"--",Color:"#f0f0f0"},Vol:{Text:"--",Color:"rgb(192,192,0)"}}]}}},mounted:function(){},methods:{ChangeTab:function(t){this.TimeTab=t}}}},"2e7f":function(t,e,a){"use strict";var i=Math.log,r=Math.LOG10E;t.exports=Math.log10||function(t){return i(t)*r}},"2ec5":function(t,e,a){"use strict";t.exports=function(t,e){return e||(e={}),t=t&&t.__esModule?t.default:t,"string"!==typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},"30f7":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},a("7a76"),a("c9b5")},3471:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=(0,i.default)(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,h=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){h=!0,o=t},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(h)throw o}}}},a("01a2"),a("e39c"),a("bf0f"),a("844d"),a("18f7"),a("de6c"),a("7a76"),a("c9b5");var i=function(t){return t&&t.__esModule?t:{default:t}}(a("5d6b"))},"36b3":function(t,e,a){"use strict";a.r(e);var i=a("14bc"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},"3f59":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"BaseDataInfo"},[i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"price",staticStyle:{"margin-right":"20px",flex:"1"},style:[{"margin-top":t.RangeData.IsShow?"-14px":0}]},[i("v-uni-view",{staticClass:"CurrentPrice",style:[{"font-size":t.FormatPriceFontSize()}]},[i("v-uni-text",{staticClass:"value",style:{color:t.StockData.Price.Color}},[t._v(t._s(t.StockData.Price.Text))])],1),i("v-uni-view",{staticClass:"ChangeInfo",style:[{"font-size":t.formatRisefallFontSzie()}]},[i("v-uni-text",{style:{color:t.StockData.Risefall.Color}},[t._v(t._s(t.StockData.Risefall.Text))]),i("v-uni-text",{staticStyle:{"padding-left":"8px"},style:{color:t.StockData.Increase.Color}},[t._v(t._s(t.StockData.Increase.Text))])],1),1==t.StockData.CorssCursorStatus||3==t.StockData.CorssCursorStatus?i("v-uni-view",{staticStyle:{"font-size":"12px","background-color":"rgb(245,245,242)",padding:"0 2px"}},[i("v-uni-text",[t._v(t._s(t.StockData.DateTime.Text))])],1):t._e()],1),t.RangeData.IsShow?i("v-uni-view",{staticStyle:{"margin-right":"10px",flex:"0.8"}},[i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.High.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.High.Color}},[t._v(t._s(t.StockData.High.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Low.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Low.Color}},[t._v(t._s(t.StockData.Low.Text))])],1)],1):t._e(),t.RangeData.IsShow?i("v-uni-view",{staticStyle:{"margin-right":"10px",flex:"1.1"}},[i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Open.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Open.Color}},[t._v(t._s(t.StockData.Open.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.ChangeRate.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.ChangeRate.Color}},[t._v(t._s(t.StockData.ChangeRate.Text))])],1)],1):t._e(),t.RangeData.IsShow?i("v-uni-view",{staticStyle:{flex:"1.1"}},[i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Vol.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Vol.Color}},[t._v(t._s(t.StockData.Vol.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Amount.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Amount.Color}},[t._v(t._s(t.StockData.Amount.Text))])],1)],1):t._e(),t.RangeData.IsShow?t._e():i("v-uni-view",{staticStyle:{"margin-right":"10px",flex:"0.8"}},[i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.High.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.High.Color}},[t._v(t._s(t.StockData.High.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Low.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Low.Color}},[t._v(t._s(t.StockData.Low.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Open.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Open.Color}},[t._v(t._s(t.StockData.Open.Text))])],1)],1),t.RangeData.IsShow?t._e():i("v-uni-view",{staticStyle:{"margin-right":"20px",flex:"1.1"}},[i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.MarketValue.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.MarketValue.Color}},[t._v(t._s(t.StockData.MarketValue.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.SharesValue.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.SharesValue.Color}},[t._v(t._s(t.StockData.SharesValue.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"Item_title",staticStyle:{position:"relative"}},[i("v-uni-text",[t._v(t._s(t.StockData.PE.Title))]),i("v-uni-image",{staticStyle:{width:"12px",height:"6px",position:"absolute",top:"6px"},attrs:{src:a("7ba5"),mode:""}})],1),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.PE.Color}},[t._v(t._s(t.StockData.PE.Text))])],1)],1),t.RangeData.IsShow?t._e():i("v-uni-view",{staticStyle:{flex:"1.1"}},[i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Vol.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Vol.Color}},[t._v(t._s(t.StockData.Vol.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.Amount.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.Amount.Color}},[t._v(t._s(t.StockData.Amount.Text))])],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-text",{staticClass:"Item_title"},[t._v(t._s(t.StockData.ChangeRate.Title))]),i("v-uni-text",{staticClass:"Item_Text",style:{color:t.StockData.ChangeRate.Color}},[t._v(t._s(t.StockData.ChangeRate.Text))])],1)],1)],1),t.RangeData.IsShow?i("v-uni-view",{staticClass:"TitleTip"},[i("v-uni-view",[i("v-uni-text",[t._v(t._s(t.RangeData.Start.Text))]),i("v-uni-text",{staticStyle:{"margin-left":"10px"}},[t._v("至今涨幅")]),i("v-uni-text",{staticStyle:{"margin-left":"4px",color:"green"}},[t._v(t._s(t.RangeData.Increase.Text))]),t.RangeData.IsShow?i("v-uni-text",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.RangeData.Count.Text))]):t._e()],1),t.RangeData.IsShow?t._e():i("v-uni-view",[i("v-uni-text",[t._v("区间统计")]),i("v-uni-text",{staticStyle:{"margin-left":"4px",color:"rgb(211, 211, 211)"}},[t._v("〉")])],1)],1):t._e()],1),t.News.IsShow?i("v-uni-view",{staticClass:"notice"},[i("v-uni-view",{staticClass:"notice_item"},[i("v-uni-image",{staticClass:"icon",attrs:{src:a("b6e0")}}),i("v-uni-text",[t._v(t._s(t.News.Title))])],1)],1):t._e(),i("v-uni-view",{staticStyle:{"background-color":"rgb(245,245,245)",height:"6px"}})],1)},r=[]},"410e":function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c223");var r=i(a("9be4")),n=r.default.IFrameSplitOperator,o={name:"StockInfoView",data:function(){return{News:{Title:"将于2025-04-29披露《2025年一季报》",IsShow:!0},StockData:{Price:{Title:"最新",Text:"--",Value:null,Color:"rgb(0,0,0)"},YPrice:{Title:"昨收",Text:"--",Value:null,Color:"rgb(0,0,0)"},High:{Title:"高",Text:"--",Value:null,Color:"rgb(0,0,0)"},Low:{Title:"低",Text:"--",Value:null,Color:"rgb(0,0,0)"},Open:{Title:"开",Text:"--",Value:null,Color:"rgb(0,0,0)"},Increase:{Title:"涨幅",Text:"--",Value:null,Color:"rgb(0,0,0)"},Risefall:{Title:"涨跌",Text:"--",Value:null,Color:"rgb(0,0,0)"},Vol:{Title:"量",Text:"--",Value:null,Color:"rgb(0,0,0)"},Amount:{Title:"额",Text:"--",Value:null,Color:"rgb(0,0,0)"},ChangeRate:{Title:"换",Text:"--",Value:null,Color:"rgb(0,0,0)"},PE:{Title:"市盈",Text:"--",Value:null,Color:"rgb(0,0,0)"},MarketValue:{Title:"市值",Text:"--",Value:null,Color:"rgb(0,0,0)"},SharesValue:{Title:"流通",Text:"--",Value:null,Color:"rgb(0,0,0)"},DateTime:{Title:"",Text:"----",Value:null,Color:"rgb(0,0,0)"},CorssCursorStatus:0},RangeData:{IsShow:!1,Start:{Date:null,Time:null,Text:"--",Color:"rgb(0,0,0)"},End:{Date:null,Time:null},Increase:{Title:"至今涨幅",Text:"--",Value:null,Color:"rgb(0,0,0)"},Count:{Title:"周期数",Text:"--",Color:"rgb(0,0,0)"}}}},mounted:function(){},methods:{UpdateNews:function(t){t&&(this.News.Title=t.Title)},UpdateStockData:function(t){t&&(this.StockData.Price.Value=t.Price,this.StockData.Price.Text="".concat(t.Price.toFixed(2)),this.StockData.Price.Color=this.GetPriceColor(t.Price,t.YClose),this.StockData.High.Value=t.High,this.StockData.High.Text="".concat(t.High.toFixed(2)),this.StockData.High.Color=this.GetPriceColor(t.High,t.YClose),this.StockData.Low.Value=t.Low,this.StockData.Low.Text="".concat(t.Low.toFixed(2)),this.StockData.Low.Color=this.GetPriceColor(t.Low,t.YClose),this.StockData.Open.Value=t.Open,this.StockData.Open.Text="".concat(t.Open.toFixed(2)),this.StockData.Open.Color=this.GetPriceColor(t.Open,t.YClose),this.StockData.Risefall.Value=t.Risefall,this.StockData.Risefall.Text="".concat(t.Risefall.toFixed(2)),this.StockData.Risefall.Color=this.GetPriceColor(t.Risefall,0),this.StockData.Increase.Value=t.Increase,this.StockData.Increase.Text="".concat(t.Risefall.toFixed(2),"%"),this.StockData.Increase.Color=this.GetPriceColor(t.Increase,0),t.ChangeRate&&(this.StockData.ChangeRate.Value=t.ChangeRate,this.StockData.ChangeRate.Text="".concat(t.Risefall.toFixed(2),"%")),t.PE&&(this.StockData.PE.Value=t.PE,this.StockData.PE.Text="".concat(t.PE.toFixed(2))),t.MarketValue&&(this.StockData.MarketValue.Value=t.MarketValue,this.StockData.MarketValue.Text=this.FormatValueString(t.MarketValue,0,1)),t.SharesValue&&(this.StockData.SharesValue.Value=t.SharesValue,this.StockData.SharesValue.Text=this.FormatValueString(t.SharesValue,0,1)),t.DateTime&&(this.StockData.DateTime.Value={Date:t.DateTime.Date,Time:t.DateTime.Time},this.StockData.DateTime.Text=this.FormatDateTimeString(t.DateTime,"MM-DD")),this.StockData.Amount.Value=t.Amount,this.StockData.Amount.Text=this.FormatValueString(t.Amount,0,1),this.StockData.Vol.Value=t.Vol,this.StockData.Vol.Text=this.FormatValueString(t.Vol,0,1))},UpdateRangeData:function(t){t&&(this.RangeData.Increase.Value=t.Increase,this.RangeData.Increase.Text="".concat(t.Increase.toFixed(2),"%"),this.RangeData.Increase.Color=this.GetPriceColor(t.Increase,0),r.default.IFrameSplitOperator.IsBool(t.IsShow)&&(this.RangeData.IsShow=t.IsShow),this.RangeData.Start.Date=t.Start.Date,this.RangeData.Start.Time=t.Start.Time,this.RangeData.Start.Text=this.FormatDateTimeString(this.RangeData.Start,"YYYY/MM/DD"),this.RangeData.Count.Value=t.Count,this.RangeData.Count.Text="周期共".concat(t.Count,"个"))},EnableShowRangeData:function(t){this.RangeData.IsShow=t},SetCorssCursorStatus:function(t){this.StockData.CorssCursorStatus=t},GetPriceColor:function(t,e){return t>e?"rgb(209, 67, 60)":t<e?"rgb(75, 140, 53)":"rgb(0,0,0)"},FormatValueString:function(t,e,a){if(null==t||isNaN(t))return"--";if(t<1e-11&&t>-1e-11)return"0";var i=Math.abs(t);return i<1e4?t.toFixed(e):i<1e6||i<1e8?(t/1e4).toFixed(a)+"万":i<1e12?(t/1e8).toFixed(a)+"亿":(t/1e12).toFixed(a)+"万亿"},FormatDateTimeString:function(t,e){var a=t.Date,i=t.Time;return n.IsNumber(i)&&n.IsNumber(a)?"".concat(n.FormatDateString(a,e)," ").concat(n.FormatTimeString(i,"HH:MM")):n.IsNumber(a)?"".concat(n.FormatDateString(a,e)):"--"},EnableShowNews:function(t){this.News.IsShow=t},FormatPriceFontSize:function(){return this.RangeData.IsShow?"30px":1==this.StockData.CorssCursorStatus||3==this.StockData.CorssCursorStatus?"26px":"34px"},formatRisefallFontSzie:function(){return this.RangeData.IsShow||1==this.StockData.CorssCursorStatus||3==this.StockData.CorssCursorStatus?"12px":"15px"}}};e.default=o},4733:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(Array.isArray(t))return(0,i.default)(t)};var i=function(t){return t&&t.__esModule?t:{default:t}}(a("8d0b"))},"4bf4":function(t,e,a){var i=a("8024");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("967d").default;r("428aceef",i,!0,{sourceMap:!1,shadowMode:!1})},"4dc5":function(t,e,a){var i=a("fa8b");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("967d").default;r("6a3782cb",i,!0,{sourceMap:!1,shadowMode:!1})},"4fdd":function(t,e,a){"use strict";a.r(e);var i=a("f163"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},5075:function(t,e,a){"use strict";var i=a("ae5c"),r=a("71e9"),n=a("e7e3"),o=a("52df"),s=a("81a7"),h=a("1fc1"),l=a("1297"),u=a("d67c"),C=a("5112"),D=a("7e91"),f=TypeError,c=function(t,e){this.stopped=t,this.result=e},m=c.prototype;t.exports=function(t,e,a){var d,I,S,T,v,p,g,x=a&&a.that,F=!(!a||!a.AS_ENTRIES),E=!(!a||!a.IS_RECORD),L=!(!a||!a.IS_ITERATOR),M=!(!a||!a.INTERRUPTED),y=i(e,x),R=function(t){return d&&D(d,"normal",t),new c(!0,t)},N=function(t){return F?(n(t),M?y(t[0],t[1],R):y(t[0],t[1])):M?y(t,R):y(t)};if(E)d=t.iterator;else if(L)d=t;else{if(I=C(t),!I)throw new f(o(t)+" is not iterable");if(s(I)){for(S=0,T=h(t);T>S;S++)if(v=N(t[S]),v&&l(m,v))return v;return new c(!1)}d=u(t,I)}p=E?t.next:d.next;while(!(g=r(p,d)).done){try{v=N(g.value)}catch(w){D(d,"throw",w)}if("object"==typeof v&&v&&l(m,v))return v}return new c(!1)}},"53f7":function(t,e,a){"use strict";var i=a("7658"),r=a("57e7");i("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},5559:function(t,e,a){"use strict";var i=a("8c96"),r=a.n(i);r.a},"57e7":function(t,e,a){"use strict";var i=a("e37c"),r=a("e4ca"),n=a("a74c"),o=a("ae5c"),s=a("b720"),h=a("1eb8"),l=a("5075"),u=a("0cc2"),C=a("97ed"),D=a("437f"),f=a("ab4a"),c=a("d0b1").fastKey,m=a("235c"),d=m.set,I=m.getterFor;t.exports={getConstructor:function(t,e,a,u){var C=t((function(t,r){s(t,D),d(t,{type:e,index:i(null),first:void 0,last:void 0,size:0}),f||(t.size=0),h(r)||l(r,t[u],{that:t,AS_ENTRIES:a})})),D=C.prototype,m=I(e),S=function(t,e,a){var i,r,n=m(t),o=T(t,e);return o?o.value=a:(n.last=o={index:r=c(e,!0),key:e,value:a,previous:i=n.last,next:void 0,removed:!1},n.first||(n.first=o),i&&(i.next=o),f?n.size++:t.size++,"F"!==r&&(n.index[r]=o)),t},T=function(t,e){var a,i=m(t),r=c(e);if("F"!==r)return i.index[r];for(a=i.first;a;a=a.next)if(a.key===e)return a};return n(D,{clear:function(){var t=m(this),e=t.first;while(e)e.removed=!0,e.previous&&(e.previous=e.previous.next=void 0),e=e.next;t.first=t.last=void 0,t.index=i(null),f?t.size=0:this.size=0},delete:function(t){var e=m(this),a=T(this,t);if(a){var i=a.next,r=a.previous;delete e.index[a.index],a.removed=!0,r&&(r.next=i),i&&(i.previous=r),e.first===a&&(e.first=i),e.last===a&&(e.last=r),f?e.size--:this.size--}return!!a},forEach:function(t){var e,a=m(this),i=o(t,arguments.length>1?arguments[1]:void 0);while(e=e?e.next:a.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!T(this,t)}}),n(D,a?{get:function(t){var e=T(this,t);return e&&e.value},set:function(t,e){return S(this,0===t?0:t,e)}}:{add:function(t){return S(this,t=0===t?0:t,t)}}),f&&r(D,"size",{configurable:!0,get:function(){return m(this).size}}),C},setStrong:function(t,e,a){var i=e+" Iterator",r=I(e),n=I(i);u(t,e,(function(t,e){d(this,{type:i,target:t,state:r(t),kind:e,last:void 0})}),(function(){var t=n(this),e=t.kind,a=t.last;while(a&&a.removed)a=a.previous;return t.target&&(t.last=a=a?a.next:t.state.first)?C("keys"===e?a.key:"values"===e?a.value:[a.key,a.value],!1):(t.target=void 0,C(void 0,!0))}),a?"entries":"values",!a,!0),D(e)}}},5971:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".tab_bar[data-v-b0e70ce2]{flex:1;display:flex;justify-content:space-around}.tab_item[data-v-b0e70ce2]{padding:5px 0;cursor:pointer}.active[data-v-b0e70ce2]{color:#007aff;border-bottom:2px solid #007aff}.tab_content[data-v-b0e70ce2]{padding:10px 2px}.option_Icon[data-v-b0e70ce2]{width:26px;height:24px;margin-right:4px;cursor:pointer}.tab_option[data-v-b0e70ce2]{border-bottom:1px solid #f4f4f4;display:flex;align-items:center;justify-content:space-between}.Optiondialog[data-v-b0e70ce2]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:999}.OptionContent[data-v-b0e70ce2]{background-color:#fff;padding:20px;border-radius:5px;width:50%;height:50%}.OptionHeader[data-v-b0e70ce2]{display:flex;justify-content:space-between;margin-bottom:10px}.OptionCloseIcon[data-v-b0e70ce2]{cursor:pointer}.OptionBody[data-v-b0e70ce2]{text-align:center}",""]),t.exports=e},"5a47":function(t,e,a){"use strict";a.r(e);var i=a("219e"),r=a("36b3");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("069c");var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"b0e70ce2",null,!1,i["a"],void 0);e["default"]=s.exports},"5d6e":function(t,e,a){"use strict";var i=a("af9e");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},"5e60":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"button-container"},[a("v-uni-view",{staticClass:"toggle-button"},[a("v-uni-button",{staticClass:"mini-btn",attrs:{type:"default",size:"mini"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.toggleButtons.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.EndTouchButton()}}},[t._v(t._s(t.isExpanded?"合":"展"))])],1),a("v-uni-view",{staticClass:"button-sp-area",style:{transform:t.isExpanded?"translateX(10%)":"translateX(-200%)",transition:"transform 0.5s ease"}},[a("v-uni-button",{staticClass:"mini-btn",attrs:{type:"default",size:"mini"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.StartTouchButton(1)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.EndTouchButton()}}},[t._v("+")]),a("v-uni-button",{staticClass:"mini-btn",attrs:{type:"default",size:"mini"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.StartTouchButton(2)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.EndTouchButton()}}},[t._v("-")]),a("v-uni-button",{staticClass:"mini-btn",attrs:{type:"default",size:"mini"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.StartTouchButton(3)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.EndTouchButton()}}},[t._v("左")]),a("v-uni-button",{staticClass:"mini-btn",attrs:{type:"default",size:"mini"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.StartTouchButton(4)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.EndTouchButton()}}},[t._v("右")])],1)],1)},r=[]},"60d3":function(t,e,a){"use strict";var i=a("a2ad"),r=a.n(i);r.a},6831:function(t,e,a){"use strict";a.r(e);var i=a("3f59"),r=a("af03");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("b03b");var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"27350f62",null,!1,i["a"],void 0);e["default"]=s.exports},"69c9":function(t,e,a){"use strict";a.r(e);var i=a("0508"),r=a("bf7ad");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("60d3");var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"97834648",null,!1,i["a"],void 0);e["default"]=s.exports},"70fc":function(t,e,a){var i=a("c190");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("967d").default;r("23e8d21e",i,!0,{sourceMap:!1,shadowMode:!1})},7658:function(t,e,a){"use strict";var i=a("8bdb"),r=a("85c1"),n=a("bb80"),o=a("8466"),s=a("81a9"),h=a("d0b1"),l=a("5075"),u=a("b720"),C=a("474f"),D=a("1eb8"),f=a("1c06"),c=a("af9e"),m=a("29ba"),d=a("181d"),I=a("dcda");t.exports=function(t,e,a){var S=-1!==t.indexOf("Map"),T=-1!==t.indexOf("Weak"),v=S?"set":"add",p=r[t],g=p&&p.prototype,x=p,F={},E=function(t){var e=n(g[t]);s(g,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(T&&!f(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return T&&!f(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(T&&!f(t))&&e(this,0===t?0:t)}:function(t,a){return e(this,0===t?0:t,a),this})},L=o(t,!C(p)||!(T||g.forEach&&!c((function(){(new p).entries().next()}))));if(L)x=a.getConstructor(e,t,S,v),h.enable();else if(o(t,!0)){var M=new x,y=M[v](T?{}:-0,1)!==M,R=c((function(){M.has(1)})),N=m((function(t){new p(t)})),w=!T&&c((function(){var t=new p,e=5;while(e--)t[v](e,e);return!t.has(-0)}));N||(x=e((function(t,e){u(t,g);var a=I(new p,t,x);return D(e)||l(e,a[v],{that:a,AS_ENTRIES:S}),a})),x.prototype=g,g.constructor=x),(R||w)&&(E("delete"),E("has"),S&&E("get")),(w||y)&&E(v),T&&g.clear&&delete g.clear}return F[t]=x,i({global:!0,constructor:!0,forced:x!==p},F),d(x,t),T||a.setStrong(x,t,S),x}},"7ba5":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAANCAYAAABcrsXuAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHhSURBVDhPtVPL66lRFP3+V6YMmJrJI49MZUBGBkohJRIh/IwNJO+8IuWVN+u2jrb7ud2R2111Oo+9z1l777WP9nw+IeN/QdOTCJF+/Xg83kMfyPV6VUP8xVdwuVzU+f1+h3Y+n1Gv11EoFFCpVFAsFlGtVtXcaDTw8/OjbOVyGaVSCblcDs1mE51OB4fDQd0l2e12exOSjGe8v9vtXiT5fB6ZTAbhcBhWqxWJRAKpVArpdBrZbBaxWAyhUAgWiwXRaFTZST6bzWA0GlGr1d4ZEIyeBCaTCf1+H5qwE91uFx6PR0UozpJyq9WC0+n8KMN8PofZbEYgEMB0OlUZ0L5areD1emEwGNSbmjxEjMdjuN1ulbpeC+5JQtvpdHrrQxKHw4FIJIJ4PK5KRFsymVQZ0zYcDqHpxZpMJiqC4/H4UWMOkrhcrrcvwXLZ7Xa02201bzYbFSj99vs9bDYber3eq7sE35JQVzaGz+eD3+9XOvIOS0/SD02+JWGZeIflDAaDShfKwP1gMPj9T/6FRLRbr9dKdNGZjaK6SzSh4VsS+ko2XEvQtI1Go1e5CBoWi4Wq7Xa7fUcjUbKT+EGFlI8xav6vv4E+9F8ul58kFJAPkkDOJCPOPNf/HX37/wlpc86/ACj2ohXeQ5OBAAAAAElFTkSuQmCC"},8024:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".TitleTip[data-v-27350f62]{background-color:#f5f5f5;display:flex;justify-content:space-between;padding:2px 4px;font-size:12px;height:20px}.BaseDataInfo[data-v-27350f62]{padding:6px;border-bottom:1px solid #f4f4f4;font-size:14px;white-space:nowrap;height:70px}.CurrentPrice[data-v-27350f62]{font-size:34px;font-weight:700;text-align:center}.ChangeInfo[data-v-27350f62]{display:flex;align-items:center;justify-content:center}.item[data-v-27350f62]{display:flex;align-items:center;justify-content:center;\n\t\t/* line-height: 26px; */height:20px}.Item_Text[data-v-27350f62]{flex:1;text-align:right}.notice[data-v-27350f62]{padding:5px 10px}.notice_item[data-v-27350f62]{display:flex;align-items:center}.icon[data-v-27350f62]{width:24px;height:24px;margin-right:5px}.newsIcon[data-v-27350f62]{width:10px;height:10px;margin-right:10px}.notice_close[data-v-27350f62]{display:flex;align-items:center;margin-left:auto;cursor:pointer}.tab_bar[data-v-27350f62]{flex:1;display:flex;justify-content:space-around}.tab_item[data-v-27350f62]{padding:5px 0;cursor:pointer}.active[data-v-27350f62]{color:#007aff;border-bottom:2px solid #007aff}.tab_content[data-v-27350f62]{padding:10px 2px}.option_Icon[data-v-27350f62]{width:26px;height:24px;margin-right:4px;cursor:pointer}.tab_option[data-v-27350f62]{border-bottom:1px solid #f4f4f4;display:flex;align-items:center;justify-content:space-between}.Optiondialog[data-v-27350f62]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:999}.OptionContent[data-v-27350f62]{background-color:#fff;padding:20px;border-radius:5px;width:50%;height:50%}.OptionHeader[data-v-27350f62]{display:flex;justify-content:space-between;margin-bottom:10px}.OptionCloseIcon[data-v-27350f62]{cursor:pointer}.OptionBody[data-v-27350f62]{text-align:center}",""]),t.exports=e},8733:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.KLineXAxisPaint=C;var r=i(a("9be4")),n=r.default.JSChart.ToFixedRect,o=r.default.JSChart.ToFixedPoint,s=r.default.JSChart,h=r.default.IExtendChartPainting,l=r.default.IFrameSplitOperator,u=r.default.JSChart.GetDevicePixelRatio;r.default.JSChart.GetMinuteTimeStringData();function C(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="KLineXAxisPaint",this.BGColor="rgb(255,255,255)",this.BorderColor="#A3A8AC",this.MinuteFrame=null,this.Font="".concat(12*u(),"px 微软雅黑"),this.Config={Height:20*u(),Margin:{Top:4*u()},Scale:{Width:6*u(),Height:5*u(),Color:"rgba(128,128,128,0.5)"}},this.SetOption=function(t){},this.GetVerticalInfoData=function(){if(!this.ChartFrame.SubFrame)return null;if(!l.IsNonEmptyArray(this.ChartFrame.SubFrame))return null;var t=this.ChartFrame.SubFrame[this.ChartFrame.SubFrame.length-1];return t.Frame?t.Frame.VerticalInfo:null},this.Draw=function(){if(this.HQChart&&this.ChartFrame.SubFrame[0]&&(this.MinuteFrame=this.ChartFrame.SubFrame[0].Frame,this.MinuteFrame)){var t=!0===this.MinuteFrame.IsHScreen,e=this.MinuteFrame.GetBorder();if(!0===t){var a={Left:e.Left,Top:e.Top,Bottom:e.Bottom,Width:this.Config.Height};a.Right=a.Left+a.Width,a.Height=a.Bottom-a.Top,this.DrawXAxisHScreen(a)}else{a={Left:e.Left+1,Right:e.Right,Bottom:e.Bottom-1,Height:this.Config.Height};a.Width=a.Right-a.Left,a.Top=a.Bottom-a.Height,this.Canvas.save(),this.DrawXAxis(a),this.Canvas.restore()}}},this.DrawXAxis=function(t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(n(t.Left),n(t.Top),n(t.Width),n(t.Height)),this.BGGradientColor&&(this.SetFillStyle(this.BGGradientColor,t.Left,t.Top,t.Right,t.Bottom),this.Canvas.fillRect(n(t.Left),n(t.Top),n(t.Width),n(t.Height))),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(o(t.Left),o(t.Top)),this.Canvas.lineTo(o(t.Right),o(t.Top)),this.Canvas.stroke(),this.Canvas.strokeStyle=this.Config.Scale.Color,this.Canvas.beginPath();for(var e=t.Left+this.Config.Scale.Width;e<t.Right;e+=this.Config.Scale.Width)this.Canvas.moveTo(o(e),o(t.Bottom-this.Config.Scale.Height)),this.Canvas.lineTo(o(e),o(t.Bottom));this.Canvas.stroke();var a=this.GetVerticalInfoData();if(l.IsNonEmptyArray(a)){this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font;var i=a[0];if(i&&i.Message[0]){var r=i.Message[0];this.Canvas.fillStyle=i.TextColor,this.Canvas.fillText(r,t.Left+1,t.Top+this.Config.Margin.Top)}i=a[1];if(i&&i.Message[0]){r=i.Message[0];var s=this.Canvas.measureText(r).width+2;this.Canvas.fillStyle=i.TextColor,this.Canvas.fillText(r,t.Right-s,t.Top+this.Config.Margin.Top)}}},this.DrawXAxisHScreen=function(t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(n(t.Left),n(t.Top),n(t.Width),n(t.Height)),this.BGGradientColor&&(this.SetFillStyle(this.BGGradientColor,t.Left,t.Top,t.Right,t.Bottom),this.Canvas.fillRect(n(t.Left),n(t.Top),n(t.Width),n(t.Height))),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(o(t.Right),o(t.Top)),this.Canvas.lineTo(o(t.Right),o(t.Bottom)),this.Canvas.moveTo(o(t.Left),o(t.Top)),this.Canvas.lineTo(o(t.Left),o(t.Bottom)),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.strokeStyle=this.Config.Scale.Color;for(var e=t.Top+this.Config.Scale.Width;e<t.Bottom;e+=this.Config.Scale.Width)this.Canvas.moveTo(o(t.Left),o(e)),this.Canvas.lineTo(o(t.Left+this.Config.Scale.Height),o(e));this.Canvas.stroke();var a=this.GetVerticalInfoData();if(a){this.Canvas.textBaseline="top",this.Canvas.font=this.Font;for(var i=0;i<a.length;++i){var r=a[i];if(r.Message[0]){var s=r.Message[0];e=this.MinuteFrame.GetXFromIndex(r.Value);this.Canvas.fillStyle=r.TextColor;var h=this.Canvas.measureText(s).width;e<h/2?this.Canvas.textAlign="left":e+h/2>=t.Bottom?this.Canvas.textAlign="right":this.Canvas.textAlign="center";var l=t.Right-this.Config.Margin.Top,u=e;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s,0,0),this.Canvas.restore()}}}},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){for(var n=this.Canvas.createLinearGradient(e,a,i,r),o=1/(t.length-1),s=0;s<t.length;++s)n.addColorStop(s*o,t[s]);this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t}}C.Register=function(){s.RegisterExtendChartClass("KLineXAxisPaint",{Create:function(){return new C}})},C.CustomCorssCursorPosition=function(t,e,a){var i=a.Frame.SubFrame[0].Frame;if(!0===a.Frame.IsHScreen){var r=i.ChartBorder.GetLeft();e.XText=r+e.Height}else{var n=i.ChartBorder.GetBottom(),o=e.RectText;o.Bottom=n,o.Top=o.Bottom-o.Height}},C.Register()},"8b56":function(t,e,a){t.exports=a.p+"assets/iconfont.08deb29a.ttf"},"8c96":function(t,e,a){var i=a("16b9");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("967d").default;r("2f10c632",i,!0,{sourceMap:!1,shadowMode:!1})},"8d89":function(t,e,a){"use strict";a.r(e);var i=a("aa55"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},"93f1":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("StockInfoView",{ref:"StockInfo"}),a("HQPeriodTabView",{ref:"PeriodTab"}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.KLine.IsShow,expression:"KLine.IsShow"}],ref:"DivKLine",staticClass:"DivHQChart"},[a("v-uni-view",{staticClass:"DivFloatToolbar"},[a("KLineToolbarView",{ref:"KLineToolbar"})],1),a("HQChartControl",{ref:"HQKLineCtrl",attrs:{DefaultChart:{Type:"KLine"},DefaultSymbol:t.Symbol}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.Minute.IsShow,expression:"Minute.IsShow"}],ref:"DivMinute",staticClass:"DivHQChart",staticStyle:{display:"flex","justify-content":"space-between"}},[a("v-uni-view",{staticStyle:{flex:"1"}},[a("HQChartControl",{ref:"HQMinuteCtrl",attrs:{DefaultChart:{Type:"Minute"},DefaultSymbol:t.Symbol}})],1),a("v-uni-view",{staticStyle:{width:"38%"}},[a("BuySellInfoView",{ref:"BuySellView"})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.MultiMinute.IsShow,expression:"MultiMinute.IsShow"}],ref:"DivMultiMinute",staticClass:"DivHQChart"},[a("HQChartControl",{ref:"HQMultiMinuteCtrl",attrs:{DefaultChart:{Type:"Minute"},DefaultSymbol:t.Symbol}})],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.HistoryMinute.IsShow,expression:"HistoryMinute.IsShow"}],staticClass:"HQHistoryMinuteCtrlTooltip"},[a("v-uni-view",{staticClass:"HistoryMinuteCloseIcon",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.EnableShowHistoryMinuteChart(!1)}}},[t._v("×")]),a("v-uni-view",{ref:"DivHistoryMinute",staticClass:"DivHQChart"},[a("HQChartControl",{ref:"HQHistoryMinuteCtrl",attrs:{DefaultChart:{Type:"Minute"}}})],1),a("v-uni-view",{staticClass:"HistoryMiunteTooltipBtn"},[a("v-uni-view",{staticClass:"changeDayBtn",on:{touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.MoveHistoryMinuteDay(-1)}}},[t._v("前一天")]),t._v("|"),a("v-uni-view",{staticClass:"changeDayBtn",on:{touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.MoveHistoryMinuteDay(1)}}},[t._v("后一天")])],1)],1)],1)},r=[]},"94d0":function(t,e,a){"use strict";var i=a("8bdb"),r=a("2e7f");i({target:"Math",stat:!0},{log10:r})},"9be4":function(t,e,a){"use strict";a("6a54");var r=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=r(a("b7c7")),s=r(a("fcf3")),h=r(a("39d8")),l=r(a("3471"));a("c1a3"),a("bf0f"),a("18f7"),a("de6c"),a("23f4"),a("7d2f"),a("5c47"),a("9c4e"),a("ab80"),a("2797"),a("5ef2"),a("af8f"),a("aa9c"),a("4626"),a("5ac7"),a("e966"),a("a1c1"),a("c223"),a("d4b5"),a("20f3"),a("f7a5"),a("8f71"),a("dd2b"),a("f3f7"),a("0506"),a("c9b5"),a("64aa"),a("1851"),a("4100"),a("dc69"),a("3efd"),a("d937"),a("2c10"),a("dfcf"),a("e838"),a("dc89"),a("2425"),a("08eb"),a("0c26"),a("7a76"),a("a03a"),a("94d0");var u={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn},JSTable:{Log:console.log,Warn:console.warn}},C={MINUTE_ID:101,MULTIDAY_MINUTE_ID:102,HISTORY_MINUTE_ID:103,KLINE_DAY_ID:0,KLINE_WEEK_ID:1,KLINE_TWOWEEK_ID:21,KLINE_MONTH_ID:2,KLINE_QUARTER_ID:9,KLINE_YEAR_ID:3,KLINE_MINUTE_ID:4,KLINE_5_MINUTE_ID:5,KLINE_15_MINUTE_ID:6,KLINE_30_MINUTE_ID:7,KLINE_60_MINUTE_ID:8};var D=new function(){this.DataMap=new Map,this.Get=function(t){return this.DataMap.has(t)?this.DataMap.get(t):null},this.Add=function(t){this.DataMap.set(t.ID,t)}};function f(){this.DataMap=new Map([["MA",this.MA],["均线",this.MA],["MA4",this.MA4],["MA5",this.MA5],["MA6",this.MA6],["MA7",this.MA7],["MA8",this.MA8],["BOLL",this.BOLL],["BOLL副图",this.BOLL2],["BBI",this.BBI],["DKX",this.DKX],["MIKE",this.MIKE],["PBX",this.PBX],["ENE",this.ENE],["MACD",this.MACD],["KDJ",this.KDJ],["MACD2",this.MACD2],["VOL",this.VOL],["VOL2",this.VOL2],["VOL_OVERLAY",this.VOL_OVERLAY],["RSI",this.RSI],["BRAR",this.BRAR],["WR",this.WR],["BIAS",this.BIAS],["OBV",this.OBV],["DMI",this.DMI],["CR",this.CR],["PSY",this.PSY],["CCI",this.CCI],["DMA",this.DMA],["TRIX",this.TRIX],["VR",this.VR],["EMV",this.EMV],["ROC",this.ROC],["MTM",this.MTM],["FSL",this.FSL],["CYR",this.CYR],["MASS",this.MASS],["WAD",this.WAD],["CHO",this.CHO],["ADTM",this.ADTM],["HSL",this.HSL],["BIAS36",this.BIAS36],["BIAS_QL",this.BIAS_QL],["DPO",this.DPO],["OSC",this.OSC],["ATR",this.ATR],["NVI",this.NVI],["PVI",this.PVI],["UOS",this.UOS],["CYW",this.CYW],["LON",this.LON],["NDB",this.NDB],["SKDJ",this.SKDJ],["KD",this.KD],["FKX",this.FKX],["DKCOL",this.DKCOL],["UDL",this.UDL],["MFI",this.MFI],["LWR",this.LWR],["MARSI",this.MARSI],["CYD",this.CYD],["CYF",this.CYF],["TAPI",this.TAPI],["VMACD",this.VMACD],["QACD",this.QACD],["VPT",this.VPT],["WVAD",this.WVAD],["DBQR",this.DBQR],["JS",this.JS],["CYE",this.CYE],["QR",this.QR],["GDX",this.GDX],["JLHB",this.JLHB],["PCNT",this.PCNT],["BTX",this.BTX],["AMO",this.AMO],["VRSI",this.VRSI],["HSCOL",this.HSCOL],["DBQRV",this.DBQRV],["DBLB",this.DBLB],["ACD",this.ACD],["EXPMA",this.EXPMA],["EXPMA_S",this.EXPMA_S],["HMA",this.HMA],["LMA",this.LMA],["VMA",this.VMA],["AMV",this.AMV],["BBIBOLL",this.BBIBOLL],["ALLIGAT",this.ALLIGAT],["GMMA",this.GMMA],["ZX",this.ZX],["XS",this.XS],["XS2",this.XS2],["SG-XDT",this.SG_XDT],["SG-SMX",this.SG_SMX],["SG-LB",this.SG_LB],["SG-PF",this.SG_PF],["RAD",this.RAD],["SHT",this.SHT],["ZLJC",this.ZLJC],["ZLMM",this.ZLMM],["SLZT",this.SLZT],["ADVOL",this.ADVOL],["CYC",this.CYC],["CYS",this.CYS],["CYQKL",this.CYQKL],["SCR",this.SCR],["ASR",this.ASR],["SAR",this.SAR],["TJCJL",this.TJCJL],["量比",this.VOLRate],["平均K线",this.HeikinAshi],["ADL",this.ADL],["SQJZ",this.SQJZ],["XT",this.XT],["CFJT",this.CFJT],["CYX",this.CYX],["WAVE",this.WAVE],["VOL-TDX",this.VOL_TDX],["EMPTY",this.EMPTY],["神奇九转",this.NineTurns],["EMA",this.EMA3],["EMA4",this.EMA4],["EMA5",this.EMA5],["EMA6",this.EMA6],["ICHIMOKU",this.ICHIMOKU],["CDP-STD",this.CDP_STD],["TBP-STD",this.TBP_STD],["ADX",this.ADX],["SMACD",this.SMACD],["ACCER",this.ACCER],["AMO-TDX",this.AMO_TDX],["WSBVOL",this.WSBVOL],["CCYD",this.CCYD],["CCL",this.CCL],["ABI",this.ABI],["持仓量",this.VOL_POSITION],["散户线",this.ShareholderCount],["NXTS",this.NXTS],["FKX",this.FKX],["两融资金",this.Margin4],["ZSDB",this.ZSDB],["CJL2",this.CJL],["ASI",this.ASI],["DC",this.DC],["DEMA",this.DEMA],["VWAP",this.VWAP],["ZNZ_CBAND",this.ZNZ_CBAND],["ZNZ_RPY2",this.ZNZ_RPY2],["ZNZ_RPY1",this.ZNZ_RPY1],["飞龙四式",this.Dragon4_Main],["飞龙四式-附图",this.Dragon4_Fig],["资金分析",this.FundsAnalysis],["融资占比",this.MarginProportion],["负面新闻",this.NewsNegative],["涨跌趋势",this.UpDownAnalyze],["北上资金",this.HK2SHSZ],["股东人数",this.ShareHolder],["两融余额",this.Margin2],["两融余额2",this.Margin3],["特色指标-操盘BS点",this.FXG_BSPoint],["特色指标-涨停多空线",this.FXG_INDEX],["特色指标-涨停吸筹区",this.FXG_INDEX2],["特色指标-量能黄金点",this.FXG_INDEX3],["五彩K线-十字星",this.COLOR_KSTAR1],["五彩K线-早晨之星",this.COLOR_KSTAR2],["五彩K线-黄昏之星",this.COLOR_KSTAR3],["五彩K线-长十字",this.COLOR_SHI1],["五彩K线-身怀六甲",this.COLOR_K220],["五彩K线-三个白武士",this.COLOR_K300],["五彩K线-三只乌鸦",this.COLOR_K310],["五彩K线-光头阳线",this.COLOR_K380],["五彩K线-光脚阴线",this.COLOR_K390],["五彩K线-垂死十字",this.COLOR_K134],["五彩K线-早晨十字星",this.COLOR_K140],["五彩K线-黄昏十字星",this.COLOR_K150],["五彩K线-射击之星",this.COLOR_K160],["五彩K线-倒转锤头",this.COLOR_K165],["五彩K线-锤头",this.COLOR_K170],["五彩K线-吊颈",this.COLOR_K180],["五彩K线-穿头破脚",this.COLOR_K190],["五彩K线-出水芙蓉",this.COLOR_CSFR],["五彩K线-乌云盖顶",this.COLOR_WYGD],["五彩K线-曙光初现",this.COLOR_SGCJ],["五彩K线-十字胎",this.COLOR_SZTAI],["五彩K线-剑",this.COLOR_SWORD],["五彩K线-平顶",this.COLOR_PINGDING],["五彩K线-平底",this.COLOR_PINGDI],["五彩K线-大阳烛",this.COLOR_DAYANZHU],["五彩K线-大阴烛",this.COLOR_DAYINGZHU],["五彩K线-好友反攻",this.COLOR_HYFG],["五彩K线-跳空缺口",this.COLOR_TKQK],["五彩K线-双飞乌鸦",this.COLOR_SFWY],["五彩K线-上升三部曲",this.COLOR_SSSBQ],["五彩K线-下跌三部曲",this.COLOR_XDSBQ],["五彩K线-长下影",this.COLOR_CHXY],["五彩K线-长上影",this.COLOR_CHSY],["五彩K线-分离",this.COLOR_FENLI],["交易系统-BIAS",this.TRADE_BIAS],["交易系统-CCI",this.TRADE_CCI],["交易系统-DMI",this.TRADE_DMI],["交易系统-KD",this.TRADE_KD],["交易系统-BOLL",this.TRADE_BOLL],["交易系统-KDJ",this.TRADE_KDJ],["交易系统-MA",this.TRADE_MA],["交易系统-MACD",this.TRADE_MACD],["交易系统-MTM",this.TRADE_MTM],["交易系统-PSY",this.TRADE_PSY],["交易系统-ROC",this.TRADE_ROC],["交易系统-RSI",this.TRADE_RSI],["交易系统-VR",this.TRADE_VR],["交易系统-DPSJ",this.TRADE_DPSJ],["TEST",this.TEST]])}if(f.AddIndex=function(t){for(var e in t)D.Add(t[e])},f.ModifyAttribute=function(t,e){if(e&&(e.Args&&(t.Args=e.Args),sa.IsNumber(e.FloatPrecision)&&(t.FloatPrecision=e.FloatPrecision),sa.IsNumber(e.StringFormat)&&(t.StringFormat=e.StringFormat),sa.IsBool(e.IsSync)&&(t.IsSync=e.IsSync),sa.IsBool(e.IsShortTitle)&&(t.IsShortTitle=e.IsShortTitle),e.TitleFont&&(t.TitleFont=e.TitleFont),e.Lock&&(t.Lock=e.Lock),sa.IsNumber(e.YSplitType)&&(t.YSplitType=e.YSplitType),sa.IsBool(e.IsShowIndexTitle)&&(t.IsShowIndexTitle=e.IsShowIndexTitle),sa.IsNumber(e.KLineType)&&(t.KLineType=e.KLineType),e.YAxis)){var a=e.YAxis;t.YAxis||(t.YAxis={}),sa.IsNumber(a.FloatPrecision)&&(t.YAxis.FloatPrecision=a.FloatPrecision),sa.IsNumber(a.StringFormat)&&(t.YAxis.StringFormat=a.StringFormat),sa.IsBool(a.EnableRemoveZero)&&(t.YAxis.EnableRemoveZero=a.EnableRemoveZero),sa.IsBool(a.ExcludeValue)&&(t.YAxis.ExcludeValue=a.ExcludeValue)}},f.prototype.Get=function(t){var e=D.Get(t);if(e)return e;var a=this.DataMap.get(t);if(a){e=a();return e.ID=t,e}return null},f.prototype.Search=function(t){var e=[],a=new RegExp(t,"i");return this.DataMap.forEach((function(t,i){0!=i.indexOf("交易系统-")&&0!=i.indexOf("五彩K线-")&&i.search(a)>=0&&e.push(i)})),e},f.prototype.MA=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);"}},f.prototype.MA4=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);"}},f.prototype.MA5=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);"}},f.prototype.MA6=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);"}},f.prototype.MA7=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);"}},f.prototype.MA8=function(){return{Name:"MA",Description:"均线",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0},{Name:"M8",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"},{Name:"MA8",DynamicName:"MA{M8}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);\nMA8:MA(CLOSE,M8);"}},f.prototype.EMA3=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);"}},f.prototype.EMA4=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);"}},f.prototype.EMA5=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);\nMA5:EMA(CLOSE,M5);"}},f.prototype.EMA6=function(){return{Name:"EMA",Description:"指数移动平均值",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);\nMA5:EMA(CLOSE,M5);\nMA6:EMA(CLOSE,M6);"}},f.prototype.BOLL=function(){return{Name:"BOLL",Description:"布林线",IsMainIndex:!0,Args:[{Name:"M",Value:20}],Script:"BOLL:MA(CLOSE,M);\nUB:BOLL+2*STD(CLOSE,M);\nLB:BOLL-2*STD(CLOSE,M);"}},f.prototype.BOLL2=function(){return{Name:"BOLL2",Description:"布林线",IsMainIndex:!1,KLineType:0,Args:[{Name:"M",Value:20}],Script:"BOLL:MA(CLOSE,M);\nUB:BOLL+2*STD(CLOSE,M);\nLB:BOLL-2*STD(CLOSE,M);"}},f.prototype.BBI=function(){return{Name:"BBI",Description:"多空均线",IsMainIndex:!0,Args:[{Name:"M1",Value:3},{Name:"M2",Value:6},{Name:"M3",Value:12},{Name:"M4",Value:24}],Script:"BBI:(MA(CLOSE,M1)+MA(CLOSE,M2)+MA(CLOSE,M3)+MA(CLOSE,M4))/4;"}},f.prototype.DKX=function(){return{Name:"DKX",Description:"多空线",IsMainIndex:!1,Args:[{Name:"M",Value:10}],Script:"MID:=(3*CLOSE+LOW+OPEN+HIGH)/6;\nDKX:(20*MID+19*REF(MID,1)+18*REF(MID,2)+17*REF(MID,3)+\n16*REF(MID,4)+15*REF(MID,5)+14*REF(MID,6)+\n13*REF(MID,7)+12*REF(MID,8)+11*REF(MID,9)+\n10*REF(MID,10)+9*REF(MID,11)+8*REF(MID,12)+\n7*REF(MID,13)+6*REF(MID,14)+5*REF(MID,15)+\n4*REF(MID,16)+3*REF(MID,17)+2*REF(MID,18)+REF(MID,20))/210;\nMADKX:MA(DKX,M);"}},f.prototype.MIKE=function(){return{Name:"MIKE",Description:"麦克支撑压力",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"HLC:=REF(MA((HIGH+LOW+CLOSE)/3,N),1);\nHV:=EMA(HHV(HIGH,N),3);\nLV:=EMA(LLV(LOW,N),3);\nSTOR:EMA(2*HV-LV,3);\nMIDR:EMA(HLC+HV-LV,3);\nWEKR:EMA(HLC*2-LV,3);\nWEKS:EMA(HLC*2-HV,3);\nMIDS:EMA(HLC-HV+LV,3);\nSTOS:EMA(2*LV-HV,3);"}},f.prototype.PBX=function(){return{Name:"PBX",Description:"瀑布线",IsMainIndex:!0,Args:[{Name:"M1",Value:4},{Name:"M2",Value:6},{Name:"M3",Value:9},{Name:"M4",Value:13},{Name:"M5",Value:18},{Name:"M6",Value:24}],Script:"PBX1:(EMA(CLOSE,M1)+MA(CLOSE,M1*2)+MA(CLOSE,M1*4))/3;\nPBX2:(EMA(CLOSE,M2)+MA(CLOSE,M2*2)+MA(CLOSE,M2*4))/3;\nPBX3:(EMA(CLOSE,M3)+MA(CLOSE,M3*2)+MA(CLOSE,M3*4))/3;\nPBX4:(EMA(CLOSE,M4)+MA(CLOSE,M4*2)+MA(CLOSE,M4*4))/3;\nPBX5:(EMA(CLOSE,M5)+MA(CLOSE,M5*2)+MA(CLOSE,M5*4))/3;\nPBX6:(EMA(CLOSE,M6)+MA(CLOSE,M6*2)+MA(CLOSE,M6*4))/3;"}},f.prototype.ENE=function(){return{Name:"ENE",Description:"轨道线",IsMainIndex:!0,Args:[{Name:"N",Value:25},{Name:"M1",Value:6},{Name:"M2",Value:6}],Script:"UPPER:(1+M1/100)*MA(CLOSE,N);\nLOWER:(1-M2/100)*MA(CLOSE,N);\nENE:(UPPER+LOWER)/2;"}},f.prototype.MACD=function(){return{Name:"MACD",Description:"平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA:EMA(DIF,MID);\nMACD:(DIF-DEA)*2,COLORSTICK;"}},f.prototype.MACD2=function(){return{Name:"MACD",Description:"平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF2:=EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA2:=EMA(DIF2,MID);\nMACD:(DIF2-DEA2)*2,COLORSTICK,LINETHICK50;\nDIF:DIF2;\nDEA:DEA2;"}},f.prototype.KDJ=function(){return{Name:"KDJ",Description:"随机指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);\nJ:3*K-2*D;"}},f.prototype.VOL=function(){return{Name:"VOL",Description:"成交量",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"}],Script:"VOL:VOL,VOLSTICK;\nMA1:MA(VOL,M1);\nMA2:MA(VOL,M2);"}},f.prototype.VOL2=function(){return{Name:"VOL",Description:"成交量",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"}],Script:"VOL:VOL,VOLSTICK,STICKTYPE(1);\nMA1:MA(VOL,M1);\nMA2:MA(VOL,M2);"}},f.prototype.VOL_OVERLAY=function(){return{Name:"VOL",Description:"成交量",IsMainIndex:!1,FloatPrecision:0,Script:"VOL:VOL,VOLSTICK,UPCOLOR(RGBA(255,0,0,0.3)),DOWNCOLOR(RGBA(0,255,0,0.3));"}},f.prototype.VOL_TDX=function(){return{Name:"VOL-TDX",Description:"成交量(虚拟)",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"TOTAL:=IF(PERIOD=1,5,IF(PERIOD=2,15,IF(PERIOD=3,30,IF(PERIOD=4,60,IF(PERIOD=5,TOTALFZNUM,1)))));\nMTIME:=MOD(FROMOPEN,TOTAL);\nCTIME:=IF(MTIME<0.5,TOTAL,MTIME);\nVVOL:IF((CURRBARSCOUNT=1 AND DYNAINFO(8)>1),VOL*(TOTAL+3)/(CTIME+3),DRAWNULL),NODRAW;\nSTICKLINE((CURRBARSCOUNT=1 AND DYNAINFO(8)>1),VVOL,0,-1,-1),COLORYELLOW;\nVOLUME:VOL,VOLSTICK;\nMAVOL1:MA(VOLUME,M1);\nMAVOL2:MA(VOLUME,M2);"}},f.prototype.AMO_TDX=function(){return{Name:"AMO-TDX",Description:"成交金额(虚拟)",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"TOTAL:=IF(PERIOD=1,5,IF(PERIOD=2,15,IF(PERIOD=3,30,IF(PERIOD=4,60,IF(PERIOD=5,TOTALFZNUM,1)))));\nMTIME:=MOD(FROMOPEN,TOTAL);\nCTIME:=IF(MTIME<0.5,TOTAL,MTIME);\nVAMO:=IF((CURRBARSCOUNT=1 AND DYNAINFO(8)>1),AMOUNT/10000.0*TOTAL/CTIME,DRAWNULL);\nSTICKLINE((CURRBARSCOUNT=1 AND DYNAINFO(8)>1),VAMO,0,-1,-1),COLOR00C0C0;\nAMOW:AMOUNT/10000.0,VOLSTICK;\nAMO1:MA(AMOW,M1);\nAMO2:MA(AMOW,M2);"}},f.prototype.RSI=function(){return{Name:"RSI",Description:"相对强弱指标",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(CLOSE,1);\nRSI1:SMA(MAX(CLOSE-LC,0),N1,1)/SMA(ABS(CLOSE-LC),N1,1)*100;\nRSI2:SMA(MAX(CLOSE-LC,0),N2,1)/SMA(ABS(CLOSE-LC),N2,1)*100;\nRSI3:SMA(MAX(CLOSE-LC,0),N3,1)/SMA(ABS(CLOSE-LC),N3,1)*100;"}},f.prototype.BRAR=function(){return{Name:"BRAR",Description:"情绪指标",IsMainIndex:!1,Args:[{Name:"N",Value:26}],Script:"BR:SUM(MAX(0,HIGH-REF(CLOSE,1)),N)/SUM(MAX(0,REF(CLOSE,1)-LOW),N)*100;\nAR:SUM(HIGH-OPEN,N)/SUM(OPEN-LOW,N)*100;"}},f.prototype.WR=function(){return{Name:"WR",Description:"威廉指标",IsMainIndex:!1,Args:[{Name:"N",Value:10},{Name:"N1",Value:6}],Script:"WR1:100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N));\nWR2:100*(HHV(HIGH,N1)-CLOSE)/(HHV(HIGH,N1)-LLV(LOW,N1));"}},f.prototype.BIAS=function(){return{Name:"BIAS",Description:"乖离率",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"BIAS1 :(CLOSE-MA(CLOSE,N1))/MA(CLOSE,N1)*100;\nBIAS2 :(CLOSE-MA(CLOSE,N2))/MA(CLOSE,N2)*100;\nBIAS3 :(CLOSE-MA(CLOSE,N3))/MA(CLOSE,N3)*100;"}},f.prototype.OBV=function(){return{Name:"OBV",Description:"累积能量线",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"VA:=IF(CLOSE>REF(CLOSE,1),VOL,-VOL);\nOBV:SUM(IF(CLOSE==REF(CLOSE,1),0,VA),0);\nMAOBV:MA(OBV,M);"}},f.prototype.DMI=function(){return{Name:"DMI",Description:"趋向指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"MM",Value:6}],Script:"MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nDMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);\nDMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);\nPDI: DMP*100/MTR;\nMDI: DMM*100/MTR;\nADX: EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);\nADXR:EXPMEMA(ADX,MM);"}},f.prototype.CR=function(){return{Name:"CR",Description:"带状能量线",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:40},{Name:"M4",Value:62}],Script:"MID:=REF(HIGH+LOW,1)/2;\nCR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\nMA1:REF(MA(CR,M1),M1/2.5+1);\nMA2:REF(MA(CR,M2),M2/2.5+1);\nMA3:REF(MA(CR,M3),M3/2.5+1);\nMA4:REF(MA(CR,M4),M4/2.5+1);"}},f.prototype.PSY=function(){return{Name:"PSY",Description:"心理线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"PSY:COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\rPSYMA:MA(PSY,M);"}},f.prototype.CCI=function(){return{Name:"CCI",Description:"商品路径指标",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));"}},f.prototype.DMA=function(){return{Name:"DMA",Description:"平均差",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:50},{Name:"M",Value:10}],Script:"DIF:MA(CLOSE,N1)-MA(CLOSE,N2);\nDIFMA:MA(DIF,M);"}},f.prototype.TRIX=function(){return{Name:"TRIX",Description:"三重指数平均线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:9}],Script:"MTR:=EMA(EMA(EMA(CLOSE,N),N),N);\nTRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\nMATRIX:MA(TRIX,M) ;"}},f.prototype.VR=function(){return{Name:"VR",Description:"成交量变异率",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M",Value:6}],Script:"TH:=SUM(IF(CLOSE>REF(CLOSE,1),VOL,0),N);\nTL:=SUM(IF(CLOSE<REF(CLOSE,1),VOL,0),N);\nTQ:=SUM(IF(CLOSE==REF(CLOSE,1),VOL,0),N);\nVR:100*(TH*2+TQ)/(TL*2+TQ);\nMAVR:MA(VR,M);"}},f.prototype.EMV=function(){return{Name:"EMV",Description:"简易波动指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"M",Value:9}],Script:"VOLUME:=MA(VOL,N)/VOL;\nMID:=100*(HIGH+LOW-REF(HIGH+LOW,1))/(HIGH+LOW);\nEMV:MA(MID*VOLUME*(HIGH-LOW)/MA(HIGH-LOW,N),N);\nMAEMV:MA(EMV,M);"}},f.prototype.ROC=function(){return{Name:"ROC",Description:"变动率指标",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"ROC:100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMAROC:MA(ROC,M);"}},f.prototype.MTM=function(){return{Name:"MTM",Description:"动量线",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"MTM:CLOSE-REF(CLOSE,N);\nMAMTM:MA(MTM,M);"}},f.prototype.FSL=function(){return{Name:"FSL",Description:"分水岭",IsMainIndex:!1,Args:[],Script:"SWL:(EMA(CLOSE,5)*7+EMA(CLOSE,10)*3)/10;\nSWS:DMA(EMA(CLOSE,12),MAX(1,100*(SUM(VOL,5)/(3*CAPITAL))));"}},f.prototype.CYR=function(){return{Name:"CYR",Description:"市场强弱",IsMainIndex:!1,Args:[{Name:"N",Value:13},{Name:"M",Value:5}],Script:"DIVE:=0.01*EMA(AMOUNT,N)/EMA(VOL,N);\nCYR:(DIVE/REF(DIVE,1)-1)*100;\nMACYR:MA(CYR,M);"}},f.prototype.MASS=function(){return{Name:"MASS",Description:"市场强弱",IsMainIndex:!1,Args:[{Name:"N1",Value:9},{Name:"N2",Value:25},{Name:"M",Value:6}],Script:"MASS:SUM(MA(HIGH-LOW,N1)/MA(MA(HIGH-LOW,N1),N1),N2);\nMAMASS:MA(MASS,M);"}},f.prototype.WAD=function(){return{Name:"WAD",Description:"威廉多空力度线",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"MIDA:=CLOSE-MIN(REF(CLOSE,1),LOW);\nMIDB:=IF(CLOSE<REF(CLOSE,1),CLOSE-MAX(REF(CLOSE,1),HIGH),0);\nWAD:SUM(IF(CLOSE>REF(CLOSE,1),MIDA,MIDB),0);\nMAWAD:MA(WAD,M);"}},f.prototype.CHO=function(){return{Name:"CHO",Description:"佳庆指标",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:20},{Name:"M",Value:6}],Script:"MID:=SUM(VOL*(2*CLOSE-HIGH-LOW)/(HIGH+LOW),0);\nCHO:MA(MID,N1)-MA(MID,N2);\nMACHO:MA(CHO,M);"}},f.prototype.ADTM=function(){return{Name:"ADTM",Description:"动态买卖气指标",IsMainIndex:!1,Args:[{Name:"N",Value:23},{Name:"M",Value:8}],Script:"DTM:=IF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));\nDBM:=IF(OPEN>=REF(OPEN,1),0,MAX((OPEN-LOW),(OPEN-REF(OPEN,1))));\nSTM:=SUM(DTM,N);\nSBM:=SUM(DBM,N);\nADTM:IF(STM>SBM,(STM-SBM)/STM,IF(STM==SBM,0,(STM-SBM)/SBM));\nMAADTM:MA(ADTM,M);"}},f.prototype.HSL=function(){return{Name:"HSL",Description:"换手线",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100);\nMAHSL:MA(HSL,N);"}},f.prototype.BIAS36=function(){return{Name:"BIAS36",Description:"三六乖离",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"BIAS36:MA(CLOSE,3)-MA(CLOSE,6);\nBIAS612:MA(CLOSE,6)-MA(CLOSE,12);\nMABIAS:MA(BIAS36,M);"}},f.prototype.BIAS_QL=function(){return{Name:"BIAS_QL",Description:"乖离率-传统版",IsMainIndex:!1,Args:[{Name:"N",Value:6},{Name:"M",Value:6}],Script:"BIAS :(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nBIASMA :MA(BIAS,M);"}},f.prototype.DPO=function(){return{Name:"DPO",Description:"区间震荡线",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"DPO:CLOSE-REF(MA(CLOSE,N),N/2+1);\nMADPO:MA(DPO,M);"}},f.prototype.OSC=function(){return{Name:"OSC",Description:"变动速率线",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"OSC:100*(CLOSE-MA(CLOSE,N));\nMAOSC:EXPMEMA(OSC,M);"}},f.prototype.ATR=function(){return{Name:"ATR",Description:"真实波幅",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"MTR:MAX(MAX((HIGH-LOW),ABS(REF(CLOSE,1)-HIGH)),ABS(REF(CLOSE,1)-LOW));\nATR:MA(MTR,N);"}},f.prototype.NVI=function(){return{Name:"ATR",Description:"负成交量",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V<REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"}},f.prototype.PVI=function(){return{Name:"PVI",Description:"正成交量",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V>REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"}},f.prototype.UOS=function(){return{Name:"UOS",Description:"终极指标",IsMainIndex:!1,Args:[{Name:"N1",Value:7},{Name:"N2",Value:14},{Name:"N3",Value:28},{Name:"M",Value:6}],Script:"TH:=MAX(HIGH,REF(CLOSE,1));\nTL:=MIN(LOW,REF(CLOSE,1));\nACC1:=SUM(CLOSE-TL,N1)/SUM(TH-TL,N1);\nACC2:=SUM(CLOSE-TL,N2)/SUM(TH-TL,N2);\nACC3:=SUM(CLOSE-TL,N3)/SUM(TH-TL,N3);\nUOS:(ACC1*N2*N3+ACC2*N1*N3+ACC3*N1*N2)*100/(N1*N2+N1*N3+N2*N3);\nMAUOS:EXPMEMA(UOS,M);"}},f.prototype.CYW=function(){return{Name:"CYW",Description:"主力控盘",IsMainIndex:!1,Args:[],Script:"VAR1:=CLOSE-LOW;\nVAR2:=HIGH-LOW;\nVAR3:=CLOSE-HIGH;\nVAR4:=IF(HIGH>LOW,(VAR1/VAR2+VAR3/VAR2)*VOL,0);\nCYW: SUM(VAR4,10)/10000, COLORSTICK;"}},f.prototype.LON=function(){return{Name:"LON",Description:"龙系长线",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"LC := REF(CLOSE,1);\nVID := SUM(VOL,2)/(((HHV(HIGH,2)-LLV(LOW,2)))*100);\nRC := (CLOSE-LC)*VID;\nLONG := SUM(RC,0);\nDIFF := SMA(LONG,10,1);\nDEA := SMA(LONG,20,1);\nLON : DIFF-DEA;\nLONMA : MA(LON,10);\nLONT : LON, COLORSTICK;"}},f.prototype.NDB=function(){return{Name:"NDB",Description:"脑电波",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"HH:=IF(C/REF(C,1)>1.098 AND L>REF(H,1),2*C-REF(C,1)-H,2*C-H-L);\nV1:= BARSCOUNT(C) - 1;\nV2:= 2 * REF(C, V1) - REF(H, V1) - REF(L, V1);\nDK: SUM(HH, 0) + V2;\nMDK5: MA(DK, P1);\nMDK10: MA(DK, P2);"}},f.prototype.SKDJ=function(){return{Name:"SKDJ",Description:"慢速随机指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M",Value:3}],Script:"LOWV:=LLV(LOW,N);\nHIGHV:=HHV(HIGH,N);\nRSV:=EMA((CLOSE-LOWV)/(HIGHV-LOWV)*100,M);\nK:EMA(RSV,M);\nD:MA(K,M);"}},f.prototype.KD=function(){return{Name:"KD",Description:"随机指标KD",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);"}},f.prototype.FKX=function(){return{Name:"FKX",Description:"反K线",IsMainIndex:!0,Args:[],Script:"DRAWKLINE(-LOW, -OPEN, -HIGH, -CLOSE);"}},f.prototype.DKCOL=function(){return{Name:"DKCOL",Description:"多空能量柱(适用于分时主图)",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"FF:=(C-REF(C,N))/REF(C,N);\nSTICKLINE(FF>0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORRED;\nSTICKLINE(FF<0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORGREEN;"}},f.prototype.UDL=function(){return{Name:"UDL",Description:"引力线",IsMainIndex:!1,Args:[{Name:"N1",Value:3},{Name:"N2",Value:5},{Name:"N3",Value:10},{Name:"N4",Value:20},{Name:"M",Value:6}],Script:"UDL:(MA(CLOSE,N1)+MA(CLOSE,N2)+MA(CLOSE,N3)+MA(CLOSE,N4))/4;\nMAUDL:MA(UDL,M);"}},f.prototype.MFI=function(){return{Name:"MFI",Description:"资金流量指标",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"N2",Value:6}],Script:"TYP := (HIGH + LOW + CLOSE)/3;\nV1:=SUM(IF(TYP>REF(TYP,1),TYP*VOL,0),N)/SUM(IF(TYP<REF(TYP,1),TYP*VOL,0),N);\nMFI:100-(100/(1+V1));"}},f.prototype.LWR=function(){return{Name:"LWR",Description:"LWR威廉指标",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:= (HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N))*100;\nLWR1:SMA(RSV,M1,1);\nLWR2:SMA(LWR1,M2,1);"}},f.prototype.MARSI=function(){return{Name:"MARSI",Description:"相对强弱平均线",IsMainIndex:!1,Args:[{Name:"M1",Value:10},{Name:"M2",Value:6}],Script:"DIF:=CLOSE-REF(CLOSE,1);\nVU:=IF(DIF>=0,DIF,0);\nVD:=IF(DIF<0,-DIF,0);\nMAU1:=MEMA(VU,M1);\nMAD1:=MEMA(VD,M1);\nMAU2:=MEMA(VU,M2);\nMAD2:=MEMA(VD,M2);\nRSI10:MA(100*MAU1/(MAU1+MAD1),M1);\nRSI6:MA(100*MAU2/(MAU2+MAD2),M2);"}},f.prototype.CYD=function(){return{Name:"CYD",Description:"承接因子",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYDS:WINNER(CLOSE)/(VOL/CAPITAL);\nCYDN:WINNER(CLOSE)/MA(VOL/CAPITAL,N);"}},f.prototype.CYF=function(){return{Name:"CYF",Description:"市场能量",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYF:100-100/(1+EMA(HSL,N));"}},f.prototype.TAPI=function(){return{Name:"TAPI",Description:"加权指数成交值",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"TAPI:AMOUNT/INDEXC;\nMATAIP:MA(TAPI,M);"}},f.prototype.VMACD=function(){return{Name:"VMACD",Description:"量平滑异同平均",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(VOL,SHORT)-EMA(VOL,LONG);\nDEA:EMA(DIF,MID);\nMACD:DIF-DEA,COLORSTICK;"}},f.prototype.SMACD=function(){return{Name:"SMACD",Description:"单线平滑异同平均线",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:=EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA:EMA(DIF,MID);\nMACD:DIF,COLORSTICK;"}},f.prototype.ACCER=function(){return{Name:"ACCER",Description:"幅度涨速",IsMainIndex:!1,Args:[{Name:"N",Value:8}],Script:"ACCER:SLOPE(CLOSE,N)/CLOSE;"}},f.prototype.QACD=function(){return{Name:"QACD",Description:"快速异同平均",IsMainIndex:!1,Args:[{Name:"N1",Value:12},{Name:"N2",Value:26},{Name:"M",Value:9}],Script:"DIF:EMA(CLOSE,N1)-EMA(CLOSE,N2);\nMACD:EMA(DIF,M);\nDDIF:DIF-MACD;"}},f.prototype.VPT=function(){return{Name:"VPT",Description:"量价曲线",IsMainIndex:!1,Args:[{Name:"N",Value:51},{Name:"M",Value:6}],Script:"VPT:SUM(VOL*(CLOSE-REF(CLOSE,1))/REF(CLOSE,1),N);\nMAVPT:MA(VPT,M);"}},f.prototype.WVAD=function(){return{Name:"WVAD",Description:"威廉变异离散量",IsMainIndex:!1,Args:[{Name:"N",Value:24},{Name:"M",Value:6}],Script:"WVAD:SUM((CLOSE-OPEN)/(HIGH-LOW)*VOL,N)/10000;\nMAWVAD:MA(WVAD,M);"}},f.prototype.DBQR=function(){return{Name:"WVAD",Description:"对比强弱",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:60}],Script:"ZS:(INDEXC-REF(INDEXC,N))/REF(INDEXC,N);\nGG:(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMADBQR1:MA(GG,M1);\nMADBQR2:MA(GG,M2);\nMADBQR3:MA(GG,M3);"}},f.prototype.JS=function(){return{Name:"JS",Description:"加速线",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],Script:"JS:100*(CLOSE-REF(CLOSE,N))/(N*REF(CLOSE,N));\nMAJS1:MA(JS,M1);\nMAJS2:MA(JS,M2);\nMAJS3:MA(JS,M3);"}},f.prototype.CYE=function(){return{Name:"CYE",Description:"市场趋势",IsMainIndex:!1,Args:[],Script:"MAL:=MA(CLOSE,5);\nMAS:=MA(MA(CLOSE,20),5);\nCYEL:(MAL-REF(MAL,1))/REF(MAL,1)*100;\nCYES:(MAS-REF(MAS,1))/REF(MAS,1)*100;"}},f.prototype.QR=function(){return{Name:"QR",Description:"强弱指标",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"个股: (CLOSE-REF(CLOSE,N))/REF(CLOSE,N)*100; \n大盘: (INDEXC-REF(INDEXC,N))/REF(INDEXC,N)*100; \n强弱值:EMA(个股-大盘,2),COLORSTICK;"}},f.prototype.GDX=function(){return{Name:"GDX",Description:"轨道线",IsMainIndex:!1,Args:[{Name:"N",Value:30},{Name:"M",Value:9}],Script:"AA:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,N))/MA(CLOSE,N); \n轨道:DMA(CLOSE,AA);\n压力线:(1+M/100)*轨道; \n支撑线:(1-M/100)*轨道;"}},f.prototype.JLHB=function(){return{Name:"JLHB",Description:"绝路航标",IsMainIndex:!1,Args:[{Name:"N",Value:7},{Name:"M",Value:5}],Script:"VAR1:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*80; \nB:SMA(VAR1,N,1); \nVAR2:SMA(B,M,1); \n绝路航标:IF(CROSS(B,VAR2) AND B<40,50,0);"}},f.prototype.PCNT=function(){return{Name:"PCNT",Description:"幅度比",IsMainIndex:!1,Args:[{Name:"M",Value:5}],Script:"PCNT:(CLOSE-REF(CLOSE,1))/CLOSE*100;\nMAPCNT:EXPMEMA(PCNT,M);"}},f.prototype.BTX=function(){return{Name:"BTX",Description:"宝塔线",IsMainIndex:!1,Args:[],Script:"B1:=REF(C,1);\nB2:= REF(C, 2);\nSS:= IF(C > REF(C, 1) AND REF(C, 1) >= REF(C, 2), 1, IF(C < REF(C, 1) AND REF(C, 1) <= REF(C, 2), -1, IF(C > REF(C, 2) AND REF(C, 2) > REF(C, 1), 2, IF(C < REF(C, 2) AND REF(C, 2) < REF(C, 1), -2, 0))));\nSM:= IF(REF(SS, 1) <> 0, REF(SS, 1), IF(REF(SS, 2) <> 0, REF(SS, 2), IF(REF(SS, 3) <> 0, REF(SS, 3), IF(REF(SS, 5) <> 0, REF(SS, 5), IF(REF(SS, 6) <> 0, REF(SS, 6), IF(REF(SS, 7) <> 0, REF(SS, 7), 0))))));\nMC:= IF(REF(SS, 1) <> 0, B2, IF(SM > 0, MIN(B1, B2), MAX(B1, B2)));\nTOW1:= IF(C > REF(C, 1), C, REF(C, 1));\nTOW2:= IF((SS == -1 OR SS == -2) AND SM > 0, B2, TOW1);\nTOWER:= IF(TOW1 > TOW2, TOW1, TOW2);\nSTICKLINE(SS == 1 OR SM >= 1 AND SS == 0, B1, C, 10, 1), COLORRED;\nSTICKLINE(SS == -1 OR SM <= -1 AND SS == 0, B1, C, 10, 0), COLORCYAN;\nSTICKLINE(SS == 2, B2, C, 10, 1), COLORRED;\nSTICKLINE(SS == -2, B2, C, 10, 0), COLORCYAN;\nSTICKLINE((SS == -1 OR SS == -2) AND SM > 0, B2, B1, 10, 1), COLORRED;\nSTICKLINE((SS == 1 OR SS == 2) AND SM < 0, B2, B1, 10, 0), COLORCYAN;"}},f.prototype.AMO=function(){return{Name:"AMO",Description:"成交金额",IsMainIndex:!1,StringFormat:2,YAxis:{FloatPrecision:0,StringFormat:2},Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"AMOW:AMOUNT/10000.0,VOLSTICK;\nAMO1:MA(AMOW,M1);\nAMO2:MA(AMOW,M2);"}},f.prototype.VRSI=function(){return{Name:"VRSI",Description:"相对强弱量",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(VOL,1);\nRSI1:SMA(MAX(VOL-LC,0),N1,1)/SMA(ABS(VOL-LC),N1,1)*100;\nRSI2:SMA(MAX(VOL-LC,0),N2,1)/SMA(ABS(VOL-LC),N2,1)*100;\nRSI3:SMA(MAX(VOL-LC,0),N3,1)/SMA(ABS(VOL-LC),N3,1)*100;"}},f.prototype.HSCOL=function(){return{Name:"HSCOL",Description:"换手柱",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSCOL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100),VOLSTICK;\nMAHSL:MA(HSCOL,N);"}},f.prototype.DBQRV=function(){return{Name:"DBQRV",Description:"对比强弱量(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"ZS:(INDEXV-REF(INDEXV,N))/REF(INDEXV,N);\nGG:(VOL-REF(VOL,N))/REF(VOL,N);"}},f.prototype.DBLB=function(){return{Name:"DBLB",Description:"对比量比(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M",Value:5}],Script:"GG:=VOL/SUM(REF(VOL,1),N);\nZS:=INDEXV/SUM(REF(INDEXV,1),N);\nDBLB:GG/ZS;\nMADBLB:MA(DBLB,M);"}},f.prototype.ACD=function(){return{Name:"ACD",Description:"升降线",IsMainIndex:!1,Args:[{Name:"M",Value:20}],Script:"LC:=REF(CLOSE,1);\nDIF:=CLOSE-IF(CLOSE>LC,MIN(LOW,LC),MAX(HIGH,LC));\nACD:SUM(IF(CLOSE==LC,0,DIF),0);\nMAACD:EXPMEMA(ACD,M);"}},f.prototype.EXPMA=function(){return{Name:"EXPMA",Description:"指数平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"}},f.prototype.EXPMA_S=function(){return{Name:"EXPMA_S",Description:"指数平均线-副图",IsMainIndex:!1,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"}},f.prototype.HMA=function(){return{Name:"HMA",Description:"高价平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"HMA1:MA(HIGH,M1);\nHMA2:MA(HIGH,M2);\nHMA3:MA(HIGH,M3);\nHMA4:MA(HIGH,M4);\nHMA5:MA(HIGH,M5);"}},f.prototype.LMA=function(){return{Name:"LMA",Description:"低价平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"LMA1:MA(LOW,M1);\nLMA2:MA(LOW,M2);\nLMA3:MA(LOW,M3);\nLMA4:MA(LOW,M4);\nLMA5:MA(LOW,M5);"}},f.prototype.VMA=function(){return{Name:"VMA",Description:"变异平均线",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"VV:=(HIGH+OPEN+LOW+CLOSE)/4;\nVMA1:MA(VV,M1);\nVMA2:MA(VV,M2);\nVMA3:MA(VV,M3);\nVMA4:MA(VV,M4);\nVMA5:MA(VV,M5);"}},f.prototype.AMV=function(){return{Name:"AMV",Description:"成本价均线",IsMainIndex:!1,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"AMOV:=VOL*(OPEN+CLOSE)/2;\nAMV1:SUM(AMOV,M1)/SUM(VOL,M1);\nAMV2:SUM(AMOV,M2)/SUM(VOL,M2);\nAMV3:SUM(AMOV,M3)/SUM(VOL,M3);\nAMV4:SUM(AMOV,M4)/SUM(VOL,M4);"}},f.prototype.BBIBOLL=function(){return{Name:"BBIBOLL",Description:"多空布林线",IsMainIndex:!0,Args:[{Name:"N",Value:11},{Name:"M",Value:6}],Script:"CV:=CLOSE;\nBBIBOLL:(MA(CV,3)+MA(CV,6)+MA(CV,12)+MA(CV,24))/4;\nUPR:BBIBOLL+M*STD(BBIBOLL,N);\nDWN:BBIBOLL-M*STD(BBIBOLL,N);"}},f.prototype.ALLIGAT=function(){return{Name:"ALLIGAT",Description:"鳄鱼线",IsMainIndex:!0,Args:[],Script:"NN:=(H+L)/2;\n上唇:REF(MA(NN,5),3),COLOR40FF40;\n牙齿:REF(MA(NN,8),5),COLOR0000C0;\n下颚:REF(MA(NN,13),8),COLORFF4040;"}},f.prototype.GMMA=function(){return{Name:"GMMA",Description:"顾比均线",IsMainIndex:!0,Args:[],Script:"MA3:EMA(CLOSE,3),COLORC08080;\nMA5:EMA(CLOSE,5),COLORC08080;\nMA8:EMA(CLOSE,8),COLORC08080;\nMA10:EMA(CLOSE,10),COLORC08080;\nMA12:EMA(CLOSE,12),COLORC08080;\nMA15:EMA(CLOSE,15),COLORC08080;\nMA30:EMA(CLOSE,30),COLOR0080FF;\nMA35:EMA(CLOSE,35),COLOR0080FF;\nMA40:EMA(CLOSE,40),COLOR0080FF;\nMA45:EMA(CLOSE,45),COLOR0080FF;\nMA50:EMA(CLOSE,50),COLOR0080FF;\nMA60:EMA(CLOSE,60),COLOR0080FF;"}},f.prototype.ZX=function(){return{Name:"ZX",Description:"重心线",IsMainIndex:!1,Args:[],Script:"AV:0.01*AMOUNT/VOL;"}},f.prototype.XS=function(){return{Name:"XS",Description:"薛斯通道",IsMainIndex:!0,Args:[{Name:"N",Value:13}],Script:"VAR2:=CLOSE*VOL;\nVAR3:=EMA((EMA(VAR2,3)/EMA(VOL,3)+EMA(VAR2,6)/EMA(VOL,6)+EMA(VAR2,12)/EMA(VOL,12)+EMA(VAR2,24)/EMA(VOL,24))/4,N);\nSUP:1.06*VAR3;\nSDN:VAR3*0.94;\nVAR4:=EMA(CLOSE,9);\nLUP:EMA(VAR4*1.14,5);\nLDN:EMA(VAR4*0.86,5);"}},f.prototype.XS2=function(){return{Name:"XS2",Description:"薛斯通道II",IsMainIndex:!0,Args:[{Name:"N",Value:102},{Name:"M",Value:7}],Script:"AA:=MA((2*CLOSE+HIGH+LOW)/4,5); \n通道1:AA*N/100; \n通道2:AA*(200-N)/100; \nCC:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,20))/MA(CLOSE,20); \nDD:=DMA(CLOSE,CC); \n通道3:(1+M/100)*DD; \n通道4:(1-M/100)*DD;"}},f.prototype.SG_XDT=function(){return{Name:"SG-XDT",Description:"心电图(需下载日线)",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"QR:CLOSE/INDEXC*1000;\nMQR1:MA(QR,5);\nMQR2:MA(QR,10);"}},f.prototype.SG_SMX=function(){return{Name:"SG-SMX",Description:"生命线(需下载日线)",IsMainIndex:!1,Args:[{Name:"N",Value:50}],Script:"H1:=HHV(HIGH,N);\nL1:=LLV(LOW,N);\nH2:=HHV(INDEXH,N);\nL2:=LLV(INDEXL,N);\nZY:=CLOSE/INDEXC*2000;\nZY1:EMA(ZY,3);\nZY2:EMA(ZY,17);\nZY3:EMA(ZY,34);"}},f.prototype.SG_LB=function(){return{Name:"SG-LB",Description:"量比(需下载日线)",IsMainIndex:!1,Args:[],Script:"ZY2:=VOL/INDEXV*1000;\n量比:ZY2;\nMA5:MA(ZY2,5);\nMA10:MA(ZY2,10);"}},f.prototype.SG_PF=function(){return{Name:"SG-PF",Description:"强势股评分(需下载日线)",IsMainIndex:!1,Args:[],Script:"ZY1:=CLOSE/INDEXC*1000;\nA1:=IF(ZY1>HHV(ZY1,3),10,0);\nA2:=IF(ZY1>HHV(ZY1,5),15,0);\nA3:=IF(ZY1>HHV(ZY1,10),20,0);\nA4:=IF(ZY1>HHV(ZY1,2),10,0);\nA5:=COUNT(ZY1>REF(ZY1,1) ,9)*5;\n强势股评分:A1+A2+A3+A4+A5;"}},f.prototype.RAD=function(){return{Name:"RAD",Description:"威力雷达(需下载日线)",IsMainIndex:!1,Args:[{Name:"D",Value:3},{Name:"S",Value:30},{Name:"M",Value:30}],Script:"SM:=(OPEN+HIGH+CLOSE+LOW)/4;\nSMID:=MA(SM,D);\nIM:=(INDEXO+INDEXH+INDEXL+INDEXC)/4;\nIMID:=MA(IM,D);\nSI1:=(SMID-REF(SMID,1))/SMID;\nII:=(IMID-REF(IMID,1))/IMID;\nRADER1:SUM((SI1-II)*2,S)*1000;\nRADERMA:SMA(RADER1,M,1);"}},f.prototype.SHT=function(){return{Name:"SHT",Description:"龙系短线",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"VAR1:=MA((VOL-REF(VOL,1))/REF(VOL,1),5);\nVAR2:=(CLOSE-MA(CLOSE,24))/MA(CLOSE,24)*100;\nMY: VAR2*(1+VAR1);\nSHT: MY, COLORSTICK;\nSHTMA: MA(SHT,N);"}},f.prototype.ZLJC=function(){return{Name:"ZLJC",Description:"主力进出",IsMainIndex:!1,Args:[],Script:"VAR1:=(CLOSE+LOW+HIGH)/3; \nVAR2:=SUM(((VAR1-REF(LOW,1))-(HIGH-VAR1))*VOL/100000/(HIGH-LOW),0); \nVAR3:=EMA(VAR2,1); \nJCS:VAR3; \nJCM:MA(VAR3,12); \nJCL:MA(VAR3,26);"}},f.prototype.ZLMM=function(){return{Name:"ZLMM",Description:"主力买卖",IsMainIndex:!1,Args:[],Script:"LC :=REF(CLOSE,1);\nRSI2:=SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100;\nRSI3:=SMA(MAX(CLOSE-LC,0),18,1)/SMA(ABS(CLOSE-LC),18,1)*100;\nMMS:MA(3*RSI2-2*SMA(MAX(CLOSE-LC,0),16,1)/SMA(ABS(CLOSE-LC),16,1)*100,3);\nMMM:EMA(MMS,8);\nMML:MA(3*RSI3-2*SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100,5);"}},f.prototype.SLZT=function(){return{Name:"SLZT",Description:"神龙在天",IsMainIndex:!1,Args:[],Script:"白龙: MA(CLOSE,125);\n黄龙: 白龙+2*STD(CLOSE,170);\n紫龙: 白龙-2*STD(CLOSE,145);\n青龙: SAR(125,1,7), LINESTICK;\nVAR2:=HHV(HIGH,70);\nVAR3:=HHV(HIGH,20);\n红龙: VAR2*0.83;\n蓝龙: VAR3*0.91;"}},f.prototype.ADVOL=function(){return{Name:"ADVOL",Description:"龙系离散量",IsMainIndex:!1,Args:[],Script:"A:=SUM(((CLOSE-LOW)-(HIGH-CLOSE))*VOL/10000/(HIGH-LOW),0);\nADVOL:A;\nMA1:MA(A,30);\nMA2:MA(MA1,100);"}},f.prototype.CYC=function(){return{Name:"CYC",Description:"成本均线",IsMainIndex:!0,Args:[{Name:"P1",Value:5},{Name:"P2",Value:13},{Name:"P3",Value:34}],Script:"JJJ:=IF(DYNAINFO(8)>0.01,0.01*DYNAINFO(10)/DYNAINFO(8),DYNAINFO(3));\nDDD:=(DYNAINFO(5)<0.01 || DYNAINFO(6)<0.01);\nJJJT:=IF(DDD,1,(JJJ<(DYNAINFO(5)+0.01) && JJJ>(DYNAINFO(6)-0.01)));\nCYC1:IF(JJJT,0.01*EMA(AMOUNT,P1)/EMA(VOL,P1),EMA((HIGH+LOW+CLOSE)/3,P1));\nCYC2:IF(JJJT,0.01*EMA(AMOUNT,P2)/EMA(VOL,P2),EMA((HIGH+LOW+CLOSE)/3,P2));\nCYC3:IF(JJJT,0.01*EMA(AMOUNT,P3)/EMA(VOL,P3),EMA((HIGH+LOW+CLOSE)/3,P3));\nCYC4:IF(JJJT,DMA(AMOUNT/(100*VOL),100*VOL/FINANCE(7)),EMA((HIGH+LOW+CLOSE)/3,120));"}},f.prototype.CYS=function(){return{Name:"CYS",Description:"市场盈亏",IsMainIndex:!1,Args:[],Script:"CYC13:EMA(AMOUNT,13)/EMA(VOL,13);\nCYS:(CLOSE-CYC13)/CYC13*100;"}},f.prototype.CYQKL=function(){return{Name:"CYQKL",Description:"博弈K线长度",IsMainIndex:!1,Args:[],Script:"KL:100*(WINNER(CLOSE)-WINNER(OPEN));"}},f.prototype.SCR=function(){return{Name:"SCR",Description:"筹码集中度",IsMainIndex:!1,Args:[{Name:"P1",Value:90}],Script:"A:=P1+(100-P1)/2;\nB:=(100-P1)/2;\nCC:=COST(A);\nDD:=COST(B);\nSCR:(CC-DD)/(CC+DD)*100/2;"}},f.prototype.ASR=function(){return{Name:"ASR",Description:"浮筹比例",IsMainIndex:!1,Args:[],Script:"ASR:(WINNER(C*1.1)-WINNER(C*0.9))/WINNER(HHV(H,0))*100;"}},f.prototype.SAR=function(){return{Name:"SAR",Description:"抛物转向",IsMainIndex:!0,Args:[{Name:"P",Value:10},{Name:"STEP",Value:2},{Name:"MAXP",Value:20}],Script:"S:SAR(P,STEP,MAXP),UPDOWNDOT;"}},f.prototype.TJCJL=function(){return{Name:"太极成交量",Description:"太极成交量",IsMainIndex:!0,Args:[],Script:'总手:VOL,NODRAW;\nDRAWTEXT_FIX(ISLASTBAR,0,0,0,"说明: 红色柱为吸货量,绿色为出货量,黄色为天量,蓝色为地量"),COLORGRAY;\nZZ:=IF(REF(C,1)>REF(O,1) AND O>REF(C,1)*1.014 AND C<O*1.02,1,3);\nV5:=MA(V,5);\nV12:=MA(V,12);\nV34:=MA(V,34);\nC6:=MA(C,6);\nSTICKLINE(VOL,0,VOL,3,0),COLORLIGRAY;\nSTICKLINE(CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,0,VOL,3,0),COLORRED;\nSTICKLINE(CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,0,VOL,3,0),COLORGREEN;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05,0,VOL,3,0),COLORYELLOW;\nSTICKLINE(VOL<MA(VOL,5)/2 AND V<V12/2,0,VOL,3,0),COLORBLUE;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,VOL*0.5,0,3,0),COLORRED;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,VOL*0.5,0,3,0),COLORRED;'}},f.prototype.Dragon4_Main=function(){return{Name:"飞龙四式",Description:"飞龙四式",IsMainIndex:!0,Args:[{Name:"N1",Value:5},{Name:"N2",Value:10},{Name:"N3",Value:50},{Name:"N4",Value:60}],Script:"蜻蜓点水:=EMA(CLOSE,N1),COLORGRAY;\n魔界:=EMA(CLOSE,N2),COLORGREEN;\n水:=EMA(CLOSE,N3),COLORRED;\nDRAWKLINE(HIGH,OPEN,LOW,CLOSE);\n生命线:MA(CLOSE,N4),COLORBLUE,LINETHICK2;\nDRAWBAND(魔界,'RGB(186,225,250)',水,'RGB(253,194,124)');\nDRAWBAND(蜻蜓点水,'RGB(128,138,135)',魔界,'RGB(0,0,255)');"}},f.prototype.Dragon4_Fig=function(){return{Name:"飞龙四式",Description:"飞龙四式",IsMainIndex:!1,Args:[],Script:"倍:VOL>=REF(V,1)*1.90 AND C>REF(C,1),COLORYELLOW;\n低:VOL<REF(LLV(VOL,13),1),COLORGREEN;\n地:VOL<REF(LLV(VOL,100),1),COLORMAGENTA; \n平:=ABS(VOL-HHV(REF(VOL,1),5))/HHV(REF(VOL,1),5)<=0.03 OR ABS(VOL-REF(VOL,1))/REF(VOL,1)<=0.03,NODRAW,COLORWHITE;\n倍缩:VOL<=REF(V,1)*0.5,COLORFF8000;\n梯量:COUNT(V>REF(V,1),3)==3 AND COUNT(C>O,3)==3,COLORBROWN;\n缩量涨:COUNT(C>REF(C,1),2)==2 AND COUNT(V<REF(V,1),2)==2,COLORBLUE;\nSTICKLINE(C>=REF(C,1),V,0,2,0),COLORRED;\nSTICKLINE(C<REF(C,1),V,0,2,0),COLORGREEN;\nSTICKLINE(倍,0,V,2,0),COLORYELLOW;\nSTICKLINE(低,0,V,2,0),COLORGREEN;\nSTICKLINE(地,0,V,2,0),COLORLIMAGENTA;\nSTICKLINE(平,0,V,2,0),COLORGRAY;\nSTICKLINE(倍缩,0,V,2,0),COLORFF8000;\nSTICKLINE(梯量,0,V,2,0),COLORBROWN;\nSTICKLINE(缩量涨,0,V,2,0),COLORBLUE;"}},f.prototype.FundsAnalysis=function(){return{Name:"资金分析",Description:"资金分析",IsMainIndex:!1,Args:[{Name:"M",Value:55},{Name:"N",Value:34}],Script:"LC:=REF(CLOSE,1);\nRSI:=((SMA(MAX((CLOSE - LC),0),3,1) / SMA(ABS((CLOSE - LC)),3,1)) * 100);\nFF:=EMA(CLOSE,3);\nMA15:=EMA(CLOSE,21); DRAWTEXT(CROSS(85,RSI),75,'▼'),COLORGREEN;\nVAR1:=IF(YEAR>=2038 AND MONTH>=1,0,1);\nVAR2:=REF(LOW,1)*VAR1;\nVAR3:=SMA(ABS(LOW-VAR2),3,1)/SMA(MAX(LOW-VAR2,0),3,1)*100*VAR1;\nVAR4:=EMA(IF(CLOSE*1.3,VAR3*10,VAR3/10),3)*VAR1;\nVAR5:=LLV(LOW,30)*VAR1;\nVAR6:=HHV(VAR4,30)*VAR1;\nVAR7:=IF(MA(CLOSE,58),1,0)*VAR1;\nVAR8:=EMA(IF(LOW<=VAR5,(VAR4+VAR6*2)/2,0),3)/618*VAR7*VAR1;\n吸筹A:IF(VAR8>100,100,VAR8)*VAR1,COLORFB2F3B;\n{吸筹B}STICKLINE(吸筹A>-150,0,吸筹A,8,0),COLORFB2F3B;\n\n散户线: 100*(HHV(HIGH,M)-CLOSE)/(HHV(HIGH,M)-LLV(LOW,M)),COLORAA89BD,LINETHICK2;\nRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,3,1);\nD:=SMA(K,3,1);\nJ:=3*K-2*D;\n主力线:EMA(J,5),COLORF39800,LINETHICK2;\nDRAWICON(CROSS(主力线,散户线),主力线,1);\nDRAWICON(CROSS(散户线,主力线),主力线,2);"}},f.prototype.MarginProportion=function(){var t={Name:"融资占比(%)",Description:"融资占比",IsMainIndex:!1,Condition:{Period:[C.KLINE_DAY_ID]},Args:[],Script:"占比:MARGIN(2);"};return t},f.prototype.Margin2=function(){var t={Name:"两融余额",Description:"融资融券余额",IsMainIndex:!1,Condition:{Period:[C.KLINE_DAY_ID]},Args:[{Name:"N",Value:5}],Script:"T1:MARGIN(1);\n        T2:MA(MARGIN(1),N);"};return t},f.prototype.Margin3=function(){var t={Name:"两融余额",Description:"融资融券余额",IsMainIndex:!1,Condition:{Period:[C.KLINE_DAY_ID]},Args:[{Name:"N",Value:5}],Script:"T1:=MARGIN(1);\n        T2:=MA(MARGIN(1),N);\n        STICKLINE(T1-T2>=0,0,T1-T2,50,T1>T2),COLORRED;\n        STICKLINE(T1-T2<0,T1-T2,0,50,T1>T2),COLORGREEN;"};return t},f.prototype.FXG_BSPoint=function(){return{Name:"操盘BS点",Description:"操盘BS点",IsMainIndex:!0,Args:[],Script:"MA5:MA(CLOSE,5);\n        MA13:MA(CLOSE,13);\n        MA21:MA(CLOSE,21);\n        MA34:MA(CLOSE,34);\n        {MA55:MA(CLOSE,55),COLOR0000FF;}\n        {MA120:=MA(CLOSE,120),COLORFFFF00;}\n        天使:=EMA(C,2),COLOR000000;\n        魔鬼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\n        买:=CROSS(天使,魔鬼);\n        卖:=CROSS(魔鬼,天使);\n        DRAWICON(买,L*0.97,13);\n        DRAWICON(卖,H*1.03,14);\n        DRAWKLINE_IF(天使>=魔鬼,HIGH,CLOSE,LOW,OPEN),COLORRED;\n        DRAWKLINE_IF(天使<魔鬼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n        DRAWKLINE_IF(CROSS(天使,魔鬼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\n        DRAWKLINE_IF(CROSS(魔鬼,天使),HIGH,CLOSE,LOW,OPEN),COLORBLACK;"}},f.prototype.FXG_INDEX=function(){return{Name:"涨停多空线",Description:"涨停多空线",IsMainIndex:!1,Args:[],Script:"做多能量线: SMA((CLOSE-LLV(LOW,9))/(HHV(HIGH,9)-LLV(LOW,9))*100,5,1)-8,COLORRED,LINETHICK3;\n做空能量线: SMA((HHV(HIGH,36)-CLOSE)/(HHV(HIGH,36)-LLV(LOW,36))*100,2,1),COLORGREEN,LINETHICK3;\n20,POINTDOT,COLORF00FF0;\n50,POINTDOT,COLORGREEN;\n80,POINTDOT,COLORLIBLUE;"}},f.prototype.FXG_INDEX2=function(){return{Name:"涨停吸筹区",Description:"涨停吸筹区",IsMainIndex:!1,Args:[],Script:"VAR0:=EMA(HHV(HIGH,500),21); \nVAR1:=EMA(HHV(HIGH,250),21);\nVAR2:=EMA(HHV(HIGH,90),21); \nVAR3:=EMA(LLV(LOW,500),21); \nVAR4:=EMA(LLV(LOW,250),21); \nVAR5:=EMA(LLV(LOW,90),21);\n\nVAR6:=EMA((VAR3*0.96+VAR4*0.96+VAR5*0.96+VAR0*0.558+VAR1*0.558+VAR2*0.558)/6,21); \nVAR7:=EMA((VAR3*1.25+VAR4*1.23+VAR5*1.2+VAR0*0.55+VAR1*0.55+VAR2*0.65)/6,21); \nVAR8:=EMA((VAR3*1.3+VAR4*1.3+VAR5*1.3+VAR0*0.68+VAR1*0.68+VAR2*0.68)/6,21); \nVAR9:=EMA((VAR6*3+VAR7*2+VAR8)/6*1.738,21); \nVAR10:=REF(LOW,1); \nVAR11:=SMA(ABS(LOW-VAR10),3,1)/SMA(MAX(LOW-VAR10,0),3,1)*100; \nVAR12:=EMA(IFF(CLOSE*1.35<=VAR9,VAR11*10,VAR11/10),3); \nVAR13:=LLV(LOW,30); \nVAR14:=HHV(VAR12,30); \nVAR15:=IFF(MA(CLOSE,58),1,0); \nVAR16:=EMA(IFF(LOW<=VAR13,(VAR12+VAR14*2)/2,0),3)/618*VAR15;\n\n资金入场:IFF(VAR16>0,VAR16,0),LINETHICK,LINETHICK2, COLORFF0000; \n\nA1:IFF(资金入场>0,资金入场*1.2,0),STICK,LINETHICK5, COLORFF0000;\nA2:IFF(资金入场>0,资金入场*0.8,0),STICK,LINETHICK5, COLORFF6600;\nA3:IFF(资金入场>0,资金入场*0.6,0),STICK,LINETHICK5, COLORFF9900;\nA4:IFF(资金入场>0,资金入场*0.4,0) ,STICK,LINETHICK5,COLORFFCC00;\nA5:IFF(资金入场>0,资金入场*0.2,0) ,STICK,LINETHICK5,COLORFFFF00;"}},f.prototype.FXG_INDEX3=function(){return{Name:"量能黄金点",Description:"量能黄金点",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"A:=IFF((CLOSE>126.32),VOL,VOL); \n主力:=MA(A,4),COLORRED;\n游资:=MA(A,8),COLORYELLOW;\n大户:=MA(A,16),COLORF0F000;\n散户:=MA(A,32),COLOR00FF00;\n主比:=ABS(((主力)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORRED;\n游比:=ABS(((游资)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORYELLOW;\n大比:=ABS(((大户)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLORF0F000;\n散比:=ABS(((散户)/(主力 + 游资 + 大户 + 散户))*(100)),LINESTICK,COLOR00FF00;\n警戒线:MA(A,180),COLORFF66FF;\nSTICKLINE((主力 > 0),0,主力,2.5,0),COLOR1020BB;\nSTICKLINE((主力 > 0),0,主力,0.7,0),COLORRED;\nSTICKLINE((游资 > 0),0,游资,2.5,0),COLOR009CFF;\nSTICKLINE((游资 > 0),0,游资,0.7,0),COLORYELLOW;\nSTICKLINE((大户 > 0),0,大户,2.5,0),COLORFF8800;\nSTICKLINE((大户 > 0),0,大户,0.7,0),COLORLIBLUE;\nSTICKLINE((散户 > 0),0,散户,2.5,0),COLOR00CA00;\nSTICKLINE((散户 > 0),0,散户,0.7,0),COLORGREEN;"}},f.prototype.NewsNegative=function(){return{Name:"负面新闻",Description:"负面新闻统计",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"负面:NEWS(1);\nMA1:MA(负面,N);\nMA2:MA(负面,N2);"}},f.prototype.UpDownAnalyze=function(){var t={Name:"涨跌趋势",Description:"涨跌趋势",IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[C.MINUTE_ID,C.MULTIDAY_MINUTE_ID,C.KLINE_DAY_ID]},Args:[],Script:"上涨家数:UPCOUNT('CNA.CI'),COLORRED;\n下跌家数:DOWNCOUNT('CNA.CI'),COLORGREEN;"};return t},f.prototype.HK2SHSZ=function(){var t={Name:"北上资金",Description:"北上资金",IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[C.MINUTE_ID,C.MULTIDAY_MINUTE_ID,C.KLINE_DAY_ID]},Args:[],Script:"净流入:HK2SHSZ(1),COLORSTICK;"};return t},f.prototype.ShareHolder=function(){var t={Name:"股东人数",Description:"股东人数",IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[C.KLINE_DAY_ID,C.KLINE_MONTH_ID,C.KLINE_WEEK_ID,C.KLINE_YEAR_ID]},Args:[],Script:"人数:FINANCE(100);"};return t},f.prototype.VOLRate=function(){var t={Name:"量比",Description:"量比",IsMainIndex:!1,Condition:{Period:[C.MINUTE_ID,C.MULTIDAY_MINUTE_ID]},Args:[],Script:"LIANGBI:VOLR;"};return t},f.prototype.COLOR_KSTAR1=function(){return{Name:"十字星",Description:"十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH>LOW;"}},f.prototype.COLOR_KSTAR2=function(){return{Name:"早晨之星",Description:"早晨之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:(REF(CLOSE,2)/REF(OPEN,2)<0.95) && (REF(OPEN,1) < REF(CLOSE,2)) && (ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03) && CLOSE/OPEN>1.05 && CLOSE>REF(CLOSE,2);"}},f.prototype.COLOR_KSTAR3=function(){return{Name:"黄昏之星",Description:"黄昏之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05 && REF(OPEN,1)>REF(CLOSE,2) && ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03 && CLOSE/OPEN<0.95 && CLOSE<REF(CLOSE,2);"}},f.prototype.COLOR_SHI1=function(){return{Name:"长十字",Description:"长十字",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH/LOW>1.03;"}},f.prototype.COLOR_K220=function(){return{Name:"身怀六甲",Description:"身怀六甲",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1)>0.04&&\n            ABS(CLOSE-OPEN)/CLOSE<0.005&&\n            MAX(CLOSE,OPEN)<MAX(REF(CLOSE,1),REF(OPEN,1))&&\n            MIN(CLOSE,OPEN)>MIN(REF(CLOSE,1),REF(OPEN,1));"}},f.prototype.COLOR_K300=function(){return{Name:"三个白武士",Description:"三个白武士",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:UPNDAY(CLOSE,3)&&NDAY(CLOSE,OPEN,3);"}},f.prototype.COLOR_K310=function(){return{Name:"三只乌鸦",Description:"三只乌鸦",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:DOWNNDAY(CLOSE,3)&&NDAY(OPEN,CLOSE,3);"}},f.prototype.COLOR_K380=function(){return{Name:"光头阳线",Description:"光头阳线",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:HIGH==CLOSE&&HIGH>LOW;"}},f.prototype.COLOR_K390=function(){return{Name:"光脚阴线",Description:"光脚阴线",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:LOW==CLOSE&&HIGH>LOW;"}},f.prototype.COLOR_K134=function(){return{Name:"垂死十字",Description:"垂死十字",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&CLOSE==LOW&&CLOSE<HIGH;"}},f.prototype.COLOR_K140=function(){return{Name:"早晨十字星",Description:"早晨十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)<0.95&&\nREF(OPEN,1)<REF(CLOSE,2)&&\nREF(OPEN,1)==REF(CLOSE,1)&&\nCLOSE/OPEN>1.05&&CLOSE>REF(CLOSE,2);"}},f.prototype.COLOR_K150=function(){return{Name:"黄昏十字星",Description:"黄昏十字星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05&&\nREF(OPEN,1)>REF(CLOSE,2)&&\nREF(OPEN,1)=REF(CLOSE,1)&&\nCLOSE/OPEN<0.95&&CLOSE<REF(CLOSE,2);"}},f.prototype.COLOR_K160=function(){return{Name:"射击之星",Description:"射击之星",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE>MA(CLOSE,5);"}},f.prototype.COLOR_K165=function(){return{Name:"倒转锤头",Description:"倒转锤头",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE<MA(CLOSE,5);"}},f.prototype.COLOR_K170=function(){return{Name:"锤头",Description:"锤头",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE<MA(CLOSE,5);"}},f.prototype.COLOR_K180=function(){return{Name:"吊颈",Description:"吊颈",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE>MA(CLOSE,5);"}},f.prototype.COLOR_K190=function(){return{Name:"穿头破脚",Description:"穿头破脚",IsMainIndex:!0,InstructionType:2,Script:"OUT:(REF(CLOSE,1)/REF(OPEN,1)>1.03&&\nCLOSE/OPEN<0.96&&\nCLOSE<REF(OPEN,1)&&OPEN>REF(CLOSE,1))||\n(REF(CLOSE,1)/REF(OPEN,1)<0.97&&\nCLOSE/OPEN>1.04&&\nCLOSE>REF(OPEN,1)&&OPEN<REF(CLOSE,1));"}},f.prototype.COLOR_SWORD=function(){return{Name:"剑",Description:"剑",IsMainIndex:!0,InstructionType:2,Script:"AA:=VOL>REF(VOL,1)||VOL>(CAPITAL*0.1);\nBB:=OPEN>=(REF(HIGH,1))&&REF(HIGH,1)>(REF(HIGH,2)*1.06);\nCC:=CLOSE>(REF(CLOSE,1))-(REF(CLOSE,1)*0.01);\nDD:=CLOSE<(HIGH*0.965) && HIGH>(OPEN*1.05);\nEE:=LOW<OPEN && LOW<CLOSE&&HIGH>(REF(CLOSE,1)*1.06);\nFF:=(HIGH-(MAX(OPEN,CLOSE)))/2>(MIN(OPEN,CLOSE))-LOW;\nGG:=(ABS(OPEN-CLOSE))/2<(MIN(OPEN,CLOSE)-LOW);\nSWORDO:AA&&BB&&CC&&DD&&EE&&FF&&GG;"}},f.prototype.COLOR_CSFR=function(){return{Name:"出水芙蓉",Description:"出水芙蓉",IsMainIndex:!0,InstructionType:2,Script:"A:=CLOSE>OPEN;\nB:=A&&CLOSE>MA(CLOSE,S)&&CLOSE>MA(CLOSE,M)&&CLOSE>MA(CLOSE,LL);\nCC:=B&&OPEN<MA(CLOSE,M)&&OPEN<MA(CLOSE,LL);\nCSFRO:CC&&(CLOSE-OPEN)>0.0618*CLOSE;"}},f.prototype.COLOR_WYGD=function(){return{Name:"乌云盖顶",Description:"乌云盖顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)>1.03 AND \nCLOSE/OPEN<0.97 AND \nOPEN>REF(CLOSE,1) AND CLOSE<REF(CLOSE,1), 3);"}},f.prototype.COLOR_SGCJ=function(){return{Name:"曙光初现",Description:"曙光初现",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)<0.97 AND \nCLOSE/OPEN>1.03 AND \nOPEN<REF(CLOSE,1) AND CLOSE>REF(CLOSE,1), 3);"}},f.prototype.COLOR_SZTAI=function(){return{Name:"十字胎",Description:"十字胎",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1) > 0.04 AND \nCLOSE==OPEN AND CLOSE < MAX(REF(CLOSE,1),REF(OPEN,1)) AND \nCLOSE > MIN(REF(CLOSE,1),REF(OPEN,1)), 2);"}},f.prototype.COLOR_PINGDING=function(){return{Name:"平顶",Description:"平顶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET(ABS(HIGH-REF(HIGH,1))/HIGH<0.001,2);"}},f.prototype.COLOR_PINGDI=function(){return{Name:"平底",Description:"平底",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET((ABS(LOW-REF(LOW,1))/LOW<0.001 AND \nABS(REF(LOW,1)-REF(LOW,2))/REF(LOW,1)<=0.001),2);"}},f.prototype.COLOR_DAYANZHU=function(){return{Name:"大阳烛",Description:"大阳烛",IsMainIndex:!0,InstructionType:2,Script:"VAR1:CLOSE/OPEN>1.05 AND HIGH/LOW < CLOSE/OPEN+0.018;"}},f.prototype.COLOR_DAYINGZHU=function(){return{Name:"大阴烛",Description:"大阴烛",IsMainIndex:!0,InstructionType:2,Script:"VAR1:OPEN/CLOSE > 1.05 AND HIGH/LOW < OPEN/CLOSE+0.018;"}},f.prototype.COLOR_HYFG=function(){return{Name:"好友反攻",Description:"好友反攻",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( (REF(CLOSE,1)<REF(OPEN,1) AND \nCLOSE>OPEN AND ABS(CLOSE-REF(CLOSE,1))/CLOSE<0.002),2);"}},f.prototype.COLOR_TKQK=function(){return{Name:"跳空缺口",Description:"跳空缺口",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( HIGH<REF(LOW,1) OR LOW>REF(HIGH,1),2);"}},f.prototype.COLOR_SFWY=function(){return{Name:"双飞乌鸦",Description:"双飞乌鸦",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( REF(CLOSE,1)<REF(OPEN,1) AND CLOSE<OPEN AND CLOSE/OPEN<0.98,1);"}},f.prototype.COLOR_SSSBQ=function(){return{Name:"上升三部曲",Description:"上升三部曲",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)>1.03 AND \nREF(CLOSE,3)<REF(OPEN,3) AND \nREF(CLOSE,2)<REF(OPEN,2) AND \nREF(CLOSE,1)<REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN>1.03 AND \nCLOSE>REF(CLOSE,4), 5);"}},f.prototype.COLOR_XDSBQ=function(){return{Name:"下跌三部曲",Description:"下跌三部曲",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)<0.97 AND \nREF(CLOSE,3)>REF(OPEN,3) AND \nREF(CLOSE,2)>REF(OPEN,2) AND \nREF(CLOSE,1)>REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN<0.97 AND \nCLOSE<REF(CLOSE,4), 5);"}},f.prototype.COLOR_CHXY=function(){return{Name:"长下影",Description:"长下影",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(MIN(CLOSE,OPEN)-LOW)/(HIGH-LOW)>0.667;"}},f.prototype.COLOR_CHSY=function(){return{Name:"长上影",Description:"长上影",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(HIGH-MAX(CLOSE,OPEN))/(HIGH-LOW)>0.667,COLORBLUE;"}},f.prototype.COLOR_FENLI=function(){return{Name:"分离",Description:"分离",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( OPEN==REF(OPEN,1) AND (CLOSE-OPEN)*(REF(CLOSE,1)-REF(OPEN,1))<0,2);"}},f.prototype.TRADE_BIAS=function(){return{Name:"BIAS",Description:"乖离率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:6},{Name:"LH",Value:6}],Script:"BIAS:=(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nENTERLONG:CROSS(-LL,BIAS);\nEXITLONG:CROSS(BIAS,LH);"}},f.prototype.TRADE_CCI=function(){return{Name:"CCI",Description:"CCI专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:=(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));\nINDEX:=CCI;\nENTERLONG:CROSS(INDEX,-100);\nEXITLONG:CROSS(100,INDEX);"}},f.prototype.TRADE_DMI=function(){return{Name:"DMI",Description:"趋向专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"MTR:=SUM(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(LOW-REF(CLOSE,1))),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nPDM:=SUM(IF(HD>0&&HD>LD,HD,0),N);\nMDM:=SUM(IF(LD>0&&LD>HD,LD,0),N);\nPDI:=PDM*100/MTR;\nMDI:=MDM*100/MTR;\nENTERLONG:CROSS(PDI,MDI);\nEXITLONG:CROSS(MDI,PDI);"}},f.prototype.TRADE_KD=function(){return{Name:"KD",Description:"KD指标专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"WRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nWK:=SMA(WRSV,M1,1);\nD:=SMA(WK,M2,1);\nENTERLONG:CROSS(WK,D)&&WK<20;\nEXITLONG:CROSS(D,WK)&&WK>80;"}},f.prototype.TRADE_BOLL=function(){return{Name:"BOLL",Description:"布林带专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:20}],Script:"MID :=MA(CLOSE,N);\nUPPER:=MID+2*STD(CLOSE,N);\nLOWER:=MID-2*STD(CLOSE,N);\nENTERLONG:CROSS(CLOSE,LOWER);\nEXITLONG:CROSS(CLOSE,UPPER);"}},f.prototype.TRADE_KDJ=function(){return{Name:"KDJ",Description:"KDJ专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,M1,1);\nD:=SMA(K,M1,1);\nJ:=3*K-2*D;\nENTERLONG:CROSS(J,0);\nEXITLONG:CROSS(100,J);"}},f.prototype.TRADE_MA=function(){return{Name:"MA",Description:"均线专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"SHORT",Value:5},{Name:"LONG",Value:20}],Script:"ENTERLONG:CROSS(MA(CLOSE,SHORT),MA(CLOSE,LONG));\nEXITLONG:CROSS(MA(CLOSE,LONG),MA(CLOSE,SHORT));"}},f.prototype.TRADE_MACD=function(){return{Name:"MACD",Description:"MACD专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"LONG",Value:26},{Name:"SHORT",Value:12},{Name:"M",Value:9}],Script:"DIFF:=EMA(CLOSE,SHORT) - EMA(CLOSE,LONG);\nDEA  := EMA(DIFF,M);\nMACD := 2*(DIFF-DEA);\nENTERLONG:CROSS(MACD,0);\nEXITLONG:CROSS(0,MACD);"}},f.prototype.TRADE_MTM=function(){return{Name:"MTM",Description:"动力指标专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6}],Script:"WMTM:=C-REF(C,N);\nENTERLONG:CROSS(WMTM,0);\nEXITLONG:CROSS(0,WMTM);"}},f.prototype.TRADE_PSY=function(){return{Name:"PSY",Description:"PSY心理线专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:10},{Name:"LH",Value:85}],Script:"MYPSY:=COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\nENTERLONG:CROSS(LL,MYPSY);\nEXITLONG:CROSS(MYPSY,LH);"}},f.prototype.TRADE_ROC=function(){return{Name:"ROC",Description:"变动速率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"WROC:=MA(100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N),M);\nENTERLONG:CROSS(WROC,0);\nEXITLONG:CROSS(0,WROC);"}},f.prototype.TRADE_RSI=function(){return{Name:"RSI",Description:"相对强弱专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6},{Name:"LL",Value:20},{Name:"LH",Value:80}],Script:"LC:=REF(CLOSE,1);\nWRSI:=SMA(MAX(CLOSE-LC,0),N,1)/SMA(ABS(CLOSE-LC),N,1)*100;\nENTERLONG:CROSS(WRSI,LL);\nEXITLONG:CROSS(LH,WRSI);"}},f.prototype.TRADE_VR=function(){return{Name:"VR",Description:"VR容量比率专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:26},{Name:"LL",Value:70},{Name:"LH",Value:250}],Script:"WVR := SUM((IF(CLOSE>OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)/SUM((IF(CLOSE<OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)*100;\nENTERLONG:CROSS(LL,WVR);\nEXITLONG:CROSS(WVR,LH);"}},f.prototype.TRADE_DPSJ=function(){return{Name:"DPSJ",Description:"大盘随机专家系统",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N1",Value:18},{Name:"N2",Value:12}],Script:"RSV:=(INDEXC-LLV(INDEXL,N1))/(HHV(INDEXH,N1)-LLV(INDEXL,N1))*100;\nK:=SMA(RSV,N2,1);\nHSL:VOL/100/(FINANCE(7));\nENTERLONG: CROSS(K,20);\nEXITLONG: (CROSS(HSL,5) OR CROSS(K,80));"}},f.prototype.HeikinAshi=function(){return{Name:"平均K线",Description:"Heikin-Ashi 平均K线",IsMainIndex:!0,KLineType:-1,Args:[],Script:"HCLOSE:(OPEN+HIGH+LOW+CLOSE)/4, NODRAW;\nHOPEN:(REF(OPEN,1)+REF(CLOSE,1))/2,NODRAW;\nHHIGH:MAX(HIGH,MAX(HOPEN,HCLOSE)),NODRAW;\nHLOW:MIN(LOW,MIN(HOPEN,HCLOSE)),NODRAW;\nDRAWKLINE(HHIGH,HOPEN,HLOW,HCLOSE);"}},f.prototype.ADL=function(){var t={Name:"腾落指标",Description:"腾落指标",IsMainIndex:!1,StringFormat:2,Condition:{Period:[C.KLINE_DAY_ID,C.KLINE_WEEK_ID,C.KLINE_TWOWEEK_ID,C.KLINE_MONTH_ID,C.KLINE_QUARTER_ID,C.KLINE_YEAR_ID],Include:["000001.SH","000003.SH","000016.SH","000300.SH","000905.SH","399001.SZ"," 399005.SZ","399006.SZ"]},Args:[{Name:"M",Value:7}],Script:"ADL:SUM(ADVANCE-DECLINE,0);\nMAADL:MA(ADL,M);"};return t},f.prototype.EMPTY=function(){return{Name:"",Description:"空指标",IsMainIndex:!0,Args:[],Script:"VAR2:=C;"}},f.prototype.CJL=function(){return{Name:"CJL",Description:"期货持仓量",IsMainIndex:!1,Args:[],Script:"成交量:VOL,VOLSTICK;\n持仓量:VOLINSTK,LINEOVERLAY;"}},f.prototype.VOL_POSITION=function(){return{Name:"持仓量",Description:"持仓量",IsMainIndex:!1,Args:[],Script:"成交量:VOL,VOLSTICK;\n持仓量:VOLINSTK,SINGLELINE;"}},f.prototype.ASI=function(){return{Name:"ASI",Description:"振动升降指标",IsMainIndex:!1,Args:[{Name:"N1",Value:6}],Script:"X_1:=REF(CLOSE,1);\nX_2:=ABS(HIGH-X_1);\nX_3:=ABS(LOW-X_1);\nX_4:=ABS(HIGH-REF(LOW,1));\nX_5:=ABS(X_1-REF(OPEN,1));\nX_6:=IF(X_2>X_3 AND X_2>X_4,X_2+X_3/2+X_5/4,IF(X_3>X_4 AND X_3>X_2,X_3+X_2/2+X_5/4,X_4+X_5/4));\nX_7:=CLOSE-X_1+(CLOSE-OPEN)/2+X_1-REF(OPEN,1);\nX_8:=8*X_7/X_6*MAX(X_2,X_3);\nASI:SUM(X_8,0),LINETHICK2;\nMASI:MA(ASI,N1),LINETHICK2;"}},f.prototype.DC=function(){return{Name:"DC",Description:"唐奇安通道",IsMainIndex:!0,Args:[{Name:"N1",Value:20}],Script:"UPPER:HHV(H,N1),COLORBLUE,LINETHICK2;\nLOWER:LLV(L,N1),COLORBLUE,LINETHICK2;\nMIDDLE:(UPPER+LOWER)/2,COLORRED,LINETHICK3;"}},f.prototype.DEMA=function(){return{Name:"DEMA",Description:"双重指数移动均线",IsMainIndex:!0,Args:[{Name:"N1",Value:10}],Script:"ERR:=C-EMA(C,N1);\nDEMA:EMA(C,10)+EMA(ERR,N1);"}},f.prototype.VWAP=function(){return{Name:"VWAP",Description:"成交量加权平均价",IsMainIndex:!0,Args:[{Name:"N1",Value:10}],Script:"PRICE:=(H+L+C)/3;\nT2:=VOL*PRICE;\nVWAP:SUM(T2,0)/SUM(VOL,0);"}},f.prototype.SQJZ=function(){return{Name:"SQJZ",Description:"神奇九转",IsMainIndex:!0,Script:"B:=C<REF(C,4);\nN:=CURRBARSCOUNT;\nB1:=(N=6 AND REFXV(COUNT(B,6),5)=6) OR (N=7 AND REFXV(COUNT(B,7),6)=7) OR (N=8 AND REFXV(COUNT(B,8),7)=8) OR (N>=9 AND REFXV(COUNT(B,9),8)=9);\nDRAWNUMBER(B1 AND REF(B,1)=0,L,1),COLORMAGENTA;\nB2:=(N=5 AND REFXV(COUNT(B,6),4)=6) OR (N=6 AND REFXV(COUNT(B,7),5)=7) OR (N=7 AND REFXV(COUNT(B,8),6)=8) OR (N>=8 AND REFXV(COUNT(B,9),7)=9);\nDRAWNUMBER(B2 AND REF(B,2)=0,L,2),COLORMAGENTA;\nB8:=(N=1 AND COUNT(B,8)=8) OR (N>=2 AND REFXV(COUNT(B,9),1)=9);\nDRAWNUMBER(B8 AND REF(B,8)=0,L,8),COLORMAGENTA;\nB9:=(N>=1 AND COUNT(B,9)=9);\nDRAWNUMBER(B9 AND REF(B,9)=0,L,9),COLORBROWN;\nS:=C>REF(C,4);\nS1:=(N=6 AND REFXV(COUNT(S,6),5)=6) OR (N=7 AND REFXV(COUNT(S,7),6)=7) OR (N=8 AND REFXV(COUNT(S,8),7)=8) OR (N>=9 AND REFXV(COUNT(S,9),8)=9);\nDRAWNUMBER(S1 AND REF(S,1)=0,H,1),COLORMAGENTA,DRAWABOVE;\nS2:=(N=5 AND REFXV(COUNT(S,6),4)=6) OR (N=6 AND REFXV(COUNT(S,7),5)=7) OR (N=7 AND REFXV(COUNT(S,8),6)=8) OR (N>=8 AND REFXV(COUNT(S,9),7)=9);\nDRAWNUMBER(S2 AND REF(S,2)=0,H,2),COLORMAGENTA,DRAWABOVE;\nS8:=(N=1 AND COUNT(S,8)=8) OR (N>=2 AND REFXV(COUNT(S,9),1)=9);\nDRAWNUMBER(S8 AND REF(S,8)=0,H,8),COLORMAGENTA,DRAWABOVE;\nS9:=(N>=1 AND COUNT(S,9)=9);\nDRAWNUMBER(S9 AND REF(S,9)=0,H,9),COLORGREEN,DRAWABOVE;"}},f.prototype.XT=function(){return{Name:"XT",Description:"箱体",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"【箱顶】:PEAK(CLOSE,N,1)*0.98;\n【箱底】:TROUGH(CLOSE,N,1)*1.02;\n【箱高】:100*(【箱顶】-【箱底】)/【箱底】,NODRAW;"}},f.prototype.CFJT=function(){return{Name:"CFJT",Description:"财富阶梯",IsMainIndex:!0,Script:"突破:=REF(EMA(C,14),1);\nA1X:=(EMA(C,10)-突破)/突破*100;\n多方:=IF(A1X>=0,REF(EMA(C,10),BARSLAST(CROSS(A1X,0))+1),DRAWNULL);\n空方:=IF(A1X<0,REF(EMA(C,10),BARSLAST(CROSS(0,A1X))+1),DRAWNULL);\nSTICKLINE(A1X>=0,多方,突破,110,0),COLORRED;\nSTICKLINE(A1X<0,空方,突破,110,0),COLORGREEN;"}},f.prototype.CYX=function(){return{Name:"CYX",Description:"撑压线",IsMainIndex:!0,Args:[{Name:"N",Value:7}],Script:"Z1:=STRCAT(HYBLOCK,' ');\nZ2:=STRCAT(Z1,DYBLOCK);\nZ3:=STRCAT(Z2,' ');\nDRAWTEXT_FIX(ISLASTBAR,0,0,0,STRCAT(Z3,GNBLOCK)),COLOR00C0C0;\nA1:=REF(H,N)=HHV(H,2*N+1);\nB1:=FILTER(A1,N);\nC1:=BACKSET(B1,N+1);\nD1:=FILTER(C1,N);\nA2:=REF(L,N)=LLV(L,2*N+1);\nB2:=FILTER(A2,N);\nC2:=BACKSET(B2,N+1);\nD2:=FILTER(C2,N);\nE1:=(REF(LLV(L,2*N),1)+REF(HHV(H,2*N),1))/2;\nE2:=(H+L)/2;\nH1:=(D1 AND NOT(D2 AND E1>=E2)) OR ISLASTBAR OR BARSCOUNT(C)=1;\nL1:=(D2 AND NOT(D1 AND E1<E2));\nH2:=D1 AND NOT(D2 AND E1>=E2);\nX1:=REF(BARSLAST(H1),1)+1;\nF1:=BACKSET(H1 AND COUNT(L1,X1)>0,LLVBARS(IF(L1,L,10000),X1));\nG1:=F1>REF(F1,1);\nI1:=BACKSET(G1,2);\nLD:=I1>REF(I1,1);\nL2:=LD OR ISLASTBAR OR BARSCOUNT(C)=1;\nX2:=REF(BARSLAST(L2),1)+1;\nF2:=BACKSET(L2 AND COUNT(H2,X2)>0,HHVBARS(IF(H2,H,0),X2));\nG2:=F2>REF(F2,1);\nI2:=BACKSET(G2,2);\nHD:=I2>REF(I2,1);\nR1:=BACKSET(ISLASTBAR,BARSLAST(HD)+1);\nS1:=R1>REF(R1,1);\nT1:=BACKSET(ISLASTBAR,BARSLAST(LD)+1);\nU1:=T1>REF(T1,1);\nR2:=BACKSET(S1,REF(BARSLAST(HD),1)+2);\nS2:=R2>REF(R2,1);\nT2:=BACKSET(U1,REF(BARSLAST(LD),1)+2);\nU2:=T2>REF(T2,1);\nDRAWLINE(S2,H,S1,H,1),LINETHICK2,COLORRED;\nDRAWLINE(U2,L,U1,L,1),LINETHICK2,COLORGREEN;"}},f.prototype.WAVE=function(){return{Name:"WAVE",Description:"波浪分析",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"ZIG(3,N);"}},f.prototype.ShareholderCount=function(){return{Name:"散户线",Description:"散户线",IsMainIndex:!1,Script:"GPJYVALUE(1,1,1);"}},f.prototype.NXTS=function(){return{Name:"NXTS",Description:"牛熊天数",IsMainIndex:!1,Args:[{Name:"N",Value:20}],Script:"Z:=ZIG(C,N);\n高点:=Z>REF(Z,1) AND Z>REFX(Z,1);\n低点:=Z<REF(Z,1) AND Z<REFX(Z,1);\nNG:=BARSLAST(高点);\nND:=BARSLAST(低点);\nD0:=DATETODAY(DATE)-DATETODAY(REF(DATE,BARSSINCE(C)));\nDG:=DATETODAY(DATE)-DATETODAY(REF(DATE,NG));\nDD:=DATETODAY(DATE)-DATETODAY(REF(DATE,ND));\nN1:=(NG>ND OR COUNT(高点,0)=0) AND ND>0 AND (HHV(C,ND)-REF(C,ND))/REF(C,ND)>(N/100);\nN2:=NG<ND AND NG>0 AND (LLV(C,NG)-REF(C,NG))/REF(C,NG)>=-(N/100);\nN3:=NG<ND AND NG=0;\nN4:=COUNT(低点 OR 高点,0)=0 AND (HHV(C,0)-REF(C,BARSSINCE(C)))/REF(C,BARSSINCE(C))>(N/100);\nN5:=COUNT(低点,0)=0 AND NG>0 AND (LLV(C,NG)-REF(C,NG))/REF(C,NG)>=-(N/100);\nN6:=COUNT(低点,0)=0 AND NG=0;\nX1:=(NG<ND OR COUNT(低点,0)=0) AND NG>0 AND (LLV(C,NG)-REF(C,NG))/REF(C,NG)<-(N/100);\nX2:=NG>ND AND ND>0 AND (HHV(C,ND)-REF(C,ND))/REF(C,ND)<=(N/100);\nX3:=NG>ND AND ND=0;\nX4:=COUNT(高点 OR 低点,0)=0 AND (LLV(C,0)-REF(C,BARSSINCE(C)))/REF(C,BARSSINCE(C))<-(N/100);\nX5:=COUNT(高点,0)=0 AND ND>0 AND (HHV(C,ND)-REF(C,ND))/REF(C,ND)<=(N/100);\nX6:=COUNT(高点,0)=0 AND ND=0;\n牛市天数:IF(N4 OR N5 OR N6,D0,IF(N1 OR N2 OR N3,DD,0)),COLORRED;\n熊市天数:IF(X4 OR X5 OR X6,D0,IF(X1 OR X2 OR X3,DG,0)),COLORGREEN;"}},f.prototype.FKX=function(){return{Name:"FKX",Description:"反K线",IsMainIndex:!1,Script:"DRAWKLINE(-LOW, -OPEN, -HIGH, -CLOSE);"}},f.prototype.Margin4=function(){return{Name:"两融资金",Description:"两融资金",IsMainIndex:!1,Script:"TMPV:=IF(FINANCE(3)==0,REF(SCJYVALUE(1,1,1),1),REF(GPJYVALUE(3,1,1),1));\nTMPV1:=IF(FINANCE(3)==0,SCJYVALUE(1,1,0),GPJYVALUE(3,1,0));\n两融:IF(TMPV==0 OR TMPV1==0,DRAWNULL,IF(FINANCE(3)==0,(SCJYVALUE(1,1,1)-REF(SCJYVALUE(1,1,1),1))/10000-(SCJYVALUE(1,2,1)-REF(SCJYVALUE(1,2,1),1))/10000,((GPJYVALUE(3,1,1)-REF(GPJYVALUE(3,1,1),1))-((GPJYVALUE(3,2,1)*C/10000-(REF(GPJYVALUE(3,2,1),1)*REF(C,1)/10000)))))),NODRAW;\nSTICKLINE(两融>0,0,两融,2,0),COLORRED;\nSTICKLINE(两融<0,0,两融,2,0),COLORCYAN;"}},f.prototype.ZSDB=function(){return{Name:"ZSDB",Description:"指数对比(副图,需下载日线)",IsMainIndex:!1,Script:"A:=REF(INDEXC,1);\n指数涨幅:IF(A>0,(INDEXC-A)*100/A,0),NODRAW;\nDRAWKLINE(INDEXH,INDEXO,INDEXL,INDEXC);"}},f.prototype.NineTurns=function(){return{Name:"神奇九转",Description:"九转指标",IsMainIndex:!0,Script:"A1:=C>REF(C,4);\nA2:=C<REF(C,4);\nT1:=A2 AND REF(A1,1);\nT2:=A2 AND REF(T1,1);\nT3:=A2 AND REF(T2,1);\nT4:=A2 AND REF(T3,1);\nT5:=A2 AND REF(T4,1);\nT6:=A2 AND REF(T5,1);\nT7:=A2 AND REF(T6,1);\nT8:=A2 AND REF(T7,1);\nT9:=A2 AND REF(T8,1);\nT10:=A2 AND REF(T9,1);\nT11:=A2 AND REF(T10,1);\nT12:=A2 AND REF(T11,1);\nT13:=A2 AND REF(T12,1);\nT14:=A2 AND REF(T13,1);\nDRAWTEXT(T1,L*0.98,'1'),COLORGREEN;\nDRAWTEXT(T2,L*0.98,'2'),COLORGREEN;\nDRAWTEXT(T3,L*0.98,'3'),COLORGREEN;\nDRAWTEXT(T4,L*0.98,'4'),COLORGREEN;\nDRAWTEXT(T5,L*0.98,'5'),COLORGREEN;\nDRAWTEXT(T6,L*0.98,'6'),COLORGREEN;\nDRAWTEXT(T7,L*0.98,'7'),COLORGREEN;\nDRAWTEXT(T8,L*0.98,'8'),COLORGREEN;\nDRAWTEXT(T9,L*0.98,'9'),COLORBLUE;\nB1:=C<REF(C,4);\nB2:=C>REF(C,4);\nD1:=B2 AND REF(B1,1);\nD2:=B2 AND REF(D1,1);\nD3:=B2 AND REF(D2,1);\nD4:=B2 AND REF(D3,1);\nD5:=B2 AND REF(D4,1);\nD6:=B2 AND REF(D5,1);\nD7:=B2 AND REF(D6,1);\nD8:=B2 AND REF(D7,1);\nD9:=B2 AND REF(D8,1);\nD10:=B2 AND REF(D9,1);\nD11:=B2 AND REF(D10,1);\nD12:=B2 AND REF(D11,1);\nD13:=B2 AND REF(D12,1);\nD14:=B2 AND REF(D13,1);\nDRAWTEXT(D1,H*1.010,'1'),COLORBLUE;\nDRAWTEXT(D2,H*1.010,'2'),COLORBLUE;\nDRAWTEXT(D3,H*1.010,'3'),COLORBLUE;\nDRAWTEXT(D4,H*1.010,'4'),COLORBLUE;\nDRAWTEXT(D5,H*1.010,'5'),COLORBLUE;\nDRAWTEXT(D6,H*1.010,'6'),COLORBLUE;\nDRAWTEXT(D7,H*1.010,'7'),COLORBLUE;\nDRAWTEXT(D8,H*1.010,'8'),COLORBLUE;\nDRAWTEXT(D9,H*1.010,'9'),COLORGREEN;"}},f.prototype.ICHIMOKU=function(){return{Name:"ICHIMOKU",Description:"一目均衡图",IsMainIndex:!0,Args:[{Name:"SHORT",Value:7},{Name:"MID",Value:22},{Name:"LONG",Value:44}],Script:"转换线:(HHV(H,SHORT)+LLV(L,SHORT))/2,COLORRED,LINETHICK2;\n基准线:(HHV(H,MID)+LLV(L,MID))/2,COLORFF8040,LINETHICK2;\n迟行带:REFXV(C,MID),COLORGRAY,LINETHICK2;\nA:=REF((转换线+基准线)/2,MID);\nB:=REF((HHV(H,LONG)+LLV(L,LONG))/2,MID);\nSTICKLINE(A<B,A,B,2,1),COLOR339933;\nSTICKLINE(A>=B,A,B,2,1),COLOR0033CC;\n先行带A:PLOYLINE(1,A),COLORBROWN;\n先行带B:PLOYLINE(1,B),COLORLIGREEN;"}},f.prototype.CDP_STD=function(){return{Name:"CDP-STD",Description:"逆势操作",IsMainIndex:!0,Script:"CH:=REF(H,1);\nCL:=REF(L,1);\nCC:=REF(C,1);\nCDP:(CH+CL+CC)/3;\nAH:2*CDP+CH-2*CL;\nNH:CDP+CDP-CL;\nNL:CDP+CDP-CH;\nAL:2*CDP-2*CH+CL;"}},f.prototype.TBP_STD=function(){return{Name:"TBP-STD",Description:"趋势平衡点",IsMainIndex:!0,Script:"APX:=(H+L+C)/3;\nTR0:=MAX(H-L,MAX(ABS(H-REF(C,1)),ABS(L-REF(C,1))));\nMF0:=C-REF(C,2);\nMF1:=REF(MF0,1);\nMF2:=REF(MF0,2);\nDIRECT1:=BARSLAST(MF0>MF1 AND MF0>MF2);\nDIRECT2:=BARSLAST(MF0<MF1 AND MF0<MF2);\nDIRECT0:=IF(DIRECT1<DIRECT2,100,-100);\nTBP:REF(REF(C,1)+IF(DIRECT0>50,MIN(MF0,MF1),MAX(MF0,MF1)),1);\n多头获利:REF(IF(DIRECT0>50,APX*2-L,DRAWNULL),1),NODRAW;\n多头停损:REF(IF(DIRECT0>50,APX-TR0,DRAWNULL),1),NODRAW;\n空头回补:REF(IF(DIRECT0<-50,APX*2-H,DRAWNULL),1),NODRAW;\n空头停损:REF(IF(DIRECT0<-50,APX+TR0,DRAWNULL),1),NODRAW;"}},f.prototype.ADX=function(){return{Name:"ADX",Description:"均趋向指标",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"TR1:=SMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(LOW-REF(CLOSE,1))),N,1);\nHD:=HIGH-REF(HIGH,1);\nLD:=REF(LOW,1)-LOW;\nDMP:=SMA(IF(HD>0 AND HD>LD,HD,0),N,1);\nDMM:=SMA(IF(LD>0 AND LD>HD,LD,0),N,1);\nPDI:DMP*100/TR1,COLORRED,DOTLINE;\nMDI:DMM*100/TR1,COLORGREEN,DOTLINE;\nADX:SMA(ABS(MDI-PDI)/(MDI+PDI)*100,N,1),COLORYELLOW,LINETHICK2;\n20;\n40;"}},f.prototype.ZNZ_CBAND=function(){return{Name:"ZNZ_CBAND",Description:"优化成本布林带宽",IsMainIndex:!1,Args:[{Name:"N",Value:20}],Script:"A:=AMOUNT/(100*VOL);\nBBI1:=MA(A,N);\nUPR0:=BBI1+STD(A,N);\nDWN0:=BBI1-STD(A,N);\nUPR1:=BBI1+1.7*STD(A,N);\nDWN1:=BBI1-1.7*STD(A,N);\n优化成本布林带宽:100*1.7*STD(A,N);"}},f.prototype.ZNZ_RPY2=function(){return{Name:"ZNZ_RPY2",Description:"两年相对价位",IsMainIndex:!1,Script:"A:=REF(HHV(CLOSE,480),1);\nB:=REF(LLV(CLOSE,480),1);\n100*(CLOSE-B)/(A-B);"}},f.prototype.ZNZ_RPY1=function(){return{Name:"ZNZ_RPY1",Description:"年相对价位",IsMainIndex:!1,Args:[{Name:"N",Value:240}],Script:"A:=REF(HHV(CLOSE,N),1);\nB:=REF(LLV(CLOSE,N),1);\n100*(CLOSE-B)/(A-B);"}},f.prototype.WSBVOL=function(){return{Name:"WSBVOL",Description:"维斯波成交量",IsMainIndex:!1,Script:"UPTJ1:=CLOSE>REF(CLOSE,1);\nUPTJ2:=(CLOSE==REF(CLOSE,1) && REF(CLOSE,1)>REF(CLOSE,2));\nUPTJ3:=MAX(OPEN,CLOSE)<REF(C,BARSLAST(CLOSE>REF(CLOSE,1))) AND MIN(OPEN,CLOSE)>REF(O,BARSLAST(CLOSE>REF(CLOSE,1)));\nUPTJ4:=NOT (H<REF(H,1) AND L<REF(L,1));\nUP:=(UPTJ1 || UPTJ2 || UPTJ3) AND UPTJ4;\nDOWN:=NOT(UP);\nM1:=BARSLASTCOUNT(UP);\nN1:=BARSLASTCOUNT(DOWN);\nCZB:=IF(M1=1 OR N1=1,2*INTPART(VOL*100/10000),INTPART(VOL*100/10000));\nSZ:=IF(M1>0,SUM(CZB,M1),-1*SUM(CZB,N1));\nGY:=IF(N1>0,SUM(CZB,N1),0);\nXQ:=IF(M1>0,SUM(CZB,M1),0);\nNOTEXT1:STICKLINE(M1>0,0,XQ,1,0),COLORRED;\nNOTEXT2:STICKLINE(N1>0,0,GY,1,0),COLORGREEN;\nWSB:SZ,NODRAW;"}},f.prototype.CCL=function(){return{Name:"CCL",Description:"持仓量(适用于期货)",IsMainIndex:!1,Script:"持仓量:VOLINSTK;\n成交:VOL,COLORLIRED;\n仓差:VOLINSTK-REF(VOLINSTK,1),NODRAW;\nSTICKLINE(仓差>0 AND C>REF(C,1),0,仓差,2,3),COLORRED;\nSTICKLINE(仓差>0 AND C<REF(C,1),0,仓差,2,3),COLORCYAN;\nSTICKLINE(仓差>0 AND C=REF(C,1),0,仓差,2,3),COLORGRAY;\nSTICKLINE(仓差<0 AND C>REF(C,1),0,仓差,2,3),COLORRED;\nSTICKLINE(仓差<0 AND C<REF(C,1),0,仓差,2,3),COLORCYAN;\nSTICKLINE(仓差<0 AND C=REF(C,1),0,仓差,2,3),COLORGRAY;"}},f.prototype.CCYD=function(){return{Name:"CCYD",Description:"持仓异动(适用于期货)",IsMainIndex:!1,Script:"CCYD:=VOLINSTK-REF(VOLINSTK,1);\nSPYD:=C-REF(C,1);\n多头增仓:IF(SPYD>=0 AND CCYD>=0,ABS(CCYD),DRAWNULL),COLOR3232FF,NODRAW;\n空头减仓:IF(SPYD>0 AND CCYD<0,ABS(CCYD),DRAWNULL),COLOR3232FF,NODRAW;\n空头增仓:IF(SPYD<0 AND CCYD>=0,ABS(CCYD),DRAWNULL),COLORFFFF54,NODRAW;\n多头减仓:IF(SPYD<0 AND CCYD<0,ABS(CCYD),DRAWNULL),COLORFFFF54,NODRAW;\nSTICKLINE(SPYD>=0 AND CCYD>=0,0,CCYD,3,1),COLOR3232FF;\nSTICKLINE(SPYD>0 AND CCYD<0,CCYD,0,3,1),COLOR3232FF;\nSTICKLINE(SPYD<0 AND CCYD>=0,CCYD,0,3,0),COLORFFFF54;\nSTICKLINE(SPYD<0 AND CCYD<0,CCYD,0,3,0),COLORFFFF54;"}},f.prototype.ABI=function(){var t={Name:"ABI",Description:"绝对广量指标",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Condition:{Period:[C.KLINE_DAY_ID,C.KLINE_WEEK_ID,C.KLINE_TWOWEEK_ID,C.KLINE_MONTH_ID,C.KLINE_QUARTER_ID,C.KLINE_YEAR_ID],Include:["000001.SH","000003.SH","000016.SH","000300.SH","000905.SH","399001.SZ"," 399005.SZ","399006.SZ"]},Script:"ABI:100*ABS(ADVANCE-DECLINE)/(ADVANCE+DECLINE);\nMAABI:EMA(ABI,M);"};return t},f.prototype.TEST=function(){return{Name:"TEST",Description:"测试脚本",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"DRAWCHANNEL(OPEN>C,H,L, 'RGB(255,94,102)', 2 ,'5,5','RGBA(58,20,62,0.3)' );"}},!u)u={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn}};function c(t,e,a){this.DivElement=t,this.JSChartContainer,this.ResizeListener,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jschart-drawing",this.CanvasElement.id=N(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&u.Chart.Log("[JSChart::JSChart] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OffscreenCanvasElement,1==e&&(this.OffscreenCanvasElement=document.createElement("canvas")),this.CacheCanvasElement=null,a&&(this.CacheCanvasElement=document.createElement("canvas")),this.MapExtraCanvasElement=new Map,this.CreateExtraCanvasElement=function(e,a){if(this.MapExtraCanvasElement.has(e))return this.MapExtraCanvasElement.get(e);var i=document.createElement("canvas");i.className="jschart-drawing-extra",i.id=N(),e==c.CorssCursorCanvasKey?i.setAttribute("tabindex",5):i.setAttribute("tabindex",1),i.style&&(i.style.outline="none",i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style["pointer-events"]="none"),a&&(sa.IsNumber(a.TabIndex)&&i.setAttribute("tabindex",a.TabIndex),sa.IsNumber(a.ZIndex)&&(i.style["z-index"]=a.ZIndex)),this.CanvasElement&&(i.height=this.CanvasElement.height,i.width=this.CanvasElement.width,i.style&&(i.style.width=this.CanvasElement.style.width,i.style.height=this.CanvasElement.style.height)),t.appendChild(i);var r={Element:i,Canvas:null};this.MapExtraCanvasElement.set(e,r)},this.GetExtraCanvas=function(t){if(!this.MapExtraCanvasElement.has(t))return null;var e=this.MapExtraCanvasElement.get(t);return e.Element?(e.Canvas||(e.Canvas=e.Element.getContext("2d")),e):null},this.OnSize=function(t){var e=this.DivElement.offsetHeight,a=this.DivElement.offsetWidth,i=F();this.DivElement.style.height&&this.DivElement.style.width&&(this.DivElement.style.height.includes("px")&&(e=parseInt(this.DivElement.style.height.replace("px",""))),this.DivElement.style.width.includes("px")&&(a=parseInt(this.DivElement.style.width.replace("px","")))),this.CanvasElement.style.width="".concat(a,"px"),this.CanvasElement.style.height="".concat(e,"px"),this.CanvasElement.height=parseInt(i*e),this.CanvasElement.width=parseInt(i*a),this.OffscreenCanvasElement&&(this.OffscreenCanvasElement.height=this.CanvasElement.height,this.OffscreenCanvasElement.width=this.CanvasElement.width),this.CacheCanvasElement&&(this.CacheCanvasElement.height=this.CanvasElement.height,this.CacheCanvasElement.width=this.CanvasElement.width);var r,n=(0,l.default)(this.MapExtraCanvasElement);try{for(n.s();!(r=n.n()).done;){var o=r.value,s=o[1],h=s.Element;h&&(h.height=this.CanvasElement.height,h.width=this.CanvasElement.width,h.style.width=this.CanvasElement.style.width,h.style.height=this.CanvasElement.style.height)}}catch(C){n.e(C)}finally{n.f()}u.Chart.Log("[JSChart::OnSize] devicePixelRatio=".concat(window.devicePixelRatio,", height=").concat(this.CanvasElement.height,", width=").concat(this.CanvasElement.width)),t&&0==t.Redraw||this.JSChartContainer&&(t&&!0===t.XYSplit&&this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.OnSize&&t&&1==t.Type?this.JSChartContainer.OnSize():this.JSChartContainer.ShowAllKLine&&t&&2==t.Type?this.JSChartContainer.ShowAllKLine():(this.JSChartContainer.Frame&&this.JSChartContainer.Frame.SetSizeChage(!0),this.JSChartContainer.Draw()))},this.AdjustChartBorder=function(t){var e=F();if(t.Frame.ChartBorder.Left*=e,t.Frame.ChartBorder.Right*=e,t.Frame.ChartBorder.Top*=e,t.Frame.ChartBorder.Bottom*=e,t.Frame.AutoLeftBorder){var a=t.Frame.AutoLeftBorder;sa.IsNumber(a.MinWidth)&&(a.MinWidth*=e),sa.IsNumber(a.Blank)&&(a.Blank*=e)}if(t.Frame.AutoRightBorder){a=t.Frame.AutoRightBorder;sa.IsNumber(a.MinWidth)&&(a.MinWidth*=e),sa.IsNumber(a.Blank)&&(a.Blank*=e)}},this.AdjustTitleHeight=function(t){for(var e=F(),a=0;a<t.Frame.SubFrame.length;++a)t.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight*=e;t.ChartCorssCursor.TextHeight*=e},this.SetChartBorder=function(t,e){if(e.Border){var a=e.Border;sa.IsNumber(e.Border.Left)?t.Frame.ChartBorder.Left=e.Border.Left:e.Border.Left=t.Frame.ChartBorder.Left,sa.IsNumber(e.Border.Right)?t.Frame.ChartBorder.Right=e.Border.Right:e.Border.Right=t.Frame.ChartBorder.Right,sa.IsNumber(e.Border.Top)?t.Frame.ChartBorder.Top=e.Border.Top:e.Border.Top=t.Frame.ChartBorder.Top,sa.IsNumber(e.Border.Bottom)?t.Frame.ChartBorder.Bottom=e.Border.Bottom:e.Border.Bottom=t.Frame.ChartBorder.Bottom,a.AutoLeft&&(t.Frame.AutoLeftBorder={},sa.IsNumber(a.AutoLeft.Blank)&&(t.Frame.AutoLeftBorder.Blank=a.AutoLeft.Blank),sa.IsNumber(a.AutoLeft.MinWidth)&&(t.Frame.AutoLeftBorder.MinWidth=a.AutoLeft.MinWidth)),a.AutoRight&&(t.Frame.AutoRightBorder={},sa.IsNumber(a.AutoRight.Blank)&&(t.Frame.AutoRightBorder.Blank=a.AutoRight.Blank),sa.IsNumber(a.AutoRight.MinWidth)&&(t.Frame.AutoRightBorder.MinWidth=a.AutoRight.MinWidth))}},this.SetEventCallback=function(t,e){if(t&&sa.IsNonEmptyArray(e))for(var a=0;a<e.length;++a){var i=e[a];t.AddEventCallback(i)}},this.CreateKLineChartContainer=function(t){var e=this,a=null;a="历史K线图横屏"===t.Type?new Cr(this.CanvasElement):new or(this.CanvasElement,this.OffscreenCanvasElement,this.CacheCanvasElement),a.GetExtraCanvas=function(t){return e.GetExtraCanvas(t)};var i=this.GetExtraCanvas(c.CorssCursorCanvasKey);i&&a.SetCorssCursorElement(i),t.EventCallback&&this.SetEventCallback(a,t.EventCallback),t.NetworkFilter&&(a.NetworkFilter=t.NetworkFilter);var r=F();if(sa.IsBool(t.IsShowRightMenu)&&(a.IsShowRightMenu=t.IsShowRightMenu),t.ScriptError&&(a.ScriptErrorCallback=t.ScriptError),1==t.EnableScrollUpDown&&(a.EnableScrollUpDown=t.EnableScrollUpDown),1==t.DisableMouse&&(a.DisableMouse=t.DisableMouse),t.TouchMoveMinAngle&&(a.TouchMoveMinAngle=t.TouchMoveMinAngle),t.EnableZoomUpDown&&(a.EnableZoomUpDown=t.EnableZoomUpDown),sa.IsString(t.SplashTitle)&&(a.LoadDataSplashTitle=t.SplashTitle),sa.IsBool(t.EnableZoomIndexWindow)&&(a.EnableZoomIndexWindow=t.EnableZoomIndexWindow),sa.IsBool(t.IsDrawPictureXY)&&(a.IsDrawPictureXY=t.IsDrawPictureXY),sa.IsNumber(t.CtrlMoveStep)&&(a.CtrlMoveStep=t.CtrlMoveStep),sa.IsNumber(t.ShiftMoveStep)&&(a.ShiftMoveStep=t.ShiftMoveStep),sa.IsBool(t.EnableIndexChartDrag)&&(a.EnableIndexChartDrag=t.EnableIndexChartDrag),sa.IsBool(t.EnableVerifyRecvData)&&(a.EnableVerifyRecvData=t.EnableVerifyRecvData),t.GlobalOption){var n=t.GlobalOption;if(sa.IsBool(n.IsValueFullRange)&&(a.GlobalOption.IsValueFullRange=n.IsValueFullRange),n.SelectedBorder){var o=n.SelectedBorder;sa.IsNumber(o.Mode)&&(a.GlobalOption.SelectedBorder.Mode=o.Mode)}}if(t.EnableYDrag){n=t.EnableYDrag;sa.IsBool(n.Left)&&(a.EnableYDrag.Left=n.Left),sa.IsBool(n.Right)&&(a.EnableYDrag.Right=n.Right),sa.IsBool(n.Wheel)&&(a.EnableYDrag.Wheel=n.Wheel),sa.IsNumber(n.WheelYMove)&&(a.EnableYDrag.WheelYMove=n.WheelYMove)}if(t.EnableXDrag){n=t.EnableXDrag;sa.IsBool(n.Bottom)&&(a.EnableXDrag.Bottom=n.Bottom),n.LButton&&sa.IsNumber(n.LButton.Type)&&(a.EnableXDrag.LButton.Type=n.LButton.Type),n.RButton&&sa.IsNumber(n.RButton.Type)&&(a.EnableXDrag.RButton.Type=n.RButton.Type)}if(t.KLineTooltip){n=t.KLineTooltip;sa.IsBool(n.Enable)&&(a.KLineTooltipConfig.Enable=n.Enable),sa.IsBool(n.EnableKeyDown)&&(a.KLineTooltipConfig.EnableKeyDown=n.EnableKeyDown)}if(t.KLine){n=t.KLine;t.KLine.DragMode>=0&&(a.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(a.Right=t.KLine.Right),t.KLine.Period>=0&&(a.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(a.MaxRequestDataCount=t.KLine.MaxReqeustDataCount),t.KLine.MaxRequestDataCount>0&&(a.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&a.SetKLineInfo(t.KLine.Info,!1),sa.IsBool(n.IsShowTooltip)&&(a.IsShowTooltip=n.IsShowTooltip),t.KLine.MaxRequestMinuteDayCount>0&&(a.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(a.KLineDrawType=t.KLine.DrawType),t.KLine.FirstShowDate>19910101&&(a.CustomShow={Date:t.KLine.FirstShowDate,PageSize:t.KLine.PageSize}),//!!已弃用 新的格式"CustomShow"
t.KLine.RightSpaceCount>0&&(a.RightSpaceCount=t.KLine.RightSpaceCount),t.KLine.ZoomType>0&&(a.ZoomType=t.KLine.ZoomType),t.KLine.DataWidth>=1&&(a.KLineSize={DataWidth:t.KLine.DataWidth}),sa.IsNumber(t.KLine.RightFormula)&&(a.RightFormula=t.KLine.RightFormula)}if(t.CustomShow&&sa.IsPlusNumber(t.CustomShow.Date)){n=t.CustomShow;a.CustomShow={Date:n.Date},sa.IsNumber(n.Time)&&(a.CustomShow.Time=n.Time),sa.IsPlusNumber(n.PageSize)&&(a.CustomShow.PageSize=n.PageSize)}if(t.EnableFlowCapital){n=t.EnableFlowCapital;1==n.BIT&&(a.EnableFlowCapital.BIT=n.BIT)}if(sa.IsBool(t.EnableBorderDrag)&&(a.EnableBorderDrag=t.EnableBorderDrag),t.Page&&(t.Page.Day&&1==t.Page.Day.Enable&&(a.Page.Day.Enable=!0),t.Page.Minute&&1==t.Page.Minute.Enable&&(a.Page.Minute.Enable=!0)),t.DragDownload&&(t.DragDownload.Day&&1==t.DragDownload.Day.Enable&&(a.DragDownload.Day.Enable=!0),t.DragDownload.Minute&&1==t.DragDownload.Minute.Enable&&(a.DragDownload.Minute.Enable=!0)),t.ZoomDownload&&(t.ZoomDownload.Day&&sa.IsBool(t.ZoomDownload.Day.Enable)&&(a.ZoomDownload.Day.Enable=t.ZoomDownload.Day.Enable),t.ZoomDownload.Minute&&sa.IsBool(t.ZoomDownload.Minute.Enable)&&(a.ZoomDownload.Minute.Enable=t.ZoomDownload.Minute.Enable)),t.Language){var s=$i.GetLanguageID(t.Language);sa.IsNumber(s)&&(a.LanguageID=s)}if(t.SourceDatatLimit&&a.SetSourceDatatLimit(t.SourceDatatLimit),t.DrawPicture&&t.DrawPicture.StorageKey&&a.ChartDrawStorage&&a.ChartDrawStorage.Load(t.DrawPicture.StorageKey),t.DrawTool&&t.DrawTool.StorageKey&&a.ChartDrawStorage&&a.ChartDrawStorage.Load(t.DrawTool.StorageKey),sa.IsNumber(t.StepPixel)&&(a.StepPixel=t.StepPixel),t.ZoomStepPixel>0&&(a.ZoomStepPixel=t.ZoomStepPixel),1==t.IsApiPeriod&&(a.IsApiPeriod=t.IsApiPeriod),t.SelectedChart){n=t.SelectedChart;sa.IsBool(n.EnableSelected)&&(a.SelectedChart.EnableSelected=n.EnableSelected),sa.IsBool(n.EnableMoveOn)&&(a.SelectedChart.EnableMoveOn=n.EnableMoveOn)}if(!t.Windows||t.Windows.length<=0)return null;if(sa.IsNonEmptyArray(t.KLineCalcOption))for(var h=0;h<t.KLineCalcOption.length;++h){n=t.KLineCalcOption[h];n.ClassName&&n.Option&&a.SetKLineCalcOption(n.ClassName,n.Option)}if(t.FastSlide){n=t.FastSlide;sa.IsNumber(n.MinDistance)&&(a.FastSlideConfig.MinDistance=n.MinDistance),sa.IsNumber(n.MinSpeed)&&(a.FastSlideConfig.MinSpeed=n.MinSpeed),sa.IsNumber(n.MaxTime)&&(a.FastSlideConfig.MaxTime=n.MaxTime),sa.IsBool(n.Enable)&&(a.FastSlideConfig.Enable=n.Enable)}if("KLineChartContainer"==a.ClassName){if(t.DragSelectRect||(t.DragSelectRect={Enable:!0}),t.DragSelectRect){var l=10;n=t.DragSelectRect;sa.IsNumber(n.ZIndex)&&(l=n.ZIndex),n.Enable&&this.CreateExtraCanvasElement(c.RectDragCanvasKey,{ZIndex:l})}if(t.DragKLine){n=t.DragKLine;sa.IsBool(n.EnableShfit)&&(a.KLineDragConfig.EnableShfit=n.EnableShfit)}}if(a.Create(t.Windows.length,t),this.SetChartBorder(a,t),this.AdjustChartBorder(a),t.KLine&&t.KLine.PageSize>0){var u=a.GetMaxMinPageSize();u.Max>10&&u.Max<t.KLine.PageSize?a.PageSize=u.Max:u.Min>10&&u.Min>t.KLine.PageSize?a.PageSize=u.Min:a.PageSize=t.KLine.PageSize}if(!0===t.IsCorssOnlyDrawKLine&&(a.ChartCorssCursor.IsOnlyDrawKLine=t.IsCorssOnlyDrawKLine),!0===t.CorssCursorTouchEnd&&(a.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(a.IsClickShowCorssCursor=t.IsClickShowCorssCursor),t.CorssCursorInfo){n=t.CorssCursorInfo;if(isNaN(t.CorssCursorInfo.Left)||(a.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(a.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(a.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(a.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),sa.IsBool(n.IsShowClose)&&(a.ChartCorssCursor.IsShowClose=n.IsShowClose),sa.IsBool(n.IsOnlyDrawKLine)&&(a.ChartCorssCursor.IsOnlyDrawKLine=n.IsOnlyDrawKLine),t.CorssCursorInfo.PressTime&&(a.PressTime=t.CorssCursorInfo.PressTime),sa.IsNumber(t.CorssCursorInfo.HPenType)&&(a.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(a.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType),sa.IsNumber(n.VLineType)&&(a.ChartCorssCursor.VLineType=n.VLineType),t.CorssCursorInfo.DateFormatType>0&&(a.ChartCorssCursor.StringFormatX.DateFormatType=t.CorssCursorInfo.DateFormatType),sa.IsBool(n.IsDrawXRangeBG)&&(a.ChartCorssCursor.IsDrawXRangeBG=n.IsDrawXRangeBG),sa.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(a.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),sa.IsNumber(n.TextHeight)&&(a.ChartCorssCursor.TextHeight=n.TextHeight),n.RightButton&&sa.IsBool(n.RightButton.Enable)&&(a.ChartCorssCursor.RightButton.Enable=n.RightButton.Enable),n.BottomButton){o=n.BottomButton;sa.IsBool(o.Enable)&&(a.ChartCorssCursor.BottomButton.Enable=o.Enable)}sa.IsNumber(n.PriceFormatType)&&(a.ChartCorssCursor.StringFormatY.PriceFormatType=n.PriceFormatType),sa.IsNumber(n.DataFormatType)&&(a.ChartCorssCursor.StringFormatY.DataFormatType=n.DataFormatType),sa.IsBool(n.EnableKeyboard)&&(a.ChartCorssCursor.EnableKeyboard=n.EnableKeyboard),sa.IsBool(n.EnableDBClick)&&(a.ChartCorssCursor.EnableDBClick=n.EnableDBClick),sa.IsBool(n.IsShowCorssPoint)&&(a.ChartCorssCursor.CorssPointConfig.Enable=n.IsShowCorssPoint),sa.IsBool(n.IsShowIncrease)&&(a.ChartCorssCursor.StringFormatX.IsShowIncrease=n.IsShowIncrease)}if(t.CorssCursor={},t.CorssCursor.TitleHeight=a.ChartCorssCursor.TextHeight,sa.IsNumber(t.SplashTitlePosition)&&a.ChartSplashPaint&&(a.ChartSplashPaint.Position=t.SplashTitlePosition),t.Frame)for(h=0;h<t.Frame.length;++h){n=t.Frame[h];if(a.Frame.SubFrame[h]){var C=a.Frame.SubFrame[h].Frame;sa.IsNumber(n.SplitCount)&&(a.Frame.SubFrame[h].Frame.YSplitOperator.SplitCount=n.SplitCount),n.StringFormat&&(a.Frame.SubFrame[h].Frame.YSplitOperator.StringFormat=n.StringFormat),sa.IsNumber(n.FloatPrecision)&&(a.Frame.SubFrame[h].Frame.YSplitOperator.FloatPrecision=n.FloatPrecision),n.Custom&&(a.Frame.SubFrame[h].Frame.YSplitOperator.Custom=n.Custom),sa.IsNumber(n.SplitType)&&(a.Frame.SubFrame[h].Frame.YSplitOperator.SplitType=n.SplitType,a.Frame.SubFrame[h].Frame.YSplitOperator.DefaultSplitType=n.SplitType),sa.IsNumber(n.FilterType)&&(C.YSplitOperator.FilterType=n.FilterType),isNaN(n.Height)||(a.Frame.SubFrame[h].Height=n.Height),!1!==n.IsShowLeftText&&!0!==n.IsShowLeftText||(a.Frame.SubFrame[h].Frame.IsShowYText[0]=n.IsShowLeftText,a.Frame.SubFrame[h].Frame.YSplitOperator.IsShowLeftText=n.IsShowLeftText),!1!==n.IsShowRightText&&!0!==n.IsShowRightText||(a.Frame.SubFrame[h].Frame.IsShowYText[1]=n.IsShowRightText,a.Frame.SubFrame[h].Frame.YSplitOperator.IsShowRightText=n.IsShowRightText),n.TopSpace>=0&&(a.Frame.SubFrame[h].Frame.ChartBorder.TopSpace=n.TopSpace*r),n.BottomSpace>=0&&(a.Frame.SubFrame[h].Frame.ChartBorder.BottomSpace=n.BottomSpace*r),n.RightTextPosition>0&&(a.Frame.SubFrame[h].Frame.YTextPosition[1]=n.RightTextPosition),n.LeftTextPosition>0&&(a.Frame.SubFrame[h].Frame.YTextPosition[0]=n.LeftTextPosition),0==n.IsShowXLine&&(a.Frame.SubFrame[h].Frame.IsShowXLine=n.IsShowXLine),0==n.IsShowYLine&&(a.Frame.SubFrame[h].Frame.IsShowYLine=n.IsShowYLine),sa.IsNumber(n.YTextBaseline)&&(a.Frame.SubFrame[h].Frame.YTextBaseline=n.YTextBaseline),n.YCoordinateType>0&&(a.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=n.YCoordinateType),1==n.IsYReverse&&(a.Frame.SubFrame[0].Frame.CoordinateType=1),sa.IsNumber(n.PercentageTextFormat)&&(C.YSplitOperator.PercentageTextFormat=n.PercentageTextFormat),n.DefaultYMaxMin&&(a.Frame.SubFrame[h].Frame.YSplitOperator.DefaultYMaxMin=n.DefaultYMaxMin),sa.IsBool(n.EnableRemoveZero)&&(a.Frame.SubFrame[h].Frame.YSplitOperator.EnableRemoveZero=n.EnableRemoveZero),sa.IsPlusNumber(n.MinYDistance)&&(a.Frame.SubFrame[h].Frame.MinYDistance=n.MinYDistance),sa.IsNumber(n.BorderLine)&&(a.Frame.SubFrame[h].Frame.BorderLine=n.BorderLine),sa.IsBool(n.IsShowIndexTitle)&&(a.Frame.SubFrame[h].Frame.IsShowIndexTitle=n.IsShowIndexTitle),sa.IsBool(n.IsDrawTitleBottomLine)&&(C.IsDrawTitleBottomLine=n.IsDrawTitleBottomLine),sa.IsBool(n.IsShowNameArrow)&&(a.Frame.SubFrame[h].Frame.IsShowNameArrow=n.IsShowNameArrow),n.ClientBGColor&&(C.ClientBGColor=n.ClientBGColor)}}if(t.KLine){n=t.KLine;var D=a.ChartPaint[0];0==t.KLine.ShowKLine&&(D.IsShow=!1),t.KLine.InfoPosition>0&&(D.InfoPosition=t.KLine.InfoPosition),sa.IsBool(n.IsShowMaxMinPrice)&&(D.IsShowMaxMinPrice=n.IsShowMaxMinPrice),sa.IsNumber(n.OneLimitBarType)&&(D.OneLimitBarType=n.OneLimitBarType),sa.IsNumber(n.UnchangeBarType)&&(D.UnchangeBarType=n.UnchangeBarType),n.PriceGap&&(sa.IsBool(n.PriceGap.Enable)&&(D.PriceGap.Enable=n.PriceGap.Enable),sa.IsNumber(n.PriceGap.Count)&&(D.PriceGap.Count=n.PriceGap.Count)),sa.IsBool(n.EnablePrediction)&&(D.PredictionConfig.Enable=n.EnablePrediction),sa.IsBool(n.EnableDaySummary)&&(D.DaySummary.Enable=n.EnableDaySummary)}if(t.KLineTitle){n=t.KLineTitle;var m=a.TitlePaint[0];if(0==t.KLineTitle.IsShowName&&(a.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(a.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(a.TitlePaint[0].IsShow=!1),sa.IsBool(n.IsShowDateTime)&&(m.IsShowDateTime=n.IsShowDateTime),sa.IsBool(n.IsTitleShowLatestData)&&(a.IsTitleShowLatestData=n.IsTitleShowLatestData),n.ShowPosition||n.ShowPostion){o=n.ShowPostion;n.ShowPosition&&(o=n.ShowPosition),m.ShowPositionConfig||(m.ShowPositionConfig={Margin:{}}),sa.IsNumber(o.Type)&&(m.ShowPositionConfig.Type=o.Type),o.Margin&&(sa.IsNumber(o.Margin.Left)&&(m.ShowPositionConfig.Margin.Left=o.Margin.Left),sa.IsNumber(o.Margin.Right)&&(m.ShowPositionConfig.Margin.Right=o.Margin.Right),sa.IsNumber(o.Margin.Bottom)&&(m.ShowPositionConfig.Margin.Bottom=o.Margin.Bottom))}}if(t.Overlay)for(h=0;h<t.Overlay.length;++h){n=t.Overlay[h];a.OverlaySymbol(n.Symbol,n)}if(t.ExtendChart)for(h=0;h<t.ExtendChart.length;++h){n=t.ExtendChart[h];a.CreateExtendChart(n.Name,n)}var d=new f;if(t.ColorIndex){n=t.ColorIndex;var I=d.Get(n.Index);I&&(I.ID=n.Index,a.ColorIndex=new pn(I.Name,I.Script,I.Args,I))}if(t.TradeIndex){n=t.TradeIndex;var S=d.Get(n.Index);S&&(S.ID=n.Index,a.TradeIndex=new pn(S.Name,S.Script,S.Args,S))}for(h=0;h<t.Windows.length;++h){n=t.Windows[h];if(n.Script)a.WindowIndex[h]=new pn(n.Name,n.Script,n.Args,n);else if(n.JsonData)a.WindowIndex[h]=new vr(n.Name,n.Script,n.Args,n);else if(n.Local&&n.Local.Data)a.WindowIndex[h]=new Fn(n.Local.Name,n.Local.Args,{JsonData:n.Local.Data});else if(n.API){var T=n.API;a.WindowIndex[h]=new xn(T.Name,T.Script,T.Args,n)}else{var v=tr.Get(n.Index);if(v)a.WindowIndex[h]=v.Create(n.Option),a.WindowIndex[h].SetArgs&&a.WindowIndex[h].SetArgs(n.Args),a.CreateWindowIndex(h);else{d=new f;var p=d.Get(n.Index);if(!p)continue;f.ModifyAttribute(p,n),p.ID=n.Index,a.WindowIndex[h]=new pn(p.Name,p.Script,p.Args,p),n.StringFormat>0&&(a.WindowIndex[h].StringFormat=n.StringFormat),n.FloatPrecision>=0&&(a.WindowIndex[h].FloatPrecision=n.FloatPrecision)}}var g=a.Frame.SubFrame[h].Frame;sa.IsBool(n.Modify)&&(g.ModifyIndex=n.Modify),sa.IsBool(n.Change)&&(g.ChangeIndex=n.Change),sa.IsBool(n.Close)&&(g.CloseIndex=n.Close),sa.IsBool(n.Overlay)&&(g.OverlayIndex=n.Overlay),sa.IsBool(n.Export)&&(g.ExportData=n.Export),sa.IsBool(n.MaxMin)&&(a.Frame.SubFrame[h].Frame.MaxMinWindow=n.MaxMin),sa.IsBool(n.TitleWindow)&&(a.Frame.SubFrame[h].Frame.TitleWindow=n.TitleWindow),sa.IsBool(n.AddIndexWindow)&&(g.AddIndexWindow=n.AddIndexWindow),1==n.IsDrawTitleBG&&(a.Frame.SubFrame[h].Frame.IsDrawTitleBG=n.IsDrawTitleBG),sa.IsBool(n.IsShowNameArrow)&&(a.Frame.SubFrame[h].Frame.IsShowNameArrow=n.IsShowNameArrow),sa.IsNumber(n.TitleHeight)?a.Frame.SubFrame[h].Frame.ChartBorder.TitleHeight=n.TitleHeight:n.TitleHeight=a.Frame.SubFrame[h].Frame.ChartBorder.TitleHeight,sa.IsBool(n.IsShowTitleArrow)&&(g.IsShowTitleArrow=n.IsShowTitleArrow),sa.IsNumber(n.TitleArrowType)&&(g.TitleArrowType=n.TitleArrowType),0==n.IsShowIndexName&&(a.Frame.SubFrame[h].Frame.IsShowIndexName=!1),0==n.IsShowOverlayIndexName&&(a.Frame.SubFrame[h].Frame.IsShowOverlayIndexName=!1),sa.IsNumber(n.IndexParamSpace)&&(a.Frame.SubFrame[h].Frame.IndexParamSpace=n.IndexParamSpace),sa.IsNumber(n.IndexTitleSpace)&&(a.Frame.SubFrame[h].Frame.IndexTitleSpace=n.IndexTitleSpace),sa.IsUndefined(n.HorizontalReserved)||(g.HorizontalReserved=n.HorizontalReserved),n.OverlayIndexType&&(sa.IsNumber(n.OverlayIndexType.Position)&&(a.Frame.SubFrame[h].Frame.OverlayIndexType.Position=n.OverlayIndexType.Position),sa.IsNumber(n.OverlayIndexType.LineSpace)&&(a.Frame.SubFrame[h].Frame.OverlayIndexType.LineSpace=n.OverlayIndexType.LineSpace))}if(t.OverlayIndexFrameWidth>40&&(a.Frame.FixedRightWidth.Overlay=t.OverlayIndexFrameWidth),sa.IsNonEmptyArray(t.OverlayIndex))for(h=0;h<t.OverlayIndex.length;++h){n=t.OverlayIndex[h];if(!(n.Windows>=a.Frame.SubFrame.length)){var x=JSON.stringify(n),E=JSON.parse(x);n.Index&&(E.IndexName=n.Index),n.Windows>=0&&(E.WindowIndex=n.Windows),a.CreateOverlayWindowsIndex(E)}}return this.AdjustTitleHeight(a),a},this.CreateCustomKLineChartContainer=function(t){var e=new hr(this.CanvasElement);if(sa.IsBool(t.IsShowRightMenu)&&(e.IsShowRightMenu=t.IsShowRightMenu),t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(e.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.PageSize>0&&(e.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1)),t.CustomStock&&(e.CustomStock=t.CustomStock),t.QueryDate&&(e.QueryDate=t.QueryDate),!t.Windows||t.Windows.length<=0)return null;if(e.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Frame)for(var a=0;a<t.Frame.length;++a){var i=t.Frame[a];i.SplitCount&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[a].Frame.YSplitOperator.StringFormat=i.StringFormat)}t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1));var r=new f;for(a=0;a<t.Windows.length;++a){i=t.Windows[a];if(i.Script)e.WindowIndex[a]=new pn(i.Name,i.Script,i.Args,i);else{var n=tr.Get(i.Index);if(n)e.WindowIndex[a]=n.Create(),e.CreateWindowIndex(a);else{var o=r.Get(i.Index);if(!o)continue;i.Lock&&(o.Lock=i.Lock),e.WindowIndex[a]=new pn(o.Name,o.Script,o.Args,o)}}null!=i.Modify&&(e.Frame.SubFrame[a].Frame.ModifyIndex=i.Modify),null!=i.Change&&(e.Frame.SubFrame[a].Frame.ChangeIndex=i.Change),isNaN(i.TitleHeight)||(e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight=i.TitleHeight)}return e},this.CreateMinuteChartContainer=function(t){var e=this,a=null;a="分钟走势图横屏"===t.Type?new Dr(this.CanvasElement):new sr(this.CanvasElement,this.OffscreenCanvasElement,this.CacheCanvasElement),a.GetExtraCanvas=function(t){return e.GetExtraCanvas(t)},t.EventCallback&&this.SetEventCallback(a,t.EventCallback),t.NetworkFilter&&(a.NetworkFilter=t.NetworkFilter);var i=F(),r=2;if(t.Windows&&t.Windows.length>0&&(r+=t.Windows.length),1==t.EnableScrollUpDown&&(a.EnableScrollUpDown=t.EnableScrollUpDown),1==t.DisableMouse&&(a.DisableMouse=t.DisableMouse),t.ScriptError&&(a.ScriptErrorCallback=t.ScriptError),sa.IsString(t.SplashTitle)&&(a.LoadDataSplashTitle=t.SplashTitle),sa.IsBool(t.EnableZoomIndexWindow)&&(a.EnableZoomIndexWindow=t.EnableZoomIndexWindow),sa.IsBool(t.IsDrawPictureXY)&&(a.IsDrawPictureXY=t.IsDrawPictureXY),sa.IsBool(t.EnableNewIndex)&&(a.EnableNewIndex=t.EnableNewIndex),sa.IsBool(t.EnableIndexChartDrag)&&(a.EnableIndexChartDrag=t.EnableIndexChartDrag),sa.IsBool(t.EnableVerifyRecvData)&&(a.EnableVerifyRecvData=t.EnableVerifyRecvData),sa.IsBool(t.EnableNightDayBG)&&(a.EnableNightDayBG=t.EnableNightDayBG),sa.IsNumber(t.MaxDayCount)&&(a.MaxDayCount=t.MaxDayCount),sa.IsBool(t.EnableSelectRect)&&(t.DragSelectRect||(t.DragSelectRect={}),t.DragSelectRect.Enable=!0,t.DragSelectRect.EnableLButton=!0),t.GlobalOption){var n=t.GlobalOption;sa.IsBool(n.IsValueFullRange)&&(a.GlobalOption.IsValueFullRange=n.IsValueFullRange),sa.IsNumber(n.XDateFormat)&&(a.GlobalOption.XDateFormat=n.XDateFormat)}if(t.DisplayLatest){n=t.DisplayLatest;sa.IsBool(n.Enable)&&(a.DisplayLatestOption.Enable=n.Enable),sa.IsNumber(n.DelayTime)&&(a.DisplayLatestOption.DelayTime=n.DelayTime)}if(t.DrawDynamicInfo){n=t.DrawDynamicInfo;sa.IsBool(n.Enable)&&(a.DrawDynamicInfoOption.Enable=n.Enable),sa.IsNumber(n.DelayTime)&&(a.DrawDynamicInfoOption.DelayTime=n.DelayTime)}if(t.Minute&&(0==t.Minute.IsShowTooltip&&(a.IsShowTooltip=!1),t.Minute.DragMode>=0&&(a.DragMode=t.Minute.DragMode)),t.Language){var o=$i.GetLanguageID(t.Language);sa.IsNumber(o)&&(a.LanguageID=o)}if(t.Info&&t.Info.length>0&&a.SetMinuteInfo(t.Info,!1),t.DrawTool&&t.DrawTool.StorageKey&&a.ChartDrawStorage&&a.ChartDrawStorage.Load(t.DrawTool.StorageKey),t.BeforeOpen){n=t.BeforeOpen;sa.IsBool(n.IsShow)&&(a.IsShowBeforeData=n.IsShow),sa.IsNumber(n.Width)&&(a.ExtendWidth.Left=n.Width),sa.IsBool(n.IsShowMultiDay)&&(a.IsShowMultiDayBeforeData=n.IsShowMultiDay),sa.IsNumber(n.MulitiDayWidth)&&(a.MultiDayExtendWidth.Left=n.MulitiDayWidth)}if(t.AfterClose){n=t.AfterClose;sa.IsBool(n.IsShow)&&(a.IsShowAfterData=n.IsShow),sa.IsNumber(n.ShareVol)&&(a.ShareAfterVol=n.ShareVol),sa.IsNumber(n.Width)&&(a.ExtendWidth.Right=n.Width),sa.IsBool(n.IsShowMultiDay)&&(a.IsShowMultiDayAfterData=n.IsShowMultiDay),sa.IsNumber(n.MulitiDayWidth)&&(a.MultiDayExtendWidth.Right=n.MulitiDayWidth)}if(t.SelectedChart){n=t.SelectedChart;sa.IsBool(n.EnableSelected)&&(a.SelectedChart.EnableSelected=n.EnableSelected),sa.IsBool(n.EnableMoveOn)&&(a.SelectedChart.EnableMoveOn=n.EnableMoveOn)}if("MinuteChartContainer"==a.ClassName&&(t.DragSelectRect||(t.DragSelectRect={Enable:!0}),t.DragSelectRect)){n=t.DragSelectRect;var s=10;sa.IsNumber(n.ZIndex)&&(s=n.ZIndex),n.Enable&&this.CreateExtraCanvasElement(c.RectDragCanvasKey,{ZIndex:s})}if(t.EnableYDrag){n=t.EnableYDrag;sa.IsBool(n.Left)&&(a.EnableYDrag.Left=n.Left),sa.IsBool(n.Right)&&(a.EnableYDrag.Right=n.Right),sa.IsBool(n.Wheel)&&(a.EnableYDrag.Wheel=n.Wheel),sa.IsNumber(n.WheelYMove)&&(a.EnableYDrag.WheelYMove=n.WheelYMove)}if(t.FastSlide){n=t.FastSlide;sa.IsNumber(n.MinDistance)&&(a.FastSlideConfig.MinDistance=n.MinDistance),sa.IsNumber(n.MinSpeed)&&(a.FastSlideConfig.MinSpeed=n.MinSpeed),sa.IsNumber(n.MaxTime)&&(a.FastSlideConfig.MaxTime=n.MaxTime),sa.IsBool(n.Enable)&&(a.FastSlideConfig.Enable=n.Enable)}if(t.PageInfo&&a.SetPageInfo(t.PageInfo),a.Create(r,t),t.CorssCursorInfo){n=t.CorssCursorInfo;if(isNaN(t.CorssCursorInfo.Left)||(a.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(a.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(a.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(a.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),t.CorssCursorInfo.RightTextFormat>0&&(a.ChartCorssCursor.TextFormat.Right=t.CorssCursorInfo.RightTextFormat),1==t.CorssCursorInfo.IsOnlyDrawMinute&&(a.ChartCorssCursor.IsOnlyDrawMinute=t.CorssCursorInfo.IsOnlyDrawMinute),sa.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(a.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),n.RightButton&&sa.IsBool(n.RightButton.Enable)&&(a.ChartCorssCursor.RightButton.Enable=n.RightButton.Enable),n.BottomButton){var h=n.BottomButton;sa.IsBool(h.Enable)&&(a.ChartCorssCursor.BottomButton.Enable=h.Enable)}sa.IsNumber(n.PriceFormatType)&&(a.ChartCorssCursor.StringFormatY.PriceFormatType=n.PriceFormatType),sa.IsNumber(n.DataFormatType)&&(a.ChartCorssCursor.StringFormatY.DataFormatType=n.DataFormatType),sa.IsNumber(n.HPenType)&&(a.ChartCorssCursor.HPenType=n.HPenType),sa.IsNumber(n.VPenType)&&(a.ChartCorssCursor.VPenType=n.VPenType),sa.IsBool(n.EnableKeyboard)&&(a.ChartCorssCursor.EnableKeyboard=n.EnableKeyboard),sa.IsBool(n.EnableDBClick)&&(a.ChartCorssCursor.EnableDBClick=n.EnableDBClick),sa.IsBool(n.IsShowCorssPoint)&&(a.ChartCorssCursor.CorssPointConfig.Enable=n.IsShowCorssPoint),sa.IsNumber(n.VLineType)&&(a.ChartCorssCursor.VLineType=n.VLineType)}if(t.MinuteInfo&&a.CreateMinuteInfo(t.MinuteInfo),sa.IsBool(t.IsShowRightMenu)&&(a.IsShowRightMenu=t.IsShowRightMenu),sa.IsNumber(t.DayCount)&&(a.DayCount=t.DayCount),this.SetChartBorder(a,t),t.SplashTitle&&(a.ChartSplashPaint.SplashTitle=t.SplashTitle),sa.IsBool(t.EnableBorderDrag)&&(a.EnableBorderDrag=t.EnableBorderDrag),sa.IsBool(t.EnableBuySellBar)){var l=a.GetChartMinuteBuySellBar();l&&(l.IsShow=t.EnableBuySellBar)}if(this.AdjustChartBorder(a),t.Frame){for(var u=0;u<t.Frame.length;++u){n=t.Frame[u];if(a.Frame.SubFrame[u]){var C=a.Frame.SubFrame[u].Frame;sa.IsNumber(n.SplitCount)&&(a.Frame.SubFrame[u].Frame.YSplitOperator.SplitCount=n.SplitCount),n.StringFormat&&(a.Frame.SubFrame[u].Frame.YSplitOperator.StringFormat=n.StringFormat),sa.IsNumber(n.SplitType)&&(a.Frame.SubFrame[u].Frame.YSplitOperator.SplitType=n.SplitType,a.Frame.SubFrame[u].Frame.YSplitOperator.DefaultSplitType=n.SplitType),sa.IsNumber(n.FilterType)&&(C.YSplitOperator.FilterType=n.FilterType),0==n.IsShowLeftText&&(a.Frame.SubFrame[u].Frame.IsShowYText[0]=n.IsShowLeftText,a.Frame.SubFrame[u].Frame.YSplitOperator.IsShowLeftText=n.IsShowLeftText),0==n.IsShowRightText&&(a.Frame.SubFrame[u].Frame.IsShowYText[1]=n.IsShowRightText,a.Frame.SubFrame[u].Frame.YSplitOperator.IsShowRightText=n.IsShowRightText),n.Height>=0&&(a.Frame.SubFrame[u].Height=n.Height),n.Custom&&(a.Frame.SubFrame[u].Frame.YSplitOperator.Custom=n.Custom),sa.IsNumber(n.TitleHeight)&&(a.Frame.SubFrame[u].Frame.ChartBorder.TitleHeight=n.TitleHeight),sa.IsNumber(n.BorderLine)&&(a.Frame.SubFrame[u].Frame.BorderLine=n.BorderLine),sa.IsBool(n.EnableRemoveZero)&&(a.Frame.SubFrame[u].Frame.YSplitOperator.EnableRemoveZero=n.EnableRemoveZero),sa.IsNumber(n.FloatPrecision)&&(a.Frame.SubFrame[u].Frame.YSplitOperator.FloatPrecision=n.FloatPrecision),sa.IsBool(n.IsShowXLine)&&(a.Frame.SubFrame[u].Frame.IsShowXLine=n.IsShowXLine),sa.IsBool(n.IsShowYLine)&&(a.Frame.SubFrame[u].Frame.IsShowYLine=n.IsShowYLine),sa.IsNumber(n.YTextBaseline)&&(a.Frame.SubFrame[u].Frame.YTextBaseline=n.YTextBaseline),sa.IsBool(n.IsShowIndexTitle)&&(a.Frame.SubFrame[u].Frame.IsShowIndexTitle=n.IsShowIndexTitle),n.TopSpace>=0&&(a.Frame.SubFrame[u].Frame.ChartBorder.TopSpace=n.TopSpace*i),n.BottomSpace>=0&&(a.Frame.SubFrame[u].Frame.ChartBorder.BottomSpace=n.BottomSpace*i),sa.IsBool(n.CloseBeforeButton)&&(a.Frame.SubFrame[u].Frame.IsShowCloseButton=n.CloseBeforeButton),n.ClientBGColor&&(C.ClientBGColor=n.ClientBGColor),sa.IsUndefined(n.HorizontalReserved)||(C.HorizontalReserved=n.HorizontalReserved),0==u&&sa.IsNumber(n.RightTextFormat)&&(C.YSplitOperator.RightTextFormat=n.RightTextFormat,2==n.RightTextFormat&&(C.MultiTextFormat=1))}}a.UpdateXShowText()}if(t.ExtendChart)for(u=0;u<t.ExtendChart.length;++u){n=t.ExtendChart[u];a.CreateExtendChart(n.Name,n)}if(t.Overlay)for(u=0;u<t.Overlay.length;++u){n=t.Overlay[u];a.OverlaySymbol(n.Symbol,n)}if(t.MinuteLine){if(0==t.MinuteLine.IsDrawAreaPrice&&(a.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowLead&&(a.IsShowLead=!1),0==t.MinuteLine.IsShowAveragePrice){a.ChartPaint[1].IsShow=!1,a.TitlePaint[0].IsShowAveragePrice=!1;for(u=0;u<a.ExtendChartPaint.length;++u){n=a.ExtendChartPaint[u];"MinuteTooltipPaint"==n.ClassName&&(n.IsShowAveragePrice=!1)}}t.MinuteLine.SplitType>0&&(a.Frame.SubFrame[0].Frame.YSplitOperator.SplitType=t.MinuteLine.SplitType)}if(t.MinuteVol){n=t.MinuteVol;sa.IsNumber(n.BarColorType)&&(a.ChartPaint[2].BarColorType=n.BarColorType)}if(t.MinuteTitle){n=t.MinuteTitle;var D=a.TitlePaint[0];if(sa.IsBool(n.IsShowName)&&(a.TitlePaint[0].IsShowName=n.IsShowName),sa.IsBool(n.IsShowDate)&&(a.TitlePaint[0].IsShowDate=n.IsShowDate),sa.IsBool(n.IsShowTime)&&(a.TitlePaint[0].IsShowTime=n.IsShowTime),sa.IsBool(n.IsTitleShowLatestData)&&(a.IsTitleShowLatestData=n.IsTitleShowLatestData),sa.IsBool(n.IsAlwaysShowLastData)&&(a.TitlePaint[0].IsAlwaysShowLastData=n.IsAlwaysShowLastData),sa.IsNumber(n.ShowLastDataFormat)&&(a.TitlePaint[0].ShowLastDataFormat=n.ShowLastDataFormat),n.TimeFormat&&(a.TitlePaint[0].TimeFormat=n.TimeFormat),n.ShowPostion||n.ShowPosition){h=n.ShowPostion;n.ShowPosition&&(h=n.ShowPosition),D.ShowPositionConfig||(D.ShowPositionConfig={Margin:{}}),sa.IsNumber(h.Type)&&(D.ShowPositionConfig.Type=h.Type),h.Margin&&(sa.IsNumber(h.Margin.Left)&&(D.ShowPositionConfig.Margin.Left=h.Margin.Left),sa.IsNumber(h.Margin.Right)&&(D.ShowPositionConfig.Margin.Right=h.Margin.Right),sa.IsNumber(h.Margin.Bottom)&&(D.ShowPositionConfig.Margin.Bottom=h.Margin.Bottom))}}if(sa.IsBool(t.CorssCursorTouchEnd)&&(a.CorssCursorTouchEnd=t.CorssCursorTouchEnd),sa.IsBool(t.IsClickShowCorssCursor)&&(a.IsClickShowCorssCursor=t.IsClickShowCorssCursor),!0===t.IsShowBeforeData&&(a.IsShowBeforeData=t.IsShowBeforeData),sa.IsNonEmptyArray(t.Windows)){var m=new f;for(u=0;u<t.Windows.length;++u){var d=2+u;n=t.Windows[u];if(n.Script)a.WindowIndex[d]=new pn(n.Name,n.Script,n.Args,n);else if(n.API){var I=n.API;a.WindowIndex[d]=new xn(I.Name,I.Script,I.Args,n)}else{var S=tr.Get(n.Index);if(S)a.WindowIndex[d]=S.Create(),a.CreateWindowIndex(d);else{var T=m.Get(n.Index);if(!T)continue;f.ModifyAttribute(T,n),T.ID=n.Index,a.WindowIndex[d]=new pn(T.Name,T.Script,T.Args,T),n.StringFormat>0&&(a.WindowIndex[d].StringFormat=n.StringFormat),n.FloatPrecision>=0&&(a.WindowIndex[d].FloatPrecision=n.FloatPrecision)}}var v=a.Frame.SubFrame[d].Frame;sa.IsBool(n.Modify)&&(v.ModifyIndex=n.Modify),sa.IsBool(n.Change)&&(v.ChangeIndex=n.Change),sa.IsBool(n.Close)&&(v.CloseIndex=n.Close),sa.IsBool(n.Overlay)&&(v.OverlayIndex=n.Overlay),sa.IsBool(n.Export)&&(v.ExportData=n.Export),sa.IsBool(n.MaxMin)&&(v.MaxMinWindow=n.MaxMin),sa.IsBool(n.TitleWindow)&&(v.TitleWindow=n.TitleWindow),sa.IsBool(n.AddIndexWindow)&&(v.AddIndexWindow=n.AddIndexWindow),sa.IsNumber(n.YSplitType)&&(a.Frame.SubFrame[d].Frame.YSplitOperator.SplitType=n.YSplitType),sa.IsNumber(n.FilterType)&&(a.Frame.SubFrame[d].Frame.YSplitOperator.FilterType=n.FilterType),isNaN(n.TitleHeight)||(a.Frame.SubFrame[d].Frame.ChartBorder.TitleHeight=n.TitleHeight),sa.IsBool(n.IsDrawTitleBG)&&(a.Frame.SubFrame[d].Frame.IsDrawTitleBG=n.IsDrawTitleBG),sa.IsBool(n.IsShowNameArrow)&&(a.Frame.SubFrame[d].Frame.IsShowNameArrow=n.IsShowNameArrow),sa.IsBool(n.IsShowTitleArrow)&&(v.IsShowTitleArrow=n.IsShowTitleArrow),sa.IsNumber(n.TitleArrowType)&&(v.TitleArrowType=n.TitleArrowType),0==n.IsShowIndexName&&(a.Frame.SubFrame[d].Frame.IsShowIndexName=!1),0==n.IsShowOverlayIndexName&&(a.Frame.SubFrame[d].Frame.IsShowOverlayIndexName=!1),sa.IsUndefined(n.HorizontalReserved)||(v.HorizontalReserved=n.HorizontalReserved)}}if(this.AdjustTitleHeight(a),sa.IsNonEmptyArray(t.OverlayIndex))for(u=0;u<t.OverlayIndex.length;++u){n=t.OverlayIndex[u];if(!(n.Windows>=a.Frame.SubFrame.length)){var p=JSON.stringify(n),g=JSON.parse(p);n.Index&&(g.IndexName=n.Index),n.Windows>=0&&(g.WindowIndex=n.Windows),a.CreateOverlayWindowsIndex(g)}}return a},this.CreateMinMinuteChartContainer=function(t){var e=null;e="迷你分钟走势图横屏"===t.Type?new Dr(this.CanvasElement):new sr(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter);if(t.BeforeOpen){var a=t.BeforeOpen;sa.IsBool(a.IsShow)&&(e.IsShowBeforeData=a.IsShow),sa.IsNumber(a.Width)&&(e.ExtendWidth.Left=a.Width),sa.IsBool(a.IsShowMultiDay)&&(e.IsShowMultiDayBeforeData=a.IsShowMultiDay),sa.IsNumber(a.MulitiDayWidth)&&(e.MultiDayExtendWidth.Left=a.MulitiDayWidth)}if(t.AfterClose){a=t.AfterClose;sa.IsBool(a.IsShow)&&(e.IsShowAfterData=a.IsShow),sa.IsNumber(a.ShareVol)&&(e.ShareAfterVol=a.ShareVol),sa.IsNumber(a.Width)&&(e.ExtendWidth.Right=a.Width),sa.IsBool(a.IsShowMultiDay)&&(e.IsShowMultiDayAfterData=a.IsShowMultiDay),sa.IsNumber(a.MulitiDayWidth)&&(e.MultiDayExtendWidth.Right=a.MulitiDayWidth)}if(t.Listener||(t.Listener={KeyDown:!1,Wheel:!1}),e.Create(2,t.Listener),t.CorssCursorInfo){a=t.CorssCursorInfo;sa.IsNumber(t.CorssCursorInfo.Left)&&(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),sa.IsNumber(t.CorssCursorInfo.Right)&&(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),sa.IsNumber(t.CorssCursorInfo.Bottom)&&(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),t.CorssCursorInfo.RightTextFormat>0&&(e.ChartCorssCursor.TextFormat.Right=t.CorssCursorInfo.RightTextFormat),1==t.CorssCursorInfo.IsOnlyDrawMinute&&(e.ChartCorssCursor.IsOnlyDrawMinute=t.CorssCursorInfo.IsOnlyDrawMinute),sa.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(e.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),a.RightButton&&sa.IsBool(a.RightButton.Enable)&&(e.ChartCorssCursor.RightButton.Enable=a.RightButton.Enable),sa.IsNumber(a.PriceFormatType)&&(e.ChartCorssCursor.StringFormatY.PriceFormatType=a.PriceFormatType),sa.IsNumber(a.DataFormatType)&&(e.ChartCorssCursor.StringFormatY.DataFormatType=a.DataFormatType),sa.IsNumber(t.CorssCursorInfo.HPenType)&&(e.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),sa.IsNumber(t.CorssCursorInfo.VPenType)&&(e.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType)}sa.IsNumber(t.DayCount)&&(e.DayCount=t.DayCount),this.SetChartBorder(e,t),t.SplashTitle&&(e.ChartSplashPaint.SplashTitle=t.SplashTitle),sa.IsBool(t.EnableVerifyRecvData)&&(e.EnableVerifyRecvData=t.EnableVerifyRecvData),e.TitlePaint[0].IsShow=!1;var i=e.Frame.SubFrame[0];if(i.Frame.IsShowYText[0]=!1,i.Frame.IsShowYText[1]=!1,i.Frame.IsShowXLine=!1,i.Frame.IsShowYLine=!1,i.Frame.BorderLine=0,e.Frame.SubFrame[1].Height=0,e.EnableBorderDrag=!1,t.Frame)for(var r=0;r<t.Frame.length;++r){a=t.Frame[r];e.Frame.SubFrame[r]&&(a.SplitCount&&(e.Frame.SubFrame[r].Frame.YSplitOperator.SplitCount=a.SplitCount),a.StringFormat&&(e.Frame.SubFrame[r].Frame.YSplitOperator.StringFormat=a.StringFormat),sa.IsNumber(a.SplitType)&&(e.Frame.SubFrame[r].Frame.YSplitOperator.SplitType=a.SplitType,e.Frame.SubFrame[r].Frame.YSplitOperator.DefaultSplitType=a.SplitType),sa.IsBool(a.IsShowLeftText)&&(e.Frame.SubFrame[r].Frame.IsShowYText[0]=a.IsShowLeftText,e.Frame.SubFrame[r].Frame.YSplitOperator.IsShowLeftText=a.IsShowLeftText),sa.IsBool(a.IsShowRightText)&&(e.Frame.SubFrame[r].Frame.IsShowYText[1]=a.IsShowRightText,e.Frame.SubFrame[r].Frame.YSplitOperator.IsShowRightText=a.IsShowRightText),a.Height>=0&&(e.Frame.SubFrame[r].Height=a.Height),a.Custom&&(e.Frame.SubFrame[r].Frame.YSplitOperator.Custom=a.Custom),a.RightTextFormat>0&&(e.Frame.SubFrame[r].Frame.YSplitOperator.RightTextFormat=a.RightTextFormat),sa.IsNumber(a.TitleHeight)&&(e.Frame.SubFrame[r].Frame.ChartBorder.TitleHeight=a.TitleHeight),sa.IsNumber(a.BorderLine)&&(e.Frame.SubFrame[r].Frame.BorderLine=a.BorderLine),sa.IsBool(a.EnableRemoveZero)&&(e.Frame.SubFrame[r].Frame.YSplitOperator.EnableRemoveZero=a.EnableRemoveZero),sa.IsNumber(a.FloatPrecision)&&(e.Frame.SubFrame[r].Frame.YSplitOperator.FloatPrecision=a.FloatPrecision),sa.IsBool(a.IsShowXLine)&&(e.Frame.SubFrame[r].Frame.IsShowXLine=a.IsShowXLine),sa.IsBool(a.IsShowYLine)&&(e.Frame.SubFrame[r].Frame.IsShowYLine=a.IsShowYLine),sa.IsNumber(a.YTextBaseline)&&(e.Frame.SubFrame[r].Frame.YTextBaseline=a.YTextBaseline))}if(e.UpdateXShowText(),t.MinuteLine){if(0==t.MinuteLine.IsDrawAreaPrice&&(e.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowLead&&(e.IsShowLead=!1),0==t.MinuteLine.IsShowAveragePrice){e.ChartPaint[1].IsShow=!1,e.TitlePaint[0].IsShowAveragePrice=!1;for(r=0;r<e.ExtendChartPaint.length;++r){a=e.ExtendChartPaint[r];"MinuteTooltipPaint"==a.ClassName&&(a.IsShowAveragePrice=!1)}}t.MinuteLine.SplitType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.SplitType=t.MinuteLine.SplitType)}if(this.AdjustTitleHeight(e),!0===t.DisableMouseEvent&&(this.CanvasElement.onmousemove=function(t){},this.CanvasElement.oncontextmenu=function(t){},this.CanvasElement.ondblclick=function(t){},this.CanvasElement.onmousedown=function(t){},this.CanvasElement.onmouseout=function(t){},this.CanvasElement.onmouseleave=function(t){}),t.ExtendChart)for(r=0;r<t.ExtendChart.length;++r){a=t.ExtendChart[r];e.CreateExtendChart(a.Name,a)}return e},this.CreateKLineTrainChartContainer=function(t){var e=!1;if("简单K线训练"==t.Type||"简单K线训练横屏"==t.Type){var a="简单K线训练横屏"==t.Type,i=new ur(this.CanvasElement,a);e=!0}else a="K线训练横屏"==t.Type,i=new lr(this.CanvasElement,a);if(t.NetworkFilter&&(i.NetworkFilter=t.NetworkFilter),1==t.IsApiPeriod&&(i.IsApiPeriod=t.IsApiPeriod),t.ScriptError&&(i.ScriptErrorCallback=t.ScriptError),t.KLine&&(t.KLine.Right>=0&&(i.Right=t.KLine.Right),t.KLine.Period>=0&&(i.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(i.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&i.SetKLineInfo(t.KLine.Info,!1),t.KLine.PageSize>0&&(i.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(i.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(i.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(i.KLineDrawType=t.KLine.DrawType),sa.IsNumber(t.KLine.RightSpaceCount)&&!e&&(i.RightSpaceCount=t.KLine.RightSpaceCount)),t.Train&&(t.Train.DataCount&&(i.TrainDataCount=t.Train.DataCount),t.Train.Callback&&(i.TrainCallback=t.Train.Callback),t.Train.StartDate&&(i.TrainStartDate=t.Train.StartDate)),!t.Windows||t.Windows.length<=0)return null;if(i.Create(t.Windows.length),this.SetChartBorder(i,t),this.AdjustChartBorder(i),0==t.IsShowCorssCursorInfo&&(i.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),!0===t.IsCorssOnlyDrawKLine&&(i.ChartCorssCursor.IsOnlyDrawKLine=t.IsCorssOnlyDrawKLine),!0===t.CorssCursorTouchEnd&&(i.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(i.IsClickShowCorssCursor=t.IsClickShowCorssCursor),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(i.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(i.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(i.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(i.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(i.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.PressTime&&(i.PressTime=t.CorssCursorInfo.PressTime),t.CorssCursorInfo.HPenType>0&&(i.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(i.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType)),t.CorssCursor={},t.CorssCursor.TitleHeight=i.ChartCorssCursor.TextHeight,t.Frame)for(var r=0;r<t.Frame.length;++r){var n=t.Frame[r];i.Frame.SubFrame[r]&&(n.SplitCount&&(i.Frame.SubFrame[r].Frame.YSplitOperator.SplitCount=n.SplitCount),n.StringFormat&&(i.Frame.SubFrame[r].Frame.YSplitOperator.StringFormat=n.StringFormat),sa.IsNumber(n.FloatPrecision)&&(i.Frame.SubFrame[r].Frame.YSplitOperator.FloatPrecision=n.FloatPrecision),n.Custom&&(i.Frame.SubFrame[r].Frame.YSplitOperator.Custom=n.Custom),sa.IsNumber(n.SplitType)&&(i.Frame.SubFrame[r].Frame.YSplitOperator.SplitType=n.SplitType),n.Height>0&&(i.Frame.SubFrame[r].Height=n.Height),0==n.IsShowLeftText&&(i.Frame.SubFrame[r].Frame.YSplitOperator.IsShowLeftText=n.IsShowLeftText),0==n.IsShowRightText&&(i.Frame.SubFrame[r].Frame.YSplitOperator.IsShowRightText=n.IsShowRightText))}if(t.KLine&&(0==t.KLine.ShowKLine&&(i.ChartPaint[0].IsShow=!1),t.KLine.InfoPosition>0&&(i.ChartPaint[0].InfoPosition=t.KLine.InfoPosition),0==t.KLine.IsShowMaxMinPrice&&(i.ChartPaint[0].IsShowMaxMinPrice=t.KLine.IsShowMaxMinPrice)),t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(i.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(i.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(i.TitlePaint[0].IsShow=!1)),sa.IsNonEmptyArray(t.Overlay))for(r=0;r<t.Overlay.length;++r){n=t.Overlay[r];i.OverlaySymbol(n.Symbol,n)}if(t.ExtendChart)for(r=0;r<t.ExtendChart.length;++r){n=t.ExtendChart[r];i.CreateExtendChart(n.Name,n)}if(sa.IsNonEmptyArray(t.Windows))for(r=0;r<t.Windows.length;++r){n=t.Windows[r];if(n.Script)i.WindowIndex[r]=new pn(n.Name,n.Script,n.Args,n);else{var o=tr.Get(n.Index);if(o)i.WindowIndex[r]=o.Create(),i.CreateWindowIndex(r);else{var s=new f,h=s.Get(n.Index);if(!h)continue;n.Lock&&(h.Lock=n.Lock),i.WindowIndex[r]=new pn(h.Name,h.Script,h.Args,h)}}null!=n.Modify&&(i.Frame.SubFrame[r].Frame.ModifyIndex=n.Modify),null!=n.Change&&(i.Frame.SubFrame[r].Frame.ChangeIndex=n.Change),null!=n.Close&&(i.Frame.SubFrame[r].Frame.CloseIndex=n.Close),null!=n.Overlay&&(frame.OverlayIndex=n.Overlay),sa.IsBool(n.Export)&&(frame.ExportData=n.Export),sa.IsBool(n.MaxMin)&&(i.Frame.SubFrame[r].Frame.MaxMinWindow=n.MaxMin),sa.IsBool(n.TitleWindow)&&(i.Frame.SubFrame[r].Frame.TitleWindow=n.TitleWindow),sa.IsBool(n.IsDrawTitleBG)&&(i.Frame.SubFrame[r].Frame.IsDrawTitleBG=n.IsDrawTitleBG),sa.IsBool(n.IsShowNameArrow)&&(i.Frame.SubFrame[r].Frame.IsShowNameArrow=n.IsShowNameArrow),sa.IsNumber(n.TitleHeight)&&(i.Frame.SubFrame[r].Frame.ChartBorder.TitleHeight=n.TitleHeight),sa.IsBool(n.IsShowTitleArrow)&&(i.Frame.SubFrame[r].Frame.IsShowTitleArrow=n.IsShowTitleArrow),0==n.IsShowIndexName&&(i.Frame.SubFrame[r].Frame.IsShowIndexName=!1),0==n.IsShowOverlayIndexName&&(i.Frame.SubFrame[r].Frame.IsShowOverlayIndexName=!1),sa.IsNumber(n.IndexParamSpace)&&(i.Frame.SubFrame[r].Frame.IndexParamSpace=n.IndexParamSpace),sa.IsNumber(n.IndexTitleSpace)&&(i.Frame.SubFrame[r].Frame.IndexTitleSpace=n.IndexTitleSpace)}return this.AdjustTitleHeight(i),i},this.CreateDepthChartContainer=function(t){var e=null;if(e=new fr(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),sa.IsPlusNumber(t.MaxVolRate)&&(e.MaxVolRate=t.MaxVolRate),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),sa.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),sa.IsBool(t.EnableVerifyRecvData)&&(e.EnableVerifyRecvData=t.EnableVerifyRecvData),t.Language){var a=$i.GetLanguageID(t.Language);sa.IsNumber(a)&&(e.LanguageID=a)}if(e.Create(t.Listener),t.Border&&(sa.IsNumber(t.Border.Left)?e.Frame.ChartBorder.Left=t.Border.Left:t.Border.Left=e.Frame.ChartBorder.Left,sa.IsNumber(t.Border.Right)?e.Frame.ChartBorder.Right=t.Border.Right:t.Border.Right=e.Frame.ChartBorder.Right,sa.IsNumber(t.Border.Top)?e.Frame.ChartBorder.Top=t.Border.Top:t.Border.Top=e.Frame.ChartBorder.Top,sa.IsNumber(t.Border.Bottom)?e.Frame.ChartBorder.Bottom=t.Border.Bottom:t.Border.Bottom=e.Frame.ChartBorder.Bottom),this.AdjustChartBorder(e),!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),t.CorssCursorInfo){var i=t.CorssCursorInfo;sa.IsNumber(i.HPenType)&&(e.ChartCorssCursor.HPenType=i.HPenType),sa.IsNumber(i.VPenType)&&(e.ChartCorssCursor.VPenType=i.VPenType),sa.IsBool(i.IsShowTooltip)&&(e.ChartCorssCursor.IsShowTooltip=i.IsShowTooltip)}if(t.Frame){i=t.Frame;i.SplitCount&&(e.Frame.YSplitOperator.SplitCount=i.SplitCount),sa.IsNumber(i.SplitType)&&(e.Frame.YSplitOperator.SplitType=i.SplitType),sa.IsNumber(i.Height)&&(e.Frame.Height=i.Height),sa.IsNumber(i.YLineType)&&(e.Frame.YSplitOperator.LineType=i.YLineType),sa.IsNumber(i.XLineType)&&(e.Frame.XSplitOperator.LineType=i.XLineType),Array.isArray(i.IgnoreYValue)&&(e.Frame.YSplitOperator.IgnoreYValue=i.IgnoreYValue),!1!==i.IsShowLeftText&&!0!==i.IsShowLeftText||(e.Frame.IsShowYText[0]=i.IsShowLeftText,e.Frame.YSplitOperator.IsShowLeftText=i.IsShowLeftText),!1!==i.IsShowRightText&&!0!==i.IsShowRightText||(e.Frame.IsShowYText[1]=i.IsShowRightText,e.Frame.YSplitOperator.IsShowRightText=i.IsShowRightText),0==i.IsShowXLine&&(e.Frame.IsShowXLine=i.IsShowXLine),0==i.IsShowYLine&&(e.Frame.IsShowYLine=i.IsShowYLine),sa.IsNumber(i.XSplitCount)&&(e.Frame.XSplitOperator.SplitCount=i.XSplitCount)}return e},this.SetOption=function(t){sa.IsNumber(t.ToolbarButtonStyle)&&(qi.ToolbarButtonStyle=t.ToolbarButtonStyle);var e=null;switch(t.Type){case"历史K线图":case"历史K线图横屏":e=this.CreateKLineChartContainer(t);break;case"自定义指数历史K线图":e=this.CreateCustomKLineChartContainer(t);break;case"分钟走势图":case"分钟走势图横屏":e=this.CreateMinuteChartContainer(t);break;case"迷你分钟走势图":e=this.CreateMinMinuteChartContainer(t);break;case"K线训练":case"K线训练横屏":case"简单K线训练":case"简单K线训练横屏":e=this.CreateKLineTrainChartContainer(t);break;case"深度图":e=this.CreateDepthChartContainer(t);break;default:return!1}if(!e)return!1;if(this.JSChartContainer=e,e.DivElement=this.DivElement,1==t.EnableResize&&this.CreateResizeListener(),t.DefaultCursor&&(e.DefaultCursor=t.DefaultCursor),t.OnCreatedCallback&&t.OnCreatedCallback(e),null!=t.IsAutoUpdate&&(e.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),!0===t.EnablePopMenuV2&&e.InitalPopMenu(),!0===t.EnableDrawToolDialogV2&&e.InitalDrawToolDialog(),!0===t.EnableModifyDrawDialogV2&&e.InitalModifyDrawDialog(),t.TooltipDialog&&t.TooltipDialog.Enable&&e.InitalTooltipDialog(t.TooltipDialog),t.FloatTooltip&&t.FloatTooltip.Enable&&e.InitalFloatTooltip(t.FloatTooltip),t.SelectRectDialog&&t.SelectRectDialog.Enable&&e.InitalSelectRectDialog(t.SelectRectDialog),t.ModifyIndexParamDialog&&t.ModifyIndexParamDialog.Enable&&e.InitalModifyIndexParamDialog(t.ModifyIndexParamDialog),t.SearchIndexDialog&&t.SearchIndexDialog.Enable&&e.InitalSearchIndexDialog(t.SearchIndexDialog),t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}t.Symbol?(e.Draw(),e.ChangeSymbol(t.Symbol),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()):(e.DrawEmpty(),this.JSChartContainer=e,this.DivElement.JSChart=this)},this.CreateResizeListener=function(){var t=this;this.ResizeListener=new ResizeObserver((function(e){t.OnDivResize(e)})),this.ResizeListener.observe(this.DivElement)},this.OnDivResize=function(t){u.Chart.Log("[JSChart::OnDivResize] entries=",t),this.OnSize({Type:1})},this.CreateToolbar=function(t){},this.CreateSettingDiv=function(t){},this.Focus=function(){this.CanvasElement&&this.CanvasElement.focus()},this.ChangeSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t,e)},this.ChangeIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndex&&this.JSChartContainer.ChangeIndex(t,e,a)},this.ChangeIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexWindow&&this.JSChartContainer.ChangeIndexWindow(t,e)},this.AddIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddIndexWindow&&this.JSChartContainer.AddIndexWindow(t,e)},this.AddScriptIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddScriptIndexWindow&&this.JSChartContainer.AddScriptIndexWindow(t,e)},this.AddAPIIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddAPIIndexWindow&&this.JSChartContainer.AddAPIIndexWindow(t,e)},this.RemoveIndexWindow=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.RemoveIndexWindow&&this.JSChartContainer.RemoveIndexWindow(t)},this.ChangeScriptIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeScriptIndex&&this.JSChartContainer.ChangeScriptIndex(t,e,a)},this.ChangePyScriptIndex=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePyScriptIndex&&this.JSChartContainer.ChangePyScriptIndex(t,e)},this.GetIndexInfo=function(){return this.JSChartContainer&&"function"==typeof this.JSChartContainer.GetIndexInfo?this.JSChartContainer.GetIndexInfo():[]},this.UpdateWindowIndexV2=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.UpdateWindowIndexV2)return this.JSChartContainer.UpdateWindowIndexV2(t,e)},this.ChangeInstructionIndex=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionIndex(t,e)},this.ChangeInstructionScriptIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionScriptIndex(t)},this.CancelInstructionIndex=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.CancelInstructionIndex&&this.JSChartContainer.CancelInstructionIndex()},this.ChangePeriod=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePeriod&&this.JSChartContainer.ChangePeriod(t,e)},this.ChangeRight=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeRight&&this.JSChartContainer.ChangeRight(t)},this.OverlaySymbol=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.OverlaySymbol&&this.JSChartContainer.OverlaySymbol(t,e)},this.DeleteOverlaySymbol=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteOverlaySymbol&&this.JSChartContainer.DeleteOverlaySymbol(t)},this.SetFirstShowDate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetFirstShowDate&&this.JSChartContainer.SetFirstShowDate(t)},this.ChangeKLineDrawType=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeKLineDrawType&&this.JSChartContainer.ChangeKLineDrawType(t,e,a)},this.ChangeIndexWindowCount=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexWindowCount&&this.JSChartContainer.ChangeIndexWindowCount(t,e)},this.ClearOverlaySymbol=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearOverlaySymbol&&this.JSChartContainer.ClearOverlaySymbol()},this.DeleteKLineInfo=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteKLineInfo&&this.JSChartContainer.DeleteKLineInfo(t)},this.ClearKLineInfo=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearKLineInfo&&this.JSChartContainer.ClearKLineInfo()},this.AddKLineInfo=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddKLineInfo&&this.JSChartContainer.AddKLineInfo(t,e)},this.AddOverlayIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddOverlayIndex&&this.JSChartContainer.AddOverlayIndex(t)},this.MoveOverlayIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.MoveOverlayIndex&&this.JSChartContainer.MoveOverlayIndex(t,e,a)},this.MoveOverlayIndexToNewWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.MoveOverlayIndexToNewWindow&&this.JSChartContainer.MoveOverlayIndexToNewWindow(t,e)},this.DeleteOverlayWindowsIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteOverlayWindowsIndex&&this.JSChartContainer.DeleteOverlayWindowsIndex(t)},this.StopAutoUpdate=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.StopAutoUpdate&&this.JSChartContainer.StopAutoUpdate()},this.ChartDestroy=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestroy&&this.JSChartContainer.ChartDestroy()},this.ChartDestory=this.ChartDestroy,this.SetDepthMapData=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetDepthMapData&&this.JSChartContainer.SetDepthMapData(t,e)},this.ForceLandscape=function(t){this.JSChartContainer&&(u.Chart.Log("[JSChart::ForceLandscape] bForceLandscape="+t),this.JSChartContainer.IsForceLandscape=t)},this.LockIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.LockIndex&&(u.Chart.Log("[JSChart:LockIndex] lockData",t),this.JSChartContainer.LockIndex(t))},this.ChangeDayCount=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeDayCount&&(u.Chart.Log("[JSChart:ChangeDayCount] count",t),this.JSChartContainer.ChangeDayCount(t,e))},this.ShowCallAuctionData=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ShowCallAuctionData&&(u.Chart.Log("[JSChart:ShowCallAuctionData] obj, option ",t,e),this.JSChartContainer.ShowCallAuctionData(t,e))},this.StartAnimation=function(t){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.StartAnimation)return u.Chart.Log("[JSChart:StartAnimation] start."),this.JSChartContainer.StartAnimation(t)},this.StopAnimation=function(){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.StopAnimation)return u.Chart.Log("[JSChart:StopAnimation] start."),this.JSChartContainer.StopAnimation()},this.SaveToImage=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.SaveToImage)return this.JSChartContainer.SaveToImage(t,e)},this.SaveToImageUrl=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.SaveToImageUrl)return this.JSChartContainer.SaveToImageUrl(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(u.Chart.Log("[JSChart:AddEventCallback] ",t),this.JSChartContainer.AddEventCallback(t))},this.SetLanguage=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetLanguage&&(u.Chart.Log("[JSChart:SetLanguage] ",t),this.JSChartContainer.SetLanguage(t))},this.ChangeIndexTemplate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexTemplate&&(u.Chart.Log("[JSChart:ChangeIndexTemplate] ",t),this.JSChartContainer.ChangeIndexTemplate(t))},this.SetChartDrawOption=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetChartDrawOption&&(u.Chart.Log("[JSChart:SetChartDrawOption] ",t),this.JSChartContainer.SetChartDrawOption(t))},this.CreateChartDrawPicture=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.CreateChartDrawPicture&&(u.Chart.Log("[JSChart:CreateChartDrawPicture] ",t),this.JSChartContainer.CreateChartDrawPicture(t,e))},this.AddChartDrawPicture=function(t){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddChartDrawPicture)return u.Chart.Log("[JSChart:AddChartDrawPicture] ",t),this.JSChartContainer.AddChartDrawPicture(t)},this.ClearChartDrawPicture=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearChartDrawPicture&&this.JSChartContainer.ClearChartDrawPicture(t,e)},this.PasteChartDrawPicture=function(t,e,a){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.PasteChartDrawPicture)return u.Chart.Log("[JSChart:PasteChartDrawPicture] ",t,e,a),this.JSChartContainer.PasteChartDrawPicture(t,e,a)},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(u.Chart.Log("[JSChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.EnableSplashScreen=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.EnableSplashScreen&&(u.Chart.Log("[JSChart:EnableSplashScreen] "),this.JSChartContainer.EnableSplashScreen(t,e))},this.Draw=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(u.Chart.Log("[JSChart:Draw] "),this.JSChartContainer.Draw())},this.SetFocus=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetFocus&&(u.Chart.Log("[JSChart:SetFocus] "),this.JSChartContainer.SetFocus())},this.ExportData=function(t){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.ExportData)return u.Chart.Log("[JSChart:ExportData] "),this.JSChartContainer.ExportData(t)},this.ChangePriceGap=function(t){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePriceGap)return u.Chart.Log("[JSChart:ChangePriceGap] "),this.JSChartContainer.ChangePriceGap(t)},this.PopupMenuByTab=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.PopupMenuByTab)return u.Chart.Log("[JSChart:PopupMenuByTab] "),this.JSChartContainer.PopupMenuByTab(t,e)},this.PopupMenuByDrapdown=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.PopupMenuByDrapdown)return u.Chart.Log("[JSChart:PopupMenuByDrapdown] "),this.JSChartContainer.PopupMenuByDrapdown(t,e)},this.ExecuteMenuCommand=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.ExecuteMenuCommand)return u.Chart.Log("[JSChart:ExecuteMenuCommand] "),this.JSChartContainer.ExecuteMenuCommand(t,e)}}c.LastVersion=null,c.EnableCanvasWillReadFrequently=!1,c.CorssCursorCanvasKey="hqchart_corsscursor",c.TooltipCursorCanvasKey="hqchart_tooltip",c.RectDragCanvasKey="hqchart_drag_rect",c.Init=function(t,e,a){var i=new c(t,e,a);return i.OnSize(),i},c.SetDomain=function(t,e){t&&(qi.Domain=t),e&&(qi.CacheDomain=e)},c.SetPyIndexDomain=function(t){t&&(qi.PyIndexDomain=t)},c.SetStyle=function(t){t&&qi.SetStyle(t)},c.SetTextResource=function(t,e){$i.SetTextResource(t,e)},c.GetLocalization=function(){return $i},c.GetDevicePixelRatio=function(){return F()},c.CreateGuid=function(){return N()},c.GetResource=function(){return qi},c.GetMinuteTimeStringData=function(){return _r},c.GetMinuteCoordinateData=function(){return Vr},c.GetKLineZoom=function(){return Et},c.SetKLineZoom=function(t){Et=t},c.GetDivTooltipDataFormat=function(){return Aa},c.GetKLineCustomCalulate=function(){return er},c.SetUSATimeType=function(t){Yr.TimeType=t,kr.TimeType=t,Xr.TimeType=t,Wr.TimeType=t},c.GetChinaFuturesTimeData=function(){return Hr},c.AddPeriodCallback=function(t){mt.AddPeriodCallback(t)},c.RemovePeriodCallback=function(t){mt.RemovePeriodCallback(t)},c.RegisterDrawPicture=function(t){return Ha.RegisterDrawPicture(t)},c.RegisterDrawPictureIonFont=function(t){return Ha.RegisterIonFont(t)},c.GetInternalTimeData=function(t){switch(t){case"NYMEXTimeData":return Yr;case"COMEXTimeData":return kr;case"NYBOTTimeData":return Xr;case"CBOTTimeData":return Wr;case"LMETimeData":return Ur;case"FuturesTimeData":return Hr;case"TOCOMTimeData":return Kr;case"IPETimeData":return zr;default:return null}},c.RegisterExtendChartClass=function(t,e){return Ve.Add(t,e)},c.AddExtendCallbackDraw=function(t){return Ve.AddCallbackDrawClassName(t)},c.RegisterChartPaintClass=function(t,e){return xt.Add(t,e)},c.RegisterScriptIndexChart=function(t,e){return vn.Add(t,e)},c.RegisterDialogClass=function(t,e){return Ar.Add(t,e)},c.RegisterChartFrameClass=function(t,e){return W.Add(t,e)},c.ToFixedPoint=function(t){return A(t)},c.ToFixedPoint2=function(t,e){return O(t,e)},c.ToFixedRect=function(t){return b(t)},c.GetScrollPosition=function(){return w()},c.GetfloatPrecision=function(t){return Jr(t)},c.GetShortSymbol=function(t){if(!sa.IsString(t))return null;var e=t.lastIndexOf(".");return e<=0?t:t.slice(0,e)};var m={RECV_INDEX_DATA:2,RECV_HISTROY_DATA:3,RECV_TRAIN_MOVE_STEP:4,CHART_STATUS:5,BARRAGE_PLAY_END:6,RECV_OVERLAY_INDEX_DATA:7,DBCLICK_KLINE:8,RECV_START_AUTOUPDATE:9,RECV_STOP_AUTOUPDATE:10,ON_CONTEXT_MENU:11,ON_TITLE_DRAW:12,ON_SELECT_RECT:13,RECV_MINUTE_DATA:14,ON_CLICK_INDEXTITLE:15,RECV_KLINE_UPDATE_DATA:16,ON_CLICK_DRAWPICTURE:17,ON_FINISH_DRAWPICTURE:18,ON_INDEXTITLE_DRAW:19,ON_CUSTOM_VERTICAL_DRAW:20,RECV_KLINE_MANUAL_UPDATE_DATA:21,ON_ENABLE_SPLASH_DRAW:22,ON_CLICK_CHART_PAINT:23,ON_DRAW_MINUTE_LAST_POINT:24,ON_DRAW_DEPTH_TOOLTIP:25,ON_CLICK:26,ON_PHONE_TOUCH:27,ON_CLICKUP_CHART_PAINT:28,ON_SPLIT_YCOORDINATE:29,ON_DBCLICK:30,ON_SPLIT_XCOORDINATE:31,ON_KEYDOWN_SELECT_RECT:32,ON_DRAG_SELECT_RECT:33,ON_DRAG_SELECT_RECT_MOUSEUP:34,ON_DRAW_KLINE_LAST_POINT:35,ON_CLICK_CROSSCURSOR_RIGHT:36,ON_PLAY_SOUND:37,ON_CALCULATE_INDEX_OX:38,ON_LOAD_DRAWPICTURE:39,ON_DRAW_COUNTDOWN:41,ON_BIND_DRAWICON:42,ON_DRAW_DEAL_VOL_COLOR:43,ON_DRAW_DEAL_TEXT:44,ON_FILTER_DEAL_DATA:45,ON_FILTER_REPORT_DATA:46,ON_CLICK_REPORT_ROW:47,ON_REPORT_MARKET_STATUS:48,ON_DBCLICK_REPORT_ROW:49,ON_RCLICK_REPORT_ROW:50,ON_CLICK_REPORT_HEADER:51,ON_RCLICK_REPORT_HEADER:52,ON_REPORT_LOCAL_SORT:53,ON_DRAW_REPORT_NAME_COLOR:54,ON_DRAW_CUSTOM_TEXT:55,ON_CLICK_REPORT_TAB:56,ON_CLICK_REPORT_TABMENU:57,ON_DRAW_REPORT_FIXEDROW_TEXT:58,ON_CLICK_REPORT_FIXEDROW:59,ON_RCLICK_REPORT_FIXEDROW:60,ON_KEYDOWN_SELECT_RECT_FIRST:61,ON_CLICK_FRAME_TOOLBAR:62,ON_REPORT_DRAG_ROW:63,ON_MOUSE_MOVE:64,ON_MINUTE_PAGE_CHANGED:65,ON_DRAG_SUB_SELECT_RECT:66,ON_DRAG_SUB_SELECT_RECT_MOUSEUP:67,ON_KEYBOARD_SELECTED:68,ON_KEYBOARD_MOUSEUP:69,ON_CLICK_DRAWPICTURE_BUTTON:70,ON_FINISH_MOVE_DRAWPICTURE:71,ON_CLICK_EXTENDCHART_BUTTON:72,ON_SCROLLBAR_SLIDER_CHANGED:73,ON_DISPLAY_LATEST:74,ON_FORMAT_CORSSCURSOR_Y_TEXT:75,ON_FORMAT_INDEX_OUT_TEXT:76,ON_FORMAT_CORSSCURSOR_X_TEXT:77,ON_REPORT_MOUSE_MOVE:78,ON_REPORT_DRAG_HEADER_TOOLTIP:88,ON_REPORT_DRAW_CUSTOM_ICON:89,ON_REPORT_DRAW_KLINE:90,ON_DBCLICK_REPORT_DRAG_COLUMN_WIDTH:91,ON_REPORT_FORMAT_DRAW_INFO:92,ON_FORMAT_INDEX_Y_LABEL:93,ON_FORMAT_OVERLAY_INDEX_Y_LABEL:94,ON_CUSTOM_UNCHANGE_KLINE_COLOR:95,ON_CLICK_TITLE_BUTTON:96,ON_CUSTOM_LEFT_TOOLBAR:97,ON_CUSTOM_RIGHT_TOOLBAR:98,ON_REPORT_DRAG_COLUMN_WIDTH:99,ON_CUSTOM_UNCHANGE_KLINE_TITLE_COLOR:100,ON_CHANGE_KLINE_PERIOD:101,ON_MINUTE_TOUCH_ZOOM:102,ON_RELOAD_INDEX_CHART_RESOURCE:103,ON_RELOAD_OVERLAY_INDEX_CHART_RESOURCE:104,ON_CREATE_FRAME:105,ON_DELETE_FRAME:106,ON_SIZE_FRAME:107,ON_TOUCH_SCROLL_UP_DOWN:108,ON_RECV_REALTIME_DATA:109,ON_CUSTOM_OVERLAY_TOOLBAR:110,ON_BEFORE_DRAW:111,ON_BEFORE_DRAW_DYNAMIC_INFO:112,ON_CUSTOM_DRAG_MOUSE_DOWN:113,ON_CUSTOM_DRAG_DOC_MOUSE_MOVE:114,ON_CUSTOM_DRAG_DOC_MOUSE_UP:115,ON_CUSTOM_DRAG_MOUSE_MOVE:116,ON_KEYDOWN:117,ON_CREATE_OVERLAY_FRAME:118,ON_CREATE_CUSTOM_Y_COORDINATE:119,ON_BEFORE_DRAW_SPLASH_SCREEN:120,ON_TREPORT_MARKET_STATUS:121,ON_DBCLICK_TREPORT_ROW:122,ON_RCLICK_TREPORT_ROW:123,ON_CLICK_TREPORT_HEADER:124,ON_RCLICK_TREPORT_HEADER:125,ON_TREPORT_LOCAL_SORT:126,ON_CLICK_TREPORT_ROW:127,ON_MOVE_SELECTED_TREPORT_ROW:128,ON_MOVE_SELECTED_REPORT_ROW:129,ON_DRAW_REPORT_ROW_BG:140,ON_CLICK_REPORT_CHECKBOX:141,ON_CLICK_REPORT_BUTTON:142,ON_CLICK_REPORT_LINK:143,ON_CREATE_REPORT_HEADER_MENU:144,ON_CHANGE_INDEX:150,ON_MENU_COMMAND:151,ON_CREATE_RIGHT_MENU:152,ON_FORMAT_CALL_AUCTION_INDEX_TITLE:153,ON_FORMAT_KLINE_HIGH_LOW_TITLE:154,ON_CUSTOM_CORSSCURSOR_POSITION:155,ON_CUSTOM_MINUTE_NIGHT_DAY_X_INDEX:156,ON_CUSTOM_MINUTE_BG:157,ON_CLICK_HORIZONTAL_LABEL:158,ON_FORMAT_DIALOG_TOOLTIP:159,ON_CHANGE_KLINE_RIGHT:160,ON_FORMAT_KLINE_FLOAT_TOOLTIP:161,ON_FORMAT_KLINE_INFO_FLOAT_TOOLTIP:162,SEARCH_DIALOG_ON_CLICK_INDEX:163,ON_CALCULATE_CHIP_DATA:164,ON_CLICK_DEAL_ROW:165,ON_RCLICK_DEAL_ROW:166,ON_DBCLICK_DEAL_ROW:167,ON_FORMAT_OVERLAY_INDEX_OUT_TEXT:168,ON_TOUCH_FAST_SLIDE:169,ON_CLICK_CROSSCURSOR_BOTTOM:170,ON_CLICK_CHART_CELL:171},d={OP_SCROLL_LEFT:1,OP_SCROLL_RIGHT:2,OP_ZOOM_OUT:3,OP_ZOOM_IN:4,OP_GOTO_HOME:5,OP_GOTO_END:6,OP_LEFT_ZOOM_OUT:7,OP_LEFT_ZOOM_IN:8,OP_RIGHT_ZOOM_OUT:9,OP_RIGHT_ZOOM_IN:10,OP_SCROLL_GOTO:11,OP_SET_SELECTRECT:12,OP_SET_SUB_SELECTRECT:13,OP_CORSSCURSOR_GOTO:14,OP_SCROOLBAR_SLIDER_CHANGED:15,OP_GOTO:16,OP_GOTO_BY_DATAINDEX:17,OP_MOVE_CORSSCURSOR:18},I={DISABLE_DRAG_ID:0,CLICK_TOUCH_MODE_ID:3},S={CLOSE_BEFOREOPEN_ID:1,CLOSE_OVERLAY_INDEX:2,MODIFY_INDEX_PARAM:3,CHANGE_INDEX:4,CLOSE_INDEX_WINDOW:5,OVERLAY_INDEX:6,MODIFY_OVERLAY_INDEX_PARAM:7,CHIP_DEFULT:8,CHIP_LONG:9,CHIP_RECENT:10,MAX_MIN_WINDOW:11,TITLE_WINDOW:12,DRAW_PICTURE_DELETE:13,DRAW_PICTURE_SETTING:14,EXTEND_CHART_BUTTON_ID:15,EXPORT_DATA:16,DRAW_PICTURE_BUTTON_1:17,DRAW_PICTURE_BUTTON_2:18,DRAW_PICTURE_BUTTON_3:19,DRAW_PICTURE_BUTTON_4:20,DRAW_PICTURE_BUTTON_5:21,DRAW_PICTURE_BUTTON_6:22,DRAW_PICTURE_BUTTON_7:23,DRAW_PICTURE_BUTTON_8:24,DRAW_PICTURE_BUTTON_9:25,DRAW_PICTURE_BUTTON_10:26,DRAW_PICTURE_BUTTON_11:27,DRAW_PICTURE_BUTTON_12:28,DRAW_PICTURE_BUTTON_13:29,DRAW_PICTURE_BUTTON_14:30,DRAW_PICTURE_BUTTON_15:31,DRAW_PICTURE_BUTTON_16:32,DRAW_PICTURE_BUTTON_17:33,DRAW_PICTURE_BUTTON_18:34,POP_MENU_1:40,POP_MENU_2:41,POP_MENU_3:42,INDEX_NAME_BUTTON:43,ADD_INDEX_WINDOW:44,CHIP_CLOSE:45},T={KLINE_ORDERFLOW:99,MINUTE_MULTI_DAY_EXTENDDATA:21,MINUTE_DAY_EXTENDDATA:21,MINUTE_BEFOREOPEN_EXTENDDATA:21,MINUTE_AFTERCLOSE_EXTENDDATA:21,KLINE_COLOR_DATA:66,KLINE_DAY_EXTENDDATA:25,KLINE_MINUTE_EXTENDDATA:25,KLINE_HEATMAP:67},v={CMD_CHANGE_PERIOD_ID:1,CMD_CHANGE_WINDOW_COUNT_ID:2,CMD_CHANGE_RIGHT_ID:3,CMD_CHANGE_INDEX_ID:4,CMD_CHANGE_COLOR_INDEX_ID:5,CMD_CHANGE_TRADE_INDEX_ID:6,CMD_DELETE_COLOR_INDEX_ID:7,CMD_DELETE_TRADE_INDEX_ID:8,CMD_CHANGE_KLINE_TYPE_ID:9,CMD_CHANGE_PRICE_GAP_ID:10,CMD_OVERLAY_SYMBOL_ID:11,CMD_DELETE_ALL_OVERLAY_SYMBOL_ID:12,CMD_CHANGE_COORDINATETYPE_ID:13,CMD_CHANGE_KLINE_INFO_ID:14,CMD_DELETE_ALL_KLINE_INFO_ID:15,CMD_CHANGE_DRAG_MODE_ID:16,CMD_CHANGE_BG_SPLIT_ID:17,CMD_SHOW_DRAWTOOL_ID:18,CMD_HIDE_DRAWTOOL_ID:19,CMD_SHOW_STOCKCHIP_ID:20,CMD_HIDE_STOCKCHIP_ID:21,CMD_XXXXXX_NONE_ID:22,CMD_CHANGE_DAY_COUNT_ID:23,CMD_SHOW_BEFORE_DATA_ID:24,CMD_SELECTED_ZOOM_ID:25,CMD_SELECTED_SUMMARY_ID:26,CMD_SHOW_INDEX_ID:27,CMD_SHOW_OVERLAY_INDEX_ID:28,CMD_DELETE_OVERLAY_INDEX_ID:29,CMD_SHOW_OVERLAY_Y_AXIS_ID:30,CMD_ENABLE_OVERLAY_SHARE_Y_ID:31,CMD_CHANGE_DEFAULTCURSOR_ID:32,CMD_CHANGE_API_INDEX_ID:33,CMD_CHANGE_SCRIPT_INDEX_ID:34,CMD_CHANGE_BASELINE_ID:35,CMD_ADD_OVERLAY_INDEX_ID:36,CMD_CHANGE_LANGUAGE_ID:37,CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID:38,CMD_SHOW_CORSS_LINE_ID:39,CMD_ENABLE_POP_MINUTE_CHART_ID:40,CMD_CHANGE_INFO_POSITION_ID:41,CMD_CHIP_CHART_SETTING_ID:42,CMD_DIALOG_TOOLTIP_ATTRIBUTE:43,CMD_KLINE_TOOLTIP_ATTRIBUTE:44,CMD_MODIFY_INDEX_PARAM:45,CMD_MODIFY_OVERLAY_INDEX_PARAM:46,CMD_LOCK_CROSSCURSOR:47,CMD_UNLOCK_CROSSCURSOR:48,CMD_CORSS_ON_CLOSE_LINE_ID:49,CMD_CORSS_ON_VAILD_TIME_ID:50,CMD_CORSS_ON_KLINE_ID:51,CMD_CORSS_POINT_ID:52,CMD_RBUTTON_SELECT_RECT_ID:53,CMD_LBUTTON_SELECT_RECT_ID:54,CMD_ENABLE_XDRAG_BOTTOM_ID:55,CMD_FULLSCREEN_SUMMARY_ID:56,CMD_CORSS_DBCLICK_ID:57,CMD_ENABLE_KLINE_DAY_SUMMARY_ID:58,CMD_SHOW_BUYSELL_BAR_ID:59,CMD_CORSS_SHOW_INCREASE_ID:60,CMD_CORSS_X_TEXTALIGN_ID:61,CMD_REPORT_CHANGE_BLOCK_ID:100,CMD_REPORT_COLUMN_SORT_ID:101,CMD_REPORT_COLUMN_DEL_ID:102,CMD_REPORT_COLUMN_MOVE_ID:103,CMD_REPORT_COLUMN_FILTER_ID:104,CMD_REPORT_CHANGE_COLUMN_ID:105};function p(){this.Start=[],this.Clear=function(){this.Start=[]},this.AddTouchStart=function(t,e,a){if(this.Start.length>0){var i=this.Start[this.Start.length-1],r=a-i.Time;r>0&&r<300?this.Start.push({X:t,Y:e,Time:a}):this.Start=[]}else this.Start.push({X:t,Y:e,Time:a})},this.IsVaildDBClick=function(){return 2==this.Start.length},this.AddTouchEnd=function(t){if(!(this.Start.length<=0)){var e=this.Start[this.Start.length-1],a=t-e.Time;a>=0&&a<150||(this.Start=[])}}}function g(t,e,a){var i=this;this.ClassName="JSChartContainer";if(this.Frame,this.ChartPaint=new Array,this.ChartPaintEx=[],this.ChartInfo=new Array,this.ChartInfoPaint,this.ExtendChartPaint=new Array,this.TitlePaint=new Array,this.OverlayChartPaint=new Array,this.ChartDrawPicture=new Array,this.ChartDrawStorage,this.ChartDrawOption={IsLockScreen:!1,Zoom:1,Magnet:null},this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null,this.MoveOnChartDrawPicture=null,this.EnableEraseChartDrawPicture=!1,this.IsDrawPictureXY=!1,this.EnableShowCorssCursor={DrawPicture:!0},this.ChartPictureMenu,this.ChartCorssCursor,this.ChartDragSelectRect,this.IsClickShowCorssCursor=!1,this.ChartSplashPaint=null,this.LoadDataSplashTitle="数据加载中",this.DefaultCursor="default",this.CacheCanvas=null,this.CacheElement=null,a&&(this.CacheElement=a,this.CacheCanvas=a.getContext("2d")),e)this.Canvas=e.getContext("2d"),this.OffscreenCanvasElement=e,this.ShowCanvas=t.getContext("2d");else{if(!0===c.EnableCanvasWillReadFrequently){this.Canvas=t.getContext("2d",{willReadFrequently:!0})}else this.Canvas=t.getContext("2d");this.ShowCanvas=null}this.CorssCursorElement,this.CorssCursorCanvas,this.UIElement=t,this.MouseDrag,this.PhoneTouchInfo,this.DragMode=1,this.EnableBorderDrag=!0,this.BorderDrag,this.YDrag,this.TouchStatus={CorssCursorShow:!1},this.DragTimer,this.EnableScrollUpDown=!1,this.ClickChartTimer=null,this.CursorIndex=0,this.LastPoint=new V,this.IsForceLandscape=!1,this.CorssCursorTouchEnd=!1,this.IsTitleShowLatestData=!1,this.StepPixel=4,this.ZoomStepPixel=5,this.TouchMoveMinAngle=70,this.EnableAnimation=!1,this.ShiftUpDownStepPixel=1*F(),this.Tooltip=document.createElement("div"),this.Tooltip.className="jschart-tooltip",this.Tooltip.style.background=qi.TooltipBGColor,this.Tooltip.style.opacity=qi.TooltipAlpha,this.Tooltip.style["pointer-events"]="none",this.Tooltip.id=N(),t.parentNode.appendChild(this.Tooltip),this.IsShowTooltip=!0,this.KLineTooltipConfig={EnableKeyDown:!0,Enable:!0},this.TooltipCache={Type:null,IsShow:!1,X:null,Y:null,Data:null,InnerHTML:null},this.FrameSplitData=new Map,this.FrameSplitData.set("double",new Ji),this.FrameSplitData.set("price",new Zi),this.mapEvent=new Map,this.PhonePinch=null,this.TouchDrag=null,this.IsOnTouch=!1,this.TouchDrawCount=0,this.DisableMouse=!1,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.PressTime=500,this.IsPress=!1,this.NetworkFilter,this.LastMouseStatus={MouseOnToolbar:null},this.ClickDownPoint,this.IsDestroy=!1,this.EnableYDrag={Left:!1,Right:!1,Wheel:!1,WheelYMove:5},this.EnableXDrag={Bottom:!0,LButton:{Type:1},RButton:{Type:2}},this.EnableZoomIndexWindow=!1,this.EnableVerifyRecvData=!1,this.PhoneDBClick=new p,this.SelectedChart={EnableSelected:!1,EnableMoveOn:!1,Selected:{Identify:null},MoveOn:{Identify:null}},this.IndexChartDrag,this.EnableIndexChartDrag=!1,this.GlobalOption={IsValueFullRange:!1,IsDisplayLatest:!1,SelectedBorder:{Mode:0,SelFrame:0},SelectedXBorder:{Mode:0,Date:null},RightHorizontal:{},LockCorssCursor:{X:{Enable:!1}},MapIndexChartCache:new Map,TradeStatus:null},this.VerticalDrag,this.EnableVerticalDrag=!1,this.ClickModel={IsShowCorssCursor:!1,PreventHide:!1,IsClickButton:!1},this.EnableClickModel=!1,this.DisplayLatestOption={Timer:null,Enable:!1,DelayTime:18e4,LastPoint:null},this.DrawDynamicInfoOption={Timer:null,Enable:!1,DelayTime:10},this.CustomChartDrag,this.StockCache={Data:null},this.BuySellData={ArySell:null,AryBuy:null},this.JSPopMenu,this.IsShowRightMenu=!0,this.DialogDrawTool,this.DialogModifyDraw,this.DialogTooltip,this.DialogSelectRect,this.FloatTooltip,this.DialogSearchIndex,this.DialogModifyIndexParam,this.RestoreFocusTimer=null,this.PreventRightMenu={Timer:null,Enable:!1,Delay:2e3},this.AryHotKey=[],this.FastSlideConfig={MinDistance:500,MinSpeed:3,MaxTime:250,Enable:!1},this.RestoreFocus=function(t){var e=this,a=1e3;sa.IsNumber(t)&&(a=t),this.ClearRestoreFocusTimer(),this.RestoreFocusTimer=setTimeout((function(){e.SetFocus()}),a)},this.ClearRestoreFocusTimer=function(){this.RestoreFocusTimer&&(clearTimeout(this.RestoreFocusTimer),this.RestoreFocusTimer=null)},this.GetVolUnit=function(){var t=this.Symbol?this.Symbol.toUpperCase():null,e=Pr.GetVolUnit(t);return e},this.ClearStockCache=function(){this.StockCache.Data=null,this.BuySellData.AryBuy=null,this.BuySellData.ArySell=null},this.InitalPopMenu=function(){this.JSPopMenu||(this.JSPopMenu=new JSPopMenu,this.JSPopMenu.Inital(this))},this.InitalDrawToolDialog=function(){this.DialogDrawTool||(this.DialogDrawTool=new JSDialogDrawTool,this.DialogDrawTool.Inital(this),this.DialogDrawTool.Create())},this.InitalTooltipDialog=function(t){this.DialogTooltip||(this.DialogTooltip=new JSDialogTooltip,this.DialogTooltip.Inital(this,t),this.DialogTooltip.Create())},this.InitalFloatTooltip=function(t){this.FloatTooltip||(this.FloatTooltip=new JSFloatTooltip,this.FloatTooltip.Inital(this,t),this.FloatTooltip.Create())},this.InitalModifyDrawDialog=function(){this.DialogModifyDraw||(this.DialogModifyDraw=new JSDialogModifyDraw,this.DialogModifyDraw.Inital(this),this.DialogModifyDraw.Create())},this.InitalSelectRectDialog=function(t){this.DialogSelectRect||(this.DialogSelectRect=new JSDialogSelectRect,this.DialogSelectRect.Inital(this,t),this.DialogSelectRect.Create())},this.InitalSearchIndexDialog=function(t){this.DialogSearchIndex||(this.DialogSearchIndex=new JSDialogSearchIndex,this.DialogSearchIndex.Inital(this,t),this.DialogSearchIndex.Create())},this.InitalModifyIndexParamDialog=function(t){this.DialogModifyIndexParam||(this.DialogModifyIndexParam=new JSDialogModifyIndexParam,this.DialogModifyIndexParam.Inital(this,t),this.DialogModifyIndexParam.Create())},this.ShowChangeIndexDialog=function(t){t&&this.DialogSearchIndex&&(t.Title="切换指标 [窗口".concat(t.WindowIndex+1,"]"),this.DialogSearchIndex.SetOpData(t),this.DialogSearchIndex.Show())},this.ShowAddOverlayIndexDialog=function(t){t&&this.DialogSearchIndex&&(t.Title="添加叠加指标 [窗口".concat(t.WindowIndex+1,"]"),this.DialogSearchIndex.SetOpData(t),this.DialogSearchIndex.Show())},this.ShowAddIndexWindowDialog=function(t){if(this.DialogSearchIndex){var e=t;e||(e={}),e.OpType=3,e.Title="增加指标窗口",this.DialogSearchIndex.SetOpData(e),this.DialogSearchIndex.Show()}},this.ShowModifyIndexParamDialog=function(t){if(this.DialogModifyIndexParam){if(1==t.Type){var e=this.WindowIndex[t.WindowIndex];if(!e)return;t.IndexScript=e,t.Title="[".concat(e.Name,"]参数修改 窗口[").concat(t.WindowIndex+1,"]")}else if(2==t.Type){var a=this.GetOverlayIndexByIdentify(t.Identify);if(!a||!a.OverlayItem.Script)return;e=a.OverlayItem.Script;t.IndexScript=e,t.Title="[".concat(e.Name,"]参数修改 叠加窗口[").concat(t.WindowIndex+1,"]")}this.DialogModifyIndexParam.SetIndexData(t),this.DialogModifyIndexParam.Show()}},this.DrawSelectRectDialog=function(){},this.IsShowSelectRectDialog=function(){return!!this.DialogSelectRect&&this.DialogSelectRect.IsShow()},this.ShowDrawToolDialog=function(t,e){if(this.DialogDrawTool){var a=this.UIElement.getBoundingClientRect(),i=w(),r=this.UIElement.offsetTop+15,n=this.UIElement.offsetWidth-this.DialogDrawTool.DivDialog.offsetWidth-15;n+=a.left+i.Left,r+=a.top+i.Top,this.DialogDrawTool.Show(n,r)}},this.IsShowDrawToolDialog=function(){return!!this.DialogDrawTool&&this.DialogDrawTool.IsShow()},this.ShowModifyDrawDialog=function(t,e,a){if(this.DialogModifyDraw&&(this.DialogModifyDraw.SetChartPicture(t),!this.DialogModifyDraw.IsShow())){var i=this.UIElement.getBoundingClientRect(),r=w(),n=this.UIElement.offsetTop+15,o=(this.UIElement.offsetWidth-this.DialogModifyDraw.DivDialog.offsetWidth)/2;o+=i.left+r.Left,n+=i.top+r.Top,this.DialogModifyDraw.Show(o,n)}},this.CloseModifyDrawDialog=function(){this.DialogModifyDraw&&this.DialogModifyDraw.Close()},this.IsShowTooltipDialog=function(){return!!this.DialogTooltip&&this.DialogTooltip.IsShow()},this.CloseTooltipDialog=function(){this.DialogTooltip&&this.DialogTooltip.Close()},this.HideFloatTooltip=function(){this.FloatTooltip&&this.FloatTooltip.Hide()},this.DestroyTooltipDialog=function(){this.DialogTooltip&&(this.DialogTooltip.Destroy(),this.DialogTooltip=null)},this.DestroyFloatTooltip=function(){this.FloatTooltip&&(this.FloatTooltip.Destroy(),this.FloatTooltip=null)},this.DestroySearchIndexDialog=function(){this.DialogSearchIndex&&(this.DialogSearchIndex.Destroy(),this.DialogSearchIndex=null)},this.DestroyDialogDrawTool=function(){this.DialogDrawTool&&(this.DialogDrawTool.Destroy(),this.DialogDrawTool=null)},this.DestroyDialogModifyIndexParam=function(){this.DialogModifyIndexParam&&(this.DialogModifyIndexParam.Destroy(),this.DialogModifyIndexParam=null)},this.DestroyDialogSelectRect=function(){this.DialogSelectRect&&(this.DialogSelectRect.Destroy(),this.DialogSelectRect=null)},this.DestroyDialogModifyDraw=function(){this.DialogModifyDraw&&(this.DialogModifyDraw.Destroy(),this.DialogModifyDraw=null)},this.HideAllPopDiv=function(){this.HideFloatTooltip(),this.CloseTooltipDialog(),this.DialogDrawTool&&this.DialogDrawTool.Close(),this.CloseModifyDrawDialog(),this.DialogSelectRect&&this.DialogSelectRect.Close(),this.DialogSearchIndex&&this.DialogSearchIndex.Close(),this.DialogModifyIndexParam&&this.DialogModifyIndexParam.Close()},this.SetCorssCursorElement=function(t){t&&t.Element&&t.Canvas&&(this.CorssCursorElement=t.Element,this.CorssCursorCanvas=t.Canvas)},this.StopDisplayLatest=function(){this.GlobalOption.IsDisplayLatest=!1,this.DisplayLatestOption.Timer&&(clearTimeout(this.DisplayLatestOption.Timer),this.DisplayLatestOption.Timer=null)},this.StartStopDisplayLatest=function(){var t=this;this.StopDisplayLatest(),this.DisplayLatestOption.Enable&&(this.DisplayLatestOption.Timer=setTimeout((function(){t.DisplayLatest&&(u.Chart.Log("[JSChartContainer:StartStopDisplayLatest] call this.DisplayLatest()"),t.DisplayLatest())}),this.DisplayLatestOption.DelayTime))},this.StopDrawDynamicInfo=function(){this.DrawDynamicInfoOption.Timer&&(clearTimeout(this.DrawDynamicInfoOption.Timer),this.DrawDynamicInfoOption.Timer=null)},this.ChartDestroy=function(){this.IsDestroy=!0,this.StopAutoUpdate(),this.DestroyTooltipDialog(),this.DestroyFloatTooltip(),this.DestroySearchIndexDialog(),this.DestroyDialogModifyIndexParam(),this.DestroyDialogDrawTool(),this.DestroyDialogModifyDraw(),this.DestroyDialogSelectRect()},this.ChartDestory=this.ChartDestroy,this.SetFocus=function(){this.UIElement&&this.UIElement.focus()},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.GetIndexEvent=function(){return this.GetEventCallback(m.RECV_INDEX_DATA)},this.GetOverlayIndexEvent=function(){return this.GetEventCallback(m.RECV_OVERLAY_INDEX_DATA)},t.onmousemove=function(t){i.UIOnMouseMove(t)},t.oncontextmenu=function(t){return i.UIOnContextMenu(t)},t.ondblclick=function(t){i.UIOnDblClick(t)},t.onmousedown=function(t){i.UIOnMouseDown(t)},t.onmouseout=function(t){i.UIOnMounseOut(t)},t.onmouseleave=function(t){i.UIOnMouseleave(t)},this.UIOnMouseMove=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(this.StopDisplayLatest(),this.MoveOnChartDrawPicture=null,(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&1!=this.DisableMouse&&!this.BorderDrag&&!this.YDrag&&!this.IndexChartDrag&&!this.CustomChartDrag&&(!this.EnableClickModel||!this.ClickModel.IsClickButton)){t&&"mouseout"==t.type&&0==t.buttons&&(a=i=-1);var r={X:a,Y:i,IsInClient:this.IsMouseOnClient(a,i)};this.LastMouseStatus.OnMouseMove=r,this.LastMouseStatus.MoveOnPoint={X:a,Y:i};var n=this.GetEventCallback(m.ON_MOUSE_MOVE),o=this.TitlePaint[0];n&&o&&(o.OnMouseMoveEvent=n),this.MoveOnPoint={X:a,Y:i},this.OnMouseMove(a,i,t),o&&(o.OnMouseMoveEvent=null),this.StartStopDisplayLatest()}},this.IsMouseOnClient=function(t,e){var a={Left:this.Frame.ChartBorder.GetLeft(),Top:this.Frame.ChartBorder.GetTop(),Width:this.Frame.ChartBorder.GetWidth(),Height:this.Frame.ChartBorder.GetHeight()};return a.Right=a.Left+a.Width,a.Bottom=a.Top+a.Height,t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom},this.UIOnContextMenu=function(t){if(t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.IsShowRightMenu)if(this.PreventRightMenu.Enable)this.PreventRightMenu.Enable=!1;else{var e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top;"function"==typeof this.OnRightMenu&&this.OnRightMenu(e,a,t)}},this.UIOnDblClick=function(t){if(!this.ChartSplashPaint||!this.ChartSplashPaint.IsEnableSplash){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;this.OnDoubleClick(a,i,t)}},this.TryYDrag=function(t,e){if(!this.EnableYDrag)return null;if(!this.EnableYDrag.Left&&!this.EnableYDrag.Right)return null;if(!this.Frame||!this.Frame.PtInFrameY)return null;var a=this.Frame.PtInFrameY(t,e);return!a||a.Index<0?null:!0===a.IsOverlay?a.Right&&this.EnableYDrag.Right&&this.Frame.IsEnableOverlayDragY(a.Index,a.OverlayIndex)?a:null:a.Left&&this.EnableYDrag.Left&&this.Frame.IsEnableDragY(a.Index)||a.Right&&this.EnableYDrag.Right&&this.Frame.IsEnableDragY(a.Index)?a:null},this.TryUpDownDrag=function(t,e){var a=this.Frame.PtInFrame(t,e);if(a<0)return null;var i=this.Frame.SubFrame[a];if(!i||!i.Frame)return null;var r=i.Frame;return r.YSplitOperator&&r.YSplitOperator.FixedYMaxMin?{Index:a,X:t,Y:e}:null},this.TryRectSelectDrag=function(t,e){var a=this.GetRectSelectPaint();if(!a)return null;if(a.GetPointCount()<=0)return null;var i=a.PtInPaint(t,e);return{Item:i,X:t,Y:e}},this.TryClickCrossCursor=function(t,e,a){if(this.ChartCorssCursor){var i=this.ChartCorssCursor.PtInButton(t,e);if(!i)return!1;if(1==i.Type){var r=this.GetEventCallback(m.ON_CLICK_CROSSCURSOR_RIGHT);if(r&&r.Callback){var n={Button:i,e:a};r.Callback(r,n,this)}}else if(2==i.Type){r=this.GetEventCallback(m.ON_CLICK_CROSSCURSOR_BOTTOM);if(r&&r.Callback){n={Button:i,e:a};r.Callback(r,n,this)}}return!0}},this.TryClickButton=function(t,e,a){var i=this.Frame.PtInButtons(t,e);if(i&&this.ClickFrameButton)return this.ClickFrameButton(i,a),!0;if(i=this.PtInExtendChartButtons(t,e),i&&this.ClickExtendChartButton)return this.ClickExtendChartButton(i,a),!0;if(i=this.PtInDrawPictureButtons(t,e),i&&this.ClickDrawPictureButton)return this.ClickDrawPictureButton(i,a),!0;if(i=this.PtInTitleButtons(t,e),i&&this.ClickTitleButton)return this.ClickTitleButton(i,a),!0;var r=this.Frame.PtInHorizontalLabel(t,e);return!(!r||!this.ClickHorizontalLabel)&&(this.ClickHorizontalLabel(r,a),!0)},this.TryClickChartCell=function(t,e,a){for(var i=null,r=0;r<this.ChartPaint.length;++r){var n=this.ChartPaint[r];if(n.ClickCell&&(!n.IsHideScriptIndex()&&(i=n.ClickCell(t,e,a),i)))return i.Chart=n,i}for(r=0;r<this.OverlayChartPaint.length;++r){n=this.OverlayChartPaint[r];if(n.ClickCell&&(i=n.ClickCell(t,e,a),i))return i.Chart=n,i.IsOverlayChart=!0,i}r=0;for(var o=0,s=0;r<this.Frame.SubFrame.length;++r){n=this.Frame.SubFrame[r];if(sa.IsNonEmptyArray(n.OverlayIndex))for(o=0;o<n.OverlayIndex.length;++o){var h=n.OverlayIndex[o];if(sa.IsNonEmptyArray(h.ChartPaint))for(s=0;s<h.ChartPaint.length;++s){var l=h.ChartPaint[s];if(l.IsShow&&(!l.IsHideScriptIndex()&&l.ClickCell&&(i=l.ClickCell(t,e,a),i)))return i.Chart=l,i.IsOverlayIndex=!0,i}}}return null},this.TryMouseMove_CustomChartDrag=function(t){var e=this.GetEventCallback(m.ON_CUSTOM_DRAG_MOUSE_MOVE);return!(!e||!e.Callback)&&e.Callback(e,t,this)},this.TryClick_CustomChartDrag=function(t){var e=this.GetEventCallback(m.ON_CUSTOM_DRAG_MOUSE_DOWN);if(!e||!e.Callback)return!1;t.ChartDrag=null,t.Cusrsor=null,e.Callback(e,t,this),this.CustomChartDrag=t.ChartDrag,this.SetCursor(t)},this.TryDragMove_CustomChartDrag=function(t){var e=this.GetEventCallback(m.ON_CUSTOM_DRAG_DOC_MOUSE_MOVE);if(e&&e.Callback){var a=t.e,i=t.Drag;Math.abs(i.LastMove.Y-a.clientY)<2&&Math.abs(i.LastMove.X-a.clientX)<2||e.Callback(e,t,this)&&(i.LastMove.X=a.clientX,i.LastMove.Y=a.clientY)}},this.TryMouseUp_CustomChartDrag=function(t){var e=this.GetEventCallback(m.ON_CUSTOM_DRAG_DOC_MOUSE_UP);e&&e.Callback&&e.Callback(e,t,this)},this.UIOnMouseDown=function(t){var e=this;if(this.MoveOnChartDrawPicture=null,!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.ClickDownPoint={X:t.clientX,Y:t.clientY},this.IsOnTouch=!0,this.BorderDrag=null,this.YDrag=null,this.UpDownDrag=null,this.RectSelectDrag=null,this.IndexChartDrag=null,this.CustomChartDrag=null;var a=F(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a;if(this.TryClickButton(i,r,t))this.IsOnTouch=!1;else{var n=!1;if(this.GlobalOption.SelectedBorder&&this.GlobalOption.SelectedBorder.Mode>=1){var o=this.GlobalOption.SelectedBorder,s=this.Frame.PtInFrame(i,r);s>=0&&s!=o.SelFrame&&(o.SelFrame=s,n=!0)}var h=!1;if(this.GlobalOption.SelectedXBorder&&this.GlobalOption.SelectedXBorder.Mode>=1&&this.PtInMulitDayMinute){o=this.GlobalOption.SelectedXBorder;var l=this.PtInMulitDayMinute(i,r);o.Date!=l&&(o.Date=l,h=!0)}if(this.TryClickCrossCursor(i,r,t))this.IsOnTouch=!1;else if(this.TryClickChartTooltipData&&this.TryClickChartTooltipData(i,r,t))this.IsOnTouch=!1;else if(!this.TryClickLock||!this.TryClickLock(i,r)){this.HideSelectRect(),this.ClearDragSelectRect(),this.ChartPictureMenu&&this.ChartPictureMenu.Hide();var C=this.GetRectSelectPaint();if(C&&C.GetPointCount()>0){o=C.PtInPaint(i,r);if(o)if(4==o.Type){this.SetCursor({Cursor:"pointer"});var D={X:t.clientX};this.GetXDataIndex(D)&&(this.RectSelectDrag={DataIndex:D.DataIndex,Type:o.Type,X:t.clientX},u.Chart.Log("[JSChartContainer::UIOnMouseDown] drag sub rect select ",D))}else this.SetCursor({Cursor:"ew-resize"}),this.RectSelectDrag={Index:o.PointIndex,Type:o.Type},u.Chart.Log("[JSChartContainer::UIOnMouseDown] drag rect select ",o)}if(this.IsShowSelectRectDialog()||!this.RectSelectDrag&&this.ClearRectSelect(!1)&&this.Draw(),this.EnableBorderDrag&&this.Frame){var f=this.Frame.PtInFrameBorder(i,r);f&&f.Index>=0&&(this.SetCursor({Cursor:"n-resize"}),this.BorderDrag={Index:f.Index},u.Chart.Log("[JSChartContainer::UIOnMouseDown] DragBorder ",f))}if(!this.BorderDrag){var c=this.TryYDrag(i,r);if(c){var d=0==c.Position?"n-resize":"row-resize";this.SetCursor({Cursor:d}),this.YDrag=c,u.Chart.Log("[JSChartContainer::UIOnMouseDown] dragY ",c)}else{var I=this.TryUpDownDrag(i,r);I&&(this.SetCursor({Cursor:"pointer"}),this.UpDownDrag=I,u.Chart.Log("[JSChartContainer::UIOnMouseDown] dragUpDown ",I))}}var S={X:i,Y:r,e:t};if(this.TryClick_CustomChartDrag(S),0!=this.DragMode){var T={Click:{},LastMove:{},CurrentMove:{},IsInFrameBottom:!1};T.Click.X=t.clientX,T.Click.Y=t.clientY,this.EnableXDrag.Bottom&&(T.Click.IsInFrameBottom=this.Frame.PtInFrameBottom(i,r)),T.LastMove.X=t.clientX,T.LastMove.Y=t.clientY,this.MouseDrag=T;var v=this.GetActiveDrawPicture(),p={Chart:this.SelectedChart.Selected.Chart,Identify:this.SelectedChart.Selected.Identify};if(this.SelectChartDrawPicture=null,this.BorderDrag);else if(this.YDrag||this.RectSelectDrag||this.CustomChartDrag);else if(this.CurrentChartDrawPicture){this.UpDownDrag=null;var g=this.CurrentChartDrawPicture;2==g.Status?this.SetChartDrawPictureThirdPoint(T.Click.X,T.Click.Y):(this.SetChartDrawPictureFirstPoint(T.Click.X,T.Click.Y),this.FinishChartDrawPicturePoint()&&(g.IsDrawMain?this.Draw():this.DrawDynamicInfo())),!v.Select.Guid||this.CurrentChartDrawPicture&&v.Select.Guid==this.CurrentChartDrawPicture.Guid||v.Select.Chart.IsDrawMain&&this.Draw()}else{var x={};if(x.X=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,x.Y=(t.clientY-this.UIElement.getBoundingClientRect().top)*a,this.GetChartDrawPictureByPoint(x)){if(this.EnableEraseChartDrawPicture)this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null,this.ClearChartDrawPicture(x.ChartDrawPicture);else{this.UpDownDrag=null,this.CurrentChartDrawPicture=x.ChartDrawPicture,this.SelectChartDrawPicture=x.ChartDrawPicture;var E=!1;(v.Select.Guid&&v.Select.Chart&&v.Select.Chart.IsDrawMain||x.ChartDrawPicture.IsDrawMain)&&(E=!0),E&&this.Draw(),1==x.ChartDrawPicture.EnableMove&&(x.ChartDrawPicture.Status=20),x.ChartDrawPicture.ValueToPoint(),x.ChartDrawPicture.MovePointIndex=x.PointIndex,this.SelectChartDrawPicture.DragInfo={Click:{X:t.clientX,Y:t.clientY}}}var L=this.GetEventCallback(m.ON_CLICK_DRAWPICTURE);if(L&&L.Callback){S={DrawPicture:x.ChartDrawPicture};L.Callback(L,S,this)}else this.OnSelectChartPicture(x.ChartDrawPicture)}else{null!=this.ClickChartTimer&&(clearTimeout(this.ClickChartTimer),this.ClickChartTimer=null);var M=this,y={X:this.ClickDownPoint.X,Y:this.ClickDownPoint.Y};this.ClickChartTimer=setTimeout((function(){M.TryClickPaintEvent(m.ON_CLICK_CHART_PAINT,y,t)}),250);var R=!1,N=this.TryClickChartCell(i,r,t);if(N){L=this.GetEventCallback(m.ON_CLICK_CHART_CELL);if(L&&L.Callback){var w={Event:t,CellData:N};L.Callback(L,w,this)}!0===N.Redraw&&(h=!0)}else if(this.SelectedChart.EnableSelected){var A=this.PtInChart(i,r);A?(this.SelectedChart.Selected.Identify!=A.Identify&&(this.SelectedChart.Selected.Identify=A.Identify,this.SelectedChart.Selected.Chart=A.Chart,R=!0),this.EnableIndexChartDrag&&(this.IndexChartDrag={SelectedChart:A,LastMove:{X:i,Y:r},Click:{X:i,Y:r}},this.IndexChartDrag.Info=this.GetSelectedChartInfo(A),this.IndexChartDrag.Info&&(this.IndexChartDrag.Info.FrameID=this.Frame.PtInFrame(i,r)))):this.SelectedChart.Selected.Identify&&(this.SelectedChart.Selected.Identify=null,this.SelectedChart.Selected.Chart=null,R=!0)}else this.SelectedChart.Selected.Identify&&(this.SelectedChart.Selected.Identify=null,R=!0);if(null!=v.Select.Guid&&null==this.SelectChartDrawPicture||R){var O=0;if(v.Select.Guid&&v.Select.Chart&&v.Select.Chart.IsDrawMain&&(O=1),R){var b=p.Chart;b&&b.SetSelectedStatus&&(b.SetSelectedStatus(0),O=1),b=this.SelectedChart.Selected.Chart,b&&b.SetSelectedStatus&&(b.SetSelectedStatus(1),O=1)}1==O?this.Draw():this.DrawDynamicInfo()}else h?this.Draw():n&&this.DrawDynamicInfo()}}this.SelectChartDrawPicture||this.CloseModifyDrawDialog(),document.onmousemove=function(t){e.DocOnMouseMove(t)},document.onmouseup=function(t){e.DocOnMouseUp(t)},document.oncontextmenu=function(t){e.DocContextMenu(t)}}}}}},this.IsShfitDragKLine=function(t){return 1==this.DragMode&&(!!this.KLineDragConfig&&(!!this.KLineDragConfig.EnableShfit&&!!t.shiftKey))},this.DocOnMouseMove=function(t){if(!this.ChartSplashPaint||!this.ChartSplashPaint.IsEnableSplash){var e=this.IsEnableRSelectRect(t,"DocOnMouseMove"),a=this.IsEnableLSelectRect(t,"DocOnMouseMove"),i=this.MouseDrag;if(i){var r=Math.abs(i.LastMove.X-t.clientX),n=Math.abs(i.LastMove.Y-t.clientY),o=this.RectSelectDrag&&this.RectSelectDrag.Index>=0,s=this.RectSelectDrag&&4==this.RectSelectDrag.Type,h=this.IsShfitDragKLine(t);if(i.CurrentMove&&(i.CurrentMove.X=t.clientX,i.CurrentMove.Y=t.clientY),this.BorderDrag&&this.BorderDrag.Index>=0){if(Math.abs(i.LastMove.Y-t.clientY)<5)return;var l=t.clientY-i.LastMove.Y;if(!this.OnMoveFromeBorder(this.BorderDrag.Index,l))return;i.LastMove.X=t.clientX,i.LastMove.Y=t.clientY}else if(this.YDrag&&this.YDrag.Index>=0){if(n<5)return;l=t.clientY-i.LastMove.Y;u.Chart.Log("[JSChartContainer::DocOnMouseMove] YDrag ",this.YDrag,l),this.OnZoomUpDownFrameY(this.YDrag,l),i.LastMove.X=t.clientX,i.LastMove.Y=t.clientY}else if(this.IndexChartDrag&&this.IndexChartDrag.SelectedChart){if(Math.abs(i.LastMove.Y-t.clientY)<2&&Math.abs(i.LastMove.X-t.clientX)<2)return;var C=this.GetExtendChartByClassName("DragMovePaint");if(C&&C.Chart){var D=F(),f=(t.clientX-this.UIElement.getBoundingClientRect().left)*D,c=(t.clientY-this.UIElement.getBoundingClientRect().top)*D;C.Chart.Point={X:f,Y:c},C.Chart.IsShow=!0,C.Chart.Info=this.IndexChartDrag.Info,this.DrawDynamicInfo()}this.IndexChartDrag.LastMove.X=f,this.IndexChartDrag.LastMove.Y=c,i.LastMove.X=t.clientX,i.LastMove.Y=t.clientY}else if(this.CustomChartDrag){D=F(),f=(t.clientX-this.UIElement.getBoundingClientRect().left)*D,c=(t.clientY-this.UIElement.getBoundingClientRect().top)*D;var m={X:f,Y:c,e:t,ChartDrag:this.CustomChartDrag,Drag:i};this.TryDragMove_CustomChartDrag(m)}else if(this.CurrentChartDrawPicture&&!0===this.CurrentChartDrawPicture.EnableMove){var d=this.CurrentChartDrawPicture;if(1==d.Status||2==d.Status){if(Math.abs(i.LastMove.X-t.clientX)<5&&Math.abs(i.LastMove.Y-t.clientY)<5)return;this.SetChartDrawPictureSecondPoint(t.clientX,t.clientY)&&this.DrawDynamicInfo()}else if(3==d.Status)this.SetChartDrawPictureThirdPoint(t.clientX,t.clientY)&&this.DrawDynamicInfo();else if(20==d.Status){if(Math.abs(i.LastMove.X-t.clientX)<5&&Math.abs(i.LastMove.Y-t.clientY)<1)return;if(this.SelectChartDrawPicture&&this.SelectChartDrawPicture.EnableCtrlMove&&!t.ctrlKey)return;this.SelectChartDrawPicture&&this.SelectChartDrawPicture.DragInfo&&(this.SelectChartDrawPicture.DragInfo.Move={X:t.clientX,Y:t.client}),this.MoveChartDrawPicture(t.clientX-i.LastMove.X,t.clientY-i.LastMove.Y,!1,i)&&this.DrawDynamicInfo()}i.LastMove.X=t.clientX,i.LastMove.Y=t.clientY}else if(i.Click&&i.Click.IsInFrameBottom){var I=this.GetDragXCoordinateType(t,"DocOnMouseMove");2==I?this.OnDragXCoordinateZoom(i,{X:r,Y:n},t):1==I&&this.OnDragXCoordinateKLine(i,{X:r,Y:n},t)}else if(!a&&!e||o||s||h)(1==this.DragMode||o||s)&&this.OnDragMode_One({X:r,Y:n},t);else{var S=Math.abs(i.LastMove.Y-t.clientY);if(r<5&&S<5)return;this.SetCursor({Cursor:"default"});var T=this.PointAbsoluteToRelative(i.Click.X,i.Click.Y),v=this.PointAbsoluteToRelative(t.clientX,t.clientY);this.ShowDragSelectRect(T,v),i.LastMove.X=t.clientX,i.LastMove.Y=t.clientY}}}},this.OnDragXCoordinateZoom=function(t,e,a){var i=e.X;e.Y;if(!(i<5)){var r=!0;t.LastMove.X<a.clientX&&(r=!1);var n=this.GetMoveOneStepWidth();i<n||(this.XCoordinateZoom(i,r)&&(this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw(),this.OnKLinePageChange("datamove")),t.LastMove.X=a.clientX),this.SetCursor({Cursor:"ew-resize"})}},this.OnDragXCoordinateKLine=function(t,e,a){var i=e.X;e.Y;if(i<5)return!1;var r=!0;t.LastMove.X<a.clientX&&(r=!1);var n=this.GetMoveOneStepWidth();if(i<n)return this.SetCursor({Cursor:"pointer"}),!1;var o=!1;if(this.DataMove(i,r))this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),o=!0;else if(this.DragDownloadData&&(this.DragDownloadData(),this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash))return!0;return t.LastMove.X=a.clientX,this.SetCursor({Cursor:"pointer"}),o&&(this.Draw(),this.OnKLinePageChange("datamove")),!0},this.OnDragMode_One=function(t,e){var a=t.X,i=t.Y,r=this.MouseDrag;if(!(a<5&&i<5)){var n=!1,o=!1;if(i>=5&&this.UpDownDrag&&this.UpDownDrag.Index>=0){var s=e.clientY-r.LastMove.Y;u.Chart.Log("[JSChartContainer::OnDragMode_One] UpDownDrag ",this.UpDownDrag,s),this.SetCursor({Cursor:"pointer"}),this.OnUpDonwFrameY(this.UpDownDrag,s)&&(n=!0,o=!0),r.LastMove.Y=e.clientY}if(a>=5){if(this.RectSelectDrag){if(this.RectSelectDrag.Index>=0){var h={X:e.clientX,Y:e.clientY,PointIndex:this.RectSelectDrag.Index,Name:"MoveRectSelectLine"};this.MoveRectSelectPoint(h)&&(n=!0)}else if(4===this.RectSelectDrag.Type){h={X:e.clientX};if(!this.GetXDataIndex(h))return;if(h.DataIndex==this.RectSelectDrag.DataIndex)return;var l=h.DataIndex-this.RectSelectDrag.DataIndex,C=!0;if(l>0&&(C=!1),!this.MoveSubRectSelect({Step:Math.abs(l),IsLeft:C,X:e.clientX,Y:e.clientY}))return;this.RectSelectDrag.DataIndex=h.DataIndex,this.RectSelectDrag.X=e.clientX,n=!0}}else{C=!0;if(r.LastMove.X<e.clientX&&(C=!1),this.KLineDragConfig&&this.KLineDragConfig.EnableShfit&&!e.shiftKey)return;var D=this.GetMoveOneStepWidth();if(a<D)return this.SetCursor({Cursor:"pointer"}),void(n&&this.Draw());if(this.DataMove(a,C))this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),n=!0;else if(!o&&this.DragDownloadData&&(this.DragDownloadData(),this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash))return;this.SetCursor({Cursor:"pointer"})}r.LastMove.X=e.clientX}n&&(this.Draw(),this.OnKLinePageChange("datamove"))}},this.GetXDataIndex=function(e){if(!this.ChartPaint[0]||!this.ChartPaint[0].Data)return!1;var a=this.ChartPaint[0].Data;if(!this.Frame.SubFrame[0])return!1;var i=this.Frame.SubFrame[0].Frame,r=F(),n=(e.X-t.getBoundingClientRect().left)*r,o=i.GetXData(n);o=parseInt(o.toFixed(0));var s=o+a.DataOffset;s>=a.Data.length&&(s=a.Data.length-1);var h=a.Data[s];return e.DataIndex=s,e.Item=h,!0},this.ClearPreventRightMenu=function(t){var e=this,a=3e3;sa.IsNumber(t)&&(a=t),this.PreventRightMenu.Timer&&(clearTimeout(this.PreventRightMenu.Timer),this.PreventRightMenu.Timer=null),this.PreventRightMenu.Timer=setTimeout((function(){e.PreventRightMenu.Enable=!1,e.PreventRightMenu.Timer=null}),a)},this.DocOnMouseUp=function(e){document.onmousemove=null,document.onmouseup=null;var a=this.IsEnableRSelectRect(e,"DocOnMouseUp"),i=this.IsEnableLSelectRect(e,"DocOnMouseUp"),r="MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName,n=this.RectSelectDrag&&this.RectSelectDrag.Index>=0,o=this.RectSelectDrag&&4==this.RectSelectDrag.Type,s=!0,h=this.IsShfitDragKLine(e);if(this.CurrentChartDrawPicture){var l=this.CurrentChartDrawPicture;2==l.Status||1==l.Status||3==l.Status?(l.PointStatus=l.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():s=!1):20==l.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}else if(this.IndexChartDrag&&this.IndexChartDrag.SelectedChart){var C=this.GetExtendChartByClassName("DragMovePaint");C&&C.Chart&&C.Chart.Clear(),this.OnDragChart(this.IndexChartDrag)||this.DrawDynamicInfo(),this.SetCursor({Cursor:"default"})}else if(this.CustomChartDrag){var D={e:e,ChartDrag:this.CustomChartDrag,Drag:this.MouseDrag};this.TryMouseUp_CustomChartDrag(D)}else if(n)this.OnDragSelectRectMouseUp&&this.OnDragSelectRectMouseUp(e);else if(o)this.OnDragSubSelectRectMouseUp&&this.OnDragSubSelectRectMouseUp(e);else if(r)this.OnMinuteSelectRectMouseUp&&this.OnMinuteSelectRectMouseUp(e);else if(this.MouseDrag&&this.MouseDrag.Click&&this.MouseDrag.Click.IsInFrameBottom)e&&2===e.button&&this.EnableXDrag.RButton.Type>=1&&(this.PreventRightMenu.Enable=!0);else if(!i&&!a||h)this.TryClickPaintEvent(m.ON_CLICKUP_CHART_PAINT,this.ClickDownPoint,e),this.ClickEvent(e);else{var f=this.MouseDrag;f.LastMove.X=e.clientX,f.LastMove.Y=e.clientY;var c=new H,d=F();c.XStart=(f.Click.X-t.getBoundingClientRect().left)*d,c.YStart=(f.Click.Y-t.getBoundingClientRect().top)*d,c.XEnd=(f.LastMove.X-t.getBoundingClientRect().left)*d,c.YEnd=(f.LastMove.Y-t.getBoundingClientRect().top)*d,c.JSChartContainer=this,c.Stock={Symbol:this.Symbol,Name:this.Name},c.IsLButton=i,c.IsRButton=a,!this.BorderDrag&&this.GetSelectRectData(c)?this.FinishSelectRect(c,e):this.TryClickPaintEvent(m.ON_CLICKUP_CHART_PAINT,this.ClickDownPoint,e)}u.Chart.Log("[KLineChartContainer::document.onmouseup]",e),this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.DragInfo=null),this.SetCursor({Cursor:"default"}),this.MouseDrag=null,this.ClickDownPoint=null,this.IsOnTouch=!1,1==this.EnableEraseChartDrawPicture&&(this.EnableEraseChartDrawPicture=!1,this.DialogDrawTool&&this.DialogDrawTool.SetEraseChartButtonStatus&&this.DialogDrawTool.SetEraseChartButtonStatus(!1)),this.BorderDrag&&this.BorderDrag.Index>=0&&this.Frame.SaveSubFrameHeightRate(),this.BorderDrag=null,this.YDrag=null,this.UpDownDrag=null,this.RectSelectDrag=null,this.IndexChartDrag=null,this.CustomChartDrag=null,!0===s&&(this.CurrentChartDrawPicture=null),this.ClearPreventRightMenu(this.PreventRightMenu.Delay)},this.FinishSelectRect=function(e,a){var i=this.IsMinuteContainer(),r=this.MouseDrag,n=this.GetEventCallback(m.ON_SELECT_RECT),o=this.GetRectSelectPaint(),s=r.LastMove.X-t.getBoundingClientRect().left,h=r.LastMove.Y-t.getBoundingClientRect().top;if(a&&2==a.button&&(this.PreventRightMenu.Enable=!0),a){var l={Chart:this,X:s,Y:h,SelectData:e,RectSelectPaint:o,IsLButton:e.IsLButton,IsRButton:e.IsRButton};a.data=l}var u=null,C=null;if(i?C={ID:v.CMD_SELECTED_SUMMARY_ID,Args:[a,e]}:u=[{Name:"区间统计",Data:{ID:v.CMD_SELECTED_SUMMARY_ID,Args:[a,e]}},{Name:"区间放大",Data:{ID:v.CMD_SELECTED_ZOOM_ID,Args:[e]}}],n&&n.Callback){var D={X:s,Y:h,e:a,SelectData:e,RectSelectPaint:o,AryMenu:u,Command:C,IsLButton:e.IsLButton,IsRButton:e.IsRButton,PreventDefault:!1};if(i&&(D.Command=null),n.Callback(n,D,this),1==D.PreventDefault)return;u=D.AryMenu,C=D.Command}u?this.PopupSelectRectMenuV3(u,l,a):C?this.ExecuteMenuCommand(C.ID,C.Args):(this.HideSelectRect(),this.UpdateSelectRect(e.Start,e.End))},this.PopupSelectRectMenuV3=function(t,e,a){var i=this;if(t){var r={Menu:t,Position:JSPopMenu.POSITION_ID.RIGHT_MENU_ID,ClickCallback:function(t){i.OnClickRightMenu(t)}},n=e.X,o=e.Y;this.PopupMenuByRClick(r,n,o)}},this.DocContextMenu=function(t){this.PreventRightMenu.Enable&&t.preventDefault()},this.UIOnMounseOut=function(t){u.Chart.Log("[KLineChartContainer::UIOnMounseOut]",t),this.EnableClickModel&&1==this.ClickModel.IsShowCorssCursor||this.IsLockCorssCursor()||this.UIOnMouseMove(t)},this.UIOnMouseleave=function(t){u.Chart.Log("[KLineChartContainer::UIOnMouseleave]",t)},this.OnDragChart=function(t){if(!t)return!1;var e=t.Info,a=t.LastMove,i=e.FrameID,r=this.Frame.PtInFrame(a.X,a.Y);return r<0?-3==r&&this.MoveIndexToNewWindow({WindowIndex:i,IndexID:e.IndexID},{Operator:0}):i!=r&&this.MoveIndex({WindowIndex:i,IndexID:e.IndexID},{WindowIndex:r},{Operator:0})},this.GetSelectedChartInfo=function(t){if(!t)return null;var e={Type:0},a=t.Identify;if("Main-KLine"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ta.MAIN_KLINE;else if(0==a.indexOf("Overlay-KLine-"))e.Name=t.Chart.Title,e.Symbol=t.Chart.Symbol,e.Type=ta.OVERLAY_KLINE;else if(0==a.indexOf("Overlay-Minute-"))e.Name=t.Chart.Title,e.Symbol=t.Chart.Symbol,e.Type=ta.OVERLAY_MINUTE;else if("Minute-Line"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ta.MAIN_MINUTE;else if("Minute-Average-Line"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ta.MAIN_AVERAGE_MINUTE;else if("Minute-Vol-Bar"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ta.MAIN_MINUTE_VOL;else if(0==a.indexOf("guid"))for(var i=0;i<this.TitlePaint.length;++i){var r=this.TitlePaint[i];if("DynamicChartTitlePainting"==r.ClassName){if(r.Identify==a){e.IndexName=r.Title,e.IndexID=a,e.Type=ta.MAIN_INDEX;break}var n,o=(0,l.default)(r.OverlayIndex);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s[0]==a){e.IndexName=s[1].Title,e.IndexID=a,e.Type=ta.OVERLAY_INDEX;break}}}catch(h){o.e(h)}finally{o.f()}if(e.Type>0)break}}return e},this.ClickEvent=function(e){var a=this.GetEventCallback(m.ON_CLICK);if(!a||!a.Callback)return!1;if(this.ClickDownPoint.X!=e.clientX||this.ClickDownPoint.Y!=e.clientY)return!1;var i=F(),r=(e.clientX-t.getBoundingClientRect().left)*i,n=(e.clientY-t.getBoundingClientRect().top)*i,o={X:e.clientX,Y:e.clientY,FrameID:-1},s=this.PtInClient(r,n);if(s>0){var h={},l=this.Frame.GetYData(n,h);if(sa.IsNumber(h.FrameID)&&h.FrameID>=0){var u=this.Frame.GetXData(r);o.FrameID=h.FrameID,o.Data={X:u,Y:l}}}return a.Callback(a,o,this),!0},this.DBClickEvent=function(e,a){var i=this.GetEventCallback(m.ON_DBCLICK);if(!i||!i.Callback)return!1;var r=F(),n=(a.clientX-t.getBoundingClientRect().left)*r,o=(a.clientY-t.getBoundingClientRect().top)*r,s={X:a.clientX,Y:a.clientY,FrameID:-1,ClientPos:-1},h=this.PtInClient(n,o);if(s.ClientPos=h,h>0){var l={},u=this.Frame.GetYData(o,l);if(sa.IsNumber(l.FrameID)&&l.FrameID>=0){var C=this.Frame.GetXData(n);s.FrameID=l.FrameID,s.Data={X:C,Y:u},this.GetDataItem&&(s.Data.Item=this.GetDataItem({ClientPos:h,Index:C,Point:{X:n,Y:o}}))}}return e&&e.SelectedChart&&(s.SelectedChart=this.GetSelectedChartInfo(e.SelectedChart)),i.Callback(i,s,this),!0},this.PtInChartPaintTooltip=function(t,e,a){for(var i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];if(r.GetTooltipData(t,e,a))return r}return null},this.PtInOverlayIndexTooltip=function(t,e,a){var i=this.Frame.PtInFrame(t,e);if(i<0)return null;if(!this.Frame.SubFrame[i])return null;var r=this.Frame.SubFrame[i].OverlayIndex;if(!sa.IsNonEmptyArray(r))return null;for(var n=0;n<r.length;++n){var o=r[n];if(sa.IsNonEmptyArray(o.ChartPaint))for(var s=0;s<o.ChartPaint.length;++s){var h=o.ChartPaint[s];if(h.IsShow&&(!h.IsHideScriptIndex()&&h.GetTooltipData(t,e,a)))return a.OverlayIndex={WindowIndex:i,Identify:o.Identify},o.Script&&(a.OverlayIndex.IndexName=o.Script.Name,a.OverlayIndex.IndexID=o.Script.ID),h}}return null},this.PtInOverlayChartPaintTooltip=function(t,e,a){for(var i=0;i<this.OverlayChartPaint.length;++i){var r=this.OverlayChartPaint[i];if(r.GetTooltipData(t,e,a))return r}return null},this.PtInExtendChartPaintTooltip=function(t,e,a){return null},this.TryClickPaintEvent=function(e,a,i){var r=this.GetEventCallback(e);if(r&&r.Callback&&a.X==i.clientX&&a.Y==i.clientY){var n=F(),o=(i.clientX-t.getBoundingClientRect().left)*n,s=(i.clientY-t.getBoundingClientRect().top)*n,h=new pt,l=null,u=this.PtInChartPaintTooltip(o,s,h);if(u&&(l={Symbol:this.Symbol,Name:this.Name}),u||(u=this.PtInOverlayChartPaintTooltip(o,s,h),u&&(l={Symbol:h.ChartPaint.Symbol,Name:h.ChartPaint.Title})),h.Data){var C={X:i.clientX,Y:i.clientY,Stock:l,Tooltip:h};return r.Callback(r,C,this),!0}}return!1},this.IsPhoneDragging=function(t){var e=t.changedTouches.length,a=t.touches.length;return 1==e&&1==a},this.IsPhonePinching=function(t){var e=t.changedTouches.length,a=t.touches.length;return(1==e||2==e)&&2==a},this.PreventTouchEvent=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},this.GetToucheData=function(t,e){for(var a=new Array,i=F(),r=0;r<t.touches.length;++r){var n=t.touches[r];e?a.push({clientX:n.clientY*i,clientY:n.clientX*i,pageX:n.pageY*i,pageY:n.pageX*i}):a.push({clientX:n.clientX*i,clientY:n.clientY*i,pageX:n.pageX*i,pageY:n.pageY*i})}return a},this.IsSingleTouch=function(t){var e=t.touches.length;return 1==e},this.StopDragTimer=function(){sa.IsNumber(this.DragTimer)&&(clearTimeout(this.DragTimer),this.DragTimer=null,this.IsPress=!1)},this.GetMoveAngle=function(t,e){var a=Math.abs(t.X-e.X),i=Math.abs(t.Y-e.Y),r=180*Math.atan(a/i)/Math.PI;return r},t.ontouchstart=function(t){i.OnTouchStart(t)},t.ontouchmove=function(t){i.OnTouchMove(t)},t.ontouchend=function(t){i.OnTouchEnd(t)},this.AddPhoneDBClickInfo=function(t,e,a){var i={X:t,Y:e,Time:a};this.PhoneDBClickInfo.Start.push(i)},this.ClearPhoneDBClickInfo=function(){this.PhoneDBClickInfo.Start=[]},this.IsShortPhoneClick=function(t,e,a){},this.TryPhoneClickButton=function(t,e,a){if(this.TryClickLock||this.TryClickIndexTitle){if(this.TryClickLock&&this.TryClickLock(t,e))return!0;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(t,e))return!0}if(this.ClickFrameButton){var i=this.Frame.PtInButtons(t,e);if(i)return this.ClickFrameButton(i,a),!0}return i=this.PtInExtendChartButtons(t,e),i&&this.ClickExtendChartButton?(this.ClickExtendChartButton(i,a),!0):!!this.TryClickCrossCursor(t,e)},this.OnTouchStart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsPress=!1,this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null,this.TouchDrag=null,this.ClickModel.IsClickButton=!1,this.ClickModel.PreventHide=!1,this.StopDragTimer();var e=this.IsSingleTouch(t);if((0==this.EnableScrollUpDown||!e||this.DragMode==I.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow)&&t.cancelable&&t.preventDefault(),this.IsPhoneDragging(t)){var a=this.GetToucheData(t,this.IsForceLandscape),i=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0);if(this.TryPhoneClickButton(i.X,i.Y,t))return void(this.ClickModel.IsClickButton=!0);this.EnableVerticalDrag&&(this.VerticalDrag={IsDrag:!1},this.Frame.PtInFrameVertical(i.X,i.Y)&&(this.VerticalDrag.IsDrag=!0));var r=!0;this.ChartDrawOption.IsLockScreen?r=!1:this.DragMode==I.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(r=!1):this.DragMode==I.DISABLE_DRAG_ID?r=!1:e||(r=!1),this.VerticalDrag&&(r=!1),this.EnableClickModel&&1==this.ClickModel.IsShowCorssCursor&&(r=!1);var n={Click:{},LastMove:{},StartTime:Date.now()},o={Click:{},LastMove:{},StartTime:Date.now()};n.Click.X=a[0].clientX,n.Click.Y=a[0].clientY,n.LastMove.X=a[0].clientX,n.LastMove.Y=a[0].clientY,this.MouseDrag=n,o.Click.X=a[0].clientX,o.Click.Y=a[0].clientY,o.LastMove.X=a[0].clientX,o.LastMove.Y=a[0].clientY,this.TouchDrag=o;var s=this.GetActiveDrawPicture();this.SelectedChart.Selected.Chart,this.SelectedChart.Selected.Identify;this.PhoneTouchInfo={Start:{X:a[0].clientX,Y:a[0].clientY},End:{X:a[0].clientX,Y:a[0].clientY}},this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null;if(this.CurrentChartDrawPicture){var h=this.CurrentChartDrawPicture;return 2==h.Status?this.SetChartDrawPictureThirdPoint(n.Click.X,n.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(n.Click.X,n.Click.Y,!0),this.FinishChartDrawPicturePoint()&&(h.IsDrawMain?this.Draw():this.DrawDynamicInfo({Corss:!1,Tooltip:!1}))),void(t.cancelable&&t.preventDefault())}i=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0);var l={X:i.X,Y:i.Y};F();if(this.GetChartDrawPictureByPoint(l)){1==l.ChartDrawPicture.EnableMove&&(l.ChartDrawPicture.Status=20),l.ChartDrawPicture.ValueToPoint(),l.ChartDrawPicture.MovePointIndex=l.PointIndex,l.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=l.ChartDrawPicture,this.SelectChartDrawPicture=l.ChartDrawPicture;var C=this.GetEventCallback(m.ON_CLICK_DRAWPICTURE);if(C&&C.Callback){var D={DrawPicture:l.ChartDrawPicture};C.Callback(C,D,this)}var f=0;return(l.ChartDrawPicture.IsDrawMain||s.Select.Guid&&s.Select.Chart&&s.Select.Chart.IsDrawMain)&&(f=1),1==f&&this.Draw(),void(t.cancelable&&t.preventDefault())}if(r){var c=this;this.DragTimer=setTimeout((function(){if(c.IsPress=!0,n.Click.X==n.LastMove.X&&n.Click.Y==n.LastMove.Y){c.MouseDrag;c.MouseDrag=null,c.DragMode==I.CLICK_TOUCH_MODE_ID&&(c.TouchStatus.CorssCursorShow=!0),!0===c.EnableClickModel&&(c.ClickModel.IsShowCorssCursor=!0),c.MoveCorssCursor(n.Click,t)}}),c.PressTime)}this.EnableZoomIndexWindow&&(this.PhoneDBClick.AddTouchStart(a[0].clientX,a[0].clientY,Date.now()),u.Chart.Log("[JSChartContainer::OnTouchStart] PhoneDBClick ",this.PhoneDBClick)),this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==I.CLICK_TOUCH_MODE_ID||(this.DragMode==I.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(n.Click,t)):this.EnableClickModel||(this.VerticalDrag?this.VerticalDrag.IsDrag||this.MoveCorssCursor(n.Click,t):this.IsClickShowCorssCursor&&this.MoveCorssCursor(n.Click,t))),this.TouchEvent({EventID:m.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},t);f=0;null!=s.Select.Guid&&s.Select.Guid&&s.Select.Chart&&(f=1),1==f&&this.Draw()}else if(this.IsPhonePinching(t)){var d={Start:{},Last:{},StartTime:Date.now()};a=this.GetToucheData(t,this.IsForceLandscape);d.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},d.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},this.PhonePinch=d,this.SelectChartDrawPicture=null}}},this.OnTouchMove=function(e){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this.GetToucheData(e,this.IsForceLandscape);if(this.ClickModel.IsClickButton=!1,this.IsPhoneDragging(e)){var i=this.MouseDrag;if(null==i)this.IsForceLandscape&&(y=t.getBoundingClientRect().width-a[0].clientY),this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:a[0].clientX,Y:a[0].clientY},e);else{var r=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),n=Math.abs(i.LastMove.X-a[0].clientX),o=Math.abs(i.LastMove.Y-a[0].clientY);n=parseInt(n);var s=this.DragMode==I.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.VerticalDrag&&(s=!0!==this.VerticalDrag.IsDrag),this.EnableClickModel&&(s=!0===this.ClickModel.IsShowCorssCursor),this.CurrentChartDrawPicture&&!0===this.CurrentChartDrawPicture.EnableMove){var h=this.CurrentChartDrawPicture;if(1==h.Status||2==h.Status){if(n<5&&o<5)return;this.SetChartDrawPictureSecondPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo()}else if(3==h.Status)this.SetChartDrawPictureThirdPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo();else if(20==h.Status){if(n<5&&o<5)return;this.MoveChartDrawPicture(a[0].clientX-i.LastMove.X,a[0].clientY-i.LastMove.Y,!0)&&this.DrawDynamicInfo()}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}else if(s){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(i.Click,e)}else if(1==this.DragMode||0==s){if((o>0&&n<=3||r<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return void this.StopDragTimer();if(n<5||r<=this.TouchMoveMinAngle)return void this.PreventTouchEvent(e);if(this.EnableVerticalDrag){if(!this.VerticalDrag)return;if(!this.VerticalDrag.IsDrag)return}var l=!0;i.LastMove.X<a[0].clientX&&(l=!1);var u=this.GetMoveOneStepWidth();if(n<u)return;this.DataMove(n,l)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw(),this.OnKLinePageChange("OnTouchMove")):this.DragDownloadData&&this.DragDownloadData(),i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}if(this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=a[0].clientX,this.PhoneTouchInfo.End.Y=a[0].clientY),this.TouchDrag){var C=this.TouchDrag;C.LastMove.X=a[0].clientX,C.LastMove.Y=a[0].clientY}}else if(this.IsPhonePinching(e)){if(this.DragMode==I.DISABLE_DRAG_ID)return;this.PreventTouchEvent(e);var D=this.PhonePinch;if(!D)return;if(D.Operator=null,this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var f=Math.abs(a[0].pageY-a[1].pageY),c=Math.abs(D.Last.Y-D.Last.Y2),m=f-c,d=Math.abs(a[0].pageX-a[1].pageX),S=Math.abs(D.Last.X-D.Last.X2),T=d-S,v=this.ZoomStepPixel;if(Math.abs(m)<v&&Math.abs(T)<v)return;var p=m;if(Math.abs(m)<v&&(p=T),p>0){var g={IsLockRight:this.IsZoomLockRight};if(g.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(g))return;D.Operator="ZoomUp",this.CursorIndex=g.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}else{g={IsLockRight:this.IsZoomLockRight};if(g.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(g))return;D.Operator="ZoomDown",this.CursorIndex=g.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}D.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}this.PreventTouchEvent(e)}},this.OnTouchEnd=function(t){if(u.Chart.Log("[KLineChartContainer:OnTouchEnd]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.FastSlideEvent();var e=!0;if(this.CurrentChartDrawPicture){var a=this.CurrentChartDrawPicture;2==a.Status||1==a.Status||3==a.Status?(a.PointStatus=a.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():e=!1):20==a.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}if(this.EnableZoomIndexWindow){var i=Date.now();this.PhoneDBClick.AddTouchEnd(i),this.PhoneDBClick.IsVaildDBClick()&&(this.OnTouchDBClick(this.PhoneDBClick.Start),this.PhoneDBClick.Clear())}this.IsOnTouch=!1,this.VerticalDrag=null,!0===e&&(this.CurrentChartDrawPicture=null),this.StopDragTimer(),this.TouchEvent({EventID:m.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0,this.PhonePinch=null,this.TouchDrag=null}},this.OnTouchDBClick=function(t){var e=this.PointAbsoluteToRelative(t[0].X,t[0].Y,!0),a=e.X,i=e.Y;u.Chart.Log("[KLineChartContainer:OnTouchDBClick] Phone dbclick absolute [".concat(a,",").concat(i,"], soruce [").concat(t[0].X,",").concat(t[0].Y,"]"));var r=this.Frame.PtInFrame(a,i);if(u.Chart.Log("[KLineChartContainer::OnTouchDBClick] frameId",r),r>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(r,{X:a,Y:i}))return this.Frame.SetSizeChage(!0),this.Draw(),!0},this.TouchEvent=function(t,e){var a=t.EventID,i=this.GetEventCallback(a);if(!i||!i.Callback)return!1;var r=this.PhoneTouchInfo;if(!r||!r.Start||!r.End)return!1;var n,o=F(),s=r.End.X/o,h=r.End.Y/o,l=r.End.X-this.UIElement.getBoundingClientRect().left*o,u=r.End.Y-this.UIElement.getBoundingClientRect().top*o,C={X:s,Y:h,FrameID:-1,FunctionName:t.FunctionName,Drag:{Start:{X:r.Start.X/o,Y:r.Start.Y/o},End:{X:r.End.X/o,Y:r.End.Y/o}}};if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),n=this.Canvas.isPointInPath(l,u),n)if(this.Frame&&this.Frame.IsHScreen){var D={},f=this.Frame.GetYData(l,D);if(sa.IsNumber(D.FrameID)&&D.FrameID>=0){var c=this.Frame.GetXData(u);C.FrameID=D.FrameID,C.Data={X:c,Y:f}}}else{D={},f=this.Frame.GetYData(u,D);if(sa.IsNumber(D.FrameID)&&D.FrameID>=0){c=this.Frame.GetXData(l);C.FrameID=D.FrameID,C.Data={X:c,Y:f}}}return i.Callback(i,C,this),!0},this.MoveCorssCursor=function(t,e){var a=F(),i=t.X-this.UIElement.getBoundingClientRect().left*a,r=t.Y-this.UIElement.getBoundingClientRect().top*a;this.DragMode==I.CLICK_TOUCH_MODE_ID&&(this.TouchStatus.CorssCursorShow=!0),this.OnMouseMove(i,r,e,!0)},this.DrawEmpty=function(){this.UIElement.width<=0||this.UIElement.height<=0||(this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Frame&&(this.Frame.ScreenImageData=null,this.Frame.Draw()))},this.PtInChart=function(t,e){for(var a=null,i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];if(r.PtInChart&&(!r.IsHideScriptIndex()&&(a=r.PtInChart(t,e),a)))return a}for(i=0;i<this.OverlayChartPaint.length;++i){r=this.OverlayChartPaint[i];if(r.PtInChart&&(a=r.PtInChart(t,e),a))return a}return this.Frame.PtInOveralyChart&&(a=this.Frame.PtInOveralyChart(t,e),a)?a:null},this.DrawSelectedStatus=function(){if(this.SelectedChart.MoveOn.Identify||this.SelectedChart.Selected.Identify){for(var t=0;t<this.ChartPaint.length;++t){var e=this.ChartPaint[t];e.Identify&&(e.Identify!=this.SelectedChart.MoveOn.Identify&&e.Identify!=this.SelectedChart.Selected.Identify||e.DrawSelectedStatus&&e.DrawSelectedStatus())}for(t=0;t<this.OverlayChartPaint.length;++t){e=this.OverlayChartPaint[t];e.Identify&&(e.Identify!=this.SelectedChart.MoveOn.Identify&&e.Identify!=this.SelectedChart.Selected.Identify||e.DrawSelectedStatus&&e.DrawSelectedStatus())}for(t=0;t<this.OverlayChartPaint.length;++t){e=this.OverlayChartPaint[t];e.Identify&&(e.Identify!=this.SelectedChart.MoveOn.Identify&&e.Identify!=this.SelectedChart.Selected.Identify||e.DrawSelectedStatus&&e.DrawSelectedStatus())}this.Frame.DrawOveralySelectedStatus&&this.Frame.DrawOveralySelectedStatus(this.SelectedChart)}},this.SetCanvas=function(t){if(this.Frame)for(var e=this.Frame.SubFrame,a=0;a<e.length;++a){var i=e[a];i.Frame.Canvas=t;for(var r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];n.Frame.Canvas=t;for(var o=0;o<n.ChartPaint.length;++o){var s=n.ChartPaint[o];s.Canvas=t}}}for(a=0;a<this.ChartDrawPicture.length;++a){i=this.ChartDrawPicture[a];i.Canvas=t}for(a=0;a<this.ChartPaint.length;++a){i=this.ChartPaint[a];i.Canvas=t}for(a=0;a<this.ChartPaintEx.length;++a){i=this.ChartPaintEx[a];i.Canvas=t}for(a=0;a<this.OverlayChartPaint.length;++a){i=this.OverlayChartPaint[a];i.Canvas=t}for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];i.Canvas=t}},this.ClearCanvas=function(t){t&&this.UIElement&&t.clearRect(0,0,this.UIElement.width,this.UIElement.height)},this.Draw=function(){var t=this;if(this.ChartCorssCursor&&(this.ChartCorssCursor.Status=0),!(this.UIElement.width<=0||this.UIElement.height<=0)){this.StopDrawDynamicInfo();var e=this.GetEventCallback(m.ON_BEFORE_DRAW);if(e&&e.Callback){e.Callback(e,{},this)}this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.CacheCanvas&&this.CacheCanvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var a=F();if(this.Canvas.lineWidth=a,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash){var i=this.InvokeBeforeDrawSplashScreenCallback();if(i&&!0===i.PreventDefault)return;return this.Frame.ClearCoordinateText(),this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw()}if(this.CacheCanvas&&this.SetCanvas(this.CacheCanvas),this.Frame.SetBeforeDrawXYCallback&&this.Frame.SetBeforeDrawXYCallback((function(e){t.BeforeDrawXYCoordinate(e)})),this.Frame.Draw(),this.Frame.DrawCustomVertical){var r=this.GetEventCallback(m.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(r)}this.Frame.CalculateLock();for(var n=0;n<this.ChartDrawPicture.length;++n){var o=this.ChartDrawPicture[n];o.IsDrawMain&&(o.IsDrawMain()&&o.MainDraw())}for(n=0;n<this.ChartPaint.length;++n){o=this.ChartPaint[n];o.IsDrawFirst&&o.Draw()}this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_5),this.Frame.DrawOveraly&&this.Frame.DrawOveraly(!0);for(n=0;n<this.ChartPaint.length;++n){o=this.ChartPaint[n];o.IsDrawFirst||o.Draw()}for(n=0;n<this.ChartPaintEx.length;++n){o=this.ChartPaintEx[n];o.Draw()}for(n=0;n<this.OverlayChartPaint.length;++n){o=this.OverlayChartPaint[n];o.Draw()}this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_8),this.Frame.DrawOveraly&&this.Frame.DrawOveraly(!1),this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_10),this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.KLineIncreaseCustomHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.Frame.DrawEx&&this.Frame.DrawEx({Symbol:this.Symbol}),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock(),this.Frame.DrawLogo(),this.CacheCanvas?(this.Canvas.drawImage(this.CacheElement,0,0),this.SetCanvas(this.Canvas)):this.Frame.Snapshot(),this.Frame.DrawToolbar&&this.Frame.DrawToolbar(this.LastMouseStatus),this.DrawSelectedStatus(),this.DrawSelectedBorder(),this.DrawSelectedXBorder&&this.DrawSelectedXBorder();var s=null;this.LastMouseStatus&&this.LastMouseStatus.MoveOnPoint&&(s=this.LastMouseStatus.MoveOnPoint),this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_20,{MoveonPoint:s});for(n=0;n<this.ChartDrawPicture.length;++n){o=this.ChartDrawPicture[n];o.IsDrawFirst&&o.Draw()}this.DrawDrawPictureXYCoordinate();var h=!1,l=null,u=this.GetCorssCursorPosition();if(null!=u.LastPoint.X||null!=u.LastPoint.Y){if(this.ChartCorssCursor){this.ChartCorssCursor.LastPoint=u.LastPoint,this.ChartCorssCursor.CursorIndex=u.CursorIndex,this.EnableNewIndex&&(this.ChartCorssCursor.CorssCursorIndex=u.CorssCursorIndex,this.ChartCorssCursor.EnableNewIndex=this.EnableNewIndex);var C=!1;this.CorssCursorCanvas&&(this.ChartCorssCursor.Canvas=this.CorssCursorCanvas,this.ChartCorssCursor.Canvas.clearRect(0,0,this.CorssCursorElement.width,this.CorssCursorElement.height),C=!0);var D=this.PtInButton(this.LastPoint.X,this.LastPoint.Y);D||(this.DragMode==I.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&this.ChartCorssCursor.Draw():this.EnableClickModel?!0===this.ClickModel.IsShowCorssCursor&&this.ChartCorssCursor.Draw():!0===this.CorssCursorTouchEnd&&this.MouseDrag||1==this.CorssCursorTouchEnd&&0==this.IsOnTouch||this.ChartCorssCursor.Draw()),C&&(this.ChartCorssCursor.Canvas=this.Canvas),h=!0}l=this.Frame.PtInFrame(this.LastPoint.X,this.LastPoint.Y)}var f=this.GetDrawStatus();f.DrawName="Draw";var c=this.GetEventCallback(m.ON_TITLE_DRAW),d=this.GetEventCallback(m.ON_INDEXTITLE_DRAW);for(n=0;n<this.TitlePaint.length;++n){o=this.TitlePaint[n];o.IsDynamic&&(o.CursorIndex=u.CursorIndex,o.LastPoint=u.LastPoint,"DynamicChartTitlePainting"==o.ClassName?o.OnDrawEvent=d:o.OnDrawEvent=c,o.OnDrawEvent&&(o.OnDrawEvent.FunctionName="Draw",o.OnDrawEvent.PointPosition=l,this.IsLockCorssCursor()&&o.OnDrawEvent.PointPosition<0&&(o.OnDrawEvent.PointPosition=0)),o.DrawStatus=f,o.Draw(s,this.LastMouseStatus))}this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_25),this.EnableAnimation&&this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_30);for(n=0;n<this.ChartDrawPicture.length;++n){o=this.ChartDrawPicture[n];o.IsDrawFirst||(o.IsDrawMain&&o.IsDrawMain()||this.SelectChartDrawPicture&&this.SelectChartDrawPicture.Guid==o.Guid||o.Draw())}if(this.SelectChartDrawPicture&&this.SelectChartDrawPicture.Draw(),this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw(),this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_50),this.OffscreenToShowCanvas(),"function"==typeof this.UpdateScrollBar&&this.UpdateScrollBar(),this.LastMouseStatus.MouseOnToolbar){var S=this.LastMouseStatus.MouseOnToolbar.Frame;S&&S.DrawToolbarTooltip&&S.DrawToolbarTooltip(this.LastMouseStatus.MouseOnToolbar)}if(h&&this.DrawTooltipDialog(),this.mapEvent.has(m.CHART_STATUS)){e=this.mapEvent.get(m.CHART_STATUS),i={};"function"==typeof this.GetChartStatus&&(i=this.GetChartStatus()),e.Callback(e,i,this)}++this.TouchDrawCount}},this.DrawExtendChartPaint=function(t,e){if(sa.IsNonEmptyArray(this.ExtendChartPaint))for(var a=0;a<this.ExtendChartPaint.length;++a){var i=this.ExtendChartPaint[a];if(!i.IsCallbackDraw){var r=i.GetPriority();if(r==t)if(t==He.DRAW_PRIORITY_ID.LEVEL_20)i.Draw(),i.DrawToolbar&&e&&i.DrawToolbar(e.MoveonPoint,e.LastMouseStatus);else if(t==He.DRAW_PRIORITY_ID.LEVEL_25&&e){if("KLineTooltipPaint"==i.ClassName&&e){if(0==e.Tooltip)continue;e.Point&&(i.LatestPoint=e.Point)}else"MinuteTooltipPaint"==i.ClassName&&e&&e.Point&&(i.LatestPoint=e.Point);i.Draw(e.MoveonPoint,e.LastMouseStatus)}else i.Draw()}}},this.PtInButton=function(t,e){var a=this.Frame.PtInButtons(t,e);return a?{Name:"FrameButton",Button:a}:(a=this.PtInExtendChartButtons(t,e),a?{Name:"ExtendChartButton",Button:a}:(a=this.PtInDrawPictureButtons(t,e),a?{Name:"DrawPictureButton",Button:a}:(a=this.PtInTitleButtons(t,e),a?{Name:"TitleButton",Button:a}:null)))},this.DrawDrawPictureXYCoordinate=function(){var t=null;this.CurrentChartDrawPicture?t=this.CurrentChartDrawPicture:this.SelectChartDrawPicture&&(t=this.SelectChartDrawPicture);for(var e={Symbol:this.Symbol,Period:this.Period},a=0;a<this.ChartDrawPicture.length;++a){var i=this.ChartDrawPicture[a];i&&(this.IsDrawPictureXY&&t&&(t==i||t.Guid==i.Guid)&&this.Frame.DrawPictureCoordinate(t,e)||i.IsShowYCoordinate&&i.Frame&&i.Frame.DrawPicturePointYCoordinate(i,e))}},this.BeforeDrawXYCoordinate=function(t){for(var e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];a.IsCallbackDraw&&(["KLineYAxisBGPaint","DepthMapPaint","BackgroundPaint","MinuteBackgroundPaint","SessionBreaksPaint"].includes(a.ClassName)?a.FrameID==t.Identify&&a.Draw():Ve.IsCallbackDraw(a.ClassName)&&a.FrameID==t.Identify&&a.Draw())}},this.DrawSelectedBorder=function(){if(this.GlobalOption.SelectedBorder){var t=this.GlobalOption.SelectedBorder;if(sa.IsPlusNumber(t.Mode)&&(sa.IsNumber(t.SelFrame)||!(t.SelFrame<0))){var e=this.Frame.SubFrame[t.SelFrame];e&&e.Frame.DrawSelectedBorder&&e.Frame.DrawSelectedBorder(t)}}},this.KLineIncreaseCustomHorizontal=function(){if(this.Frame&&this.Frame.SubFrame){var t=this.Frame.SubFrame[0].Frame;if(t){var e=Jr(this.Symbol),a=!1;t.YSplitOperator&&1==t.YSplitOperator.CoordinateType&&(a=!0);for(var i=!1,r=0;r<t.CustomHorizontalInfo.length;++r){var n=t.CustomHorizontalInfo[r];if(4==n.Type&&(i=!0),a&&3==n.Type||2==n.Type){var o=this.ChartPaint[0];if(!o)continue;var s=o.Data;if(!s||!sa.IsNonEmptyArray(s.Data))continue;if(!sa.IsNumber(o.DrawKRange.Start)||!sa.IsNumber(o.DrawKRange.End))continue;var h=s.Data[o.DrawKRange.Start],l=s.Data[o.DrawKRange.End],u=(l.Close-h.Close)/h.Close*100;n.Value=l.Close,2==n.Type?(n.Message[1]=l.Close.toFixed(e),l.Close>l.Open?n.LineColor=qi.FrameLatestPrice.UpBarColor:l.Close<l.Open?n.LineColor=qi.FrameLatestPrice.DownBarColor:n.LineColor=qi.FrameLatestPrice.UnchagneBarColor):n.Message[1]=u.toFixed(2)+"%",this.Name&&(n.Title=this.Name)}}if(i){var C=t.CustomHorizontalInfo.filter((function(t,e,a){return 4!=t.Type}));t.CustomHorizontalInfo=C}for(r=0;r<this.OverlayChartPaint.length;++r){o=this.OverlayChartPaint[r];if(o&&4==o.YInfoType){s=o.Data;if(s&&sa.IsNonEmptyArray(s.Data)&&sa.IsNumber(o.DrawKRange.Start)&&sa.IsNumber(o.DrawKRange.End)){h=null;for(var D=o.DrawKRange.Start;D<=o.DrawKRange.End;++D){var f=s.Data[D];if(sa.IsNumber(f.Close)){h=f;break}}if(h){l=s.Data[o.DrawKRange.End],u=(l.Close-h.Close)/h.Close*100,n=new Y;n.Value=l.Close/o.ShowRange.FirstOverlayOpen*o.ShowRange.FirstOpen,n.Message[1]=u.toFixed(2)+"%",n.LineType=-1,n.Type=o.YInfoType,n.LineColor=o.Color,n.TextColor=qi.FrameLatestPrice.OverlayTextColor,o.Title&&(n.Title=o.Title),t.CustomHorizontalInfo.push(n)}}}}}}},this.OffscreenToShowCanvas=function(){this.ShowCanvas&&(this.ShowCanvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.ShowCanvas.drawImage(this.OffscreenCanvasElement,0,0))},this.GetDrawStatus=function(){var t={Point:{X:this.LastPoint.X,Y:this.LastPoint.Y},IsOnTouch:this.IsOnTouch,CorssCursorTouchEnd:this.CorssCursorTouchEnd,IsTitleShowLatestData:this.IsTitleShowLatestData,IsMinuteChart:"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName};return t.FrameID=this.Frame.PtInFrame(this.LastPoint.X,this.LastPoint.Y),t},this.InvokeBeforeDrawSplashScreenCallback=function(){var t=this.GetEventCallback(m.ON_BEFORE_DRAW_SPLASH_SCREEN);if(!t||!t.Callback)return null;var e={PreventDefault:!1};return t.Callback(t,e,this),e},this.DrawSplashScreen=function(t){var e=this.InvokeBeforeDrawSplashScreenCallback();if((!e||!0!==e.PreventDefault)&&(null!=this.Frame.ScreenImageData||this.CacheCanvas)){this.Frame.ScreenImageData?this.Canvas.putImageData(this.Frame.ScreenImageData,0,0):this.CacheCanvas&&(this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Canvas.drawImage(this.CacheElement,0,0));var a=qi.SplashScreen.BGColor;if(this.Canvas.fillStyle=a,this.Canvas.fillRect(0,0,this.UIElement.width,this.UIElement.height),this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash){var i=qi.SplashScreen.Title;t&&t.Title&&(i=t.Title),this.ChartSplashPaint.SetTitle(i),this.ChartSplashPaint.Draw()}}},this.GetCorssCursorPosition=function(){var t={LastPoint:{X:this.LastPoint.X,Y:this.LastPoint.Y},CursorIndex:this.CursorIndex};return t},this.IsLockCorssCursor=function(){return!(!this.GlobalOption||!this.GlobalOption.LockCorssCursor)&&this.GlobalOption.LockCorssCursor.X.Enable},this.DrawDynamicInfo=function(t){this.LastMouseStatus.MouseOnToolbar=null,this.ChartCorssCursor&&(this.ChartCorssCursor.Status=0);var e=this.GetEventCallback(m.ON_BEFORE_DRAW_DYNAMIC_INFO);if(e&&e.Callback){e.Callback(e,{},this)}if(null!=this.Frame.ScreenImageData||this.CacheCanvas){var a=!1;if(this.ChartCorssCursor&&(null==this.ChartCorssCursor.PointX&&null==this.ChartCorssCursor.PointY||(a=!0)),a=!0,0==a)for(var i=0;i<this.ExtendChartPaint.length;++i){var r=this.ExtendChartPaint[i];if(!r.IsCallbackDraw&&(r.IsDynamic&&r.IsEraseBG)){a=!0;break}}a&&(this.Frame.ScreenImageData?this.Canvas.putImageData(this.Frame.ScreenImageData,0,0):this.CacheCanvas&&(this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Canvas.drawImage(this.CacheElement,0,0))),this.Frame.DrawToolbar&&this.Frame.DrawToolbar(this.LastMouseStatus),this.DrawSelectedStatus(),this.DrawSelectedBorder(),this.DrawSelectedXBorder&&this.DrawSelectedXBorder();var n=null;this.LastMouseStatus&&this.LastMouseStatus.MoveOnPoint&&(n=this.LastMouseStatus.MoveOnPoint),this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_20,{MoveonPoint:n,LastMouseStatus:this.LastMouseStatus});for(i=0;i<this.ChartDrawPicture.length;++i){r=this.ChartDrawPicture[i];r.IsDrawFirst&&r.Draw()}this.DrawDrawPictureXYCoordinate();var o=!1,s=this.GetCorssCursorPosition();if(this.ChartCorssCursor){this.ChartCorssCursor.LastPoint=s.LastPoint,this.ChartCorssCursor.CursorIndex=s.CursorIndex,this.EnableNewIndex&&(this.ChartCorssCursor.CorssCursorIndex=s.CorssCursorIndex,this.ChartCorssCursor.EnableNewIndex=this.EnableNewIndex);var h=!1;this.CorssCursorCanvas&&(this.ChartCorssCursor.Canvas=this.CorssCursorCanvas,this.ChartCorssCursor.Canvas.clearRect(0,0,this.CorssCursorElement.width,this.CorssCursorElement.height),h=!0),t&&0==t.Corss||(this.DragMode==I.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&this.ChartCorssCursor.Draw():this.EnableClickModel?!0===this.ClickModel.IsShowCorssCursor&&this.ChartCorssCursor.Draw():!1===this.IsOnTouch&&this.CurrentChartDrawPicture&&!0===this.CurrentChartDrawPicture.IsShowCorssCursor?this.ChartCorssCursor.Draw():!1===this.IsOnTouch&&!0===this.CorssCursorTouchEnd||this.CurrentChartDrawPicture?!0===this.IsOnTouch&&this.CurrentChartDrawPicture&&this.EnableShowCorssCursor&&1==this.EnableShowCorssCursor.DrawPicture&&this.ChartCorssCursor.Draw():this.ChartCorssCursor.Draw()),h&&(this.ChartCorssCursor.Canvas=this.Canvas),o=!0}var l=null;t&&t.Point&&("OnMouseMove"==t.ParentFunction||"MoveCorssCursorIndex"==t.ParentFunction)&&(l=this.Frame.PtInFrame(t.Point.X,t.Point.Y));var u=this.GetDrawStatus();u.DrawName="DrawDynamicInfo";for(i=0;i<this.TitlePaint.length;++i){r=this.TitlePaint[i];if(r.IsDynamic){r.CursorIndex=s.CursorIndex,r.LastPoint=this.LastPoint,r.OnDrawEvent&&(r.OnDrawEvent.FunctionName="DrawDynamicInfo",r.OnDrawEvent.PointPosition=l,this.IsLockCorssCursor()&&r.OnDrawEvent.PointPosition<0&&(r.OnDrawEvent.PointPosition=0)),r.DrawStatus=u;var C=null;t&&sa.IsNumber(t.ClientPos)&&t.Point&&(C={ClientPos:t.ClientPos,Point:{X:t.Point.X,Y:t.Point.Y}},this.IsLockCorssCursor()&&C.ClientPos<=0&&(C.ClientPos=1)),r.PointInfo=C,r.Draw(n,this.LastMouseStatus)}}var D={MoveonPoint:n,LastMouseStatus:this.LastMouseStatus};t&&(D.Tooltip=t.Tooltip,D.Point=t.Point),this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_25,D),this.EnableAnimation&&this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_30);for(i=0;i<this.ChartDrawPicture.length;++i){r=this.ChartDrawPicture[i];r.IsDrawFirst||(r.IsDrawMain&&r.IsDrawMain()||this.SelectChartDrawPicture&&r.Guid==this.SelectChartDrawPicture.Guid||r.Draw(n,this.LastMouseStatus))}if(this.SelectChartDrawPicture&&this.SelectChartDrawPicture.Draw(n,this.LastMouseStatus),this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw(),this.DrawExtendChartPaint(He.DRAW_PRIORITY_ID.LEVEL_50),this.LastMouseStatus.MouseOnToolbar){var f=this.LastMouseStatus.MouseOnToolbar.Frame;f&&f.DrawToolbarTooltip&&f.DrawToolbarTooltip(this.LastMouseStatus.MouseOnToolbar)}this.OffscreenToShowCanvas(),o&&this.DrawTooltipDialog(),++this.TouchDrawCount}},this.DrawAnimation=function(){if(this.EnableAnimation){if(this.Frame.ScreenImageData&&!this.IsOnTouch){for(var t=0;t<this.ExtendChartPaint.length;++t){var e=this.ExtendChartPaint[t];!0===e.IsAnimation&&(e.IsMoveStep=!0)}this.DrawDynamicInfo()}var a=this;window.requestAnimationFrame((function(){a.DrawAnimation()}))}},this.StartAnimation=function(t){for(var e=!1,a=null,i=0;i<this.ExtendChartPaint.length;++i){var r=this.ExtendChartPaint[i];if("BarragePaint"===r.ClassName){e=!0,a=r.BarrageList;break}}if(!e){var n=new na;n.Canvas=this.Canvas,n.ChartBorder=this.Frame.ChartBorder,n.ChartFrame=this.Frame,n.HQChart=this,n.SetOption(t),this.ExtendChartPaint.push(n),a=n.BarrageList}this.EnableAnimation=!0;var o=this;return window.requestAnimationFrame((function(){o.DrawAnimation()})),a},this.StopAnimation=function(){this.EnableAnimation=!1,this.DrawDynamicInfo()},this.GetChartTooltipData=function(t,e,a){var i=new pt;if(this.ChartInfoPaint&&this.ChartInfoPaint.GetTooltipData(t,e,i))return i;if(this.PtInChartPaintTooltip(t,e,i))return i;if(sa.IsNonEmptyArray(this.Frame.SubFrame))for(var r=0;r<this.Frame.SubFrame.length;++r)for(var n=this.Frame.SubFrame[r],o=0;o<n.OverlayIndex.length;++o)for(var s=n.OverlayIndex[o],h=0;h<s.ChartPaint.length;++h){var l=s.ChartPaint[h];if(l.GetTooltipData(t,e,i))return i}return this.PtInOverlayChartPaintTooltip(t,e,i)||this.PtInExtendChartPaintTooltip(t,e,i)?i:null},this.PtInExtendChartButtons=function(t,e){for(var a=0;a<this.ExtendChartPaint.length;++a){var i=this.ExtendChartPaint[a];if(i.PtInButtons){var r=i.PtInButtons(t,e);if(r)return r.Chart=i,r}}return null},this.ClickExtendChartButton=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_EXTENDCHART_BUTTON);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}},this.PtInDrawPictureButtons=function(t,e){for(var a=0;a<this.ChartDrawPicture.length;++a){var i=this.ChartDrawPicture[a];if(i.PtInButtons){var r=i.PtInButtons(t,e);if(r)return r.Chart=i,r}}return null},this.ClickDrawPictureButton=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_DRAWPICTURE_BUTTON);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}t.ID==S.DRAW_PICTURE_DELETE?(u.Chart.Log(t,"ClickDrawPictureButton"),this.ClearChartDrawPicture(t.Chart)):t.ID},this.PtInTitleButtons=function(t,e){for(var a=0;a<this.TitlePaint.length;++a){var i=this.TitlePaint[a];if(i.PtInButtons){var r=i.PtInButtons(t,e);if(r)return r.Chart=i,r}}return null},this.OnMouseMove=function(t,e,a,i){var r=this;this.StopDrawDynamicInfo(),this.LastPoint.X=t,this.LastPoint.Y=e;var n=null,o=null,s=this.Frame.PtInFrame(t,e);if(sa.IsNumber(s)&&s>=0&&(this.CursorIndex=this.Frame.GetXData(t)),this.EnableBorderDrag&&this.Frame&&!this.CurrentChartDrawPicture){var h=this.Frame.PtInFrameBorder(t,e);h&&h.Index>=0&&(n={Cursor:"n-resize",Name:"DragBorder"},u.Chart.Log("[JSChartContainer::OnMouseMove] drag border ",h))}if(this.EnableYDrag&&this.Frame&&!this.CurrentChartDrawPicture){var l=this.TryYDrag(t,e);l&&(n={Cursor:0==l.Position?"n-resize":"row-resize",Name:"DragY"},u.Chart.Log("[JSChartContainer::OnMouseMove] drag y ",l))}if(this.CurrentChartDrawPicture||(o=this.PtInButton(t,e),o&&(n={Cursor:"pointer",Name:o.Name},u.Chart.Log("[JSChartContainer::OnMouseMove] frame button ",o))),this.ChartCorssCursor){var C=this.ChartCorssCursor.PtInButton(t,e);C&&(n={Cursor:"pointer",Name:"CorssCursorButton"},u.Chart.Log("[JSChartContainer::OnMouseMove] cross cursor button ",C))}if("KLineChartContainer"==this.ClassName&&this.EnableXDrag.Bottom&&this.Frame.PtInFrameBottom(t,e)&&u.Chart.Log("[JSChartContainer::OnMouseMove] frame bottom "),this.Frame.PtInHorizontalLabel&&this.Frame.PtInHorizontalLabel(t,e)&&(n={Cursor:"pointer",Name:"HorizontalLabel"},u.Chart.Log("[JSChartContainer::OnMouseMove] frame Horizontal Label ")),this.SelectedChart.EnableMoveOn&&this.PtInChart&&!this.CurrentChartDrawPicture){var D=this.PtInChart(t,e);D&&D.Identify?(n={Cursor:"pointer",Name:"PtInChart"},this.SelectedChart.MoveOn.Identify=D.Identify,this.SelectedChart.MoveOn.Identify=null,u.Chart.Log("[JSChartContainer::OnMouseMove] Point in chart ",D)):this.SelectedChart.MoveOn.Identify=null}else this.SelectedChart.MoveOn.Identify=null;var f=this.GetRectSelectPaint();if(f&&f.GetPointCount()>0){var c=f.PtInPaint(t,e);c&&(n=4==c.Type?{Cursor:"pointer",Name:"DragRectSelect"}:{Cursor:"ew-resize",Name:"DragRectSelect"},u.Chart.Log("[JSChartContainer::OnMouseMove] drag rect select ",c))}var m={MouseStatus:null,X:t,Y:e,FrameID:s,e:a};this.TryMouseMove_CustomChartDrag(m)&&m.MouseStatus&&(1==m.MouseStatus.Level?n=m.MouseStatus:n||(n=m.MouseStatus));var d=!1;if(this.CurrentChartDrawPicture){var I=this.Frame.PtInChartFrame(t,e);if(20!=this.CurrentChartDrawPicture.Status){var S=!1;sa.IsNumber(this.CurrentChartDrawPicture.LimitFrameID)?I>=0&&I==this.CurrentChartDrawPicture.LimitFrameID&&(S=!0):I>=0&&(S=!0),n={Cursor:S?"crosshair":"not-allowed",Name:"CurrentChartDrawPicture"}}this.CurrentChartDrawPicture.SetLastPoint&&this.CurrentChartDrawPicture.SetLastPoint({X:t,Y:e}),d=!0}else{var T={};T.X=t,T.Y=e,this.GetChartDrawPictureByPoint(T)&&T.ChartDrawPicture?(this.EnableEraseChartDrawPicture?this.SetCursor({Cursor:"grabbing"}):1==T.ChartDrawPicture.EnableMove&&(100===T.PointIndex?T.Cursor?this.SetCursor(T):this.SetCursor({Cursor:"move"}):T.Cursor?this.SetCursor(T):this.SetCursor({Cursor:"pointer"}),d=!0),this.MoveOnChartDrawPicture=T.ChartDrawPicture):this.MouseDrag||this.SetCursor({Cursor:"default"})}var v=this.PtInClient(t,e),p={ParentFunction:"OnMouseMove",Point:{X:t,Y:e},IsPhone:!0===i,ClientPos:v};if((a&&("mouseout"==a.type||"mouseleave"==a.type)||o)&&(p.Corss=!1),this.SetCorssCursorIndex&&this.SetCorssCursorIndex(p),this.DrawDynamicInfoOption.Enable?this.DrawDynamicInfoOption.Timer=setTimeout((function(){r.DrawDynamicInfo(p)}),this.DrawDynamicInfoOption.DelayTime):this.DrawDynamicInfo(p),this.IsShowTooltip&&0==d){var g=this.GetChartTooltipData(t,e);if(g&&g.Data){if(!0===i)var x=a.touches[0],F=x.clientX-this.UIElement.getBoundingClientRect().left,E=x.clientY-this.UIElement.getBoundingClientRect().top;else F=a.clientX-this.UIElement.getBoundingClientRect().left,E=a.clientY-this.UIElement.getBoundingClientRect().top;n={Cursor:"default",Name:"Tooltip"},this.ShowTooltip(F,E,g)}else this.HideTooltip()}this.SetCursor(n)},this.SetCursor=function(t){t&&t.Cursor&&("default"==t.Cursor?this.UIElement.style.cursor=this.DefaultCursor:this.UIElement.style.cursor=t.Cursor)},this.OnHotKeyDown=function(t,e){var a=this.FindHotKey(t,e);return!!a&&(this.ExecuteMenuCommand(a.CMD,a.Args),!0)},this.FindHotKey=function(t,e){if(!sa.IsNonEmptyArray(this.AryHotKey))return null;for(var a=0;a<this.AryHotKey.length;++a){var i=this.AryHotKey[a];if(t==i.KeyID&&(1==i.SecondKeyID&&e.shiftKey||2==i.SecondKeyID&&e.ctrlKey||3==i.SecondKeyID&&e.altKey))return i}return null},this.IsHotKey=function(t,e){var a=this.FindHotKey(t,e);return!!a},this.OnKeyDown=function(t){var e=this;if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=t.keyCode?t.keyCode:t.which,i=this.GetEventCallback(m.ON_KEYDOWN);if(i&&i.Callback){var r={e:t,KeyID:a,PreventDefault:!1};if(i.Callback(i,r,this),r.PreventDefault)return}var n=!1;if(27==a&&this.PopMinuteChart&&this.PopMinuteChart.IsShow())this.PopMinuteChart.Close(),n=!0;else if(this.ChartCorssCursor&&this.ChartCorssCursor.OnKeyDown){r={e:t,KeyID:a,Draw:!1,PreventDefault:!1};this.ChartCorssCursor.OnKeyDown(r),n=r.Draw}if(this.OnHotKeyDown(a,t))t.preventDefault?t.preventDefault():t.returnValue=!1;else{switch(a){case 37:if((t.ctrlKey||t.shiftKey)&&this.OnCustomKeyDown&&this.OnCustomKeyDown(a,t))break;if(this.FixCursorIndexValid&&this.FixCursorIndexValid()){this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown();break}if(this.CursorIndex<=.99999){if(!this.DataMoveLeft()){this.DragDownloadData&&this.DragDownloadData();break}this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown")}else--this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown();break;case 39:if((t.ctrlKey||t.shiftKey)&&this.OnCustomKeyDown&&this.OnCustomKeyDown(a,t))break;if(this.FixCursorIndexValid&&this.FixCursorIndexValid()){this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown();break}var o=0;if(o=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,this.CursorIndex+1>=o){if(!this.DataMoveRight())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown")}else{var s=null;if(s=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,!s)break;if(this.CursorIndex+s.DataOffset+1>=s.Data.length)break;++this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}break;case 38:if((t.ctrlKey||t.shiftKey)&&this.OnCustomKeyDown&&this.OnCustomKeyDown(a,t))break;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Keyboard)break;var h={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};if(t.ctrlKey&&(h.ZoomType=1),h.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(h))break;this.CursorIndex=h.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown");break;case 40:if((t.ctrlKey||t.shiftKey)&&this.OnCustomKeyDown&&this.OnCustomKeyDown(a,t))break;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Keyboard)break;h={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};if(t.ctrlKey&&(h.ZoomType=1),h.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(h,{ZoomDownloadDataCallback:function(t){e.ZoomDownloadData(t)}}))break;this.CursorIndex=h.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.ChartSplashPaint&&1==this.ChartSplashPaint.IsEnableSplash||this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown");break;case 46:if(this.SelectChartDrawPicture){var l=this.SelectChartDrawPicture;u.Chart.Log("[JSChartContainer::OnKeyDown] delete draw picture."),this.SelectChartDrawPicture=null,this.ChartPictureMenu&&this.ChartPictureMenu.Hide(),this.ClearChartDrawPicture(l)}else if(this.SelectedChart&&this.SelectedChart.Selected.Identify){var C=this.GetSelectedChartInfo(this.SelectedChart.Selected);C&&(C.Type==ta.OVERLAY_INDEX?this.DeleteOverlayWindowsIndex(C.IndexID):C.Type==ta.OVERLAY_KLINE&&this.DeleteOverlaySymbol(C.Symbol))}break;case 32:this.OnMarkRectSelect(t);break;case 27:if(this.CurrentChartDrawPicture){l=this.CurrentChartDrawPicture;20!=l.Status&&(this.CurrentChartDrawPicture=null)}break;case 13:this.OnCustomKeyDown&&this.OnCustomKeyDown(a,t);break;default:return}n&&this.DrawDynamicInfo(),t.preventDefault?t.preventDefault():t.returnValue=!1}}},this.OnDoubleClick=function(t,e,a){},this.ZoomIndexWindow=function(t,e){return!(t<0||t>=this.Frame.SubFrame.length)&&this.Frame.ZoomIndexWindow(t,e)},this.ShowIndexTitleOnly=function(t,e){return!(t<0||t>=this.Frame.SubFrame.length)&&this.Frame.ShowIndexTitleOnly(t,e)},this.RemoveMinSizeWindows=function(){if(this.Frame.ZoomWindowsInfo){for(var t=[],e=[],a=0;a<this.Frame.SubFrame.length;++a){var i=this.Frame.SubFrame[a];i.Frame.ClearToolbar(),i.Frame.IsMinSize?t.push(a):e.push(a)}if(this.Frame.ZoomWindowsInfo=null,!(t.length<=0)){for(a=0;a<t.length;++a)this.DeleteIndexPaint(t[a]);var r=[],n=[],o=[this.TitlePaint[0]];for(a=0;a<e.length;++a){var s=e[a];r[a]=this.Frame.SubFrame[s],n[a]=this.WindowIndex[s],o[a+1]=this.TitlePaint[s+1]}this.Frame.SubFrame=r,this.WindowIndex=n,this.TitlePaint=o;for(a=0;a<this.Frame.SubFrame.length;++a){i=this.Frame.SubFrame[a].Frame;a==this.Frame.SubFrame.length-1?i.XSplitOperator.ShowText=!0:i.XSplitOperator.ShowText=!1,i.Identify=a}if(sa.IsNonEmptyArray(this.ChartDrawPicture)){var h=[];for(a=0;a<this.ChartDrawPicture.length;++a){i=this.ChartDrawPicture[a];for(var l=0;l<this.Frame.SubFrame.length;++l)if(i.Frame==this.Frame.SubFrame[l].Frame){h.push(i);break}}this.ChartDrawPicture=h}}}},this.PtInClient=function(t,e){if(this.Canvas.beginPath(),!0===this.Frame.IsHScreen){var a=this.Frame.ChartBorder.GetHScreenBorder();if(a.DayBorder){for(var i=a.Right-a.Left,r=0;r<a.DayBorder.length;++r){var n=a.DayBorder[r];if(this.Canvas.beginPath(),this.Canvas.rect(a.Left,n.TopEx,i,n.BottomEx-n.TopEx),this.Canvas.isPointInPath(t,e))return 1;if(this.Canvas.beginPath(),this.Canvas.rect(a.Left,n.Top,i,n.TopEx-n.Top),this.Canvas.isPointInPath(t,e))return 200+parseInt(r);if(this.Canvas.beginPath(),this.Canvas.rect(a.Left,n.BottomEx,i,n.Bottom-n.BottomEx),this.Canvas.isPointInPath(t,e))return 300+parseInt(r)}return-1}this.Canvas.rect(a.Left,a.TopEx,a.Right-a.Left,a.BottomEx-a.TopEx)}else{a=this.Frame.ChartBorder.GetBorder();if(a.DayBorder){for(r=0;r<a.DayBorder.length;++r){n=a.DayBorder[r];if(this.Canvas.beginPath(),this.Canvas.rect(n.Left,a.TopEx,n.LeftEx-n.Left,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 200+parseInt(r);if(this.Canvas.beginPath(),this.Canvas.rect(n.LeftEx,a.TopEx,n.RightEx-n.LeftEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 1;if(this.Canvas.beginPath(),this.Canvas.rect(n.RightEx,a.TopEx,n.Right-n.RightEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 300+parseInt(r)}return-1}this.Canvas.rect(a.LeftEx,a.Top,a.RightEx-a.LeftEx,a.Bottom-a.Top)}return this.Canvas.isPointInPath(t,e)?1:this.Frame.ChartBorder.LeftExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.Top,a.Right-a.Left,a.TopEx-a.Top):this.Canvas.rect(a.Left,a.Top,a.LeftEx-a.Left,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?2:this.Frame.ChartBorder.RightExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.BottomEx,a.Right-a.Left,a.Bottom-a.BottomEx):this.Canvas.rect(a.RightEx,a.Top,a.Right-a.RightEx,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?3:-1},this.OnMoveFromeBorder=function(t,e){return!!this.Frame&&(!!this.Frame.OnMoveFromeBorder(t,e)&&(this.Frame.SetFrameBorderSizeChange(),this.Frame.ReDrawToolbar(),this.Draw(),!0))},this.OnZoomUpDownFrameY=function(t,e){this.Frame&&this.Frame.OnZoomUpDownFrameY(t,e)&&(this.Frame.SetSizeChage(!0),this.Draw())},this.OnUpDonwFrameY=function(t,e){return!!this.Frame&&(!!this.Frame.OnUpDonwFrameY(t,e)&&(this.Frame.SetSizeChage(!0),!0))},this.CancelZoomUpDownFrameY=function(t){this.Frame&&this.Frame.CancelZoomUpDownFrameY(t)&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())},this.IsKLineContainer=function(){return"KLineChartContainer"==this.ClassName||"KLineChartHScreenContainer"==this.ClassName||"KLineTrainChartContainer"==this.ClassName||"CustomKLineChartContainer"==this.ClassName},this.IsMinuteContainer=function(){return"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName},this.UpdatePointByCursorIndex=function(t){var e={X:null,Y:null};e.X=this.Frame.GetXFromIndex(this.CursorIndex);var a=Math.abs(this.CursorIndex-.5);this.IsKLineContainer()&&(a=this.CursorIndex);var i=this.Frame.Data;if(i.DataOffset+a<i.Data.length){var r=i.Data[i.DataOffset+a].Close;e.Y=this.Frame.GetYFromData(r)}if(1==t&&this.ChartCorssCursor)if(1==this.ChartCorssCursor.Status);else{this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);a=Math.abs(this.CursorIndex-.5);a=parseInt(a.toFixed(0)),this.IsKLineContainer()&&(a=this.CursorIndex),this.LastPoint.Y=null}else 2==t&&this.ChartCorssCursor?(this.LastPoint.Y=null,this.LastPoint.X=null):(this.LastPoint.X=e.X,this.LastPoint.Y=e.Y)},this.ShowTooltipByKeyDown=function(){if(this.KLineTooltipConfig.Enable&&this.KLineTooltipConfig.EnableKeyDown){var t=this.GetKData();if(t&&sa.IsNonEmptyArray(t.Data)){var e=Math.abs(this.CursorIndex-.5);e=parseInt(e.toFixed(0)),"KLineChartContainer"!=this.ClassName&&"KLineTrainChartContainer"!=this.ClassName||(e=this.CursorIndex);var a=t.DataOffset+e;if(!(a<0||a>=t.Data.length)){var i=t.Data[a];if(i){this.Frame.Data;var r=new pt;r.Data=i,r.ChartPaint=this.ChartPaint[0];var n=F();0===n&&(n=1),this.ShowTooltip(this.LastPoint.X/n,this.LastPoint.Y/n,r)}}}}else this.HideFloatTooltip()},this.DrawTooltipDialog=function(){},this.DrawFloatTooltip=function(t,e){this.FloatTooltip&&this.UpdateFloatTooltip(t,e)},this.UpdateFloatTooltip=function(t,e){if(this.FloatTooltip){var a={Tooltip:e,Point:t,Symbol:this.Symbol,Name:this.Name,DataType:1};this.FloatTooltip.Update(a)}},this.UpdateHQFloatTooltip=function(t){},this.ShowTooltip=function(t,e,a){var i=this;if(this.IsShowTooltip){var r=F(),n=15/r;this.TooltipCache.Type=a.Type,this.TooltipCache.Data=null,this.TooltipCache.X=t,this.TooltipCache.Y=e;var o=!0;if(0===a.Type){if(!this.KLineTooltipConfig.Enable)return;if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);w();var s=t,h=e,l=Aa.Create("HistoryDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.LanguageID=this.LanguageID,l.GetEventCallback=function(t){return i.GetEventCallback(t)},!l.Operator())return;var u=25*l.LineCount;l.Height>0&&(u=l.Height);var C=l.Width;this.Tooltip.style.width=C+"px",this.Tooltip.style.height=u+"px",this.Tooltip.style.position="absolute",s+C>this.UIElement.getBoundingClientRect().width?this.Tooltip.style.left=s-C+"px":this.Tooltip.style.left=s+"px",h+n+u>this.UIElement.getBoundingClientRect().height-5?this.Tooltip.style.top=h-u+"px":this.Tooltip.style.top=h+n+"px",this.Tooltip.className="jschart-tooltip",this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block",this.TooltipCache.IsShow=!0,this.TooltipCache.Data={Date:a.Data.Date,Time:a.Data.Time},this.TooltipCache.InnerHTML=l.Text}else if(1===a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);w(),s=t,h=e,l=Aa.Create("KLineInfoDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-klineinfo-tooltip",this.Tooltip.style.position="absolute",s+C>this.UIElement.getBoundingClientRect().width?this.Tooltip.style.left=s-C+"px":this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(2==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);s=t,h=e,l=Aa.Create("KLineTradeDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-klinetrade-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(3==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);s=t,h=e,l=Aa.Create("MinuteInfoDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-minuteinfo-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(4==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);s=t,h=e,l=Aa.Create("IconDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-iconinfo-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(5==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);s=t,h=e,l=Aa.Create("ChartOXDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.Period=this.Period,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-chartox-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(6==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);s=t,h=e,l=Aa.Create("ScatterPlotDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.Period=this.Period,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-charscatterplot-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(7==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);s=t,h=e,l=Aa.Create("ChartDrawSVGDataStringFormat");if(l.Value=a,l.Symbol=this.Symbol,l.Period=this.Period,l.LanguageID=this.LanguageID,!l.Operator())return;C=l.Width;this.Tooltip.className="jchart-chartdrawsvg-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=s+"px",this.Tooltip.style.top=h+n+"px",this.Tooltip.style.width=C+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=l.Text,this.Tooltip.style.display="block"}else if(8==a.Type){if(this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1)}else if(9==a.Type&&a.Data.Item&&a.Data.Item.Tooltip&&this.FloatTooltip)return this.DrawFloatTooltip({X:t,Y:e,YMove:20/r},a),void(o=!1);o&&this.HideFloatTooltip()}},this.UpdateDOMTooltip=function(t,e){var a=this;if(this.TooltipCache.IsShow&&this.TooltipCache.Type==t&&this.TooltipCache.Data&&0===this.TooltipCache.Type){if(!e||!sa.IsNonEmptyArray(e.Data))return;var i=e.Data[e.Data.length-1];if(i.Date!=this.TooltipCache.Data.Date)return;if(sa.IsNumber(i.Time)&&i.Time!=this.TooltipCache.Data.Time)return;var r=this.ChartPaint[0],n=Aa.Create("HistoryDataStringFormat");if(n.Value={Data:i,ChartPaint:r,Type:this.TooltipCache.Type},n.Symbol=this.Symbol,n.LanguageID=this.LanguageID,n.GetEventCallback=function(t){return a.GetEventCallback(t)},!n.Operator())return;if(n.Text==this.TooltipCache.InnerHTML)return;this.Tooltip.innerHTML=n.Text,this.TooltipCache.InnerHTML=n.Text}},this.HideTooltip=function(){this.TooltipCache.IsShow=!1,this.TooltipCache.Type=null,this.TooltipCache.InnerHTML=null,this.TooltipCache.Data=null,"none"!=this.Tooltip.style.display&&(this.Tooltip.style.display="none"),this.HideFloatTooltip()},this.UpdateSelectRect=function(t,e){if(this.ChartPaint[0].Data){var a=this.GetRectSelectPaint();if(a){var i=this.ChartPaint[0].Data,r=i.Data.length;e>=r&&(e=r-1);var n=i.Data[t],o=i.Data[e];u.Chart.Log("[JSChartContainer::UpdateSelectRect]",n,o),a.SetPoint(n,{Index:0,DataIndex:t}),a.SetPoint(o,{Index:1,DataIndex:e}),this.Draw()}}},this.HideSelectRect=function(){this.ClearDragSelectRect()},this.ResetFrameXYSplit=function(){"function"==typeof this.Frame.ResetXYSplit&&this.Frame.ResetXYSplit()},this.ResetFrameXSplit=function(){"function"==typeof this.Frame.ResetXSplit&&this.Frame.ResetXSplit()},this.ResetFrameYCustomSplit=function(t){"function"==typeof this.Frame.ResetYCustomSplit&&this.Frame.ResetYCustomSplit(t)},this.UpdateFrameMaxMinV2=function(){for(var t=new Map,e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e];if(a&&a.Frame){var i=a.Frame;i.YCustomSplit=!0;for(var r=i.Identify,n={ID:r,Frame:i,ChartPaint:[],Max:null,Min:null,OverlayFrame:[],SingleOverlay:[],MainOverlayFrame:[null,null]},o=0;o<a.OverlayIndex.length;++o){var s=a.OverlayIndex[o],h=s.Frame;if(1===h.IsShowMainFrame?n.MainOverlayFrame[0]=h:2===h.IsShowMainFrame&&(n.MainOverlayFrame[1]=h),h.IsShareY){if(!h.MainFrame)continue;if(!1===h.IsCalculateYMaxMin)continue;n.OverlayFrame.push(h);for(var u=0;u<s.ChartPaint.length;++u){var C=s.ChartPaint[u];n.ChartPaint.push(C)}}else n.SingleOverlay.push(s)}t.set(r,n)}}for(e=0;e<this.ChartPaint.length;++e){C=this.ChartPaint[e],r=C.ChartFrame.Identify;if(t.has(r)){var D=t.get(r);D.ChartPaint.push(C)}}for(e=0;e<this.OverlayChartPaint.length;++e){C=this.OverlayChartPaint[e];if(C.ChartFrame){r=C.ChartFrame.Identify;if(t.has(r)){D=t.get(r);D.ChartPaint.push(C)}}}var f,c=(0,l.default)(t);try{for(c.s();!(f=c.n()).done;){var m=f.value;for(n=m[1],i=n.Frame,e=0;e<n.ChartPaint.length;++e){C=n.ChartPaint[e];if(0!=C.IsShow&&(!C.NotSupportMessage&&C.ChartFrame&&!0!==C.IsExcludeYValue)){var d=C.GetMaxMin();null!=d&&null!=d.Max&&null!=d.Min&&((null==n.Max||n.Max<d.Max)&&(n.Max=d.Max),(null==n.Min||n.Min>d.Min)&&(n.Min=d.Min))}}if(n.Frame.YSpecificMaxMin&&(n.Min=n.Frame.YSpecificMaxMin.Max,n.Max=n.Frame.YSpecificMaxMin.Min),sa.IsNumber(i.YMaxMin.Max)&&i.YMaxMin.Max==n.Max||(i.YMaxMin.Max=n.Max,i.XYSplit=!0),sa.IsNumber(i.YMaxMin.Min)&&i.YMaxMin.Min==n.Min||(i.YMaxMin.Min=n.Min,i.XYSplit=!0),i.XYSplit){var I=10,S=0;null!=n.Max&&(I=n.Max),null!=n.Min&&(S=n.Min),i.HorizontalMax=I,i.HorizontalMin=S}else i.XSplit=!0;for(o=0;o<n.OverlayFrame.length;++o)n.OverlayFrame[o].XYSplit=!0;for(e=0;e<n.MainOverlayFrame.length;++e){a=n.MainOverlayFrame[e];a&&(a.XYSplit=!0)}for(e=0;e<n.SingleOverlay.length;++e){s=n.SingleOverlay[e];s.UpdateFrameMaxMin()}}}catch(T){c.e(T)}finally{c.f()}},this.UpdateFrameMaxMin=function(){this.UpdateFrameMaxMinV2()},this.DataMoveLeft=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!!t&&(!(t.DataOffset<=0)&&(--t.DataOffset,!0))},this.DataMoveRight=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;var e=0;return e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!!e&&(!(e+t.DataOffset>=t.Data.length)&&(++t.DataOffset,!0))},this.UpdataDataoffset=function(){var t=null;if(t=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,t){for(var e in this.ChartPaint){var a=this.ChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(var e in this.OverlayChartPaint){a=this.OverlayChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(var e in this.Frame.SubFrame){var i=this.Frame.SubFrame[e];for(var r in i.OverlayIndex){var n=i.OverlayIndex[r];for(var o in n.ChartPaint){a=n.ChartPaint[o];a.Data&&(a.Data.DataOffset=t.DataOffset)}}}}},this.GetMoveOneStepWidth=function(){if(sa.IsPlusNumber(this.StepPixel))return this.StepPixel;var t=F(),e=this.Frame.SubFrame[0].Frame,a=e.DataWidth,i=e.DistanceWidth,r=this.StepPixel;r=(a+i)/t;return r<1&&(r=1),r},this.DataMove=function(t,e){var a=this.GetMoveOneStepWidth(),i=t;if(t=parseInt(t/a),t<=0)return!1;var r=null;if(r=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!r)return!1;var n=0;if(n=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!n)return!1;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&this.Frame.SubFrame[0].Frame){var o=this.Frame.SubFrame[0].Frame;(o.DataWidth<=1||o.DistanceWidth<=1)&&sa.IsPlusNumber(this.StepPixel)&&(t=parseInt(i)*this.StepPixel)}if(e){if(this.RightSpaceCount>0){if(n+r.DataOffset>=r.Data.length+this.RightSpaceCount)return!1;r.DataOffset+=t,r.DataOffset+n>=r.Data.length+this.RightSpaceCount&&(r.DataOffset=r.Data.length-(n-this.RightSpaceCount))}else{if(n+r.DataOffset>=r.Data.length)return!1;r.DataOffset+=t,r.DataOffset+n>=r.Data.length&&(r.DataOffset=r.Data.length-n)}return!0}return!(r.DataOffset<=0)&&(r.DataOffset-=t,r.DataOffset<0&&(r.DataOffset=0),!0)},this.XCoordinateZoom=function(t,e){var a=this.GetMoveOneStepWidth();return t=parseInt(t/a),!(t<=0)&&this.Frame.XCoordinateZoom(e)},this.GetSubFrameIndex=function(t,e){if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return-1;for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a].Frame,r=i.ChartBorder.GetLeft(),n=i.ChartBorder.GetTop(),o=i.ChartBorder.GetHeight(),s=i.ChartBorder.GetWidth();if(this.Canvas.beginPath(),this.Canvas.rect(r,n,s,o),this.Canvas.isPointInPath(t,e))return parseInt(a)}return 0},this.GetDataIndexByPoint=function(t){var e=this.Frame;this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame);var a=null;if(a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,a&&e){var i=parseInt(e.GetXData(t));return a.DataOffset+i}},this.GetSelectRectData=function(t){if(Math.abs(t.XStart-t.XEnd)<5)return!1;this.PtInClient(t.XStart,t.YStart),this.PtInClient(t.XEnd,t.YEnd);var e=null;if(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,!e)return!1;var a=this.GetDataIndexByPoint(t.XStart),i=this.GetDataIndexByPoint(t.XEnd);return!(Math.abs(a-i)<2)&&(t.Data=e,a>i?(t.Start=i,t.End=a):(t.Start=a,t.End=i),!0)},this.GetChartDrawPictureByPoint=function(t){for(var e=0;e<this.ChartDrawPicture.length;++e){var a=this.ChartDrawPicture[e],i=a.IsPointIn(t.X,t.Y,this.ChartDrawOption);if(!1!==i&&i>=0)return t.ChartDrawPicture=a,t.PointIndex=i,a.GetCursorType&&(t.Cursor=a.GetCursorType(i)),!0}return!1},this.SaveToImage=function(t,e){if(this.UIElement.width<=0||this.UIElement.height<=0)return null;if(this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return null;u.Chart.Log("[JSChartContainer::SaveToImage]",this.UIElement);var a="rgb(255,255,255)";e&&(a=e),this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Canvas.fillStyle=a,this.Canvas.fillRect(0,0,this.UIElement.width,this.UIElement.height);var i=F();for(var r in this.Canvas.lineWidth=i,this.Frame.Draw(),this.ChartPaint){var n=this.ChartPaint[r];n.IsDrawFirst&&n.Draw()}for(var r in this.ChartPaint){n=this.ChartPaint[r];n.IsDrawFirst||n.Draw()}for(var r in this.ChartPaintEx){n=this.ChartPaintEx[r];n.Draw()}for(var r in this.OverlayChartPaint){n=this.OverlayChartPaint[r];n.Draw()}for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsDynamic||0!=n.IsAnimation||n.Draw()}for(var r in this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawLock(),this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsDynamic&&!1===n.DrawAfterTitle&&n.Draw()}for(var r in null==this.LastPoint.X&&null==this.LastPoint.Y||this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex),this.TitlePaint){n=this.TitlePaint[r];n.IsDynamic&&(n.CursorIndex=this.CursorIndex,n.Draw())}for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsDynamic&&!0===n.DrawAfterTitle&&0==n.IsAnimation&&n.Draw()}if(this.EnableAnimation)for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];!0===n.IsAnimation&&n.Draw()}for(var r in this.ChartDrawPicture){n=this.ChartDrawPicture[r];n.Draw()}this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw();var o=this.UIElement.toDataURL(t||"image/png",1);return u.Chart.Log("[JSChartContainer::SaveToImage] data= ",o),o},this.SaveToImageUrl=function(t,e){t||(t={Format:"image/png",ColorGB:"rgb(255,255,255)"});var a=this.SaveToImage(t.Format,t.ColorGB),i={Base64:a,BucketName:"downloadcache",Path:"hqchart/hq_snapshot"},r=qi.Domain+"/API/FileUploadForBase64";io.HttpRequest({url:r,method:"POST",dataType:"json",data:i,success:function(t){u.Chart.Log("[JSChartContainer::SaveToImageUrl] recv data",t);var a={Path:t.relativeurl,Domain:"http://127.0.0.1:8087"};a.Url="".concat(a.Domain,"/").concat(a.Path),e&&e(!0,a,"")},error:function(t){u.Chart.Log("[JSChartContainer::SaveToImageUrl] error ",t),e&&e(!1,null,"upload failed")}})},this.ExportDataToCSV=function(t){for(var e="",a="",i=0,r=0;r<t.length;++r){var n=t[r];a+='"'.concat(n.Name,'"'),r==t.length-1?a+="\r\n":a+=",",sa.IsNonEmptyArray(n.Data)&&(i=Math.max(i,n.Data.length))}e+=a;r=0;for(var o=0;r<i;++r){for(a="",o=0;o<t.length;++o){n=t[o];var s=null;n.Data&&r<n.Data.length&&(s=n.Data[r]),a+='"'.concat(s,'"'),o==t.length-1?a+="\r\n":a+=","}e+=a}return e="\ufeff"+e,e},this.SetLanguage=function(t){var e=$i.GetLanguageID(t);if(sa.IsNumber(e)){if(this.LanguageID!=e){this.LanguageID=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID);for(var a=0;a<this.TitlePaint.length;++a){var i=this.TitlePaint[a];i&&(i.LanguageID=this.LanguageID)}for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];i&&(i.LanguageID=this.LanguageID)}this.Frame&&this.Frame.SetLanguage&&this.Frame.SetLanguage(this.LanguageID),this.ResetFrameXYSplit(),this.Frame.SetSizeChage(!0),this.Draw(),this.PopMinuteChart&&this.PopMinuteChart.SetLanguage(t)}}else console.warn("[JSChartContainer::SetLanguage] language=".concat(t," error"))},this.ReloadTiltePaintResource=function(t){for(var e in this.TitlePaint){var a=this.TitlePaint[e];a.ReloadResource&&a.ReloadResource(t)}},this.ReloadExtendChartPaintResource=function(t){for(var e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}this.ChartDragSelectRect&&this.ChartDragSelectRect.ReloadResource&&this.ChartDragSelectRect.ReloadResource(t)},this.ReloadChartDrawPictureResource=function(t){if(sa.IsNonEmptyArray(this.ChartDrawPicture))for(var e=0;e<this.ChartDrawPicture.length;++e){var a=this.ChartDrawPicture[e];a.ReloadResource&&a.ReloadResource(t)}},this.ReloadResource=function(t){this.ReloadBorder(t),this.ReloadTiltePaintResource(t.Resource),this.ReloadChartPaint(t.Resource),this.ReloadFrame(t.Resource),this.ReloadExtendChartPaintResource(t.Resource),this.ReloadChartCorssCursor(t,t.Resource),this.ReloadChartDrawPictureResource(t.Resource),t.Update&&this.Update?this.Update({UpdateCursorIndexType:2}):1!=t.Draw&&1!=t.Redraw||this.Draw(),this.PopMinuteChart&&this.PopMinuteChart.ReloadResource(t),this.DialogTooltip&&this.DialogTooltip.ReloadResource(t),this.FloatTooltip&&this.FloatTooltip.ReloadResource(t),this.DialogSelectRect&&this.DialogSelectRect.ReloadResource(t),this.DialogSearchIndex&&this.DialogSearchIndex.ReloadResource(t)},this.ReloadBorder=function(t){if(t){var e=F();if(t.Border){var a=t.Border;sa.IsNumber(a.Left)&&(this.Frame.ChartBorder.Left=a.Left*e),sa.IsNumber(a.Right)&&(this.Frame.ChartBorder.Right=a.Right*e),sa.IsNumber(a.Top)&&(this.Frame.ChartBorder.Top=a.Top*e),sa.IsNumber(a.Bottom)&&(this.Frame.ChartBorder.Bottom=a.Bottom*e)}for(var i in t.Windows){a=t.Windows[i];if(!(i>=this.Frame.SubFrame.length)){var r=this.Frame.SubFrame[i],n=r.Frame.ChartBorder;sa.IsNumber(a.TitleHeight)&&(n.TitleHeight=a.TitleHeight*e)}}for(var i in t.Frame){a=t.Frame[i];if(!(i>=this.Frame.SubFrame.length)){r=this.Frame.SubFrame[i],n=r.Frame.ChartBorder;a.TopSpace>=0&&(n.TopSpace=a.TopSpace*e),a.BottomSpace>=0&&(n.BottomSpace=a.BottomSpace*e)}}}},this.ReloadFrame=function(t){for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e],i=a.Frame;i&&i.ReloadResource&&i.ReloadResource(t);for(var r=0;r<a.OverlayIndex.length;++r){var n=a.OverlayIndex[r];n.Frame&&n.Frame.ReloadResource&&n.Frame.ReloadResource(t)}}},this.ReloadChartPaint=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&a.ReloadResource&&a.ReloadResource(t)}},this.ReloadChartCorssCursor=function(t,e){var a=F();if(t&&t.CorssCursor){var i=t.CorssCursor;sa.IsNumber(i.TitleHeight)&&(this.ChartCorssCursor.TextHeight=i.TitleHeight*a)}this.ChartCorssCursor.ReloadResource&&this.ChartCorssCursor.ReloadResource(e)},this.SetDepthMapData=function(t,e){for(var a=0;a<t.length;++a)for(var i=t[a],r=0;r<this.ExtendChartPaint.length;++r){var n=this.ExtendChartPaint[r];if(n.ID==i.ID){n.Data=i.Data;break}}e&&1==e.Draw&&this.Draw()},this.PointAbsoluteToRelative=function(t,e,a){var i={X:t,Y:e},r=F(),n=this.UIElement.getBoundingClientRect();return a?(i.X=t-n.left*r,i.Y=e-n.top*r):(i.X=(t-n.left)*r,i.Y=(e-n.top)*r),i},this.SetChartDrawPictureFirstPoint=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return!1;for(var r=this.PointAbsoluteToRelative(t,e,a),n=r.X,o=r.Y,s=0;s<this.Frame.SubFrame.length;++s){var h=this.Frame.SubFrame[s].Frame,l=h.ChartBorder.GetLeft(),u=h.ChartBorder.GetTopEx(),C=h.ChartBorder.GetBottomEx(),D=C-u,f=h.ChartBorder.GetWidth();if(this.Canvas.beginPath(),this.Canvas.rect(l,u,f,D),this.Canvas.isPointInPath(n,o)){if(sa.IsNumber(i.LimitFrameID)&&s!=i.LimitFrameID)return!1;i.Frame=h;break}}return!!i.Frame&&(i.Point[0]=new V,i.Point[0].X=n,i.Point[0].Y=o,i.Status=1,i.PointMagnetKLine(),!0)},this.SetChartDrawPictureSecondPoint=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;var r=this.PointAbsoluteToRelative(t,e,a);return i.Point[1]=new V,i.Point[1].X=r.X,i.Point[1].Y=r.Y,i.Status=2,!0},this.SetChartDrawPictureThirdPoint=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;var r=this.PointAbsoluteToRelative(t,e,a);return i.Point[2]=new V,i.Point[2].X=r.X,i.Point[2].Y=r.Y,i.Status=3,!0},this.MoveChartDrawPicture=function(t,e,a,i){var r=this.CurrentChartDrawPicture;if(!r)return!1;var n=F();a&&(n=1);var o=t*n,s=e*n;return r.Move(o,s,i),!0},this.FinishChartDrawPicturePoint=function(){var t=this.CurrentChartDrawPicture;if(!t)return!1;if(t.PointCount!=t.Point.length)return!1;if("ChartDrawRuler"==t.ClassName)return t.FinishedCallback&&t.FinishedCallback(t),this.CurrentChartDrawPicture=null,!0;t.PointMagnetKLine(),t.Status=10,t.PointToValue(),this.ChartDrawPicture.push(t),this.CurrentChartDrawPicture=null;var e=this.GetEventCallback(m.ON_FINISH_DRAWPICTURE);if(e&&e.Callback){var a={DrawPicture:t};e.Callback(e,a,this)}return t.FinishedCallback&&t.FinishedCallback(t),t.OnFinish&&t.OnFinish(),this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(t),!0},this.OnSelectChartPicture=function(t){u.Chart.Log("[JSChartContainer::OnSelectChartPicture]",t),this.DialogModifyDraw&&this.ShowModifyDrawDialog(t)},this.FinishMoveChartDrawPicture=function(){var t=this.CurrentChartDrawPicture;if(!t)return!1;if(t.PointCount!=t.Point.length)return!1;if(t.PointMagnetKLine(),t.Status=10,t.PointToValue(),this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(t),this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture&&this.SelectChartDrawPicture.DragInfo){var e=this.SelectChartDrawPicture.DragInfo;if(e.Click&&e.Move&&(e.Click.X!=e.Move.X||e.Click.Y!=e.Move.Y)){var a=this.GetEventCallback(m.ON_FINISH_MOVE_DRAWPICTURE);if(a&&a.Callback){var i={DrawPicture:t};a.Callback(a,i,this)}t.OnMoveFinish&&t.OnMoveFinish()}}return!0},this.ClearChartDrawPicture=function(t,e){var a=!0;if(t)for(var i=0;i<this.ChartDrawPicture.length;++i){var r=this.ChartDrawPicture[i];if(r.Guid==t.Guid||r==t){this.ChartDrawStorage&&this.ChartDrawStorage.DeleteDrawData(t),this.ChartDrawPicture.splice(i,1),this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.Guid!=t.Guid&&this.SelectChartDrawPicture!=t||(this.SelectChartDrawPicture=null)),e&&0==e.Draw&&(a=!1),a&&this.Draw(),this.DialogModifyDraw&&this.DialogModifyDraw.OnClearChartDrawPicture(t);break}}else this.ChartDrawPicture=[],this.ChartDrawStorage&&this.ChartDrawStorage.Clear(),this.SelectChartDrawPicture=null,e&&0==e.Draw&&(a=!1),a&&this.Draw(),this.DialogModifyDraw&&this.DialogModifyDraw.OnClearChartDrawPicture(null)},this.GetActiveDrawPicture=function(){var t={Move:{Guid:null},Select:{Guid:null},MoveOn:{Guid:null}};return this.CurrentChartDrawPicture&&(t.Move={Guid:this.CurrentChartDrawPicture.Guid}),this.SelectChartDrawPicture&&(t.Select={Guid:this.SelectChartDrawPicture.Guid,Chart:this.SelectChartDrawPicture}),this.MoveOnChartDrawPicture&&(t.MoveOn={Guid:this.MoveOnChartDrawPicture.Guid}),t},this.SetChartDrawOption=function(t){if(sa.IsBool(t.IsLockScreen)&&(this.ChartDrawOption.IsLockScreen=t.IsLockScreen),sa.IsNumber(t.Zoom)&&t.Zoom>=0&&(this.ChartDrawOption.Zoom=t.Zoom),t.Magnet){var e=t.Magnet;this.ChartDrawOption.Magnet||(this.ChartDrawOption.Magnet={Type:0,Distance:20*F(),Enable:!1}),sa.IsBool(e.Enable)&&(this.ChartDrawOption.Magnet.Enable=e.Enable),sa.IsNumber(e.Type)&&(this.ChartDrawOption.Magnet.Type=e.Type),sa.IsNumber(e.Distance)&&(this.ChartDrawOption.Magnet.Distance=e.Distance)}},this.EnableShowCorssCursorLine=function(t){this.ChartCorssCursor&&(this.ChartCorssCursor.IsShowCorss=t)},this.GetExtendChartByClassName=function(t){for(var e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];if(a.ClassName==t)return{Index:e,Chart:a}}return null},this.GetExtendChartByClassNameV2=function(t){for(var e=[],a=0;a<this.ExtendChartPaint.length;++a){var i=this.ExtendChartPaint[a];i.ClassName==t&&e.push({Index:a,Chart:i})}return e.length<=0?null:e},this.GetExtendChartRightWidth=function(){for(var t=0,e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];a&&("StockChip"==a.ClassName&&sa.IsNumber(a.Width)&&(t+=a.Width))}return t},this.GetChartPaintByClassName=function(t){for(var e=[],a=0;a<this.ChartPaint.length;++a){var i=this.ChartPaint[a];if(i.ClassName==t){var r=null;i.ChartFrame&&(r=i.ChartFrame.Identify),e.push({IsOverlay:!1,Chart:i,FrameID:r})}}for(a=0;a<this.Frame.SubFrame.length;++a){var n=this.Frame.SubFrame[a];if(n&&sa.IsNonEmptyArray(n.OverlayIndex))for(var o=0;o<n.OverlayIndex.length;++o){i=n.OverlayIndex[o];for(var s=0;s<i.ChartPaint.length;++s){var h=i.ChartPaint[s];h.ClassName==t&&e.push({IsOverlay:!0,Chart:h,FrameID:n.Frame.Identify,SubFrameID:o})}}}return e},this.DeleteExtendChart=function(t){t.Index>=this.ExtendChartPaint.length||this.ExtendChartPaint[t.Index]==t.Chart&&("function"==typeof t.Chart.Clear&&t.Chart.Clear(),this.ExtendChartPaint.splice(t.Index,1))},this.DeleteExtendChartByID=function(t){for(var e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];if(a.ID==t)return this.ExtendChartPaint.splice(e,1),!0}return!1},this.EnableSplashScreen=function(t,e){this.ChartSplashPaint&&(this.ChartSplashPaint.EnableSplash(t),e&&!1===e.Draw||(t?this.DrawSplashScreen(e):this.Draw()))},this.SetSplashScreen=function(t){t&&(sa.IsBool(t.Enable)&&this.ChartSplashPaint.EnableSplash(t.Enable),t.Title&&this.ChartSplashPaint.SetTitle(t.Title),t.Draw&&this.Draw())},this.IsEnableSplashScreen=function(){return!!this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash},this.SetSubFrameAttribute=function(t,e,a){if(t&&t.Frame){var i=t.Frame;e&&(sa.IsBool(e.Modify)&&(i.ModifyIndex=e.Modify),sa.IsBool(e.Change)&&(i.ChangeIndex=e.Change),sa.IsBool(e.Close)&&(i.CloseIndex=e.Close),sa.IsBool(e.Overlay)&&(i.OverlayIndex=e.Overlay),sa.IsBool(e.AddIndexWindow)&&(i.AddIndexWindow=e.AddIndexWindow),sa.IsBool(e.IsDrawTitleBG)&&(i.IsDrawTitleBG=e.IsDrawTitleBG),sa.IsNumber(e.TitleHeight)?i.ChartBorder.TitleHeight=e.TitleHeight:e.TitleHeight=i.ChartBorder.TitleHeight,sa.IsBool(e.IsShowTitleArrow)&&(i.IsShowTitleArrow=e.IsShowTitleArrow),sa.IsNumber(e.TitleArrowType)&&(i.TitleArrowType=e.TitleArrowType),sa.IsBool(e.IsShowIndexName)&&(i.IsShowIndexName=e.IsShowIndexName),sa.IsNumber(e.IndexParamSpace)&&(i.IndexParamSpace=e.IndexParamSpace),sa.IsNumber(e.IndexTitleSpace)&&(i.IndexTitleSpace=e.IndexTitleSpace),sa.IsUndefined(e.HorizontalReserved)||(i.HorizontalReserved=e.HorizontalReserved),sa.IsBool(e.IsShowNameArrow)&&(i.IsShowNameArrow=e.IsShowNameArrow)),a&&(a.SplitCount&&(i.YSplitOperator.SplitCount=a.SplitCount),sa.IsNumber(a.SplitType)&&(i.YSplitOperator.SplitType=a.SplitType,i.YSplitOperator.DefaultSplitType=a.SplitType),sa.IsBool(a.IsShowXLine)&&(i.IsShowXLine=a.IsShowXLine),sa.IsBool(a.IsShowYLine)&&(i.IsShowYLine=a.IsShowYLine),sa.IsBool(a.IsShowLeftText)&&(i.IsShowYText[0]=a.IsShowLeftText,i.YSplitOperator.IsShowLeftText=a.IsShowLeftText),sa.IsBool(a.IsShowRightText)&&(i.IsShowYText[1]=a.IsShowRightText,i.YSplitOperator.IsShowRightText=a.IsShowRightText),sa.IsNumber(a.Height)&&a.Height>=0&&(t.Height=a.Height))}},this.SetSubFrameOption=function(t,e){if(e){var a=t.Frame;if(e.Window){var i=e.Window;sa.IsBool(i.Modify)&&(a.ModifyIndex=i.Modify),sa.IsBool(i.Change)&&(a.ChangeIndex=i.Change),sa.IsBool(i.Close)&&(a.CloseIndex=i.Close),sa.IsBool(i.Overlay)&&(a.OverlayIndex=i.Overlay),sa.IsBool(i.Export)&&(a.ExportData=i.Export),sa.IsBool(i.MaxMin)&&(a.MaxMinWindow=i.MaxMin),sa.IsBool(i.TitleWindow)&&(a.TitleWindow=i.TitleWindow),sa.IsBool(i.AddIndexWindow)&&(a.AddIndexWindow=i.AddIndexWindow),sa.IsBool(i.IsDrawTitleBG)&&(a.IsDrawTitleBG=i.IsDrawTitleBG),sa.IsBool(i.IsShowNameArrow)&&(a.IsShowNameArrow=i.IsShowNameArrow),i.OverlayIndexType&&(sa.IsNumber(i.OverlayIndexType.Position)&&(a.OverlayIndexType.Position=i.OverlayIndexType.Position),sa.IsNumber(i.OverlayIndexType.LineSpace)&&(a.OverlayIndexType.LineSpace=i.OverlayIndexType.LineSpace)),sa.IsNonEmptyArray(i.CustomToolbar)&&(a.CustomToolbar=i.CustomToolbar.slice())}sa.IsNumber(e.SplitCount)&&(t.Frame.YSplitOperator.SplitCount=e.SplitCount),sa.IsNumber(e.TitleHeight)&&(t.Frame.ChartBorder.TitleHeight=e.TitleHeight),sa.IsBool(e.IsShowTitleArrow)&&(t.Frame.IsShowTitleArrow=e.IsShowTitleArrow),sa.IsNumber(e.TitleArrowType)&&(t.Frame.TitleArrowType=e.TitleArrowType),sa.IsBool(e.IsShowIndexName)&&(t.Frame.IsShowIndexName=e.IsShowIndexName),sa.IsBool(e.IsShowOverlayIndexName)&&(t.Frame.IsShowOverlayIndexName=e.IsShowOverlayIndexName),sa.IsNumber(e.IndexParamSpace)&&(t.Frame.IndexParamSpace=e.IndexParamSpace),sa.IsBool(e.IsShowXLine)&&(t.Frame.IsShowXLine=e.IsShowXLine),sa.IsBool(e.IsShowYLine)&&(t.Frame.IsShowYLine=e.IsShowYLine),sa.IsBool(e.IsShowIndexTitle)&&(t.Frame.IsShowIndexTitle=e.IsShowIndexTitle),sa.IsNumber(e.Height)&&(t.Height=e.Height),sa.IsBool(e.IsShowLeftText)&&(t.Frame.IsShowYText[0]=e.IsShowLeftText,t.Frame.YSplitOperator.IsShowLeftText=e.IsShowLeftText),sa.IsBool(e.IsShowRightText)&&(t.Frame.IsShowYText[1]=e.IsShowRightText,t.Frame.YSplitOperator.IsShowRightText=e.IsShowRightText)}},this.AddNewSubFrame=function(t){var e=this,a=this.Frame.SubFrame.length,i=this.CreateSubFrameItem(a),r=F();i.Frame.ChartBorder.TitleHeight*=r,this.Frame.SubFrame[a]=i;var n=new Va;n.Frame=this.Frame.SubFrame[a].Frame,n.Canvas=this.Canvas,n.LanguageID=this.LanguageID,n.GetEventCallback=function(t){return e.GetEventCallback(t)},n.HQChart=this,this.TitlePaint[a+1]=n,this.SetSubFrameOption(i,t),this.UpdateSubFrameDataWidth(i.Frame);for(var o=0;o<this.Frame.SubFrame.length;++o){var s=this.Frame.SubFrame[o].Frame;o==this.Frame.SubFrame.length-1?s.XSplitOperator.ShowText=!0:s.XSplitOperator.ShowText=!1}return this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw(),a},this.UpdateSubFrameDataWidth=function(t){var e=this.Frame.SubFrame[0].Frame;t.XPointCount=e.XPointCount,t.ZoomIndex=e.ZoomIndex,t.DataWidth=e.DataWidth,t.DistanceWidth=e.DistanceWidth,t.LastCalculateStatus.Width=e.LastCalculateStatus.Width,t.LastCalculateStatus.XPointCount=e.LastCalculateStatus.XPointCount},this.AddIndexWindow=function(t,e){var a=new f,i=a.Get(t);if(i){this.Frame.RestoreIndexWindows();var r=this.AddNewSubFrame(e);if(f.ModifyAttribute(i,e),this.WindowIndex[r]=new pn(i.Name,i.Script,i.Args,i),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var n=this.SourceData;else n=this.ChartPaint[0].Data;this.BindIndexData(r,n)}},this.AddAPIIndexWindow=function(t,e){if(t.API){this.Frame.RestoreIndexWindows();var a=this.AddNewSubFrame(e),i=t.API;if(this.WindowIndex[a]=new xn(i.Name,i.Script,i.Args,t),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var r=this.SourceData;else r=this.ChartPaint[0].Data;this.BindIndexData(a,r)}},this.AddScriptIndexWindow=function(t,e){if(t&&t.Script&&t.Name){this.Frame.RestoreIndexWindows();var a=this.AddNewSubFrame(e),i={Name:t.Name,Script:t.Script,Args:t.Args,ID:t.Name,KLineType:t.KLineType,YSpecificMaxMin:t.YSpecificMaxMin,YSplitScale:t.YSplitScale,FloatPrecision:t.FloatPrecision,Condition:t.Condition,StringFormat:t.StringFormat,OutName:t.OutName};if(t.ID&&(i.ID=t.ID),this.WindowIndex[a]=new pn(i.Name,i.Script,i.Args,i),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var r=this.SourceData;else r=this.ChartPaint[0].Data;this.BindIndexData(a,r)}},this.GetRectSelectPaint=function(){var t=this.GetExtendChartByClassName("RectSelectPaint");return t?t.Chart:null},this.GetRectDragPaint=function(){var t=this.GetExtendChartByClassName("RectDragPaint");return t?t.Chart:null},this.SetRectSelectData=function(t,e){var a=this.GetRectSelectPaint();if(!a)return!1;if(2==a.GetPointCount()){if(!a.SpaceReselected)return!1;var i=a.PreventClose;a.PreventClose=!1,a.ClearPoint(),a.PreventClose=i}return a.SetPoint(t,{DataIndex:e})},this.MoveRectSelectPoint=function(e){var a=this.GetRectSelectPaint();if(!a)return!1;if(!this.ChartPaint[0]||!this.ChartPaint[0].Data)return!1;var i=this.ChartPaint[0].Data;if(!this.Frame.SubFrame[0])return!1;var r=this.Frame.SubFrame[0].Frame,n=F(),o=(e.X-t.getBoundingClientRect().left)*n,s=r.GetXData(o);s=parseInt(s.toFixed(0));var h=s+i.DataOffset;h>=i.Data.length&&(h=i.Data.length-1);var l=i.Data[h];if(u.Chart.Log("[KLineChartContainer::MoveRectSelectPoint] point, item",e.PointIndex,l),!a.SetPoint(l,{Index:e.PointIndex,DataIndex:h}))return!1;var C=this.GetEventCallback(m.ON_DRAG_SELECT_RECT);if(C){var D=a.GetSelectRectData(),f={X:e.X,Y:e.Y,SelectData:D,RectSelectPaint:a};C.Callback(C,f,this)}if(this.IsShowSelectRectDialog()){D=a.GetSelectRectData(),f={Chart:this,X:e.X,Y:e.Y,SelectData:D,RectSelectPaint:a};var c={data:f};this.DrawSelectRectDialog(c)}return!0},this.MoveSubRectSelect=function(t){var e=this.GetRectSelectPaint();if(!e)return!1;if(!e.MoveSubRect(t.Step,t.IsLeft))return!1;var a=this.GetEventCallback(m.ON_DRAG_SUB_SELECT_RECT);if(a){var i={Start:e.SubClient.FirstPoint,End:e.SubClient.SecondPoint},r={X:t.X,Y:t.Y,SubRectSelectData:i,RectSelectPaint:e};a.Callback(a,r,this)}return!0},this.ClearRectSelect=function(t){var e=this.GetRectSelectPaint();return!!e&&(t&&(e.PreventClose=!1),e.ClearPoint())},this.DeleteWindowsOverlayIndex=function(t){if(sa.IsNumber(t)&&!(t<0||t>=this.Frame.SubFrame.length)){var e=this.Frame.SubFrame[t];if(sa.IsNonEmptyArray(e.OverlayIndex)){for(var a=[],i=0;i<e.OverlayIndex.length;++i){var r=e.OverlayIndex[i];a.push(r.Identify);for(var n=0;n<r.ChartPaint.length;++n){var o=r.ChartPaint[n];o&&o.OnDestroy&&o.OnDestroy()}r.ChartPaint=[]}e.OverlayIndex=[];var s=this.TitlePaint[t+1];for(i=0;i<a.length;++i){var h=a[i];s.OverlayIndex.has(h)&&s.OverlayIndex.delete(h),s.OverlayDynamicTitle.has(h)&&s.OverlayDynamicTitle.delete(h)}}}},this.DeleteOverlayIndex=function(t,e){var a=null;if(sa.IsNumber(e)){if(e>=0&&e<this.Frame.SubFrame.length)for(var i=this.Frame.SubFrame[e],r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];if(n.Identify===t){for(var o=0;o<n.ChartPaint.length;++o){var s=n.ChartPaint[o];s&&s.OnDestroy&&s.OnDestroy()}i.OverlayIndex.splice(r,1),a=e;break}}}else for(var h=0;h<this.Frame.SubFrame.length;++h)for(i=this.Frame.SubFrame[h],r=0;r<i.OverlayIndex.length;++r){n=i.OverlayIndex[r];if(n.Identify===t){for(o=0;o<n.ChartPaint.length;++o){s=n.ChartPaint[o];s&&s.OnDestroy&&s.OnDestroy()}i.OverlayIndex.splice(r,1),a=h;break}}if(null==a)return console.warn("[JSChartContainer::DeleteOverlayIndex] can't find overlay index. [identify=".concat(t,"]")),!1;var l=a+1,u=this.TitlePaint[l];return u.OverlayIndex.has(t)&&u.OverlayIndex.delete(t),u.OverlayDynamicTitle.has(t)&&u.OverlayDynamicTitle.delete(t),!0},this.FindScriptIndex=function(t,e){if(sa.IsNumber(e)&&e>=0){if(e>=this.Frame.SubFrame.length)return null;var a=this.WindowIndex[e];if(a&&a.Guid==t)return{Type:0,Data:a,WindowIndex:e};a=this.Frame.SubFrame[e];for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];if(r.Identify===t)return{Type:1,Data:r,WindowIndex:e,OverlayIndex:i}}}else for(i=0;i<this.Frame.SubFrame.length;++i){a=this.WindowIndex[i];if(a&&a.Guid==t)return{Type:0,Data:a,WindowIndex:i};a=this.Frame.SubFrame[i];for(var n=0;n<a.OverlayIndex.length;++n){r=a.OverlayIndex[n];if(r.Identify===t)return{Type:1,Data:r,WindowIndex:i,OverlayIndex:n}}}return null},this.MoveIndex=function(t,e,a){var i=this;if(!t||!e||!a)return!1;if(!sa.IsNumber(t.WindowIndex)||t.WindowIndex<0||t.WindowIndex>=this.Frame.SubFrame.length)return!1;if(!sa.IsNumber(e.WindowIndex)||e.WindowIndex<0||e.WindowIndex>=this.Frame.SubFrame.length)return!1;var r=this.FindScriptIndex(t.IndexID,t.WindowIndex);if(!r)return!1;var n=null,o=null;if(0==r.Type?n=r.Data:1==r.Type&&(o=r.Data),!o&&!n)return!1;var s=0,h="MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName;if(h&&(s=2),e.WindowIndex>=s&&null==this.WindowIndex[e.WindowIndex]){n?this.WindowIndex[e.WindowIndex]=this.CreateMainScript(n):o&&(this.WindowIndex[e.WindowIndex]=this.CreateMainScript(o.Script)),0==a.Operator&&(o?this.DeleteOverlayIndex(o.Identify,t.WindowIndex):n&&this.DeleteMainIndex(n.Guid,t.WindowIndex));var l=this.GetMainData();this.BindIndexData(e.WindowIndex,l),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}else{var u,C=this.Frame.SubFrame[e.WindowIndex],D=new rt,f=this.CreateOverlayFrame();f.Canvas=this.Canvas,f.MainFrame=C.Frame,f.ChartBorder=C.Frame.ChartBorder,f.GlobalOption=this.GlobalOption,o&&(f.IsShow=o.Frame.IsShow),f.YSplitOperator=new la,f.YSplitOperator.LanguageID=this.LanguageID,f.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),f.YSplitOperator.Frame=f,f.YSplitOperator.ChartBorder=f.ChartBorder,f.YSplitOperator.SplitCount=C.Frame.YSplitOperator.SplitCount,f.YSplitOperator.GetEventCallback=function(t){return i.GetEventCallback(t)},f.YSplitOperator.HQChart=this,D.Frame=f,n?(u=this.CreateOverlayScript(n),u.OverlayIndex={IsOverlay:!0,Identify:D.Identify,WindowIndex:e.WindowIndex,Frame:D}):o&&(u=this.CreateOverlayScript(o.Script),u.OverlayIndex={IsOverlay:!0,Identify:D.Identify,WindowIndex:e.WindowIndex,Frame:D}),D.Script=u;var c=this.GetEventCallback(m.ON_CREATE_OVERLAY_FRAME);if(c&&c.Callback){var d={OverlayFrame:D,WindowIndex:e.WindowIndex,SubFrame:C};c.Callback(c,d,this)}C.OverlayIndex.push(D);var I=e.WindowIndex;if(0==a.Operator)if(o)this.DeleteOverlayIndex(o.Identify,t.WindowIndex);else if(n){this.DeleteMainIndex(n.Guid,t.WindowIndex);r=this.FindScriptIndex(D.Identify);r&&(I=r.WindowIndex)}l=this.GetMainData();this.BindOverlayIndexData(D,I,l),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.MoveIndexToNewWindow=function(t,e){var a=this;if(!t||!e)return!1;if(!sa.IsNumber(t.WindowIndex)||t.WindowIndex<0||t.WindowIndex>=this.Frame.SubFrame.length)return!1;var i=this.FindScriptIndex(t.IndexID,t.WindowIndex);if(!i)return!1;var r=null,n=null;if(0==i.Type?r=i.Data:1==i.Type&&(n=i.Data),!n&&!r)return!1;if(t.WindowIndex==this.Frame.SubFrame.length-1&&this.Frame.SubFrame[t.WindowIndex].OverlayIndex<=0)return!1;this.RemoveMinSizeWindows();var o=this.Frame.SubFrame.length,s=this.CreateSubFrameItem(o),h=F();s.Frame.ChartBorder.TitleHeight*=h,this.Frame.SubFrame[o]=s;var l=new Va;l.Frame=this.Frame.SubFrame[o].Frame,l.Canvas=this.Canvas,l.LanguageID=this.LanguageID,l.SelectedChart=this.SelectedChart,l.GetEventCallback=function(t){return a.GetEventCallback(t)},l.HQChart=this,this.TitlePaint[o+1]=l,this.SetSubFrameOption(s,e);for(var u=0;u<this.Frame.SubFrame.length;++u){var C=this.Frame.SubFrame[u].Frame;u==this.Frame.SubFrame.length-1?C.XSplitOperator.ShowText=!0:C.XSplitOperator.ShowText=!1}0==e.Operator&&(n?this.DeleteOverlayIndex(n.Identify,t.WindowIndex):r&&this.DeleteMainIndex(r.Guid,t.WindowIndex)),this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw();o=this.Frame.SubFrame.length-1;r?this.WindowIndex[o]=this.CreateMainScript(r):n&&(this.WindowIndex[o]=this.CreateMainScript(n.Script));var D=this.GetMainData();this.BindIndexData(o,D)},this.CreateOverlayScript=function(t){var e=null;switch(t.ClassName){case"ScriptIndex":e=new gn;break;case"APIScriptIndex":e=new xn(null,null,null,null,!0);break;case"OverlayScriptIndex":e=new gn;break}return t.CopyTo(e),e},this.CreateMainScript=function(t){var e=null;switch(t.ClassName){case"ScriptIndex":case"OverlayScriptIndex":e=new pn;break;case"APIScriptIndex":e=new xn;break}return t.CopyTo(e),e},this.DeleteMainIndex=function(t,e){var a=this.WindowIndex[e];if(!a)return!1;var i=this.Frame.SubFrame[e];if(!i)return!1;if(sa.IsNonEmptyArray(i.OverlayIndex)){var r=i.OverlayIndex[0];this.DeleteOverlayIndex(r.Identify,e),this.WindowIndex[e]=this.CreateMainScript(r.Script);var n=this.GetMainData();this.BindIndexData(e,n)}else this.RemoveIndexWindow(e,{DeleteMainIndex:!0})},this.GetMainData=function(){switch(this.ClassName){case"MinuteChartContainer":case"MinuteChartHScreenContainer":return this.SourceData;case"KLineChartContainer":case"KLineChartHScreenContainer":return this.ChartPaint[0].Data}},this.CreateOverlayFrame=function(){switch(this.ClassName){case"KLineChartContainer":return new tt;case"KLineChartHScreenContainer":return new at;case"MinuteChartContainer":return new Z;case"MinuteChartHScreenContainer":return new Q}},this.ExportData=function(t){if(!this.ExportMainData)return null;if(!this.ChartPaint[0])return null;var e=this.GetMainData();if(!e||!sa.IsNonEmptyArray(e.Data))return null;var a=null,i=e.Data;t.Start&&t.End&&(a=e.GetDataRange(t.Start,t.End));var r=this.ExportMainData(e,a);if(!r)return null;for(var n=1;n<this.ChartPaint.length;++n){var o=this.ChartPaint[n];if(o&&o.ExportData){var s=o.ExportData(i,a);if(s&&sa.IsNonEmptyArray(s))for(var h=0;h<s.length;++h){var l=s[h];o.IndexName?r.push({Name:"".concat(l.Name,"(").concat(o.IndexName,")"),Data:l.Data}):r.push(l)}}}for(n=0;n<this.OverlayChartPaint.length;++n){o=this.OverlayChartPaint[n];if(o.Data&&sa.IsNonEmptyArray(D.Data.Data)){s=this.ExportMainData(o.Data,{IsOverlay:!0});if(s&&sa.IsNonEmptyArray(s))for(h=0;h<s.length;++h){l=s[h];r.push({Name:"".concat(l.Name,"(").concat(o.Symbol,")"),Data:l.Data})}}}n=0,h=0;for(var u=0;n<this.Frame.SubFrame.length;++n){o=this.Frame.SubFrame[n];for(h=0;h<o.OverlayIndex.length;++h){var C=o.OverlayIndex[h];if(sa.IsNonEmptyArray(C.ChartPaint))for(u=0;u<C.ChartPaint.length;++u){var D=C.ChartPaint[u];if(D&&D.ExportData){s=D.ExportData(i,a);if(s&&sa.IsNonEmptyArray(s))for(var f=0;f<s.length;++f){l=s[f];D.IndexName?r.push({Name:"".concat(l.Name,"(").concat(D.IndexName,")"),Data:l.Data}):r.push(l)}}}}}return t&&"CSV"==t.Type?this.ExportDataToCSV(r):r},this.ClearIndexRunCount=function(){for(var t=0;t<this.WindowIndex.length;++t){var e=this.WindowIndex[t];e&&(e.RunCount=0)}for(t=0;t<this.Frame.SubFrame.length;++t){e=this.Frame.SubFrame[t];for(var a=0;a<e.OverlayIndex.length;++a){var i=e.OverlayIndex[a];i.Script&&(i.Script.RunCount=0)}}},this.GetIndexInfo=function(){for(var t=[],e=0,a=0;e<this.WindowIndex.length;++e){var i=this.WindowIndex[e];if(i){var r={Name:i.Name,WindowIndex:e,IsOverlay:!1};if(i.ID&&(r.ID=i.ID),sa.IsNonEmptyArray(i.Arguments))for(r.Args=[],a=0;a<i.Arguments.length;++a){var n=i.Arguments[a];r.Args.push({Name:n.Name,Value:n.Value})}t.push(r)}}return this.GetOverlayIndexInfo(t),t},this.GetOverlayIndexInfo=function(t){for(var e=0,a=0,i=0;e<this.Frame.SubFrame.length;++e){var r=this.Frame.SubFrame[e];if(sa.IsNonEmptyArray(r.OverlayIndex))for(a=0;a<r.OverlayIndex.length;++a){var n=r.OverlayIndex[a];if(n.Script){var o=n.Script,s={Name:o.Name,ID:o.ID,WindowIndex:e,IsOverlay:!0,Identify:n.Identify};if(sa.IsNonEmptyArray(o.Arguments))for(s.Args=[],i=0;i<o.Arguments.length;++i){var h=o.Arguments[i];s.Args.push({Name:h.Name,Value:h.Value})}t.push(s)}}}},this.PopupMenuByTab=function(t,e){if(this.JSPopMenu){var a=F(),i={Left:e.Left/a,Right:e.Right/a,Bottom:e.Bottom/a,Top:e.Top/a};i.Width=i.Right-i.Left,i.Height=i.Bottom-i.Top;var r=this.UIElement.getBoundingClientRect(),n=w(),o=r.left+n.Left,s=r.top+n.Top;i.Left+=o,i.Right+=o,i.Top+=s,i.Bottom+=s,this.JSPopMenu.CreatePopMenu(t),this.JSPopMenu.PopupMenuByTab(i)}},this.PopupMenuByDrapdown=function(t,e){if(this.JSPopMenu){var a=F(),i={Left:e.Left/a,Right:e.Right/a,Bottom:e.Bottom/a,Top:e.Top/a};i.Width=i.Right-i.Left,i.Height=i.Bottom-i.Top;var r=this.UIElement.getBoundingClientRect(),n=w(),o=r.left+n.Left,s=r.top+n.Top;i.Left+=o,i.Right+=o,i.Top+=s,i.Bottom+=s,this.JSPopMenu.CreatePopMenu(t),this.JSPopMenu.PopupMenuByDrapdown(i)}},this.PopupMenuByRClick=function(t,e,a){if(this.JSPopMenu){var i=this.UIElement.getBoundingClientRect(),r=w();e+=i.left+r.Left,a+=i.top+r.Top,this.JSPopMenu.CreatePopMenu(t),this.JSPopMenu.PopupMenuByRight(e,a)}},this.ExecuteMenuCommand=function(t,e){u.Chart.Log("[JSChartContainer::ExecuteMenuCommand] cmdID=, aryArgs=",t,e);var a=null,i=null;switch(sa.IsNonEmptyArray(e)&&(i=e[0],sa.IsNumber(e[0])&&(a=e[0])),t){case v.CMD_CHANGE_PERIOD_ID:this.ChangePeriod&&null!=a&&this.ChangePeriod(a);break;case v.CMD_CHANGE_WINDOW_COUNT_ID:this.ChangeIndexWindowCount&&null!=a&&this.ChangeIndexWindowCount(a);break;case v.CMD_CHANGE_RIGHT_ID:this.ChangeRight&&null!=a&&this.ChangeRight(a);break;case v.CMD_CHANGE_INDEX_ID:this.ChangeIndex&&null!=a&&e[1]&&this.ChangeIndex(a,e[1]);break;case v.CMD_CHANGE_API_INDEX_ID:this.ChangeAPIIndex&&null!=a&&e[1]&&this.ChangeAPIIndex(a,e[1]);break;case v.CMD_CHANGE_SCRIPT_INDEX_ID:this.ChangeScriptIndex&&null!=a&&e[1]&&this.ChangeScriptIndex(a,e[1],e[2]);break;case v.CMD_CHANGE_COLOR_INDEX_ID:case v.CMD_CHANGE_TRADE_INDEX_ID:this.ChangeInstructionIndex&&e[0]&&this.ChangeInstructionIndex(e[0]);break;case v.CMD_DELETE_COLOR_INDEX_ID:case v.CMD_DELETE_TRADE_INDEX_ID:this.CancelInstructionIndex&&this.CancelInstructionIndex();break;case v.CMD_CHANGE_KLINE_TYPE_ID:this.ChangeKLineDrawType&&null!=a&&this.ChangeKLineDrawType(a,e[1],e[2]);break;case v.CMD_CHANGE_PRICE_GAP_ID:this.ChangePriceGap&&sa.IsBool(e[0])&&(0==e[0]?this.ChangePriceGap({Enable:e[0]}):sa.IsNumber(e[1])&&this.ChangePriceGap({Enable:e[0],Count:e[1]}));break;case v.CMD_OVERLAY_SYMBOL_ID:!0===e[1]?this.OverlaySymbol&&e[0]&&this.OverlaySymbol(e[0]):!1===e[1]&&this.DeleteOverlaySymbol&&e[0]&&this.DeleteOverlaySymbol(e[0]);break;case v.CMD_DELETE_ALL_OVERLAY_SYMBOL_ID:this.ClearOverlaySymbol&&this.ClearOverlaySymbol();break;case v.CMD_CHANGE_COORDINATETYPE_ID:this.ChangeCoordinateType&&e[0]&&this.ChangeCoordinateType(e[0]);break;case v.CMD_CHANGE_KLINE_INFO_ID:e[0]&&sa.IsBool(e[1])&&(1==e[1]&&this.AddKLineInfo?this.AddKLineInfo(e[0],!0):0==e[1]&&this.DeleteKLineInfo&&this.DeleteKLineInfo(e[0]));break;case v.CMD_DELETE_ALL_KLINE_INFO_ID:this.ClearKLineInfo&&this.ClearKLineInfo();break;case v.CMD_CHANGE_DRAG_MODE_ID:null!=a&&(this.DragMode=a,1==this.DragMode&&sa.IsBool(e[1])&&(this.KLineDragConfig.EnableShfit=e[1]));break;case v.CMD_CHANGE_BG_SPLIT_ID:if(sa.IsBool(i))if(i)this.CreateExtendChart("SessionBreaksPaint",{}),this.Draw();else{var r=this.GetExtendChartByClassName("SessionBreaksPaint");r&&(this.DeleteExtendChartByID(r.Chart.ID),this.Draw())}break;case v.CMD_SHOW_DRAWTOOL_ID:this.IsShowDrawToolDialog()||this.ShowDrawToolDialog();break;case v.CMD_SHOW_STOCKCHIP_ID:var n=this.GetStockChipChart();if(n)return;if(i){this.CreateExtendChart(i,e[1]);this.SetSizeChange(!0),this.Draw()}break;case v.CMD_HIDE_STOCKCHIP_ID:this.DeleteStockChipChart&&this.DeleteStockChipChart();break;case v.CMD_CHIP_CHART_SETTING_ID:n=this.GetStockChipChart();if(!n)return;null!=a&&(n.Chart.ShowType=a,this.SetSizeChange(!0),this.Draw());break;case v.CMD_CHANGE_DAY_COUNT_ID:this.ChangeDayCount&&null!=a&&this.ChangeDayCount(a);break;case v.CMD_SHOW_BEFORE_DATA_ID:this.ShowCallAuctionData&&sa.IsBool(i)&&this.ShowCallAuctionData({Left:i,MultiDay:{Left:i}});break;case v.CMD_CHANGE_BASELINE_ID:this.ChangeBaselineType&&sa.IsNumber(a)&&this.ChangeBaselineType(a);break;case v.CMD_SELECTED_ZOOM_ID:this.ShowSelectData&&i&&this.ShowSelectData(i);break;case v.CMD_SELECTED_SUMMARY_ID:this.OnCMDSelectedSummary(i,e[1]);break;case v.CMD_SHOW_INDEX_ID:if(null==a||!sa.IsNumber(e[1]))return!1;var o=a,s=e[1],h=this.WindowIndex[o];if(!h)return!1;h.IsShow=1!=s&&(2==s||!h.IsShow),this.UpdateWindowIndex(o);break;case v.CMD_SHOW_OVERLAY_INDEX_ID:if(!i||!sa.IsNumber(e[1]))return!1;var l=i,C=(s=e[1],this.GetOverlayIndexByIdentify(l));if(!C||!C.OverlayItem||!C.OverlayItem.Script)return!1;h=C.OverlayItem.Script;1==s?h.IsShow=!1:2==s?h.IsShow:h.IsShow=!h.IsShow,this.UpdateOverlayIndex(l);break;case v.CMD_DELETE_OVERLAY_INDEX_ID:i&&this.DeleteOverlayWindowsIndex&&this.DeleteOverlayWindowsIndex(i);break;case v.CMD_SHOW_OVERLAY_Y_AXIS_ID:if(!i||!sa.IsNumber(e[1]))return!1;if(!this.GetOverlayIndexByIdentify)return!1;l=i,s=e[1],r=this.GetOverlayIndexByIdentify(l);if(!r||!r.OverlayItem)return!1;var D=r.OverlayItem.Frame;1==s?D.IsShow=!1:2==s?D.IsShow:D.IsShow=!D.IsShow,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw();break;case v.CMD_ENABLE_OVERLAY_SHARE_Y_ID:if(!i||!sa.IsNumber(e[1]))return!1;if(!this.GetOverlayIndexByIdentify)return!1;l=i,s=e[1],r=this.GetOverlayIndexByIdentify(l);if(!r||!r.OverlayItem)return!1;D=r.OverlayItem.Frame;1==s?D.IsShareY=!1:2==s?D.IsShareY:D.IsShareY=!D.IsShareY,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw();break;case v.CMD_CHANGE_DEFAULTCURSOR_ID:if(!sa.IsString(i))return;this.DefaultCursor=i,this.UIElement.style.cursor=this.DefaultCursor;break;case v.CMD_ADD_OVERLAY_INDEX_ID:if(null==a||!e[1])return!1;var f=e[1];f.WindowIndex=a,this.AddOverlayIndex(f);break;case v.CMD_CHANGE_LANGUAGE_ID:i&&this.SetLanguage(i);break;case v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID:null!=a&&this.ChartDragSelectRect&&(this.ChartDragSelectRect.ShowMode=a);break;case v.CMD_SHOW_CORSS_LINE_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.IsShowCorss=i);break;case v.CMD_ENABLE_POP_MINUTE_CHART_ID:sa.IsBool(i)&&(i?(this.DestroyPopMinuteChart(),this.InitalPopMinuteChart({PopMinuteChart:{Enable:!0}})):this.DestroyPopMinuteChart());break;case v.CMD_CHANGE_INFO_POSITION_ID:if(null==a)return!1;var c=this.ChartPaint[0];if(!c)return!1;c.InfoPosition=a,this.Draw();break;case v.CMD_DIALOG_TOOLTIP_ATTRIBUTE:if(!e[0])return!1;var m=e[0];if(!sa.IsBool(m.Enable))return!1;!1===m.Enable?this.DestroyTooltipDialog():(this.DestroyTooltipDialog(),this.InitalTooltipDialog(m));break;case v.CMD_KLINE_TOOLTIP_ATTRIBUTE:if(!e[0])return!1;m=e[0];sa.IsBool(m.Enable)&&(this.KLineTooltipConfig.Enable=m.Enable),sa.IsBool(m.EnableKeyDown)&&(this.KLineTooltipConfig.EnableKeyDown=m.EnableKeyDown);break;case v.CMD_MODIFY_INDEX_PARAM:if(null==a)return!1;var d={e:null,WindowIndex:a,Type:1};this.ShowModifyIndexParamDialog(d);break;case v.CMD_MODIFY_OVERLAY_INDEX_PARAM:if(null==a)return!1;if(!e[1])return!1;d={e:null,WindowIndex:a,Type:2,Identify:e[1]};this.ShowModifyIndexParamDialog(d);break;case v.CMD_LOCK_CROSSCURSOR:i&&this.LockCorssCursor(i);break;case v.CMD_UNLOCK_CROSSCURSOR:this.IsLockCorssCursor()&&this.UnlockCorssCursor({Draw:!0});break;case v.CMD_CORSS_ON_CLOSE_LINE_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.IsOnlyDrawMinute=i);break;case v.CMD_CORSS_ON_VAILD_TIME_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.IsFixXLastTime=i);break;case v.CMD_CORSS_ON_KLINE_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.IsOnlyDrawKLine=i,this.ChartCorssCursor.IsShowClose=i);break;case v.CMD_CORSS_SHOW_INCREASE_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.StringFormatX.IsShowIncrease=i);break;case v.CMD_CORSS_X_TEXTALIGN_ID:if(null==a)return!1;this.ChartCorssCursor&&(this.ChartCorssCursor.BottomConfig.Align=a);break;case v.CMD_CORSS_POINT_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.CorssPointConfig.Enable=i);break;case v.CMD_CORSS_DBCLICK_ID:sa.IsBool(i)&&this.ChartCorssCursor&&(this.ChartCorssCursor.EnableDBClick=i);break;case v.CMD_RBUTTON_SELECT_RECT_ID:sa.IsBool(i)&&this.ChartDragSelectRect&&(this.ChartDragSelectRect.EnableRButton=i);break;case v.CMD_LBUTTON_SELECT_RECT_ID:sa.IsBool(i)&&this.ChartDragSelectRect&&(this.ChartDragSelectRect.EnableLButton=i);break;case v.CMD_ENABLE_XDRAG_BOTTOM_ID:sa.IsBool(i)&&(this.EnableXDrag.Bottom=i),sa.IsNonEmptyArray(e)&&sa.IsNumber(e[1])&&(this.EnableXDrag.LButton.Type=e[1]),sa.IsNonEmptyArray(e)&&sa.IsNumber(e[2])&&(this.EnableXDrag.RButton.Type=e[2]);break;case v.CMD_FULLSCREEN_SUMMARY_ID:this.FullScreenSummary();break;case v.CMD_ENABLE_KLINE_DAY_SUMMARY_ID:sa.IsBool(i)&&(this.ChartPaint[0].DaySummary.Enable=i,this.Draw());break;case v.CMD_SHOW_BUYSELL_BAR_ID:if(sa.IsBool(i)){var I=this.GetChartMinuteBuySellBar();I.IsShow=i,this.RequestData({ClearYCoordinateMaxMin:!0}),this.Draw()}break}},this.GetShowIndexMenuData=function(t,e){var a=this.WindowIndex[t];if(!a)return null;var i={Name:a.IsShow?"隐藏指标":"显示指标",Data:{ID:v.CMD_SHOW_INDEX_ID,Args:[t,0]}};return i},this.GetModifyIndexMenuData=function(t){var e={Name:"参数修改",Data:{ID:v.CMD_MODIFY_INDEX_PARAM,Args:[t]}};return e},this.GetShowOverlayIndexMenuData=function(t,e){var a=this.GetOverlayIndexByIdentify(t);if(!a||!a.OverlayItem||!a.OverlayItem.Script)return null;var i=a.OverlayItem.Script,r={Name:i.IsShow?"隐藏指标":"显示指标",Data:{ID:v.CMD_SHOW_OVERLAY_INDEX_ID,Args:[t,0]}};return r},this.GetModifyOverlayIndexMenuData=function(t){var e=this.GetOverlayIndexByIdentify(t);if(!e)return null;var a={Name:"参数修改",Data:{ID:v.CMD_MODIFY_OVERLAY_INDEX_PARAM,Args:[e.WindowIndex,t]}};return a},this.GetShowOverlayIndexYAxisMenuData=function(t,e){var a=this.GetOverlayIndexByIdentify(t);if(!a||!a.OverlayItem||!a.OverlayItem.Script)return null;var i=a.OverlayItem.Frame,r={Name:i.IsShow?"隐藏Y轴":"显示Y轴",Data:{ID:v.CMD_SHOW_OVERLAY_Y_AXIS_ID,Args:[t,0]}};return r},this.GetOverlayIndexShareYMenuData=function(t,e){var a=this.GetOverlayIndexByIdentify(t);if(!a||!a.OverlayItem||!a.OverlayItem.Script)return null;var i=a.OverlayItem.Frame,r={Name:"公用窗口Y轴",Data:{ID:v.CMD_ENABLE_OVERLAY_SHARE_Y_ID,Args:[t,0]},Checked:i.IsShareY};return r},this.OnClickRightMenu=function(t){if(u.Chart.Log("[JSChartContainer::OnClickRightMenu] ",t),t&&t.Data){var e=t.Data.ID,a=t.Data.Args,i=this.GetEventCallback(m.ON_MENU_COMMAND);if(i&&i.Callback){t={PreventDefault:!1,CommandID:e,Args:a,SrcData:t};if(i.Callback(i,t,this),t.PreventDefault)return}this.ExecuteMenuCommand(e,a)}},this.PopupRightMenuV2=function(t,e){var a=this;if(this.JSPopMenu){var i=t.X,r=t.Y,n=t.FrameID,o={Menu:this.GetRightMenuData(n,t),Position:JSPopMenu.POSITION_ID.RIGHT_MENU_ID,ClickCallback:function(t){a.OnClickRightMenu(t)}},s=this.GetEventCallback(m.ON_CREATE_RIGHT_MENU);if(s&&s.Callback){var h={MenuData:o,FrameID:n,Data:t};s.Callback(s,h,this)}this.PopupMenuByRClick(o,i,r)}},this.OnCMDSelectedSummary=function(t,e){e&&this.UpdateSelectRect(e.Start,e.End),this.HideSelectRect(),this.DialogSelectRect&&t&&this.DrawSelectRectDialog(t)},this.CreateChartPaintExtend=function(t,e){if(e<0)return!1;var a=this.Frame.SubFrame[e];if(!a||!a.Frame)return!1;var i=a.Frame;return t.Canvas=this.Canvas,t.ChartBorder=i.ChartBorder,t.ChartFrame=i,t.HQChart=this,this.ChartPaintEx.push(t),!0},this.CreateChartPaintExtendV2=function(t,e,a){if(a<0)return!1;var i=this.Frame.SubFrame[a];if(!i||!i.Frame)return!1;var r=xt.Create(t,e);if(!r)return!1;var n=i.Frame;return r.Canvas=this.Canvas,r.ChartBorder=n.ChartBorder,r.ChartFrame=n,r.HQChart=this,this.ChartPaintEx.push(r),!0},this.DeleteChartPaintExtend=function(t,e){if(t&&sa.IsNonEmptyArray(this.ChartPaintEx)&&sa.IsNumber(t.WindowIndex)){var a=t.WindowIndex;if(!this.Frame.SubFrame[a])return;var i=this.Frame.SubFrame[a].Frame;if(!i)return;for(var r=[],n=0,o=0;o<this.ChartPaintEx.length;++o){var s=this.ChartPaintEx[o],h=s.ChartFrame.Guid==i.Guid||s.ChartFrame==i;h?(++n,!0===e&&s&&s.OnDestroy&&s.OnDestroy()):r.push(s)}n>0&&(this.ChartPaintEx=r)}},this.ClearCurrnetDrawPicture=function(){this.CurrentChartDrawPicture=null},this.CreateDragSelectRect=function(t){var e=Ve.Create("RectDragPaint",t);if(!e)return null;e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.HQChart=this,e.SetOption(t),this.ChartDragSelectRect=e},this.ClearDragSelectRect=function(){this.ChartDragSelectRect&&this.ChartDragSelectRect.ClearPoint()},this.ShowDragSelectRect=function(t,e){this.ChartDragSelectRect&&(this.ChartDragSelectRect.SetFirstPoint(t.X,t.Y),this.ChartDragSelectRect.SetSecondPoint(e.X,e.Y),this.ChartDragSelectRect.Draw())},this.ChangeIndexWindow=function(t,e){if(u.Chart.Log("[KLineChartContainer::ChangeIndexWindow] windowIndex, option",t,e),t<0||t>=this.Frame.SubFrame.length)return!1;if(!e)return!1;var a=this.Frame.SubFrame[t];if(e.Delete){var i=e.Delete;!0===i.Window&&this.DeleteIndexPaint(t),!0===i.Overlay&&this.DeleteWindowsOverlayIndex(t)}var r=t+1;if(this.TitlePaint[r].Data=[],this.TitlePaint[r].Title=null,e.Window){this.DeleteIndexPaint(t);i=e.Window;if(i.Script)this.WindowIndex[t]=new pn(i.Name,i.Script,i.Args,i);else if(i.API){var n=i.API;this.WindowIndex[t]=new xn(n.Name,n.Script,n.Args,i)}else{var o=i.Index,s=tr.Get(o);if(s)this.WindowIndex[t]=s.Create(),this.CreateWindowIndex(t);else{var h=new f,l=h.Get(o);l&&(f.ModifyAttribute(l,i),this.WindowIndex[t]=new pn(l.Name,l.Script,l.Args,l))}}this.SetSubFrameAttribute(a,i,e.Frame)}var C=[];if(sa.IsNonEmptyArray(e.OverlayIndex)){this.DeleteWindowsOverlayIndex(t);for(var D=0;D<e.OverlayIndex.length;++D){i=e.OverlayIndex[D];i.Index&&(i.IndexName=i.Index),i.WindowIndex=t,i.Windows>=0&&(i.WindowIndex=i.Windows);var c=this.CreateOverlayWindowsIndex(i);c&&C.push({WindowsIndex:i.WindowIndex,Overlay:c})}}var m=this.ChartPaint[0].Data;this.BindIndexData(t,m);for(D=0;D<C.length;++D){i=C[D];this.BindOverlayIndexData(i.Overlay,i.WindowsIndex,m)}this.UpdataDataoffset(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()},this.ClickHorizontalLabel=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_HORIZONTAL_LABEL);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}},this.ResetOverlaySymbolStatus=function(){for(var t=0;t<this.OverlayChartPaint.length;++t){var e=this.OverlayChartPaint[t];e.Status=Rt.STATUS_NONE_ID}},this.OnChangeCorssCursorStatus=function(t,e){1==t.Type&&(t.IsShowCorss||(this.HideTooltip(),this.CloseTooltipDialog()))},this.UpdateWindowIndexV2=function(t,e){if(!this.Frame||!this.Frame.SubFrame)return!1;var a=this.GetKData();if(!a||!sa.IsNonEmptyArray(a.Data))return!1;if(!sa.IsNonEmptyArray(t))return!1;for(var i=new Set,r=new Set,n=0;n<t.length;++n){var o=t[n];o&&(sa.IsNumber(o.ID)&&i.add(o.ID),o.OverlayID&&r.add(o.OverlayID))}if(i.size<=0&&r.size<0)return!1;var s=new dt;if(a&&(s.Data=a.Data),this.IsKLineContainer()&&(s.Period=this.Period,s.Right=this.Right),i.size>0)for(n=0;n<this.WindowIndex.length;++n){o=this.WindowIndex[n];o&&(i.has(n)&&this.BindIndexData(n,s))}if(r.size>0)for(n=0;n<this.Frame.SubFrame.length;++n){o=this.Frame.SubFrame[n];for(var h=0;h<o.OverlayIndex.length;++h){var l=o.OverlayIndex[h];r.has(l.Identify)&&this.BindOverlayIndexData(l,n,s)}}var u=!0;return e&&!1===e.Draw&&(u=!1),u&&(this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()),!0},this.GetKData=function(){return null},this.IsEnableRSelectRect=function(t,e){if(!this.ChartDragSelectRect)return!1;if(!this.ChartDragSelectRect.EnableRButton)return!1;if(!t)return!1;if("DocOnMouseUp"==e){if(2!=t.button)return!1}else if("DocOnMouseMove"==e&&2!=t.buttons)return!1;return!0},this.IsEnableLSelectRect=function(t,e){if(!this.ChartDragSelectRect)return!1;if(!this.ChartDragSelectRect.EnableLButton)return!1;if(!t)return!1;if("DocOnMouseUp"==e){if(0!=t.button)return!1}else if("DocOnMouseMove"==e&&1!=t.buttons)return!1;return!0},this.GetDragXCoordinateType=function(t,e){if("DocOnMouseMove"==e){if(1==t.buttons)return this.EnableXDrag.LButton.Type;if(2==t.buttons)return this.EnableXDrag.RButton.Type}return null},this.OnMarkRectSelect=function(t){var e=this.ChartCorssCursor;if(e&&0!=e.Status&&sa.IsNumber(e.CursorIndex)&&this.ChartPaint[0]&&this.ChartPaint[0].Data){var a=this.GetRectSelectPaint();if(a){var i=this.GetKData();if(i&&sa.IsNonEmptyArray(i.Data)){var r=e.CursorIndex;u.Chart.Log("[JSChartContainer::OnMarkRectSelect] dataIndex",r),r=parseInt(r.toFixed(0));var n=r+i.DataOffset;n>=i.Data.length&&(n=i.Data.length-1);var o=i.Data[n];if(u.Chart.Log("[KLineChartContainer::OnMarkRectSelect] item",o),this.SetRectSelectData(o,n)){var s=a.GetPointCount(),h=F(),l=e.LastPoint.X/h,C=e.LastPoint.Y/h;if(1==s){var D=this.GetEventCallback(m.ON_KEYDOWN_SELECT_RECT_FIRST);if(D&&D.Callback){var f={X:l,Y:C,Item:o,Index:n,RectSelectPaint:a,e:t};D.Callback(D,f,this)}this.Draw()}else if(2==s){var c=a.GetSelectRectData();if(t){f={Chart:this,X:l,Y:C,SelectData:c,RectSelectPaint:a};t.data=f}var d=null,I=null,S=this.IsMinuteContainer();S?I={ID:v.CMD_SELECTED_SUMMARY_ID,Args:[t,c]}:d=[{Name:"区间统计",Data:{ID:v.CMD_SELECTED_SUMMARY_ID,Args:[t,c]}},{Name:"区间放大",Data:{ID:v.CMD_SELECTED_ZOOM_ID,Args:[c]}}];D=this.GetEventCallback(m.ON_KEYDOWN_SELECT_RECT);if(D&&D.Callback){var T={X:l,Y:C,SelectData:c,RectSelectPaint:a,AryMenu:d,Command:I,e:t,PreventDefault:!1};if(S&&(T.Command=null),D.Callback(D,T,this),d=T.AryMenu,I=T.Command,T.PreventDefault)return void this.Draw()}I?this.ExecuteMenuCommand(I.ID,I.Args):d&&this.PopupSelectRectMenuV3(d,f,t),this.Draw()}}}}}},this.MoveCorssCursorUp=function(t){if(sa.IsNumber(this.LastPoint.Y)){var e=this.Frame.ChartBorder.GetBorder(),a=e.TopEx;this.LastPoint.Y-t<=a||(this.LastPoint.Y-=t,this.DrawDynamicInfo())}},this.MoveCorssCursorDown=function(t){if(sa.IsNumber(this.LastPoint.Y)){var e=this.Frame.ChartBorder.GetBorder(),a=(e=this.Frame.ChartBorder.GetBorder(),e.BottomEx);this.LastPoint.Y+t>=a||(this.LastPoint.Y+=t,this.DrawDynamicInfo())}},this.FullScreenSummary=function(){var t=this.GetKData();if(!t||!sa.IsNonEmptyArray(t.Data))return!1;var e=this.GetRectSelectPaint();if(!e)return!1;var a=0;if(a=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!sa.IsPlusNumber(a))return!1;var i=t.DataOffset,r=i+a;this.UpdateSelectRect(i,r);var n=e.GetSelectRectData(),o=this.Frame.SubFrame[0].Frame.GetBorder(),s={X:o.ChartWidth/2,Y:o.ChartHeight/2,SelectData:n,RectSelectPaint:e},h={data:s};return this.DialogSelectRect&&this.DrawSelectRectDialog(h),!0},this.FastSlideEvent=function(){if(!this.TouchDrag)return!1;if(!this.FastSlideConfig)return!1;var t=this.FastSlideConfig;if(!t.Enable)return!1;var e=this.GetEventCallback(m.ON_TOUCH_FAST_SLIDE);if(!e||!e.Callback)return!1;var a=this.TouchDrag,i=Date.now(),r=i-a.StartTime;if(r>t.MaxTime)return!1;if(!a.Click||!a.LastMove)return!1;var n=a.Click.X,o=a.LastMove.X;if(!sa.IsNumber(n)||!sa.IsNumber(o))return!1;var s=o-n,h=Math.abs(s)/r;if(u.Chart.Log("[JSChartContainer:FastSlideEvent] speed=".concat(h,", distance=").concat(s,", spanTime=").concat(r)),Math.abs(s)<t.MinDistance)return!1;if(h<t.MinSpeed)return!1;var l={Speed:h,Distance:s,IsLeft:s<0};return e.Callback(e,l,this),!0},this.IsCallAuctionFrame=function(t){return!1},this.UpdateTradeStatusData=function(t,e){return e&&!0===e.IsClear&&(this.GlobalOption.TradeStatus=null),!!t&&(!!(sa.IsNumber(t.Date)&&sa.IsNumber(t.Time)&&sa.IsNumber(t.Status))&&(this.GlobalOption.TradeStatus={Date:t.Date,Time:t.Time,Status:t.Status},!0))}}function F(){return"undefined"==typeof window?1:window.devicePixelRatio||1}function E(t,e,a){if(!t)return null;e&&(t.font=e);var i="擎";sa.IsString(a)&&(i=a);var r=t.measureText(i),n=r.fontBoundingBoxAscent+r.fontBoundingBoxDescent;return sa.IsNumber(n)||(n=r.width+2*F()),n}function L(t){this.JSChartContainer&&this.JSChartContainer.OnKeyDown&&this.JSChartContainer.OnKeyDown(t)}function M(t,e){return Math.max(t.Left,e.Left)<Math.min(t.Right,e.Right)&&Math.max(t.Top,e.Top)<Math.min(t.Bottom,e.Bottom)}function R(t,e,a){var i=t.measureText(e),r=Math.abs(Math.abs(i.fontBoundingBoxAscent)+Math.abs(i.fontBoundingBoxDescent)),n=t.textBaseline;"top"==n?r=i.fontBoundingBoxDescent:"bottom"==n&&(r=i.fontBoundingBoxAscent);var o={Width:i.width,Height:r};return o}function N(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"guid"+(t()+t())+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function w(){var t={},e=0,a=0;return document.documentElement&&(document.documentElement.scrollTop||document.documentElement.scrollLeft)?(e=document.documentElement.scrollTop,a=document.documentElement.scrollLeft):document.body&&(e=document.body.scrollTop,a=document.body.scrollLeft),t.Top=e,t.Left=a,t}function A(t){return parseInt(t)+.5}function O(t,e){var a=t%2===0?Math.floor(e):Math.floor(e)+.5;return a}function b(t){return.5+t<<0}function B(t,e,a){return t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom}function P(t){if(!t)return null;var e=JSON.stringify(t),a=JSON.parse(e);return a}function G(t,e){e&&t&&(sa.IsNumber(e.Left)&&(t.Left=e.Left),sa.IsNumber(e.Top)&&(t.Top=e.Top),sa.IsNumber(e.Right)&&(t.Right=e.Right),sa.IsNumber(e.Bottom)&&(t.Bottom=e.Bottom))}function _(){}function V(){this.X,this.Y}function H(){this.Data,this.JSChartContainer,this.Start,this.End,this.XStart,this.YStart,this.XEnd,this.YEnd}function Y(){this.Value,this.Message=[],this.TextColor=qi.FrameSplitTextColor,this.TextBGColor,this.TextColor2,this.Font=qi.FrameSplitTextFont,this.LineColor=qi.FrameSplitPen,this.LineDash=null,this.LineType=1,this.LineWidth,this.ExtendLine,this.ExtendData,this.AreaData}function X(){this.UIElement,this.Left=50,this.Right=80,this.Top=50,this.Bottom=50,this.TitleHeight=24,this.TopSpace=0,this.BottomSpace=0,this.LeftExtendWidth=0,this.RightExtendWidth=0,this.MultiDayMinute={Count:1,Left:0,Right:0},this.IsShowTitleOnly=!1,this.GetBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.LeftExtendWidth,Right:this.UIElement.width-this.Right,RightEx:this.UIElement.width-this.Right-this.RightExtendWidth,Top:this.Top,TopEx:this.Top+this.TitleHeight+this.TopSpace,TopTitle:this.Top+this.TitleHeight,Bottom:this.UIElement.height-this.Bottom,BottomEx:this.UIElement.height-this.Bottom-this.BottomSpace,ChartWidth:this.UIElement.width,ChartHeight:this.UIElement.height};if(this.MultiDayMinute&&this.MultiDayMinute.Count>1&&(this.MultiDayMinute.Left>0||this.MultiDayMinute.Right>0)){for(var e=this.UIElement.width-this.Left-this.Right,a=e/this.MultiDayMinute.Count,i=[],r=0;r<this.MultiDayMinute.Count;++r){var n={Left:this.Left+a*r,Right:this.Left+a*(r+1)};n.LeftEx=n.Left+this.MultiDayMinute.Left,n.RightEx=n.Right-this.MultiDayMinute.Right,r>0&&(n.Left+=1),i.push(n)}t.DayBorder=i}return t},this.GetHScreenBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.BottomSpace,Right:this.UIElement.width-this.Right,RightEx:this.UIElement.width-this.Right-this.TitleHeight-this.TopSpace,RightTitle:this.UIElement.width-this.Right-this.TitleHeight,Top:this.Top,TopEx:this.Top+this.LeftExtendWidth,Bottom:this.UIElement.height-this.Bottom,BottomEx:this.UIElement.height-this.Bottom-this.RightExtendWidth,ChartWidth:this.UIElement.width,ChartHeight:this.UIElement.height};if(this.MultiDayMinute&&this.MultiDayMinute.Count>1&&(this.MultiDayMinute.Left>0||this.MultiDayMinute.Right>0)){for(var e=this.UIElement.height-this.Top-this.Bottom,a=e/this.MultiDayMinute.Count,i=[],r=0;r<this.MultiDayMinute.Count;++r){var n={Top:this.Top+a*r,Bottom:this.Top+a*(r+1)};n.TopEx=n.Top+this.MultiDayMinute.Left,n.BottomEx=n.Bottom-this.MultiDayMinute.Right,i.push(n)}t.DayBorder=i}return t},this.PtInClient=function(t,e,a,i){if(i){var r=this.GetHScreenBorder();a.rect(r.Left,r.TopEx,r.Right-r.Left,r.BottomEx-r.TopEx)}else{r=this.GetBorder();if(r.DayBorder){for(var n=0;n<r.DayBorder.length;++n){var o=r.DayBorder[n];if(a.beginPath(),a.rect(o.LeftEx,r.TopEx,o.RightEx-o.LeftEx,r.BottomEx-r.TopEx),a.isPointInPath(t,e))return 1;if(a.beginPath(),a.rect(o.Left,r.TopEx,o.LeftEx-o.Left,r.BottomEx-r.TopEx),a.isPointInPath(t,e))return 200+parseInt(n);if(a.beginPath(),a.rect(o.RightEx,r.TopEx,o.Right-o.RightEx,r.BottomEx-r.TopEx),a.isPointInPath(t,e))return 300+parseInt(n)}return-1}a.rect(r.LeftEx,r.Top,r.RightEx-r.LeftEx,r.Bottom-r.Top)}return a.isPointInPath(t,e)?1:this.LeftExtendWidth>10&&(a.beginPath(),!0===i?a.rect(r.Left,r.Top,r.Right-r.Left,r.TopEx-r.Top):a.rect(r.Left,r.Top,r.LeftEx-r.Left,r.Bottom-r.Top),a.isPointInPath(t,e))?2:this.RightExtendWidth>10&&(a.beginPath(),!0===i?a.rect(r.Left,r.BottomEx,r.Right-r.Left,r.Bottom-r.BottomEx):a.rect(r.RightEx,r.Top,r.Right-r.RightEx,r.Bottom-r.Top),a.isPointInPath(t,e))?3:-1},this.GetChartWidth=function(){return this.UIElement.width},this.GetChartHeight=function(){return this.UIElement.height},this.GetLeft=function(){return this.Left+this.LeftExtendWidth},this.GetRight=function(){return this.UIElement.width-this.Right-this.RightExtendWidth},this.GetTop=function(){return this.Top},this.GetTopEx=function(){return this.Top+this.TitleHeight+this.TopSpace},this.GetTopTitle=function(){return this.Top+this.TitleHeight},this.GetBottom=function(){return this.UIElement.height-this.Bottom},this.GetBottomEx=function(){return this.UIElement.height-this.Bottom-this.BottomSpace},this.GetWidth=function(){return this.UIElement.width-this.Left-this.Right-this.LeftExtendWidth-this.RightExtendWidth},this.GetHeight=function(){return this.UIElement.height-this.Top-this.Bottom},this.GetHeightEx=function(){return this.UIElement.height-this.Top-this.Bottom-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetRightEx=function(){return this.UIElement.width-this.Right-this.TitleHeight-this.TopSpace},this.GetWidthEx=function(){return this.UIElement.width-this.Left-this.Right-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetLeftEx=function(){return this.Left+this.BottomSpace},this.GetRightTitle=function(){return this.UIElement.width-this.Right-this.TitleHeight},this.GetTitleHeight=function(){return this.TitleHeight},this.IsShowBeforeOpen=function(){return!(this.LeftExtendWidth<10)},this.IsShowAfterClose=function(){return!(this.RightExtendWidth<10)},this.IsShowMultiDayBeforeOpen=function(){return!!this.MultiDayMinute&&!(this.MultiDayMinute.Count<=1||this.MultiDayMinute.Left<=0)},this.IsShowMultiDayAfterClose=function(){return!!this.MultiDayMinute&&!(this.MultiDayMinute.Count<=1||this.MultiDayMinute.Right<=0)}}Number.prototype.toFixed2=Number.prototype.toFixed,Number.prototype.toFixed=function(t){return function(t,e){var a=1;if(isNaN(t))return t;t<0&&(a=-1);var i=Math.pow(10,e),r=Math.round(Math.abs(t)*i)/i*a;if(/^(\d+(?:\.\d+)?)(e)([\-]?\d+)$/.test(r))var n=r.toFixed2(e);else n=r.toString();var o=n.indexOf(".");o<0&&e>0&&(o=n.length,n+=".");while(n.length<=o+e)n+="0";return n}(this,t)},_.LT=function(t,e){return!(sa.IsNumberV2(t,e)&&Math.abs(t-e)<1e-7)&&t<e},_.GT=function(t,e){return!(sa.IsNumberV2(t,e)&&Math.abs(t-e)<1e-7)&&t>e};var W=new function(){this.DataMap=new Map([["KLineFrame",{Create:function(t){return new q}}],["KLineHScreenFrame",{Create:function(t){return new et}}]]),this.Create=function(t,e){if(!this.DataMap.has(t))return u.Chart.Warn("[ChartFrameFactory::Create] can't find class=".concat(t,".")),null;var a=this.DataMap.get(t);return a.Create(e)},this.Add=function(t,e){var a=null;return this.DataMap.has(t)&&(a=this.DataMap.get(t)),this.DataMap.set(t,{Create:e.Create}),a}};function U(){this.HorizontalInfo=new Array,this.VerticalInfo=new Array,this.ClassName="IChartFramePainting",this.Canvas,this.Identify,this.Guid=N(),this.ChartBorder,this.PenBorder=qi.FrameBorderPen,this.TitleBGColor=qi.FrameTitleBGColor,this.IsShow=!0,this.SizeChange=!0,this.XYSplit=!0,this.XSplit=!0,this.YCustomSplit=!0,this.HorizontalMax,this.HorizontalMin,this.HorizontalReserved=null,this.XPointCount=10,this.ClientBGColor,this.YMaxMin={Max:null,Min:null},this.YSplitOperator,this.XSplitOperator,this.Data,this.IsLocked=!1,this.LockPaint=null,this.YSpecificMaxMin=null,this.IsShowBorder=!0,this.IsShowTitleArrow=qi.IndexTitle.EnableIndexArrow,this.TitleArrowType=qi.IndexTitle.ArrowType,this.IsShowIndexName=!0,this.IsShowOverlayIndexName=!0,this.OverlayIndexType={Position:1,LineSpace:3},this.IndexParamSpace=2,this.IndexTitleSpace=0,this.IsShowIndexTitle=!0,this.IsDrawTitleBottomLine=!1,this.BorderLine=null,this.Buttons=[],this.ToolbarCacheSize=null,this.IsMinSize=!1,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font,this.LogoBGColor=qi.FrameLogo.BGColor,this.GlobalOption,this.IsDrawRightBorder=!1,this.IsDrawLeftBorder=!1,this.HorizontalLabel,this.PtInButtons=function(t,e){for(var a=0;a<this.Buttons.length;++a){var i=this.Buttons[a];if(i.Rect){var r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,r.Top,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return{ID:i.ID,Rect:r}}}return null},this.PtInHorizontalLabel=function(t,e){if(!sa.IsNonEmptyArray(this.HorizontalLabel))return null;for(var a=0;a<this.HorizontalLabel.length;++a){var i=this.HorizontalLabel[a],r=i.Rect;if(B(t,e,r))return{ID:i.ID,Rect:r,Item:i.Item,LineID:i.LineID}}},this.GetBorder=function(){return this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder()},this.Draw=function(){this.Buttons=[],this.HorizontalLabel=[],this.ToolbarCacheSize=null,this.DrawClientBG(),this.DrawFrame(),this.DrawBorder(),this.SizeChange=!1,this.XYSplit=!1,this.XSplit=!1,this.YCustomSplit=!1},this.DrawFrame=function(){},this.DrawClientBG=function(){if(this.ClientBGColor){var t=1==this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder(),e=A(t.Left),a=A(t.Top),i=A(t.Right),r=A(t.Bottom),n=i-e,o=r-a;this.Canvas.fillStyle=this.ClientBGColor,this.Canvas.fillRect(e,a,n,o)}},this.ClearCoordinateText=function(t){if(sa.IsNonEmptyArray(this.HorizontalInfo))for(var e=0;e<this.HorizontalInfo.length;++e){var a=this.HorizontalInfo[e];a&&a.Message&&Array.isArray(a.Message)&&(a.Message[0]=a.Message[1]=null)}if(sa.IsNonEmptyArray(this.VerticalInfo))for(e=0;e<this.VerticalInfo.length;++e){a=this.VerticalInfo[e];a&&a.Message&&Array.isArray(a.Message)&&(a.Message[0]=a.Message[1]=null)}},this.DrawBorder=function(){if(this.IsShowBorder&&!this.IsMinSize){var t=1==this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder(),e=A(t.Left),a=A(t.Top),i=A(t.Right),r=A(t.Bottom),n=i-e,o=r-a;if(null==this.BorderLine)if(this.IsDrawRightBorder||this.IsDrawLeftBorder){if(this.Canvas.strokeStyle=this.PenBorder,this.IsDrawRightBorder&&this.IsDrawLeftBorder){var s=A(t.ChartWidth),h=A(0);this.Canvas.strokeRect(h,a,s-h-1,o)}else if(this.IsDrawRightBorder){s=A(t.ChartWidth);this.Canvas.strokeRect(e,a,s-e-1,o)}else if(this.IsDrawLeftBorder){h=A(0);this.Canvas.strokeRect(h,a,i-h,o)}this.IsDrawRightBorder&&(this.Canvas.beginPath(),this.Canvas.moveTo(i,a),this.Canvas.lineTo(i,r),this.Canvas.stroke()),this.IsDrawLeftBorder&&(this.Canvas.beginPath(),this.Canvas.moveTo(e,a),this.Canvas.lineTo(e,r),this.Canvas.stroke())}else this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(e,a,n,o);else sa.IsPlusNumber(this.BorderLine)&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(i,a)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(e,r),this.Canvas.lineTo(i,r)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(e,r)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(i,a),this.Canvas.lineTo(i,r)),this.Canvas.stroke())}},this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var t=this.GetBorder(),e=A(t.Left),a=A(t.Top),i=A(t.Right),r=A(this.ChartBorder.GetTopTitle()),n=i-e,o=r-a;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(e,a,n,o),this.IsDrawTitleBottomLine&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(e,A(t.TopTitle)),this.Canvas.lineTo(i,A(t.TopTitle)),this.Canvas.stroke())}},this.DrawLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new Pe),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw(!0))},this.DrawLogo=function(){var t=this.GetBorder(),e=qi.FrameLogo.Text;if(sa.IsString(e)){this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var a=this.Canvas.measureText("擎").width,i=this.Canvas.measureText(e).width;if(this.IsHScreen){var r=t.Left+5,n=t.Top+5;this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180);var o={Left:0,Bottom:0,Width:i+4,Height:a+4};o.Top=o.Bottom-o.Height,o.Right=o.Left+o.Width,this.LogoBGColor&&(this.Canvas.fillStyle=this.LogoBGColor,this.Canvas.fillRect(o.Left,o.Top,o.Width,o.Height)),this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.fillText(e,1,0),this.Canvas.restore()}else{o={Left:t.Left+5,Bottom:t.Bottom-5,Width:i+4,Height:a+4};o.Top=o.Bottom-o.Height,o.Right=o.Left+o.Width,this.LogoBGColor&&(this.Canvas.fillStyle=this.LogoBGColor,this.Canvas.fillRect(o.Left,o.Top,o.Width,o.Height));r=o.Left+1,n=o.Bottom-1;this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.fillText(e,r,n)}}},this.CalculateLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new Pe),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw(!1))},this.SetLock=function(t){t?(this.IsLocked=!0,this.LockPaint||(this.LockPaint=new Pe),t.Callback&&(this.LockPaint.Callback=t.Callback),t.IndexName&&(this.LockPaint.IndexName=t.IndexName),t.ID&&(this.LockPaint.LockID=t.ID),t.BG&&(this.LockPaint.BGColor=t.BG),t.Text&&(this.LockPaint.Title=t.Text),t.TextColor&&(this.LockPaint.TextColor=t.TextColor),t.Font&&(this.LockPaint.Font=t.Font),t.Count&&(this.LockPaint.LockCount=t.Count),t.MinWidth>0&&(this.LockPaint.MinWidth=t.MinWidth)):this.IsLocked=!1},this.GetLockRect=function(){return this.IsLocked&&this.LockPaint?this.LockPaint.LockRect:null},this.ReloadResource=function(t){for(var e in t||(this.PenBorder=qi.FrameBorderPen,this.TitleBGColor=qi.FrameTitleBGColor),this.HorizontalInfo){var a=this.HorizontalInfo[e];a.Font&&(a.Font=qi.FrameSplitTextFont),a.TextColor&&(a.TextColor=qi.FrameSplitTextColor),a.LineColor&&(a.LineColor=qi.FrameSplitPen)}for(var e in this.VerticalInfo){a=this.VerticalInfo[e];a.Font&&(a.Font=qi.FrameSplitTextFont),a.TextColor&&(a.TextColor=qi.FrameSplitTextColor),a.LineColor&&(a.LineColor=qi.FrameSplitPen)}},this.GetFontHeight=function(t){return E(this.Canvas,t,"擎")},this.GetScaleTextWidth=function(){},this.IsMinuteFrame=function(t){var e=["MinuteFrame","MinuteHScreenFrame","OverlayMinuteFrame","OverlayMinuteHScreenFrame"];!1===t&&(e=["MinuteFrame","MinuteHScreenFrame"]);var a=e.includes(this.ClassName);return a},this.IsKLineFrame=function(t){var e=["KLineFrame","KLineHScreenFrame","KLineHScreenFrame","OverlayKLineHScreenFrame"];!1===t&&(e=["KLineFrame","KLineHScreenFrame"]);var a=e.includes(this.ClassName);return a}}function K(){this.newMethod=U,this.newMethod(),delete this.newMethod,this.ClassName="AverageWidthFrame",this.DataWidth=50*F(),this.DistanceWidth=10*F(),this.MinXDistance=30*F(),this.MinYDistance=12*F(),this.CoordinateType=0,this.IsShowYText=[!0,!0],this.XBottomOffset=qi.Frame.XBottomOffset,this.YTextTopOffset=qi.Frame.YTopOffset,this.YTextPosition=[0,0],this.YTextPadding=[qi.Frame.YTextPadding[0],qi.Frame.YTextPadding[1]],this.IsShowXLine=!0,this.IsShowYLine=!0,this.YInsideOffset=0,this.YTextBaseline=0,this.MultiTextFormat=0,this.RightTextMaxWidth=0,this.ShortYLineLength=5,this.ShortXLineLength=5,this.BeforeDrawXYCallback,this.GetEventCallback,this.ToolbarButtonStyle=qi.ToolbarButtonStyle,this.CloseWindowButton=P(qi.Buttons.CloseWindow),this.OverlayIndexButton=P(qi.Buttons.OverlayIndex),this.ChangeIndexButton=P(qi.Buttons.ChangeIndex),this.ModifyIndexParamButton=P(qi.Buttons.ModifyIndexParam),this.MaxMinWindowButton=P(qi.Buttons.MaxMinWindow),this.TitleWindowButton=P(qi.Buttons.TitleWindow),this.ExportDataButton=P(qi.Buttons.ExportData),this.AddIndexWindowButton=P(qi.Buttons.AddIndexWindow),this.ButtonTooltip=P(qi.Buttons.Tooltip),this.YLineExtend,this.YTextExtend,this.YRightTextInfo,this.XTextExtend,this.XLineExtend,this.FrameData={SubFrameItem:null},this.DrawPicture={BGColor:qi.DrawPicture.XYCoordinate.BGColor,TextBGColor:qi.DrawPicture.XYCoordinate.TextBGColor,TextColor:qi.DrawPicture.XYCoordinate.TextColor,Font:qi.DrawPicture.XYCoordinate.Font},this.IChartFramePainting_ReloadResource=this.ReloadResource,this.ReloadResource=function(t){this.IChartFramePainting_ReloadResource(t),t||(this.ToolbarButtonStyle=qi.ToolbarButtonStyle,this.CloseWindowButton=P(qi.Buttons.CloseWindow),this.OverlayIndexButton=P(qi.Buttons.OverlayIndex),this.ChangeIndexButton=P(qi.Buttons.ChangeIndex),this.ModifyIndexParamButton=P(qi.Buttons.ModifyIndexParam),this.MaxMinWindowButton=P(qi.Buttons.MaxMinWindow),this.TitleWindowButton=P(qi.Buttons.TitleWindow),this.ButtonTooltip=P(qi.Buttons.Tooltip),this.AddIndexWindowButton=P(qi.Buttons.AddIndexWindow))},this.DrawFrame=function(){if(this.XPointCount>0){var t=this.ChartBorder.GetWidth()/(6*this.XPointCount);this.DistanceWidth=2*t,this.DataWidth=4*t}this.DrawHorizontal(),this.DrawVertical()},this.DrawTitleButton=function(t,e,a){var i=this.GetBorder();if(this.IsHScreen){var r=i.Bottom-3,n=i.RightTitle+this.ChartBorder.TitleHeight/2;this.Canvas.save(),this.Canvas.translate(n,r),this.Canvas.rotate(90*Math.PI/180);for(var o=0,s=0,h=0,l=0;l<t.length;++l){var u=t[l],C=u.Style.Size,D=(s=h-C-u.Style.MerginLeft,"".concat(C,"px ").concat(u.Style.Family)),f=u.Style.Color;this.Canvas.fillStyle=f,this.Canvas.font=D,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(u.Style.Text,s,0);var c={Left:n-C/2,Right:n+C/2,Bottom:r,Width:C,Height:C+u.Style.MerginLeft};c.Top=c.Bottom-C-u.Style.MerginLeft,this.Buttons.push({ID:u.ID,Rect:c}),h=s,r=c.Top}this.Canvas.restore()}else{var m=i.RightEx-3;i.Left,o=i.Top+this.ChartBorder.TitleHeight/2;this.ToolbarCacheSize={RToolbar:{Right:m,Left:m}};for(l=0;l<t.length;++l){u=t[l],C=u.Style.Size;var d=m-C-u.Style.MerginLeft;D="".concat(C,"px ").concat(u.Style.Family),c={Left:d,Top:o-C/2,Right:d+C+u.Style.MerginLeft,Bottom:o+C/2,Width:C+u.Style.MerginLeft,Height:C},f=u.Style.Color;e&&e.X>=c.Left&&e.X<c.Right&&e.Y>=c.Top&&e.Y<=c.Bottom&&(f=u.Style.MoveOnColor,a&&(a.MouseOnToolbar={Rect:c,Item:u,Frame:this,Point:{X:e.X,Y:e.Y}})),this.Canvas.fillStyle=f,this.Canvas.font=D,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(u.Style.Text,d,o),this.Buttons.push({ID:u.ID,Rect:c}),this.ToolbarCacheSize.RToolbar.Left=c.Left,m=d}}},this.DrawToolbarTooltip=function(t){if(t){var e=this.GetBorder(),a=null;if(t.Item.TooltipText)a=t.Item.TooltipText;else{var i="Toolbar-"+t.Item.ID;a=$i.GetText(i,0)}if(a){F();var r=this.Canvas;if(this.GetExtraCanvas){var n=this.GetExtraCanvas(c.TooltipCursorCanvasKey);n&&(r=n.Canvas)}var o=t.Rect.Left+t.Rect.Width/2;r.font=this.ButtonTooltip.Font,r.textAlign="left",r.textBaseline="bottom";var s=this.ButtonTooltip.Mergin,h=r.measureText(a).width+s.Left+s.Right,l=this.GetFontHeight(),u=l+s.Top+s.Bottom;if("TitleButton"==t.ID)var C=t.Point.X,D=t.Point.Y+20;else if(S.CLOSE_BEFOREOPEN_ID==t.Item.ID)C=t.Rect.Right+5,D=t.Rect.Top;else if(S.DRAW_PICTURE_DELETE==t.Item.ID||S.DRAW_PICTURE_SETTING==t.Item.ID||t.Item.ID>=S.DRAW_PICTURE_BUTTON_1&&t.Item.ID<=S.DRAW_PICTURE_BUTTON_18){C=t.Point.X,D=t.Point.Y+20;C+h>=e.ChartWidth&&(C=e.ChartWidth-h-2)}else{C=o-h/2,D=e.Top-u;D<0&&(D=e.TopEx+1),C+h>e.ChartWidth&&(C=e.ChartWidth-h-2)}if(sa.IsNumber(this.ButtonTooltip.BorderRadius)){var f=this.ButtonTooltip.BorderRadius;r.beginPath(),r.roundRect(A(C),A(D),b(h),b(u),[f]),r.closePath(),r.fillStyle=this.ButtonTooltip.ColorBG,r.fill(),r.strokeStyle=this.ButtonTooltip.ColorBorder,r.stroke(),r.fillStyle=this.ButtonTooltip.Color,r.fillText(a,C+s.Left,D+u-s.Bottom)}else r.fillStyle=this.ButtonTooltip.ColorBG,r.fillRect(C,D,h,u),r.fillStyle=this.ButtonTooltip.Color,r.fillText(a,C+s.Left,D+u-s.Bottom)}}},this.GetYFromData=function(t,e){if(this.Logarithmic&&this.GetYLogarithmicFromData)return this.GetYLogarithmicFromData(t,e);if(!1===e){if(1==this.CoordinateType){var a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetTopEx()+a}a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-a}if(1==this.CoordinateType){if(t<=this.HorizontalMin)return this.ChartBorder.GetTopEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetBottomEx();a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetTopEx()+a}if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-a},this.IsShowRightHorizontal=function(){var t=this.ChartBorder.Right;if(t<=10)return!1;if(2==this.YTextPosition[1])return!1;if(!1===this.IsShowYText[1])return!1;if(this.GlobalOption&&this.GlobalOption.RightHorizontal){var e=this.GlobalOption.RightHorizontal;if(!1===e.Show)return!1}return!0},this.DrawHorizontal=function(){if(this.RightTextMaxWidth=0,sa.IsNonEmptyArray(this.HorizontalInfo)&&!this.ChartBorder.IsShowTitleOnly){var t=this.ChartBorder.GetBorder(),e=t.Left,a=t.Right,i=t.Bottom,r=this.ChartBorder.GetTop(),n=(this.ChartBorder.Right,this.ChartBorder.Left),o=n>10&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],s=this.IsShowRightHorizontal(),h=null,l=null;sa.IsNonEmptyArray(this.YLineExtend)&&(h=this.YLineExtend[1],l=this.YLineExtend[0]);var u=null,C=null;sa.IsNonEmptyArray(this.YTextExtend)&&(C=this.YTextExtend[0],u=this.YTextExtend[1]);for(var D,f,c,m,d=null,I=F(),S=(t.BottomEx-t.TopEx)/this.HorizontalInfo.length,T=[],v=[],p=0,g=this.HorizontalInfo.length-1;g>=0;--g){var x=this.HorizontalInfo[g];if(sa.IsNumber(x.Value)&&(!_.GT(x.Value,this.HorizontalMax)&&!_.LT(x.Value,this.HorizontalMin))){var E=this.GetYFromData(x.Value);if(!(null!=E&&null!=d&&Math.abs(E-d)<this.MinYDistance)){var L=A(E);if(E!=i&&this.IsShowYLine){var M=!1;sa.IsPlusNumber(x.LineWidth)&&(this.Canvas.lineWidth=x.LineWidth*I,M=!0),this.Canvas.strokeStyle=x.LineColor,2==x.LineType?(this.Canvas.save(),x.LineDash?this.Canvas.setLineDash(x.LineDash):this.Canvas.setLineDash([5*I,5*I]),this.Canvas.beginPath(),this.Canvas.moveTo(e,L),this.Canvas.lineTo(a,L),this.Canvas.stroke(),this.Canvas.setLineDash([]),this.Canvas.restore()):3==x.LineType||8==x.LineType||9==x.LineType||x.LineType>0&&(qi.FrameYLineDash?(this.Canvas.save(),this.Canvas.setLineDash(qi.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(e,L),this.Canvas.lineTo(a,L),this.Canvas.stroke(),this.Canvas.setLineDash([]),this.Canvas.restore()):(this.Canvas.beginPath(),this.Canvas.moveTo(e,L),this.Canvas.lineTo(a,L),this.Canvas.stroke())),M&&(this.Canvas.lineWidth=I)}var y=E;if(E>=i-2?(this.Canvas.textBaseline="bottom",p=2):E<=r+2?(this.Canvas.textBaseline="top",y+=this.YTextTopOffset,p=0):(this.Canvas.textBaseline="middle",p=1),this.Canvas.strokeStyle=x.TextColor,this.Canvas.fillStyle=x.TextColor,null!=x.Message[0]&&o){var R=0;if(sa.IsNonEmptyArray(x.YOffset)){var N=x.YOffset[0];N&&sa.IsNumber(N.Offset)&&(R=N.Offset)}if(Array.isArray(x.Message[0])){if(1==this.MultiTextFormat){var w=this.CreateMulitCoordinateItem(x.Message[0],e-2,y,this.Canvas.textBaseline,x);v.push(w)}else if(3==this.MultiTextFormat){var O={Data:x.Message[0],X:e,Y:y,TextBaseLine:p,IsLeft:!0,Item:x,TextPadding:this.YTextPadding[0]};this.DrawMultiLineText(O)}}else{null!=x.Font&&(this.Canvas.font=x.Font);var b=e;if(l&&l.Width>1){var B=l.Width;l.Color?this.Canvas.strokeStyle=l.Color:this.Canvas.strokeStyle=x.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(b,L),this.Canvas.lineTo(b-B,L),this.Canvas.stroke(),b-=B}c=this.GetTextTopBottom(p,y),(!m||c&&!this.IsTextTopBottomOverlap(c,m))&&(C&&1===C.Align?(this.Canvas.textAlign="left",this.Canvas.fillText(x.Message[0],this.YTextPadding[0],y+R)):(this.Canvas.textAlign="right",this.Canvas.fillText(x.Message[0],b-this.YTextPadding[0],y+R),m=c))}}if(null!=x.Message[1]&&s){R=0;if(sa.IsNonEmptyArray(x.YOffset)){N=x.YOffset[1];N&&sa.IsNumber(N.Offset)&&(R=N.Offset)}null!=x.Font&&(this.Canvas.font=x.Font);b=a;if(3==x.LineType){B=this.ShortYLineLength*F();this.Canvas.beginPath(),this.Canvas.moveTo(b,L),this.Canvas.lineTo(b+B,L),this.Canvas.stroke(),b+=B}if(h&&h.Width>1){B=h.Width;h.Color?this.Canvas.strokeStyle=h.Color:this.Canvas.strokeStyle=x.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(b,L),this.Canvas.lineTo(b+B,L),this.Canvas.stroke(),b+=B+2}if(this.Canvas.textAlign="left",Array.isArray(x.Message[1]))if(1==this.MultiTextFormat){w=this.CreateMulitCoordinateItem(x.Message[1],b+2,y,this.Canvas.textBaseline,x);T.push(w)}else if(2==this.MultiTextFormat){this.Canvas.fillText(x.Message[1][0],b+this.YTextPadding[1],y);var P=this.Canvas.measureText("M").width;S>2*P&&this.Canvas.fillText(x.Message[1][1],b+this.YTextPadding[1],y+P)}else if(3==this.MultiTextFormat){O={Data:x.Message[1],X:b,Y:y,TextBaseLine:p,IsLeft:!1,Item:x,TextPadding:this.YTextPadding[1]};this.DrawMultiLineText(O)}else{var G=x.Message[1][0];if(x.TextColor2&&(this.Canvas.fillStyle=x.TextColor2),u&&2===u.Align&&this.YRightTextInfo){this.Canvas.textAlign="right";var V=this.YRightTextInfo.MainTextWidth+a-this.YTextPadding[1];this.Canvas.fillText(G,V,y)}else this.Canvas.fillText(G,b+this.YTextPadding[1],y)}else if(f=this.GetTextTopBottom(p,y),!D||f&&!this.IsTextTopBottomOverlap(f,D)){if(x.TextColor2&&(this.Canvas.fillStyle=x.TextColor2),u&&2===u.Align&&this.YRightTextInfo){this.Canvas.textAlign="right";V=this.YRightTextInfo.MainTextWidth+a-this.YTextPadding[1];this.Canvas.fillText(x.Message[1],V,y+R)}else this.Canvas.fillText(x.Message[1],b+this.YTextPadding[1],y+R);D=f}}d=E}}}if(sa.IsNonEmptyArray(v)&&1==this.MultiTextFormat&&this.DrawMultiCoordinateLeftText(v),sa.IsNonEmptyArray(T)&&1==this.MultiTextFormat&&this.DrawMultiCoordinateRightText(T),s&&this.IsDrawRightBorder&&this.YRightTextInfo){V=this.YRightTextInfo.MainTextWidth+a;if(xLine=A(V),this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(xLine,r),this.Canvas.lineTo(xLine,i),this.Canvas.stroke(),sa.IsNonEmptyArray(this.YRightTextInfo.AryOverlayWidth)){this.Canvas.beginPath();for(g=0;g<this.YRightTextInfo.AryOverlayWidth.length;++g){var H=this.YRightTextInfo.AryOverlayWidth[g];V+=H,xLine=A(V),this.Canvas.moveTo(xLine,r),this.Canvas.lineTo(xLine,i)}this.Canvas.stroke()}}}},this.CreateMulitCoordinateItem=function(t,e,a,i,r){for(var n={AryText:[],X:e,Y:a,TextBaseline:i,Item:r},o=0;o<t.length;++o){var s=t[o];s.Font&&(this.Canvas.font=s.Font);var h=0;s.Text&&(h=this.Canvas.measureText(s.Text).width),n.AryText.push({Width:h,Item:s})}return n},this.GetMulitCoordinateItemTextWidth=function(t){for(var e=0,a=0;a<t.length;++a){var i=t[a];i.Font&&(this.Canvas.font=i.Font);var r=this.Canvas.measureText(i.Text).width;e+=r}return e},this.DrawMultiLineText=function(t){var e=this.Canvas.measureText("擎").width,a=t.Data.length,i=e*a+2*(a-1),r=t.Y;if(null!=t.Item.Font&&(this.Canvas.font=t.Item.Font),t.IsLeft){this.Canvas.textAlign="right";var n=t.X-t.TextPadding}else{this.Canvas.textAlign="left";n=t.X+t.TextPadding}var o=this.Canvas.textBaseline;this.Canvas.textBaseline="top",1==t.TextBaseLine?r-=i/2:0==t.TextBaseLine||2==t.TextBaseLine&&(r-=i);for(var s=0;s<t.Data.length;++s){var h=t.Data[s],l=h.Text,u=null;h.Color&&(u=this.Canvas.fillStyle,this.Canvas.fillStyle=h.Color),this.Canvas.fillText(l,n,r),r+=e+2,u&&(this.Canvas.fillStyle=u)}this.Canvas.textBaseline=o},this.IsTextTopBottomOverlap=function(t,e){return e.Top>=t.Top&&e.Top<=t.Bottom||e.Bottom>=t.Top&&e.Bottom<=t.Bottom},this.GetTextTopBottom=function(t,e){var a=null,i=this.Canvas.measureText("擎").width;return 0==t?a={Top:e,Bottom:e+i}:1==t?(a={Top:e-i/2},a.Bottom=a.Top+i):2==t&&(a={Bottom:e},a.Top=a.Bottom-i),a},this.DrawMultiCoordinateLeftText=function(t){for(var e=[],a=0,i=0;a<t.length;++a){var r=t[a];for(i=0;i<r.AryText.length;++i){var n=r.AryText[i];(!sa.IsNumber(e[i])||e[i]<n.Width)&&(e[i]=n.Width)}}this.Canvas.textAlign="right";for(a=0;a<t.length;++a){r=t[a];var o=r.Item,s=r.X;this.Canvas.textBaseline=r.TextBaseline;for(i=0;i<r.AryText.length;++i){n=r.AryText[i];var h=n.Item;h&&h.Text&&(h.Font?this.Canvas.font=h.Font:o.Font&&(this.Canvas.font=o.Font),h.Color?this.Canvas.fillStyle=h.Color:this.Canvas.fillStyle=o.TextColor,this.Canvas.fillText(h.Text,s,r.Y)),s-=e[i]}}},this.DrawMultiCoordinateRightText=function(t){for(var e=[],a=0,i=0;a<t.length;++a){var r=t[a];for(i=0;i<r.AryText.length;++i){var n=r.AryText[i];(!sa.IsNumber(e[i])||e[i]<n.Width)&&(e[i]=n.Width)}}this.Canvas.textAlign="right";for(a=0;a<t.length;++a){r=t[a];var o=r.Item,s=r.X;this.Canvas.textBaseline=r.TextBaseline;for(i=0;i<r.AryText.length;++i){n=r.AryText[i];var h=n.Item;h&&h.Text&&(h.Font?this.Canvas.font=h.Font:o.Font&&(this.Canvas.font=o.Font),h.Color?this.Canvas.fillStyle=h.Color:this.Canvas.fillStyle=o.TextColor,s+=e[i],this.Canvas.fillText(h.Text,s,r.Y))}}},this.DrawInsideClientHorizontal=function(){var t=this.GetBorder();if(t.DayBorder&&sa.IsNonEmptyArray(t.DayBorder))var e=t.DayBorder[0],a=e.LeftEx,i=(e=t.DayBorder[t.DayBorder.length-1],e.RightEx),r=t.Bottom,n=t.TopTitle;else a=t.LeftEx,i=t.RightEx,r=t.Bottom,n=t.TopTitle;for(var o=F(),s=null,h=null,l=this.HorizontalInfo.length-1;l>=0;--l){e=this.HorizontalInfo[l];var u=this.GetYFromData(e.Value);if(!(null!=u&&null!=s&&Math.abs(u-s)<this.MinYDistance)){if(e.Message[2]){null!=e.Font&&(this.Canvas.font=e.Font),this.Canvas.fillStyle=e.TextColor,this.Canvas.textAlign="left";var C=u;u>=r-2?this.Canvas.textBaseline="bottom":u<=n+2?(this.Canvas.textBaseline="top",C+=this.YTextTopOffset):this.Canvas.textBaseline="middle";var D=0;if(sa.IsNonEmptyArray(e.YOffset)){var f=e.YOffset[2];f&&sa.IsNumber(f.Offset)&&(D=f.Offset)}var c={X:a,Y:C+D,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:e.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(c)||(this.Canvas.fillText(e.Message[2],a+1*o,C+D),(null==h||h>C)&&(this.YInsideOffset=this.Canvas.measureText(e.Message[2]).width+4*F(),h=C))}if(e.Message[3]){null!=e.Font&&(this.Canvas.font=e.Font),this.Canvas.fillStyle=e.TextColor,this.Canvas.textAlign="right";C=u;u>=r-2?this.Canvas.textBaseline="bottom":u<=n+2?(this.Canvas.textBaseline="top",C+=this.YTextTopOffset):this.Canvas.textBaseline="middle";D=0;if(sa.IsNonEmptyArray(e.YOffset)){f=e.YOffset[3];f&&sa.IsNumber(f.Offset)&&(D=f.Offset)}var m=this.Canvas.measureText(e.Message[3]).width;c={X:i-m,Y:C+D,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:e.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(c)||this.Canvas.fillText(e.Message[3],i-1*o,C+D)}s=u}}},this.DrawInsideHorizontal=function(){if(!0!==this.IsHScreen&&!this.IsMinSize&&!this.ChartBorder.IsShowTitleOnly&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){this.DrawInsideClientHorizontal();var t=this.ChartBorder.GetBorder(),e=t.Left,a=t.Right,i=t.Bottom,r=t.TopTitle,n=this.ChartBorder.Right,o=this.ChartBorder.Left,s=(this.ChartBorder.TitleHeight,(o<10||2==this.YTextPosition[0])&&!0===this.IsShowYText[0]),h=(n<10||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(s||h)for(var l=F(),u=null,C=null,D=this.HorizontalInfo.length-1;D>=0;--D){var f=this.HorizontalInfo[D],c=this.GetYFromData(f.Value);if(!(null!=c&&null!=u&&Math.abs(c-u)<this.MinYDistance)){if(null!=f.Message[0]&&s){null!=f.Font&&(this.Canvas.font=f.Font),this.Canvas.fillStyle=f.TextColor,this.Canvas.textAlign="left";var m=this.Canvas.measureText("擎").width,d=c;c>=i-2?this.Canvas.textBaseline="bottom":c-m/2<=r?(this.Canvas.textBaseline="top",d+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle";var I=0;if(sa.IsNonEmptyArray(f.YOffset)){var S=f.YOffset[0];S&&sa.IsNumber(S.Offset)&&(I=S.Offset)}var T={X:e,Y:d+I,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:f.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(T)||(this.Canvas.fillText(f.Message[0],e+1*l,d+I),(null==C||C>d)&&(this.YInsideOffset=this.Canvas.measureText(f.Message[0]).width+4*F(),C=d))}if(null!=f.Message[1]&&h){null!=f.Font&&(this.Canvas.font=f.Font),this.Canvas.fillStyle=f.TextColor,this.Canvas.textAlign="right";m=this.Canvas.measureText("擎").width,d=c;if(c>=i-2?this.Canvas.textBaseline="bottom":c-m/2<=r?(this.Canvas.textBaseline="top",d+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle",Array.isArray(f.Message[1]))var v=f.Message[1][0];else v=f.Message[1];I=0;if(sa.IsNonEmptyArray(f.YOffset)){S=f.YOffset[1];S&&sa.IsNumber(S.Offset)&&(I=S.Offset)}var p=this.Canvas.measureText(v).width;T={X:a-p,Y:d+I,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:f.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(T)||this.Canvas.fillText(v,a-1*l,d+I)}u=c}}}},this.GetXFromIndex=function(t){var e=this.XPointCount;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.DrawVertical=function(){var t=this.GetBorder(),e=t.TopTitle,a=t.Bottom,i=t.RightEx,r=F(),n=null;this.GetVerticalXCache&&(n=this.GetVerticalXCache());var o=null;this.XTextExtend&&(o=this.XTextExtend[0]);var s=null;this.XLineExtend&&(s=this.XLineExtend[0]);for(var h=null,l=null,u=0;u<this.VerticalInfo.length;++u){var C=this.VerticalInfo[u],D=null;if(D=n&&n.has(C.Value)?n.get(C.Value):this.GetXFromIndex(C.Value),D>i)break;if(!(null!=h&&Math.abs(D-h)<this.MinXDistance)){C=this.VerticalInfo[u];var f=A(D);if(this.IsShowXLine&&(2==C.LineType?(this.Canvas.strokeStyle=this.VerticalInfo[u].LineColor,C.LineDash?this.Canvas.setLineDash(C.LineDash):this.Canvas.setLineDash([5*r,5*r]),this.Canvas.beginPath(),this.Canvas.moveTo(f,e),this.Canvas.lineTo(f,a),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==C.LineType||C.LineType>0&&(qi.FrameXLineDash?(this.Canvas.strokeStyle=this.VerticalInfo[u].LineColor,this.Canvas.setLineDash(qi.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(f,e),this.Canvas.lineTo(f,a),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.strokeStyle=this.VerticalInfo[u].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(f,e),this.Canvas.lineTo(f,a),this.Canvas.stroke()))),C.BG&&this.DrawDayVertical&&this.DrawDayVertical(C,D,t),null!=this.VerticalInfo[u].Message[0]&&this.ChartBorder.Bottom>5*r){this.VerticalInfo[u].Font&&(this.Canvas.font=this.VerticalInfo[u].Font);var c=0;this.Canvas.strokeStyle=C.TextColor;var m=this.Canvas.measureText(this.VerticalInfo[u].Message[0]).width,d=this.Canvas.measureText("擎").width;if(o&&1==o.Align||D<m/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",c=D):D+m/2>=this.ChartBorder.GetChartWidth()?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",c=D-m):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",c=D-m/2),null==l||c>l){var I=a;if(3==C.LineType){var S=this.ShortXLineLength*r;this.Canvas.beginPath(),this.Canvas.moveTo(f,I),this.Canvas.lineTo(f,I+S),this.Canvas.stroke(),I+=S+2*r}if(s)if(1===s.Mode)C.Value>1&&(s.Color&&(this.Canvas.strokeStyle=s.Color),this.Canvas.beginPath(),this.Canvas.moveTo(f,a),this.Canvas.lineTo(f,t.ChartHeight),this.Canvas.stroke(),D+=1);else if(2===s.Mode&&s.Width>=1){S=s.Width;s.Color&&(this.Canvas.strokeStyle=s.Color),this.Canvas.beginPath(),this.Canvas.moveTo(f,I),this.Canvas.lineTo(f,I+S),this.Canvas.stroke(),I+=S+2}if(C.TextBGColor){var T={Left:c,Top:I+this.XBottomOffset,Width:m,Height:d};this.Canvas.fillStyle=C.TextBGColor,this.Canvas.fillRect(T.Left-1,T.Top,T.Width+2,T.Height)}this.Canvas.fillStyle=C.TextColor,this.Canvas.fillText(this.VerticalInfo[u].Message[0],D,I+this.XBottomOffset),l=c+m}}h=D}}},this.GetYData=function(t,e){return this.Logarithmic&&this.GetYLogarithmicFromData?this.GetYLogarithmicData(t):1==this.CoordinateType?0==e?(t-this.ChartBorder.GetTopEx())/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:t<this.ChartBorder.GetTopEx()?this.HorizontalMin:t>this.ChartBorder.GetBottomEx()?this.HorizontalMax:(t-this.ChartBorder.GetTopEx())/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:0==e?(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:t<this.ChartBorder.GetTopEx()?this.HorizontalMax:t>this.ChartBorder.GetBottomEx()?this.HorizontalMin:(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawPictureXCoordinate=function(t,e,a){if(!this.IsHScreen&&e&&sa.IsNonEmptyArray(e.Points)){var i=this.GetBorder(),r=i.Left,n=i.Right;this.Canvas.font=this.DrawPicture.Font;var o=this.GetFontHeight();if(this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",e.X){var s=e.X,h=s.Min.X,l=s.Max.X;h<r&&(h=r),l>n&&(l=n),this.Canvas.fillStyle=this.DrawPicture.BGColor,this.Canvas.fillRect(h,i.Bottom,l-h,o)}for(var u=0;u<e.Points.length;++u){var C=e.Points[u];if(!(C.X<r||C.X>n)){var D=this.GetXData(C.X,!1),f=(D=Math.round(D),this.GetKItem(D));if(f){var c=sa.FormatDateString(f.Date,null);dt.IsMinutePeriod(a.Period)?c+=" "+sa.FormatTimeString(f.Time,"HH:MM"):dt.IsMilliSecondPeriod(a.Period)&&(c+=" "+sa.FormatTimeString(f.Time,"HH:MM:SS.fff"));var m=this.Canvas.measureText(c).width+2,d=C.X-m/2;d<r&&(d=r),this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(d,i.Bottom,m,o),this.Canvas.fillStyle=this.DrawPicture.TextColor;var I=i.Bottom+o;this.Canvas.fillText(c,d+1,I)}}}}},this.GetKItem=function(t){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;var e=this.Data.DataOffset+t;return this.Data.Data[e]},this.DrawPictureYCoordinate=function(t,e,a){if(!this.IsHScreen&&e&&sa.IsNonEmptyArray(e.Points)){var i=this.GetBorder(),r=i.TopEx,n=i.BottomEx,o=i.Right;this.Canvas.font=this.DrawPicture.Font;var s=this.GetFontHeight();this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var h=2;a&&a.Symbol&&(h=Jr(a.Symbol));for(var l=0,u=0;u<e.Points.length;++u){var C=e.Points[u],D=this.GetYData(C.Y),f=D.toFixed(h),c=this.Canvas.measureText(f).width;l<c&&(l=c),e.Points[u].Text=f}if(l+=this.YTextPadding[1]+2,e.Y){var m=e.Y,d=m.Min.Y,I=m.Max.Y;m.Min.Y<r&&(d=r),m.Max.Y>n&&(I=n),this.Canvas.fillStyle=this.DrawPicture.BGColor,this.Canvas.fillRect(o,d,l+5,I-d)}for(u=0;u<e.Points.length;++u){C=e.Points[u];if(!(C.Y<r||C.Y>n)){this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(o,C.Y-s/2,l,s),this.Canvas.fillStyle=this.DrawPicture.TextColor;var S=C.Y+s/2;this.Canvas.fillText(C.Text,o+this.YTextPadding[1],S)}}}},this.DrawPicturePointYCoordinate=function(t,e){if(!this.IsHScreen&&t.GetYCoordinatePoint){var a=t.GetYCoordinatePoint();if(sa.IsNonEmptyArray(a)){var i=this.GetBorder(),r=i.TopEx,n=i.BottomEx,o=i.Right;this.Canvas.font=this.DrawPicture.Font;var s=this.GetFontHeight();this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var h=2;e&&e.Symbol&&(h=Jr(e.Symbol));for(var l=0;l<a.length;++l){var u=a[l];if(u&&!(u.Y<r||u.Y>n)){var C=u.YValue.toFixed(h),D=this.Canvas.measureText(C).width+2;D+=this.YTextPadding[1],this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(o,u.Y-s/2,D,s),this.Canvas.fillStyle=this.DrawPicture.TextColor;var f=u.Y+s/2;this.Canvas.fillText(C,o+this.YTextPadding[1],f)}}}}},this.GetCustomItemTextInfo=function(t,e,a){var i=e?t.Message[0]:t.Message[1],r=[],n=0;if(Array.isArray(i)){for(var o=0;o<i.length;++o){t=i[o];if(1===t.Type)r.push({Type:t.Type});else{var s=this.Canvas.measureText(i[o].Text).width;s>n&&(n=s);var h={Text:i[o].Text,Width:s+2*a};t.TextColor&&(h.TextColor=t.TextColor),t.BGColor&&(h.BGColor=t.BGColor),sa.IsBool(t.EnableBGColor)&&(h.EnableBGColor=t.EnableBGColor),r.push(h)}}n>0&&(n+=2*a)}else n=this.Canvas.measureText(i).width+2*a,r.push({Text:i,Width:n});return{MaxWidth:n,Text:r}},this.DrawOutRangeCustomItem=function(t,e){if(!0!==this.IsHScreen&&(this.IsShow||this.IsYDrawMainFrame)&&(t.Message[1]||t.Message[0])&&t.OutRange){var a=0;if(t.Value>this.HorizontalMax)a=1;else{if(!(t.Value<this.HorizontalMin))return;a=2}this.Canvas.save();var i=t.OutRange,r=this.GetBorder(),n=r.Left,o=r.Right,s=(r.Bottom,r.Top,this.ChartBorder.Right),h=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(h=this.ChartBorder.Top,s=this.ChartBorder.Bottom,r.Top,r.Bottom);var l=F(),u=18*l,C=u;if(t.Message[0]&&h>=10){null!=t.Font&&(this.Canvas.font=t.Font);var D=this.GetCustomItemTextInfo(t,!0,l),f=D.MaxWidth,c=n-f,m=this.GetFontHeight();C=m>u?m:u;this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";var d=null;1==a?(d=r.TopEx,sa.IsNumber(i.TopYOffset)&&(d+=i.TopYOffset)):2==a&&(d=r.BottomEx+C,sa.IsNumber(i.BottomYOffset)&&(d+=i.BottomYOffset));for(var I=0;I<D.Text.length;++I){var S=D.Text[I],T={Left:c,Width:S.Width,Bottom:d,Height:C};if(T.Top=T.Bottom-T.Height,T.Right=T.Left+T.Width,t.ExtendLine&&t.ExtendLine[0]){var v=t.ExtendLine[0];if(sa.IsNumber(v.Width)){var p=T.Bottom;2==a&&(p=T.Top);var g=t.LineType;sa.IsNumber(i.ExtendLine.Type)&&(g=i.ExtendLine.Type),0==I&&this.DrawLine(n,n-v.Width,p,t.LineColor,g,t),T.Left-=v.Width,T.Right-=v.Width}}this.Canvas.fillStyle=i.BGColor,this.Canvas.fillRect(T.Left,T.Top,T.Width,T.Height),i.Border&&i.Border.Color&&(sa.IsNonEmptyArray(i.Border.LineDash)&&this.Canvas.setLineDash(i.Border.LineDash),this.Canvas.strokeStyle=i.Border.Color,this.Canvas.strokeRect(A(T.Left),A(T.Top),b(T.Width),b(T.Height))),this.Canvas.fillStyle=i.TextColor,this.Canvas.fillText(S.Text,T.Right-1*l,T.Top+T.Height/2+1*l),d+=C+1}}else if(t.Message[1]&&s>=10){null!=t.Font&&(this.Canvas.font=t.Font);D=this.GetCustomItemTextInfo(t,!1,l),f=D.MaxWidth;var x=o+f;m=this.GetFontHeight(),C=m>u?m:u;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";d=null;1==a?(d=r.TopEx,sa.IsNumber(i.TopYOffset)&&(d+=i.TopYOffset)):2==a&&(d=r.BottomEx+C,sa.IsNumber(i.BottomYOffset)&&(d+=i.BottomYOffset));for(I=0;I<D.Text.length;++I){S=D.Text[I],T={Right:x,Width:S.Width,Bottom:d,Height:C};if(T.Top=T.Bottom-T.Height,T.Left=T.Right-T.Width,t.ExtendLine&&t.ExtendLine[1]){v=t.ExtendLine[1];if(sa.IsNumber(v.Width)){p=T.Bottom;2==a&&(p=T.Top);g=t.LineType;sa.IsNumber(i.ExtendLine.Type)&&(g=i.ExtendLine.Type),0==I&&this.DrawLine(o,o+v.Width,p,t.LineColor,g,t),T.Left+=v.Width,T.Right+=v.Width}}this.Canvas.fillStyle=i.BGColor,this.Canvas.fillRect(T.Left,T.Top,T.Width,T.Height),i.Border&&i.Border.Color&&(sa.IsNonEmptyArray(i.Border.LineDash)&&this.Canvas.setLineDash(i.Border.LineDash),this.Canvas.strokeStyle=i.Border.Color,this.Canvas.strokeRect(A(T.Left),A(T.Top),b(T.Width),b(T.Height))),this.Canvas.fillStyle=i.TextColor,this.Canvas.fillText(S.Text,T.Left+1*l,T.Top+T.Height/2+1*l),d+=C+1}}this.Canvas.restore()}},this.DrawCustomItem=function(t,e){if(t.Message[1]||t.Message[0]){if(t.Value>this.HorizontalMax||t.Value<this.HorizontalMin)return this.DrawOutRangeCustomItem(t,e),void this.SendDrawCountDownEvent({IsShow:!1});var a=this.GetBorder(),i=a.Left,r=a.Right,n=a.Bottom,o=a.Top,s=this.ChartBorder.Right,h=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(h=this.ChartBorder.Top,s=this.ChartBorder.Bottom,o=a.Top,n=a.Bottom);var l,u=F(),C=5*u,D=C;l="TopEx"==t.Value?a.TopEx:"TopTitle"==t.Value?a.TopTitle:"Top"==t.Value?a.Top:"BottomEx"==t.Value?a.BottomEx:"Bottom"==t.Value?a.Bottom:this.GetYFromData(t.Value),sa.IsNumber(t.YOffset)&&(l+=t.YOffset);var f,c=0;if(t.ExtendData&&t.ExtendData.Custom){var m=t.ExtendData.Custom;sa.IsNumber(m.Position)&&(c=m.Position),m.EmptyBGColor&&(f=m.EmptyBGColor)}if(t.Message[0])if(h<10||1==c||2==c){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var d=this.GetCustomItemTextInfo(t,!0,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;var T=t.LineColor,v=this.RGBToStruct(t.LineColor);v&&(T="rgba(".concat(v.R,", ").concat(v.G,", ").concat(v.B,", ").concat(qi.FrameLatestPrice.BGAlpha,")")),t.BGColor&&(T=t.BGColor);for(var p=l,g=0;g<d.Text.length;++g){var x=d.Text[g];if(this.IsHScreen){var E=o,L=p-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(E+x.Width,n,p,t.LineColor,t.LineType,t),p-=D+1*u}else if(1===x.Type);else{2==c&&(i=a.LeftEx-d.MaxWidth);E=p-D/2-1*u,L=i+1*u;if(t.ExtendLine&&t.ExtendLine[0]&&2==c){var M=t.ExtendLine[0];if(sa.IsNumber(M.Width)){var y=t.LineType;if(sa.IsNumber(M.Type)&&(y=M.Type),0==g){var R=a.LeftEx-M.Width;this.DrawLine(R,R+M.Width,l,t.LineColor,y,t)}L-=M.Width}}this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,x.Width,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L+1*u,p),0==g&&(2==c?this.DrawLine(a.LeftEx,r,p,t.LineColor,t.LineType,t):this.DrawLine(L+x.Width,r,p,t.LineColor,t.LineType,t)),t.ClickData&&this.AddHorizontalLabel(L,E,x.Width,D,t,g),p+=D+1*u}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";d=this.GetCustomItemTextInfo(t,!0,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;for(p=l,g=0;g<d.Text.length;++g){x=d.Text[g];if(this.IsHScreen){if(0==g)E=o-x.Width;else E=o-I;L=p-D/2-1*u;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(E+x.Width,n,p,t.LineColor,t.LineType,t),p-=D+1*u}else{E=p-D/2-1*u;if(0==g){var N=i-x.Width;L=i}else N=i-I,L=i-(I-x.Width);if(t.ExtendLine&&t.ExtendLine[0]){M=t.ExtendLine[0];if(sa.IsNumber(M.Width)){y=t.LineType;sa.IsNumber(M.Type)&&(y=M.Type);var w=t.LineColor;M.LineColor&&(w=M.LineColor),0==g&&this.DrawLine(i,i-M.Width,l,w,y,t),L-=M.Width,N-=M.Width}}if(f)this.Canvas.fillStyle=f,this.Canvas.fillRect(N-1,E,x.Width+1,D),this.Canvas.strokeStyle=t.LineColor,this.Canvas.strokeRect(A(N-1),A(E),A(x.Width+1),A(D)),this.Canvas.fillStyle=t.LineColor,this.Canvas.fillText(x.Text,L-1*u,p);else{if(!1!==x.EnableBGColor){var O=t.LineColor;x.BGColor&&(O=x.BGColor),this.Canvas.fillStyle=O,this.Canvas.fillRect(N,E,x.Width,D)}this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L-1*u,p)}0==g&&this.DrawLine(i,r,p,t.LineColor,t.LineType,t),t.ClickData&&this.AddHorizontalLabel(L,E,x.Width,D,t,g),p+=D+1*u}}}else if(t.Message[1])if(s<10||1==c){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";d=this.GetCustomItemTextInfo(t,!1,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;T=t.LineColor,v=this.RGBToStruct(t.LineColor);v&&(T="rgba(".concat(v.R,", ").concat(v.G,", ").concat(v.B,", ").concat(qi.FrameLatestPrice.BGAlpha,")"));for(p=l,g=0;g<d.Text.length;++g){x=d.Text[g];if(this.IsHScreen){E=n-x.Width,L=p-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(o,E,p,t.LineColor,t.LineType,t),p-=D+1*u}else if(1===x.Type){if(this.GetEventCallback){E=p-D/2-1*u;var B={Top:E,Right:r,Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,PixelTatio:u,Position:"Right",IsInside:!0};this.SendDrawCountDownEvent(B)&&sa.IsPlusNumber(B.Height)&&(p+=D+1*u)}}else{E=p-D/2-1*u,L=r-x.Width;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,x.Width,D),x.TextColor?this.Canvas.fillStyle=x.TextColor:this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L+1*u,p),0==g&&this.DrawLine(i,L,p,t.LineColor,t.LineType,t),p+=D+1*u}}if((3==t.Type||4==t.Type)&&t.Title){var P=this.Canvas.measureText(t.Title).width+2*u;if(this.IsHScreen){E=n-x.Width-P,L=l-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,P),this.DrawHScreenText({X:l,Y:E},{Text:t.Title,Color:t.TextColor,XOffset:1*u,YOffset:2*u})}else{E=l-D/2-1*u,L=r-I-P-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,P,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,L+1*u,l)}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";d=this.GetCustomItemTextInfo(t,!1,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;var G=null;e&&e.has(3)&&(G=e.get(3));p=l;var _={};for(g=0;g<d.Text.length;++g){x=d.Text[g];if(this.IsHScreen){E=n,L=p-D/2-1*u;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(o,E,p,t.LineColor,t.LineType,t),p-=D+1*u}else if(1===x.Type){if(this.GetEventCallback){E=p-D/2-1*u,B={Top:E,Left:r,Right:this.ChartBorder.GetChartWidth(),Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,PixelTatio:u,Position:"Right",IsInside:!1};this.SendDrawCountDownEvent(B)&&sa.IsPlusNumber(B.Height)&&(p+=D+1*u)}}else{E=p-D/2-1*u;if(0==g&&0==d.Text.length){L=r;_.Left=L,G&&E<G.Rect.Bottom&&(p=G.Rect.Bottom,E=p-D/2-1*u)}else L=r+I-x.Width;if(t.ExtendLine&&t.ExtendLine[1]){M=t.ExtendLine[1];if(sa.IsNumber(M.Width)){y=t.LineType;sa.IsNumber(M.Type)&&(y=M.Type),0==g&&this.DrawLine(r,L+M.Width,l,t.LineColor,y,t),L+=M.Width}}f?(this.Canvas.fillStyle=f,this.Canvas.fillRect(L,E,x.Width+1,D),this.Canvas.strokeStyle=t.LineColor,this.Canvas.strokeRect(A(L),A(E),b(x.Width+1),b(D)),this.Canvas.fillStyle=t.LineColor,this.Canvas.fillText(x.Text,L+2*u,p)):(this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(L,E,x.Width,D),x.TextColor?this.Canvas.fillStyle=x.TextColor:this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L+1*u,p)),0==g&&this.DrawLine(i,r,l,t.LineColor,t.LineType,t),t.ClickData&&this.AddHorizontalLabel(L,E,x.Width,D,t,g),p+=D+1*u,_.Bottom=p}}if(e&&sa.IsNumber(_.Left)&&sa.IsNumber(_.Bottom)&&e.set(3,{Rect:_,Item:t}),(3==t.Type||4==t.Type)&&t.Title){T=t.LineColor,v=this.RGBToStruct(t.LineColor);v&&(T="rgba(".concat(v.R,", ").concat(v.G,", ").concat(v.B,", ").concat(qi.FrameLatestPrice.BGAlpha,")"));P=this.Canvas.measureText(t.Title).width+2*u;if(this.IsHScreen){E=n-P,L=l-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,P),this.DrawHScreenText({X:l,Y:E},{Text:t.Title,Color:t.TextColor,XOffset:1*u,YOffset:2*u})}else{E=l-D/2-1*u,L=r-P-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,P,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,L+1*u,l)}}}}},this.AddHorizontalLabel=function(t,e,a,i,r,n){var o={Left:t,Top:e,Width:a,Height:i};o.Right=o.Left+o.Width,o.Bottom=o.Top+o.Height;var s={Rect:o,Item:r,ID:r.ClickData.ID,Args:r.ClickData.Args,LineID:n};this.HorizontalLabel.push(s)},this.DrawCustomAreaItem=function(t){if(t.AreaData&&!this.IsHScreen&&sa.IsNonEmptyArray(t.AreaData.Value)&&2==t.AreaData.Value.length){var e=Math.max(t.AreaData.Value[0],t.AreaData.Value[1]),a=Math.min(t.AreaData.Value[0],t.AreaData.Value[1]);if(!(a>=this.HorizontalMax)&&!(e<=this.HorizontalMin)){e>this.HorizontalMax&&(e=this.HorizontalMax),a<this.HorizontalMin&&(a=this.HorizontalMin);var i=this.GetBorder(),r=i.Left,n=i.Right,o=this.ChartBorder.Right,s=this.ChartBorder.Left,h=this.GetYFromData(e),l=this.GetYFromData(a);if(t.AreaData.Position.includes(0)&&s>10){var u={Left:0,Right:r-1,Top:h,Bottom:l};if(u.Height=u.Bottom-u.Top,u.Width=u.Right-u.Left,sa.IsNonEmptyArray(t.AreaData.Width)){var C=t.AreaData.Width[0];sa.IsNumber(C)&&u.Width>C&&(u.Width=C,u.Left=u.Right-u.Width)}this.Canvas.fillStyle=t.AreaData.BGColor,this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height),this.DrawCustomAreaText(u,t,0)}if(t.AreaData.Position.includes(1)&&o>10){u={Left:n+1,Top:h,Bottom:l};if(u.Height=u.Bottom-u.Top,this.YRightTextInfo&&sa.IsNumber(this.YRightTextInfo.MainTextWidth)?(u.Width=this.YRightTextInfo.MainTextWidth-1,u.Right=u.Left+u.Width):(u.Right=i.ChartWidth,u.Width=u.Right-u.Left),sa.IsNonEmptyArray(t.AreaData.Width)){C=t.AreaData.Width[1];sa.IsNumber(C)&&u.Width>C&&(u.Width=C,u.Right=u.Left+u.Width)}this.Canvas.fillStyle=t.AreaData.BGColor,this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height),this.DrawCustomAreaText(u,t,1)}}}},this.DrawCustomAreaText=function(t,e,a){null!=e.Font&&(this.Canvas.font=e.Font);var i=this.GetFontHeight();if(!(t.Height<i)){var r,n,o=F();if(0==a){if(!e.Message[0])return;this.Canvas.textAlign="right",r=e.Message[0],n=t.Right-2*o}else if(1==a){if(!e.Message[1])return;this.Canvas.textAlign="left",r=e.Message[1],n=t.Left+2*o}var s=t.Top+t.Height/2;this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e.TextColor,this.Canvas.fillText(r,n,s)}},this.SendDrawCountDownEvent=function(t){if(!this.GetEventCallback)return!1;var e=this.GetEventCallback(m.ON_DRAW_COUNTDOWN);return!(!e||!e.Callback)&&(e.Callback(e,t,this),!0)},this.DrawDotLine=function(t,e,a,i,r){var n=F();this.Canvas.save(),this.Canvas.strokeStyle=i,r&&sa.IsPlusNumber(r.LineWidth)&&(this.Canvas.lineWidth=r.LineWidth*n),r.LineDash?this.Canvas.setLineDash(r.LineDash):this.Canvas.setLineDash([5*n,5*n]),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(A(a),t),this.Canvas.lineTo(A(a),e)):(this.Canvas.moveTo(t,A(a)),this.Canvas.lineTo(e,A(a))),this.Canvas.stroke(),this.Canvas.restore()},this.DrawLine=function(t,e,a,i,r,n){if(-1!=r)if(0==r){var o=F();this.Canvas.strokeStyle=i;var s=!1;n&&sa.IsPlusNumber(n.LineWidth)&&(this.Canvas.lineWidth=n.LineWidth*o,s=!0),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(A(a),t),this.Canvas.lineTo(A(a),e)):(this.Canvas.moveTo(t,A(a)),this.Canvas.lineTo(e,A(a))),this.Canvas.stroke(),s&&(this.Canvas.lineWidth=o)}else if(3==r){var h=10*F();this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(A(a),t),this.Canvas.lineTo(A(a),t+h)):(this.Canvas.moveTo(t,A(a)),this.Canvas.lineTo(t+h,A(a))),this.Canvas.stroke()}else 1!=r&&2!=r||this.DrawDotLine(t,e,a,i,n)},this.DrawHScreenText=function(t,e){this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e.Color,this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e.Text,e.XOffset,e.YOffset),this.Canvas.restore()},this.RGBToStruct=function(t){if(/^(rgb|RGB)/.test(t)){var e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),a={};return 3!=e.length?null:(a.R=Number(e[0]),a.G=Number(e[1]),a.B=Number(e[2]),a)}return null},this.GetMulitTextMaxWidth=function(t){for(var e=null,a=0;a<t.length;++a){var i=t[a],r=i.Text;if(r){var n=this.Canvas.measureText(r).width;(null==e||e<n)&&(e=n)}}return e},this.GetScaleTextWidth=function(){this.ChartBorder.GetBorder();var t=F();if(this.IsHScreen)var e=this.ChartBorder.Top,a=(this.ChartBorder.Bottom,e>10*t&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0]),i=this.IsShowRightHorizontal();else{this.ChartBorder.Right;var r=this.ChartBorder.Left;a=r>10&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],i=this.IsShowRightHorizontal()}if(!i&&!a)return null;var n={Left:null,Right:null},o=!1;this.YSplitOperator&&1==this.YSplitOperator.CoordinateType&&(o=!0);var s=0,h=0;sa.IsNonEmptyArray(this.YLineExtend)&&(this.YLineExtend[0]&&this.YLineExtend[0].Width>1&&(s=this.YLineExtend[0].Width),this.YLineExtend[1]&&this.YLineExtend[1].Width>1&&(h=this.YLineExtend[1].Width));for(var l=0;l<this.HorizontalInfo.length;++l){var u=null,C=this.HorizontalInfo[l];if(C&&(null!=C.Font&&(this.Canvas.font=C.Font),null!=C.Message[0]&&a&&(u=Array.isArray(C.Message[0])?1==this.MultiTextFormat?this.GetMulitCoordinateItemTextWidth(C.Message[0]):this.GetMulitTextMaxWidth(C.Message[0]):this.Canvas.measureText(C.Message[0]).width,(null==n.Left||n.Left<u)&&(n.Left=u)),null!=C.Message[1]&&i)){if(null!=C.Font&&(this.Canvas.font=C.Font),Array.isArray(C.Message[1])){if(1==this.MultiTextFormat)u=this.GetMulitCoordinateItemTextWidth(C.Message[1]);else if(2==this.MultiTextFormat){u=this.Canvas.measureText(C.Message[1][0]).width;var D=this.Canvas.measureText(C.Message[1][1]).width;u<D&&(u=D)}else if(3==this.MultiTextFormat)u=this.GetMulitTextMaxWidth(C.Message[1]);else if(u=this.Canvas.measureText(C.Message[1][0]).width,o){var f=this.Canvas.measureText("-00.00%").width;f>u&&(u=f)}}else u=this.Canvas.measureText(C.Message[1]).width;(null==n.Right||n.Right<u)&&(n.Right=u)}}return sa.IsNumber(n.Right)&&(n.Right+=0),sa.IsNumber(n.Left)&&(n.Left+=this.YTextPadding[0]+s),sa.IsNumber(n.Right)&&(n.Right+=this.YTextPadding[1]+h),{TextWidth:n}},this.ClearToolbar=function(){if(this.ToolbarID){var t=document.getElementById(this.ToolbarID);t&&(this.ChartBorder.UIElement.parentNode.removeChild(t),this.ToolbarRect=null)}},this.HideToolbar=function(){if(this.ToolbarID){this.ToolbarRect=null;var t=document.getElementById(this.ToolbarID);t&&"none"!=t.style.display&&(t.style.display="none")}},this.GetMainOverlayFrame=function(){if(!this.FrameData||!this.FrameData.SubFrameItem)return null;for(var t=this.FrameData.SubFrameItem,e=null,a=null,i=0;i<t.OverlayIndex.length;++i){var r=t.OverlayIndex[i],n=r.Frame;2==n.IsShowMainFrame?a=n:1==n.IsShowMainFrame&&(e=n)}return e||a?[e,a]:null}}function z(){this.newMethod=K,this.newMethod(),delete this.newMethod,this.ClassName="MinuteFrame",this.DataWidth=1*F(),this.DistanceWidth=1*F(),this.MinuteCount=243,this.BeforeBGColor=qi.Minute.Before.BGColor,this.AfterBGColor=qi.Minute.After.BGColor,this.MultiDayBorderPen=qi.MultiDayBorderPen,this.CustomHorizontalInfo=[],this.RightFrame=null,this.ToolbarID=N(),this.ReDrawToolbar=!1,this.DayCount=1,this.ModifyIndex=qi.MinuteToolbar.ModifyIndex,this.ChangeIndex=qi.MinuteToolbar.ChangeIndex,this.CloseIndex=qi.MinuteToolbar.CloseIndex,this.MaxMinWindow=qi.MinuteToolbar.MaxMinWindow,this.TitleWindow=qi.MinuteToolbar.TitleWindow,this.ExportData=qi.MinuteToolbar.ExportData,this.OverlayIndex=qi.MinuteToolbar.OverlayIndex,this.AddIndexWindow=qi.MinuteToolbar.AddIndexWindow,this.ToolbarRect=null,this.IsShowPositionTitle=!1,this.LastCalculateStatus={Width:0,XPointCount:0},this.BeforeCloseIcon=P(qi.Minute.Before.CloseIcon),this.IsShowCloseButton=!0,this.BeforeOpenVerticalInfo=[],this.AfterCloseVerticalInfo=[],this.NightDayConfig=P(qi.Minute.NightDay),this.MinuteFrame_ReloadResource=this.ReloadResource,this.ReloadResource=function(t){this.MinuteFrame_ReloadResource(t),this.BeforeBGColor=qi.Minute.Before.BGColor,this.AfterBGColor=qi.Minute.After.BGColor,this.MultiDayBorderPen=qi.MultiDayBorderPen},this.DrawFrame=function(){this.IsMinSize||(this.SplitXYCoordinate(),this.DrawBeforeDataBG(),this.YInsideOffset=0,this.BeforeDrawXYCallback&&this.BeforeDrawXYCallback(this),this.DrawNightDayBG(),this.DrawCustomBG(),this.DrawTitleBG(),this.DrawCustomHorizontalArea(),this.DrawHorizontal(),this.DrawVertical()),1!=this.SizeChange&&1!=this.ReDrawToolbar||(this.DrawToolbar(),this.ReDrawToolbar=!1)},this.DrawCustomHorizontalArea=function(){if(!this.IsMinSize&&!this.ChartBorder.IsShowTitleOnly&&sa.IsNonEmptyArray(this.CustomHorizontalInfo))for(var t=0;t<this.CustomHorizontalInfo.length;++t){var e=this.CustomHorizontalInfo[t];5==e.Type&&this.DrawCustomAreaItem(e)}},this.SuperDrawBorder=this.DrawBorder,this.DrawBorder=function(){if(this.IsShowBorder&&!this.IsMinSize&&(this.SuperDrawBorder(),1==this.Identify)){var t=this.ChartBorder.GetBorder(),e=A(t.Left),a=A(t.Top),i=A(t.Right);this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(e,a),this.Canvas.lineTo(i,a),this.Canvas.save(),this.Canvas.lineWidth=2*F(),this.Canvas.stroke(),this.Canvas.restore()}},this.DrawVolTitle=function(t){if(Pr.IsShowMinuteVolTitle(t)&&1==this.Identify){var e=F(),a=this.ChartBorder.GetLeft()+2*e+this.YInsideOffset,i=this.ChartBorder.GetTopEx()+2*e;if(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",qi.Minute.VolBarColor||qi.Minute.VolTitleColor){qi.Minute.VolBarColor?this.Canvas.fillStyle=qi.Minute.VolBarColor:this.Canvas.fillStyle=qi.Minute.VolTitleColor;var r=this.YSplitOperator.LanguageID,n=$i.GetText("MVol-Vol",r);this.Canvas.fillText(n,a,i),a+=this.Canvas.measureText(n).width,a+=6*F()}this.IsShowPositionTitle&&(n=$i.GetText("MVol-Position",r),this.Canvas.fillStyle=qi.Minute.PositionColor,this.Canvas.fillText(n,a,i))}},this.DrawToolbar=function(){if(1!=this.ToolbarButtonStyle&&!0!==qi.IsDOMFrameToolbar&&"undefined"!=typeof $&&!(this.Identify<2)&&this.ChartBorder.UIElement){var t=document.getElementById(this.ToolbarID);if(!t||0!=this.SizeChange||0!=this.ReDrawToolbar)if(t||(t=document.createElement("div"),t.className="klineframe-toolbar",t.id=this.ToolbarID,t.oncontextmenu=function(){return!1},t.setAttribute("identify",this.Identify.toString()),this.ChartBorder.UIElement.parentNode.appendChild(t)),this.ModifyIndex||this.ChangeIndex||this.OverlayIndex||this.CloseIndex){var e=F(),a=parseInt(this.ChartBorder.UIElement.parentElement.style.width.replace("px","")),i=(parseInt(this.ChartBorder.UIElement.parentElement.style.height.replace("px","")),this.ChartBorder.GetTitleHeight()),r=a-this.ChartBorder.Right/e-100,n=this.ChartBorder.GetTop()/e;if(!this.ToolbarRect||this.ToolbarRect.Left!=r||this.ToolbarRect.Top!=n||100!=this.ToolbarRect.Width||this.ToolbarRect.Height!=i/e){this.ToolbarRect={Left:r,Top:n,Width:100,Height:i/e};var o="<span class='index_param icon iconfont icon-index_param' id='modifyindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='调整指标参数'></span><span class='index_change icon iconfont icon-change_index' id='changeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='切换指标'></span>";this.CloseIndex&&(o+="<span class='index_close icon iconfont icon-close' id='closeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='关闭指标窗口'></span>"),t.style.left=r+"px",t.style.top=n+"px",t.style.width="100px",t.style.height=i/e+"px",t.innerHTML=o;this.ChartBorder.UIElement.JSChartContainer,this.Identify;this.ModifyIndex?"function"==typeof this.ModifyIndexEvent&&$("#"+t.id+" .index_param").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},this.ModifyIndexEvent):$("#"+t.id+" .index_param").hide(),this.ChangeIndex?"function"==typeof this.ChangeIndexEvent&&$("#"+t.id+" .index_change").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!1},this.ChangeIndexEvent):$("#"+t.id+" .index_change").hide(),$("#"+t.id+" .index_close").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},(function(t){var e=t.data.Chart,a=t.data.Identify;e.RemoveIndexWindow(a)})),t.style.display="block"}}else"none"!=t.style.display&&(t.style.display="none")}},this.DrawToolbarV2=function(t,e){if(!0!==qi.IsDOMFrameToolbar&&(0==this.Identify&&this.IsShowCloseButton&&this.DrawCloseBeforeButton(t,e),!(this.ChartBorder.TitleHeight<5))){var a=[];if(0!=this.Identify&&1!=this.Identify&&(this.CloseIndex&&a.push({ID:S.CLOSE_INDEX_WINDOW,Style:this.CloseWindowButton}),this.MaxMinWindow&&a.push({ID:S.MAX_MIN_WINDOW,Style:this.MaxMinWindowButton}),this.TitleWindow&&a.push({ID:S.TITLE_WINDOW,Style:this.TitleWindowButton}),this.ExportData&&a.push({ID:S.EXPORT_DATA,Style:this.ExportDataButton}),this.OverlayIndex&&a.push({ID:S.OVERLAY_INDEX,Style:this.OverlayIndexButton}),this.ChangeIndex&&a.push({ID:S.CHANGE_INDEX,Style:this.ChangeIndexButton}),this.ModifyIndex&&a.push({ID:S.MODIFY_INDEX_PARAM,Style:this.ModifyIndexParamButton}),this.AddIndexWindow&&a.push({ID:S.ADD_INDEX_WINDOW,Style:this.AddIndexWindowButton})),sa.IsNonEmptyArray(this.CustomToolbar))for(var i=0;i<this.CustomToolbar.length;++i){var r=this.CustomToolbar[i];r.ID&&r.Style&&a.push({ID:r.ID,Style:r.Style,TooltipText:r.TooltipText,Data:r.Data})}this.DrawTitleButton(a,t,e)}},this.DrawCloseBeforeButton=function(t,e){if(0==this.Identify){var a=this.ChartBorder.GetBorder();if(!a.DayBorder&&!(this.ChartBorder.LeftExtendWidth<10)){var i={Left:a.Left,Top:a.TopEx,Width:this.BeforeCloseIcon.Size,Height:this.BeforeCloseIcon.Size};i.Right=i.Left+this.BeforeCloseIcon.Size,i.Bottom=i.Top+this.BeforeCloseIcon.Size;var r={Rect:i,Name:"集合竞价关闭按钮",ID:S.CLOSE_BEFOREOPEN_ID},n=this.BeforeCloseIcon.Color;t&&t.X>=i.Left&&t.X<i.Right&&t.Y>=i.Top&&t.Y<=i.Bottom&&(n=this.BeforeCloseIcon.MoveOnColor,e&&(e.MouseOnToolbar={Rect:i,Item:r,Frame:this,Point:{X:t.X,Y:t.Y}}));var o="".concat(this.BeforeCloseIcon.Size,"px ").concat(this.BeforeCloseIcon.Family);this.Canvas.font=o,this.Canvas.fillStyle=n,this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillText(this.BeforeCloseIcon.Text,a.Left,a.TopEx),this.Buttons.push(r)}}},this.DrawMultiDayBeforeDataBG=function(t){var e=t.DayBorder,a=A(t.Top),i=A(t.Bottom),r=i-a;this.Canvas.strokeStyle=this.MultiDayBorderPen;for(var n=0;n<e.length;++n){var o=0,s=e[n],h=A(s.Left),l=A(s.LeftEx),u=l-h;u>3&&(this.Canvas.fillStyle=this.BeforeBGColor,this.Canvas.fillRect(h,a,u,r),++o);h=A(s.RightEx),l=A(s.Right),u=l-h;u>3&&(this.Canvas.fillStyle=this.AfterBGColor,this.Canvas.fillRect(h,a,u,r),++o),2==o&&n!=e.length-1&&(this.Canvas.beginPath(),this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,i),this.Canvas.stroke())}},this.DrawCallAuctionVertical=function(t,e,a,i){if(e){var r=a.TopTitle,n=a.Bottom,o=(a.Left,a.LeftEx),s=F(),h=null,l=null;for(var u in t){var C=t[u],D=this.GetLeftExtendXFromIndex(C.Value,e);if(D>o)break;if(!(null!=h&&Math.abs(D-h)<this.MinXDistance)){var f=A(D);if(this.IsShowXLine&&(2==C.LineType?(this.Canvas.strokeStyle=C.LineColor,this.Canvas.setLineDash([5*s,5*s]),this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==C.LineType||C.LineType>0&&(qi.FrameXLineDash?(this.Canvas.strokeStyle=C.LineColor,this.Canvas.setLineDash(qi.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.strokeStyle=C.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke()))),null!=C.Message[0]&&this.ChartBorder.Bottom>5*s){null!=C.Font&&(this.Canvas.font=C.Font);var c=0;this.Canvas.fillStyle=C.TextColor,this.Canvas.strokeStyle=C.TextColor;var m=this.Canvas.measureText(C.Message[0]).width;if(D<m/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",c=D):D+m/2>=a.ChartWidth?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",c=D-m):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",c=D-m/2),null==l||c>l){var d=n;if(3==C.LineType){var I=this.ShortXLineLength*s;this.Canvas.beginPath(),this.Canvas.moveTo(f,d),this.Canvas.lineTo(f,d+I),this.Canvas.stroke(),d+=I+2*s}this.Canvas.fillText(C.Message[0],D,d+this.XBottomOffset),l=c+m}}h=D}}}},this.DrawBeforeDataBG=function(){var t=this.ChartBorder.GetBorder();if(t.DayBorder)this.DrawMultiDayBeforeDataBG(t);else if(!(this.ChartBorder.LeftExtendWidth<10&&this.ChartBorder.RightExtendWidth<10)){var e=A(t.Top),a=A(t.Bottom);if(this.Canvas.fillStyle=this.BeforeBGColor,this.ChartBorder.LeftExtendWidth>10){var i=A(t.Left),r=A(this.ChartBorder.GetLeft()),n=r-i,o=a-e;this.Canvas.fillRect(i,e,n,o),this.DrawCallAuctionVertical(this.BeforeOpenVerticalInfo,this.YSplitOperator.BeforeOpenData,t,!0)}if(this.ChartBorder.RightExtendWidth>10){this.Canvas.fillStyle=this.AfterBGColor;i=A(this.ChartBorder.GetRight()),r=A(t.Right),n=r-i,o=a-e;this.Canvas.fillRect(i,e,n,o)}}},this.DrawCustomBG=function(){if(this.HQChart&&!this.IsHScreen){var t=this.HQChart.Symbol;if(t){var e=this.GetEventCallback(m.ON_CUSTOM_MINUTE_BG);if(e&&e.Callback){var a=null;if(this.DayCount>1){if(!sa.IsNonEmptyArray(this.HQChart.DayData))return;a=[];for(var i=this.HQChart.DayData.length-1;i>=0;--i)a.push({Date:this.HQChart.DayData[i].Date,BGColor:null})}else if(1==this.DayCount){if(!sa.IsPlusNumber(this.HQChart.DataStatus.LatestDate))return;a=[{Date:this.HQChart.DataStatus.LatestDate,BGColor:null}]}if(sa.IsNonEmptyArray(a)){var r={XPointCount:this.XPointCount,DayCount:this.DayCount,MinuteCount:this.MinuteCount,AryDay:a,PreventDefault:!1};if(e.Callback(e,r,this),!r.PreventDefault){var n=this.ChartBorder.GetBorder();for(i=0;i<a.length;++i){var o=a[i];if(o.BGColor){var s=i*this.MinuteCount,h=s+this.MinuteCount-1,l=this.GetXFromIndex(s),u=this.GetXFromIndex(h),C={Left:l,Top:n.Top,Right:u,Bottom:n.Bottom};C.Width=C.Right-C.Left,C.Height=C.Bottom-C.Top,this.Canvas.fillStyle=o.BGColor,this.Canvas.fillRect(C.Left,C.Top,C.Width,C.Height)}}}}}}}},this.DrawNightDayBG=function(){if(1==this.DayCount&&this.HQChart&&this.HQChart.EnableNightDayBG){var t=this.HQChart.Symbol;if(t){var e=-1,a=this.GetEventCallback(m.ON_CUSTOM_MINUTE_NIGHT_DAY_X_INDEX);if(a&&a.Callback){var i={Symbol:t,XIndex:e,MinuteTimeStringData:_r};if(a.Callback(a,i,this),e=i.XIndex,!(e<0)){var r=this.ChartBorder.GetBorder(),n=this.GetXFromIndex(e),o={Left:r.Left,Top:r.TopEx,Right:n,Bottom:r.Bottom};if(o.Width=o.Right-o.Left,o.Height=o.Bottom-o.Top,this.Canvas.fillStyle=this.NightDayConfig.NightBGColor,this.Canvas.fillRect(o.Left,o.Top,o.Width,o.Height),0==this.Identify){this.Canvas.font=this.NightDayConfig.Font,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";for(var s=[{Title:"夜盘",Position:1,Config:this.NightDayConfig.Night},{Title:"日盘",Position:0,Config:this.NightDayConfig.Day}],h=this.Canvas.measureText("擎").width,l=0;l<s.length;++l){var u=s[l],C=$i.GetText(u.Title,this.HQChart.LanguageID),D=this.Canvas.measureText(C).width,f={Width:D+u.Config.Margin.Left+u.Config.Margin.Right,Height:h+u.Config.Margin.Top+u.Config.Margin.Bottom,Bottom:r.Bottom};f.Top=f.Bottom-f.Height,1===u.Position?(f.Right=n-1,f.Left=f.Right-f.Width):(f.Left=n+1,f.Right=f.Left+f.Width),u.Config.BGColor&&(this.Canvas.fillStyle=u.Config.BGColor,this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height)),u.Config.BorderColor&&(this.Canvas.strokeStyle=u.Config.BorderColor,this.Canvas.strokeRect(A(f.Left),A(f.Top),b(f.Width),b(f.Height))),this.Canvas.fillStyle=u.Config.Color,this.Canvas.fillText(C,f.Left+u.Config.Margin.Left,f.Bottom-u.Config.Margin.Bottom)}}}}}}},this.DrawPictureXCoordinate=function(t,e,a){if(!this.IsHScreen&&e&&sa.IsNonEmptyArray(e.Points)){var i=this.GetBorder(),r=i.Left,n=i.Right;this.Canvas.font=this.DrawPicture.Font;var o=this.GetFontHeight();if(e.X){var s=e.X,h=s.Min.X,l=s.Max.X;h<r&&(h=r),l>n&&(l=n),this.Canvas.fillStyle=this.DrawPicture.BGColor,this.Canvas.fillRect(h,i.Bottom,l-h,o)}for(var u=0;u<e.Points.length;++u){var C=e.Points[u];if(!(C.X<r||C.X>n)){var D=parseInt(this.GetXData(C.X)),f=this.GetKItem(D,a);if(f){var c=sa.FormatTimeString(f.Time,"HH:MM"),m=this.Canvas.measureText(c).width+2,d=C.X-m/2;d<r&&(d=r),this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(d,i.Bottom,m,o),this.Canvas.fillStyle=this.DrawPicture.TextColor;var I=i.Bottom+o;this.Canvas.fillText(c,d+1,I)}}}}},this.GetKItem=function(t,e){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;if(t<this.Data.Data.length)return this.Data.Data[t];var a=this.Data.Data[this.Data.Data.length-1],i=_r.GetTimeData(e.Symbol),r=t%i.length,n=i[r];return{Date:a.Date,Time:n}},this.DrawDayVertical=function(t,e,a){if(t.BG){var i=t.BG,r=this.GetXFromIndex(i.Index.Start),n=this.GetXFromIndex(i.Index.End),o=n-r,s=this.ChartBorder.Bottom;if(sa.IsNumber(i.Height)&&(s=i.Height),i.Color){this.Canvas.fillStyle=i.Color;var h={Left:r,Width:o,Top:a.Bottom,Height:s};this.Canvas.fillRect(h.Left,h.Top,h.Width,h.Height)}if(sa.IsNonEmptyArray(t.AryText)){t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="top";for(var l=a.Bottom+2,u=this.Canvas.measureText("擎").width+2,C=0,D=0;C<t.AryText.length;++C){var f=t.AryText[C],c=0,m=[];for(D=0;D<f.length;++D){var d=f[D],I=this.Canvas.measureText(d.Text).width;if(c+I>o)break;var S={Text:d.Text,Width:I,Color:d.Color,Space:d.Space};c+=I,d.Width=I,d.Space>=1&&(c+=d.Space),m.push(S)}var T=r+(o-c)/2;for(D=0;D<m.length;++D){d=m[D];if(!sa.IsNumber(d.Width))break;d.Color?this.Canvas.fillStyle=d.Color:t.TextColor&&(this.Canvas.fillStyle=t.TextColor),this.Canvas.fillText(d.Text,T,l),T+=d.Width,d.Space>=1&&(T+=d.Space)}l+=u}}}},this.SplitXYCoordinate=function(){0!=this.XYSplit?(null!=this.XSplitOperator&&this.XSplitOperator.Operator(),null!=this.YSplitOperator&&this.YSplitOperator.Operator()):this.YCustomSplit&&this.YSplitOperator&&this.YSplitOperator.CustomCoordinate&&this.YSplitOperator.CustomCoordinate()},this.GetMultiDayXFromIndex=function(t,e){var a=e.DayBorder,i=t%this.MinuteCount,r=parseInt(t/this.MinuteCount);r>=a.length&&(r=a.length-1);var n=a[r],o=this.MinuteCount-1;if(i>=o)return n.RightEx;var s=n.RightEx-n.LeftEx,h=n.LeftEx+s*i/o;return h},this.GetXFromIndex=function(t){var e=this.XPointCount-1,a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetMultiDayXFromIndex(t,a);if(1==e)return 0==t?a.LeftEx:a.RightEx;if(e<=0)return a.LeftEx;if(t>=e)return a.RightEx;var i=a.RightEx-a.LeftEx,r=a.LeftEx+i*t/e;return r},this.GetMultiDayXData=function(t,e){for(var a=e.DayBorder,i=0;i<a.length;++i){var r=a[i];if(t>=r.Left&&t<=r.Right){var n=this.MinuteCount-1,o=this.MinuteCount*i;if(t<=r.LeftEx)return 0+o;if(t>=r.RightEx)return n+o;var s=r.RightEx-r.LeftEx;return(t-r.LeftEx)*(1*n/s)+o}}},this.GetXData=function(t){var e=this.XPointCount-1;e<0&&(e=0);var a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetMultiDayXData(t,a);if(t<=a.LeftEx)return 0;if(t>=a.RightEx)return e;var i=a.RightEx-a.LeftEx;return(t-a.LeftEx)*(1*e/i)},this.DrawCustomHorizontal=function(){if(!this.IsMinSize&&!this.ChartBorder.IsShowTitleOnly)for(var t in this.CustomHorizontalInfo){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:case 10:this.DrawCustomItem(e);break}}},this.GetLeftExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetBorder();if(i.DayBorder)return this.GetLeftExtendMultiDayXFromIndex(t,e,i);var r=i.Left,n=this.ChartBorder.LeftExtendWidth,o=r+n*t/a;return o},this.GetLeftExtendMultiDayXFromIndex=function(t,e,a){var i=a.DayBorder,r=i[e.Index],n=e.TotalCount-1,o=r.Left,s=r.LeftEx,h=s-o,l=o+h*t/n;return l},this.GetLeftExtendMultiDayXData=function(t,e,a){for(var i=a.DayBorder,r=0;r<i.length;++r){var n=i[r];if(t>=n.Left&&t<=n.LeftEx){if(!e[r])return null;var o=e[r].TotalCount-1,s=n.Left,h=n.LeftEx,l=h-s,u=1*o/l*(t-s);return{DayIndex:parseInt(r),DataIndex:u}}}},this.GetLeftExtendXData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetLeftExtendMultiDayXData(t,e,a);var i=e.TotalCount-1;i<0&&(i=0);var r=a.Left,n=a.LeftEx;if(t<=r)return 0;if(t>=n)return i;var o=n-r;return 1*i/o*(t-r)},this.MoveXIndexLeft=function(t,e){if(u.Chart.Log("[MinuteFrame::MoveXIndexLeft] obj ",e),2==e.DataType){var a=e.IndexData.DayIndex,i=e.IndexData.DataIndex-t,r=-1;if(20==e.IndexData.Type)r=0;else if(10==e.IndexData.Type)r=1;else{if(30!=e.IndexData.Type)return!1;r=2}for(var n=a,o=r;n>=0;--n){for(var s=e.Data[n];o>=0;--o){var h=s[o];if(h.DayItem&&h.DayItem.Data){for(null==i&&(i=h.DayItem.Data.length-1);i>=0;--i){var l=h.DayItem.Data[i];if(l){if(10==h.Type){var C=this.MinuteCount*n+i;return e.Point.X=this.GetXFromIndex(C),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=C,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(20==h.Type){if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(30==h.Type){if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}}i=null}}o=2}return!1}if(1==e.DataType){a=e.IndexData.DayIndex,i=e.IndexData.DataIndex-t,r=-1;if(2==e.IndexData.Type)r=0;else if(1==e.IndexData.Type)r=1;else{if(3!=e.IndexData.Type)return!1;r=2}for(n=r;n>=0;--n){h=e.Data[n];if(h&&h.DayItem&&h.DayItem.Data){for(null==i&&(i=h.DayItem.Data.length-1);i>=0;--i){if(1==h.Type){var D=h.DayItem.DataOffset;l=h.DayItem.Data[i+D];if(!l)continue;C=i;return e.Point.X=this.GetXFromIndex(C),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=C,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(2==h.Type){l=h.DayItem.Data[i];if(!l)continue;if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(3==h.Type){l=h.DayItem.Data[i];if(!l)continue;if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}i=null}}}},this.MoveXIndexRight=function(t,e){if(u.Chart.Log("[MinuteFrame::MoveXIndexRight] obj ",e),2==e.DataType){var a=e.IndexData.DayIndex,i=e.IndexData.DataIndex+t,r=-1;if(20==e.IndexData.Type)r=0;else if(10==e.IndexData.Type)r=1;else{if(30!=e.IndexData.Type)return!1;r=2}for(var n=a,o=r;n<e.Data.length;++n){for(var s=e.Data[n];o<3;++o){var h=s[o];if(h.DayItem&&h.DayItem.Data){for(null==i&&(i=0);i<h.DayItem.Data.length;++i){var l=h.DayItem.Data[i];if(l){if(10==h.Type){var C=this.MinuteCount*n+i;return e.Point.X=this.GetXFromIndex(C),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=C,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(20==h.Type){if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(30==h.Type){if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}}i=null}}o=0}return!1}if(1==e.DataType){a=e.IndexData.DayIndex,i=e.IndexData.DataIndex+t,r=-1;if(2==e.IndexData.Type)r=0;else if(1==e.IndexData.Type)r=1;else{if(3!=e.IndexData.Type)return!1;r=2}for(n=r;n<e.Data.length;++n){h=e.Data[n];if(h.DayItem&&h.DayItem.Data){for(null==i&&(i=0);i<h.DayItem.Data.length;++i){if(1==h.Type){if(i>=this.XPointCount)break;var D=h.DayItem.DataOffset;l=h.DayItem.Data[i+D];if(!l)continue;C=i;return e.Point.X=this.GetXFromIndex(C),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=C,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(2==h.Type){l=h.DayItem.Data[i];if(!l)continue;if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(3==h.Type){l=h.DayItem.Data[i];if(!l)continue;if(!sa.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}i=null}}}},this.GetLeftExtendXValidData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder){var i=this.GetLeftExtendXData(t,e.Data);if(!i)return!1;var r=parseInt(i.DataIndex.toFixed(0)),n=e.Data[i.DayIndex];if(r>=0&&r<n.Data.length){var o=n.Data[r];if(sa.IsNumber(o.Price))return e.IndexData.DataIndex=r,!0}r<0?r=0:r>=n.Data.length&&(r=n.Data.length-1);for(var s=-1,h=r;h>=0;--h){o=n.Data[h];if(o&&sa.IsNumber(o.Price)){s=h;break}}return!(s<0)&&(e.IndexData.DataIndex=s,e.IndexData.Point.X=this.GetLeftExtendXFromIndex(s,n),u.Chart.Log("[MinuteFrame::GetLeftExtendXValidData] DayIndex:".concat(e.IndexData.DayIndex,", Type:").concat(e.IndexData.Type,", x:").concat(t,"=>").concat(e.IndexData.Point.X,", index:").concat(r,"=>").concat(s)),!0)}r=this.GetLeftExtendXData(t,e.Data);if(r=parseInt(r.toFixed(0)),r>=0&&r<e.Data.Data.length){o=e.Data.Data[r];if(sa.IsNumber(o.Price))return e.IndexData.DataIndex=r,!0}r<0?r=0:r>=e.Data.Data.length&&(r=e.Data.Data.length-1);for(s=-1,h=r;h>=0;--h){o=e.Data.Data[h];if(sa.IsNumber(o.Price)){s=h;break}}if(s<0)for(h=r+1;h<e.Data.Data.length;++h){o=e.Data.Data[h];if(sa.IsNumber(o.Price)){s=h;break}}return!(s<0)&&(e.IndexData.DataIndex=s,e.IndexData.Point.X=this.GetLeftExtendXFromIndex(s,e.Data),u.Chart.Log("[MinuteFrame::GetLeftExtendXValidData] DayIndex:".concat(e.IndexData.DayIndex,", Type:").concat(e.IndexData.Type,", x:").concat(t,"=>").concat(e.IndexData.Point.X,", index:").concat(r,"=>").concat(s)),!0)},this.GetRightExtendXValidData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder){var i=this.GetRightExtendXData(t,e.Data);if(!i)return!1;var r=parseInt(i.DataIndex.toFixed(0)),n=e.Data[i.DayIndex];if(r>=0&&r<n.Data.length){var o=n.Data[r];if(sa.IsNumber(o.Price))return e.IndexData.DataIndex=r,!0}r<0?r=0:r>=n.Data.length&&(r=n.Data.length-1);for(var s=-1,h=r;h>=0;--h){o=n.Data[h];if(o&&sa.IsNumber(o.Price)){s=h;break}}return!(s<0)&&(e.IndexData.DataIndex=s,e.IndexData.Point.X=this.GetRightExtendXFromIndex(s,n),u.Chart.Log("[MinuteFrame::GetRightExtendXValidData] DayIndex:".concat(e.IndexData.DayIndex,", Type:").concat(e.IndexData.Type,", x:").concat(t,"=>").concat(e.IndexData.Point.X,", index:").concat(r,"=>").concat(s)),!0)}if(!e||!e.Data)return!1;r=this.GetRightExtendXData(t,e.Data);if(r=parseInt(r.toFixed(0)),r>=0&&r<e.Data.Data.length){o=e.Data.Data[r];if(sa.IsNumber(o.Price))return e.IndexData.DataIndex=r,!0}r<0?r=0:r>=e.Data.Data.length&&(r=e.Data.Data.length-1);for(s=-1,h=r;h>=0;--h){o=e.Data.Data[h];if(sa.IsNumber(o.Price)){s=h;break}}if(s<0)for(h=r+1;h<e.Data.Data.length;++h){o=e.Data.Data[h];if(sa.IsNumber(o.Price)){s=h;break}}return!(s<0)&&(e.IndexData.DataIndex=s,e.IndexData.Point.X=this.GetRightExtendXFromIndex(s,e.Data),u.Chart.Log("[MinuteFrame::GetRightExtendXValidData] DayIndex:".concat(e.IndexData.DayIndex,", Type:").concat(e.IndexData.Type,", x:").concat(t,"=>").concat(e.IndexData.Point.X,", index:").concat(r,"=>").concat(s)),!0)},this.GetLeftExtendYFromData=function(t,e,a){if(!a||!a.Range)return this.GetYFromData(t,e);var i=a.Range,r=this.ChartBorder.GetBorder(),n=r.BottomEx-r.TopEx,o=n*(t-i.Min)/(i.Max-i.Min);return r.BottomEx-o},this.GetLeftExtendYData=function(t,e,a){if(!a||!a.Range)return this.GetYData(t,e);var i=a.Range,r=this.ChartBorder.GetBorder(),n=r.BottomEx-r.TopEx;return(r.BottomEx-t)/n*(i.Max-i.Min)+i.Min},this.GetRightExtendMultiDayXFromIndex=function(t,e,a){var i=a.DayBorder,r=i[e.Index],n=e.TotalCount-1,o=r.RightEx,s=r.Right,h=s-o,l=o+h*t/n;return l},this.GetRightExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetBorder();if(i.DayBorder)return this.GetRightExtendMultiDayXFromIndex(t,e,i);var r=i.RightEx,n=this.ChartBorder.RightExtendWidth,o=r+n*t/a;return o},this.GetRightExtendYFromData=function(t,e,a){return this.GetLeftExtendYFromData(t,e,a)},this.GetRightExtendYData=function(t,e,a){return a&&a.Range?this.GetLeftExtendYData(t,e,a):this.GetYData(t,e)},this.GetRightExtendMultiDayXData=function(t,e,a){for(var i=a.DayBorder,r=0;r<i.length;++r){var n=i[r];if(t>=n.RightEx&&t<=n.Right){if(!e[r])return null;var o=e[r].TotalCount-1,s=n.RightEx,h=n.Right,l=h-s,u=1*o/l*(t-s);return{DayIndex:parseInt(r),DataIndex:u}}}return null},this.GetRightExtendXData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetRightExtendMultiDayXData(t,e,a);var i=e.TotalCount-1;i<0&&(i=0);var r=a.RightEx,n=a.Right;if(t<=r)return 0;if(t>=n)return i;var o=n-r;return 1*i/o*(t-r)}}function J(){this.newMethod=z,this.newMethod(),delete this.newMethod,this.ClassName="MinuteHScreenFrame",this.IsHScreen=!0,this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var t=this.ChartBorder.GetHScreenBorder(),e=A(t.RightEx),a=A(t.Top),i=A(t.Bottom),r=this.ChartBorder.TitleHeight,n=i-a;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(e,a,r,n)}},this.DrawToolbar=function(){},this.DrawBeforeDataBG=function(){var t=this.ChartBorder.GetHScreenBorder();if(t.DayBorder)this.DrawMultiDayBeforeDataBG(t);else if(!(this.ChartBorder.LeftExtendWidth<10&&this.ChartBorder.RightExtendWidth<10)){var e=A(t.Left),a=A(t.Right);if(this.Canvas.fillStyle=this.BeforeBGColor,this.ChartBorder.LeftExtendWidth>10){var i=A(t.Top),r=A(t.TopEx),n=a-e,o=r-i;this.Canvas.fillRect(e,i,n,o)}if(this.ChartBorder.RightExtendWidth>10){i=t.BottomEx,r=t.Bottom,n=a-e,o=r-i;this.Canvas.fillRect(e,i,n,o)}}},this.DrawMultiDayBeforeDataBG=function(t){var e=t.DayBorder,a=A(t.Left),i=A(t.Right),r=i-a;this.Canvas.strokeStyle=this.MultiDayBorderPen;for(var n=0;n<e.length;++n){var o=0,s=e[n],h=A(s.Top),l=A(s.TopEx),u=l-h;u>3&&(this.Canvas.fillStyle=this.BeforeBGColor,this.Canvas.fillRect(a,h,r,u),++o);h=A(s.BottomEx),l=A(s.Bottom),u=l-h;u>3&&(this.Canvas.fillStyle=this.AfterBGColor,this.Canvas.fillRect(a,h,r,u),++o),2==o&&n!=e.length-1&&(this.Canvas.beginPath(),this.Canvas.moveTo(a,l),this.Canvas.lineTo(i,l),this.Canvas.stroke())}},this.GetYData=function(t){var e=this.ChartBorder.GetHScreenBorder();if(t<e.LeftEx)return this.HorizontalMin;if(t>e.RightEx)return this.HorizontalMax;var a=e.RightEx-e.LeftEx;return(t-e.LeftEx)/a*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetMultiDayXData=function(t,e){for(var a=e.DayBorder,i=0;i<a.length;++i){var r=a[i];if(t>=r.Top&&t<=r.Bottom){var n=this.MinuteCount-1,o=this.MinuteCount*i;if(t<=r.TopEx)return 0+o;if(t>=r.BottomEx)return n+o;var s=r.BottomEx-r.TopEx;return(t-r.TopEx)*(1*n/s)+o}}},this.GetXData=function(t){var e=this.XPointCount-1;e<0&&(e=0);var a=this.ChartBorder.GetHScreenBorder();if(a.DayBorder)return this.GetMultiDayXData(t,a);if(t<=a.TopEx)return 0;if(t>=a.BottomEx)return e;var i=a.BottomEx-a.TopEx;return(t-a.TopEx)*(1*e/i)},this.GetMultiDayXFromIndex=function(t,e){var a=e.DayBorder,i=t%this.MinuteCount,r=parseInt(t/this.MinuteCount);r>=a.length&&(r=a.length-1);var n=a[r],o=this.MinuteCount-1;if(i>=o)return n.BottomEx;var s=n.BottomEx-n.TopEx,h=n.TopEx+s*i/o;return h},this.GetXFromIndex=function(t){var e=this.XPointCount-1,a=this.ChartBorder.GetHScreenBorder();if(a.DayBorder)return this.GetMultiDayXFromIndex(t,a);if(1==e)return 0==t?a.TopEx:a.BottomEx;if(e<=0)return a.TopEx;if(t>=e)return a.BottomEx;var i=a.BottomEx-a.TopEx,r=a.TopEx+i*t/e;return r},this.GetYFromData=function(t){var e=this.ChartBorder.GetHScreenBorder();if(t<=this.HorizontalMin)return e.LeftEx;if(t>=this.HorizontalMax)return e.RightEx;var a=(e.RightEx-e.LeftEx)*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return e.LeftEx+a},this.DrawVolTitle=function(t){if(Pr.IsShowMinuteVolTitle(t)&&1==this.Identify){var e=F(),a=this.ChartBorder.GetRight()-2*e,i=this.ChartBorder.GetTopEx()+2*e,r=a,n=i;this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180);var o=this.YInsideOffset;if(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",qi.Minute.VolBarColor||qi.Minute.VolTitleColor){qi.Minute.VolBarColor?this.Canvas.fillStyle=qi.Minute.VolBarColor:this.Canvas.fillStyle=qi.Minute.VolTitleColor;var s=this.YSplitOperator.LanguageID,h=$i.GetText("MVol-Vol",s);this.Canvas.fillText(h,o,0),o+=this.Canvas.measureText(h).width,o+=6*F()}this.IsShowPositionTitle&&(h=$i.GetText("MVol-Position",s),this.Canvas.fillStyle=qi.Minute.PositionColor,this.Canvas.fillText(h,o,0)),this.Canvas.restore()}},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetHScreenBorder(),e=t.Top,a=t.Bottom,i=t.Left,r=t.Right,n=this.ChartBorder.Top,o=this.ChartBorder.Bottom,s=null,h=this.HorizontalInfo.length-1;h>=0;--h){var l=this.HorizontalInfo[h],u=this.GetYFromData(l.Value);if(!(null!=u&&Math.abs(u-s)<this.MinYDistance)){if(this.Canvas.strokeStyle=l.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(u),e),this.Canvas.lineTo(A(u),a),this.Canvas.stroke(),u>=r-2)this.Canvas.textBaseline="top",u=r;else if(u<=i+2){if(this.Canvas.textBaseline="bottom",u=i,null!=u&&Math.abs(u-s)<2*this.MinYDistance)continue}else this.Canvas.textBaseline="middle";if(null!=l.Message[0]&&n>10){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="right";var C=u,D=e;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[0],-2,0),this.Canvas.restore()}if(null!=l.Message[1]&&o>10){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="left";C=u,D=a;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[1],2,0),this.Canvas.restore()}s=u}}},this.DrawInsideClientHorizontal=function(){for(var t=this.GetBorder(),e=t.Left,a=t.Right,i=t.BottomEx,r=t.TopEx,n=(F(),null),o=this.HorizontalInfo.length-1;o>=0;--o){var s=this.HorizontalInfo[o];if(s&&s.Message[2]&&s.Message[3]){var h=this.GetYFromData(s.Value);if(!(null!=h&&null!=n&&Math.abs(h-n)<this.MinYDistance)){if(h>=a-2)this.Canvas.textBaseline="top",h=a;else if(h<=e+2){if(this.Canvas.textBaseline="bottom",h=e,null!=h&&Math.abs(h-n)<2*this.MinYDistance)continue}else this.Canvas.textBaseline="middle";if(s.Message[2]){null!=s.Font&&(this.Canvas.font=s.Font),this.Canvas.fillStyle=s.TextColor,this.Canvas.textAlign="left";var l=h,u=r;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s.Message[2],2,0),this.Canvas.restore()}if(s.Message[3]){null!=s.Font&&(this.Canvas.font=s.Font),this.Canvas.fillStyle=s.TextColor,this.Canvas.textAlign="right";l=h,u=i;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s.Message[3],-2,0),this.Canvas.restore()}n=h}}}},this.DrawVertical=function(){var t=this.ChartBorder.GetHScreenBorder(),e=t.Left,a=t.Right,i=t.Bottom,r=null;for(var n in this.VerticalInfo){var o=this.GetXFromIndex(this.VerticalInfo[n].Value);if(o>i)break;if(!(null!=r&&Math.abs(o-r)<this.MinXDistance)){if(this.Canvas.strokeStyle=this.VerticalInfo[n].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e,A(o)),this.Canvas.lineTo(a,A(o)),this.Canvas.stroke(),null!=this.VerticalInfo[n].Message[0]){null!=this.VerticalInfo[n].Font&&(this.Canvas.font=this.VerticalInfo[n].Font),this.Canvas.fillStyle=this.VerticalInfo[n].TextColor;var s=this.Canvas.measureText(this.VerticalInfo[n].Message[0]).width;o<s/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):o+s/2>=this.ChartBorder.GetChartHeight()?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var h=e,l=o;this.Canvas.save(),this.Canvas.translate(h,l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[n].Message[0],0,0),this.Canvas.restore()}r=o}}},this.DrawInsideHorizontal=function(){if(!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){this.DrawInsideClientHorizontal();var t=this.ChartBorder.GetHScreenBorder(),e=t.Left,a=t.RightEx,i=t.Top,r=t.Bottom,n=this.ChartBorder.Top,o=this.ChartBorder.Bottom,s=(this.ChartBorder.TitleHeight,F());if(n<10*s&&!0===this.IsShowYText[0]||o<10*s&&!0===this.IsShowYText[1]){s=F();for(var h=null,l=null,u=this.HorizontalInfo.length-1;u>=0;--u){var C=this.HorizontalInfo[u],D=this.GetYFromData(C.Value);if(!(null!=D&&null!=h&&Math.abs(D-h)<this.MinYDistance)){if(null!=C.Message[0]&&n<10*s&&!0===this.IsShowYText[0]){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=D>=a-2?"top":D<=e+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[0];var f=D,c=i;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],2*s,0),this.Canvas.restore(),(null==l||l<f)&&(this.YInsideOffset=this.Canvas.measureText(C.Message[0]).width+4*F(),l=f)}if(null!=C.Message[1]&&o<10*s&&!0===this.IsShowYText[1]){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=D>=a-2?"top":D<=e+2?"bottom":"middle";var m=this.Canvas.measureText(C.Message[1]).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[1],f=D,c=r;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[1],-2*s,0),this.Canvas.restore()}h=D}}}}},this.GetLeftExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetHScreenBorder();if(i.DayBorder)return this.GetLeftExtendMultiDayXFromIndex(t,e,i);var r=i.Top,n=this.ChartBorder.LeftExtendWidth,o=r+n*t/a;return o},this.GetLeftExtendMultiDayXFromIndex=function(t,e,a){var i=a.DayBorder,r=i[e.Index],n=e.TotalCount-1,o=r.Top,s=r.TopEx,h=s-o,l=o+h*t/n;return l},this.GetLeftExtendMultiDayXData=function(t,e,a){for(var i=a.DayBorder,r=0;r<i.length;++r){var n=i[r];if(t>=n.Top&&t<=n.TopEx){if(!e[r])return null;var o=e[r].TotalCount-1,s=n.Top,h=n.TopEx,l=h-s,u=1*o/l*(t-s);return{DayIndex:parseInt(r),DataIndex:u}}}return null},this.GetLeftExtendXData=function(t,e){var a=this.ChartBorder.GetHScreenBorder();if(a.DayBorder)return this.GetLeftExtendMultiDayXData(t,e,a);var i=e.TotalCount-1;i<0&&(i=0);var r=a.Top,n=a.TopEx;if(t<=r)return 0;if(t>=n)return i;var o=n-r;return 1*i/o*(t-r)},this.GetLeftExtendYFromData=function(t,e,a){if(!a||!a.Range)return this.GetYFromData(t,e);var i=a.Range,r=this.ChartBorder.GetHScreenBorder(),n=r.RightEx-r.LeftEx,o=n*(t-i.Min)/(i.Max-i.Min);return r.LeftEx+o},this.GetLeftExtendYData=function(t,e,a){if(!a||!a.Range)return this.GetYData(y,e);var i=a.Range,r=this.ChartBorder.GetHScreenBorder(),n=r.RightEx-r.LeftEx;return(t-r.LeftEx)/n*(i.Max-i.Min)+i.Min},this.GetRightExtendMultiDayXFromIndex=function(t,e,a){var i=a.DayBorder,r=i[e.Index],n=e.TotalCount-1,o=r.BottomEx,s=r.Bottom,h=s-o,l=o+h*t/n;return l},this.GetRightExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetHScreenBorder();if(i.DayBorder)return this.GetRightExtendMultiDayXFromIndex(t,e,i);var r=i.BottomEx,n=this.ChartBorder.RightExtendWidth,o=r+n*t/a;return o},this.GetRightExtendMultiDayXData=function(t,e,a){for(var i=a.DayBorder,r=0;r<i.length;++r){var n=i[r];if(t>=n.BottomEx&&t<=n.Bottom){if(!e[r])return null;var o=e[r].TotalCount-1,s=n.BottomEx,h=n.Bottom,l=h-s,u=1*o/l*(t-s);return{DayIndex:parseInt(r),DataIndex:u}}}return null},this.GetRightExtendXData=function(t,e){var a=this.ChartBorder.GetHScreenBorder();if(a.DayBorder)return this.GetRightExtendMultiDayXData(t,e,a);var i=e.TotalCount-1;i<0&&(i=0);var r=a.BottomEx,n=a.Bottom;if(t<=r)return 0;if(t>=n)return i;var o=n-r;return 1*i/o*(t-r)},this.GetRightExtendYFromData=function(t,e,a){return a&&a.Range?this.GetLeftExtendYFromData(t,e,a):this.GetYFromData(t,e)},this.DrawNightDayBG=function(){if(1==this.DayCount&&this.HQChart&&this.HQChart.EnableNightDayBG){var t=this.HQChart.Symbol;if(t){var e=-1,a=this.GetEventCallback(m.ON_CUSTOM_MINUTE_NIGHT_DAY_X_INDEX);if(a&&a.Callback){var i={Symbol:t,XIndex:e,MinuteTimeStringData:_r};if(a.Callback(a,i,this),e=i.XIndex,!(e<0)){var r=this.ChartBorder.GetHScreenBorder(),n=this.GetXFromIndex(e),o={Left:r.Left,Top:r.Top,Right:r.RightEx,Bottom:n};if(o.Width=o.Right-o.Left,o.Height=o.Bottom-o.Top,this.Canvas.fillStyle=this.NightDayConfig.NightBGColor,this.Canvas.fillRect(o.Left,o.Top,o.Width,o.Height),0==this.Identify){this.Canvas.font=this.NightDayConfig.Font,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";for(var s=[{Title:"夜盘",Position:1,Config:this.NightDayConfig.Night},{Title:"日盘",Position:0,Config:this.NightDayConfig.Day}],h=this.Canvas.measureText("擎").width,l=0;l<s.length;++l){var u=s[l],C=$i.GetText(u.Title,this.HQChart.LanguageID),D=this.Canvas.measureText(C).width,f={Height:D+u.Config.Margin.Left+u.Config.Margin.Right,Width:h+u.Config.Margin.Top+u.Config.Margin.Bottom,Left:r.Left};f.Right=f.Left+f.Width,1===u.Position?(f.Bottom=n-1,f.Top=f.Bottom-f.Height):(f.Top=n+1,f.Bottom=f.Top+f.Height),u.Config.BGColor&&(this.Canvas.fillStyle=u.Config.BGColor,this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height)),u.Config.BorderColor&&(this.Canvas.strokeStyle=u.Config.BorderColor,this.Canvas.strokeRect(A(f.Left),A(f.Top),b(f.Width),b(f.Height))),this.Canvas.fillStyle=u.Config.Color;var c=f.Left,d=f.Top;this.Canvas.save(),this.Canvas.translate(c,d),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C,u.Config.Margin.Left,-u.Config.Margin.Bottom),this.Canvas.restore()}}}}}}}}function Z(){this.newMethod=z,this.newMethod(),delete this.newMethod,this.ClassName="OverlayMinuteFrame",this.IsShow=!0,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.IsShowMainFrame=0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1,this.XSplit=!1,this.YCustomSplit=!1},this.DrawToolbar=function(){},this.GetScaleTextWidth=function(){return{TextWidth:0}},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY){this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[];for(var t=0;t<this.MainFrame.HorizontalInfo.length;++t){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()}}function Q(){this.newMethod=J,this.newMethod(),delete this.newMethod,this.ClassName="OverlayMinuteHScreenFrame",this.IsShow=!0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1,this.XSplit=!1,this.YCustomSplit=!1},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY)for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()}}function q(){this.newMethod=K,this.newMethod(),delete this.newMethod,this.ClassName="KLineFrame",this.ToolbarID=N(),this.ModifyIndex=qi.KLineToolbar.ModifyIndex,this.ChangeIndex=qi.KLineToolbar.ChangeIndex,this.CloseIndex=qi.KLineToolbar.CloseIndex,this.OverlayIndex=qi.KLineToolbar.OverlayIndex,this.MaxMinWindow=qi.KLineToolbar.MaxMinWindow,this.TitleWindow=qi.KLineToolbar.TitleWindow,this.ExportData=qi.KLineToolbar.ExportData,this.AddIndexWindow=qi.KLineToolbar.AddIndexWindow,this.SelBorderColor=qi.SelFrameBorderColor,this.ToolbarRect=null,this.ReDrawToolbar=!1,this.LastCalculateStatus={Width:0,XPointCount:0},this.CustomHorizontalInfo=[],this.IsDrawTitleBG=!1,this.IsShowNameArrow=!1,this.CustomVerticalInfo=[],this.DrawCustomVerticalEvent,this.RightSpaceCount=0,this.Logarithmic=null,this.CustomToolbar=[],this.ToolbarType=0,this.DrawToolbar=function(){if(1!=this.ToolbarButtonStyle&&!0!==qi.IsDOMFrameToolbar&&"undefined"!=typeof $&&this.ChartBorder.UIElement&&this.ChartBorder.UIElement.parentNode){var t=document.getElementById(this.ToolbarID);if(!t||0!=this.SizeChange||0!=this.ReDrawToolbar)if(t||(t=document.createElement("div"),t.className="klineframe-toolbar",t.id=this.ToolbarID,t.oncontextmenu=function(){return!1},t.setAttribute("identify",this.Identify.toString()),this.ChartBorder.UIElement.parentNode.appendChild(t)),this.ModifyIndex||this.ChangeIndex||this.OverlayIndex||this.CloseIndex||sa.IsNonEmptyArray(this.CustomToolbar)){var e=F(),a=parseInt(this.ChartBorder.UIElement.parentElement.style.width.replace("px","")),i=(parseInt(this.ChartBorder.UIElement.parentElement.style.height.replace("px","")),this.ChartBorder.GetTitleHeight()),r=a-this.ChartBorder.Right/e-100,n=this.ChartBorder.GetTop()/e;if(!this.ToolbarRect||this.ToolbarRect.Left!=r||this.ToolbarRect.Top!=n||100!=this.ToolbarRect.Width||this.ToolbarRect.Height!=i/e){this.ToolbarRect={Left:r,Top:n,Width:100,Height:i/e};var o="<span class='index_param icon iconfont icon-index_param' id='modifyindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='调整指标参数'></span><span class='index_change icon iconfont icon-change_index' id='changeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='切换指标'></span><span class='index_overlay icon iconfont icon-overlay_index' id='overlayindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='叠加指标'></span>";if(0!==this.Identify&&this.CloseIndex&&(o+="<span class='index_close icon iconfont icon-close' id='closeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='关闭指标窗口'></span>"),sa.IsNonEmptyArray(this.CustomToolbar))for(var s=0;s<this.CustomToolbar.length;++s){var h=this.CustomToolbar[s];o+=h.Html}t.style.left=r+"px",t.style.top=n+"px",t.style.width="100px",t.style.height=i/e+"px",t.innerHTML=o;this.ChartBorder.UIElement.JSChartContainer,this.Identify;if(this.ModifyIndex?"function"==typeof this.ModifyIndexEvent&&$("#"+t.id+" .index_param").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},this.ModifyIndexEvent):$("#"+t.id+" .index_param").hide(),this.ChangeIndex?"function"==typeof this.ChangeIndexEvent&&$("#"+t.id+" .index_change").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!1},this.ChangeIndexEvent):$("#"+t.id+" .index_change").hide(),this.OverlayIndex?$("#"+t.id+" .index_overlay").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!0},this.ChangeIndexEvent):$("#"+t.id+" .index_overlay").hide(),$("#"+t.id+" .index_close").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},(function(t){var e=t.data.Chart,a=t.data.Identify;e.RemoveIndexWindow(a)})),sa.IsNonEmptyArray(this.CustomToolbar))for(s=0;s<this.CustomToolbar.length;++s){h=this.CustomToolbar[s];$("#"+h.ID).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,ID:h.ID},h.Click)}t.style.display="block"}}else"none"!=t.style.display&&(t.style.display="none")}},this.DrawToolbarV2=function(t,e){if(!0!==qi.IsDOMFrameToolbar&&(this.Buttons=[],1!=this.IsMinSize&&!(this.ChartBorder.TitleHeight<5))){var a=[];if(this.CloseIndex&&0!==this.Identify&&a.push({ID:S.CLOSE_INDEX_WINDOW,Style:this.CloseWindowButton}),this.MaxMinWindow&&0!=this.Identify&&a.push({ID:S.MAX_MIN_WINDOW,Style:this.MaxMinWindowButton}),this.TitleWindow&&0!=this.Identify&&a.push({ID:S.TITLE_WINDOW,Style:this.TitleWindowButton}),this.ExportData&&a.push({ID:S.EXPORT_DATA,Style:this.ExportDataButton}),this.OverlayIndex&&a.push({ID:S.OVERLAY_INDEX,Style:this.OverlayIndexButton}),this.ChangeIndex&&a.push({ID:S.CHANGE_INDEX,Style:this.ChangeIndexButton}),this.ModifyIndex&&a.push({ID:S.MODIFY_INDEX_PARAM,Style:this.ModifyIndexParamButton}),this.AddIndexWindow&&a.push({ID:S.ADD_INDEX_WINDOW,Style:this.AddIndexWindowButton}),sa.IsNonEmptyArray(this.CustomToolbar))for(var i=0;i<this.CustomToolbar.length;++i){var r=this.CustomToolbar[i];if(r.ID&&r.Style){var n={ID:r.ID,Style:r.Style,TooltipText:r.TooltipText,Data:r.Data};!0===r.IsLeft||a.push(n)}}if(this.GetEventCallback){var o=this.GetEventCallback(m.ON_CUSTOM_RIGHT_TOOLBAR);if(o&&o.Callback){var s={PreventDefault:!1,DefaultButton:a,AryButton:null,FrameID:this.Identify};if(o.Callback(o,s,this),s.PreventDefault)return void this.DrawTitleButton(s.AryButton,t,e)}}this.DrawTitleButton(a,t,e)}},this.GetLeftToolbar=function(t){if(this.GetEventCallback){var e=this.GetEventCallback(m.ON_CUSTOM_LEFT_TOOLBAR);if(e&&e.Callback){var a={PreventDefault:!1,AryButton:null,FrameID:this.Identify};if(t&&(t.Overlay&&(a.Title=t.Overlay.Title),t.OverlayID&&(a.OverlayID=t.OverlayID)),e.Callback(e,a,this),a.PreventDefault)return a.AryButton}}if(!sa.IsNonEmptyArray(this.CustomToolbar))return null;for(var i=[],r=0;r<this.CustomToolbar.length;++r){var n=this.CustomToolbar[r];if(n.ID&&n.Style){var o={ID:n.ID,Style:n.Style,TooltipText:n.TooltipText,Data:n.Data};!0===n.IsLeft&&i.push(o)}}return i},this.DrawFrame=function(){this.IsMinSize||(this.SplitXYCoordinate(),1==this.SizeChange&&(this.CalculateDataWidth(),this.Logarithmic&&this.SplitLogarithmicXYCoordinate()),this.BeforeDrawXYCallback&&this.BeforeDrawXYCallback(this),this.DrawTitleBG(),this.DrawCustomHorizontalArea(),this.DrawHorizontal(),this.DrawVertical()),1!=this.SizeChange&&1!=this.ReDrawToolbar||(this.DrawToolbar(),this.ReDrawToolbar=!1)},this.GetXFromIndex=function(t,e){if(!1===e)if(t>=0)for(var a=this.ChartBorder.GetLeft()+qi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,i=1;i<=t;++i)a+=this.DistanceWidth+this.DataWidth;else{a=this.ChartBorder.GetLeft()+qi.FrameLeftMargin-(this.DistanceWidth/2+this.DataWidth+this.DistanceWidth);var r=Math.abs(t);for(i=1;i<r;++i)a-=this.DistanceWidth+this.DataWidth}else{t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(a=this.ChartBorder.GetLeft()+qi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,i=1;i<=t;++i)a+=this.DistanceWidth+this.DataWidth}return a},this.GetXData=function(t,e){var a=this.DistanceWidth,i=this.DataWidth,r=this.ChartBorder.GetLeft()+qi.FrameLeftMargin;if(0==e){if(t<this.ChartBorder.GetLeft()){var n=-1,o=this.ChartBorder.GetLeft()-(a/2+i+a);while(n>-5e5){if(o<=t)break;o-=i+a,--n}return n}n=0,o=r+a/2+i+a;while(n<5e5){if(o>=t)break;o+=i+a,++n}return n}if(t<=this.ChartBorder.GetLeft())return 0;if(t>=this.ChartBorder.GetRight())return this.XPointCount-1;var s=this.ChartBorder.GetRight()-qi.FrameRightMargin;n=0,o=r+a/2+i+a;while(o<s&&n<5e5&&n+1<this.XPointCount){if(o>=t)break;o+=i+a,++n}return n},this.CalculateDataWidth=function(){if(!(this.XPointCount<2)){var t=this.GetFrameWidth()-qi.FrameMargin;if(this.ZoomIndex>=0&&this.LastCalculateStatus.Width==t&&this.LastCalculateStatus.XPointCount==this.XPointCount){var e=this.DistanceWidth/2+qi.FrameLeftMargin+(this.DataWidth+this.DistanceWidth)*(this.XPointCount-1),a=(this.DataWidth+this.DistanceWidth)*this.XPointCount;if(this.DataWidth<2){if(a<=t)return}else if(e<=t)return}this.LastCalculateStatus.Width=t,this.LastCalculateStatus.XPointCount=this.XPointCount;for(var i=0;i<Et.length;++i)if((Et[i][0]+Et[i][1])*this.XPointCount<t)return this.ZoomIndex=i,this.DataWidth=Et[i][0],this.DistanceWidth=Et[i][1],this.TrimKLineDataWidth(t),void u.Chart.Log("[KLineFrame::CalculateDataWidth] ZOOM_SEED, DataWidth, DistanceWidth, XPointCount",Et[this.ZoomIndex],this.DataWidth,this.DistanceWidth,this.XPointCount);this.ZoomIndex=Et.length-1,this.DataWidth=t/this.XPointCount,this.DistanceWidth=0}},this.OnSize=function(t){for(var e=this.GetFrameWidth()-qi.FrameMargin,a=0,i=this.DistanceWidth/2+qi.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);i<e;i+=this.DataWidth+this.DistanceWidth,++a);return t.CurCount=this.XPointCount,t.CalcCount=a,t.DataWidth=this.DataWidth,t.DistanceWidth=this.DistanceWidth,t.Changed=!1,this.LastCalculateStatus.Width=e,t.CurCount==t.CalcCount||(this.XPointCount=a,this.LastCalculateStatus.XPointCount=this.XPointCount,this.Data&&(this.Data.DataOffset+=t.CurCount-t.CalcCount,this.Data.DataOffset<0&&(this.Data.DataOffset=0),t.Changed=!0)),t},this.SetDataWidth=function(t){var e=Et.length-1;for(var a in Et){var i=Et[a];if(i[0]<=t){e=parseInt(a)-1;break}}this.ZoomIndex=e,this.DataWidth=Et[this.ZoomIndex][0],this.DistanceWidth=Et[this.ZoomIndex][1];for(var r=this.GetFrameWidth()-qi.FrameMargin,n=0,o=this.DistanceWidth/2+qi.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);o<=r;o+=this.DataWidth+this.DistanceWidth,++n);this.XPointCount=n,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=r;var s={XPointCount:this.XPointCount,DataWidth:this.DataWidth,DistanceWidth:this.DistanceWidth};return s},this.TrimKLineDataWidth=function(t){var e=Et[this.ZoomIndex][0],a=Et[this.ZoomIndex][1];if(1!=e||0!=a)while(1){if((this.DistanceWidth+this.DataWidth)*this.XPointCount+this.DistanceWidth>t){this.DistanceWidth-=.01;break}this.DistanceWidth+=.01}else this.DataWidth=t/this.XPointCount},this.IsOverlayMaxMin=function(t){if(!this.ChartKLine)return!1;if(!this.ChartKLine.Max||!this.ChartKLine.Min)return!1;var e=this.Canvas.measureText(t.Text.Value).width+4;"right"===t.Text.TextAlign&&(t.X-=e);var a=this.ChartKLine.Max,i=this.ChartKLine.Min,r=!1,n=!1;if(a.X>=t.X&&a.X<=t.X+e){var o=a.Y+20,s=a.Y-20;(o>=t.Y-20&&o<=t.Y+20||s>=t.Y-20&&s<=t.Y+20)&&(r=!0)}if(1==r)return!0;if(i.X>=t.X&&i.X<=t.X+e){o=i.Y+20,s=i.Y-20;(o>=t.Y-20&&o<=t.Y+20||s>=t.Y-20&&s<=t.Y+20)&&(n=!0)}return r||n},this.SplitXYCoordinate=function(){if(0==this.XYSplit)return this.XSplit&&this.XSplitOperator&&this.XSplitOperator.Operator(),void(this.YCustomSplit&&this.YSplitOperator&&this.YSplitOperator.CustomCoordinate&&this.YSplitOperator.CustomCoordinate());null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator(),this.Logarithmic&&this.SplitLogarithmicXYCoordinate()},this.SplitLogarithmicXYCoordinate=function(){for(var t=this.Logarithmic.Up,e=this.Logarithmic.Down,a=0,i=0,r=Math.max(t.length,e.length),n=[],o=0;o<r;++o)n[o]=2*o;o=0;for(var s=n.length-1;o<t.length;++o,--s){var h=t[o];h.LogHeight=n[s],a+=h.LogHeight,++i}for(o=0,s=n.length-1;o<e.length;++o,--s){h=e[o];h.LogHeight=n[s],a+=h.LogHeight,++i}var l=2*F(),C=this.ChartBorder.GetTopEx(),D=this.ChartBorder.GetBottomEx(),f=D-C,c=(f-a*l)/i;if(c<0&&(c=0,l=f/a),1==this.CoordinateType){var m=C;for(o=e.length-1;o>=0;--o){h=e[o];h.Height=c+l*h.LogHeight,h.Top=m,h.Bottom=h.Top+h.Height,m=h.Bottom}var d=D;for(o=t.length-1;o>=0;--o){h=t[o];h.Height=c+l*h.LogHeight,h.Bottom=d,h.Top=d-h.Height,d=h.Top}}else{for(m=C,o=t.length-1;o>=0;--o){h=t[o];h.Height=c+l*h.LogHeight,h.Top=m,h.Bottom=h.Top+h.Height,m=h.Bottom}for(d=D,o=e.length-1;o>=0;--o){h=e[o];h.Height=c+l*h.LogHeight,h.Bottom=d,h.Top=d-h.Height,d=h.Top}}u.Chart.Log("[KLineFrame::SplitLogarithmicXYCoordinate]",this.Logarithmic)},this.GetYLogarithmicFromData=function(t,e){if(1==this.CoordinateType){if(t<=this.HorizontalMin)return this.ChartBorder.GetTopEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetBottomEx();if(t>this.Logarithmic.OpenPrice){var a=this.Logarithmic.Up;for(var i in a){var r=a[i];if(t>=r.Start&&t<=r.End){var n=r.Bottom-r.Top,o=n*(t-r.Start)/(r.End-r.Start);return r.Top+o}}}else{var s=this.Logarithmic.Down;for(var i in s){r=s[i];if(t>=r.Start&&t<=r.End){n=r.Bottom-r.Top,o=n*(t-r.Start)/(r.End-r.Start);return r.Top+o}}}}else{if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();if(t>this.Logarithmic.OpenPrice){a=this.Logarithmic.Up;for(var i in a){r=a[i];if(t>=r.Start&&t<=r.End){n=r.Bottom-r.Top,o=n*(t-r.Start)/(r.End-r.Start);return r.Bottom-o}}}else{s=this.Logarithmic.Down;for(var i in s){r=s[i];if(t>=r.Start&&t<=r.End){n=r.Bottom-r.Top,o=n*(t-r.Start)/(r.End-r.Start);return r.Bottom-o}}}}},this.GetYLogarithmicData=function(t){if(1==this.CoordinateType){if(t<this.ChartBorder.GetTopEx())return this.HorizontalMin;if(t>this.ChartBorder.GetBottomEx())return this.HorizontalMax;var e=this.Logarithmic.Up;for(var a in e){var i=e[a];if(t>=i.Top&&t<=i.Bottom)return(t-i.Top)/i.Height*(i.End-i.Start)+i.Start}var r=this.Logarithmic.Down;for(var a in r){i=r[a];if(t>=i.Top&&t<=i.Bottom)return(t-i.Top)/i.Height*(i.End-i.Start)+i.Start}}else{if(t<this.ChartBorder.GetTopEx())return this.HorizontalMax;if(t>this.ChartBorder.GetBottomEx())return this.HorizontalMin;e=this.Logarithmic.Up;for(var a in e){i=e[a];if(t>=i.Top&&t<=i.Bottom)return(i.Bottom-t)/i.Height*(i.End-i.Start)+i.Start}r=this.Logarithmic.Down;for(var a in r){i=r[a];if(t>=i.Top&&t<=i.Bottom)return(i.Bottom-t)/i.Height*(i.End-i.Start)+i.Start}}},this.CalculateCount=function(t){var e=Et[t][0],a=Et[t][1],i=this.GetFrameWidth()-qi.FrameMargin-a/2;return parseInt(i/(e+a))},this.ZoomUp=function(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount,i=0,r=this.Data.DataOffset+this.XPointCount-1,n=this.Data.DataOffset+t.Index;r>=e&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var o=this.CalculateCount(this.ZoomIndex-1);u.Chart.Log("[KLineFrame::ZoomUp] old status. XPointCount=".concat(o," ZoomIndex=").concat(this.ZoomIndex," DataCount= ").concat(this.Data.Data.length," rightSpaceCount=").concat(i));var s=!1;if(--this.ZoomIndex,1==t.IsLockRight){var h=this.Data.DataOffset+this.XPointCount;if(o>h)o=h,this.XPointCount=o,this.Data.DataOffset=0;else{var l=r-(o-i)+1;this.XPointCount=o,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else if(o>=a)this.Data.DataOffset=0,this.XPointCount=o,s=!0,u.Chart.Log("[KLineFrame::ZoomUp] Show all data. XPointCount=".concat(o," ZoomIndex=").concat(this.ZoomIndex," DataCount= ").concat(e));else{l=r-(o-i)+1;if(1==t.ZoomType){var C=this.XPointCount-o+1,D=parseInt(t.Index/this.XPointCount*C),f=this.Data.DataOffset+D;f<e&&(l=this.Data.DataOffset+D)}this.XPointCount=o,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0),u.Chart.Log("[KLineFrame::ZoomUp] calculate. XPointCount=".concat(o," ZoomIndex=").concat(this.ZoomIndex," DataCount= ").concat(e," DataOffset=").concat(this.Data.DataOffset))}if(this.DataWidth=Et[this.ZoomIndex][0],this.DistanceWidth=Et[this.ZoomIndex][1],!s){var c=this.GetFrameWidth()-qi.FrameMargin;this.TrimKLineDataWidth(c)}return this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=n-this.Data.DataOffset,!0},this.SetXShowCount=function(t){for(var e=-1,a=this.GetFrameWidth()-qi.FrameMargin,i=0;i<Et.length;++i){var r=Et[i],n=r[0],o=r[1],s=(a=this.GetFrameWidth()-qi.FrameMargin-o/2,parseInt((a-o/2)/(n+o)));if(s>=t)return e=i,this.XPointCount=t,this.ZoomIndex=e,this.DataWidth=n,this.DistanceWidth=o,n<=1&&0==o&&(this.DataWidth=a/this.XPointCount),this.LastCalculateStatus.XPointCount=this.XPointCount,void(this.LastCalculateStatus.Width=a)}this.XPointCount=t,this.ZoomIndex=Et.length-1,this.DataWidth=a/this.XPointCount,this.DistanceWidth=0,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=a},this.XCoordinateZoom=function(t){var e=this.XPointCount;if(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var a=this.ZoomIndex-1,i=this.CalculateCount(a),r=this.Data.Data.length,n=e-i;if(n<=0)return!1;this.Data.DataOffset+=n,this.Data.DataOffset>r&&(this.Data.DataOffset=0)}else{if(this.ZoomIndex+1>=Et.length)return!1;if(this.Data.DataOffset<0)return!1;a=this.ZoomIndex+1,i=this.CalculateCount(a),n=i-e;this.Data.DataOffset-=n,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}this.XPointCount=i,this.ZoomIndex=a,this.DataWidth=Et[this.ZoomIndex][0],this.DistanceWidth=Et[this.ZoomIndex][1];var o=this.GetFrameWidth()-qi.FrameMargin;return this.TrimKLineDataWidth(o),this.LastCalculateStatus.XPointCount=this.XPointCount,!0},this.ZoomDown=function(t,e){if(this.ZoomIndex+1>=Et.length)return!1;if(this.Data.DataOffset<0)return!1;if(this.Data.DataOffset<=0&&1==t.IsLockRight)return!1;var a=this.Data.Data.length,i=a+this.RightSpaceCount,r=0,n=this.Data.DataOffset+this.XPointCount-1;n>=this.Data.Data.length&&(r=n-(this.Data.Data.length-1),n=this.Data.Data.length-1,r>this.RightSpaceCount&&(r=this.RightSpaceCount));var o=this.CalculateCount(this.ZoomIndex+1),s=this.Data.DataOffset+t.Index;u.Chart.Log("[KLineFrame::ZoomDown] old status. XPointCount=".concat(o," ZoomIndex=").concat(this.ZoomIndex," DataCount= ").concat(this.Data.Data.length," lastCursorIndex=").concat(s," rightSpaceCount=").concat(r));if(++this.ZoomIndex,1==t.IsLockRight){var h=this.Data.DataOffset+this.XPointCount;if(o>h)o=h,this.XPointCount=o,this.Data.DataOffset=0;else{var l=n-(o-r)+1;this.XPointCount=o,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else if(o>=i)this.XPointCount=o,this.Data.DataOffset=0,u.Chart.Log("[KLineFrame::ZoomDown] Show all data. XPointCount=".concat(o," ZoomIndex=").concat(this.ZoomIndex," DataCount= ").concat(a)),o-this.RightSpaceCount>a&&e&&e.ZoomDownloadDataCallback&&e.ZoomDownloadDataCallback({PageSize:o,DataCount:a,RightSpaceCount:this.RightSpaceCount,Count:o-a});else{l=n-(o-r)+1;if(1==t.ZoomType){var C=o-this.XPointCount+1,D=parseInt(t.Index/this.XPointCount*C);l=this.Data.DataOffset-D;l+(o-this.RightSpaceCount)>=a&&(l=this.Data.DataOffset-C)}this.XPointCount=o,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0),u.Chart.Log("[KLineFrame::ZoomDown] calculate. XPointCount=".concat(o," ZoomIndex=").concat(this.ZoomIndex," DataCount= ").concat(a," DataOffset=").concat(this.Data.DataOffset))}this.DataWidth=Et[this.ZoomIndex][0],this.DistanceWidth=Et[this.ZoomIndex][1];var f=this.GetFrameWidth()-qi.FrameMargin;return this.TrimKLineDataWidth(f),this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=s-this.Data.DataOffset,!0},this.GetFrameWidth=function(){if(this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder();return t.BottomEx-t.TopEx}t=this.ChartBorder.GetBorder();return t.RightEx-t.LeftEx},this.DrawCustomHorizontal=function(){if(!this.IsMinSize&&!this.ChartBorder.IsShowTitleOnly&&sa.IsNonEmptyArray(this.CustomHorizontalInfo)){var t=this.CustomHorizontalInfo.slice();t.sort((function(t,e){return e.Value-t.Value}));for(var e=new Map,a=0;a<t.length;++a){var i=t[a];switch(i.Type){case 0:case 1:this.DrawCustomItem(i,e);break;case 2:case 3:case 4:case 10:this.DrawCustomItem(i,e);break}}}},this.DrawCustomHorizontalArea=function(){if(!this.IsMinSize&&!this.ChartBorder.IsShowTitleOnly&&sa.IsNonEmptyArray(this.CustomHorizontalInfo))for(var t=0;t<this.CustomHorizontalInfo.length;++t){var e=this.CustomHorizontalInfo[t];5==e.Type&&this.DrawCustomAreaItem(e)}},this.DrawCustomVerticalItem=function(t){this.Canvas.save(),1==t.Data.Line.Type&&this.Canvas.setLineDash([5,5]),this.Canvas.strokeStyle=t.Data.Line.Color,this.Canvas.beginPath(),t.IsHScreen?(this.Canvas.moveTo(t.Top,A(t.X)),this.Canvas.lineTo(t.Bottom,A(t.X))):(this.Canvas.moveTo(A(t.X),t.Top),this.Canvas.lineTo(A(t.X),t.Bottom)),this.Canvas.stroke(),this.Canvas.restore()},this.DrawCustomVertical=function(){if(this.CustomVerticalInfo&&!(this.CustomVerticalInfo.length<=0)&&this.Data){var t=this.IsHScreen,e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetBottomEx(),i=this.DataWidth,r=this.DistanceWidth,n=this.ChartBorder.GetLeft()+r/2+2;t&&(n=this.ChartBorder.GetTop()+r/2+2,e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx());for(var o=0,s=this.Data.DataOffset;s<this.Data.Data.length&&o<this.XPointCount;++s,++o,n+=i+r){var h=this.Data.Data[s];for(var l in this.CustomVerticalInfo){var u=this.CustomVerticalInfo[l];if(0==u.Type){if(sa.IsNumber(u.Time)){if(h.Date!=u.Date||h.Time!=u.Time)continue}else if(h.Date!=u.Date)continue;var C=n,D=n+i,f=C+(D-C)/2,c={X:f,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(c),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,c,this);break}}}for(s=1;o<this.XPointCount;++s,++o,n+=i+r)for(var l in this.CustomVerticalInfo){u=this.CustomVerticalInfo[l];if(1==u.Type&&u.Space==s){C=n,D=n+i,f=C+(D-C)/2,c={X:f,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(c),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,c,this);break}}}},this.DrawSelectedBorder=function(t){if(0!==this.Identify){var e=1==this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder(),a=A(e.Left),i=A(e.Top),r=A(e.Right),n=A(e.Bottom),o=n-i;if(this.Canvas.strokeStyle=this.SelBorderColor,1==t.Mode){var s=A(e.ChartWidth);this.Canvas.strokeRect(r,i,s-r-1,o)}else this.Canvas.strokeRect(a,i,r-a-1,o)}},this.GetVerticalXCache=function(){if(!sa.IsNonEmptyArray(this.VerticalInfo))return null;for(var t=this.DataWidth,e=this.DistanceWidth,a=this.XPointCount,i=new Set,r=0;r<this.VerticalInfo.length;++r){var n=this.VerticalInfo[r];i.add(n.Value)}if(this.IsHScreen)var o=this.ChartBorder.GetHScreenBorder(),s=o.TopEx+e/2+qi.FrameLeftMargin;else o=this.ChartBorder.GetBorder(),s=o.LeftEx+e/2+qi.FrameLeftMargin;var h=new Map;for(r=0;r<a;++r,s+=t+e){var l=s,u=s+t,C=l+(u-l)/2;i.has(r)&&h.set(r,C)}return h}}function tt(){this.newMethod=q,this.newMethod(),delete this.newMethod,this.ClassName="OverlayKLineFrame",this.MainFrame=null,this.IsShareY=!1,this.IsShowMainFrame=0,this.IsCalculateYMaxMin=!0,this.RightOffset=50,this.PenBorder=qi.OverlayFrame.BolderPen,this.IsShow=qi.KLineToolbar.IsShowOverlayFrame,this.IsShowToolbar=qi.KLineToolbar.IsShowOverlayToolbar,this.Title=null,this.TitleColor=qi.OverlayFrame.TitleColor,this.TitleFont=qi.OverlayFrame.TitleFont,this.IsShowTitle=!0,this.IsYDrawMainFrame=!1,this.BlankWidth=0,this.Style=0,this.YLineExtend=[{Width:2},null],this.Buttons=[],this.CloseButton=P(qi.Buttons.CloseOverlayIndex),this.ModifyIndexParamButton=P(qi.Buttons.ModifyIndexParam),this.DrawSelectedBorder=null,this.KLineFrame_ReloadResource=this.ReloadResource,this.ReloadResource=function(t){this.KLineFrame_ReloadResource(t),t||(this.CloseButton=P(qi.Buttons.CloseOverlayIndex),this.ModifyIndexParamButton=P(qi.Buttons.ModifyIndexParam),this.PenBorder=qi.OverlayFrame.BolderPen,this.TitleColor=qi.OverlayFrame.TitleColor,this.TitleFont=qi.OverlayFrame.TitleFont)},this.Draw=function(){this.Buttons=[],this.ChartBorder.IsShowTitleOnly||(this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal(),this.DrawTitle()),this.SizeChange=!1,this.XYSplit=!1,this.XSplit=!1,this.YCustomSplit=!1)},this.GetXHorizontal=function(){var t=this.ChartBorder.GetBorder(),e=t.Right;return e+=this.RightOffset,1==this.Style||(e+=this.BlankWidth),e},this.GetHorizontalWidth=function(){var t=null;return this.YRightTextInfo&&sa.IsNumber(this.TextWidthIndex)&&(t=this.YRightTextInfo.AryOverlayWidth[this.TextWidthIndex]),t},this.DrawTitle=function(){if(this.IsShowTitle&&this.Title){var t=this.ChartBorder.GetBorder(),e=this.ChartBorder.GetTopTitle(),a=t.Bottom,i=this.GetXHorizontal(),r=null,n=null;sa.IsNonEmptyArray(this.YLineExtend)&&(n=this.YLineExtend[1],r=this.YLineExtend[0]),1==this.Style?(this.Canvas.textBaseline="bottom",n&&n.Width>0?i+=n.Width+1:i+=1):(this.Canvas.textBaseline="top",r&&r.Width>0?i-=r.Width:i-=2);var o=e+(a-e)/2;this.Canvas.fillStyle=this.TitleColor,this.Canvas.font=this.TitleFont,this.Canvas.textAlign="center",this.Canvas.save(),this.Canvas.translate(i,o),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Title,0,0),this.Canvas.restore()}},this.GetScaleTextWidth=function(){if(!this.IsShow)return null;this.ChartBorder.GetBorder();var t=F();if(this.IsHScreen)var e=this.ChartBorder.Bottom,a=e>10*t&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1];else{var i=this.ChartBorder.Right;a=i>10&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1]}if(!a)return null;for(var r={Left:null,Right:0},n=0;n<this.HorizontalInfo.length;++n){var o=null,s=this.HorizontalInfo[n];s&&(null!=s.Message[1]&&a&&(null!=s.Font&&(this.Canvas.font=s.Font),o=this.Canvas.measureText(s.Message[1]).width,this.YTextPadding&&sa.IsNumber(this.YTextPadding[1])&&(o+=this.YTextPadding[1]),r.Right<o&&(r.Right=o)))}if(sa.IsNonEmptyArray(this.YLineExtend)){var h=this.YLineExtend[1];h&&h.Width>0&&(r.Right+=h.Width)}return{TextWidth:r}},this.SyncMainHorizontalInfo=function(){if(!this.MainFrame)return!1;this.MainFrame.YMaxMin&&(this.YMaxMin.Max=this.MainFrame.YMaxMin.Max,this.YMaxMin.Min=this.MainFrame.YMaxMin.Min),this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[];for(var t=0;t<this.MainFrame.HorizontalInfo.length;++t){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}return this.CoordinateType=this.MainFrame.CoordinateType,!0},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(this.IsShareY?this.SyncMainHorizontalInfo():null!=this.YSplitOperator&&this.YSplitOperator.Operator())},this.DrawHorizontal=function(){var t=this.ChartBorder.GetBorder(),e=(t.Left,t.Right),a=t.Bottom,i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right;e+=this.RightOffset;var n=this.GetXHorizontal();sa.IsNumber(this.BlankWidth)&&(e+=this.BlankWidth);var o=null;sa.IsNonEmptyArray(this.YTextExtend)&&(o=this.YTextExtend[1]);var s=null,h=null;sa.IsNonEmptyArray(this.YLineExtend)&&(h=this.YLineExtend[1],s=this.YLineExtend[0]);for(var l=this.GetHorizontalWidth(),u=null,C=this.HorizontalInfo.length-1;C>=0;--C){var D=this.HorizontalInfo[C],f=this.GetYFromData(D.Value);if(!(null!=f&&Math.abs(f-u)<this.MinYDistance)){if(this.Canvas.textBaseline=f>=a-2?"bottom":f<=i+2?"top":"middle",s&&s.Width>0&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(n-s.Width,A(f)),this.Canvas.lineTo(n,A(f)),this.Canvas.stroke()),h&&h.Width>0&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(n+h.Width,A(f)),this.Canvas.lineTo(n,A(f)),this.Canvas.stroke()),null!=D.Message[1]&&r>10){null!=D.Font&&(this.Canvas.font=D.Font);var c=D.Message[1];if(Array.isArray(D.Message[1])&&(c=D.Message[1][0]),o&&o.Align){var m=l;this.Canvas.textAlign="right";var d=t.Right+this.RightOffset+m-this.YTextPadding[1];this.Canvas.fillText(c,d,f)}else{var I=e+2;h&&h.Width>0&&(I+=h.Width),this.Canvas.fillStyle=D.TextColor,this.Canvas.textAlign="left",this.Canvas.fillText(c,I,f)}}u=f}}},this.DrawVertical=function(){var t=this.ChartBorder.GetBorder(),e=t.TopEx,a=t.BottomEx,i=this.GetXHorizontal();this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(A(i),A(e)),this.Canvas.lineTo(A(i),A(a)),this.Canvas.stroke()},this.DrawToolbar=function(t,e,a){if(this.Buttons=[],1!=e&&!this.ChartBorder.IsShowTitleOnly&&!(this.ChartBorder.TitleHeight<5)&&this.IsShowToolbar){var i=[];if(i.push({ID:S.MODIFY_OVERLAY_INDEX_PARAM,Style:this.ModifyIndexParamButton}),i.push({ID:S.CLOSE_OVERLAY_INDEX,Style:this.CloseWindowButton}),this.GetEventCallback){var r=this.GetEventCallback(m.ON_CUSTOM_OVERLAY_TOOLBAR);if(r&&r.Callback){var n={PreventDefault:!1,DefaultButton:i,AryButton:null,Guid:this.Guid};if(r.Callback(r,n,this),n.PreventDefault)return void this.DrawToolbarButton(n.AryButton,t,a)}}this.DrawToolbarButton(i,t,a)}},this.DrawToolbarButton=function(t,e,a){if(sa.IsNonEmptyArray(t))for(var i=this.ChartBorder.GetBorder(),r=i.Top+this.ChartBorder.TitleHeight/2,n=this.GetHorizontalWidth(),o=i.Right+this.RightOffset+n-this.CloseButton.MerginLeft,s=t.length-1;s>=0;--s){var h=t[s],l=h.Style.Size,u="".concat(l,"px ").concat(h.Style.Family),C={Left:o-l-h.Style.MerginLeft,Top:r-l/2,Right:o,Bottom:r+l/2,Width:l+h.Style.MerginLeft,Height:l},D=this.CloseButton.Color;e&&e.X>=C.Left&&e.X<C.Right&&e.Y>=C.Top&&e.Y<=C.Bottom&&(D=h.Style.MoveOnColor,a&&(a.MouseOnToolbar={Rect:C,Item:h,Frame:this,Point:{X:e.X,Y:e.Y}})),this.Canvas.fillStyle=D,this.Canvas.font=u,this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillText(h.Style.Text,o,r),this.Buttons.push({ID:h.ID,Rect:C}),o=C.Left}},this.DrawCustomItem=function(t,e){if((this.IsShow||this.IsYDrawMainFrame)&&(t.Message[1]||t.Message[0]))if(t.Value>this.HorizontalMax||t.Value<this.HorizontalMin)this.SendDrawCountDownEvent({IsShow:!1});else{var a=this.GetBorder(),i=a.Left,r=a.Right+this.RightOffset;this.IsYDrawMainFrame&&(r=a.Right);var n=a.Bottom,o=a.Top,s=this.ChartBorder.Right,h=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(h=this.ChartBorder.Top,s=this.ChartBorder.Bottom,o=a.Top,n=a.Bottom);var l,u=F(),C=18*u,D=C,f=this.GetYFromData(t.Value),c=0;if(t.ExtendData&&t.ExtendData.Custom){var m=t.ExtendData.Custom;sa.IsNumber(m.Position)&&(c=m.Position),m.EmptyBGColor&&(l=m.EmptyBGColor)}if(t.Message[0])if(h<10||1==c){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var d=this.GetCustomItemTextInfo(t,!0,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;var T=t.LineColor,v=this.RGBToStruct(t.LineColor);v&&(T="rgba(".concat(v.R,", ").concat(v.G,", ").concat(v.B,", ").concat(qi.FrameLatestPrice.BGAlpha,")"));for(var p=f,g=0;g<d.Text.length;++g){var x=d.Text[g];if(this.IsHScreen){var E=o,L=p-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(E+x.Width,n,p,t.LineColor,t.LineType,t),p-=D+1*u}else if(1===x.Type);else{E=p-D/2-1*u,L=i+1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,x.Width,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L+1*u,p),0==g&&this.DrawLine(L+x.Width,r,p,t.LineColor,t.LineType,t),p+=D+1*u}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";d=this.GetCustomItemTextInfo(t,!0,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;for(p=f,g=0;g<d.Text.length;++g){x=d.Text[g];if(this.IsHScreen){if(0==g)E=o-x.Width;else E=o-I;L=p-D/2-1*u;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(E+x.Width,n,p,t.LineColor,t.LineType,t),p-=D+1*u}else{E=p-D/2-1*u;if(0==g){var M=i-x.Width;L=i}else M=i-I,L=i-(I-x.Width);l?(this.Canvas.fillStyle=l,this.Canvas.fillRect(M-1,E,x.Width+1,D),this.Canvas.strokeStyle=t.LineColor,this.Canvas.strokeRect(A(M-1),A(E),A(x.Width+1),A(D)),this.Canvas.fillStyle=t.LineColor,this.Canvas.fillText(x.Text,L-1*u,p)):(this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(M,E,x.Width,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L-1*u,p)),0==g&&this.DrawLine(i,r,p,t.LineColor,t.LineType,t),p+=D+1*u}}}else if(t.Message[1])if(s<10||1==c){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";d=this.GetCustomItemTextInfo(t,!1,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;T=t.LineColor,v=this.RGBToStruct(t.LineColor);v&&(T="rgba(".concat(v.R,", ").concat(v.G,", ").concat(v.B,", ").concat(qi.FrameLatestPrice.BGAlpha,")"));for(p=f,g=0;g<d.Text.length;++g){x=d.Text[g];if(this.IsHScreen){E=n-x.Width,L=p-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,I),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(o,E,p,t.LineColor,t.LineType,t),p-=D+1*u}else if(1===x.Type){if(this.GetEventCallback){E=p-D/2-1*u;var y={Top:E,Right:r,Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,PixelTatio:u,Position:"Right",IsInside:!0};this.SendDrawCountDownEvent(y)&&sa.IsPlusNumber(y.Height)&&(p+=D+1*u)}}else{E=p-D/2-1*u,L=r-x.Width;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,I,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L+1*u,p),0==g&&this.DrawLine(i,L,p,t.LineColor,t.LineType,t),p+=D+1*u}}if((3==t.Type||4==t.Type)&&t.Title){var R=this.Canvas.measureText(t.Title).width+2*u;if(this.IsHScreen){E=n-x.Width-R,L=f-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,R),this.DrawHScreenText({X:f,Y:E},{Text:t.Title,Color:t.TextColor,XOffset:1*u,YOffset:2*u})}else{E=f-D/2-1*u,L=r-I-R-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,R,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,L+1*u,f)}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";d=this.GetCustomItemTextInfo(t,!1,u),I=d.MaxWidth,S=this.GetFontHeight();D=S>C?S:C;var N=null;e&&e.has(3)&&(N=e.get(3));p=f;var w={};for(g=0;g<d.Text.length;++g){x=d.Text[g];if(this.IsHScreen){E=n,L=p-D/2-1*u;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(L,E,D,x.Width),this.DrawHScreenText({X:p,Y:E},{Text:x.Text,Color:t.TextColor,XOffset:1*u,YOffset:2*u}),0==g&&this.DrawLine(o,E,p,t.LineColor,t.LineType,t),p-=D+1*u}else if(1===x.Type){if(this.GetEventCallback){E=p-D/2-1*u,y={Top:E,Left:r,Right:this.ChartBorder.GetChartWidth(),Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,PixelTatio:u,Position:"Right",IsInside:!1};this.SendDrawCountDownEvent(y)&&sa.IsPlusNumber(y.Height)&&(p+=D+1*u)}}else{E=p-D/2-1*u;if(0==g){L=r;w.Left=L,N&&E<N.Rect.Bottom&&(p=N.Rect.Bottom,E=p-D/2-1*u)}else L=r+I-x.Width;l?(this.Canvas.fillStyle=l,this.Canvas.fillRect(L,E,x.Width+1,D),this.Canvas.strokeStyle=t.LineColor,this.Canvas.strokeRect(A(L),A(E),b(x.Width+1),b(D)),this.Canvas.fillStyle=t.LineColor,this.Canvas.fillText(x.Text,L+2*u,p)):(this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(L,E,x.Width,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(x.Text,L+1*u,p)),0==g&&this.DrawLine(i,r,f,t.LineColor,t.LineType,t),p+=D+1*u,w.Bottom=p}}if(e&&sa.IsNumber(w.Left)&&sa.IsNumber(w.Bottom)&&e.set(3,{Rect:w,Item:t}),(3==t.Type||4==t.Type)&&t.Title){T=t.LineColor,v=this.RGBToStruct(t.LineColor);v&&(T="rgba(".concat(v.R,", ").concat(v.G,", ").concat(v.B,", ").concat(qi.FrameLatestPrice.BGAlpha,")"));R=this.Canvas.measureText(t.Title).width+2*u;if(this.IsHScreen){E=n-R,L=f-D/2-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,D,R),this.DrawHScreenText({X:f,Y:E},{Text:t.Title,Color:t.TextColor,XOffset:1*u,YOffset:2*u})}else{E=f-D/2-1*u,L=r-R-1*u;this.Canvas.fillStyle=T,this.Canvas.fillRect(L,E,R,D),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,L+1*u,f)}}}}}}function et(){this.newMethod=q,this.newMethod(),delete this.newMethod,this.ClassName="KLineHScreenFrame",this.IsHScreen=!0,this.DrawSelectedBorder=null,this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var t=this.ChartBorder.GetHScreenBorder(),e=A(t.RightTitle),a=A(t.Top),i=A(t.Bottom),r=this.ChartBorder.TitleHeight,n=i-a;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(e,a,r,n)}},this.DrawToolbar=function(){},this.GetYFromData=function(t,e){var a=this.ChartBorder.GetHScreenBorder();if(!1===e){var i=(a.RightEx-a.LeftEx)*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return a.LeftEx+i}if(t<=this.HorizontalMin)return a.LeftEx;if(t>=this.HorizontalMax)return a.RightEx;i=(a.RightEx-a.LeftEx)*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return a.LeftEx+i},this.IsShowRightHorizontal=function(){var t=F(),e=this.ChartBorder.Bottom;if(e<=10*t)return!1;if(2==this.YTextPosition[1])return!1;if(!1===this.IsShowYText[1])return!1;if(this.GlobalOption&&this.GlobalOption.RightHorizontal){var a=this.GlobalOption.RightHorizontal;if(!1===a.Show)return!1}return!0},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetHScreenBorder(),e=t.Top,a=t.Bottom,i=this.ChartBorder.Top,r=(this.ChartBorder.Bottom,t.Left),n=(t.Right,null),o=F(),s=i>10*o&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],h=this.IsShowRightHorizontal(),l=this.HorizontalInfo.length-1;l>=0;--l){var u=this.HorizontalInfo[l],C=this.GetYFromData(u.Value);if(!(null!=C&&Math.abs(C-n)<this.MinYDistance)){if(C!=r&&(2==u.LineType?(this.Canvas.strokeStyle=u.LineColor,this.Canvas.setLineDash([5*o,5*o]),this.Canvas.beginPath(),this.Canvas.moveTo(A(C),e),this.Canvas.lineTo(A(C),a),this.Canvas.stroke(),this.Canvas.setLineDash([])):u.LineType>0&&(this.Canvas.strokeStyle=u.LineColor,qi.FrameYLineDash?(this.Canvas.setLineDash(qi.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(A(C),e),this.Canvas.lineTo(A(C),a),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(A(C),e),this.Canvas.lineTo(A(C),a),this.Canvas.stroke()))),null!=u.Message[0]&&s){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";var D=C,f=e;this.Canvas.save(),this.Canvas.translate(D,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[0],-2,0),this.Canvas.restore()}if(null!=u.Message[1]&&h){var c;null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",c=Array.isArray(u.Message[1])?u.Message[1][0]:u.Message[1];D=C,f=a;this.Canvas.save(),this.Canvas.translate(D,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(c,2,0),this.Canvas.restore()}n=C}}},this.DrawInsideHorizontal=function(){if(!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,o=(this.ChartBorder.TitleHeight,F()),s=(r<10*o||2==this.YTextPosition[0])&&!0===this.IsShowYText[0],h=(n<10*o||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(s||h){o=F();for(var l=null,u=this.HorizontalInfo.length-1;u>=0;--u){var C=this.HorizontalInfo[u],D=this.GetYFromData(C.Value);if(!(null!=D&&null!=l&&Math.abs(D-l)<this.MinYDistance)){if(null!=C.Message[0]&&s){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=D>=e-2?"top":D<=t+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[0];var f=D,c=a;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],-2,0),this.Canvas.restore()}if(null!=C.Message[1]&&h){if(null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=D>=e-2?"top":D<=t+2?"bottom":"middle",Array.isArray(C.Message[1]))var m=C.Message[1][0];else m=C.Message[1];var d=this.Canvas.measureText(m).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,f=D,c=i;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(m,-2,0),this.Canvas.restore()}l=D}}}}},this.GetXFromIndex=function(t,e){if(!1===e){var a=this.ChartBorder.GetHScreenBorder();if(t>=0)for(var i=a.TopEx+qi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,r=1;r<=t;++r)i+=this.DistanceWidth+this.DataWidth;else{i=a.TopEx-(this.DistanceWidth/2+this.DataWidth+this.DistanceWidth);var n=Math.abs(t);for(r=1;r<n;++r)i-=this.DistanceWidth+this.DataWidth}}else{t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(a=this.ChartBorder.GetHScreenBorder(),i=a.TopEx+qi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,r=1;r<=t;++r)i+=this.DistanceWidth+this.DataWidth}return i},this.DrawVertical=function(){var t=null;this.GetVerticalXCache&&(t=this.GetVerticalXCache());for(var e=this.ChartBorder.GetHScreenBorder(),a=e.Left,i=e.RightTitle,r=e.Bottom,n=F(),o=null,s=0;s<this.VerticalInfo.length;++s){var h=this.VerticalInfo[s],l=null;if(l=t&&t.has(h.Value)?t.get(h.Value):this.GetXFromIndex(h.Value),l>=r)break;if(!(null!=o&&Math.abs(l-o)<80)){if(2==h.LineType?(this.Canvas.strokeStyle=this.VerticalInfo[s].LineColor,this.Canvas.setLineDash([5*n,5*n]),this.Canvas.beginPath(),this.Canvas.moveTo(a,A(l)),this.Canvas.lineTo(i,A(l)),this.Canvas.stroke(),this.Canvas.setLineDash([])):h.LineType>0&&(this.Canvas.strokeStyle=this.VerticalInfo[s].LineColor,qi.FrameXLineDash?(this.Canvas.setLineDash(qi.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(a,A(l)),this.Canvas.lineTo(i,A(l)),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(a,A(l)),this.Canvas.lineTo(i,A(l)),this.Canvas.stroke())),null!=this.VerticalInfo[s].Message[0]){null!=this.VerticalInfo[s].Font&&(this.Canvas.font=this.VerticalInfo[s].Font),this.Canvas.fillStyle=this.VerticalInfo[s].TextColor;var u=this.Canvas.measureText(this.VerticalInfo[s].Message[0]).width;l<u/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var C=a,D=l;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[s].Message[0],0,this.XBottomOffset),this.Canvas.restore()}o=l}}},this.GetYData=function(t,e){var a=this.ChartBorder.GetHScreenBorder();if(!1===e){var i=a.RightEx-a.LeftEx;return(t-a.LeftEx)/i*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin}if(t<a.LeftEx)return this.HorizontalMin;if(t>a.RightEx)return this.HorizontalMax;i=a.RightEx-a.LeftEx;return(t-a.LeftEx)/i*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t,e){var a=this.ChartBorder.GetHScreenBorder(),i=a.TopEx+qi.FrameLeftMargin,r=a.BottomEx,n=this.DistanceWidth,o=this.DataWidth;if(0==e){if(t<i){var s=-1,h=i-(n/2+o+n);while(s>-1e5){if(h<=t)break;h-=o+n,--s}return s}s=0,h=i+n/2+o+n;while(s<1e5){if(h>=t)break;h+=o+n,++s}return s}if(t<=a.TopEx)return 0;if(t>=a.BottomEx)return this.XPointCount-1;s=0,h=i+n/2+o+n;while(h<r&&s<1e5&&s+1<this.XPointCount){if(h>t)break;h+=o+n,++s}return s},this.DrawBottons=function(){}}function at(){this.newMethod=et,this.newMethod(),delete this.newMethod,this.ClassName="OverlayKLineHScreenFrame",this.MainFrame=null,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.RightOffset=50,this.PenBorder=qi.OverlayFrame.BolderPen,this.IsShow=!0,this.Title=null,this.TitleColor=qi.OverlayFrame.TitleColor,this.TitleFont=qi.OverlayFrame.TitleFont,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal(),this.DrawTitle()),this.SizeChange=!1,this.XYSplit=!1,this.XSplit=!1,this.YCustomSplit=!1},this.DrawTitle=function(){},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY)for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){},this.DrawVertical=function(){},this.GetScaleTextWidth=function(){return{TextWidth:0}}}function it(){this.Frame,this.Height,this.OverlayIndex=[]}function rt(){this.Frame,this.ChartPaint=[],this.Identify=N(),this.Scprit,this.UpdateFrameMaxMin=function(){var t={Max:null,Min:null};if(this.Frame.IsShareY)this.Frame.XYSplit=!0;else{if(this.Frame.YSpecificMaxMin)t.Max=this.Frame.YSpecificMaxMin.Max,t.Min=this.Frame.YSpecificMaxMin.Min;else for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];if(0!=a.IsShow){var i=a.GetMaxMin();null!=i&&null!=i.Max&&null!=i.Min&&(sa.IsNumber(i.Max)&&(null==t.Max||t.Max<i.Max)&&(t.Max=i.Max),sa.IsNumber(i.Min)&&(null==t.Min||t.Min>i.Min)&&(t.Min=i.Min))}}if(sa.IsNumber(this.Frame.YMaxMin.Max)&&this.Frame.YMaxMin.Max==t.Max||(this.Frame.YMaxMin.Max=t.Max,this.Frame.XYSplit=!0),sa.IsNumber(this.Frame.YMaxMin.Min)&&this.Frame.YMaxMin.Min==t.Min||(this.Frame.YMaxMin.Min=t.Min,this.Frame.XYSplit=!0),this.Frame.XYSplit){var r=10,n=0;null!=t.Max&&(r=t.Max),null!=t.Min&&(n=t.Min),this.Frame.HorizontalMax=r,this.Frame.HorizontalMin=n}else this.Frame.XYSplit=!0}}}function nt(){this.SubFrame=new Array,this.SizeChange=!0,this.ChartBorder,this.Canvas,this.ScreenImageData,this.Data,this.Position,this.SizeChange=!0,this.MinSubFrameHeight=qi.DragSubFrameBorder.MinFrameHeight,this.DragBorderHeight=qi.DragSubFrameBorder.TopBorderHeight,this.AutoLeftBorder=null,this.AutoRightBorder=null,this.OverlayBlankWidth=30,this.AuotRightWidth,this.FixedRightWidth={Main:60,Overlay:80},this.ZoomWindowsInfo=null,this.ZoomStartWindowIndex=1,this.GetExtendChartByClassName,this.GetEventCallback,this.OnMoveFromeBorder=function(t,e){if(this.SubFrame.length<=0)return!1;for(var a=null,i=[],r=t;r>=0;--r){var n=this.SubFrame[r];if(n.Frame&&n.Frame.ChartBorder&&n.Frame.ChartBorder.IsShowTitleOnly)i.push(n);else if(n.Height>0){a=n;break}}var o=null,s=[];for(r=t+1;r<this.SubFrame.length;++r){n=this.SubFrame[r];if(n.Frame&&n.Frame.ChartBorder&&n.Frame.ChartBorder.IsShowTitleOnly)s.push(n);else if(n.Height>0){o=n;break}}if(!a||!o)return!1;var h=a.Frame.ChartBorder.Bottom,l=o.Frame.ChartBorder.Top;a.Frame.ChartBorder.Bottom-=e,o.Frame.ChartBorder.Top+=e;var u=a.Frame.ChartBorder.GetHeightEx(),C=o.Frame.ChartBorder.GetHeightEx();for(r=0;r<s.length;++r){n=s[r];n.Frame.ChartBorder.Bottom+=e,n.Frame.ChartBorder.Top+=e}for(r=0;r<i.length;++r){n=i[r];n.Frame.ChartBorder.Bottom+=e,n.Frame.ChartBorder.Top+=e}return!(u<this.MinSubFrameHeight&&e<0||C<this.MinSubFrameHeight&&e>0)||(a.Frame.ChartBorder.Bottom=h,o.Frame.ChartBorder.Top=l,!1)},this.ReDrawToolbar=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.ReDrawToolbar=!0},this.SetFrameBorderSizeChange=function(){var t=this.SubFrame[0];if(t&&t.Frame){var e=t.Frame.YSplitOperator;e&&2==e.CoordinateType&&(t.Frame.XYSplit=!0)}},this.CancelZoomUpDownFrameY=function(t){var e=t.Index;if(this.SubFrame.length<=0)return!1;if(!this.SubFrame[e])return!1;var a=this.SubFrame[e],i=a.Frame;if(t.IsOverlay){var r=a.OverlayIndex[t.OverlayIndex];if(!r)return!1;r.Frame.IsShareY||(i=r.Frame)}var n=i.YSplitOperator;if(n.FixedYMaxMin){for(var o in n.FixedYMaxMin=null,n.EnableZoomUpDown=!1,i.XYSplit=!0,a.OverlayIndex){var s=a.OverlayIndex[o];s.Frame.IsShareY&&(s.Frame.XYSplit=!0)}return u.Chart.Log("[HQTradeFrame::CancelZoomUpDownFrameY]"),!0}return!1},this.OnZoomUpDownFrameY=function(t,e){var a=t.Index;if(this.SubFrame.length<=0)return!1;if(!this.SubFrame[a])return!1;var i=this.SubFrame[a],r=i.Frame;if(t.IsOverlay){var n=i.OverlayIndex[t.OverlayIndex];if(!n)return!1;n.Frame.IsShareY||(r=n.Frame)}var o=r.ChartBorder.GetTopEx(),s=r.ChartBorder.GetBottomEx(),h=r.HorizontalMax,l=r.HorizontalMin,C=(h-l)*Math.abs(e)/(s-o),D=r.YSplitOperator,f={Max:h,Min:l};if(1==t.Position){var c=e>0?-C:C;f.Max+=c}else if(2==t.Position){c=e>0?-C:C;f.Min+=c}else{if(0!=t.Position)return!1;c=e>0?C:-C;f.Max+=c,f.Min-=c}if(f.Max>f.Min){D.FixedYMaxMin=f,D.EnableZoomUpDown=!0,r.XYSplit=!0;for(var m=0;m<i.OverlayIndex.length;++m){var d=i.OverlayIndex[m];d.Frame.IsShareY&&(d.Frame.XYSplit=!0)}return u.Chart.Log("[HQTradeFrame::OnZoomUpDownFrameY] Max=".concat(f.Max,", Min=").concat(f.Min)),!0}return!1},this.OnUpDonwFrameY=function(t,e){var a=t.Index;if(this.SubFrame.length<=0)return!1;if(!this.SubFrame[a])return!1;var i=this.SubFrame[a],r=i.Frame,n=r.ChartBorder.GetTopEx(),o=r.ChartBorder.GetBottomEx(),s=r.YSplitOperator;if(!s)return!1;var h=r.HorizontalMax,l=r.HorizontalMin,C=(h-l)*Math.abs(e)/(o-n),D=e>0?-C:C,f={Max:h,Min:l};for(var c in f.Max-=D,f.Min-=D,s.FixedYMaxMin=f,s.EnableZoomUpDown=!0,r.XYSplit=!0,i.OverlayIndex){var m=i.OverlayIndex[c];m.Frame.IsShareY&&(m.Frame.XYSplit=!0)}return u.Chart.Log("[HQTradeFrame::OnUpDonwFrameY] Max=".concat(f.Max,", Min=").concat(f.Min,", yMove=").concat(e,", moveStep=").concat(C)),!0},this.ClearUpDonwFrameYData=function(t){if(!(this.SubFrame.length<=0))if(t){var e=t.Index;if(e<0||e>=this.SubFrame.length)return;var a=this.SubFrame[e];if(!a||!a.Frame||!a.Frame.YSplitOperator)return;var i=a.Frame.YSplitOperator;1==i.EnableZoomUpDown&&(i.FixedYMaxMin=null)}else for(var r=0;r<this.SubFrame.length;++r){a=this.SubFrame[r];if(a&&a.Frame&&a.Frame.YSplitOperator){i=a.Frame.YSplitOperator;1==i.EnableZoomUpDown&&(i.FixedYMaxMin=null)}}},this.ClearCoordinateText=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&a.Frame.ClearCoordinateText(t)}},this.RestoreIndexWindows=function(){if(!this.ZoomWindowsInfo)return!1;this.SubFrame[this.ZoomWindowsInfo.FrameID];for(var t=this.ZoomStartWindowIndex;t<this.ZoomWindowsInfo.Data.length;++t){var e=this.ZoomWindowsInfo.Data[t],a=this.SubFrame[t];a.Height=e.Height,a.Frame.IsMinSize=!1,a.Frame.ReDrawToolbar=!0,a.Frame.XSplitOperator.ShowText=e.ShowXText,a.Frame.XYSplit=!0;for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];r.Frame.IsMinSize=!1}}return this.ZoomWindowsInfo=null,!0},this.ZoomIndexWindow=function(t,e){var a=this.SubFrame[t];if(!a)return!1;if(a.Frame.ChartBorder.IsShowTitleOnly=!1,this.ZoomWindowsInfo)return this.RestoreIndexWindows();for(var i={FrameID:t,Data:[]},r=0;r<this.SubFrame.length;++r){var n=this.SubFrame[r];i.Data[r]={Height:n.Height,ShowXText:n.Frame.XSplitOperator.ShowText}}this.ZoomWindowsInfo=i;var o=0;for(r=this.ZoomStartWindowIndex;r<this.SubFrame.length;++r){n=this.SubFrame[r];var s=n.Frame;if(s.XYSplit=!0,o+=n.Height,r!=t){n.Height=0,s.IsMinSize=!0,s.HideToolbar(),s.XSplitOperator.ShowText=!1;for(var h=0;h<n.OverlayIndex.length;++h){var l=n.OverlayIndex[h];l.Frame.IsMinSize=!0}}}return a.Height=o,a.Frame.XSplitOperator.ShowText=!0,!0},this.SaveSubFrameHeightRate=function(){for(var t=this.ChartBorder.GetHeight(),e=0,a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame;r&&r.ChartBorder&&r.ChartBorder.IsShowTitleOnly&&i.Height>0&&(e+=r.ChartBorder.TitleHeight)}t-=e;for(a=0;a<this.SubFrame.length;++a){i=this.SubFrame[a],r=i.Frame;if(!(i.Height<=0)&&!(r&&r.ChartBorder&&r.ChartBorder.IsShowTitleOnly&&i.Height>0)){var n=i.Frame.ChartBorder.GetHeight(),o=n/t*100;i.Height=o}}},this.ShowIndexTitleOnly=function(t,e){var a=this.SubFrame[t];if(!a&&!a.Frame)return!1;var i=a.Frame;if(!i.ChartBorder)return!1;var r=i.ChartBorder;if(r.TitleHeight<10)return!1;this.RestoreIndexWindows();var n=!1,o=!r.IsShowTitleOnly;return e&&sa.IsBool(e.Enable)&&(o=e.Enable),r.IsShowTitleOnly!=o&&(r.IsShowTitleOnly=o,n=!0),n},this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){for(var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=0,i=0,r=0;r<this.SubFrame.length;++r){var n=this.SubFrame[r],o=n.Frame;o&&o.ChartBorder&&o.ChartBorder.IsShowTitleOnly&&n.Height>0?i+=o.ChartBorder.TitleHeight:a+=n.Height}e-=i;for(r=0;r<this.SubFrame.length;++r){n=this.SubFrame[r],o=n.Frame;if(n.Frame.ChartBorder.Top=t,n.Frame.ChartBorder.Left=this.ChartBorder.Left,n.Frame.ChartBorder.Right=this.ChartBorder.Right,n.Frame.ChartBorder.LeftExtendWidth=this.ChartBorder.LeftExtendWidth,n.Frame.ChartBorder.RightExtendWidth=this.ChartBorder.RightExtendWidth,o&&o.ChartBorder&&o.ChartBorder.IsShowTitleOnly&&n.Height>0){var s=n.Frame.ChartBorder.Top+o.ChartBorder.TitleHeight;n.Frame.ChartBorder.Bottom=this.ChartBorder.GetChartHeight()-s,t=s}else{s=e*(n.Height/a)+t;n.Frame.ChartBorder.Bottom=this.ChartBorder.GetChartHeight()-s,t=s}}if(this.GetEventCallback){var h=this.GetEventCallback(m.ON_SIZE_FRAME);if(h&&h.Callback){var l={SubFrame:this.SubFrame};h.Callback(h,l,this)}}}},this.SetExtendWidth=function(t){if(t){var e=null,a=null;for(var i in sa.IsNumber(t.Left)&&(e=t.Left,this.ChartBorder.LeftExtendWidth=e),sa.IsNumber(t.Right)&&(a=t.Right,this.ChartBorder.RightExtendWidth=a),this.SubFrame){var r=this.SubFrame[i];null!=e&&(r.Frame.ChartBorder.LeftExtendWidth=e),null!=a&&(r.Frame.ChartBorder.RightExtendWidth=a)}}},this.CalculateChartBorder2=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.Top,e=this.ChartBorder.Bottom,a=this.ChartBorder.GetHeight(),i=0;for(var r in this.SubFrame){var n=this.SubFrame[r];i+=n.Height}var o=0;for(var r in this.SubFrame){n=this.SubFrame[r];n.Frame.ChartBorder.Top=t,n.Frame.ChartBorder.Left=this.ChartBorder.Left,n.Frame.ChartBorder.Right=this.ChartBorder.Right,n.Frame.ChartBorder.X=this.ChartBorder.X,n.Frame.ChartBorder.Y=this.ChartBorder.Y,n.Frame.ChartBorder.Width=this.ChartBorder.Width,n.Frame.ChartBorder.Height=this.ChartBorder.Height;var s=a*(n.Height/i);o+=s,e=this.ChartBorder.Bottom+(a-o),n.Frame.ChartBorder.Bottom=e,t+=s}}},this.GetScaleTextWidth=function(){for(var t={Left:null,Right:null,OverlayRight:0},e=[],a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a];if(!(i.Height<=0)){var r=i.Frame;if(r&&r.XSplitOperator){r.HorizontalMax,r.HorizontalMin;r.YSplitOperator.Operator();var n=r.GetScaleTextWidth();if(n&&n.TextWidth){var o=n.TextWidth;sa.IsNumber(o.Left)&&(null==t.Left||t.Left<o.Left)&&(t.Left=o.Left),sa.IsNumber(o.Right)&&(null==t.Right||t.Right<o.Right)&&(t.Right=o.Right)}if(sa.IsNonEmptyArray(i.OverlayIndex))for(var s=0,h=0;s<i.OverlayIndex.length;++s){var l=i.OverlayIndex[s];if(l.Frame){if(l.Frame.IsShareY){l.Frame.SyncMainHorizontalInfo&&l.Frame.SyncMainHorizontalInfo();n=l.Frame.GetScaleTextWidth()}else{l.Frame.HorizontalMax,l.Frame.HorizontalMin;l.Frame.YSplitOperator.Operator();n=l.Frame.GetScaleTextWidth()}if(l.RightWidth={Index:-1,Width:0},n&&n.TextWidth){o=n.TextWidth;sa.IsNumber(o.Right)&&(l.RightWidth.Index=h,l.RightWidth.Width=o.Right,e[h]||(e[h]=[]),e[h][a]=l.RightWidth,++h)}}}}}}var u=[];for(a=0;a<e.length;++a){var C=e[a],D=0;for(s=0;s<C.length;++s)if(C[s]){i=C[s].Width;D<i&&(D=i)}D>0&&(D+=this.OverlayBlankWidth);for(s=0;s<C.length;++s)C[s]&&(C[s].Width=D);u[a]=D}for(a=0;a<u.length;++a){n=u[a];sa.IsNumber(n)&&(t.OverlayRight+=n)}return t.AryOverlayWidth=u,t},this.IsFrameXYSplit=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];if(e.Frame.XYSplit)return!0;for(var a=0;a<e.OverlayIndex.length;++a){var i=e.OverlayIndex[a];if(i.Frame.XYSplit)return!0}}return!1},this.Draw=function(t){!0===this.SizeChange&&this.CalculateChartBorder();var e=!1;if(t&&!0===t.IsEnableSplash&&(e=!0),0==e&&(this.AutoLeftBorder||this.AutoRightBorder)&&this.IsFrameXYSplit()){this.AutoRightOverlayWidth=[];var a=this.GetScaleTextWidth();if(sa.IsNumber(a.Left)&&this.AutoLeftBorder){var i=0;sa.IsNumber(this.AutoLeftBorder.Blank)&&(i=this.AutoLeftBorder.Blank);var r=a.Left+i;sa.IsNumber(this.AutoLeftBorder.MinWidth)&&this.AutoLeftBorder.MinWidth>r&&(r=this.AutoLeftBorder.MinWidth),this.IsHScreen?this.ChartBorder.Top=r:this.ChartBorder.Left=r;for(var n=0;n<this.SubFrame.length;++n){var o=this.SubFrame[n];this.IsHScreen?o.Frame.ChartBorder.Top=r:o.Frame.ChartBorder.Left=r}}if(sa.IsNumber(a.Right))if(this.AutoRightBorder){var s={};i=0;sa.IsNumber(this.AutoRightBorder.Blank)&&(i=this.AutoRightBorder.Blank);r=a.Right+i;if(sa.IsNumber(this.AutoRightBorder.MinWidth)&&this.AutoRightBorder.MinWidth>r&&(r=this.AutoRightBorder.MinWidth),this.AuotRightWidth=r,s.MainTextWidth=r,sa.IsNonEmptyArray(a.AryOverlayWidth)&&(s.AryOverlayWidth=a.AryOverlayWidth),sa.IsPlusNumber(a.OverlayRight)&&(this.AuotRightWidth=r,r+=a.OverlayRight),this.GetExtendChartRightWidth){var h=this.GetExtendChartRightWidth();if(this.GetExtendChartByClassName){var l=this.GetExtendChartByClassName("StockChip");l&&l.Chart&&(l.Chart.Left=r)}r+=h}this.IsHScreen?(this.ChartBorder.Bottom!=r&&!0,this.ChartBorder.Bottom=r):(this.ChartBorder.Right!=r&&!0,this.ChartBorder.Right=r);for(n=0;n<this.SubFrame.length;++n){o=this.SubFrame[n];this.IsHScreen?o.Frame.ChartBorder.Bottom=r:o.Frame.ChartBorder.Right=r,o.Frame.ReDrawToolbar=!0,o.Frame.YRightTextInfo=s;for(var u=0;u<o.OverlayIndex.length;++u){var C=o.OverlayIndex[u];C.Frame.YRightTextInfo=s}}}else{s={};if(s.MainTextWidth=this.FixedRightWidth.Main,0==a.OverlayRight)this.IsHScreen?s.MainTextWidth=this.ChartBorder.Bottom:s.MainTextWidth=this.ChartBorder.Right;else if(sa.IsNonEmptyArray(a.AryOverlayWidth)){for(n=0;n<a.AryOverlayWidth.length;++n)a.AryOverlayWidth[n]=this.FixedRightWidth.Overlay;s.AryOverlayWidth=a.AryOverlayWidth}for(n=0;n<this.SubFrame.length;++n){o=this.SubFrame[n];o.Frame.ReDrawToolbar=!0,o.Frame.YRightTextInfo=s;for(u=0;u<o.OverlayIndex.length;++u){C=o.OverlayIndex[u];C.Frame.YRightTextInfo=s}}}this.SetSizeChage(!0)}for(n=0;n<this.SubFrame.length;++n){o=this.SubFrame[n];if(!(o.Height<=0))if(o.Frame.Draw(),this.AutoRightBorder)for(var D=this.AuotRightWidth,f=(u=0,0);u<o.OverlayIndex.length;++u){C=o.OverlayIndex[u];C.Frame.DataWidth=o.Frame.DataWidth,C.Frame.DistanceWidth=o.Frame.DistanceWidth,C.Frame.XPointCount=o.Frame.XPointCount,C.Frame.RightOffset=D,C.Frame.BlankWidth=0,C.Frame.TextWidthIndex=f,sa.IsNumber(this.OverlayBlankWidth)&&(C.Frame.BlankWidth=this.OverlayBlankWidth),C.Frame.Draw(),C.RightWidth&&(D+=C.RightWidth.Width),C.Frame.IsShow&&++f}else{D=this.FixedRightWidth.Main;o.Frame.RightTextMaxWidth>D&&(D=o.Frame.RightTextMaxWidth);for(u=0,f=0;u<o.OverlayIndex.length;++u){C=o.OverlayIndex[u];C.Frame.DataWidth=o.Frame.DataWidth,C.Frame.DistanceWidth=o.Frame.DistanceWidth,C.Frame.XPointCount=o.Frame.XPointCount,C.Frame.RightOffset=D,C.Frame.BlankWidth=0,C.Frame.TextWidthIndex=f,sa.IsNumber(this.OverlayBlankWidth)&&(C.Frame.BlankWidth=this.OverlayBlankWidth),C.Frame.Draw(),C.Frame.IsShow&&(D+=this.FixedRightWidth.Overlay,++f)}}}this.SizeChange=!1},this.DrawOveraly=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];if(!(a.Height<=0))for(var i=0;i<a.OverlayIndex.length;++i)for(var r=a.OverlayIndex[i],n=0;n<r.ChartPaint.length;++n){var o=r.ChartPaint[n];o.IsShow&&(t?o.IsDrawFirst&&o.Draw():o.IsDrawFirst||o.Draw())}}},this.DrawOveralySelectedStatus=function(t){if(t.MoveOn.Identify||t.Selected.Identify)for(var e in this.SubFrame){var a=this.SubFrame[e];for(var i in a.OverlayIndex){var r=a.OverlayIndex[i];for(var n in r.ChartPaint){var o=r.ChartPaint[n];o.IsShow&&(o.Identify&&(o.Identify!=t.MoveOn.Identify&&o.Identify!=t.Selected.Identify||o.DrawSelectedStatus&&o.DrawSelectedStatus()))}}}},this.PtInOveralyChart=function(t,e){var a=null;for(var i in this.SubFrame){var r=this.SubFrame[i];for(var n in r.OverlayIndex){var o=r.OverlayIndex[n];for(var s in o.ChartPaint){var h=o.ChartPaint[s];if(h.IsShow&&(!h.IsHideScriptIndex()&&h.PtInChart&&(a=h.PtInChart(t,e),a)))return a}}}return null},this.DrawPictureCoordinate=function(t,e){if(!t||!t.Frame)return!1;if(!sa.IsNonEmptyArray(t.Point))return!1;if(!t.GetXYCoordinate)return!1;var a=t.GetXYCoordinate();a&&!1===a.IsShowYCoordinate||t.Frame.DrawPictureYCoordinate(t,a,e);for(var i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i];if(r&&r.Frame&&r.Frame.XSplitOperator.ShowText){r.Frame.DrawPictureXCoordinate(t,a,e);break}}return!0},this.DrawLock=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawLock()}},this.DrawLogo=function(){for(var t=0;t<this.SubFrame.length;++t){var e=this.SubFrame[t];if(e.Frame.DrawLogo){e.Frame.DrawLogo();break}}},this.CalculateLock=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.CalculateLock()}},this.DrawInsideHorizontal=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Height<=0||e.Frame.DrawInsideHorizontal&&e.Frame.DrawInsideHorizontal()}},this.DrawCustomHorizontal=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawCustomHorizontal&&e.Frame.DrawCustomHorizontal();for(var a=0;a<e.OverlayIndex.length;++a){var i=e.OverlayIndex[a];i.Frame&&i.Frame.DrawCustomHorizontal&&i.Frame.DrawCustomHorizontal()}}},this.DrawEx=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];"MinuteFrame"!=a.Frame.ClassName&&"MinuteHScreenFrame"!=a.Frame.ClassName||1!=e||a.Frame.DrawVolTitle(t.Symbol)}},this.DrawCustomVertical=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame.DrawCustomVerticalEvent=t,a.Frame.DrawCustomVertical&&a.Frame.DrawCustomVertical()}},this.DrawToolbar=function(t){var e=null;t&&t.MoveOnPoint&&(e=t.MoveOnPoint);for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a];if(!(i.Height<=0)){var r=i.Frame;if(r){1==r.ToolbarButtonStyle&&r.DrawToolbarV2&&r.DrawToolbarV2(e,t);for(var n=0;n<i.OverlayIndex.length;++n){var o=i.OverlayIndex[n],s=o.Frame;s.IsShow&&(s.DrawToolbar&&s.DrawToolbar(e,r.IsMinSize,t))}}}}},this.SetSizeChage=function(t){for(var e in this.SizeChange=t,this.SubFrame){var a=this.SubFrame[e];for(var i in a.Frame.SizeChange=t,a.OverlayIndex){var r=a.OverlayIndex[i];r.Frame&&(r.Frame.SizeChange=t)}}this.ChartBorder.UIElement&&(this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight})},this.SetBeforeDrawXYCallback=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame.BeforeDrawXYCallback=t}},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.GetXData=function(t){return this.SubFrame[0].Frame.GetXData(t)},this.GetYData=function(t,e){for(var a,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeft(),o=r.Frame.ChartBorder.GetTopEx(),s=r.Frame.ChartBorder.GetWidth(),h=r.Frame.ChartBorder.GetHeightEx();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(n,o,s,h),r.Frame.Canvas.isPointInPath(n,t)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a){a.RightFrame&&(e.RightYValue=a.RightFrame.GetYData(t));var l=a.GetYData(t);if(1==a.YSplitOperator.CoordinateType){var u=a.YSplitOperator.GetFirstOpenPrice();e.RightYValue=((l-u)/u*100).toFixed(2)+"%"}if(a.GetMainOverlayFrame){var C=a.GetMainOverlayFrame();if(C){if(C[0]){var D=C[0],f=D.GetYData(t);e.RightYValue=l,l=f}if(C[1]){var c=C[1];f=c.GetYData(t);e.RightYValue=f}}}return l}},this.PtInFrame=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame.ChartBorder.GetLeft(),n=i.Frame.ChartBorder.GetTop(),o=i.Frame.ChartBorder.GetWidth(),s=i.Frame.ChartBorder.GetHeight();if(i.Frame.Canvas.beginPath(),i.Frame.Canvas.rect(r,n,o,s),i.Frame.Canvas.isPointInPath(t,e))return a}var h=this.ChartBorder.GetBottom(),l=this.ChartBorder.GetChartHeight(),u=(r=this.ChartBorder.GetLeft(),this.ChartBorder.GetRight());return t>=r&&t<=u&&e>h&&e<l?-3:-1},this.PtInChartFrame=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame.ChartBorder.GetLeft(),n=i.Frame.ChartBorder.GetTopEx(),o=i.Frame.ChartBorder.GetWidth(),s=i.Frame.ChartBorder.GetHeightEx();if(i.Frame.Canvas.beginPath(),i.Frame.Canvas.rect(r,n,o,s),i.Frame.Canvas.isPointInPath(t,e))return a}return-1},this.PtInHorizontalLabel=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a];if(!(i.Height<=0)){var r=i.Frame.PtInHorizontalLabel(t,e);if(r)return r.Frame=i.Frame,r.FrameID=a,r}}return null},this.PtInButtons=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a];if(!(i.Height<=0)){var r=i.Frame.PtInButtons(t,e);if(r)return r.Frame=i.Frame,r.FrameID=a,r;for(var n=0;n<i.OverlayIndex.length;++n){var o=i.OverlayIndex[n],s=o.Frame;if(s&&s.PtInButtons){r=s.PtInButtons(t,e);if(r)return r.IndexID=o.Identify,r.FrameID=a,r.OverlayFrame=s,r.Frame=i.Frame,r}}}}return null},this.PtInFrameBottom=function(t,e){var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetWidth(),n=this.ChartBorder.Bottom;return this.Canvas.beginPath(),this.Canvas.rect(a,i,r,n),!!this.Canvas.isPointInPath(t,e)},this.PtInFrameVertical=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a];if(!(i.Height<=0)&&(i.Frame.PtInVertical&&i.Frame.PtInVertical(t,e)))return{Frame:i.Frame}}return null},this.GetXFromIndex=function(t,e){return this.SubFrame[0].Frame.GetXFromIndex(t,e)},this.GetYFromData=function(t){return this.SubFrame[0].Frame.GetYFromData(t)},this.ZoomUp=function(t){var e=this.SubFrame[0].Frame.ZoomUp(t);return this.UpdateAllFrame(),e},this.ZoomDown=function(t,e){var a=this.SubFrame[0].Frame.ZoomDown(t,e);return this.UpdateAllFrame(),a},this.SetXShowCount=function(t){var e=this.SubFrame[0].Frame.SetXShowCount(t);return this.UpdateAllFrame(),e},this.GetXShowCount=function(){var t=-1;if(!sa.IsNonEmptyArray(this.SubFrame))return t;var e=this.SubFrame[0];return e.Frame?(t=e.Frame.XPointCount,t):t},this.XCoordinateZoom=function(t,e){var a=this.SubFrame[0].Frame.XCoordinateZoom(t,e);return this.UpdateAllFrame(),a},this.ResetXYSplit=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.XYSplit=!0},this.ResetXSplit=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.XSplit=!0},this.ResetYCustomSplit=function(t){if(sa.IsNonEmptyArray(this.SubFrame))if(sa.IsNumber(t)&&t>=0){var e=this.SubFrame[t];e.Frame&&(e.Frame.YCustomSplit=!0)}else for(var a=0;a<this.SubFrame.length;++a)this.SubFrame[a].Frame.YCustomSplit=!0},this.ClearYCoordinateMaxMin=function(t){if(sa.IsNumber(t)){var e=this.SubFrame[t];if(!e||!e.Frame)return;var a=e.Frame;a.YMaxMin&&(a.YMaxMin.Max=null,a.YMaxMin.Min=null)}else for(var i=0;i<this.SubFrame.length;++i){e=this.SubFrame[i],a=e.Frame;a.YMaxMin&&(a.YMaxMin.Max=null,a.YMaxMin.Min=null)}},this.SetLanguage=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a&&a.Frame&&(a.Frame.YSplitOperator&&(a.Frame.YSplitOperator.LanguageID=t),a.Frame.XSplitOperator&&(a.Frame.XSplitOperator.LanguageID=t))}},this.GetCurrentPageSize=function(){if(this.SubFrame.length<=0)return null;var t=this.SubFrame[0];return t&&t.Frame?t.Frame.XPointCount:null},this.OnSize=function(){var t={};return this.SubFrame[0].Frame.OnSize(t),this.UpdateAllFrame(),t},this.SetDataWidth=function(t){var e=this.SubFrame[0].Frame.SetDataWidth(t);return this.UpdateAllFrame(),e},this.UpdateAllFrame=function(){for(var t=this.SubFrame[0].Frame,e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];for(var i in e>0&&(a.Frame.XPointCount=t.XPointCount,a.Frame.ZoomIndex=t.ZoomIndex,a.Frame.DataWidth=t.DataWidth,a.Frame.DistanceWidth=t.DistanceWidth,a.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,a.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount),a.OverlayIndex){var r=this.SubFrame[e].OverlayIndex[i];r.Frame.XPointCount=t.XPointCount,r.Frame.ZoomIndex=t.ZoomIndex,r.Frame.DataWidth=t.DataWidth,r.Frame.DistanceWidth=t.DistanceWidth,r.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,r.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount}}},this.PtInFrameBorder=function(t,e){for(var a=this.DragBorderHeight,i=0;i<this.SubFrame.length-1;++i){var r=this.SubFrame[i];if(!(r.Frame.Heigh<=0)){var n=r.Frame.ChartBorder.GetBottom(),o=r.Frame.ChartBorder.GetLeft(),s=r.Frame.ChartBorder.GetRight(),h={Left:o,Right:s,Top:n-a/2,Height:a};if(h.Bottom=h.Top+h.Height,h.Width=h.Right-h.Left,t>=h.Left&&t<=h.Right&&e>=h.Top&&e<h.Bottom)return{Index:i,Bottom:!0}}}return null},this.IsEnableDragY=function(t){if(!this.SubFrame)return!1;var e=this.SubFrame[t];if(!e||!e.Frame||!e.Frame.YSplitOperator)return!1;var a=e.Frame.YSplitOperator;return"function"==typeof a.IsEnableDragY&&a.IsEnableDragY()},this.IsEnableOverlayDragY=function(t,e){if(!this.SubFrame)return!1;var a=this.SubFrame[t],i=a.OverlayIndex[e];if(!i||!i.Frame)return!1;var r=i.Frame.YSplitOperator;return i.Frame.IsShareY&&(r=i.Frame.MainFrame.YSplitOperator),!(!r||"function"!=typeof r.IsEnableDragY)&&r.IsEnableDragY()},this.PtInFrameY=function(t,e){var a=0;if(this.GetExtendChartByClassName){var i=this.GetExtendChartByClassName("StockChip");i&&i.Chart&&(a=i.Chart.Width)}for(var r=0;r<this.SubFrame.length;++r){var n=this.SubFrame[r];if(!(n.Frame.Heigh<=0)){var o=n.Frame.ChartBorder.Right;o-=a;var s=n.Frame.ChartBorder.GetBorder(),h=s.Bottom,l=s.TopTitle,u=(s.Left,s.Right),C=h-l;if(C/3>30)var D=l+30,f=h-30;else{var c=C/3;D=l+c,f=h-c}var m=0;if(e<D?m=1:e>f&&(m=2),o>=10)if(sa.IsNonEmptyArray(n.OverlayIndex)){var d=n.OverlayIndex[0],I=d.Frame.RightOffset;if(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(u,l,I,h-l),n.Frame.Canvas.isPointInPath(t,e))return{Index:r,Right:!0,Left:!1,Position:m,IsOverlay:!1};for(var S=u+I,T=0;T<n.OverlayIndex.length;++T){d=n.OverlayIndex[T];if(d.RightWidth&&sa.IsNumber(d.RightWidth.Width)){var v=d.RightWidth.Width;if(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(S,l,v,h-l),n.Frame.Canvas.isPointInPath(t,e))return{Index:r,Right:!0,Left:!1,Position:m,IsOverlay:!0,OverlayIndex:T};S+=v}}}else if(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(u,l,o,h-l),n.Frame.Canvas.isPointInPath(t,e))return{Index:r,Right:!0,Left:!1,Position:m,IsOverlay:!1};var p=n.Frame.ChartBorder.Left;if(p>=10&&(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(0,l,p,h-l),n.Frame.Canvas.isPointInPath(t,e)))return{Index:r,Right:!1,Left:!0,Position:m,IsOverlay:!1}}}return null},this.SetDayCount=function(t){this.ChartBorder.MultiDayMinute.Count=t;for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&(a.Frame.DayCount=t,a.Frame.ChartBorder.MultiDayMinute.Count=t)}},this.SetMultiDayMinuteWidth=function(t){if(t){sa.IsNumber(t.Left)&&(this.ChartBorder.MultiDayMinute.Left=t.Left),sa.IsNumber(t.Right)&&(this.ChartBorder.MultiDayMinute.Right=t.Right);for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&(sa.IsNumber(t.Left)&&(a.Frame.ChartBorder.MultiDayMinute.Left=t.Left),sa.IsNumber(t.Right)&&(a.Frame.ChartBorder.MultiDayMinute.Right=t.Right))}}}}function ot(){this.newMethod=nt,this.newMethod(),delete this.newMethod,this.IsHScreen=!0,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){for(var t=this.ChartBorder.GetHScreenBorder(),e=this.ChartBorder.Right,a=t.Right,i=t.Right-t.Left,r=0,n=0,o=0;o<this.SubFrame.length;++o){var s=this.SubFrame[o],h=s.Frame;h&&h.ChartBorder&&h.ChartBorder.IsShowTitleOnly&&s.Height>0?n+=h.ChartBorder.TitleHeight:r+=s.Height}i-=n;for(o=0;o<this.SubFrame.length;++o){s=this.SubFrame[o],h=s.Frame;if(s.Frame.ChartBorder.Top=this.ChartBorder.Top,s.Frame.ChartBorder.Bottom=this.ChartBorder.Bottom,s.Frame.ChartBorder.LeftExtendWidth=this.ChartBorder.LeftExtendWidth,s.Frame.ChartBorder.RightExtendWidth=this.ChartBorder.RightExtendWidth,h&&h.ChartBorder&&h.ChartBorder.IsShowTitleOnly&&s.Height>0){var l=h.ChartBorder.TitleHeight;s.Frame.ChartBorder.Right=e,s.Frame.ChartBorder.Left=a-l,e+=l,a-=l}else{l=i*(s.Height/r);s.Frame.ChartBorder.Right=e,s.Frame.ChartBorder.Left=a-l,e+=l,a-=l}}}},this.GetYData=function(t,e){for(var a,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeftEx(),o=r.Frame.ChartBorder.GetTop(),s=r.Frame.ChartBorder.GetWidthEx(),h=r.Frame.ChartBorder.GetHeight();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(n,o,s,h),r.Frame.Canvas.isPointInPath(t,o)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a){var l=a.GetYData(t);if(a.GetMainOverlayFrame){var u=a.GetMainOverlayFrame();if(u){if(u[0]){var C=u[0],D=C.GetYData(t);e.RightYValue=l,l=D}if(u[1]){var f=u[1];D=f.GetYData(t);e.RightYValue=D}}}return l}}}function st(){this.newMethod=K,this.newMethod(),delete this.newMethod,this.ScreenImageData,this.Position,this.ClassName="DepthChartFrame",this.VerticalRange={Max:88,Min:8,Center:null,MaxDiffer:null,Differ:null,Step:.05},this.AskPrice,this.BidPrice,this.MinZoom=.05,this.SetPriceList=function(t,e){this.AskPrice=t,this.BidPrice=e},this.DrawFrame=function(){this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth()),i=a*(t-this.VerticalRange.Min)/(this.VerticalRange.Max-this.VerticalRange.Min);return e+i},this.GetXData=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth());return(t-e)/a*(this.VerticalRange.Max-this.VerticalRange.Min)+this.VerticalRange.Min},this.GetXFromPrice=function(t){var e=!1,a=this.GetPrice(this.BidPrice,t);if(null==a&&(a=this.GetPrice(this.AskPrice,t),e=!0),null==a&&this.BidPrice&&Array.isArray(this.BidPrice)&&this.BidPrice.length>0){var i=this.BidPrice[0];t<i&&(e=!1,a=i)}if(null==a&&this.AskPrice&&Array.isArray(this.AskPrice)&&this.AskPrice.length>0){var r=this.AskPrice[this.AskPrice.length-1];t>r&&(e=!0,a=r)}if(null==a)return null;var n=this.GetXFromIndex(a);return{X:n,Price:a,IsAsk:e}},this.GetPrice=function(t,e){if(!t||!Array.isArray(t)||t.length<=0)return null;if(e<t[0]||e>t[t.length-1])return null;var a=null;for(var i in t){var r=t[i];if(e==r)return r;if(e<r)return a;a=r}},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.PtInFrame=function(t,e){var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetWidth(),n=this.ChartBorder.GetHeight();return this.Canvas.beginPath(),this.Canvas.rect(a,i,r,n),this.Canvas.isPointInPath(t,e)?0:-1},this.PtInFrameBorder=function(t,e){return null},this.ZoomUp=function(){var t=this.VerticalRange,e=t.Differ,a=t.MaxDiffer*this.MinZoom;if(e<a)return!1;var i=t.Differ*t.Step;return e-=i,t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0},this.ZoomDown=function(){var t=this.VerticalRange,e=t.Differ;if(e==t.MaxDiffer)return!1;var a=t.Differ*t.Step;return e+=a,e>t.MaxDiffer&&(e=t.MaxDiffer),t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0}}function ht(){this.Date,this.YClose,this.Open,this.Close,this.High,this.Low,this.Vol,this.Amount,this.Time,this.FlowCapital=null,this.Position=null,this.IsVirtual=!1,this.IsNonTrade=!1,this.YFClose=null,this.FClose=null,this.Stop,this.Up,this.Down,this.Unchanged,this.ExtendData,this.BFactor,this.AFactor,this.RightSeed,this.OrderFlow,this.ColorData,this.HeatMap}function lt(){this.Close,this.Open,this.High,this.Low,this.Vol,this.Amount,this.DateTime,this.Increase,this.Risefall,this.AvPrice,this.Lead=null,this.Time,this.Date,this.Position=null,this.YClearing,this.YClose,this.ExtendData}function ut(){this.Time,this.Date,this.Price,this.AvPrice,this.Vol=[],this.ColorID,this.YClose}function Ct(){this.Time,this.Date,this.Price,this.AvPrice,this.Vol=[],this.ColorID,this.YClose}function Dt(){this.Date,this.Time,this.Value}ht.Copy=function(t){var e=new ht;return e.Date=t.Date,sa.IsNumber(t.Time)&&(e.Time=t.Time),e.YClose=t.YClose,e.Open=t.Open,e.Close=t.Close,e.High=t.High,e.Low=t.Low,e.Vol=t.Vol,e.Amount=t.Amount,sa.IsNumber(t.FlowCapital)&&(e.FlowCapital=t.FlowCapital),sa.IsNumber(t.Position)&&(e.Position=t.Position),sa.IsNumber(t.YFClose)&&(e.YFClose=t.YFClose),sa.IsNumber(t.FClose)&&(e.FClose=t.FClose),sa.IsNumber(t.Stop)&&(e.Stop=t.Stop),sa.IsNumber(t.Up)&&(e.Up=t.Up),sa.IsNumber(t.Down)&&(e.Down=t.Down),sa.IsNumber(t.Unchanged)&&(e.Unchanged=t.Unchanged),sa.IsNumber(t.BFactor)&&(e.BFactor=t.BFactor),sa.IsNumber(t.AFactor)&&(e.AFactor=t.AFactor),sa.IsBool(t.IsVirtual)&&(e.IsVirtual=t.IsVirtual),sa.IsBool(t.IsNonTrade)&&(e.IsNonTrade=t.IsNonTrade),t.OrderFlow&&(e.OrderFlow=t.OrderFlow),t.ColorData&&(e.ColorData=t.ColorData),t.ExtendData&&(e.ExtendData=t.ExtendData),t.HeatMap&&(e.HeatMap=t.HeatMap),e},ht.CopyTo=function(t,e){t.Date=e.Date,sa.IsNumber(e.Time)&&(t.Time=e.Time),t.YClose=e.YClose,t.Open=e.Open,t.Close=e.Close,t.High=e.High,t.Low=e.Low,t.Vol=e.Vol,t.Amount=e.Amount,sa.IsNumber(e.FlowCapital)&&(t.FlowCapital=e.FlowCapital),sa.IsNumber(e.Position)&&(t.Position=e.Position),sa.IsNumber(e.YFClose)&&(t.YFClose=e.YFClose),sa.IsNumber(e.FClose)&&(t.FClose=e.FClose),sa.IsNumber(e.Stop)&&(t.Stop=e.Stop),sa.IsNumber(e.Up)&&(t.Up=e.Up),sa.IsNumber(e.Down)&&(t.Down=e.Down),sa.IsNumber(e.Unchanged)&&(t.Unchanged=e.Unchanged),sa.IsNumber(e.BFactor)&&(t.BFactor=e.BFactor),sa.IsNumber(e.AFactor)&&(t.AFactor=e.AFactor),sa.IsBool(e.IsVirtual)&&(t.IsVirtual=e.IsVirtual),sa.IsBool(e.IsNonTrade)&&(t.IsNonTrade=e.IsNonTrade),e.OrderFlow&&(t.OrderFlow=e.OrderFlow),e.ColorData&&(t.ColorData=e.ColorData),e.HeatMap&&(t.HeatMap=e.HeatMap),e.ExtendData&&(t.ExtendData=e.ExtendData)},ht.CopyRight=function(t,e){var a=new ht;return a.Date=t.Date,sa.IsNumber(t.Time)&&(a.Time=t.Time),a.YClose=t.YClose*e,a.Open=t.Open*e,a.Close=t.Close*e,a.High=t.High*e,a.Low=t.Low*e,a.Vol=t.Vol,a.Amount=t.Amount,a.FlowCapital=t.FlowCapital,a.Position=t.Position,a.YFClose=t.YFClose,a.FClose=t.FClose,t.ColorData&&(a.ColorData=t.ColorData),t.ExtendData&&(a.ExtendData=t.ExtendData),a};var ft={INVESTOR:1,ANNOUNCEMENT:2,PFORECAST:3,ANNOUNCEMENT_QUARTER_1:4,ANNOUNCEMENT_QUARTER_2:5,ANNOUNCEMENT_QUARTER_3:6,ANNOUNCEMENT_QUARTER_4:7,RESEARCH:8,BLOCKTRADING:9,TRADEDETAIL:10,ANNOUNCEMENT_EX_START:100,ANNOUNCEMENT_EX_END:200};function ct(){this.ID,this.Date,this.Time,this.Title,this.InfoType,this.ExtendData}var mt=new function(){this.PeriodCallback=new Map,this.GetPeriodCallback=function(t){return this.PeriodCallback.has(t)?this.PeriodCallback.get(t):null},this.AddPeriodCallback=function(t){if(sa.IsNumber(t.Period)&&t.Callback){var e={Period:t.Period,Callback:t.Callback};this.PeriodCallback.set(t.Period,e)}},this.RemovePeriodCallback=function(t){this.PeriodCallback.has(t.ID)&&this.PeriodCallback.delete(t.ID)}};function dt(){this.Data=new Array,this.DataOffset=0,this.Period=0,this.Right=0,this.Symbol,this.Data2=new Array,this.GetCloseMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Close;e[a]=r/t}return e},this.GetVolMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Vol;e[a]=r/t}return e},this.GetAmountMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Amount;e[a]=r/t}return e},this.GetClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Close;return t},this.GetYClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].YClose;return t},this.GetHigh=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].High;return t},this.GetLow=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Low;return t},this.GetOpen=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Open;return t},this.GetVol=function(t){var e=1;sa.IsNumber(t)&&(e=t);var a=new Array;for(var i in this.Data)a[i]=this.Data[i].Vol/e;return a},this.GetAmount=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Amount;return t},this.GetPosition=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Position;return t},this.GetSettlementPrice=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].FClose;return t},this.GetIsEqual=function(){var t=[];for(var e in this.Data){var a=this.Data[e];t[e]=a.Close==a.Open?1:0}return t},this.GetIsUp=function(){var t=[];for(var e in this.Data){var a=this.Data[e];t[e]=a.Close>a.Open?1:0}return t},this.GetIsDown=function(){var t=[];for(var e in this.Data){var a=this.Data[e];t[e]=a.Close<a.Open?1:0}return t},this.GetLead=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Lead;return t},this.GetDate=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Date;return t},this.GetTime=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Time;return t},this.GetUp=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Up;return t},this.GetDown=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Down;return t},this.GetYear=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date/1e4);return t},this.GetMonth=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date%1e4/100);return t},this.GetAvPrice=function(){var t=new Array;for(var e in this.Data){var a=this.Data[e].AvPrice;sa.IsNumber(a)?t[e]=a:t[e]=0}return t},this.GetDateRange=function(){if(!this.Data||this.Data.length<=0)return null;var t=this.Data[0],e=this.Data[this.Data.length-1],a={Start:{Date:t.Date},End:{Date:e.Date}};return sa.IsNumber(t.Time)&&(a.Start.Time=t.Time),sa.IsNumber(e.Time)&&(a.End.Time=e.Time),a},this.GetDateList=function(){if(!this.Data||this.Data.length<=0)return null;for(var t=[],e=new Set,a=0;a<this.Data.length;++a){var i=this.Data[a];sa.IsNumber(i.Date)&&(e.has(i.Date)||(e.add(i.Date),t.push(i.Date)))}return t},this.GetMinutePeriodData=function(t){var e=new Array,a=5;if(5==t)a=5;else if(6==t)a=15;else if(7==t)a=30;else if(8==t)a=60;else if(11==t)a=120;else{if(12!=t)return t>Tt&&t<=vt?(a=t-Tt,this.GetMinuteCustomPeriodData(a)):this.Data;a=240}for(var i=!1,r=null,n=null,o=0;o<this.Data.length;){i=!0;for(var s=0;s<a&&o<this.Data.length;++o){i&&(r=new ht,e.push(r),i=!1);var h=this.Data[o];if(null!=h){if((925!=h.Time||null!=n&&924==n)&&(930!=h.Time||null!=n&&929==n)&&(1300!=h.Time||null!=n&&1259==n)&&++s,r.Date=h.Date,r.Time=h.Time,n=r.Time,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position,r.YFClose=h.YFClose,r.FClose=h.FClose):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,null!=h.Amount&&(r.Amount+=h.Amount),r.Position=h.Position,r.FlowCapital=h.FlowCapital,r.FClose=h.FClose),o+1<this.Data.length)){var l=this.Data[o+1];if(l&&l.Date!=h.Date){++o;break}}}else++s}}return e},this.GetMinuteCustomPeriodData=function(t){for(var e=new Array,a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var o=0;o<a&&n<this.Data.length;++n,++o){i&&(r=new ht,e.push(r),i=!1);var s=this.Data[n];null!=s&&(r.Date=s.Date,r.Time=s.Time,null!=s.Open&&null!=s.Close&&(null==r.Open||null==r.Close?(r.Open=s.Open,r.High=s.High,r.Low=s.Low,r.YClose=s.YClose,r.Close=s.Close,r.Vol=s.Vol,r.Amount=s.Amount,r.FlowCapital=s.FlowCapital,r.Position=s.Position,r.YFClose=s.YFClose,r.FClose=s.FClose):(r.High<s.High&&(r.High=s.High),r.Low>s.Low&&(r.Low=s.Low),r.Close=s.Close,r.Vol+=s.Vol,null!=s.Amount&&(r.Amount+=s.Amount),r.Position=s.Position,r.FlowCapital=s.FlowCapital,r.FClose=s.FClose)))}}return e},this.GetDayPeriodData=function(t){if(t>It&&t<=St)return this.GetDayCustomPeriodData(t-It);var e=Pr.IsBIT(this.Symbol),a=new Array,i=0,r=2,n=null;for(var o in this.Data){var s=!1,h=this.Data[o];switch(t){case 1:if(e)var l=dt.GetSunday(h.Date);else l=dt.GetFirday(h.Date);l!=i&&(s=!0,i=l);break;case 21:if(e)l=dt.GetSunday(h.Date);else l=dt.GetFirday(h.Date);l!=i&&(++r,r>=2&&(s=!0,r=0),i=l);break;case 2:parseInt(h.Date/100)!=parseInt(i/100)&&(s=!0,i=h.Date);break;case 3:parseInt(h.Date/1e4)!=parseInt(i/1e4)&&(s=!0,i=h.Date);break;case 22:var u=dt.GetHalfYear(h.Date);u!=i&&(s=!0,i=u);break;case 9:var C=dt.GetQuarter(h.Date);C=10*parseInt(h.Date/1e4)+C;var D=dt.GetQuarter(i);D=10*parseInt(i/1e4)+D,C!=D&&(s=!0,i=h.Date);break}if(s){if(n=new ht,n.Date=h.Date,a.push(n),null==h.Open||null==h.Close)continue;n.Open=h.Open,n.High=h.High,n.Low=h.Low,n.YClose=h.YClose,n.Close=h.Close,n.Vol=h.Vol,n.Amount=h.Amount,n.FlowCapital=h.FlowCapital,n.Position=h.Position,n.YFClose=h.YFClose,n.FClose=h.FClose}else{if(null==n)continue;if(null==h.Open||null==h.Close)continue;null==n.Open||null==n.Close?(n.Open=h.Open,n.High=h.High,n.Low=h.Low,n.YClose=h.YClose,n.Close=h.Close,n.Vol=h.Vol,n.Amount=h.Amount,n.FlowCapital=h.FlowCapital,n.Position=h.Position,n.YFClose=h.YFClose,n.FClose=h.FClose):(n.High<h.High&&(n.High=h.High),n.Low>h.Low&&(n.Low=h.Low),n.Close=h.Close,n.Vol+=h.Vol,null!=h.Amount&&(n.Amount+=h.Amount),n.Position=h.Position,n.FlowCapital=h.FlowCapital,n.Date=h.Date,n.FClose=h.FClose)}}return a},this.GetDayCustomPeriodData=function(t){for(var e=[],a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var o=0;o<a&&n<this.Data.length;++n,++o){i&&(r=new ht,e.push(r),i=!1);var s=this.Data[n];null!=s&&(r.Date=s.Date,null!=s.Open&&null!=s.Close&&(null==r.Open||null==r.Close?(r.Open=s.Open,r.High=s.High,r.Low=s.Low,r.YClose=s.YClose,r.Close=s.Close,r.Vol=s.Vol,r.Amount=s.Amount,r.FlowCapital=s.FlowCapital,r.Position=s.Position,r.YFClose=s.YFClose,r.FClose=s.FClose):(r.High<s.High&&(r.High=s.High),r.Low>s.Low&&(r.Low=s.Low),r.Close=s.Close,r.Vol+=s.Vol,null!=s.Amount&&(r.Amount+=s.Amount),r.Position=s.Position,r.FlowCapital=s.FlowCapital,r.FClose=s.FClose)))}}return e},this.GetPeriodData=function(t){var e=mt.GetPeriodCallback(t);if(e)return e.Callback(t,this.Data,this);if(Pr.IsBIT(this.Symbol)&&(5==t||6==t||7==t||8==t||t>Tt&&t<=vt)){var a=5;return 5==t?a=5:6==t?a=15:7==t?a=30:8==t?a=60:11==t?a=120:12==t?a=240:t>Tt&&t<=vt&&(a=t-Tt),this.GetMinuteCustomPeriodData(a)}return dt.IsDayPeriod(t,!1)?this.GetDayPeriodData(t):dt.IsMinutePeriod(t,!1)?this.GetMinutePeriodData(t):void 0},this.GetRightData=function(t,e){var a=[];if(this.Data.length<=0)return a;if(e&&1==e.AlgorithmType){for(var i=0;i<this.Data.length;++i){var r=this.Data[i],n=1==t?r.BFactor:r.AFactor;a[i]=ht.CopyRight(r,n)}return a}if(1==t){var o=this.Data.length-1,s=(n=1,this.Data[o].YClose);for(a[o]=ht.Copy(this.Data[o]),a[o].RightSeed=n,--o;o>=0;--o){if(s!=this.Data[o].Close)break;var h=ht.Copy(this.Data[o]);h.RightSeed=n,a[o]=h,s=this.Data[o].YClose}for(;o>=0;--o){var l=this.Data[o].Close;s!=l&&0!=l&&(n*=s/l);h=ht.CopyRight(this.Data[o],n);h.RightSeed=n,a[o]=h,s=this.Data[o].YClose}}else if(2==t){o=0,n=1;var u=this.Data[o].Close;for(a[o]=ht.Copy(this.Data[o]),a[o].RightSeed=n,++o;o<this.Data.length;++o){if(u!=this.Data[o].YClose)break;h=ht.Copy(this.Data[o]);h.RightSeed=n,a[o]=h,u=this.Data[o].Close}for(;o<this.Data.length;++o){u!=this.Data[o].YClose&&(n*=u/this.Data[o].YClose);h=ht.CopyRight(this.Data[o],n);h.RightSeed=n,a[o]=h,u=this.Data[o].Close}}return a},this.GetRightDate=this.GetRightData,this.GetOverlayData=function(t,e){for(var a=[],i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)a[i]=new ht,a[i].Date=n,++i;else{var o=t[r].Date;o==n?(a[i]=new ht,a[i].Date=t[r].Date,a[i].YClose=t[r].YClose,a[i].Open=t[r].Open,a[i].High=t[r].High,a[i].Low=t[r].Low,a[i].Close=t[r].Close,a[i].Vol=t[r].Vol,a[i].Amount=t[r].Amount,a[i].Stop=t[r].Stop,a[i].Up=t[r].Up,a[i].Down=t[r].Down,a[i].Unchanged=t[r].Unchanged,++r,++i):o<n?++r:(a[i]=new ht,a[i].Date=n,++i)}}return a},this.GetOverlayMinuteData=function(t,e){for(var a=[],i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date,o=this.Data[i].Time;if(r>=t.length)a[i]=new ht,a[i].Date=n,a[i].Time=o,++i;else{var s=t[r].Date,h=t[r].Time;s==n&&h==o?(a[i]=new ht,a[i].Date=t[r].Date,a[i].Time=t[r].Time,a[i].YClose=t[r].YClose,a[i].Open=t[r].Open,a[i].High=t[r].High,a[i].Low=t[r].Low,a[i].Close=t[r].Close,a[i].Vol=t[r].Vol,a[i].Amount=t[r].Amount,a[i].Stop=t[r].Stop,a[i].Up=t[r].Up,a[i].Down=t[r].Down,a[i].Unchanged=t[r].Unchanged,++r,++i):s<n||s==n&&h<o?++r:(a[i]=new ht,a[i].Date=n,a[i].Time=o,++i)}}return a},this.GetFittingData=function(t){for(var e=new Array,a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i>=t.length)e[a]=null,++a;else{var n=t[i].Date;if(n==r){var o=new Dt;o.Date=t[i].Date,o.Value=t[i].Value,e[a]=o,++i,++a}else n<r?++i:(e[a]=new Dt,e[a].Date=r,++a)}}return e},this.GetFittingData2=function(t,e){for(var a=new Array,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)a[i]=new Dt,a[i].Date=n,a[i].Value=e,++i;else{var o=t[r].Date;if(o==n){var s=new Dt;s.Date=t[r].Date,s.Value=t[r].Value,a[i]=s,++r,++i}else o<n?++r:(a[i]=new Dt,a[i].Date=n,a[i].Value=e,++i)}}return a},this.GetDateIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date;if(a>=t.length)break;var r=t[a];r.Date==i?(r.Index=e,++a):r.Date<i?++a:++e}},this.GetDateTimeIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date,r=this.Data[e].Time;if(a>=t.length)break;var n=t[a];n.Date==i&&n.Time==r?(n.Index=e,++a):n.Date<i||n.Date==i&&n.Time<r?++a:++e}},this.GetMinuteFittingData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Time;if(i>=t.length)e[a]=null,++a;else{var o=t[i].Date,s=t[i].Time,h=t[i];if(o==r&&s==n){var l=new Dt;l.Date=h.Date,l.Time=h.Time,l.Value=h.Value,e[a]=l,++i,++a}else if(o<r||o==r&&s<n)++i;else{l=new Dt;l.Date=r,l.Time=n,e[a]=l,++a}}}return e},this.GetMinuteFittingDataV2=function(t){for(var e=[],a=null,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date,o=this.Data[i].Time;if(r>=t.length)e[i]=null,++i;else{var s=t[r].Date,h=t[r].Time,l=t[r];if(s==n&&h==o){var u=new Dt;u.Date=l.Date,u.Time=l.Time,u.Value=l.Value,e[i]=u,a=l,++r,++i}else if(s<n||s==n&&h<o){var C=e.length-1;if(C>=0){u=e[C];u&&(s<u.Date||s==u.Date&&h<u.Time)&&(u.Value=l.Value)}a=l,++r}else{u=new Dt;u.Date=n,u.Time=o,a&&(u.Value=a.Value),e[i]=u,++i}}}return e},this.GetFittingFinanceData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i<t.length){var n=t[i].Date;if(r<n){++a;continue}}if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var o=new Dt;o.Date=r,i<t.length?(o.Value=t[i].Value,o.FinanceDate=t[i].Date):(o.Value=null,o.FinanceDate=null),e[a]=o,++a}}return e},this.GetMinuteFittingFinanceData=function(t){var e=[];if(!Array.isArray(t)||t.length<=0)return e;var a=0,i=t[0];for(a=0;a<this.Data.length;++a){var r=this.Data[a].Date,n=this.Data[a].Time;if(r>i.Date||r==i.Date&&n>=i.Time)break}for(var o=0;a<this.Data.length;){r=this.Data[a].Date,n=this.Data[a].Time;if(o+1<t.length&&(t[o].Date<r&&t[o+1].Date<=r||t[o].Date==r&&t[o].Time<n&&t[o+1].Time<=n))++o;else{var s=new Dt;s.Date=r,s.Time=n,o<t.length?(s.Value=t[o].Value,s.FinanceDate=t[o].Date,s.FinanceTime=t[o].Time):(s.Value=null,s.FinanceDate=null,s.FinanceTime=null),e[a]=s,++a}}return e},this.GetFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,o=0;n<this.Data.length;){var s=this.Data[n].Date;if(o<t.length&&t[o].Date>s){var h=new Dt;h.Date=s,h.Value=e,i[n]=h,++n}else if(o+1<t.length&&t[o].Date<s&&t[o+1].Date<=s)++o,r=!1;else{h=new Dt;if(h.Date=s,h.Value=e,h.FinanceDate=null,o<t.length){var l=t[o];0==this.Period&&!0===a?l.Date==h.Date&&(h.Value=l.Value,h.FinanceDate=l.Date,r=!0):0==r&&(h.Value=l.Value,h.FinanceDate=l.Date,r=!0)}i[n]=h,++n}}return i},this.GetMinuteFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,o=0;n<this.Data.length;){var s=this.Data[n].Date,h=this.Data[n].Time;if(o<t.length&&(t[o].Date>s||t[o].Date==s&&t[o].Time>h)){var l=new Dt;l.Date=s,l.Time=h,l.Value=e,i[n]=l,++n}else if(o+1<t.length&&(t[o].Date<s&&t[o+1].Date<=s||t[o].Date==s&&t[o].Time<h&&t[o+1].Time<=h))++o,r=!1;else{l=new Dt;if(l.Date=s,l.FinanceDate=null,l.Time=h,l.Value=e,o<t.length){var u=t[o];4==this.Period&&!0===a?u.Date==l.Date&&u.Time==l.Time&&(l.Value=u.Value,l.FinanceDate=u.Date,l.FinanceTime=u.Time,r=!0):0==r&&(l.Value=u.Value,l.FinanceDate=u.Date,l.FinanceTime=u.Time,r=!0)}i[n]=l,++n}}return i},this.GetFittingMarketValueData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Close;if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var o=new Dt;o.Date=r,o.Value=t[i].Value*n,o.FinanceDate=t[i].Date,e[a]=o,++a}}return e},this.GetFittingMonthData=function(t){for(var e=new Array,a=null,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)e[i]=null,++i;else{var o=t[r].Date;if(o==n){var s=new Dt;s.Date=t[r].Date,s.Value=t[r].Value,s.Text=t[r].Text,e[i]=s,++r,++i}else if(null!=a&&a<o&&n>o){s=new Dt;s.Date=n,s.OverlayDate=t[r].Date,s.Value=t[r].Value,s.Text=t[r].Text,e[i]=s,++r,++i}else o<n?++r:(e[i]=new Dt,e[i].Date=n,++i);a=n}}return e},this.GetValue=function(){var t=[];for(var e in this.Data)if(this.Data[e]&&null!=this.Data[e].Value){var a=this.Data[e].Value;sa.IsNumber(a)||sa.IsString(a)?t[e]=a:t[e]=a instanceof Array?a:null}else t[e]=null;return t},this.GetObject=function(){var t=[];for(var e in this.Data)if(this.Data[e]&&this.Data[e].Value){var a=this.Data[e].Value;t[e]=a}else t[e]=null;return t},this.GetPeriodSingleData=function(t){var e=new Array,a=0,i=2,r=null;for(var n in this.Data){var o=!1,s=this.Data[n];if(null!=s&&null!=s.Date){switch(t){case 1:var h=dt.GetFirday(s.Date);h!=a&&(o=!0,a=h);break;case 21:h=dt.GetFirday(s.Date);h!=a&&(++i,i>=2&&(o=!0,i=0),a=h);break;case 2:parseInt(s.Date/100)!=parseInt(a/100)&&(o=!0,a=s.Date);break;case 3:parseInt(s.Date/1e4)!=parseInt(a/1e4)&&(o=!0,a=s.Date);break;case 9:var l=dt.GetQuarter(s.Date);l=10*parseInt(s.Date/1e4)+l;var u=dt.GetQuarter(a);u=10*parseInt(a/1e4)+u,l!=u&&(o=!0,a=s.Date);break}if(o)r=new Dt,r.Date=s.Date,r.Value=s.Value,e.push(r);else{if(null==r)continue;if(null==s.Value||isNaN(s.Value))continue;(null==r.Value||isNaN(r.Value))&&(r.Value=s.Value)}}}return e},this.GetMinuteAvPrice=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].AvPrice;return t},this.MergeMinuteData=function(t,e){if(!this.Data||this.Data.length<=0)return this.Data=t,!0;for(var a=dt.IsDayPeriod(e,!0),i=this.Data[0],r=0,n=null,o=0;o<t.length;++o){var s=t[o];if(s.Date>i.Date){r=o,n=s;break}if(a){if(s.Date==i.Date){r=o,n=s;break}}else if(s.Date==i.Date&&s.Time>=i.Time){r=o,n=s;break}}if(null==n)return!1;var h=null,l=!1;for(o=this.Data.length-1;o>=0;--o){var u=this.Data[o].Date,C=this.Data[o].Time;if(a){if(n.Date>u||n.Date==u){h=o,n.Date==u&&(l=!0);break}}else if(n.Date>u||n.Date==u&&n.Time>=C){h=o,n.Date==u&&n.Time==C&&(l=!0);break}}if(null==h)return!1;var D=h;o=r;if(1==l){s=t[o];if(D-1>0){var f=this.Data[D-1];s.YClose||(s.YClose=f.Close),!sa.IsNumber(s.FlowCapital)&&sa.IsNumber(f.FlowCapital)&&(s.FlowCapital=f.FlowCapital)}var c=ht.Copy(s);this.Data[D]=c,++D,++o}else++D;for(;o<t.length;){s=t[o];if(D>=this.Data.length-1){if(D-1>0){f=this.Data[D-1];s.YClose||(s.YClose=f.Close),!sa.IsNumber(s.FlowCapital)&&sa.IsNumber(f.FlowCapital)&&(s.FlowCapital=f.FlowCapital)}c=ht.Copy(s);this.Data[D]=c,++D,++o}else{var m=this.Data[D];m.Date==s.Date&&m.Time==s.Time?(ht.CopyTo(m,s),++D,++o):++D}}return!0},this.ConverPeriod=function(t,e,a){for(var i=[],r=null,n=dt.IsMinutePeriod(e,!0),o=dt.IsMinutePeriod(a,!0),s=n&&o,h=n&&!o,l=!n&&!o,C=0,D=0;C<this.Data.length;++C){for(var f=this.Data[C];D<t.length;++D){var c=t[D];if(s){if(c.Date>f.Date||c.Date==f.Date&&c.Time>=f.Time){r=c;break}}else if((h||l)&&c.Date>=f.Date){r=c;break}}var m=null;r?(m=ht.Copy(r),m.PDate=r.Date,m.PTime=r.Time):m=new ht,m.Date=f.Date,(s||h)&&(m.Time=f.Time),i.push(m)}return u.Chart.Log("[ChartData::ConverPeriod] result",i),i},this.GetRef=function(t){for(var e=[],a=0;a<this.Data.length;++a){e[a]=null;var i=this.Data[a];if(a-t<0){var r=new ht;r.Date=i.Date,r.Time=i.Time,e[a]=r}else{var n=this.Data[a-t];r=ht.Copy(n);r.Date=i.Date,r.Time=i.Time,e[a]=r}}return e},this.FitKLineIndex=function(t,e,a,i){for(var r=this.Data.length,n=t.length,o=[dt.IsMinutePeriod(a,!0),dt.IsMinutePeriod(i,!0)],s=[dt.IsDayPeriod(a,!0),dt.IsDayPeriod(i,!0)],h=dt.GetKLineDataTime(this.Data[0]),l=[],u=n,C=0;C<n;++C){var D=dt.GetKLineDataTime(t[C]);if(s[0]&&s[1]||o[0]&&s[1]){if(D.Date>=h.Date){u=C;break}}else if(o[0]&&o[1]){if(D.Date>h.Date){u=C;break}if(D.Date==h.Date&&D.Time>=h.Time){u=C;break}}}C=0;for(var f=u;C<r;){D=dt.GetKLineDataTime(this.Data[C]);if(f>=n){var c={Date:D.Date,Time:D.Time,Index:-1};l[C]=c,++C}else{var m=dt.GetKLineDataTime(t[f]);if(s[0]&&s[1]||o[0]&&s[1])if(m.Date==D.Date){c={Date:D.Date,Time:D.Time,Index:f,Data2:m.Date,Time2:m.Time};l[C]=c,++C}else if(f+1<n){var d=dt.GetKLineDataTime(t[f+1]);if(m.Date<=D.Date&&d.Date>D.Date){c={Date:D.Date,Time:D.Time,Index:f+1,Data2:d.Date,Time2:d.Time};l[C]=c,++C}else if(d.Date<=D.Date)++f;else{c={Date:D.Date,Time:D.Time,Index:-1};l[C]=c,++C}}else++f;else if(o[0]&&o[1])if(m.Date==D.Date&&m.Time==D.Time){c={Date:D.Date,Time:D.Time,Index:f,Data2:m.Date,Time2:m.Time};l[C]=c,++C}else if(f+1<n){d=dt.GetKLineDataTime(t[f+1]);if(m.Date<D.Date&&d.Date>D.Date||m.Date==D.Date&&m.Time<D.Time&&d.Date==D.Date&&d.Time>D.Time||m.Date==D.Date&&m.Time<D.Time&&d.Date>D.Date||m.Date<D.Date&&d.Date==D.Date&&d.Time>D.Time){c={Date:D.Date,Time:D.Time,Index:f+1,Data2:d.Date,Time2:d.Time};l[C]=c,++C}else if(d.Date<D.Date||d.Date==D.Date&&d.Time<=D.Time)++f;else{c={Date:D.Date,Time:D.Time,Index:-1};l[C]=c,++C}}else++f}}var I=[];for(var C in e){D=e[C];if(Array.isArray(D.Data)){var S=[];I[C]={Data:S,Name:D.Name};for(f=0;f<l.length;++f){var T=l[f];S[f]=null,T&&T.Index>=0&&T.Index<D.Data.length&&(S[f]=D.Data[T.Index])}}else I[C]={Data:D.Data,Name:D.Name}}return I},this.FindDataIndexByDateTime=function(t){for(var e=0,a=0;a<t.length;++a)t[a].Index=-1;for(a=0;a<this.Data.length;++a)for(var i=this.Data[a],r=0;r<t.length;++r){var n=t[r];if(!(n.Index>=0)){if(sa.IsNumber(n.Time)){if(n.Date==i.Date&&n.Time==i.Time){n.Index=a,++e;break}}else if(n.Date==i.Date){n.Index=a,++e;break}if(e>=t.length)break}}},this.CloneData=function(t){var e=[];if("HistoryData"==t)for(var a in this.Data){var i=this.Data[a],r=ht.Copy(i);e.push(r)}return e},this.GetAPIDataIndex=function(t,e){var a=[];if(t&&e){for(var i=this.Data.length,r=t.length,n=dt.GetKLineDataTime(this.Data[0]),o=r,s=(o=r,0);s<r;++s){var h=t[s],l=e[s];if(h>n.Date||h==n.Date&&l>=n.Time){o=s;break}}s=0;for(var u=o;s<i;){var C=this.Data[s];if(u>=r){var D={KDate:C.Date,KTime:C.Time,KIndex:s,Index:-1};a[s]=D,++s}else{h=t[u],l=e[u];if(h==C.Date&&l==C.Time){D={KDate:C.Date,KTime:C.Time,KIndex:s,Index:u,Data:h,Time:l};a[s]=D,++s}else if(u+1<r){var f=t[u+1],c=e[u+1];if(h<C.Date&&f>C.Date||h==C.Date&&l<C.Time&&f==C.Date&&c>C.Time||h==C.Date&&l<C.Time&&f>C.Date||h<C.Date&&f==C.Date&&c>C.Time){D={KDate:C.Date,KTime:C.Time,KIndex:s,Index:u,Data:h,Time:l};a[s]=D,++s}else if(f<C.Date||f==C.Date&&c<=C.Time)++u;else{D={KDate:C.Date,KTime:C.Time,KIndex:s,Index:-1};a[s]=D,++s}}else++u}}}else if(t){for(i=this.Data.length,r=t.length,n=dt.GetKLineDataTime(this.Data[0]),o=r,s=0;s<r;++s){C=t[s];if(C>=n.Date){o=s;break}}for(s=0,u=o;s<i;){C=this.Data[s];if(u>=r){D={KDate:C.Date,KIndex:s,Index:-1};a[s]=D,++s}else{var m=t[u];if(m==C.Date){D={KDate:C.Date,KIndex:s,Index:u,Data:m};a[s]=D,++s}else if(u+1<r){var d=t[u+1];if(m<=C.Date&&d>C.Date){D={KDate:C.Date,KIndex:s,Index:u,Data:m};a[s]=D,++s}else if(d<=C.Date)++u;else{D={KDate:C.Date,KIndex:s,Index:-1};a[s]=D,++s}}else++u}}}return a},this.FixKData=function(t,e){return dt.IsDayPeriod(e,!0)?this.FixKData_Day(t):dt.IsMinutePeriod(e,!0)?this.FixKData_Minute(t):null},this.FixKData_Day=function(t){for(var e=[],a=t.length,i=0,r=0;i<this.Data.length;){var n=this.Data[i];if(r<a){var o=t[r];if(o.Date>n.Date){++i;continue}}if(r+1<a){o=t[r];var s=t[r+1];if(o.Date<n.Date&&s.Date<=n.Date){++r;continue}}var h=new ht;h.Date=n.Date;var l=r<a?r:a-1;o=t[l];h.Close=o.Close,h.High=o.High,h.Low=o.Low,h.Open=o.Open,h.YClose=o.YClose,h.Amount=o.Amount,h.Vol=o.Vol,h.ExDate=o.Date,e[i]=h,++i}return e},this.FixKData_Minute=function(t){for(var e=[],a=t.length,i=0,r=0;i<this.Data.length;){var n=this.Data[i],o=dt.DateTimeToNumber(n);if(r<a){var s=t[r],h=dt.DateTimeToNumber(s);if(h>o){++i;continue}}if(r+1<a){s=t[r];var l=t[r+1],u=(h=dt.DateTimeToNumber(s),dt.DateTimeToNumber(l));if(h<o&&u<=o){++r;continue}}var C=new ht;C.Date=n.Date,C.Time=n.Time;var D=r<a?r:a-1;s=t[D];C.Close=s.Close,C.High=s.High,C.Low=s.Low,C.Open=s.Open,C.YClose=s.YClose,C.Amount=s.Amount,C.Vol=s.Vol,C.ExDate=s.Date,C.ExTime=s.Time,e[i]=C,++i}return e},this.GetDataRange=function(t,e){if(!sa.IsNonEmptyArray(this.Data))return null;for(var a={},i=0;i<this.Data.length;++i){var r=this.Data[i];if(r.Date==t.Date&&(sa.IsNumber(t.Time)?r.Time==t.Time&&(a.Start={Index:i,Date:r.Date,Time:r.Time}):a.Start={Index:i,Date:r.Date}),(r.Date=e.Date)&&(sa.IsNumber(e.Time)?r.Time==e.Time&&(a.End={Index:i,Date:r.Date,Time:r.Time}):a.End={Index:i,Date:r.Date}),a.Start&&a.End)return a}return null},this.ExportArrayData=function(t,e){if(!sa.IsNonEmptyArray(this.Data))return null;var a=0,i=this.Data.length-1;e&&e.Start&&e.End&&sa.IsNumber(e.Start.Index)&&sa.IsNumber(e.End.Index)&&(a=e.Start.Index,i=e.End.Index);for(var r=[],n=a;n<=i&&n<this.Data.length;++n)r[n]=this.Data[n];return r},this.ExportBoolData=function(t,e){if(!sa.IsNonEmptyArray(this.Data))return null;var a=0,i=this.Data.length-1;e&&e.Start&&e.End&&sa.IsNumber(e.Start.Index)&&sa.IsNumber(e.End.Index)&&(a=e.Start.Index,i=e.End.Index);for(var r=[],n=a;n<=i&&n<this.Data.length;++n){var o=this.Data[n];r[n]=!1,sa.IsPlusNumber(o)&&(r[n]=!0)}return r},this.ExportKLineData=function(t){if(!sa.IsNonEmptyArray(this.Data))return null;var e=0,a=this.Data.length-1;t&&t.Start&&t.End&&sa.IsNumber(t.Start.Index)&&sa.IsNumber(t.End.Index)&&(e=t.Start.Index,a=t.End.Index);for(var i=[],r=[],n=[],o=[],s=[],h=[],l=[],u=[],C=e;C<=a&&C<this.Data.length;++C){var D=this.Data[C];i[C]=D.Date,r[C]=D.Open,n[C]=D.High,o[C]=D.Low,l[C]=D.Close,s[C]=D.Vol,h[C]=D.Amount,u[C]=D.Time}if(t&&t.IsOverlay){var f=[{Name:"Open",Data:r},{Name:"High",Data:n},{Name:"Low",Data:o},{Name:"Close",Data:l},{Name:"Vol",Data:s},{Name:"Amount",Data:h}];return f}f=[{Name:"Date",Data:i}];return(dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)||dt.IsMilliSecondPeriod(this.Period))&&f.push({Name:"Time",Data:u}),f.push({Name:"Open",Data:r},{Name:"High",Data:n},{Name:"Low",Data:o},{Name:"Close",Data:l},{Name:"Vol",Data:s},{Name:"Amount",Data:h}),f},this.ExportMinuteData=function(t){if(!sa.IsNonEmptyArray(this.Data))return null;var e=[],a=[],i=[],r=[],n=[],o=[],s=[],h=[],l=[],u=[],C=0,D=this.Data.length-1;t&&t.Start&&t.End&&sa.IsNumber(t.Start.Index)&&sa.IsNumber(t.End.Index)&&(C=t.Start.Index,D=t.End.Index);for(var f=C;f<=D&&f<this.Data.length;++f){var c=this.Data[f];e[f]=c.Date,a[f]=c.Open,i[f]=c.High,r[f]=c.Low,s[f]=c.Close,n[f]=c.Vol,o[f]=c.Amount,h[f]=c.Time,u[f]=c.AvPrice,l[f]=c.Position}var m=[{Name:"Open",Data:a},{Name:"High",Data:i},{Name:"Low",Data:r},{Name:"Close",Data:s},{Name:"Vol",Data:n},{Name:"Amount",Data:o},{Name:"AvPrice",Data:u},{Name:"Position",Data:l}];return t&&t.IsOverlay||m.splice(0,0,{Name:"Date",Data:e},{Name:"Time",Data:h}),m}}dt.DateTimeToNumber=function(t){return 1e4*t.Date+t.Time},dt.GetKLineDataTime=function(t){var e={Date:t.Date,Time:0};return sa.IsNumber(t.Time)&&(e.Time=t.Time),e},dt.GetFirday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return t;var i=e.getTime();if(a<5){var r=864e5*(5-a);i+=r}else{r=864e5*(a-5);i-=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},dt.GetSunday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(0==a)return t;var i=e.getTime();if(a>0){var r=864e5*(7-a);i+=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},dt.GetQuarter=function(t){var e=parseInt(t%1e4/100);return 1==e||2==e||3==e?1:4==e||5==e||6==e?2:7==e||8==e||9==e?3:10==e||11==e||12==e?4:0},dt.GetHalfYear=function(t){var e=parseInt(t/1e4),a=t%1e4;return a<=630?1e4*e+630:1e4*e+1231};var It=4e4,St=49999;dt.IsDayPeriod=function(t,e){return 1==t||2==t||3==t||9==t||21==t||22==t||(t>It&&t<=St||0==t&&1==e)};var Tt=2e4,vt=29999;dt.IsMinutePeriod=function(t,e){return 5==t||6==t||7==t||8==t||11==t||12==t||(t>Tt&&t<=vt||4==t&&1==e)};dt.IsSecondPeriod=function(t){return t>3e4&&t<=32e3};function pt(){this.ChartPaint,this.Data,this.Type=0}function gt(t,e,a,i){this.X=t,this.Y=e,this.Width=a,this.Height=i,this.PtInRect=function(t,e){var a=this.X,i=this.X+this.Width,r=this.Y,n=this.Y+this.Height;return t>=a&&t<=i&&e>=r&&e<=n}}dt.IsMilliSecondPeriod=function(t){return t>5e4&&t<=6e4},dt.IsTickPeriod=function(t){return 10==t},dt.GetPeriodName=function(t){var e=new Map([[0,"日线"],[1,"周线"],[2,"月线"],[3,"年线"],[9,"季线"],[21,"双周"],[22,"半年"],[4,"1分"],[5,"5分"],[6,"15分"],[7,"30分"],[8,"60分"],[11,"2小时"],[12,"4小时"],[10,"分笔"]]);return e.has(t)?e.get(t):""},dt.GetKValue=function(t,e){if(!t)return null;switch(e){case"HIGH":case"H":return t.High;case"L":case"LOW":return t.Low;case"C":case"CLOSE":return t.Close;case"O":case"OPEN":return KItem.Open;default:return null}};var xt=new function(){this.DataMap=new Map([["ChartKLine",{Create:function(t){return new Lt}}],["ChartMinuteVolumBar",{Create:function(t){return new Pt}}],["ChartMinutePriceLine",{Create:function(t){return new le}}],["ChartMinuteBuySellBar",{Create:function(t){return new De}}],["ChartMinuteBarCallAuction",{Create:function(t){return new Gt}}]]),this.Create=function(t,e){if(!this.DataMap.has(t))return u.Chart.Warn("[ChartPaintFactory::Create] can't find class=".concat(t,".")),null;var a=this.DataMap.get(t);return a.Create(e)},this.Add=function(t,e){this.DataMap.set(t,{Create:e.Create})}};function Ft(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="IChartPainting",this.Data=new dt,this.Script,this.NotSupportMessage=null,this.MessageFont=qi.Index.NotSupport.Font,this.MessageColor=qi.Index.NotSupport.TextColor,this.IsDrawFirst=!1,this.IsShow=!0,this.IsVisible=!0,this.GetEventCallback,this.SelectedLineWidth=qi.SelectedChart.LineWidth,this.SelectedLineColor=qi.SelectedChart.LineColor,this.SelectedRadius=qi.SelectedChart.Radius,this.SelectedPointMinSpace=qi.SelectedChart.MinSpace,this.SelectedBGColor=qi.SelectedChart.BGColor,this.DrawSelectedStatus,this.PtInChart,this.IsFullRangeMaxMin=!1,this.IsExcludeYValue=!1,this.Draw=function(){},this.BuildKey=function(t){return sa.IsNumber(t.Time)?"".concat(t.Date,"-").concat(t.Time):t.Date},this.SaveCacheData=function(t,e){if(!this.ChartFrame||!this.ChartFrame.GlobalOption)return!1;var a=this.ChartFrame.GlobalOption.MapIndexChartCache;if(!a)return!1;if(!this.Script||!this.Script.Guid)return!1;if(!this.Name)return!1;var i=this.Script.Guid;a.has(i)||a.set(i,{MapData:new Map});var r=a.get(i),n="".concat(this.Name,"-").concat(t);return r.MapData.set(n,e),!0},this.GetCacheData=function(t,e){if(!this.ChartFrame||!this.ChartFrame.GlobalOption)return!1;var a=this.ChartFrame.GlobalOption.MapIndexChartCache;if(!a)return!1;if(!this.Script||!this.Script.Guid)return!1;if(!this.Name)return!1;var i=this.Script.Guid;if(!a.has(i))return!1;var r=a.get(i),n="".concat(this.Name,"-").concat(t);if(!r.MapData.has(n))return!1;var o=r.MapData.get(n);return e&&(e.Data=o,e.Key=n,e.IndexGuid=i),!0},this.GetBorder=function(){return this.ChartFrame.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder()},this.ClipClient=function(t){if(1==t)var e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx()+1,i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();else e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTopEx()-1,r=this.ChartBorder.GetBottomEx();this.Canvas.beginPath(),this.Canvas.rect(e,i,a-e,r-i),this.Canvas.clip()},this.GetYFromData=function(t,e){return this.ChartFrame.GetYFromData(t,e)},this.IsMinuteFrame=function(){var t="MinuteFrame"==this.ChartFrame.ClassName||"MinuteHScreenFrame"==this.ChartFrame.ClassName||"OverlayMinuteFrame"==this.ChartFrame.ClassName||"OverlayMinuteHScreenFrame"==this.ChartFrame.ClassName;return t},this.DrawNotSupportmessage=function(){this.Canvas.font=this.MessageFont,this.Canvas.fillStyle=this.MessageColor;var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeightEx(),r=t+e/2,n=a+i/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.NotSupportMessage,r,n)},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(e=0,t=this.Data.Data.length);var a={Min:null,Max:null};if(!this.Data||!this.Data.Data)return a;for(var i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];null==n||isNaN(n)||(null==a.Max&&(a.Max=n),null==a.Min&&(a.Min=n),a.Max<n&&(a.Max=n),a.Min>n&&(a.Min=n))}return a},this.GetDynamicFont=function(t,e,a,i,r,n){var o=F();if(a*=o,i*=o,a==i){var s="".concat(a.toFixed(0),"px ").concat(n);return s}var h=t+e;r&&(0==r.Type?r.Value>0&&(h=t*r.Value):1==r.Type?r.Value>0&&(h=(t+e)*r.Value):2==r.Type&&sa.IsNumber(r.Value)&&(h=t+e+2*r.Value*o)),h<i?h=i:h>a&&(h=a);s="".concat(h.toFixed(0),"px ").concat(n);return s},this.GetLockRect=function(){return this.ChartFrame.GetLockRect()},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){for(var n=this.Canvas.createLinearGradient(e,a,i,r),o=1/(t.length-1),s=0;s<t.length;++s){var h=s*o;n.addColorStop(h,t[s])}this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t},this.GetDynamicIconSize=function(t,e,a,i,r){var n=F();if(a*=n,i*=n,a==i)return a;var o=t+e-2*n;return r&&(0==r.Type?r.Value>0&&(o=t*r.Value):1==r.Type?r.Value>0&&(o=(t+e)*r.Value):2==r.Type&&sa.IsNumber(r.Value)&&(o=t+e+2*r.Value*n)),o<i?o=i:o>a&&(o=a),o},this.GetFontHeight=function(t){return E(this.Canvas,t,"擎")},this.DrawLinePoint=function(t){var e=!0===this.ChartFrame.IsHScreen;if(!e&&this.IsShow){var a=this.IsMinuteFrame(),i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth,n=this.ChartFrame.XPointCount;if(e)var o=this.ChartBorder.GetHScreenBorder(),s=o.BottomEx,h=o.TopEx+r/2+qi.FrameLeftMargin;else o=this.ChartBorder.GetBorder(),h=o.LeftEx+r/2+qi.FrameLeftMargin,s=o.RightEx;var l=this.GetLockRect();l&&(s=e?l.Top:l.Left);var u=F();this.Canvas.save(),this.ClipClient(e),this.Canvas.lineWidth=this.SelectedLineWidth*u,this.Canvas.strokeStyle=this.SelectedLineColor,this.SelectedBGColor&&(this.Canvas.fillStyle=this.SelectedBGColor);var C=this.SelectedRadius,D=Math.ceil(this.SelectedPointMinSpace/(i+r));if(D<=0&&(D=1),a){var f=(o.Right-o.Left)/n;D=Math.ceil(this.SelectedPointMinSpace/f)}var c=0,m=null,d=null;t&&(t.KLineClose?c=1:t.MinuteVolBar?c=2:t.MinuteOverlayPrice?c=1==t.OverlayType?1:3:t.OverlayKLine?(c=4,m=this.GetFirstOpen()):t.StackedBar&&(c=5));for(var I=this.Data.DataOffset,S=0,T=0;I<this.Data.Data.length&&S<n;++I,++S,++T,h+=i+r){var v=null;if(1==c){var p=this.Data.Data[I];p&&sa.IsNumber(p.Close)&&(v=p.Close)}else if(2==c){p=this.Data.Data[I];p&&sa.IsNumber(p.Vol)&&(v=p.Vol)}else if(3==c){var g=this.Data.Data[I],x=this.MainData.Data[I];if(!g||!sa.IsNumber(g.Close)||!sa.IsNumber(g.YClose))continue;if(!x||!sa.IsNumber(x.Close)||!sa.IsNumber(x.YClose))continue;var E=g.Close;v=E/g.YClose*x.YClose}else if(4==c){var L=this.Data.Data[I];null==d&&(d=L.Open),v=L.Close/d*m}else if(5==c){var M=this.Data.Data[I];if(!sa.IsNonEmptyArray(M))continue;var y=0,R=0;for(T=0;T<M.length;++T){var N=M[T];sa.IsNumber(N)&&(0!=N&&(N>0?y+=N:N<0&&(R+=N)))}v=(y+R)/2}else v=this.Data.Data[I];if(null!=v&&!(T<D)){if(T=0,a)var w=this.ChartFrame.GetXFromIndex(S);else{var A=h,O=h+i;if(O>s)break;w=A+(O-A)/2}var b=this.GetYFromData(v,!1);if(w>s)break;this.Canvas.beginPath(),this.Canvas.arc(w,b,C,0,360,!1),this.Canvas.closePath(),this.SelectedBGColor&&this.Canvas.fill(),this.Canvas.stroke()}}this.Canvas.restore()}},this.PtInLine=function(t,e,a){if(this.IsShow&&!this.ChartFrame.IsMinSize){var i=!0===this.ChartFrame.IsHScreen;if(!i){var r=this.IsMinuteFrame(),n=this.ChartFrame.DataWidth,o=this.ChartFrame.DistanceWidth,s=this.ChartFrame.XPointCount;if(i)var h=this.ChartBorder.GetHScreenBorder(),l=h.BottomEx,u=h.TopEx+o/2+qi.FrameLeftMargin;else h=this.ChartBorder.GetBorder(),u=h.LeftEx+o/2+qi.FrameLeftMargin,l=h.RightEx;var C=this.GetLockRect();if(C&&(l=i?C.Top:C.Left),t<u||t>l)return null;if(e>h.BottomEx||e<h.TopEx)return null;var D={},f={},c=0;a&&(a.KLineClose?c=1:a.MinuteOverlayPrice&&(c=1==a.OverlayType?1:3));for(var m=this.Data.DataOffset,d=0;m<this.Data.Data.length&&d<s;++m,++d,u+=n+o){var I=null;if(1==c){var S=this.Data.Data[m];sa.IsNumber(S.Close)&&(I=S.Close)}else if(3==c){var T=this.Data.Data[m],v=this.MainData.Data[m];if(!T||!sa.IsNumber(T.Close)||!sa.IsNumber(T.YClose))continue;if(!v||!sa.IsNumber(v.Close)||!sa.IsNumber(v.YClose))continue;var p=T.Close;I=p/T.YClose*v.YClose}else I=this.Data.Data[m];if(null!=I){if(r)var g=this.ChartFrame.GetXFromIndex(d);else{var x=u,F=u+n;if(F>l)break;g=x+(F-x)/2}var E=this.GetYFromData(I,!1);if(!(g<t)){if(g==t){D.X=f.X=g,D.Y=f.Y=E;break}f.X=g,f.Y=E;break}if(D.X=g,D.Y=E,t>l)break}}if(!sa.IsNumber(D.X)||!sa.IsNumber(D.Y))return null;if(!sa.IsNumber(f.X)||!sa.IsNumber(f.Y))return null;if(t==D.X&&e==D.Y)return{Identify:this.Identify,Chart:this};if(t==f.X&&e==f.Y)return{Identify:this.Identify,Chart:this};return this.Canvas.beginPath(),D.X==f.X?(this.Canvas.moveTo(D.X-5,D.Y),this.Canvas.lineTo(D.X+5,D.Y),this.Canvas.lineTo(f.X+5,f.Y),this.Canvas.lineTo(f.X-5,f.Y)):(this.Canvas.moveTo(D.X,D.Y+5),this.Canvas.lineTo(D.X,D.Y-5),this.Canvas.lineTo(f.X,f.Y-5),this.Canvas.lineTo(f.X,f.Y+5)),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e)?{Identify:this.Identify,Chart:this}:null}}},this.PtInBar=function(t,e,a){if(!this.IsShow||this.ChartFrame.IsMinSize)return null;var i=!0===this.ChartFrame.IsHScreen;if(i)return null;var r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,o=this.ChartBorder.GetBorder(),s=o.LeftEx+n/2+qi.FrameLeftMargin,h=o.RightEx,l=this.ChartFrame.XPointCount,u=this.GetLockRect();if(u&&(h=u.Left),t<s||t>h)return null;if(e>o.BottomEx||e<o.TopEx)return null;var C=this.IsMinuteFrame(),D=this.ChartFrame.GetYFromData(0),f=null,c=!1,m=!1,d=1;a&&(a.BarWidth>0&&(f=a.BarWidth),1==a.MinuteVolBar?(c=!0,f=4):1==a.StackedBar&&(m=!0),sa.IsNumber(a.VolUnit)&&(d=a.VolUnit));for(var I=this.Data.DataOffset,S=0;I<this.Data.Data.length&&S<l;++I,++S,s+=r+n){var T=this.Data.Data[I];if(null!=T){if(C)var v=this.ChartFrame.GetXFromIndex(S),p=v-f/2,g=p+f;else{p=s,g=s+r;if(g>h)break}if(c){if(!sa.IsNumber(T.Vol))continue;var x=this.ChartFrame.GetYFromData(T.Vol/d),F=x,E=D}else if(m){var L=0,M=0;if(!sa.IsNonEmptyArray(T))continue;for(var y=0;y<T.length;++y){var R=T[y];sa.IsNumber(R)&&(0!=R&&(R>0?L+=R:R<0&&(M+=R)))}F=this.ChartFrame.GetYFromData(L),E=this.ChartFrame.GetYFromData(M)}else x=this.ChartFrame.GetYFromData(T),F=x,E=D;F>E&&(F=D,E=x);var N=p,w=g;if(f>0&&(N=p+(g-p)/2-f/2,w=N+f),t>=N&&t<=w&&e>=F&&e<=E)return{Identify:this.Identify,Chart:this};if(g>t)break}}return null},this.PtInKBar=function(t,e,a){if(!this.IsShow||this.ChartFrame.IsMinSize)return null;var i=!0===this.ChartFrame.IsHScreen;if(i)return null;var r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,o=this.ChartBorder.GetBorder(),s=o.LeftEx+n/2+qi.FrameLeftMargin,h=o.RightEx,l=this.ChartFrame.XPointCount;if(i){o=this.ChartBorder.GetHScreenBorder();s=o.TopEx+n/2+qi.FrameLeftMargin,h=o.BottomEx}if(t<s||t>h)return null;if(e>o.BottomEx||e<o.TopEx)return null;var u=null,C=0,D=null;a&&a.OverlayKLine&&(C=1,D=this.GetFirstOpen());for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<l;++f,++c,s+=r+n){var m=this.Data.Data[f];if(m&&null!=m.Open&&null!=m.High&&null!=m.Low&&null!=m.Close){null==u&&(u=m.Open);var d=s,I=s+r;if(I>h)break;if(t>=d&&t<=I){if(1==C)var S=this.GetYFromData(m.Low/u*D,!1),T=this.GetYFromData(m.High/u*D,!1);else S=this.GetYFromData(m.Low,!1),T=this.GetYFromData(m.High,!1);if(e<=S&&e>=T)return{Identify:this.Identify,Chart:this}}if(I>t)break}}},this.IsShowIndexTitleOnly=function(){return!!(this.ChartFrame&&this.ChartFrame.ChartBorder&&this.ChartFrame.ChartBorder.IsShowTitleOnly)},this.IsHideScriptIndex=function(){return!(!this.Script||0!=this.Script.IsShow)},this.ExportArrayData=function(t,e){var a=this.Data.ExportArrayData(t,e);return[{Name:this.Name,Data:a}]},this.ExportBoolData=function(t,e){var a=this.Data.ExportBoolData(t,e);return[{Name:this.Name,Data:a}]},this.GetArrayItemData=function(t){if(!t)return null;if(!sa.IsNumber(t.Index))return null;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return null;var e=t.Index;if(e<0||e>=this.Data.Data.length)return null;var a=this.Data.Data[e];return[{Value:a,Color:this.Color,Name:this.Name}]}}Ft.CACHE_KEY={SELECTED:"_Selected_Key_"};var Et=[[48,10],[44,10],[40,9],[36,9],[32,8],[28,8],[24,7],[20,7],[18,6],[16,6],[15,5],[13,5],[9,4],[7,4],[5,4],[3,3],[3,1],[2,1],[1,1],[1,0]];function Lt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartKLine",this.Symbol,this.DrawType=0,this.CloseLineColor=qi.CloseLineColor,this.CloseLineAreaColor=qi.CloseLineAreaColor,this.CloseLineWidth=qi.CloseLineWidth,this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.UnchagneColor=qi.UnchagneBarColor,this.ColorData,this.TradeData,this.TradeIcon=qi.KLine.TradeIcon,this.TooltipRect=[],this.InfoTooltipRect=[],this.TradeIconTooltipRect=[],this.IsShowMaxMinPrice=!0,this.IsShowKTooltip=!0,this.TextFont=qi.KLine.MaxMin.Font,this.TextColor=qi.KLine.MaxMin.Color,this.InfoData,this.InfoPosition=0,this.PtMax,this.PtMin,this.TickSymbol="╳",this.TickFontName="arial",this.Period,this.ShowRange={},this.CustomKLine,this.DrawKRange={Start:null,End:null},this.IsThinAKBar=!0,this.OneLimitBarType=0,this.UnchangeBarType=0,this.EnableColorBar=!1,this.HighLowBarColor=qi.HighLowBarColor,this.HighLowTextConfig={FontName:qi.HighLowText.FontName,MaxSize:qi.HighLowText.MaxSize,MinSize:qi.HighLowText.MinSize,Color:qi.HighLowText.Color,MaxText:qi.HighLowText.MaxText},this.HLCAreaConfig={HighLineColor:qi.HLCArea.HighLineColor,LowLineColor:qi.HLCArea.LowLineColor,CloseLineColor:qi.HLCArea.CloseLineColor,LineWidth:qi.HLCArea.LineWidth,UpAreaColor:qi.HLCArea.UpAreaColor,DownAreaColor:qi.HLCArea.DownAreaColor},this.VirtualBarConfig={Color:qi.VirtualKLine.Color,LineDash:qi.VirtualKLine.LineDash},this.PredictionConfig={Line:{Color:qi.PredictionKLine.Line.Color,LineDash:qi.PredictionKLine.Line.LineDash,LineWidth:qi.PredictionKLine.Line.LineWidth},Bar:{UpColor:qi.PredictionKLine.Bar.UpColor,DownColor:qi.PredictionKLine.Bar.DownColor,UnchangeColor:qi.PredictionKLine.Bar.UnchangeColor,DrawType:qi.PredictionKLine.Bar.DrawType},Enable:!1},this.AryPredictionCache=[],this.FFKChart,this.OrderFlow={UpColor:{BG:qi.OrderFlow.UpColor.BG,Border:qi.OrderFlow.UpColor.Border},DownColor:{BG:qi.OrderFlow.DownColor.BG,Border:qi.OrderFlow.DownColor.Border},UnchagneColor:{BG:qi.OrderFlow.UnchagneColor.BG,Border:qi.OrderFlow.UnchagneColor.Border},Text:{Color:qi.OrderFlow.Text.Color,Family:qi.OrderFlow.Text.Family,FontMaxSize:qi.OrderFlow.Text.FontMaxSize,MaxValue:qi.OrderFlow.Text.MaxValue},Line:{UpDownColor:qi.OrderFlow.Line.UpDownColor,MiddleColor:qi.OrderFlow.Line.MiddleColor},POCGBColor:qi.OrderFlow.POCGBColor,ShowType:0,AskBarColor:qi.OrderFlow.AskBarColor,BidBarColor:qi.OrderFlow.BidBarColor,AlwaysShowOrderText:qi.OrderFlow.AlwaysShowOrderText,IsShowAskText:!0,IsShowAskBar:!1,IsShowBidText:!0,IsShowBidBar:!1,IsShowPOCBG:!0},this.OrderFlow_Style2={BarWidth:qi.OrderFlow_Style2.BarWidth,UpColor:qi.OrderFlow_Style2.UpColor,DownColor:qi.OrderFlow_Style2.DownColor,UnchagneColor:qi.OrderFlow_Style2.UnchagneColor},this.OrderFlow_Style3={BarWidth:qi.OrderFlow_Style3.BarWidth,UpColor:qi.OrderFlow_Style3.UpColor,DownColor:qi.OrderFlow_Style3.DownColor,UnchagneColor:qi.OrderFlow_Style3.UnchagneColor},this.OrderFlow_Style4={UpColor:qi.OrderFlow_Style4.UpColor,DownColor:qi.OrderFlow_Style4.DownColor,UnchagneColor:qi.OrderFlow_Style4.UnchagneColor,KBarType:1,VolBarSpace:qi.OrderFlow_Style4.VolBarSpace,KBarWidth:qi.OrderFlow_Style4.KBarWidth,LeftMargin:qi.OrderFlow_Style4.LeftMargin,RightMargin:qi.OrderFlow_Style4.RightMargin},this.OrderFlow_Style5={AskBarColor:qi.OrderFlow_Style5.AskBarColor,BidBarColor:qi.OrderFlow_Style5.BidBarColor,LeftMargin:qi.OrderFlow_Style5.LeftMargin,RightMargin:qi.OrderFlow_Style5.RightMargin},this.IsShowOrderText=!1,this.AryOrderFlowBorder=[],this.ChartHeatMap,this.PriceGap={Enable:!1,Count:1},this.PriceGapStyple={Line:{Color:qi.PriceGapStyple.Line.Color},Text:{Color:qi.PriceGapStyple.Text.Color,Font:qi.PriceGapStyple.Text.Font}},this.AryPriceGapCache=[],this.AryBreakPoint,this.DaySummary={MapDate:new Map,Enable:!1},this.DaySummaryConfig={Font:qi.DaySummaryKLine.Font,TextColor:qi.DaySummaryKLine.TextColor,LeftMargin:qi.DaySummaryKLine.LeftMargin},this.AddToDaySummary=function(t){return!!this.DaySummary.Enable&&(!!t&&(!!sa.IsPlusNumber(t.Date)&&(!this.DaySummary.MapDate.has(t.Date)&&void this.DaySummary.MapDate.set(t.Date,{Date:t.Date}))))},this.ClearDaySummary=function(){this.DaySummary.MapDate.clear()},this.BuildDateTimeKey=function(t){return t?sa.IsNumber(t.Time)?"".concat(t.Date,"-").concat(t.Time):"".concat(t.Date):null},this.BuildBreakPoint=function(){if(!sa.IsNonEmptyArray(this.AryBreakPoint))return null;for(var t=new Map,e=0;e<this.AryBreakPoint.length;++e){var a=this.AryBreakPoint[e],i=this.BuildDateTimeKey(a);i&&t.set(i,a)}return t},this.ReloadResource=function(t){this.TextFont=qi.KLine.MaxMin.Font,this.TextColor=qi.KLine.MaxMin.Color,this.CloseLineColor=qi.CloseLineColor,this.CloseLineAreaColor=qi.CloseLineAreaColor,this.CloseLineWidth=qi.CloseLineWidth,this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.UnchagneColor=qi.UnchagneBarColor,this.HighLowBarColor=qi.HighLowBarColor,this.OrderFlow.UpColor={BG:qi.OrderFlow.UpColor.BG,Border:qi.OrderFlow.UpColor.Border},this.OrderFlow.DownColor={BG:qi.OrderFlow.DownColor.BG,Border:qi.OrderFlow.DownColor.Border},this.OrderFlow.UnchagneColor={BG:qi.OrderFlow.UnchagneColor.BG,Border:qi.OrderFlow.UnchagneColor.Border},this.OrderFlow.Text={Color:qi.OrderFlow.Text.Color,Family:qi.OrderFlow.Text.Family,FontMaxSize:qi.OrderFlow.Text.FontMaxSize,MaxValue:qi.OrderFlow.Text.MaxValue},this.OrderFlow.Line={UpDownColor:qi.OrderFlow.Line.UpDownColor,MiddleColor:qi.OrderFlow.Line.MiddleColor},this.PredictionConfig.Line={Color:qi.PredictionKLine.Line.Color,LineDash:qi.PredictionKLine.Line.LineDash,LineWidth:qi.PredictionKLine.Line.LineWidth},this.PredictionConfig.Bar={UpColor:qi.PredictionKLine.Bar.UpColor,DownColor:qi.PredictionKLine.Bar.DownColor,UnchangeColor:qi.PredictionKLine.Bar.UnchangeColor,DrawType:qi.PredictionKLine.Bar.DrawType},this.DaySummaryConfig={Font:qi.DaySummaryKLine.Font,TextColor:qi.DaySummaryKLine.TextColor,LeftMargin:qi.DaySummaryKLine.LeftMargin}},this.ClearCustomKLine=function(){this.CustomKLine=null},this.ClearBreakPoint=function(){this.AryBreakPoint=null},this.GetCustomKLine=function(t){if(!this.CustomKLine)return null;if(!t)return null;var e=1e6*t.Date;if(sa.IsNumber(t.Time)&&(e+=t.Time),!this.CustomKLine.has(e))return null;var a=this.CustomKLine.get(e);return a},this.DrawHeatMap=function(){this.ChartHeatMap&&(this.ChartHeatMap.Canvas=this.Canvas,this.ChartHeatMap.ChartBorder=this.ChartBorder,this.ChartHeatMap.ChartFrame=this.ChartFrame,this.ChartHeatMap.Data=this.Data,this.ChartHeatMap.Draw())},this.ClearHeatMap=function(){this.ChartHeatMap=null},this.CreateHeatMap=function(){this.ChartHeatMap=new yt},this.DrawAKLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx;var s=this.UpColor,h=this.DownColor,l=this.UnchagneColor,u={X:null,Y:null,Value:null,Align:"left"},C={X:null,Y:null,Value:null,Align:"left"};this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;var D=null;this.GetEventCallback&&(D=this.GetEventCallback(m.ON_CUSTOM_UNCHANGE_KLINE_COLOR));for(var f=null,c=this.Data.DataOffset,d=0;c<this.Data.Data.length&&d<i;++c,++d,n+=e+a,++this.ShowRange.DataCount){var I=this.Data.Data[c];if(this.ShowRange.End=c,null!=I.Open&&null!=I.High&&null!=I.Low&&null!=I.Close){var S=n,T=n+e;if(T>o)break;var v=S+(T-S)/2,p=this.GetYFromData(I.Low,!1),g=this.GetYFromData(I.High,!1),x=this.GetYFromData(I.Open,!1),F=this.GetYFromData(I.Close,!1);this.DrawKRange.End=c,this.AddToDaySummary(I);var E={Data:I,Coordinate:{X:v,Low:p,High:g,Close:F,Open:x,Left:S,Right:T}};if((null==u.Value||u.Value<I.High)&&(u.X=v,u.Y=g,u.Value=I.High,u.Align=d<i/2?"left":"right"),(null==C.Value||C.Value>I.Low)&&(C.X=v,C.Y=p,C.Value=I.Low,C.Align=d<i/2?"left":"right"),l=this.UnchagneColor,I.Open<I.Close)this.Canvas.strokeStyle=this.UpColor;else if(I.Open>I.Close)this.Canvas.strokeStyle=this.DownColor;else{if(D&&D.Callback){var L={KItem:I,DataIndex:c,DefaultColor:l,BarColor:null};D.Callback(D,L,this),L.BarColor&&(l=L.BarColor)}this.Canvas.strokeStyle=l}if(this.ColorData&&(s=h=l=c<this.ColorData.length&&this.ColorData[c]>0?this.UpColor:this.DownColor),0==this.IsThinAKBar&&e>=9){var M={YLow:p,YHigh:g,YOpen:x,YClose:F,X:v,Left:S,Right:T},y={UpColor:s,DownColor:h,UnchangeColor:l};this.DrawAKBar(I,e,t,M,y)}else this.Canvas.beginPath(),t?I.High==I.Low&&e<4?(this.Canvas.moveTo(g,A(v)),this.Canvas.lineTo(p-1,A(v))):(this.Canvas.moveTo(g,A(v)),this.Canvas.lineTo(p,A(v))):I.High==I.Low&&e<4?(this.Canvas.moveTo(A(v),g),this.Canvas.lineTo(A(v),p+1)):(this.Canvas.moveTo(A(v),g),this.Canvas.lineTo(A(v),p)),this.Canvas.stroke(),e>=4&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(A(x),S),this.Canvas.lineTo(A(x),v)):(this.Canvas.moveTo(S,A(x)),this.Canvas.lineTo(v,A(x))),this.Canvas.stroke(),this.Canvas.beginPath(),t?(this.Canvas.moveTo(A(F),T),this.Canvas.lineTo(A(F),v)):(this.Canvas.moveTo(T,A(F)),this.Canvas.lineTo(v,A(F))),this.Canvas.stroke());if(0==this.Data.DataType){var R={Xleft:S,XRight:T,YMax:g,XCenter:v,YMin:p,DayData:I,Index:d};this.DrawInfo(R)}if(this.PriceGap.Enable&&f){this.CheckPriceGap(E);var N=this.IsPriceGap(E,f);N>0&&this.AryPriceGapCache.push({Data:[f,E],Type:N})}f=E}}this.PtMax=u,this.PtMin=C},this.DrawAKBar=function(t,e,a,i,r){var n=e/3,o=b(i.Left),s=[o,b(o+n),b(o+2*n),b(o+3*n)],h=i.YHigh,l=i.YLow,u=i.YOpen,C=i.YClose;if(t.Open<t.Close?(this.Canvas.strokeStyle=r.UpColor,this.Canvas.fillStyle=r.UpColor):t.Open>t.Close?(this.Canvas.strokeStyle=r.DownColor,this.Canvas.fillStyle=r.DownColor):(this.Canvas.strokeStyle=r.UnchangeColor,this.Canvas.fillStyle=r.UnchangeColor),a)if(t.High==t.Low){var D=h-n/2;this.Canvas.fillRect(D,s[1],n,s[2]-s[1])}else this.Canvas.fillRect(h,s[1],l-h,s[2]-s[1]);else if(t.High==t.Low){D=h-n/2;this.Canvas.fillRect(s[1],D,s[2]-s[1],n)}else this.Canvas.fillRect(s[1],h,s[2]-s[1],l-h);D=u-n/2;a?this.Canvas.fillRect(D,s[0],n,s[1]-s[0]):this.Canvas.fillRect(s[0],D,s[1]-s[0],n);D=C-n/2;a?this.Canvas.fillRect(D,s[2],n,s[3]-s[2]):this.Canvas.fillRect(s[2],D,s[3]-s[2],n)},this.DrawCloseArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx,s=r.TopEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,s=r.LeftEx;var h=!0,l=null;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor,sa.IsNumber(this.CloseLineWidth)&&(this.Canvas.lineWidth=this.CloseLineWidth);var u=null;if(this.Data.DataOffset>0){var C=this.Data.Data[this.Data.DataOffset-1];if(C&&sa.IsNumber(C.Close)){var D=s,f=this.GetYFromData(C.Close,!1);t?(this.Canvas.moveTo(f,D),l={X:f,Y:D}):(this.Canvas.moveTo(D,f),l={X:D,Y:f}),h=!1}}this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var c=null,m=null,d=null,I=this.Data.DataOffset,S=0;I<this.Data.Data.length&&S<i;++I,++S,n+=e+a,++this.ShowRange.DataCount){C=this.Data.Data[I];if(this.ShowRange.End=I,null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var T=n,v=n+e;if(v>o)break;D=T+(v-T)/2,f=this.GetYFromData(C.Close,!1);if(this.DrawKRange.End=I,this.AddToDaySummary(C),C.IsVirtual&&this.PredictionConfig.Enable)this.AryPredictionCache.push({PrePoint:m,Point:{X:D,Y:f}}),m={X:D,Y:f};else if(h?(t?(this.Canvas.moveTo(f,D),l={X:f,Y:D}):(this.Canvas.moveTo(D,f),l={X:D,Y:f}),h=!1):t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),d=D,m={X:D,Y:f},I==this.Data.Data.length-1&&(u={X:D,Y:f,XLeft:T,XRight:v,KItem:C,ChartRight:o}),this.PriceGap.Enable){var p=this.GetYFromData(C.Low,!1),g=this.GetYFromData(C.High,!1),x=this.GetYFromData(C.Open,!1),F={Data:C,Coordinate:{X:D,Low:p,High:g,Close:f,Open:x,Left:T,Right:v}};if(c){this.CheckPriceGap(F);var E=this.IsPriceGap(F,c);E>0&&this.AryPriceGapCache.push({Data:[c,F],Type:E})}c=F}}}if(this.DrawLastPointEvent(u),!h){if(this.Canvas.stroke(),t?(this.Canvas.lineTo(r.Left,d),this.Canvas.lineTo(r.Left,l.Y)):(this.Canvas.lineTo(d,r.Bottom),this.Canvas.lineTo(l.X,r.Bottom)),this.Canvas.closePath(),Array.isArray(this.CloseLineAreaColor))if(t){var L=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());L.addColorStop(0,this.CloseLineAreaColor[0]),L.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=L}else{var M=this.Canvas.createLinearGradient(l.X,this.ChartBorder.GetTopEx(),l.X,this.ChartBorder.GetBottom());M.addColorStop(0,this.CloseLineAreaColor[0]),M.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=M}else this.Canvas.fillStyle=this.CloseLineAreaColor;this.Canvas.fill()}},this.DrawCloseLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx;var s=!0,h=0;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor,sa.IsNumber(this.CloseLineWidth)&&(this.Canvas.lineWidth=this.CloseLineWidth),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var l=this.BuildBreakPoint(),u=null,C=null,D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<i;++D,++f,n+=e+a,++this.ShowRange.DataCount){var c=this.Data.Data[D];if(this.ShowRange.End=D,c&&null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var m=n,d=n+e;if(d>o)break;var I=m+(d-m)/2,S=this.GetYFromData(c.Close,!1);if(this.DrawKRange.End=D,this.AddToDaySummary(c),c.IsVirtual&&this.PredictionConfig.Enable)this.AryPredictionCache.push({PrePoint:C,Point:{X:I,Y:S}}),C={X:I,Y:S};else{if(s?(t?this.Canvas.moveTo(S,I):this.Canvas.moveTo(I,S),s=!1):t?this.Canvas.lineTo(S,I):this.Canvas.lineTo(I,S),++h,C={X:I,Y:S},this.PriceGap.Enable){var T=this.GetYFromData(c.Low,!1),v=this.GetYFromData(c.High,!1),p=this.GetYFromData(c.Open,!1),g={Data:c,Coordinate:{X:I,Low:T,High:v,Close:S,Open:p,Left:m,Right:d}};if(u){this.CheckPriceGap(g);var x=this.IsPriceGap(g,u);x>0&&this.AryPriceGapCache.push({Data:[u,g],Type:x})}u=g}if(l){var F=c,E=this.BuildDateTimeKey(F);E&&l.has(E)&&(h>0&&this.Canvas.stroke(),s=!0,h=0)}}}}h>0&&this.Canvas.stroke()},this.DrawKBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}var s={X:null,Y:null,Value:null,Align:"left"},h={X:null,Y:null,Value:null,Align:"left"},l=this.UpColor,u=this.DownColor,C=this.UnchagneColor;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o;var D=null;this.DrawKRange.Start=this.Data.DataOffset;var f=null;this.GetEventCallback&&(f=this.GetEventCallback(m.ON_CUSTOM_UNCHANGE_KLINE_COLOR));for(var c=null,d=this.Data.DataOffset,I=0;d<this.Data.Data.length&&I<o;++d,++I,r+=e+a,++this.ShowRange.DataCount){var S=this.Data.Data[d];if(this.ShowRange.End=d,S&&null!=S.Open&&null!=S.High&&null!=S.Low&&null!=S.Close){var T=r,v=r+e;if(v>n)break;var p=T+(v-T)/2,g=this.GetYFromData(S.Low,!1),x=this.GetYFromData(S.High,!1),F=this.GetYFromData(S.Open,!1),E=this.GetYFromData(S.Close,!1),L=x,M={Data:S,Coordinate:{X:p,Low:g,High:x,Close:E,Open:F,Left:T,Right:v}};this.AddToDaySummary(S),this.DrawKRange.End=d,(null==s.Value||s.Value<S.High)&&(s.X=p,s.Y=x,s.Value=S.High,s.Align=I<o/2?"left":"right"),(null==h.Value||h.Value>S.Low)&&(h.X=p,h.Y=g,h.Value=S.Low,h.Align=I<o/2?"left":"right"),this.ColorData&&(l=u=C=d<this.ColorData.length&&this.ColorData[d]>0?this.UpColor:this.DownColor);var y=this.GetCustomKLine(S);if(S.IsNonTrade)this.DrawVirtualBar(S,e,p,L,T,v,g,x,F,E,t);else if(S.IsVirtual&&this.PredictionConfig.Enable)this.DrawPredictionBar(S,e,p,L,T,v,g,x,F,E,t);else if(y){var R=y.Color;R||(R=S.Open<S.Close?l:S.Open>S.Close?u:C);var N=this.DrawType;sa.IsNumber(y.DrawType)&&(N=y.DrawType),this.DrawKBar_Custom(S,e,R,N,y,p,L,T,v,g,x,F,E,i,t)}else if((9==this.DrawType||this.EnableColorBar)&&S.ColorData)this.DrawColorKBar(S,S.ColorData,e,p,L,T,v,g,x,F,E,t);else if(S.Open<S.Close)this.DrawKBar_Up(S,e,l,this.DrawType,p,L,T,v,g,x,F,E,t);else if(S.Open>S.Close)this.DrawKBar_Down(S,e,u,this.DrawType,p,L,T,v,g,x,F,E,t);else{R=C;if(f&&f.Callback){var w={KItem:S,DataIndex:d,DefaultColor:R,BarColor:null};f.Callback(f,w,this),w.BarColor&&(R=w.BarColor)}this.DrawKBar_Unchagne(S,e,R,this.DrawType,p,L,T,v,g,x,F,E,t)}if(this.IsShowKTooltip&&!t){var A=Math.min(F,E),O=Math.max(F,E);Math.abs(F-E)<5&&(A=Math.min(x,A-5),O=Math.max(g,O+5)),S.IsNonTrade&&(A=x,O=g);var b=new gt(T,A,e,O-A);this.TooltipRect.push([d,b])}if(0==this.Data.DataType||1==this.Data.DataType){var B={Xleft:T,XRight:v,XCenter:p,YMax:x,YMin:g,DayData:S,Index:I};this.DrawInfo(B)}if(d==this.Data.Data.length-1&&(D={X:p,Y:E,XLeft:T,XRight:v,KItem:S,ChartRight:n}),this.PriceGap.Enable&&c){this.CheckPriceGap(M);var P=this.IsPriceGap(M,c);P>0&&this.AryPriceGapCache.push({Data:[c,M],Type:P})}({X:p,Y:E}),c=M}}this.DrawLastPointEvent(D),this.PtMax=s,this.PtMin=h},this.DrawKBar_Up=function(t,e,a,i,r,n,o,s,h,l,u,C,D){var f=3==i||6==i;if(e>=4){if(f&&e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(A(n),A(r)),this.Canvas.lineTo(A(3==i?Math.max(C,u):C),A(r));else if(f){var c=o+e/2;this.Canvas.moveTo(A(c),A(n)),this.Canvas.lineTo(A(c),A(Math.min(C,u)))}else this.Canvas.moveTo(A(r),A(n)),this.Canvas.lineTo(A(r),A(C));this.Canvas.stroke(),n=C}else n=C;if(this.Canvas.fillStyle=a,D?Math.abs(u-n)<1?this.Canvas.fillRect(b(n),b(o),1,b(e)):f?(this.Canvas.beginPath(),this.Canvas.rect(A(n),A(o),b(u-n),b(e)),this.Canvas.stroke()):this.Canvas.fillRect(b(n),b(o),b(u-n),b(e)):Math.abs(u-n)<1?this.Canvas.fillRect(b(o),b(n),b(e),1):f?(this.Canvas.beginPath(),this.Canvas.rect(A(o),A(n),b(e),b(u-n)),this.Canvas.stroke()):this.Canvas.fillRect(b(o),b(Math.min(n,u)),b(e),b(Math.abs(u-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(A(3==i?Math.min(C,u):n),A(r)),this.Canvas.lineTo(A(h),A(r));else if(f){c=o+e/2;this.Canvas.moveTo(A(c),A(Math.max(C,u))),this.Canvas.lineTo(A(c),A(h))}else this.Canvas.moveTo(A(r),A(n)),this.Canvas.lineTo(A(r),A(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,A(r)),this.Canvas.lineTo(h,A(r))):(this.Canvas.moveTo(A(r),l),this.Canvas.lineTo(A(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Down=function(t,e,a,i,r,n,o,s,h,l,u,C,D){var f=6==i;if(e>=4){if(f&&e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(A(n),A(r)),this.Canvas.lineTo(A(u),A(r));else if(f){var c=o+e/2;this.Canvas.moveTo(A(c),A(n)),this.Canvas.lineTo(A(c),A(Math.min(C,u)))}else this.Canvas.moveTo(A(r),A(n)),this.Canvas.lineTo(A(r),A(u));this.Canvas.stroke(),n=u}else n=u;if(this.Canvas.fillStyle=a,D?Math.abs(C-n)<1?this.Canvas.fillRect(b(n),b(o),1,b(e)):this.Canvas.fillRect(b(n),b(o),b(C-n),b(e)):Math.abs(C-n)<1?this.Canvas.fillRect(b(o),b(n),b(e),1):f?(this.Canvas.beginPath(),this.Canvas.rect(A(o),A(Math.min(n,C)),b(e),b(Math.abs(C-n))),this.Canvas.stroke()):this.Canvas.fillRect(b(o),b(Math.min(n,C)),b(e),b(Math.abs(C-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(A(n),A(r)),this.Canvas.lineTo(A(h),A(r));else if(f){c=o+e/2;this.Canvas.moveTo(A(c),A(Math.max(C,u))),this.Canvas.lineTo(A(c),A(h))}else this.Canvas.moveTo(A(r),A(n)),this.Canvas.lineTo(A(r),A(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,A(r)),this.Canvas.lineTo(h,A(r))):(this.Canvas.moveTo(A(r),l),this.Canvas.lineTo(A(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Unchagne=function(t,e,a,i,r,n,o,s,h,l,u,C,D){if(1==this.UnchangeBarType&&(a=this.GetUnchangeBarColor(t)),1===this.OneLimitBarType&&this.IsOneLimitBar(t)&&(a=this.GetOneLimitBarColor(t)),e>=4){if(e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,this.Canvas.beginPath(),t.High>t.Close){if(D)this.Canvas.moveTo(n,A(r)),this.Canvas.lineTo(u,A(r));else{var f=A(o+e/2);this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,u)}n=u}else n=u;if(D?(this.Canvas.moveTo(A(n),A(o)),this.Canvas.lineTo(A(n),A(s))):(this.Canvas.moveTo(A(o),A(n)),this.Canvas.lineTo(A(o+e),A(n))),t.Open>t.Low)if(D)this.Canvas.moveTo(A(n),A(r)),this.Canvas.lineTo(A(h),A(r));else{f=A(o+e/2);this.Canvas.moveTo(f,A(n)),this.Canvas.lineTo(f,A(h))}this.Canvas.stroke()}else this.Canvas.beginPath(),D?t.High==t.Low?(this.Canvas.moveTo(l,A(r)),this.Canvas.lineTo(h-1,A(r))):(this.Canvas.moveTo(l,A(r)),this.Canvas.lineTo(h,A(r))):t.High==t.Low?(this.Canvas.moveTo(A(r),l),this.Canvas.lineTo(A(r),h+1)):(this.Canvas.moveTo(A(r),l),this.Canvas.lineTo(A(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.IsOneLimitBar=function(t){return t.Open==t.Close&&t.High==t.Low&&t.Open==t.High},this.GetOneLimitBarColor=function(t){return t&&sa.IsNumber(t.YClose)?t.Close>t.YClose?this.UpColor:t.Close<t.YClose?this.DownColor:this.UnchagneColor:this.UnchagneColor},this.GetUnchangeBarColor=function(t){return t&&sa.IsNumber(t.YClose)?t.Close>t.YClose?this.UpColor:t.Close<t.YClose?this.DownColor:this.UnchagneColor:this.UnchagneColor},this.DrawKBar_Custom=function(t,e,a,i,r,n,o,s,h,l,u,C,D,f,c){if(r.BGColor){this.Canvas.fillStyle=r.BGColor;var m=this.ChartFrame.DistanceWidth;if(c){var d=s-m/2,I=h+m/2,S=f.RightEx,T=f.LeftEx;this.Canvas.fillRect(b(T),b(d),b(S-T),b(I-d))}else{var v=s-m/2,p=h+m/2,g=f.TopEx,x=f.BottomEx;this.Canvas.fillRect(b(v),b(g),b(p-v),b(x-g))}}e>=4?(this.Canvas.strokeStyle=a,t.High>t.Close?(this.Canvas.beginPath(),c?(this.Canvas.moveTo(A(o),A(n)),this.Canvas.lineTo(A(3==i?Math.max(D,C):D),A(n))):(this.Canvas.moveTo(A(n),A(o)),this.Canvas.lineTo(A(n),A(3==i?Math.min(D,C):D))),this.Canvas.stroke(),o=D):o=D,this.Canvas.fillStyle=a,c?Math.abs(C-o)<1?this.Canvas.fillRect(b(o),b(s),1,b(e)):3==i?(this.Canvas.beginPath(),this.Canvas.rect(A(o),A(s),b(C-o),b(e)),this.Canvas.stroke()):this.Canvas.fillRect(b(o),b(s),b(C-o),b(e)):Math.abs(C-o)<1?this.Canvas.fillRect(b(s),b(o),b(e),1):3==i?(this.Canvas.beginPath(),this.Canvas.rect(A(s),A(o),b(e),b(C-o)),this.Canvas.stroke()):this.Canvas.fillRect(b(s),b(Math.min(o,C)),b(e),b(Math.abs(C-o))),t.Open>t.Low&&(this.Canvas.beginPath(),c?(this.Canvas.moveTo(A(3==i?Math.min(D,C):o),A(n)),this.Canvas.lineTo(A(l),A(n))):(this.Canvas.moveTo(A(n),A(3==i?Math.max(D,C):o)),this.Canvas.lineTo(A(n),A(l))),this.Canvas.stroke())):(this.Canvas.beginPath(),c?(this.Canvas.moveTo(u,A(n)),this.Canvas.lineTo(l,A(n))):(this.Canvas.moveTo(A(n),u),this.Canvas.lineTo(A(n),l)),this.Canvas.strokeStyle=a,this.Canvas.stroke())},this.DrawColorKBar=function(t,e,a,i,r,n,o,s,h,l,u,C){Math.abs(u-l)<1?this.DrawColorKBar_Line(t,e,a,i,r,n,o,s,h,l,u,C):e.Border||0===e.Type?this.DrawColorKBar_Border(t,e,a,i,r,n,o,s,h,l,u,C):this.DrawColorKBar_NoBorder(t,e,a,i,r,n,o,s,h,l,u,C)},this.DrawColorKBar_Border=function(t,e,a,i,r,n,o,s,h,l,u,C){if(a>=4){a%2!=0&&(a-=1);var D=Math.max(t.Close,t.Open),f=Math.min(t.Close,t.Open);if(C)var c=Math.max(u,l),m=Math.min(u,l);else c=Math.min(u,l),m=Math.max(u,l);var d=Math.abs(u-l);if(t.High>D&&e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(A(h),A(i)),this.Canvas.lineTo(A(c),A(i));else{var I=n+a/2;this.Canvas.moveTo(A(I),A(h)),this.Canvas.lineTo(A(I),A(c))}this.Canvas.stroke()}if(f>t.Low&&e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(A(m),A(i)),this.Canvas.lineTo(A(s),A(i));else{I=n+a/2;this.Canvas.moveTo(A(I),A(m)),this.Canvas.lineTo(A(I),A(s))}this.Canvas.stroke()}if(C){var S=new Path2D;S.rect(A(m),A(n),b(d),b(a))}else{S=new Path2D;S.rect(A(n),A(c),b(a),b(d))}0==e.Type?(e.BarColor&&(this.Canvas.strokeStyle=e.BarColor,this.Canvas.stroke(S)),e.Border&&(this.Canvas.strokeStyle=e.Border.Color,this.Canvas.stroke(S))):1==e.Type&&(e.BarColor&&(this.Canvas.fillStyle=e.BarColor,this.Canvas.fill(S)),e.Border&&(this.Canvas.strokeStyle=e.Border.Color,this.Canvas.stroke(S)))}else this.DrawColorKBar_MinBar(t,e,a,i,r,n,o,s,h,l,u,C)},this.DrawColorKBar_NoBorder=function(t,e,a,i,r,n,o,s,h,l,u,C){if(a>=4){var D=Math.max(t.Close,t.Open),f=Math.min(t.Close,t.Open);if(C)var c=Math.max(u,l),m=Math.min(u,l);else c=Math.min(u,l),m=Math.max(u,l);var d=Math.abs(u-l);if(t.High>D&&e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(A(h),A(i)),this.Canvas.lineTo(A(c),A(i));else{var I=n+a/2;this.Canvas.moveTo(A(I),A(h)),this.Canvas.lineTo(A(I),A(c))}this.Canvas.stroke()}if(f>t.Low&&e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(A(m),A(i)),this.Canvas.lineTo(A(s),A(i));else{I=n+a/2;this.Canvas.moveTo(A(I),A(m)),this.Canvas.lineTo(A(I),A(s))}this.Canvas.stroke()}if(C){var S=new Path2D;S.rect(b(m),b(n),b(d),b(a))}else{S=new Path2D;S.rect(b(n),b(c),b(a),b(d))}1==e.Type&&e.BarColor&&(this.Canvas.fillStyle=e.BarColor,this.Canvas.fill(S))}else this.DrawColorKBar_MinBar(t,e,a,i,r,n,o,s,h,l,u,C)},this.DrawColorKBar_MinBar=function(t,e,a,i,r,n,o,s,h,l,u,C){e.Line&&(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C?(this.Canvas.moveTo(A(h),A(i)),this.Canvas.lineTo(A(s),A(i))):(this.Canvas.moveTo(A(i),A(h)),this.Canvas.lineTo(A(i),A(s))),this.Canvas.stroke())},this.DrawColorKBar_Line=function(t,e,a,i,r,n,o,s,h,l,u,C){var D;if(a>=4)e.Line&&(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C?(this.Canvas.moveTo(A(h),A(i)),this.Canvas.lineTo(A(s),A(i))):(this.Canvas.moveTo(A(i),A(h)),this.Canvas.lineTo(A(i),A(s))),this.Canvas.stroke()),(0==e.Type||1==e.Type)&&(e.Border?D=e.Border.Color:e.BarColor&&(D=e.BarColor)),D&&(this.Canvas.strokeStyle=D,this.Canvas.beginPath(),C?(this.Canvas.moveTo(A(l),A(n)),this.Canvas.lineTo(A(l),A(o))):(this.Canvas.moveTo(A(n),A(l)),this.Canvas.lineTo(A(o),A(l))),this.Canvas.stroke());else if(e.Line){this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C?(this.Canvas.moveTo(A(h),A(i)),this.Canvas.lineTo(A(s),A(i))):(this.Canvas.moveTo(A(i),A(h)),this.Canvas.lineTo(A(i),A(s))),this.Canvas.stroke()}},this.DrawVirtualBar=function(t,e,a,i,r,n,o,s,h,l,u){var C=Math.min(s,o),D=Math.max(s,o);this.Canvas.strokeStyle=this.VirtualBarConfig.Color,this.Canvas.setLineDash(this.VirtualBarConfig.LineDash),u?e>=4?this.Canvas.strokeRect(A(C),A(r),b(D-C),b(e)):(this.Canvas.beginPath(),this.Canvas.moveTo(C,A(a)),this.Canvas.lineTo(D,A(a)),this.Canvas.stroke()):e>=4?this.Canvas.strokeRect(A(r),A(C),b(e),b(D-C)):(this.Canvas.beginPath(),this.Canvas.moveTo(A(a),C),this.Canvas.lineTo(A(a),D),this.Canvas.stroke()),this.Canvas.setLineDash([])},this.DrawPredictionBar=function(t,e,a,i,r,n,o,s,h,l,u){var C=this.PredictionConfig.Bar,D=this.DrawType;sa.IsNumber(C.DrawType)&&(D=C.DrawType),t.Open<t.Close?this.DrawKBar_Up(t,e,C.UpColor,D,a,i,r,n,o,s,h,l,u):t.Open>t.Close?this.DrawKBar_Down(t,e,C.DownColor,D,a,i,r,n,o,s,h,l,u):this.DrawKBar_Unchagne(t,e,C.UnchangeColor,D,a,i,r,n,o,s,h,l,u)},this.DrawPredictionLine=function(){if(sa.IsNonEmptyArray(this.AryPredictionCache)){this.Canvas.save();for(var t=!0===this.ChartFrame.IsHScreen,e=!0,a=0,i=0;i<this.AryPredictionCache.length;++i){var r=this.AryPredictionCache[i];if(e){if(e=!1,this.Canvas.beginPath(),r.PrePoint){var n=r.PrePoint;t?this.Canvas.moveTo(n.Y,n.X):this.Canvas.moveTo(n.X,n.Y);n=r.Point;t?this.Canvas.lineTo(n.Y,n.X):this.Canvas.lineTo(n.X,n.Y)}else if(r.Point){n=r.Point;t?this.Canvas.moveTo(n.Y,n.X):this.Canvas.moveTo(n.X,n.Y)}}else{n=r.Point;t?this.Canvas.lineTo(n.Y,n.X):this.Canvas.lineTo(n.X,n.Y)}++a}if(a>0){var o=F(),s=this.PredictionConfig.Line;this.Canvas.strokeStyle=s.Color,sa.IsNumber(s.LineWidth)&&(this.Canvas.lineWidth=s.LineWidth*o),sa.IsNonEmptyArray(s.LineDash)&&this.Canvas.setLineDash(s.LineDash),this.Canvas.stroke()}this.Canvas.restore()}},this.DrawRenkoCandle=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx;var s={X:null,Y:null,Value:null,Align:"left"},h={X:null,Y:null,Value:null,Align:"left"};this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<i;++l,++u,n+=e+a,++this.ShowRange.DataCount){var C=this.Data.Data[l];if(this.ShowRange.End=l,null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=n,f=n+e;if(f>o)break;var c=D+(f-D)/2,m=this.GetYFromData(C.Low,!1),d=this.GetYFromData(C.High,!1);this.DrawKRange.End=l,(null==s.Value||s.Value<C.High)&&(s.X=c,s.Y=d,s.Value=C.High,s.Align=u<i/2?"left":"right"),(null==h.Value||h.Value>C.Low)&&(h.X=c,h.Y=m,h.Value=C.Low,h.Align=u<i/2?"left":"right"),C.YClose<C.Close?(this.Canvas.strokeStyle=this.UpColor,this.Canvas.fillStyle=this.UpColor):C.YClose>C.Close&&(this.Canvas.strokeStyle=this.DownColor,this.Canvas.fillStyle=this.DownColor),e>=4?t?this.Canvas.fillRect(b(m),b(D),b(Math.abs(m-d)),b(e)):this.Canvas.fillRect(b(D),b(d),b(e),b(Math.abs(m-d))):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(d,A(c)),this.Canvas.lineTo(m,A(c))):(this.Canvas.moveTo(A(c),d),this.Canvas.lineTo(A(c),m)),this.Canvas.stroke())}}this.PtMax=s,this.PtMin=h},this.DrawLineBreak=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=a/2;if(t)var n=this.ChartBorder.GetHScreenBorder(),o=n.TopEx+a/2+qi.FrameLeftMargin-r,s=n.BottomEx;else n=this.ChartBorder.GetBorder(),o=n.LeftEx+a/2+qi.FrameLeftMargin-r,s=n.RightEx;var h={X:null,Y:null,Value:null,Align:"left"},l={X:null,Y:null,Value:null,Align:"left"};this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<i;++u,++C,o+=e+a,++this.ShowRange.DataCount){var D=this.Data.Data[u];if(this.ShowRange.End=u,null!=D.Open&&null!=D.High&&null!=D.Low&&null!=D.Close){var f=o,c=o+e+a;if(c>s)break;var m=f+(c-f)/2,d=this.GetYFromData(D.Low,!1),I=this.GetYFromData(D.High,!1);this.DrawKRange.End=u,(null==h.Value||h.Value<D.High)&&(h.X=m,h.Y=I,h.Value=D.High,h.Align=C<i/2?"left":"right"),(null==l.Value||l.Value>D.Low)&&(l.X=m,l.Y=d,l.Value=D.Low,l.Align=C<i/2?"left":"right"),D.YClose<D.Close?(this.Canvas.strokeStyle=this.UpColor,this.Canvas.fillStyle=this.UpColor):D.YClose>D.Close&&(this.Canvas.strokeStyle=this.DownColor,this.Canvas.fillStyle=this.DownColor),e>=4?t?this.Canvas.fillRect(b(d),b(f),b(Math.abs(d-I)),b(e+a)):this.Canvas.fillRect(b(f),b(I),b(e+a),b(Math.abs(d-I))):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(I,A(m)),this.Canvas.lineTo(d,A(m))):(this.Canvas.moveTo(A(m),I),this.Canvas.lineTo(A(m),d)),this.Canvas.stroke())}}this.PtMax=h,this.PtMin=l},this.DrawKagi=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx,s=r.TopEx+qi.FrameLeftMargin;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,s=r.Left+qi.FrameLeftMargin;var h={X:null,Y:null,Value:null,Align:"left"},l={X:null,Y:null,Value:null,Align:"left"};this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;var u=2*F();this.Canvas.lineWidth=u;var C={Item:null,X:s,Y:null},D=this.Data.DataOffset-1;if(D>=0&&D<this.Data.Data.length){var f=this.Data.Data[D];C.Item=f,1==f.Direction?C.Y=this.GetYFromData(f.High,!1):2==f.Direction&&(C.Y=this.GetYFromData(f.Low,!1))}for(var c=this.Data.DataOffset,m=0;c<this.Data.Data.length&&m<i;++c,++m,n+=e+a,++this.ShowRange.DataCount){var d=this.Data.Data[c];if(this.ShowRange.End=c,null!=d.Open&&null!=d.High&&null!=d.Low&&null!=d.Close){s=n;var I=n+e;if(I>o)break;var S=s+(I-s)/2,T=this.GetYFromData(d.Low,!1),v=this.GetYFromData(d.High,!1);this.DrawKRange.End=c,(null==h.Value||h.Value<d.High)&&(h.X=S,h.Y=v,h.Value=d.High,h.Align=m<i/2?"left":"right"),(null==l.Value||l.Value>d.Low)&&(l.X=S,l.Y=T,l.Value=d.Low,l.Align=m<i/2?"left":"right");var p=O(u,S);if(C.Item){this.Canvas.beginPath();var g=O(u,C.Y);this.Canvas.moveTo(C.X,g),this.Canvas.lineTo(p,g);var x=null;if(1==C.Item.Direction?x=C.Item.Low:2==C.Item.Direction&&(x=C.Item.High),1==d.Direction)if(d.High<x)this.Canvas.lineTo(p,v),this.Canvas.strokeStyle=this.DownColor,this.Canvas.stroke();else{var E=this.GetYFromData(x,!1);this.Canvas.lineTo(p,E),this.Canvas.strokeStyle=this.DownColor,this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.moveTo(p,E),this.Canvas.lineTo(p,v),this.Canvas.strokeStyle=this.UpColor,this.Canvas.stroke()}else if(2==d.Direction)if(d.Low>x)this.Canvas.lineTo(p,T),this.Canvas.strokeStyle=this.DownColor,this.Canvas.stroke();else{E=this.GetYFromData(x,!1);this.Canvas.lineTo(p,E),this.Canvas.strokeStyle=this.DownColor,this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.moveTo(p,E),this.Canvas.lineTo(p,T),this.Canvas.strokeStyle=this.UpColor,this.Canvas.stroke()}}else this.Canvas.beginPath(),1==d.Direction?(this.Canvas.moveTo(p,T),this.Canvas.lineTo(p,v)):2==d.Direction&&(this.Canvas.moveTo(p,v),this.Canvas.lineTo(p,T)),this.Canvas.stroke();C.Item=d,C.X=S,1==d.Direction?C.Y=v:2==d.Direction&&(C.Y=T)}}this.PtMax=h,this.PtMin=l},this.DrawTrade=function(){if(this.TradeData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var o=this.TradeData.Sell,s=this.TradeData.Buy,h=e;h>10&&(h=10);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=!1,f=!1;if(o&&l<o.length&&(f=o[l]>0),s&&l<s.length&&(D=s[l]>0),f||D){var c=i,m=i+e;if(m>r)break;var d=c+(m-c)/2,I=this.GetYFromData(C.Low,!1),S=this.GetYFromData(C.High,!1);this.GetYFromData(C.Open,!1),this.GetYFromData(C.Close,!1);D&&(this.Canvas.fillStyle=this.UpColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(I-1,d),this.Canvas.lineTo(I-h-1,d-h/2),this.Canvas.lineTo(I-h-1,d+h/2)):(this.Canvas.moveTo(d,I+1),this.Canvas.lineTo(d-h/2,I+h+1),this.Canvas.lineTo(d+h/2,I+h+1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()),f&&(this.Canvas.fillStyle=this.DownColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(S+1,d),this.Canvas.lineTo(S+h+1,d-h/2),this.Canvas.lineTo(S+h+1,d+h/2)):(this.Canvas.moveTo(d,S-1),this.Canvas.lineTo(d-h/2,S-h-1),this.Canvas.lineTo(d+h/2,S-h-1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke())}}}}},this.DrawTick=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var n=this.ChartFrame.XPointCount,o=parseInt(e);o<=1?o=2:o>=18&&(o=18);var s=F(),h=o*s;this.Canvas.beginPath(),this.Canvas.font=o*s+"px "+this.TickFontName,this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=n,this.DrawKRange.Start=this.Data.DataOffset;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=e+a){var C=this.Data.Data[l];if(this.ShowRange.End=l,null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=i,f=i+e;if(f>r)break;var c=D+(f-D)/2,m=this.ChartFrame.GetYFromData(C.Close,!1);if(this.DrawKRange.End=l,0===C.Flag?this.Canvas.fillStyle=this.UpColor:1==C.Flag?this.Canvas.fillStyle=this.DownColor:this.Canvas.fillStyle=this.UnchagneColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",t?this.Canvas.fillText(this.TickSymbol,m,c):this.Canvas.fillText(this.TickSymbol,c,m),this.IsShowKTooltip&&!t){var d=new gt(c-h/2,m-h/2,h,h);this.TooltipRect.push([l,d])}}}},this.DrawHLCArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx,s=r.TopEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,s=r.LeftEx;var h=new Path2D,l=new Path2D,u=new Path2D,C=new Path2D,D=new Path2D,f=[],c=[],m=[],d=!0;if(this.Data.DataOffset>0){var I=this.Data.Data[this.Data.DataOffset-1];if(I&&sa.IsNumber(I.Close)&&sa.IsNumber(I.High)&&sa.IsNumber(I.Low)){var S=s,T=this.GetYFromData(I.Close,!1),v=this.GetYFromData(I.High,!1),p=this.GetYFromData(I.Low,!1);t?(u.moveTo(T,S),l.moveTo(v,S),h.moveTo(p,S),C.moveTo(v,S),D.moveTo(p,S),m.push({X:T,Y:S}),f.push({X:v,Y:S}),c.push({X:p,Y:S})):(u.moveTo(S,T),l.moveTo(S,v),h.moveTo(S,p),C.moveTo(S,v),D.moveTo(S,p),m.push({X:S,Y:T}),f.push({X:S,Y:v}),c.push({X:S,Y:p})),d=!1}}this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var g=this.Data.DataOffset,x=0;g<this.Data.Data.length&&x<i;++g,++x,n+=e+a,++this.ShowRange.DataCount){I=this.Data.Data[g];if(this.ShowRange.End=g,I&&sa.IsNumber(I.Close)&&sa.IsNumber(I.High)&&sa.IsNumber(I.Low)){var F=n,E=n+e;if(E>o)break;S=F+(E-F)/2,T=this.GetYFromData(I.Close,!1),v=this.GetYFromData(I.High,!1),p=this.GetYFromData(I.Low,!1);this.DrawKRange.End=g,d?(t?(u.moveTo(T,S),l.moveTo(v,S),h.moveTo(p,S),C.moveTo(v,S),D.moveTo(p,S)):(u.moveTo(S,T),l.moveTo(S,v),h.moveTo(S,p),C.moveTo(S,v),D.moveTo(S,p)),d=!1):t?(u.lineTo(T,S),l.lineTo(v,S),h.lineTo(p,S),C.lineTo(v,S),D.lineTo(p,S)):(u.lineTo(S,T),l.lineTo(S,v),h.lineTo(S,p),C.lineTo(S,v),D.lineTo(S,p)),t?(m.push({X:T,Y:S}),f.push({X:v,Y:S}),c.push({X:p,Y:S})):(m.push({X:S,Y:T}),f.push({X:S,Y:v}),c.push({X:S,Y:p}))}}if(!d){for(g=m.length-1;g>=0;--g){var L=m[g];C.lineTo(L.X,L.Y),D.lineTo(L.X,L.Y)}C.closePath(),D.closePath(),this.Canvas.fillStyle=this.HLCAreaConfig.UpAreaColor,this.Canvas.fill(C),this.Canvas.fillStyle=this.HLCAreaConfig.DownAreaColor,this.Canvas.fill(D),sa.IsNumber(this.HLCAreaConfig.LineWidth)&&(this.Canvas.lineWidth=this.HLCAreaConfig.LineWidth),this.Canvas.strokeStyle=this.HLCAreaConfig.CloseLineColor,this.Canvas.stroke(u),this.Canvas.strokeStyle=this.HLCAreaConfig.HighLineColor,this.Canvas.stroke(l),this.Canvas.strokeStyle=this.HLCAreaConfig.LowLineColor,this.Canvas.stroke(h)}},this.ClipTickClient=function(t){var e=this.GetBorder();if(1==t)var a=this.ChartBorder.GetLeftEx(),i=this.ChartBorder.GetRightEx(),r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetBottom();else a=e.Left,i=e.Right,r=e.TopTitle,n=e.Bottom;this.Canvas.beginPath(),this.Canvas.rect(a,r,i-a,n-r),this.Canvas.clip()},this.ClipWindow=function(t){if(1==t)var e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRightEx(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();else e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetBottom();this.Canvas.beginPath(),this.Canvas.rect(e,i,a-e,r-i),this.Canvas.clip()},this.ClipClient=function(t){if(1==t)var e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();else{e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetBottomEx();this.ChartBorder.BottomSpace>0&&(r+=1),13==this.DrawType&&(i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.GetBottom())}this.Canvas.beginPath(),this.Canvas.rect(e,i,a-e,r-i),this.Canvas.clip()},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&(this.ClearDaySummary(),this.IsShowOrderText=!1,this.TooltipRect=[],this.InfoTooltipRect=[],this.TradeIconTooltipRect=[],this.PtMax={X:null,Y:null,Value:null,Align:"left"},this.PtMin={X:null,Y:null,Value:null,Align:"left"},this.DrawKRange={Start:null,End:null},this.AryPriceGapCache=[],this.AryPredictionCache=[],this.ChartFrame.ChartKLine={Max:null,Min:null},this.DrawHeatMap(),this.IsShow&&(!this.ChartFrame.IsMinSize||"Self Kline"!=this.Name))){if(dt.IsTickPeriod(this.Period))return this.Canvas.save(),1==this.DrawType?(this.ClipClient(this.ChartFrame.IsHScreen),this.DrawCloseLine()):4==this.DrawType?(this.ClipClient(this.ChartFrame.IsHScreen),this.DrawCloseArea()):(this.ClipTickClient(this.ChartFrame.IsHScreen),this.DrawTick()),void this.Canvas.restore();if(this.Canvas.save(),this.ClipClient(this.ChartFrame.IsHScreen),1==this.DrawType)return this.DrawCloseLine(),this.Canvas.restore(),this.DrawPredictionLine(),void(this.PriceGap.Enable&&this.DrawPriceGap());2==this.DrawType?this.DrawAKLine():4==this.DrawType?this.DrawCloseArea():5==this.DrawType?this.DrawOrderFlow():7==this.DrawType?this.DrawOrderFlow_Style2():8==this.DrawType?this.DrawOrderFlow_Style3():9==this.DrawType?this.DrawKBar():10==this.DrawType?this.DrawRenkoCandle():12==this.DrawType?this.DrawLineBreak():13==this.DrawType?this.DrawHighLow():14==this.DrawType?this.FFKChart&&this.FFKChart.Draw&&this.FFKChart.Draw(this):15==this.DrawType?this.DrawHLCArea():16==this.DrawType?this.DrawKagi():17==this.DrawType?this.DrawOrderFlow_Style4():18==this.DrawType?this.DrawOrderFlow_Style5():this.DrawKBar(),this.TradeIcon?this.DrawTradeIcon():this.DrawTrade(),this.Canvas.restore(),this.DrawPredictionLine(),this.PriceGap.Enable&&this.DrawPriceGap(),this.IsShowMaxMinPrice&&(!0===this.ChartFrame.IsHScreen?this.HScreenDrawMaxMinPrice(this.PtMax,this.PtMin):this.DrawMaxMinPrice(this.PtMax,this.PtMin)),14==this.DrawType&&this.FFKChart&&this.FFKChart.DrawMaxMinPrice&&this.FFKChart.DrawMaxMinPrice(),this.DrawDaySummary()}},this.OnFormatHighLowTitle=function(t,e){if(!t||!e)return null;if(!sa.IsNumber(t.Value)||!sa.IsNumber(e.Value))return null;var a=Jr(this.Symbol),i={High:t.Value.toFixed(a),Low:e.Value.toFixed(a)};if(!this.GetEventCallback)return i;var r=this.GetEventCallback(m.ON_FORMAT_KLINE_HIGH_LOW_TITLE);if(!r||!r.Callback)return i;var n={Max:t,Min:e,Symbol:this.Symbol,Title:{High:i.High,Low:i.Low},Decimal:a,PreventDefault:!1};return r.Callback(r,n,this),n.PreventDefault?n.Title:i},this.DrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=this.OnFormatHighLowTitle(t,e);if(a){var i=qi.KLine.MaxMin.LeftArrow,r=qi.KLine.MaxMin.RightArrow,n=qi.KLine.MaxMin.HighYOffset,o=qi.KLine.MaxMin.LowYOffset;Jr(this.Symbol);this.Canvas.font=this.TextFont;var s=this.ChartBorder.GetTopEx(),h=this.ChartBorder.GetBottomEx(),l=t,u=a.High,C=this.TextColor;if(1==this.ChartFrame.CoordinateType){t.Y<e.Y&&(l=e),this.Canvas.textBaseline="top";u=a.Low;a.LowColor&&(C=a.LowColor)}else t.Y>e.Y&&(l=e),this.Canvas.textBaseline="bottom",a.HighColor&&(C=a.HighColor);this.Canvas.fillStyle=C,this.Canvas.textAlign=l.Align;var D=(l.Align,l.X);if(sa.IsNumber(n)&&(l.Y+=n),"left"==l.Align?u=i+u:u+=r,l.Y>s-2){var f=R(this.Canvas,u),c=f.Width,m=f.Height;if(1==this.ChartFrame.CoordinateType){var d={Width:c,Height:m,Top:l.Y};d.Bottom=d.Top+d.Height}else{d={Width:c,Height:m,Bottom:l.Y};d.Top=d.Bottom-d.Height}"left"==l.Align?(d.Left=D,d.Right=d.Left+d.Width):(d.Right=D,d.Left=d.Right-d.Width),this.Canvas.fillText(u,D,l.Y),this.ChartFrame.ChartKLine.Max={X:D,Y:l.Y,Text:{BaseLine:"bottom"},Rect:d}}var I=e;u=a.Low,C=this.TextColor;if(1==this.ChartFrame.CoordinateType){e.Y>t.Y&&(I=t),this.Canvas.textBaseline="bottom";u=a.High;a.HighColor&&(C=a.HighColor)}else t.Y>e.Y&&(l=e),this.Canvas.textBaseline="top",a.LowColor&&(C=a.LowColor);this.Canvas.fillStyle=C,this.Canvas.textAlign=I.Align;D=(I.Align,I.X);if(sa.IsNumber(o)&&(I.Y+=o),"left"==I.Align?u=i+u:u+=r,I.Y<h+1){f=R(this.Canvas,u),c=f.Width,m=f.Height;if(1==this.ChartFrame.CoordinateType){d={Width:c,Height:m,Bottom:I.Y};d.Top=d.Bottom-d.Height}else{d={Width:c,Height:m,Top:I.Y};d.Bottom=d.Top+d.Height}"left"==I.Align?(d.Left=D,d.Right=d.Left+d.Width):(d.Right=D,d.Left=d.Right-d.Width),this.Canvas.fillText(u,D,I.Y),this.ChartFrame.ChartKLine.Min={X:D,Y:I.Y,Text:{BaseLine:"top"},Rect:d}}}}},this.HScreenDrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=this.OnFormatHighLowTitle(t,e);if(a){var i=qi.KLine.MaxMin.LeftArrow,r=qi.KLine.MaxMin.RightArrow,n=qi.KLine.MaxMin.HighYOffset,o=qi.KLine.MaxMin.LowYOffset,s=t.Y,h=t.X;sa.IsNumber(n)&&(s+=n),this.Canvas.save(),this.Canvas.translate(s,h),this.Canvas.rotate(90*Math.PI/180);var l=a.High;this.Canvas.font=this.TextFont,a.HighColor?this.Canvas.fillStyle=a.HighColor:this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline="bottom","left"==t.Align?l=i+l:l+=r,this.Canvas.fillText(l,0,0),this.Canvas.restore();s=e.Y,h=e.X;sa.IsNumber(o)&&(s+=o),this.Canvas.save(),this.Canvas.translate(s,h),this.Canvas.rotate(90*Math.PI/180);l=a.Low;this.Canvas.font=this.TextFont,a.LowColor?this.Canvas.fillStyle=a.LowColor:this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=e.Align,this.Canvas.textBaseline="top","left"==e.Align?l=i+l:l+=r,this.Canvas.fillText(l,0,0),this.Canvas.restore()}}},this.DrawInfo=function(t){if(this.InfoData&&!(this.InfoData.size<=0)){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetBottom(),n=this.ChartBorder.GetTop(),o="".concat(t.DayData.Date);if(1==this.Data.DataType&&(o="".concat(t.DayData.Date,"-").concat(t.DayData.Time)),this.InfoData.has(o)){var s=this.InfoData.get(o);if(s&&!(s.Data.length<=0)){this.Canvas.restore(),this.Canvas.save(),this.ClipWindow(e);var h=F(),u=a+i,C=18*h,D=!0;u<=15&&(D=!1),u<C&&(u=C);var f,c="",m=new Map,d=t.YMax+1*h,I=t.YMin+1*h+u,S=!0,T=0;for(var v in s.Data){var p=s.Data[v],g=m.get(p.InfoType);if(g)g.Data.push(p);else{var x=pr.GetIconFont(p.InfoType);if(this.Canvas.fillStyle=x.Color,this.Canvas.font=u+"px "+x.Family,e){this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillText(x.HScreenText,d,t.XCenter,u);var E=new gt(t.XCenter-u/2,d-u,u,u),L={Data:new Array(p),Rect:E,Type:p.InfoType,TextRect:{X:d,Y:t.XCenter}};m.set(p.InfoType,L),d+=u}else if(this.Canvas.textBaseline="bottom",this.Canvas.textAlign="center",1===this.InfoPosition){var M=r+T;this.Canvas.fillText(x.Text,t.XCenter,M,u);E=new gt(t.XCenter-u/2,M-u,u,u),L={Data:new Array(p),Rect:E,Type:p.InfoType,TextRect:{X:t.XCenter,Y:M}};m.set(p.InfoType,L),T-=u}else if(S){this.Canvas.fillText(x.Text,t.XCenter,d,u);E=new gt(t.XCenter-u/2,d-u,u,u),L={Data:new Array(p),Rect:E,Type:p.InfoType,TextRect:{X:t.XCenter,Y:d}};m.set(p.InfoType,L),d-=u,d-u<n&&(S=!1)}else{this.Canvas.fillText(x.Text,t.XCenter,I,u);E=new gt(t.XCenter-u/2,I-u,u,u),L={Data:new Array(p),Rect:E,Type:p.InfoType,TextRect:{X:t.XCenter,Y:I}};m.set(p.InfoType,L),I+=u}}}qi.KLine.NumIcon&&(f=e?qi.KLine.NumIcon.HScreenText:qi.KLine.NumIcon.Text);var y,R=(0,l.default)(m);try{for(R.s();!(y=R.n()).done;){t=y.value;var N=t[1];if(N.Data.length>=2&&f&&D){var w=N.Data.length;w>=f.length&&(w=0),this.Canvas.fillStyle=qi.KLine.NumIcon.Color;c=f[w];this.Canvas.fillText(c,N.TextRect.X,N.TextRect.Y,u)}e||this.InfoTooltipRect.push(N)}}catch(A){R.e(A)}finally{R.f()}this.Canvas.restore(),this.Canvas.save(),this.ClipClient(e)}}}},this.DrawTradeIcon=function(){if(this.TradeData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var o=this.TradeData.Sell,s=this.TradeData.Buy,h=e+a,l=F(),u=24*l,C=12*l;h<C?h=C:h>u&&(h=u),this.Canvas.font=h+"px "+this.TradeIcon.Family;for(var D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<n;++D,++f,i+=e+a){var c=this.Data.Data[D];if(null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var m=!1,d=!1;if(o&&D<o.length&&(d=o[D]>0),s&&D<s.length&&(m=s[D]>0),d||m){var I=i,S=i+e;if(S>r)break;var T=I+(S-I)/2,v=this.GetYFromData(c.Low,!1),p=this.GetYFromData(c.High,!1);this.GetYFromData(c.Open,!1),this.GetYFromData(c.Close,!1);if(m)if(this.Canvas.fillStyle=this.TradeIcon.Buy.Color,t)this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.TradeIcon.Buy.HScreenText,v,T);else{this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillText(this.TradeIcon.Buy.Text,T,v);var g=new gt(T-h/2,v,h,h),x={Data:{Type:1,KData:c,Name:this.TradeData.Name,Param:this.TradeData.Param},Rect:g,TextRect:{X:T,Y:v}};this.TradeIconTooltipRect.push(x)}if(d)if(this.Canvas.fillStyle=this.TradeIcon.Sell.Color,t)this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.TradeIcon.Sell.HScreenText,p,T);else{this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillText(this.TradeIcon.Sell.Text,T,p);g=new gt(T-h/2,p-h,h,h),x={Data:{Type:2,KData:c,Name:this.TradeData.Name,Param:this.TradeData.Param},Rect:g,TextRect:{X:T,Y:p}};this.TradeIconTooltipRect.push(x)}}}}}},this.GetTooltipData=function(t,e,a){if(!this.IsShow)return!1;for(var i in this.TradeIconTooltipRect){var r=this.TradeIconTooltipRect[i];if(r.Rect){var n=r.Rect,o=n.X,s=n.Y,h=o+n.Width,l=s+n.Height;if(t>=o&&t<=h&&e>=s&&e<=l)return u.Chart.Log("[ChartKLine::GetTooltipData] trade icon ",r),a.Data=r,a.ChartPaint=this,a.Type=2,!0}}for(var i in this.InfoTooltipRect){r=this.InfoTooltipRect[i];if(r.Rect){n=r.Rect,o=n.X,s=n.Y,h=o+n.Width,l=s+n.Height;if(t>=o&&t<=h&&e>=s&&e<=l)return a.Data=r,a.ChartPaint=this,a.Type=1,!0}}if(sa.IsNonEmptyArray(this.TooltipRect))for(i=0;i<this.TooltipRect.length;++i){n=this.TooltipRect[i][1],o=n.X,s=n.Y,h=o+n.Width,l=s+n.Height;if(t>=o&&t<=h&&e>=s&&e<=l){var C=this.TooltipRect[i][0];return a.Data=this.Data.Data[C],a.ChartPaint=this,a.Type=0,a.Symbol=this.Symbol,!0}}return!1},this.GetMaxMin=function(){if(14==this.DrawType&&this.FFKChart&&this.FFKChart.GetMaxMin)return this.FFKChart.GetMaxMin(this);var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(e=0,t=this.Data.Data.length);var a={Max:null,Min:null};if(1==this.DrawType||4==this.DrawType)for(var i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];n&&sa.IsNumber(n.Close)&&(null==a.Max&&(a.Max=n.Close),null==a.Min&&(a.Min=n.Close),a.Max<n.Close&&(a.Max=n.Close),a.Min>n.Close&&(a.Min=n.Close))}else for(i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){n=this.Data.Data[i];if(n&&null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close)if(5==this.DrawType&&n.OrderFlow&&sa.IsNumber(n.OrderFlow.PriceOffset)){var o=n.High,s=n.Low;if(sa.IsNonEmptyArray(n.OrderFlow.High))for(var h=0;h<n.OrderFlow.High.length;++h){var l=n.OrderFlow.High[h];o<l.Price&&(o=l.Price)}if(sa.IsNonEmptyArray(n.OrderFlow.Low))for(h=0;h<n.OrderFlow.Low.length;++h){l=n.OrderFlow.Low[h];s>l.Price&&(s=l.Price)}o+=n.OrderFlow.PriceOffset,s-=n.OrderFlow.PriceOffset,null==a.Max&&(a.Max=o),null==a.Min&&(a.Min=s),a.Max<o&&(a.Max=o),a.Min>s&&(a.Min=s)}else null==a.Max&&(a.Max=n.High),null==a.Min&&(a.Min=n.Low),a.Max<n.High&&(a.Max=n.High),a.Min>n.Low&&(a.Min=n.Low)}return a},this.GetAllPrice=function(){for(var t=this.ChartFrame.XPointCount,e=new Set,a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close){var n=r.Close;e.add(n)}}var o,s=[],h=(0,l.default)(e);try{for(h.s();!(o=h.n()).done;){var u=o.value;s.push(u)}}catch(C){h.e(C)}finally{h.f()}return s.sort((function(t,e){return t-e})),s},this.DrawLastPointEvent=function(t){if(this.GetEventCallback){var e=this.GetEventCallback(m.ON_DRAW_KLINE_LAST_POINT);if(e){var a={Data:this.ChartFrame.DataWidth,Distance:this.ChartFrame.DistanceWidth};if(t)var i={LastPoint:{X:t.X,Y:t.Y,XLeft:t.XLeft,XRight:t.XRight},KItem:t.KItem,DrawType:this.DrawType,KWidth:a,ChartRight:t.ChartRight};else i={LastPoint:null,KItem:null,KWidth:a};e.Callback(e,i,this)}}},this.DrawOrderFlow=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}this.UpColor,this.DownColor,this.UnchagneColor;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset;this.DrawOrderFlowHBar();for(var s=this.Data.DataOffset,h=0;s<this.Data.Data.length&&h<o;++s,++h,r+=e+a,++this.ShowRange.DataCount){var l=this.Data.Data[s];if(this.ShowRange.End=s,null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=r,C=r+e;if(C>n)break;var D=u+(C-u)/2,f=this.GetYFromData(l.Low,!1),c=this.GetYFromData(l.High,!1),m=this.GetYFromData(l.Open,!1),d=this.GetYFromData(l.Close,!1);this.DrawKRange.End=s;var I={Low:f,High:c,Open:m,Close:d},S={Left:u,Center:D,Right:C,DataWidth:e};if(this.DrawOrderFlowBar(l.OrderFlow,l,S,I,t),this.IsShowKTooltip&&!t){var T=Math.min(m,d),v=Math.max(m,d);Math.abs(m-d)<5&&(T=Math.min(c,T-5),v=Math.max(f,v+5));var p=new gt(u,T,e,v-T);this.TooltipRect.push([s,p])}if(0==this.Data.DataType){var g={Xleft:u,XRight:C,XCenter:D,YMax:c,YMin:f,DayData:l,Index:h};this.DrawInfo(g)}s==this.Data.Data.length-1&&{X:D,Y:d,XLeft:u,XRight:C,KItem:l,ChartRight:n}}}},this.DrawOrderFlowBar=function(t,e,a,i,r){var n=Math.min(i.Open,i.Close),o=Math.max(i.Open,i.Close),s=Math.abs(i.Open-i.Close),h=0;t&&sa.IsNumber(t.PriceOffset)&&(h=this.GetPriceYOffset(t.PriceOffset));var l,u=this.GetDynamicOrderFlowFont(h,a.DataWidth/2);this.IsShowOrderText=h>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),l=e.Open<e.Close?this.OrderFlow.UpColor:e.Open>e.Close?this.OrderFlow.DownColor:this.OrderFlow.UnchagneColor;var C=a.DataWidth<4;C?(this.Canvas.strokeStyle=l.Border,this.Canvas.beginPath(),this.Canvas.moveTo(A(a.Center),n-h/2),this.Canvas.lineTo(A(a.Center),o+h/2),this.Canvas.stroke()):(this.Canvas.fillStyle=l.BG,this.Canvas.fillRect(b(a.Left),b(n-h/2),b(a.DataWidth),b(s+h))),this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=u;var D=a.DataWidth/2,f=D/2;if(t&&sa.IsNonEmptyArray(t.Order)){var c=0,m=0,d=null;if(this.OrderFlow.IsShowAskBar||this.OrderFlow.IsShowBidBar||this.OrderFlow.IsShowPOCBG)for(var I=0,S=0,T=0;T<t.Order.length;++T){var v=t.Order[T];S=0,v.Ask&&sa.IsNumber(v.Ask.Value)&&(c+=v.Ask.Value,S+=v.Ask.Value),v.Bid&&sa.IsNumber(v.Bid.Value)&&(m+=v.Bid.Value,S+=v.Bid.Value),I<S&&(I=S,d=T)}for(T=0;T<t.Order.length;++T){v=t.Order[T];var p=this.GetYFromData(v.Price,!1),g={Left:a.Left,Right:a.Center,Bottom:p+h/2,Top:p-h/2};if(g.Width=g.Right-g.Left,g.Height=g.Bottom-g.Top,v.Ask.BG&&(this.Canvas.fillStyle=v.Ask.BG,this.Canvas.fillRect(b(g.Left),b(g.Top),b(g.Width),b(g.Height))),this.OrderFlow.IsShowPOCBG&&d==T&&(this.Canvas.fillStyle=this.OrderFlow.POCGBColor,this.Canvas.fillRect(b(g.Left),b(g.Top),b(g.Width),b(g.Height))),this.OrderFlow.IsShowAskBar&&sa.IsNumber(v.Ask.Value)&&c>0){var x=g.Width*(v.Ask.Value/c);x<1&&(x=1),this.Canvas.fillStyle=this.OrderFlow.AskBarColor,this.Canvas.fillRect(b(g.Right),b(g.Top),b(-x),b(g.Height))}var F=null;if(sa.IsString(v.Ask.Text)?F=v.Ask.Text:sa.IsNumber(v.Ask.Value)&&(F=v.Ask.Value.toString()),F&&this.IsShowOrderText&&this.OrderFlow.IsShowAskText)if(v.Ask.Color?this.Canvas.fillStyle=v.Ask.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,v.Ask.Font){var E=this.GetDynamicOrderFlowFont(h,a.DataWidth/2,v.Ask.Font);this.Canvas.font=E,this.Canvas.fillText(F,a.Left+f,p),this.Canvas.font=u}else this.Canvas.fillText(F,a.Left+f,p);g={Left:a.Center,Right:a.Right,Bottom:p+h/2,Top:p-h/2};if(g.Width=g.Right-g.Left,g.Height=g.Bottom-g.Top,v.Bid.BG&&(this.Canvas.fillStyle=v.Bid.BG,this.Canvas.fillRect(b(g.Left),b(g.Top),b(g.Width),b(g.Height))),this.OrderFlow.IsShowPOCBG&&d==T&&(this.Canvas.fillStyle=this.OrderFlow.POCGBColor,this.Canvas.fillRect(b(g.Left),b(g.Top),b(g.Width),b(g.Height))),this.OrderFlow.IsShowBidBar&&sa.IsNumber(v.Bid.Value)&&m>0){x=g.Width*(v.Bid.Value/m);x<1&&(x=1),this.Canvas.fillStyle=this.OrderFlow.BidBarColor,this.Canvas.fillRect(b(g.Left),b(g.Top),b(x),b(g.Height))}F=null;if(sa.IsString(v.Bid.Text)?F=v.Bid.Text:sa.IsNumber(v.Bid.Value)&&(F=v.Bid.Value.toString()),F&&this.IsShowOrderText&&this.OrderFlow.IsShowBidText)if(v.Bid.Color?this.Canvas.fillStyle=v.Bid.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,v.Bid.Font){E=this.GetDynamicOrderFlowFont(h,a.DataWidth/2,v.Bid.Font);this.Canvas.font=E,this.Canvas.fillText(F,a.Center+f,p),this.Canvas.font=u}else this.Canvas.fillText(F,a.Center+f,p)}}(i.High<n||i.Low>o)&&(this.Canvas.strokeStyle=this.OrderFlow.Line.UpDownColor,i.High<n&&(this.Canvas.beginPath(),this.Canvas.moveTo(A(a.Center),i.High-h/2),this.Canvas.lineTo(A(a.Center),n-h/2),this.Canvas.stroke()),i.Low>o&&(this.Canvas.beginPath(),this.Canvas.moveTo(A(a.Center),i.Low+h/2),this.Canvas.lineTo(A(a.Center),o+h/2),this.Canvas.stroke())),!C&&Math.abs(i.Open-i.Close)>1&&(this.Canvas.strokeStyle=this.OrderFlow.Line.MiddleColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(a.Center),n-h/2),this.Canvas.lineTo(A(a.Center),o+h/2),this.Canvas.stroke()),C||(this.Canvas.beginPath(),this.Canvas.strokeStyle=l.Border,this.Canvas.rect(A(a.Left),A(n-h/2),b(a.DataWidth),b(s+h)),this.Canvas.stroke());u=this.GetDynamicOrderFlowFont(h,a.DataWidth);if(t&&sa.IsNonEmptyArray(t.High)&&this.IsShowOrderText)for(T=0;T<t.High.length;++T){v=t.High[T];if(sa.IsString(v.Text)?F=v.Text:sa.IsNumber(v.Value)&&(F=v.Value.toString()),F){v.Color?this.Canvas.fillStyle=v.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color;p=this.GetYFromData(v.Price,!1);if(v.Font){E=this.GetDynamicOrderFlowFont(h,a.DataWidth,v.Font);this.Canvas.font=E,this.Canvas.fillText(F,a.Center,p),this.Canvas.font=u}else this.Canvas.fillText(F,a.Center,p)}}if(t&&sa.IsNonEmptyArray(t.Low)&&this.IsShowOrderText)for(T=0;T<t.Low.length;++T){v=t.Low[T];if(sa.IsString(v.Text)?F=v.Text:sa.IsNumber(v.Value)&&(F=v.Value.toString()),F){v.Color?this.Canvas.fillStyle=v.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color;p=this.GetYFromData(v.Price,!1);if(v.Font){E=this.GetDynamicOrderFlowFont(h,a.DataWidth,v.Font);this.Canvas.font=E,this.Canvas.fillText(F,a.Center,p),this.Canvas.font=u}else this.Canvas.fillText(F,a.Center,p)}}},this.GetPriceYOffset=function(t){var e=this.ChartFrame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a},this.GetDynamicOrderFlowFont=function(t,e,a){var i=parseInt(t)-2;t<5&&(i=parseInt(t)),i>this.OrderFlow.Text.FontMaxSize?i=this.OrderFlow.Text.FontMaxSize:i<=0&&(i=1);for(var r=this.FormatFontString(i,this.OrderFlow.Text.Family,a),n=i;n>0;n-=2){r=this.FormatFontString(n,this.OrderFlow.Text.Family,a);this.Canvas.font=r;var o=this.Canvas.measureText(this.OrderFlow.Text.MaxValue).width+2;if(o<e)break}return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i="".concat(a.Weight," ").concat(t,"px ").concat(e)):i="".concat(t,"px ").concat(e),i},this.DrawOrderFlowHBar=function(){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartFrame.HorizontalMax,r=this.ChartFrame.HorizontalMin,n=this.Data.DataOffset,o=this.Data.DataOffset+a,s=0;s<this.Data.Data.length;++s){var h=this.Data.Data[s];if(h&&h.OrderFlow&&sa.IsNonEmptyArray(h.OrderFlow.Order))for(var l=0;l<h.OrderFlow.Order.length;++l){var u=h.OrderFlow.Order[l];if(u.HBar&&(sa.IsNumber(u.HBar.Width)&&sa.IsNumber(u.Price)&&!(u.Price>i||u.Price<r))){var C=Math.ceil(s+u.HBar.Width),D=Math.min(s,C),f=Math.max(s,C);f<n||D>o||this.DrawOrderFlowHBarItem(s,h.OrderFlow,u,t,e)}}}},this.DrawOrderFlowHBarItem=function(t,e,a,i,r){var n=this.ShowRange.Start,o=(this.ShowRange.Start,this.ShowRange.ShowCount,this.GetYFromData(a.Price,!1)),s=parseInt(t+a.HBar.Width),h=t-n,l=s-n;if(h<0&&(h=0),l<0&&(l=0),h<=l){this.ChartBorder.GetRight(),this.ChartFrame.XPointCount;var u=n,C=this.GetPriceYOffset(e.PriceOffset),D=this.ChartFrame.GetXFromIndex(h)-i/2;if(1==a.HBar.Type)for(var f=0,c=t+1;f<a.HBar.Width&&c<this.Data.Data.length;++f,++c){var m=this.Data.Data[c];if(m.Close<a.Price){l=c-1-u;break}}else if(2==a.HBar.Type)for(f=0,c=t+1;f<a.HBar.Width&&c<this.Data.Data.length;++f,++c){m=this.Data.Data[c];if(m.Close>a.Price){l=c-1-u;break}}if(l<0)return;var d=this.ChartFrame.GetXFromIndex(l)+i/2,I=o-C/2,S=C+.5;sa.IsNumber(a.HBar.Height)&&(S=a.HBar.Height*C+.1);var T=a.HBar.Width-parseInt(a.HBar.Width);T>1e-6&&(d+=(i+r)*T),this.Canvas.fillStyle=a.HBar.Color,this.Canvas.fillRect(b(D),b(I),b(d-D),b(S))}},this.PtInChart=function(t,e){return 1==this.DrawType||4==this.DrawType?this.PtInLine(t,e,{KLineClose:!0}):this.PtInKBar(t,e)},this.DrawSelectedStatus=function(){this.DrawLinePoint({KLineClose:!0})},this.DrawOrderFlow_Style2=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(this.AryOrderFlowBorder=[],t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}var s=this.OrderFlow_Style2.UpColor,h=this.OrderFlow_Style2.DownColor,l=this.OrderFlow_Style2.UnchagneColor,u=b(this.OrderFlow_Style2.BarWidth),C=e-u;C/7<u&&(u=C/7),u<=1&&(u=2),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset,this.DrawOrderFlowHBar();for(var D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<o;++D,++f,r+=e+a,++this.ShowRange.DataCount){var c=this.Data.Data[D];if(this.ShowRange.End=D,null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var m=r,d=r+e;if(d>n)break;var I=m+(d-m)/2,S=this.GetYFromData(c.Low,!1),T=this.GetYFromData(c.High,!1),v=this.GetYFromData(c.Open,!1),p=this.GetYFromData(c.Close,!1);this.DrawKRange.End=D;var g=Math.min(v,p),x=Math.max(v,p),F=b(m),E=F+u;c.Open<c.Close?this.Canvas.fillStyle=s:c.Open>c.Close?this.Canvas.fillStyle=h:this.Canvas.fillStyle=l;var L=0;c.OrderFlow&&sa.IsNumber(c.OrderFlow.PriceOffset)&&(L=this.GetPriceYOffset(c.OrderFlow.PriceOffset)),this.Canvas.fillRect(F,b(g-L/2),u,b(x-g+L));var M={Low:S,High:T,Open:v,Close:p},y={Left:E,Center:I,Right:d,DataWidth:d-E};y.Center=y.Left+y.DataWidth/2,this.DrawOrderFlowBar_Style2(c.OrderFlow,c,y,M,t)}}if(e-u>5)for(D=0;D<this.AryOrderFlowBorder.length;++D){var R=this.AryOrderFlowBorder[D];if(R&&R.Rect&&R.Color){var N=R.Rect;this.Canvas.strokeStyle=R.Color,this.Canvas.beginPath(),this.Canvas.rect(A(N.Left),A(N.Top),b(N.Width),b(N.Height)),this.Canvas.stroke()}}this.AryOrderFlowBorder=[]},this.DrawOrderFlow_Style3=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(this.AryOrderFlowBorder=[],t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}var s=this.OrderFlow_Style3.UpColor,h=this.OrderFlow_Style3.DownColor,l=this.OrderFlow_Style3.UnchagneColor,u=b(this.OrderFlow_Style3.BarWidth);e/4<u&&(u=e/4),u<=1&&(u=2),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset,this.DrawOrderFlowHBar();for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<o;++C,++D,r+=e+a,++this.ShowRange.DataCount){var f=this.Data.Data[C];if(this.ShowRange.End=C,null!=f.Open&&null!=f.High&&null!=f.Low&&null!=f.Close){var c=r,m=r+e;if(m>n)break;var d=this.GetYFromData(f.Low,!1),I=this.GetYFromData(f.High,!1),S=this.GetYFromData(f.Open,!1),T=this.GetYFromData(f.Close,!1);this.DrawKRange.End=C;var v=Math.min(S,T),p=Math.max(S,T),g=b(c),x=g+u;f.Open<f.Close?this.Canvas.fillStyle=s:f.Open>f.Close?this.Canvas.fillStyle=h:this.Canvas.fillStyle=l;var F=0;f.OrderFlow&&sa.IsNumber(f.OrderFlow.PriceOffset)&&(F=this.GetPriceYOffset(f.OrderFlow.PriceOffset)),this.Canvas.fillRect(g,b(v-F/2),u,b(p-v+F));var E={Low:d,High:I,Open:S,Close:T},L={Left:x,Right:m,DataWidth:m-x};this.DrawOrderFlowBar_Style3(f.OrderFlow,f,L,E,t)}}if(e-u>5)for(C=0;C<this.AryOrderFlowBorder.length;++C){var M=this.AryOrderFlowBorder[C];if(M&&M.Rect&&M.Color){var y=M.Rect;this.Canvas.strokeStyle=M.Color,this.Canvas.beginPath(),this.Canvas.rect(A(y.Left),A(y.Top),b(y.Width),b(y.Height)),this.Canvas.stroke()}}this.AryOrderFlowBorder=[]},this.DrawOrderFlowBar_Style2=function(t,e,a,i,r){Math.min(i.Open,i.Close),Math.max(i.Open,i.Close),Math.abs(i.Open-i.Close);var n=0;t&&sa.IsNumber(t.PriceOffset)&&(n=this.GetPriceYOffset(t.PriceOffset));var o=this.GetDynamicOrderFlowFont(n,a.DataWidth/2);this.IsShowOrderText=n>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=o;a.DataWidth;if(t&&sa.IsNonEmptyArray(t.Order))for(var s=0;s<t.Order.length;++s){var h=t.Order[s],l=this.GetYFromData(h.Price,!1),u={Left:a.Left,Right:a.Center,Bottom:l+n/2,Top:l-n/2};if(u.Width=u.Right-u.Left,u.Height=u.Bottom-u.Top,h.Ask.BG&&(this.Canvas.fillStyle=h.Ask.BG,this.Canvas.fillRect(b(u.Left),b(u.Top),b(u.Width),b(u.Height))),h.Ask.BorderColor){var C={Rect:u,Color:h.Ask.BorderColor};this.AryOrderFlowBorder.push(C)}var D=null;if(sa.IsString(h.Ask.Text)?D=h.Ask.Text:sa.IsNumber(h.Ask.Value)&&(D=h.Ask.Value.toString()),D&&this.IsShowOrderText)if(h.Ask.Color?this.Canvas.fillStyle=h.Ask.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,h.Ask.Font){var f=this.GetDynamicOrderFlowFont(n,a.DataWidth/2,h.Ask.Font);this.Canvas.font=f,this.Canvas.fillText(D,a.Left+2,l),this.Canvas.font=o}else this.Canvas.fillText(D,a.Left+2,l);u={Left:a.Center,Right:a.Right,Bottom:l+n/2,Top:l-n/2};if(u.Width=u.Right-u.Left,u.Height=u.Bottom-u.Top,h.Bid.BG&&(this.Canvas.fillStyle=h.Bid.BG,this.Canvas.fillRect(b(u.Left),b(u.Top),b(u.Width),b(u.Height))),h.Bid.BorderColor){C={Rect:u,Color:h.Bid.BorderColor};this.AryOrderFlowBorder.push(C)}D=null;if(sa.IsString(h.Bid.Text)?D=h.Bid.Text:sa.IsNumber(h.Bid.Value)&&(D=h.Bid.Value.toString()),D&&this.IsShowOrderText)if(h.Bid.Color?this.Canvas.fillStyle=h.Bid.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,h.Bid.Font){f=this.GetDynamicOrderFlowFont(n,a.DataWidth/2,h.Bid.Font);this.Canvas.font=f,this.Canvas.fillText(D,a.Center+2,l),this.Canvas.font=o}else this.Canvas.fillText(D,a.Center+2,l)}},this.DrawOrderFlowBar_Style3=function(t,e,a,i,r){Math.min(i.Open,i.Close),Math.max(i.Open,i.Close),Math.abs(i.Open-i.Close);var n=a.DataWidth-4,o=0;t&&sa.IsNumber(t.PriceOffset)&&(o=this.GetPriceYOffset(t.PriceOffset));var s=this.GetDynamicOrderFlowFont(o,n);this.IsShowOrderText=o>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=s;if(t&&sa.IsNonEmptyArray(t.Order))for(var h=0;h<t.Order.length;++h){var l=t.Order[h],u=this.GetYFromData(l.Price,!1),C={Left:a.Left,Right:a.Right,Bottom:u+o/2,Top:u-o/2};if(C.Width=C.Right-C.Left,C.Height=C.Bottom-C.Top,l.Item.BG&&(this.Canvas.fillStyle=l.Item.BG,this.Canvas.fillRect(b(C.Left),b(C.Top),b(C.Width),b(C.Height))),l.Item.BorderColor){var D={Rect:C,Color:l.Item.BorderColor};this.AryOrderFlowBorder.push(D)}var f=null;if(sa.IsString(l.Item.Text)?f=l.Item.Text:sa.IsNumber(l.Item.Value)&&(f=l.Item.Value.toString()),f&&this.IsShowOrderText)if(l.Item.Color?this.Canvas.fillStyle=l.Item.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,l.Item.Font){var c=this.GetDynamicOrderFlowFont(o,n,l.Item.Font);this.Canvas.font=c,this.Canvas.fillText(f,a.Left+2,u),this.Canvas.font=s}else this.Canvas.fillText(f,a.Left+2,u)}},this.DrawOrderFlow_Style4=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(this.AryOrderFlowBorder=[],t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}var s=this.OrderFlow_Style4.UpColor,h=this.OrderFlow_Style4.DownColor,l=this.OrderFlow_Style4.UnchagneColor;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset,this.DrawOrderFlowHBar();var u=this.OrderFlow_Style4.KBarWidth;e+a<3*u&&(u=1);for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<o;++C,++D,r+=e+a,++this.ShowRange.DataCount){var f=this.Data.Data[C];if(this.ShowRange.End=C,null!=f.Open&&null!=f.High&&null!=f.Low&&null!=f.Close){var c=r,m=r+e;if(m>n)break;var d=c+(m-c)/2,I=this.GetYFromData(f.Low,!1),S=this.GetYFromData(f.High,!1),T=this.GetYFromData(f.Open,!1),v=this.GetYFromData(f.Close,!1);this.DrawKRange.End=C;var p=c+this.OrderFlow_Style4.LeftMargin,g=m+a-this.OrderFlow_Style4.RightMargin;if(1==this.OrderFlow_Style4.KBarType){var x=Math.min(T,v),F=Math.max(T,v),E=b(c)+this.OrderFlow_Style4.LeftMargin,L=p+u;f.Open<f.Close?this.Canvas.fillStyle=s:f.Open>f.Close?this.Canvas.fillStyle=h:this.Canvas.fillStyle=l;var M=0;f.OrderFlow&&sa.IsNumber(f.OrderFlow.PriceOffset)&&(M=this.GetPriceYOffset(f.OrderFlow.PriceOffset)),this.Canvas.fillRect(E,b(x-M/2),u,b(F-x+M)),p=L+1}var y={Low:I,High:S,Open:T,Close:v},R={Left:p,Center:d,Right:g,DataWidth:g-p};R.Center=R.Left+R.DataWidth/2,this.DrawOrderFlowBar_Style4(f.OrderFlow,f,R,y,t)}}},this.DrawOrderFlowBar_Style4=function(t,e,a,i,r){Math.min(i.Open,i.Close),Math.max(i.Open,i.Close),Math.abs(i.Open-i.Close);var n=0;t&&sa.IsNumber(t.PriceOffset)&&(n=this.GetPriceYOffset(t.PriceOffset));var o=this.GetDynamicOrderFlowFont(n,a.DataWidth/2);this.IsShowOrderText=n>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=o;var s=this.OrderFlow_Style4.VolBarSpace;if(n<=4&&(s=0),t&&sa.IsNonEmptyArray(t.Order)){if(t.Summary||(t.Summary={}),!t.Summary.VolMaxMin){for(var h={Max:null,Min:null},l=0;l<t.Order.length;++l){var u=t.Order.length[l];(null==h.Max||h.Max<u.Vol.Value)&&(h.Max=u.Vol.Value),(null==h.Min||h.Min>u.Vol.Value)&&(h.Min=u.Vol.Value)}t.Summary.VolMaxMin=h}var C=null,D=t.Summary.VolMaxMin.Max,f=t.Summary.VolMaxMin.Min;for(l=0;l<t.Order.length;++l){u=t.Order[l];var c=this.GetYFromData(u.Price,!1);if(u.Vol)if(sa.IsNonEmptyArray(u.AryVol)){for(var m=a.Right-a.Left,d=a.Left,I=d,S=0,T={Bottom:c+n/2,Top:c-n/2},v=0;v<u.AryVol.length;++v){var p=u.AryVol[v];if(sa.IsNumber(p.Value)){S+=p.Value,I=m*(S-f)/(D-f)+a.Left;var g={Left:d,Right:I,Bottom:c+n/2,Top:c-n/2};C&&u.Price>C.Price&&(g.Bottom=C.Rect.Top-s),g.Width=g.Right-g.Left,g.Height=g.Bottom-g.Top,T={Left:b(g.Left),Top:b(g.Top),Width:b(g.Width),Height:b(g.Height)},T.Bottom=T.Top+T.Height,T.Right=T.Left+T.Width,T.Width<1&&(T.Width=1),p.BG&&(this.Canvas.fillStyle=p.BG,this.Canvas.fillRect(T.Left,T.Top,T.Width,T.Height)),d=T.Right}}if(T.Left=a.Left,T.Width=T.Right-T.Left,u.Vol.Text&&this.IsShowOrderText)if(this.Canvas.fillStyle=u.Vol.Color,u.Vol.Font){var x=this.GetDynamicOrderFlowFont(n,m/2,u.Vol.Font);this.Canvas.font=x,this.Canvas.fillText(text,a.Center+textXOffset,c),this.Canvas.font=o}else this.Canvas.fillText(u.Vol.Text,T.Left+2,c);C={Price:u.Price,Rect:T}}else{if(!sa.IsNumber(u.Vol.Value))continue;m=a.Right-a.Left;var F=m*(u.Vol.Value-f)/(D-f),E={Left:a.Left,Right:a.Right,Bottom:c+n/2,Top:c-n/2};E.Right=E.Left+F,C&&u.Price>C.Price&&(E.Bottom=C.Rect.Top-s),E.Width=E.Right-E.Left,E.Height=E.Bottom-E.Top;T={Left:b(E.Left),Top:b(E.Top),Width:b(E.Width),Height:b(E.Height)};if(T.Bottom=T.Top+T.Height,T.Right=T.Left+T.Width,T.Width<1&&(T.Width=1),u.Vol.BG&&(this.Canvas.fillStyle=u.Vol.BG,this.Canvas.fillRect(T.Left,T.Top,T.Width,T.Height)),u.Vol.BorderColor&&(this.Canvas.strokeStyle=u.Vol.BorderColor,this.Canvas.strokeRect(A(T.Left),A(T.Top),T.Width,T.Height)),u.Vol.Text&&this.IsShowOrderText)if(this.Canvas.fillStyle=u.Vol.Color,u.Vol.Font){x=this.GetDynamicOrderFlowFont(n,m/2,u.Vol.Font);this.Canvas.font=x,this.Canvas.fillText(text,a.Center+textXOffset,c),this.Canvas.font=o}else this.Canvas.fillText(u.Vol.Text,T.Left+2,c);C={Price:u.Price,Rect:T}}}}},this.DrawOrderFlow_Style5=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(this.AryOrderFlowBorder=[],t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}var s=this.OrderFlow_Style2.UpColor,h=this.OrderFlow_Style2.DownColor,l=this.OrderFlow_Style2.UnchagneColor,u=b(this.OrderFlow_Style2.BarWidth),C=e-u;C/7<u&&(u=C/7),u<=1&&(u=2),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.DrawKRange.Start=this.Data.DataOffset,this.DrawOrderFlowHBar();for(var D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<o;++D,++f,r+=e+a,++this.ShowRange.DataCount){var c=this.Data.Data[D];if(this.ShowRange.End=D,null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var m=r,d=r+e;if(d>n)break;var I=m+(d-m)/2,S=this.GetYFromData(c.Low,!1),T=this.GetYFromData(c.High,!1),v=this.GetYFromData(c.Open,!1),p=this.GetYFromData(c.Close,!1);this.DrawKRange.End=D;var g=Math.min(v,p),x=Math.max(v,p),F=b(m),E=F+u;c.Open<c.Close?this.Canvas.fillStyle=s:c.Open>c.Close?this.Canvas.fillStyle=h:this.Canvas.fillStyle=l;var L=0;c.OrderFlow&&sa.IsNumber(c.OrderFlow.PriceOffset)&&(L=this.GetPriceYOffset(c.OrderFlow.PriceOffset)),this.Canvas.fillRect(F,b(g-L/2),u,b(x-g+L));var M={Low:S,High:T,Open:v,Close:p},y={Left:E,Center:I,Right:d,DataWidth:d-E};y.Center=y.Left+y.DataWidth/2,this.DrawOrderFlowBar_Style5(c.OrderFlow,c,y,M,t)}}},this.DrawOrderFlowBar_Style5=function(t,e,a,i,r){Math.min(i.Open,i.Close),Math.max(i.Open,i.Close),Math.abs(i.Open-i.Close);var n=0;t&&sa.IsNumber(t.PriceOffset)&&(n=this.GetPriceYOffset(t.PriceOffset));var o=this.GetDynamicOrderFlowFont(n,a.DataWidth/2);this.IsShowOrderText=n>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),this.Canvas.textBaseline="middle",this.Canvas.font=o;a.DataWidth;if(t&&sa.IsNonEmptyArray(t.Order))for(var s=t.MaxValue,h=0;h<t.Order.length;++h){var l=t.Order[h],u=this.GetYFromData(l.Price,!1),C={Left:a.Left,Right:a.Center,Bottom:u+n/2,Top:u-n/2};if(C.Width=C.Right-C.Left,C.Height=C.Bottom-C.Top,sa.IsNumber(l.Ask.Value)){var D=this.OrderFlow_Style5.AskBarColor;l.Ask.BG&&(D=l.Ask.BG),this.Canvas.fillStyle=D;var f=C.Width*l.Ask.Value/s;this.Canvas.fillRect(b(C.Right),b(C.Top),b(-f),b(C.Height));var c=null;if(c=sa.IsString(l.Ask.Text)?l.Ask.Text:l.Ask.Value.toString(),c&&this.IsShowOrderText){var m=this.OrderFlow.Text.Color;l.Ask.Color&&(m=l.Ask.Color),this.Canvas.fillStyle=m,this.Canvas.textAlign="right";var d=C.Right-this.OrderFlow_Style5.LeftMargin;if(l.Ask.Font){var I=this.GetDynamicOrderFlowFont(n,a.DataWidth/2,l.Ask.Font);this.Canvas.font=I,this.Canvas.fillText(c,d,u),this.Canvas.font=o}else this.Canvas.fillText(c,d,u)}}C={Left:a.Center,Right:a.Right,Bottom:u+n/2,Top:u-n/2};if(C.Width=C.Right-C.Left,C.Height=C.Bottom-C.Top,sa.IsNumber(l.Bid.Value)){D=this.OrderFlow_Style5.BidBarColor;l.Bid.BG&&(D=l.Bid.BG),this.Canvas.fillStyle=D;f=C.Width*l.Bid.Value/s;this.Canvas.fillRect(b(C.Left),b(C.Top),b(f),b(C.Height));c=null;if(c=sa.IsString(l.Bid.Text)?l.Bid.Text:l.Bid.Value.toString(),c&&this.IsShowOrderText){m=this.OrderFlow.Text.Color;l.Bid.Color&&(m=l.Bid.Color),this.Canvas.fillStyle=m,this.Canvas.textAlign="left";d=C.Left+this.OrderFlow_Style5.RightMargin;if(l.Bid.Font){I=this.GetDynamicOrderFlowFont(n,a.DataWidth/2,l.Bid.Font);this.Canvas.font=I,this.Canvas.fillText(c,d,u),this.Canvas.font=o}else this.Canvas.fillText(c,d,u)}}}},this.DrawHighLow=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset,this.Canvas.fillStyle=this.HighLowBarColor,this.Canvas.strokeStyle=this.HighLowBarColor;var s=Jr(this.Symbol),h=this.GetHighLowTextFont(e,a),l=!1;h&&(l=!0,this.Canvas.font=h);for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<i;++u,++C,n+=e+a,++this.ShowRange.DataCount){var D=this.Data.Data[u];if(this.ShowRange.End=u,null!=D.Open&&null!=D.High){var f=n,c=n+e;if(c>o)break;var m=f+(c-f)/2,d=this.GetYFromData(D.Low,!1),I=this.GetYFromData(D.High,!1);this.DrawKRange.End=u;var S=d,T=I-d;if(Math.abs(T)<1&&(T=1),e>=4)t?this.Canvas.fillRect(b(S),b(f),b(T),b(e)):(this.Canvas.fillRect(b(f),b(S),b(e),b(T)),l&&this.DrawHighLowText(I,d,m,D,s));else{m=f+(c-f)/2;this.Canvas.beginPath(),t?(this.Canvas.moveTo(A(d),A(m)),this.Canvas.lineTo(A(I),A(m))):(this.Canvas.moveTo(A(m),A(d)),this.Canvas.lineTo(A(m),A(I))),this.Canvas.stroke()}if(this.IsShowKTooltip&&!t){var v=Math.min(d,I),p=Math.max(d,I);Math.abs(v-p)<5&&(v=Math.min(I,v-5),p=Math.max(d,p+5));var g=new gt(f,v,e,p-v);this.TooltipRect.push([u,g])}}}},this.DrawHighLowText=function(t,e,a,i,r){this.Canvas.textAlign="center";var n=i.High.toFixed(r);this.Canvas.textBaseline="bottom",this.Canvas.fillText(n,a,t-2);n=i.Low.toFixed(r);this.Canvas.textBaseline="top",this.Canvas.fillText(n,a,e+3)},this.GetHighLowTextFont=function(t,e){for(var a=t+e,i=this.HighLowTextConfig.MaxText,r=Math.min(this.HighLowTextConfig.MaxSize,this.HighLowTextConfig.MinSize),n=Math.max(this.HighLowTextConfig.MaxSize,this.HighLowTextConfig.MinSize),o=n;o>=r;--o){var s="".concat(o*F(),"px ").concat(this.HighLowTextConfig.FontName);this.Canvas.font=s;var h=this.Canvas.measureText(i).width;if(h<=a)return s}return null},this.DrawPriceGap=function(){if(sa.IsNonEmptyArray(this.AryPriceGapCache)&&!(this.PriceGap.Count<=0)){var t=this.AryPriceGapCache.length-this.PriceGap.Count;t<0&&(t=0);var e=!0===this.ChartFrame.IsHScreen,a=null;a=e?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder(),this.Canvas.font=this.PriceGapStyple.Text.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";for(var i=this.Canvas.measureText("擎").width,r=Jr(this.Symbol),n=t;n<this.AryPriceGapCache.length;++n){var o=this.AryPriceGapCache[n],s=o.Data[0],h=o.Data[1],l=null,u=null,C=null;if(1==o.Type)e?(l={Left:s.Coordinate.High,Right:h.Coordinate.Low,Top:s.Coordinate.X,Bottom:a.Bottom},l.Width=l.Right-l.Left,l.Height=l.Bottom-l.Top,u={Left:s.Coordinate.High-i-2,Top:s.Coordinate.Right+2,Height:i},u.Bottom=u.Top+u.Height):(l={Left:s.Coordinate.X,Right:a.Right,Top:h.Coordinate.Low,Bottom:s.Coordinate.High},l.Width=l.Right-l.Left,l.Height=l.Bottom-l.Top,u={Left:s.Coordinate.Right+2,Top:l.Bottom+2,Right:l.Right,Height:i},u.Bottom=u.Top+u.Height),C="".concat(s.Data.High.toFixed(r),"-").concat(h.Data.Low.toFixed(r));else{if(2!=o.Type)continue;e?(l={Left:s.Coordinate.Low,Right:h.Coordinate.High,Top:s.Coordinate.X,Bottom:a.Bottom},l.Width=l.Right-l.Left,l.Height=l.Bottom-l.Top,u={Left:s.Coordinate.Low+2,Top:s.Coordinate.Right+2,Height:i},u.Bottom=u.Top+u.Height):(l={Left:s.Coordinate.X,Right:a.Right,Top:s.Coordinate.Low,Bottom:h.Coordinate.High},l.Width=l.Right-l.Left,l.Height=l.Bottom-l.Top,u={Left:s.Coordinate.Right+2,Bottom:l.Top,Right:l.Right,Height:i},u.Top=u.Bottom-u.Height),C="".concat(s.Data.Low.toFixed(r),"-").concat(h.Data.High.toFixed(r))}if(!l)return;if(this.Canvas.fillStyle=this.PriceGapStyple.Line.Color,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height),u){var D=this.Canvas.measureText(C).width;u.Width=D,u.Right=u.Left+u.Width,this.Canvas.fillStyle=this.PriceGapStyple.Text.Color,e?(this.Canvas.save(),this.Canvas.translate(u.Left,u.Top),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C,0,0),this.Canvas.restore()):(u.Right>l.Right&&(u.Right=l.Right,u.Left=u.Right-u.Width),this.Canvas.fillStyle=this.PriceGapStyple.Text.Color,this.Canvas.fillText(C,u.Left,u.Bottom))}}}},this.IsPriceGap=function(t,e){return e&&t?e.Data.Low>t.Data.High?2:e.Data.High<t.Data.Low?1:-1:0},this.CheckPriceGap=function(t){for(var e=t.Data,a=0;a<this.AryPriceGapCache.length;++a){var i=this.AryPriceGapCache[a],r=i.Data[0],n=i.Data[1];if(1==i.Type){if(e.Low<=r.Data.High){this.AryPriceGapCache.splice(a,1),--a;continue}e.Low<n.Data.Low&&(i.Data[1]=t)}else if(2==i.Type){if(e.High>=r.Data.Low){this.AryPriceGapCache.splice(a,1),--a;continue}e.High>n.Data.High&&(i.Data[1]=t)}}},this.GetDaySummaryText=function(){var t,e=this.DaySummary.MapDate.size;if(e<=0)return null;if(!this.HQChart)return null;if(dt.IsMinutePeriod(this.Data.Period,!0))return t="".concat(e).concat($i.GetText("天",this.HQChart.LanguageID)),t;if(dt.IsDayPeriod(this.Data.Period,!0)){switch(this.Data.Period){case 0:t="".concat(e).concat($i.GetText("天",this.HQChart.LanguageID));break;case 1:t="".concat(e).concat($i.GetText("周",this.HQChart.LanguageID));break;case 2:t="".concat(e).concat($i.GetText("月",this.HQChart.LanguageID));break;case 4:t="".concat(e).concat($i.GetText("年",this.HQChart.LanguageID));break;default:return null}return t}return null},this.DrawDaySummary=function(){if(this.DaySummary.Enable&&!0!==this.ChartFrame.IsHScreen){var t=this.GetDaySummaryText();if(t){this.Canvas.font=this.DaySummaryConfig.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var e=this.ChartBorder.GetBorder(),a=e.Left+this.DaySummaryConfig.LeftMargin,i=e.Bottom,r=R(this.Canvas,t),n=r.Width,o=r.Height,s={Left:a,Bottom:i,Width:n,Height:o};if(s.Right=s.Left+s.Width,s.Top=s.Bottom-s.Height,this.ChartFrame.ChartKLine.Max&&this.ChartFrame.ChartKLine.Max.Rect){var h=this.ChartFrame.ChartKLine.Max.Rect;M(s,h)&&(s.Left=h.Right+2,s.Right=s.Left+s.Width)}if(this.ChartFrame.ChartKLine.Min&&this.ChartFrame.ChartKLine.Min.Rect){var l=this.ChartFrame.ChartKLine.Min.Rect;M(s,l)&&(s.Left=l.Right+2,s.Right=s.Left+s.Width)}this.Canvas.fillStyle=this.DaySummaryConfig.TextColor,this.Canvas.fillText(t,s.Left,s.Bottom),this.ClearDaySummary()}}}}function Mt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartColorKline",this.Symbol,this.Color="rgb(0,255,44)",this.IsEmptyBar=!1,this.DrawType=0,this.KLineColor,this.DrawName,this.Draw=function(){if(this.IsShow)if("DRAWCOLORKLINE"==this.DrawName)this.DrawColorBar();else{if(!this.KLineColor)return;this.DrawBar()}},this.DrawUpBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,o=e+a,s=n+(o-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),D=l;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(A(D),A(s)),this.Canvas.lineTo(A(3==this.DrawType?Math.max(C,u):C),A(s))):(this.Canvas.moveTo(A(s),A(D)),this.Canvas.lineTo(A(s),A(3==this.DrawType?Math.min(C,u):C))),this.Canvas.stroke(),D=C):D=C,r?Math.abs(u-D)<1?this.Canvas.fillRect(b(D),b(n),1,b(a)):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(A(D),A(n),b(u-D),b(a)),this.Canvas.stroke()):this.Canvas.fillRect(b(D),b(n),b(u-D),b(a)):Math.abs(u-D)<1?this.Canvas.fillRect(b(n),b(D),b(a),1):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(A(n),A(D),b(a),b(u-D)),this.Canvas.stroke()):this.Canvas.fillRect(b(n),b(Math.min(D,u)),b(a),b(Math.abs(u-D))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(A(3==this.DrawType?Math.min(C,u):D),A(s)),this.Canvas.lineTo(A(h),A(s))):(this.Canvas.moveTo(A(s),A(3==this.DrawType?Math.max(C,u):D)),this.Canvas.lineTo(A(s),A(h))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,A(s)),this.Canvas.lineTo(h,A(s))):(this.Canvas.moveTo(A(s),l),this.Canvas.lineTo(A(s),h)),this.Canvas.stroke())},this.DrawDownBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,o=e+a,s=n+(o-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),D=l;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(A(D),A(s)),this.Canvas.lineTo(A(u),A(s))):(this.Canvas.moveTo(A(s),A(D)),this.Canvas.lineTo(A(s),A(u))),this.Canvas.stroke(),D=u):D=u,r?Math.abs(C-D)<1?this.Canvas.fillRect(b(D),b(n),1,b(a)):this.Canvas.fillRect(b(D),b(n),b(C-D),b(a)):Math.abs(C-D)<1?this.Canvas.fillRect(b(n),b(D),b(a),1):this.Canvas.fillRect(b(n),b(Math.min(D,C)),b(a),b(Math.abs(C-D))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(A(D),A(s)),this.Canvas.lineTo(A(h),A(s))):(this.Canvas.moveTo(A(s),A(D)),this.Canvas.lineTo(A(s),A(h))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,A(s)),this.Canvas.lineTo(h,A(s))):(this.Canvas.moveTo(A(s),l),this.Canvas.lineTo(A(s),h)),this.Canvas.stroke())},this.DrawUnChangeBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,o=e+a,s=n+(o-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=(this.ChartFrame.GetYFromData(t.Close),l);a>=4?(this.Canvas.beginPath(),t.High>t.Close?(r?(this.Canvas.moveTo(C,A(s)),this.Canvas.lineTo(u,A(s))):(this.Canvas.moveTo(A(s),C),this.Canvas.lineTo(A(s),u)),C=u):C=u,r?(this.Canvas.moveTo(A(C),A(n)),this.Canvas.lineTo(A(C),A(o))):(this.Canvas.moveTo(A(n),A(C)),this.Canvas.lineTo(A(o),A(C))),t.Open>t.Low&&(r?(this.Canvas.moveTo(A(C),A(s)),this.Canvas.lineTo(A(h),A(s))):(this.Canvas.moveTo(A(s),A(C)),this.Canvas.lineTo(A(s),A(h)))),this.Canvas.stroke()):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,A(s)),this.Canvas.lineTo(h,A(s))):(this.Canvas.moveTo(A(s),l),this.Canvas.lineTo(A(s),h)),this.Canvas.stroke())},this.DrawBar=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount;this.IsHScreen&&(a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom());for(var n=this.Data.DataOffset,o=0;n<this.Data.Data.length&&o<r;++n,++o,a+=t+e){var s=this.Data.Data[n];if(null!=s.Open&&null!=s.High&&null!=s.Low&&null!=s.Close&&this.KLineColor.has(n)){var h=this.KLineColor.get(n),l=a+t;if(l>i)break;h.Color?(this.Canvas.strokeStyle=h.Color,this.Canvas.fillStyle=h.Color):(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color),s.Open<s.Close?this.DrawUpBarItem(s,a,t,h):s.Open>s.Close?this.DrawDownBarItem(s,a,t,h):this.DrawUnChangeBarItem(s,a,t,h)}}},this.DrawColorBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+qi.FrameLeftMargin,n=i.RightEx,o=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+qi.FrameLeftMargin,n=i.BottomEx}for(var s=this.Data.DataOffset,h=0;s<this.Data.Data.length&&h<o;++s,++h,r+=e+a){var l=this.Data.Data[s];if(l&&(sa.IsNumber(l.Open)&&sa.IsNumber(l.High)&&sa.IsNumber(l.Low)&&sa.IsNumber(l.Close))){var u=r,C=r+e;if(C>n)break;var D=u+(C-u)/2,f=this.GetYFromData(l.Low,!1),c=this.GetYFromData(l.High,!1),m=this.GetYFromData(l.Open,!1),d=this.GetYFromData(l.Close,!1),I=c;l.Open==l.Close?this.DrawKBar_Unchagne(l,e,this.Color,this.IsEmptyBar,D,I,u,C,f,c,m,d,t):this.DrawKBar_Custom(l,e,this.Color,this.IsEmptyBar,D,I,u,C,f,c,m,d,t)}}},this.DrawKBar_Unchagne=function(t,e,a,i,r,n,o,s,h,l,u,C,D){if(e>=4){if(e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,this.Canvas.beginPath(),t.High>t.Close){if(D)this.Canvas.moveTo(n,A(r)),this.Canvas.lineTo(u,A(r));else{var f=A(o+e/2);this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,u)}n=u}else n=u;if(D?(this.Canvas.moveTo(A(n),A(o)),this.Canvas.lineTo(A(n),A(s))):(this.Canvas.moveTo(A(o),A(n)),this.Canvas.lineTo(A(o+e),A(n))),t.Open>t.Low)if(D)this.Canvas.moveTo(A(n),A(r)),this.Canvas.lineTo(A(h),A(r));else{f=A(o+e/2);this.Canvas.moveTo(f,A(n)),this.Canvas.lineTo(f,A(h))}this.Canvas.stroke()}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,A(r)),this.Canvas.lineTo(h,A(r))):(this.Canvas.moveTo(A(r),l),this.Canvas.lineTo(A(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Custom=function(t,e,a,i,r,n,o,s,h,l,u,C,D){if(i&&e%2!=0&&(e-=1),e>=4){if(this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(A(n),A(r)),this.Canvas.lineTo(A(i?Math.max(C,u):C),A(r));else if(i){var f=o+e/2;this.Canvas.moveTo(A(f),A(n)),this.Canvas.lineTo(A(f),A(Math.min(C,u)))}else this.Canvas.moveTo(A(r),A(n)),this.Canvas.lineTo(A(r),A(C));this.Canvas.stroke(),n=C}else n=C;if(this.Canvas.fillStyle=a,D?Math.abs(u-n)<1?this.Canvas.fillRect(b(n),b(o),1,b(e)):i?(this.Canvas.beginPath(),this.Canvas.rect(A(n),A(o),b(u-n),b(e)),this.Canvas.stroke()):this.Canvas.fillRect(b(n),b(o),b(u-n),b(e)):Math.abs(u-n)<1?this.Canvas.fillRect(b(o),b(n),b(e),1):i?(this.Canvas.beginPath(),this.Canvas.rect(A(o),A(n),b(e),b(u-n)),this.Canvas.stroke()):this.Canvas.fillRect(b(o),b(Math.min(n,u)),b(e),b(Math.abs(u-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(A(i?Math.min(C,u):n),A(r)),this.Canvas.lineTo(A(h),A(r));else if(i){f=o+e/2;this.Canvas.moveTo(A(f),A(Math.max(C,u))),this.Canvas.lineTo(A(f),A(h))}else this.Canvas.moveTo(A(r),A(n)),this.Canvas.lineTo(A(r),A(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,A(r)),this.Canvas.lineTo(h,A(r))):(this.Canvas.moveTo(A(r),l),this.Canvas.lineTo(A(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.GetMaxMin=function(){var t={Max:null,Min:null};if("DRAWCOLORKLINE"==this.DrawName)for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<e;++a,++i){var r=this.Data.Data[a];r&&(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close&&(null==t.Max&&(t.Max=r.High),null==t.Min&&(t.Min=r.Low),t.Max<r.High&&(t.Max=r.High),t.Min>r.Low&&(t.Min=r.Low)))}return t}}function yt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartHeatMap",this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize){this.ChartFrame.IsHScreen;for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetBorder(),i=a.LeftEx+qi.FrameLeftMargin,r=a.RightEx,n=this.ChartFrame.XPointCount,o=this.Data.DataOffset,s=0;o<this.Data.Data.length&&s<n;++o,++s,i+=t+e){var h=this.Data.Data[o];if(h.HeatMap){var l=i,u=i+t;if(u>r)break;this.DrawHeatMap(l,u+e,h.HeatMap)}}}},this.DrawHeatMap=function(t,e,a){if(sa.IsNonEmptyArray(a.Order)){var i=this.ChartFrame.HorizontalMax,r=this.ChartFrame.HorizontalMin,n=0;sa.IsNumber(a.PriceOffset)&&(n=this.GetPriceYOffset(a.PriceOffset));for(var o=0;o<a.Order.length;++o){var s=a.Order[o];if(sa.IsNumber(s.Price)&&(s.Color&&!(s.Price>i||s.Price<r))){var h=this.GetYFromData(s.Price,!1),l={Left:t,Right:e,Bottom:h+n/2,Top:h-n/2};l.Width=l.Right-l.Left,l.Height=l.Bottom-l.Top,this.Canvas.fillStyle=s.Color,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height)}}}},this.GetPriceYOffset=function(t){var e=this.ChartFrame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a}}var Rt={STATUS_NONE_ID:0,STATUS_REQUESTDATA_ID:1,STATUS_RECVDATA_ID:2,STATUS_FINISHED_ID:3};function Nt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartOverlayKLine",this.Color="rgb(65,105,225)",this.MainData,this.SourceData,this.Title,this.DrawType=0,this.CustomDrawType=null,this.Status=Rt.STATUS_NONE_ID,this.IsDelete=!1,this.CloseLineWidth=qi.CloseLineWidth,this.ShowRange={},this.DrawKRange={Start:null,End:null},this.YInfoType=4,this.SetOption=function(t){t&&(sa.IsNumber(t.DrawType)&&(this.CustomDrawType=t.DrawType),sa.IsNumber(t.YInfoType)&&(this.YInfoType=t.YInfoType))},this.DrawKBar=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var o=this.ChartFrame.XPointCount,s=this.DrawType;null!=this.CustomDrawType&&(s=this.CustomDrawType);var h=!0,l=null;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset;for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<o;++u,++C,r+=a+i,++this.ShowRange.DataCount){var D=this.Data.Data[u];if(D&&null!=D.Open&&null!=D.High&&null!=D.Low&&null!=D.Close){null==l&&(l=D.Open,this.ShowRange.FirstOverlayOpen=D.Open),h&&(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color,this.Canvas.beginPath(),h=!1);var f=r,c=r+a;if(c>n)break;var m=f+(c-f)/2,d=this.GetYFromData(D.Low/l*t,!1),I=this.GetYFromData(D.High/l*t,!1),S=this.GetYFromData(D.Open/l*t,!1),T=this.GetYFromData(D.Close/l*t,!1),v=I;this.DrawKRange.End=u,D.Open<D.Close?a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(A(v),A(m)),this.Canvas.lineTo(A(3==this.DrawType?Math.max(T,S):T),A(m))):(this.Canvas.moveTo(A(m),A(v)),this.Canvas.lineTo(A(m),A(3==this.DrawType?Math.min(T,S):T))),v=T):v=T,e?Math.abs(S-v)<1?this.Canvas.fillRect(b(v),b(f),1,b(a)):3==s?this.Canvas.rect(A(v),A(f),b(S-v),b(a)):this.Canvas.fillRect(b(v),b(f),b(S-v),b(a)):Math.abs(S-v)<1?this.Canvas.fillRect(b(f),b(v),b(a),1):3==s?this.Canvas.rect(A(f),A(v),b(a),b(S-v)):this.Canvas.fillRect(b(f),b(v),b(a),b(S-v)),D.Open>D.Low&&(e?(this.Canvas.moveTo(A(3==this.DrawType?Math.min(T,S):v),A(m)),this.Canvas.lineTo(A(d),A(m))):(this.Canvas.moveTo(A(m),A(3==this.DrawType?Math.max(T,S):v)),this.Canvas.lineTo(A(m),A(d))))):e?(this.Canvas.moveTo(I,A(m)),this.Canvas.lineTo(d,A(m))):(this.Canvas.moveTo(A(m),I),this.Canvas.lineTo(A(m),d)):D.Open>D.Close?a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(A(v),A(m)),this.Canvas.lineTo(A(S),A(m))):(this.Canvas.moveTo(A(m),A(v)),this.Canvas.lineTo(A(m),A(S))),v=S):v=S,e?Math.abs(T-v)<1?this.Canvas.fillRect(b(v),b(f),1,b(a)):this.Canvas.fillRect(b(v),b(f),b(T-v),b(a)):Math.abs(T-v)<1?this.Canvas.fillRect(b(f),b(v),b(a),1):this.Canvas.fillRect(b(f),b(v),b(a),b(T-v)),D.Open>D.Low&&(e?(this.Canvas.moveTo(A(v),A(m)),this.Canvas.lineTo(A(d),A(m))):(this.Canvas.moveTo(A(m),A(v)),this.Canvas.lineTo(A(m),A(d))))):e?(this.Canvas.moveTo(I,A(m)),this.Canvas.lineTo(d,A(m))):(this.Canvas.moveTo(A(m),I),this.Canvas.lineTo(A(m),d)):a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(v,A(m)),this.Canvas.lineTo(S,A(m))):(this.Canvas.moveTo(A(m),v),this.Canvas.lineTo(A(m),S)),v=S):v=S,e?(this.Canvas.moveTo(A(v),A(f)),this.Canvas.lineTo(A(v),A(c))):(this.Canvas.moveTo(A(f),A(v)),this.Canvas.lineTo(A(c),A(v))),D.Open>D.Low&&(e?(this.Canvas.moveTo(A(v),A(m)),this.Canvas.lineTo(A(d),A(m))):(this.Canvas.moveTo(A(m),A(v)),this.Canvas.lineTo(A(m),A(d))))):e?D.High==D.Low?(this.Canvas.moveTo(I,A(m)),this.Canvas.lineTo(d-1,A(m))):(this.Canvas.moveTo(I,A(m)),this.Canvas.lineTo(d,A(m))):D.High==D.Low?(this.Canvas.moveTo(A(m),I),this.Canvas.lineTo(A(m),d+1)):(this.Canvas.moveTo(A(m),I),this.Canvas.lineTo(A(m),d));var p=Math.min(d,I,S,T),g=Math.max(d,I,S,T),x=new gt(f,p,a,g-p);this.TooltipRect.push([u,x])}}0==h&&this.Canvas.stroke()},this.DrawAKLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var o=this.ChartFrame.XPointCount,s=null;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset,this.Canvas.strokeStyle=this.Color;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<o;++h,++l,r+=a+i,++this.ShowRange.DataCount){var u=this.Data.Data[h];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){null==s&&(s=u.Open,this.ShowRange.FirstOverlayOpen=u.Open);var C=r,D=r+a;if(D>n)break;var f=C+(D-C)/2,c=this.GetYFromData(u.Low/s*t,!1),m=this.GetYFromData(u.High/s*t,!1),d=this.GetYFromData(u.Open/s*t,!1),I=this.GetYFromData(u.Close/s*t,!1);this.DrawKRange.End=h,this.Canvas.beginPath(),e?(this.Canvas.moveTo(m,A(f)),this.Canvas.lineTo(c,A(f))):(this.Canvas.moveTo(A(f),m),this.Canvas.lineTo(A(f),c)),this.Canvas.stroke(),a>=4&&(this.Canvas.beginPath(),e?(this.Canvas.moveTo(A(d),C),this.Canvas.lineTo(A(d),f)):(this.Canvas.moveTo(C,A(d)),this.Canvas.lineTo(f,A(d))),this.Canvas.stroke(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(A(I),D),this.Canvas.lineTo(A(I),f)):(this.Canvas.moveTo(D,A(I)),this.Canvas.lineTo(f,A(I))),this.Canvas.stroke())}}},this.DrawCloseLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var o=this.ChartFrame.XPointCount,s=null,h=!0;this.Canvas.strokeStyle=this.Color,sa.IsNumber(this.CloseLineWidth)&&(this.Canvas.lineWidth=this.CloseLineWidth),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=o,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset,this.Canvas.beginPath();for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<o;++l,++u,r+=a+i,++this.ShowRange.DataCount){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==s&&(s=C.Open,this.ShowRange.FirstOverlayOpen=C.Open);var D=r,f=r+a;if(f>n)break;var c=D+(f-D)/2,m=this.GetYFromData(C.Close/s*t,!1);this.DrawKRange.End=l,h?(e?this.Canvas.moveTo(m,c):this.Canvas.moveTo(c,m),h=!1):e?this.Canvas.lineTo(m,c):this.Canvas.lineTo(c,m)}}0==h&&this.Canvas.stroke()},this.GetFirstOpen=function(){if(!this.MainData||!this.Data)return null;for(var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=0;e<this.MainData.Data.length&&a<t;++e,++a){var i=this.MainData.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return i.Open}return null},this.Draw=function(){if(this.TooltipRect=[],this.InfoTooltipRect=[],this.DrawKRange={Start:null,End:null},this.MainData&&this.Data){this.ChartFrame.XPointCount;var t=this.GetFirstOpen();if(null!=t){var e=this.DrawType;null!=this.CustomDrawType&&(e=this.CustomDrawType),this.Canvas.save(),this.ClipClient(this.ChartFrame.IsHScreen),1==e?this.DrawCloseLine(t):2==e?this.DrawAKLine(t):this.DrawKBar(t),this.Canvas.restore()}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(!this.MainData||!this.Data)return e;var a=this.GetFirstOpen();if(null==a)return e;for(var i,r,n=null,o=this.Data.DataOffset,s=0;o<this.Data.Data.length&&s<t;++o,++s){var h=this.Data.Data[o];h&&null!=h.Open&&null!=h.High&&null!=h.Low&&null!=h.Close&&(null==n&&(n=h.Open),i=h.High/n*a,r=h.Low/n*a,null==e.Max&&(e.Max=i),null==e.Min&&(e.Min=r),e.Max<i&&(e.Max=i),e.Min>r&&(e.Min=r))}return e},this.GetTooltipData=function(t,e,a){for(var i in this.TooltipRect){var r=this.TooltipRect[i][1];if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e)){var n=this.TooltipRect[i][0];return a.Data=this.Data.Data[n],a.ChartPaint=this,!0}}return!1},this.PtInChart=function(t,e){var a=this.DrawType;return sa.IsNumber(this.CustomDrawType)&&(a=this.CustomDrawType),1==a||4==a?null:this.PtInKBar(t,e,{OverlayKLine:!0})},this.DrawSelectedStatus=function(){this.DrawLinePoint({OverlayKLine:!0})}}function wt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartKLineTable",this.Data,this.RowName,this.RowNamePosition=1,this.BGColor,this.BorderColor,this.RowCount=5,this.RowHeight=10,this.RowHeightType=1,this.TextFontConfig=P(qi.ChartKLineTable.TextFont),this.ItemMergin=P(qi.ChartKLineTable.ItemMergin),this.TextFont,this.TextColor="rgb(0,0,0)",this.AryTableData=[],this.MapCache=null,this.GetKValue=dt.GetKValue,this.AryCellRect=[],this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.AryTableData))for(var e=0;e<this.AryTableData.length;++e){var a=this.AryTableData[e],i=this.BuildKey(a);t.set(i,a)}},this.DrawBG=function(t){this.BGColor&&this.BGColor&&(this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(t.Left+1,t.Top,t.Width-1,t.Height))},this.DrawBorder=function(t){if(this.BorderColor)for(var e=t.Top,a=0;a<30;++a)if(this.Canvas.beginPath(),this.Canvas.moveTo(t.Left,A(e)),this.Canvas.lineTo(t.Right,A(e)),this.Canvas.stroke(),e+=this.RowHeight,e>=t.Bottom)break},this.CalculateRowHeight=function(t){1==this.RowHeightType?this.RowHeight=this.TextFontConfig.FontMaxSize+this.ItemMergin.Top+this.ItemMergin.Bottom:this.RowHeight=t.Height/this.RowCount},this.Draw=function(){if(this.AryCellRect=[],this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&sa.IsNonEmptyArray(this.AryTableData)&&this.MapCache&&!(this.MapCache.size<=0)&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var t=!0===this.ChartFrame.IsHScreen;if(!t&&!(this.RowCount<=0)){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=this.ChartFrame.GetBorder(),n=(r.Bottom,r.TopTitle,r.LeftEx+qi.FrameLeftMargin),o=r.RightEx,s=r.TopTitle,h=r.Bottom,l={Left:r.LeftEx,Top:s,Right:r.RightEx,Bottom:h};l.Width=l.Right-l.Left,l.Height=l.Bottom-l.Top,this.DrawBG(l),this.CalculateRowHeight(l);var u=this.RowHeight,C=e+a;u-this.ItemMergin.Top-this.ItemMergin.Bottom>0&&(u=u-this.ItemMergin.Top-this.ItemMergin.Bottom),C-this.ItemMergin.Left-this.ItemMergin.Right>0&&(C=C-this.ItemMergin.Left-this.ItemMergin.Right);var D=this.GetDynamicTextFont(u,C);this.TextFont=D,this.Canvas.font=this.TextFont;for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<i;++f,++c,n+=e+a){var m=this.Data.Data[f];if(m){var d=n,I=n+e+a;if(I>o)break;var S=d+(I-d)/2;if(S>o)break;var T=!1;0==c&&1===this.RowNamePosition&&(T=!0),T&&this.DrawRowName(s,h,d,I);var v=this.BuildKey(m);if(this.MapCache.has(v)){var p=this.MapCache.get(v);T||this.DrawRow(p,s,h,d,I)}}}3==this.RowNamePosition&&this.DrawRightRowName(),this.DrawBorder(l)}}},this.DrawRowName=function(t,e,a,i){if(sa.IsNonEmptyArray(this.RowName)){var r=a,n=t,o=i-a,s=3;this.ItemMergin.YOffset&&(s=this.ItemMergin.YOffset);for(var h=0;h<this.RowName.length;++h){var l=this.RowName[h],u={Left:r,Top:n,Right:i,Height:this.RowHeight,Width:o};u.Bottom=u.Top+this.RowHeight;var C=u.Bottom-s;l.Name&&u.Width>10&&(this.Canvas.fillStyle=l.Color?l.Color:this.TextColor,this.Canvas.textBaseline="bottom","right"==l.TextAlign?(this.Canvas.textAlign="right",this.Canvas.fillText(l.Name,u.Right-2,C,o-4)):"center"==l.TextAlign?(this.Canvas.textAlign="center",this.Canvas.fillText(l.Name,u.Left+u.Width/2,C,o-4)):(this.Canvas.textAlign="left",this.Canvas.fillText(l.Name,u.Left+2,C,o-4))),n+=this.RowHeight}}},this.DrawRightRowName=function(){var t=this.ChartFrame.GetBorder();if(this.BGColor){var e={Left:t.RightEx,Top:t.Top,Right:t.ChartWidth,Bottom:t.Bottom};e.Width=e.Right-e.Left,e.Height=e.Bottom-e.Top,this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(e.Left+1,e.Top,e.Width-1,e.Height)}var a=t.RightEx,i=t.TopTitle,r=3;this.ItemMergin.YOffset&&(r=this.ItemMergin.YOffset);for(var n=0;n<this.RowName.length;++n){var o=this.RowName[n],s={Left:a,Top:i,Right:t.ChartWidth,Height:this.RowHeight};s.Bottom=s.Top+this.RowHeight,s.Width=s.Right-s.Left;var h=s.Bottom-r;if(s.Bottom>t.Bottom)break;o.Name&&s.Width>10&&(this.Canvas.fillStyle=o.Color?o.Color:this.TextColor,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillText(o.Name,s.Left+2,h)),i+=this.RowHeight}},this.DrawRow=function(t,e,a,i,r){if(sa.IsNonEmptyArray(t.Data)){var n=i,o=e,s=r-i,h=3;this.ItemMergin.YOffset&&(h=this.ItemMergin.YOffset);for(var l=0;l<t.Data.length;++l,o+=this.RowHeight){var u=t.Data[l];if(u){var C={Left:n,Top:o,Right:r,Height:this.RowHeight,Width:s};if(C.Bottom=C.Top+this.RowHeight,C.Bottom>a)break;if(sa.IsNonEmptyArray(u.AryText))for(var D=C.Width/u.AryText.length,f=C.Left,c=0;c<u.AryText.length;++c){var m=u.AryText[c],d={Left:f,Top:C.Top,Bottom:C.Bottom,Width:D,Height:C.Height};if(d.Right=d.Left+d.Width,m&&m.BGColor&&(this.Canvas.fillStyle=m.BGColor,this.Canvas.fillRect(d.Left,d.Top,d.Width,d.Height)),m&&m.Color&&D>10){this.Canvas.fillStyle=m.Color,this.Canvas.textBaseline="bottom";var I=d.Bottom-h;"right"==m.TextAlign?(this.Canvas.textAlign="right",this.Canvas.fillText(m.Text,d.Right-2,I,s-4)):"center"==m.TextAlign?(this.Canvas.textAlign="center",this.Canvas.fillText(m.Text,d.Left+d.Width/2,I,s-4)):(this.Canvas.textAlign="left",this.Canvas.fillText(m.Text,d.Left+2,I,s-4))}C.Width>5&&this.AryCellRect.push({Item:{Cell:u,Colunm:t,RowIndex:l,SubCell:m,SubIndex:c,Tooltip:m.Tooltip,Type:2},Rect:d}),f+=D}else{if(u.BGColor&&(this.Canvas.fillStyle=u.BGColor,this.Canvas.fillRect(C.Left,C.Top,C.Width,C.Height)),u.Text&&C.Width>10){u.Color?this.Canvas.fillStyle=u.Color:this.Canvas.fillStyle=this.TextColor,this.Canvas.textBaseline="bottom";I=C.Bottom-h;"right"==u.TextAlign?(this.Canvas.textAlign="right",this.Canvas.fillText(u.Text,C.Right-2,I,s-4)):"center"==u.TextAlign?(this.Canvas.textAlign="center",this.Canvas.fillText(u.Text,C.Left+C.Width/2,I,s-4)):(this.Canvas.textAlign="left",this.Canvas.fillText(u.Text,C.Left+2,I,s-4))}C.Width>5&&this.AryCellRect.push({Item:{Cell:u,Colunm:t,RowIndex:l,Tooltip:u.Tooltip,Type:1},Rect:C})}}}}},this.GetDynamicTextFont=function(t,e,a){var i=parseInt(t)-2;t<5&&(i=parseInt(t)),i>this.TextFontConfig.FontMaxSize?i=this.TextFontConfig.FontMaxSize:i<=0&&(i=1);var r=this.FormatFontString(i,this.TextFontConfig.Family,a);return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i="".concat(a.Weight," ").concat(t,"px ").concat(e)):i="".concat(t,"px ").concat(e),i},this.GetMaxMin=function(){return{Min:0,Max:this.RowCount}},this.GetTooltipData=function(t,e,a){if(!this.IsShow)return!1;for(var i=0;i<this.AryCellRect.length;++i){var r=this.AryCellRect[i];if(r.Rect){var n=r.Rect;if(t>=n.Left&&t<=n.Right&&e>=n.Top&&e<=n.Bottom){var o=r.Item;return u.Chart.Log("[ChartKLineTable::GetTooltipData] cell",r),a.Data={Rect:r.Rect,Item:o},a.ChartPaint=this,a.Type=9,!0}}}return!1}}function At(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartSimpleTable",this.TextFontConfig=P(qi.ChartSimpleTable.TextFont),this.ItemMargin=P(qi.ChartSimpleTable.ItemMargin),this.TextColor=qi.ChartSimpleTable.TextColor,this.BGColor=qi.ChartSimpleTable.BGColor,this.BorderColor=qi.ChartSimpleTable.BorderColor,this.Offset={X:-3,Y:0},this.DefaultCellWidth=30,this.RectClient={},this.AryColumnCache=[],this.TextFontHeight,this.TextFont,this.RowHeight,this.ReloadResource=function(t){this.TextFontConfig=P(qi.ChartSimpleTable.TextFont),this.ItemMargin=P(qi.ChartSimpleTable.ItemMargin),this.TextColor=qi.ChartSimpleTable.TextColor,this.BGColor=qi.ChartSimpleTable.BGColor,this.BorderColor=qi.ChartSimpleTable.BorderColor},this.CalculateSize=function(){this.AryColumnCache=[];var t=F();this.TextFont="".concat(this.TextFontConfig.Size*t,"px ").concat(this.TextFontConfig.Name),this.TextFontHeight=this.GetFontHeight(this.TextFont,"擎"),this.RowHeight=this.TextFontHeight+this.ItemMargin.Top+this.ItemMargin.Bottom;for(var e=this.Data.Data.length,a=0,i=0;a<e;++a){var r=this.Data.Data[a];for(i=0;i<r.AryCell.length;++i){this.AryColumnCache[i]||(this.AryColumnCache[i]={Width:this.DefaultCellWidth});var n=this.AryColumnCache[i],o=r.AryCell[i],s=this.Canvas.measureText(o.Text).width;n.Width<s&&(n.Width=s)}}var h=0;for(a=0;a<this.AryColumnCache.length;++a){var l=this.AryColumnCache[a];l.Width+=this.ItemMargin.Left+this.ItemMargin.Right,h+=l.Width}this.RectClient={Width:h,Height:this.RowHeight*e};var u=this.ChartFrame.GetBorder();this.RectClient.Right=u.Right+this.Offset.X,this.RectClient.Top=u.TopEx+this.Offset.Y,this.RectClient.Left=this.RectClient.Right-this.RectClient.Width,this.RectClient.Bottom=this.RectClient.Top+this.RectClient.Height},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var t=!0===this.ChartFrame.IsHScreen;if(!t){this.CalculateSize(),this.BGColor&&(this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(this.RectClient.Left,this.RectClient.Top,this.RectClient.Width,this.RectClient.Height));var e=this.RowHeight;this.Canvas.font=this.TextFont,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";var a={Left:this.RectClient.Left,Top:this.RectClient.Top,Width:this.RectClient.Width,Height:e};a.Right=a.Left+a.Width,a.Bottom=a.Top+a.Height;for(var i=this.Data.Data.length,r=0;r<i;++r){var n=this.Data.Data[r];this.DrawRow(n,a),a.Top+=e,a.Bottom+=e}this.DrawBorder()}}},this.DrawBorder=function(){if(this.BorderColor){var t=this.Data.Data.length,e=this.AryColumnCache.length;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath();for(var a=this.RectClient.Top,i=this.RectClient.Left,r=this.RectClient.Right,n=this.RectClient.Bottom,o=this.RectClient.Top,s=0;s<t;++s){if(0==s){var h=A(a);this.Canvas.moveTo(i,h),this.Canvas.lineTo(r,h)}h=A(a+this.RowHeight);this.Canvas.moveTo(i,h),this.Canvas.lineTo(r,h),a+=this.RowHeight}var l=this.RectClient.Left;for(s=0;s<e;++s){var u=this.AryColumnCache[s];if(0==s){var C=A(l);this.Canvas.moveTo(C,o),this.Canvas.lineTo(C,n)}C=A(l+u.Width);this.Canvas.moveTo(C,o),this.Canvas.lineTo(C,n),l+=u.Width}this.Canvas.stroke()}},this.DrawRow=function(t,e){if(sa.IsNonEmptyArray(t.AryCell))for(var a=e.Left,i=(e.Top,e.Width,0);i<t.AryCell.length;++i){var r=t.AryCell[i],n=this.AryColumnCache[i],o={Left:a,Top:e.Top,Bottom:e.Bottom,Height:this.RowHeight,Width:n.Width};if(o.Right=o.Left+o.Width,r&&(r.BGColor&&(this.Canvas.fillStyle=r.BGColor,this.Canvas.fillRect(o.Left,o.Top,o.Width,o.Height)),r.Text&&o.Width>10)){r.Color?this.Canvas.fillStyle=r.Color:this.Canvas.fillStyle=this.TextColor;var s=a+this.ItemMargin.Left,h=o.Bottom-this.ItemMargin.Bottom;if("right"==r.TextAlign){var l=this.Canvas.measureText(r.Text).width;s=o.Right-this.ItemMargin.Right-l}else if("center"==r.TextAlign){l=this.Canvas.measureText(r.Text).width;s=o.Left+o.Width/2-l/2}this.Canvas.fillText(r.Text,s,h)}a+=o.Width}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function Ot(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartSimplePie",this.BorderColor=qi.ChartSimplePie.BorderColor,this.Offset=P(qi.ChartSimplePie.Offset),this.LineExtendWidth=10,this.TextFontConfig=P(qi.ChartSimplePie.TextFont),this.RectClient={},this.TotalValue=1,this.Radius=50,this.TextFont,this.ReloadResource=function(t){this.BorderColor=qi.ChartSimplePie.BorderColor,this.Offset=P(qi.ChartSimplePie.Offset),this.TextFontConfig=P(qi.ChartSimplePie.TextFont)},this.CalculateSize=function(){var t=this.ChartFrame.GetBorder(),e=F();this.TextFont="".concat(this.TextFontConfig.Size*e,"px ").concat(this.TextFontConfig.Name),this.LineExtendWidth=this.GetFontHeight(this.TextFont,"擎")+1,this.RectClient={Width:2*this.Radius*e,Height:2*this.Radius*e},this.RectClient.Right=t.Right+this.Offset.X,this.RectClient.Top=t.TopEx+this.Offset.Y,this.RectClient.Left=this.RectClient.Right-this.RectClient.Width,this.RectClient.Bottom=this.RectClient.Top+this.RectClient.Height},this.CalculateTotalValue=function(){for(var t=0,e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];sa.IsPlusNumber(a.Value)&&(t+=a.Value)}this.TotalValue=t},this.DrawPie=function(){this.Canvas.font=this.TextFont,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";for(var t=[],e=0,a=0;a<this.Data.Data.length;++a){var i=this.Data.Data[a];if(sa.IsPlusNumber(i.Value)&&i.Text){var r=this.Canvas.measureText(i.Text).width;t[a]={Width:r},e<r&&(e=r)}}var n=e+this.LineExtendWidth;this.RectClient.Left-=n,this.RectClient.Right-=n;var o=F(),s=this.Radius*o,h=0,l=0,u=this.RectClient.Left+s,C=this.RectClient.Top+s;for(a=0;a<this.Data.Data.length;++a){i=this.Data.Data[a];if(sa.IsPlusNumber(i.Value)){var D=i.Value/this.TotalValue;if(this.Canvas.beginPath(),this.Canvas.moveTo(u,C),l+=2*D*Math.PI,this.Canvas.strokeStyle=this.BorderColor,this.Canvas.fillStyle=i.Color,this.Canvas.arc(u,C,s,h,l),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),i.Text){var f=s*Math.cos(l-(l-h)/2)+u,c=s*Math.sin(l-(l-h)/2)+C,m=(s+this.LineExtendWidth)*Math.cos(l-(l-h)/2)+u,d=(s+this.LineExtendWidth)*Math.sin(l-(l-h)/2)+C;this.Canvas.beginPath(),i.LineColor?this.Canvas.strokeStyle=i.LineColor:this.Canvas.strokeStyle=i.Color,this.Canvas.moveTo(f,c),this.Canvas.lineTo(m,d);r=t[a].Width;var I=m;l-(l-h)/2<1.5*Math.PI&&l-(l-h)/2>.5*Math.PI?(this.Canvas.lineTo(m-r,d),I=m-r):this.Canvas.lineTo(m+r,d),this.Canvas.stroke(),i.TextColor?this.Canvas.fillStyle=i.TextColor:this.Canvas.fillStyle=i.Color,this.Canvas.fillText(i.Text,I,d)}h+=2*D*Math.PI}}},this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();this.CalculateTotalValue(),sa.IsPlusNumber(this.TotalValue)||this.DrawEmptyData(),this.CalculateSize(),this.Canvas.save(),this.DrawPie(),this.Canvas.restore()},this.DrawEmptyData=function(){u.Chart.Log("[ChartSimplePie::DrawEmptyData]")},this.GetMaxMin=function(){return{Min:null,Max:null}}}function bt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartSimpleDoughnut",this.BorderColor=qi.ChartSimpleDoughnut.BorderColor,this.Offset=P(qi.ChartSimpleDoughnut.Offset),this.LineExtendWidth=10,this.TextFontConfig=P(qi.ChartSimpleDoughnut.TextFont),this.RectClient={},this.TotalValue=1,this.Radius=50,this.InnerRadius=30,this.TextFont,this.ReloadResource=function(t){this.BorderColor=qi.ChartSimpleDoughnut.BorderColor,this.Offset=P(qi.ChartSimpleDoughnut.Offset),this.TextFontConfig=P(qi.ChartSimpleDoughnut.TextFont)},this.CalculateSize=function(){var t=this.ChartFrame.GetBorder(),e=F();this.TextFont="".concat(this.TextFontConfig.Size*e,"px ").concat(this.TextFontConfig.Name),this.LineExtendWidth=this.GetFontHeight(this.TextFont,"擎")+1,this.RectClient={Width:2*this.Radius*e,Height:2*this.Radius*e},this.RectClient.Right=t.Right+this.Offset.X,this.RectClient.Top=t.TopEx+this.Offset.Y,this.RectClient.Left=this.RectClient.Right-this.RectClient.Width,this.RectClient.Bottom=this.RectClient.Top+this.RectClient.Height},this.CalculateTotalValue=function(){for(var t=0,e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];sa.IsPlusNumber(a.Value)&&(t+=a.Value)}this.TotalValue=t},this.DrawPie=function(){this.Canvas.font=this.TextFont,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";for(var t=[],e=0,a=0;a<this.Data.Data.length;++a){var i=this.Data.Data[a];if(sa.IsPlusNumber(i.Value)&&i.Text){var r=this.Canvas.measureText(i.Text).width;t[a]={Width:r},e<r&&(e=r)}}var n=e+this.LineExtendWidth;this.RectClient.Left-=n,this.RectClient.Right-=n;var o=F(),s=this.Radius*o,h=this.InnerRadius*o,l=0,u=0,C=this.RectClient.Left+s,D=this.RectClient.Top+s;for(a=0;a<this.Data.Data.length;++a){i=this.Data.Data[a];if(sa.IsPlusNumber(i.Value)){var f=i.Value/this.TotalValue;if(this.Canvas.beginPath(),u+=2*f*Math.PI,this.Canvas.strokeStyle=this.BorderColor,this.Canvas.fillStyle=i.Color,this.Canvas.arc(C,D,s,l,u),this.Canvas.arc(C,D,h,u-2*Math.PI,l-2*Math.PI,!0),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),i.Text){var c=s*Math.cos(u-(u-l)/2)+C,m=s*Math.sin(u-(u-l)/2)+D,d=(s+this.LineExtendWidth)*Math.cos(u-(u-l)/2)+C,I=(s+this.LineExtendWidth)*Math.sin(u-(u-l)/2)+D;this.Canvas.beginPath(),i.LineColor?this.Canvas.strokeStyle=i.LineColor:this.Canvas.strokeStyle=i.Color,this.Canvas.moveTo(c,m),this.Canvas.lineTo(d,I);r=t[a].Width;var S=d;u-(u-l)/2<1.5*Math.PI&&u-(u-l)/2>.5*Math.PI?(this.Canvas.lineTo(d-r,I),S=d-r):this.Canvas.lineTo(d+r,I),this.Canvas.stroke(),i.TextColor?this.Canvas.fillStyle=i.TextColor:this.Canvas.fillStyle=i.Color,this.Canvas.fillText(i.Text,S,I)}l+=2*f*Math.PI}}},this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();this.CalculateTotalValue(),sa.IsPlusNumber(this.TotalValue)||this.DrawEmptyData(),this.CalculateSize(),this.Canvas.save(),this.DrawPie(),this.Canvas.restore()},this.DrawEmptyData=function(){u.Chart.Log("[ChartSimplePie::DrawEmptyData]")},this.GetMaxMin=function(){return{Min:null,Max:null}}}function Bt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartSimpleRadar",this.AreaColor="rgba(242,154,118,0.4)",this.AreaLineColor="rgb(242,154,118)",this.TitleColor=qi.ChartSimpleRadar.TextColor,this.TextFontConfig=P(qi.ChartSimpleRadar.TextFont),this.Offset=P(qi.ChartSimpleRadar.Offset),this.BorderColor=qi.ChartSimpleRadar.BorderColor,this.AryBGColor=qi.ChartSimpleRadar.AryBGColor.slice(),this.AryAreaConfig=qi.ChartSimpleRadar.AryArea.slice(),this.StartAngle=270,this.Radius=50,this.AryBorder=[1,.75,.5,.25],this.AryIndex,this.CenterPoint={},this.RectClient={},this.AryIndexCache=[],this.MapDataCache=new Map,this.TextFont,this.ReloadResource=function(t){this.TitleColor=qi.ChartSimpleRadar.TextColor,this.TextFontConfig=P(qi.ChartSimpleRadar.TextFont),this.Offset=P(qi.ChartSimpleRadar.Offset),this.BorderColor=qi.ChartSimpleRadar.BorderColor,this.AryBGColor=qi.ChartSimpleRadar.AryBGColor.slice(),this.AryAreaConfig=qi.ChartSimpleRadar.AryArea.slice()},this.DrawBorder=function(){this.Canvas.strokeStyle=this.BorderColor,this.Canvas.font=this.TextFont;for(var t=0;t<this.AryBorder.length;++t){for(var e=this.AryBorder[t],a=this.RectClient.Radius*e,i=!0,r=0;r<this.AryIndexCache.length;++r){var n=this.AryIndexCache[r],o=this.CenterPoint.X+a*Math.cos(n.Angle*Math.PI/180),s=this.CenterPoint.Y+a*Math.sin(n.Angle*Math.PI/180);i?(this.Canvas.beginPath(),this.Canvas.moveTo(o,s),i=!1):this.Canvas.lineTo(o,s)}this.Canvas.closePath(),this.Canvas.stroke(),sa.IsNonEmptyArray(this.AryBGColor)&&(this.Canvas.fillStyle=this.AryBGColor[t%this.AryBGColor.length],this.Canvas.fill())}this.Canvas.beginPath();for(t=0;t<this.AryIndexCache.length;++t){n=this.AryIndexCache[t],o=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180),s=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180);this.Canvas.moveTo(this.CenterPoint.X,this.CenterPoint.Y),this.Canvas.lineTo(o,s),this.DrawText(n,o,s)}this.Canvas.stroke()},this.GetRadarRate=function(t,e){var a={Max:100,Min:0};return sa.IsNumber(t.Max)&&(a.Max=t.Max),sa.IsNumber(t.Min)&&(a.Min=t.Min),e>a.Max?e=a.Max:e<a.Min&&(e=a.Min),(e-a.Min)/(a.Max-a.Min)},this.DrawArea=function(){if(!(this.MapDataCache.size<=0)){var t,e=0,a=(0,l.default)(this.MapDataCache);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,r=i[1].MapData,n=!0,o=0,s=0;s<this.AryIndexCache.length;++s){var h=this.AryIndexCache[s];if(h.Data&&h.Data.Name&&r.has(h.Data.Name)){var u=r.get(h.Data.Name);u.Data||sa.IsNumber(u.Data.Value)||conintue;var C=this.GetRadarRate(h,u.Data.Value),D=this.CenterPoint.X+h.Radius*C*Math.cos(h.Angle*Math.PI/180),f=this.CenterPoint.Y+h.Radius*C*Math.sin(h.Angle*Math.PI/180);n?(this.Canvas.beginPath(),this.Canvas.moveTo(D,f),n=!1,++o):(this.Canvas.lineTo(D,f),++o)}}if(o>0){this.Canvas.closePath();var c=this.AryAreaConfig[e%this.AryAreaConfig.length];c.Color&&(this.Canvas.fillStyle=c.Color,this.Canvas.fill()),c.LineColor&&(this.Canvas.strokeStyle=c.LineColor,this.Canvas.stroke())}++e}}catch(m){a.e(m)}finally{a.f()}}},this.DrawText=function(t,e,a){if(t.Data&&t.Data.Name){this.Canvas.fillStyle=this.TitleColor;var i=e,r=a,n=t.Angle%360;n>0&&n<45?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",i+=2):n>=45&&n<90?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",i+=2):90==n?(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",r+=2):n>=90&&n<135||n>=135&&n<180?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",i-=2):n>=180&&n<225?(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",i-=2):n>=225&&n<=270?(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom"):n>270&&n<315?(this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",i+=2):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",i+=2),this.Canvas.fillText(t.Data.Name,i,r)}},this.Draw=function(){this.AryIndexCache=[],this.MapData=new Map,sa.IsNonEmptyArray(this.AryIndex)&&(this.CalculateSize(),this.DrawBorder(),this.DrawArea())},this.BuildCacheData=function(){this.MapDataCache=new Map;for(var t=0;t<this.Data.Data.length;++t){var e=this.Data.Data[t];this.MapDataCache.has(e.Group)||this.MapDataCache.set(e.Group,{MapData:new Map});var a=this.MapDataCache.get(e.Group);a.MapData.set(e.Name,{Data:e})}},this.CalculateSize=function(t){var e=this.ChartBorder.GetBorder(),a=F();this.TextFont="".concat(this.TextFontConfig.Size*a,"px ").concat(this.TextFontConfig.Name);var i=this.GetFontHeight(this.TextFont,"擎")+1,r=0;if(sa.IsNonEmptyArray(this.AryIndex))for(var n=0;n<this.AryIndex.length;++n){var o=this.AryIndex[n];if(o.Name){var s=this.Canvas.measureText(o.Name).width;r<s&&(r=s)}}var h=2*this.Radius*a;this.RectClient={Width:2*h,Height:2*h,Radius:h},this.RectClient.Right=e.Right+this.Offset.X-r,this.RectClient.Top=e.TopEx+this.Offset.Y+i,this.RectClient.Left=this.RectClient.Right-this.RectClient.Width,this.RectClient.Bottom=this.RectClient.Top+this.RectClient.Height;var l={X:this.RectClient.Left+this.RectClient.Width/2,Y:this.RectClient.Top+this.RectClient.Height/2},u=Math.max(5,this.AryIndex.length),C=360/u;for(n=0;n<u;++n){var D=n*C+this.StartAngle,f={Data:null,Index:n,Angle:D,Radius:h};this.AryIndex&&this.AryIndex[n]&&(f.Data=this.AryIndex[n]),this.AryIndexCache.push(f)}this.CenterPoint=l},this.DrawEmptyData=function(){u.Chart.Log("[ChartSimpleRadar::DrawEmptyData]")}}function Pt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteVolumBar",this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.UnchangeColor=qi.UnchagneBarColor,this.BarColorType=1,this.CustomColor=qi.Minute.VolBarColor,this.YClose,this.Symbol,this.BeforeOpenData,this.AfterCloseData,this.BeforeVolColor=qi.Minute.Before.VolColor,this.ShareAfterVol=0,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.PtInChart=function(t,e){var a={MinuteVolBar:!0,VolUnit:this.GetVolUnit()};return this.PtInBar(t,e,a)},this.DrawSelectedStatus=function(){return this.DrawLinePoint({MinuteVolBar:!0})},this.GetVolUnit=function(){var t=this.Symbol?this.Symbol.toUpperCase():null,e=Pr.GetVolUnit(t);return e},this.Draw=function(){var t=!0===this.ChartFrame.IsHScreen;if(t)var e=this.ChartBorder.GetHScreenBorder(),a=e.BottomEx;else e=this.ChartBorder.GetBorder(),a=e.RightEx;this.DrawBeforeOpen(),this.DrawMultiDayBeforeOpen();var i=this.ChartFrame.XPointCount,r=this.ChartFrame.GetYFromData(0),n=this.YClose,o=this.Data,s=Pr.IsShowMinuteColorVolBar(this.Symbol);s&&(this.Canvas.strokeStyle=this.CustomColor);for(var h=this.GetVolUnit(),l=o.DataOffset,u=0;l<o.Data.length&&u<i;++l,++u){var C,D=o.Data[l];if(D){var f;if(C=D.Vol/h,f=D.Close,C){var c=this.ChartFrame.GetYFromData(C),m=this.ChartFrame.GetXFromIndex(u);if(m>a)break;s||(this.Canvas.strokeStyle=this.GetMinuteBarColor(f,n)),this.Canvas.beginPath(),t?(this.Canvas.moveTo(c,A(m)),this.Canvas.lineTo(r,A(m))):(this.Canvas.moveTo(A(m),c),this.Canvas.lineTo(A(m),r)),this.Canvas.stroke(),f&&(n=f)}}}this.DrawAfterClose(),this.DrawMultiDayAfterClose()},this.GetMinuteBarColor=function(t,e){return 1==this.BarColorType?t>e?this.UpColor:t<e?this.DownColor:this.UnchangeColor:t>=e?this.UpColor:this.DownColor},this.DrawBeforeOpen=function(){this.ChartBorder.LeftExtendWidth<10||this.BeforeOpenData&&this.DrawCallAuction(-1,this.BeforeOpenData,!0)},this.DrawAfterClose=function(){this.ChartBorder.RightExtendWidth<10||this.AfterCloseData&&this.DrawCallAuction(-1,this.AfterCloseData,!1)},this.DrawMultiDayBeforeOpen=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Left<=0)&&this.MultiDayBeforeOpenData){var t=0,e=this.MultiDayBeforeOpenData.length;this.DayOffset&&(sa.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayBeforeOpenData.length&&i<e;++a,++i){var r=this.MultiDayBeforeOpenData[a];this.DrawCallAuction(i,r,!0)}}},this.DrawMultiDayAfterClose=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Right<=0)&&this.MultiDayAfterCloseData){var t=0,e=this.MultiDayAfterCloseData.length;this.DayOffset&&(sa.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayAfterCloseData.length&&i<e;++a,++i){var r=this.MultiDayAfterCloseData[a];this.DrawCallAuction(i,r,!1)}}},this.DrawCallAuction=function(t,e,a){if(e){e.Index=t;var i=this.GetBorder(),r=!0===this.ChartFrame.IsHScreen,n=this.YClose,o=this.ChartFrame.GetYFromData(0);o=i.BottomEx;r&&(o=i.LeftEx);var s=this.GetVolUnit();if(1==e.Ver)for(var h in e.Data){var l=e.Data[h];if(l&&sa.IsNumber(l.Vol[0])){if(a)var u=this.ChartFrame.GetLeftExtendXFromIndex(h,e),C=this.ChartFrame.GetLeftExtendYFromData(l.Vol[0]/s);else u=this.ChartFrame.GetRightExtendXFromIndex(h,e),C=this.ChartFrame.GetRightExtendYFromData(l.Vol[0]/s);this.Canvas.strokeStyle=l.Price>=n?this.UpColor:this.DownColor,this.Canvas.beginPath(),r?(this.Canvas.moveTo(C,A(u)),this.Canvas.lineTo(o,A(u))):(this.Canvas.moveTo(A(u),C),this.Canvas.lineTo(A(u),o)),this.Canvas.stroke(),l.Price&&(n=l.Price)}}else if(2==e.Ver||3==e.Ver){var D={Max:e.VolMax,Min:e.VolMin};for(var h in e.Data){l=e.Data[h];if(l){if(sa.IsPlusNumber(l.Vol[0])){if(a)u=this.ChartFrame.GetLeftExtendXFromIndex(h,e),C=this.ChartFrame.GetLeftExtendYFromData(l.Vol[0]/s,!1,{Range:D});else{u=this.ChartFrame.GetRightExtendXFromIndex(h,e);if(1==this.ShareAfterVol)C=this.ChartFrame.GetYFromData(l.Vol[0]/s);else C=this.ChartFrame.GetRightExtendYFromData(l.Vol[0]/s,!1,{Range:D})}this.Canvas.strokeStyle=this.GetBarColor(l.ColorID),this.Canvas.beginPath(),r?(this.Canvas.moveTo(C,A(u)),this.Canvas.lineTo(o,A(u))):(this.Canvas.moveTo(A(u),C),this.Canvas.lineTo(A(u),o)),this.Canvas.stroke()}if(sa.IsPlusNumber(l.Vol[1])){if(a)u=this.ChartFrame.GetLeftExtendXFromIndex(h,e),C=this.ChartFrame.GetLeftExtendYFromData(l.Vol[1]/s,!1,{Range:D});else{u=this.ChartFrame.GetRightExtendXFromIndex(h,e);if(1==this.ShareAfterVol)C=this.ChartFrame.GetYFromData(l.Vol[1]/s);else C=this.ChartFrame.GetRightExtendYFromData(l.Vol[1]/s,!1,{Range:D})}this.Canvas.strokeStyle=this.GetBarColor(l.ColorID),this.Canvas.beginPath(),r?(C-=o,C=i.RightEx-C,this.Canvas.moveTo(C,A(u)),this.Canvas.lineTo(i.RightEx,A(u))):(C-=o,C=i.TopEx-C,this.Canvas.moveTo(A(u),C),this.Canvas.lineTo(A(u),i.TopEx)),this.Canvas.stroke()}}}}}},this.GetBarColor=function(t){switch(t){case 0:return this.UnchangeColor;case 1:return this.UpColor;case 2:return this.DownColor}if(this.BeforeVolColor&&Array.isArray(this.BeforeVolColor)){var e=t-3;if(e>=0&&e<this.BeforeVolColor.length)return this.BeforeVolColor[e]}return this.UnchangeColor},this.GetMaxMin=function(){var t=this.GetVolUnit(),e=this.ChartFrame.XPointCount,a=this.Data.DataOffset;this.ChartFrame.GlobalOption&&!0===this.ChartFrame.GlobalOption.IsValueFullRange&&(e=this.Data.Data.length,a=0);for(var i={Min:0,Max:null},r=a,n=0;r<this.Data.Data.length&&n<e;++r,++n){var o=this.Data.Data[r];if(o&&o.Vol){var s=o.Vol/t;(null==i.Max||i.Max<s)&&(i.Max=s)}}return 1==this.ShareAfterVol&&(this.GetAfterCloseMaxMin(i),this.GetMultiDayAfterCloseMaxMin(i)),i},this.GetAfterCloseMaxMin=function(t){if(!(this.ChartBorder.RightExtendWidth<10)&&this.AfterCloseData){var e=this.AfterCloseData;(null==t.Max||t.Max<e.VolMax)&&(t.Max=e.VolMax)}},this.GetMultiDayAfterCloseMaxMin=function(t){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Right<=0)&&this.MultiDayAfterCloseData)for(var e=0;e<this.MultiDayAfterCloseData.length;++e){var a=this.MultiDayAfterCloseData[e];2!=a.Ver&&3!=a.Ver||(null==t.Max||t.Max<a.VolMax)&&(t.Max=a.VolMax)}}}function Gt(){this.newMethod=Pt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteBarCallAuction",this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&(this.IsShowIndexTitleOnly()||(this.DrawBeforeOpen(),this.DrawMultiDayBeforeOpen(),this.DrawAfterClose(),this.DrawMultiDayAfterClose()))}}function _t(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartErrorMessage",this.Draw=function(){this.IsShow&&this.NotSupportMessage&&this.DrawNotSupportmessage()}}function Vt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.LineDash=qi.DOTLINE.LineDash,this.BreakPoint,this.AryBreakPoint,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=this.PtInLine,this.ExportData=this.ExportArrayData,this.GetItemData=this.GetArrayItemData,this.BuildBreakPoint=function(){if(!sa.IsNonEmptyArray(this.AryBreakPoint))return null;for(var t=new Map,e=0;e<this.AryBreakPoint.length;++e){var a=this.AryBreakPoint[e],i=this.BuildDateTimeKey(a);i&&t.set(i,a)}return t},this.BuildDateTimeKey=function(t){return t?sa.IsNumber(t.Time)?"".concat(t.Date,"-").concat(t.Time):"".concat(t.Date):null},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)switch(this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine();case 2:return this.DrawSectionLine()}},this.DrawLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.IsDotLine&&this.Canvas.setLineDash(this.LineDash);for(var i=!0,r=0,n=this.Data.DataOffset,o=0;n<this.Data.Data.length&&o<a;++n,++o){var s=this.Data.Data[n];if(null!=s){var h=this.ChartFrame.GetXFromIndex(o),l=this.GetYFromData(s);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.DrawStraightLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount,n=this.BuildBreakPoint();if(t)var o=this.ChartBorder.GetHScreenBorder(),s=o.BottomEx,h=o.TopEx+i/2+qi.FrameLeftMargin;else o=this.ChartBorder.GetBorder(),h=o.LeftEx+i/2+qi.FrameLeftMargin,s=o.RightEx;var l=this.GetLockRect();l&&(s=t?l.Top:l.Left),this.Canvas.save(),this.ClipClient(t),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(this.LineDash);var u=!0,C=null,D=0,f=null;this.HQChart&&(f=this.HQChart.GetKData());for(var c=this.Data.DataOffset,m=0;c<this.Data.Data.length&&m<r;++c,++m,h+=a+i){var d=this.Data.Data[c];if(null!=d){if(e)var I=this.ChartFrame.GetXFromIndex(m);else{var S=h,T=h+a;if(T>s)break;I=S+(T-S)/2}var v=this.GetYFromData(d,!1);if(I>s)break;if(u?(this.Canvas.beginPath(),t?this.Canvas.moveTo(v,I):this.Canvas.moveTo(I,v),u=!1,C={X:I,Y:v}):t?this.Canvas.lineTo(v,I):this.Canvas.lineTo(I,v),++D,n&&f&&f.Data){var p=f.Data[c],g=this.BuildDateTimeKey(p);g&&n.has(g)&&(D>0&&this.Canvas.stroke(),u=!0,D=0)}}else D>0&&this.Canvas.stroke(),u=!0,D=0,C=null}D>0&&(1==D&&C&&(t?this.Canvas.lineTo(C.Y,C.X+1*F()):this.Canvas.lineTo(C.X+1*F(),C.Y)),this.Canvas.stroke()),this.Canvas.restore()},this.DrawSectionLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount;if(t)var n=this.ChartBorder.GetHScreenBorder(),o=n.BottomEx,s=n.TopEx+i/2+qi.FrameLeftMargin;else n=this.ChartBorder.GetBorder(),s=n.LeftEx+i/2+qi.FrameLeftMargin,o=n.RightEx;var h=this.GetLockRect();h&&(o=t?h.Top:h.Left),this.Canvas.save(),this.ClipClient(t),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(this.LineDash);for(var l=!0,u=null,C=0,D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<r;++D,++f,s+=a+i){var c=this.Data.Data[D];if(null!=c){if(e)var m=this.ChartFrame.GetXFromIndex(f);else{var d=s,I=s+a;if(I>o)break;m=d+(I-d)/2}var S=this.GetYFromData(c,!1);if(m>o)break;this.BreakPoint&&this.BreakPoint.has(D)&&(C>0&&this.Canvas.stroke(),l=!0,C=0,u=null),l?(this.Canvas.beginPath(),t?this.Canvas.moveTo(S,m):this.Canvas.moveTo(m,S),l=!1,u={X:m,Y:S}):t?this.Canvas.lineTo(S,m):this.Canvas.lineTo(m,S),++C}else C>0&&this.Canvas.stroke(),l=!0,C=0,u=null}C>0&&(1==C&&u&&(t?this.Canvas.lineTo(u.Y,u.X+1*F()):this.Canvas.lineTo(u.X+1*F(),u.Y)),this.Canvas.stroke()),this.Canvas.restore()}}function Ht(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartIndexTitle",this.AryTitle=[],this.MapCache=null,this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.AryTitle))for(var e=0;e<this.AryTitle.length;++e){var a=this.AryTitle[e],i=this.BuildKey(a);t.set(i,{Data:a})}},this.GetItem=function(t){if(!this.MapCache||this.MapCache.size<=0)return null;var e=this.BuildKey(t);return this.MapCache.has(e)?this.MapCache.get(e):null},this.Draw=function(){},this.GetMaxMin=function(){return{Min:null,Max:null}}}function Yt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartArea",this.Color="rgb(255,193,37)",this.AreaColor,this.LineWidth,this.LineDash,this.AreaDirection=0,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=this.PtInLine,this.ExportData=this.ExportArrayData,this.GetItemData=this.GetArrayItemData,this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawArea()))},this.DrawArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount;if(t)var n=this.ChartBorder.GetHScreenBorder(),o=n.BottomEx,s=n.TopEx+i/2+qi.FrameLeftMargin;else n=this.ChartBorder.GetBorder(),s=n.LeftEx+i/2+qi.FrameLeftMargin,o=n.RightEx;var h=this.GetLockRect();h&&(o=t?h.Top:h.Left),this.Canvas.save(),this.ClipClient(t),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.Canvas.strokeStyle=this.Color,this.AreaColor?this.Canvas.fillStyle=this.AreaColor:this.Canvas.fillStyle=Ha.ColorToRGBA(this.Color,.6),sa.IsNonEmptyArray(this.LineDash)&&this.Canvas.setLineDash(this.LineDas);for(var l=!0,u=null,C=null,D=0,f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<r;++f,++c,s+=a+i){var m=this.Data.Data[f];if(sa.IsNumber(m)){if(e)var d=this.ChartFrame.GetXFromIndex(c);else{var I=s,S=s+a;if(S>o)break;d=I+(S-I)/2}var T=this.GetYFromData(m,!1);if(d>o)break;l?(this.Canvas.beginPath(),t?this.Canvas.moveTo(T,d):this.Canvas.moveTo(d,T),l=!1,u={X:d,Y:T}):(t?this.Canvas.lineTo(T,d):this.Canvas.lineTo(d,T),C={X:d,Y:T}),++D}else D>0&&this.Canvas.stroke(),u&&C&&(t?(1==this.AreaDirection?(this.Canvas.lineTo(n.RightEx,C.X),this.Canvas.lineTo(n.RightEx,u.X)):(this.Canvas.lineTo(n.LeftEx,C.X),this.Canvas.lineTo(n.LeftEx,u.X)),this.Canvas.closePath(),this.Canvas.fill()):(1==this.AreaDirection?(this.Canvas.lineTo(C.X,n.TopEx),this.Canvas.lineTo(u.X,n.TopEx)):(this.Canvas.lineTo(C.X,n.BottomEx),this.Canvas.lineTo(u.X,n.BottomEx)),this.Canvas.closePath(),this.Canvas.fill())),l=!0,D=0,u=null,C=null}D>0&&(1==D&&u&&(t?this.Canvas.lineTo(u.Y,u.X+1*F()):this.Canvas.lineTo(u.X+1*F(),u.Y)),this.Canvas.stroke(),u&&C&&(t?(1==this.AreaDirection?(this.Canvas.lineTo(n.RightEx,C.X),this.Canvas.lineTo(n.RightEx,u.X)):(this.Canvas.lineTo(n.LeftEx,C.X),this.Canvas.lineTo(n.LeftEx,u.X)),this.Canvas.closePath(),this.Canvas.fill()):(1==this.AreaDirection?(this.Canvas.lineTo(C.X,n.TopEx),this.Canvas.lineTo(u.X,n.TopEx)):(this.Canvas.lineTo(C.X,n.BottomEx),this.Canvas.lineTo(u.X,n.BottomEx)),this.Canvas.closePath(),this.Canvas.fill()))),this.Canvas.restore()}}function kt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartScatterPlot",this.Color="rgb(255,193,37)",this.Radius=3,this.TooltipData=[],this.Draw=function(){this.TooltipData=[],this.IsShow&&!this.ChartFrame.IsMinSize&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawScatterPlot()))},this.DrawScatterPlot=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount;if(t)var n=this.ChartBorder.GetHScreenBorder(),o=n.BottomEx,s=n.TopEx+i/2+qi.FrameLeftMargin;else n=this.ChartBorder.GetBorder(),s=n.LeftEx+i/2+qi.FrameLeftMargin,o=n.RightEx;var h=this.GetLockRect();h&&(o=t?h.Top:h.Left),this.Canvas.save(),this.ClipClient(t);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<r;++l,++u,s+=a+i){var C=this.Data.Data[l];if(C){if(e)var D=this.ChartFrame.GetXFromIndex(u);else{var f=s,c=s+a;if(c>o)break;D=f+(c-f)/2}if(D>o)break;if(Array.isArray(C))for(u=0;u<C.length;++u)this.DrawItem(C[u],D);else this.DrawItem(C,D)}}this.Canvas.restore()},this.DrawItem=function(t,e){if(t&&sa.IsNumber(t.Value)){var a=this.GetYFromData(t.Value,!1),i=this.Radius;if(t.Radius&&(i=t.Radius),sa.IsNumber(i)){this.Canvas.beginPath(),this.Canvas.arc(e,a,i,0,2*Math.PI);var r=this.Color;t.Color&&(r=t.Color),r&&(this.Canvas.fillStyle=r,this.Canvas.fill()),t.ColorBorder&&(this.Canvas.strokeStyle=t.ColorBorder,this.Canvas.stroke());var n={X:e,Y:a,Radius:i,Data:t};this.TooltipData.push(n)}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(e=0,t=this.Data.Data.length);var a={Min:null,Max:null};if(!this.Data||!this.Data.Data)return a;for(var i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];if(n)if(Array.isArray(n))for(var o=0;o<n.length;++o){var s=n[o];sa.IsNumber(s.Value)&&(null==a.Max&&(a.Max=s.Value),null==a.Min&&(a.Min=s.Value),a.Max<s.Value&&(a.Max=s.Value),a.Min>s.Value&&(a.Min=s.Value))}else{if(!sa.IsNumber(n.Value))continue;null==a.Max&&(a.Max=n.Value),null==a.Min&&(a.Min=n.Value),a.Max<n.Value&&(a.Max=n.Value),a.Min>n.Value&&(a.Min=n.Value)}}return a},this.GetTooltipData=function(t,e,a){if(!this.IsShow)return!1;if(!sa.IsNonEmptyArray(this.TooltipData))return!1;for(var i=this.TooltipData.length-1;i>=0;--i){var r=this.TooltipData[i];if(this.Canvas.beginPath(),this.Canvas.arc(r.X,r.Y,r.Radius,0,2*Math.PI),this.Canvas.isPointInPath(t,e))return u.Chart.Log("[ChartScatterPlot::GetTooltipData] point",r),a.Data=r,a.ChartPaint=this,a.Type=6,!0}}}function Xt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartScatterPlotV2",this.Color=qi.ChartScatterPlotV2.Color,this.TextColor=qi.ChartScatterPlotV2.TextColor,this.Radius=qi.ChartScatterPlotV2.Radius,this.Font=qi.ChartScatterPlotV2.Font,this.TooltipData=[],this.MapCache=null,this.AryPoint=[],this.GetKValue=dt.GetKValue,this.TextHeight=10,this.AryDrawRect=[],this.ReloadResource=function(t){this.Color=qi.ChartScatterPlotV2.Color,this.TextColor=qi.ChartScatterPlotV2.TextColor,this.Radius=qi.ChartScatterPlotV2.Radius,this.Font=qi.ChartScatterPlotV2.Font},this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.AryPoint))for(var e=0;e<this.AryPoint.length;++e){var a=this.AryPoint[e],i=this.BuildKey(a);if(t.has(i)){var r=t.get(i);r.Data.push(a)}else t.set(i,{Data:[a]})}},this.Draw=function(){this.TooltipData=[],this.AryDrawRect=[],this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||sa.IsNonEmptyArray(this.AryPoint)&&(!this.MapCache||this.MapCache.size<=0||this.Data&&sa.IsNonEmptyArray(this.Data.Data)&&(this.DrawScatterPlot(),this.AryDrawRect=[])))},this.DrawScatterPlot=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount;if(t)var n=this.ChartBorder.GetHScreenBorder(),o=n.BottomEx,s=n.TopEx+i/2+qi.FrameLeftMargin;else n=this.ChartBorder.GetBorder(),s=n.LeftEx+i/2+qi.FrameLeftMargin,o=n.RightEx;var h=this.GetLockRect();h&&(o=t?h.Top:h.Left),this.Canvas.save(),this.ClipClient(t),this.Canvas.font=this.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.TextHeight=this.GetFontHeight();for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<r;++l,++u,s+=a+i){var C=this.Data.Data[l];if(C){var D=this.BuildKey(C);if(this.MapCache.has(D)){var f=this.MapCache.get(D);if(sa.IsNonEmptyArray(f.Data)){if(e)var c=this.ChartFrame.GetXFromIndex(u);else{var m=s,d=s+a;if(d>o)break;c=m+(d-m)/2}if(c>o)break;for(var I=0;I<f.Data.length;++I){var S=f.Data[I];this.DrawItem(C,S,c)}}}}}this.Canvas.restore()},this.DrawItem=function(t,e,a){var i=this.ChartFrame.DataWidth,r=i/2;if(e){var n=e.Value;if(sa.IsString(e.Value)&&(n=this.GetKValue(t,e.Value)),sa.IsNumber(n)){var o=this.GetYFromData(n,!1),s=this.Radius;if(e.Radius&&(s=e.Radius),sa.IsNumber(s)){s>r&&(s=r),this.Canvas.beginPath(),this.Canvas.arc(a,o,s,0,2*Math.PI);var h=this.Color;e.Color&&(h=e.Color),h&&(this.Canvas.fillStyle=h,this.Canvas.fill()),e.ColorBorder&&(this.Canvas.strokeStyle=e.ColorBorder,this.Canvas.stroke()),i>this.TextHeight&&this.DrawText(e.Text,a,o,s);var l={X:a,Y:o,Radius:s,Data:e};this.TooltipData.push(l)}}}},this.DrawText=function(t,e,a,i){if(t&&t.Text){var r=!0===this.ChartFrame.IsHScreen;if(!r){var n=t.Text,o=this.Canvas.measureText(n).width,s=1,h=2,l=2,u=e;sa.IsNumber(t.YOffset)&&(l=t.YOffset),sa.IsNumber(t.BaseLine)&&(s=t.BaseLine);var C=a-i-l;2==s&&(C=a+i+this.TextHeight+l),sa.IsNumber(t.Align)&&(h=t.Align),1==h?u=e-o:2==h&&(u=e-o/2);var D=null;if(t.BG&&t.BG.Color){var f=t.BG,c=2,m=2,d=1,I=0,S=0;sa.IsNumber(f.MarginLeft)&&(c=f.MarginLeft),sa.IsNumber(f.MarginRight)&&(m=f.MarginRight),sa.IsNumber(f.MarginBottom)&&(I=f.MarginBottom),sa.IsNumber(f.MarginTop)&&(S=f.MarginTop),sa.IsNumber(f.YOffset)&&(d=f.YOffset);var T={Left:u-c,Bottom:C+d+I,Width:o+c+m,Height:this.TextHeight+I+S};if(T.Right=T.Left+T.Width,T.Top=T.Bottom-T.Height,this.IsTextOverlap(T))return;this.Canvas.fillStyle=f.Color,this.Canvas.fillRect(T.Left,T.Top,T.Width,T.Height),D=T}else if(D={Left:u,Bottom:C,Width:o,Height:this.TextHeight},D.Right=D.Left+D.Width,D.Top=D.Bottom-D.Height,this.IsTextOverlap(D))return;t.Color?this.Canvas.fillStyle=t.Color:this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(n,u,C),this.AryDrawRect.push(D)}}},this.IsTextOverlap=function(t){for(var e=0;e<this.AryDrawRect.length;++e){var a=this.AryDrawRect[e];if(M(t,a))return!0}return!1},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!sa.IsNonEmptyArray(this.AryPoint))return t;if(!this.MapCache||this.MapCache.size<=0)return t;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(a=0,e=this.Data.Data.length);for(var i=a,r=0;i<this.Data.Data.length&&r<e;++i,++r){var n=this.Data.Data[i];if(n){var o=this.BuildKey(n);if(this.MapCache.has(o)){var s=this.MapCache.get(o);if(sa.IsNonEmptyArray(s.Data))for(k=0;k<s.Data.length;++k){var h=s.Data[k],l=h.Value;sa.IsString(h.Value)&&(l=this.GetKValue(n,h.Value)),sa.IsNumber(l)&&((null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>l)&&(t.Min=l))}}}}return t},this.GetTooltipData=function(t,e,a){if(!this.IsShow)return!1;if(!sa.IsNonEmptyArray(this.TooltipData))return!1;for(var i=this.TooltipData.length-1;i>=0;--i){var r=this.TooltipData[i];if(this.Canvas.beginPath(),this.Canvas.arc(r.X,r.Y,r.Radius,0,2*Math.PI),this.Canvas.isPointInPath(t,e))return u.Chart.Log("[ChartScatterPlotV2::GetTooltipData] point",r),a.Data=r,a.ChartPaint=this,a.Type=6,!0}}}function Wt(){this.newMethod=Vt,this.newMethod(),delete this.newMethod,this.ClassName="ChartSubLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.SubFrame={Max:null,Min:null},this.Draw=function(){if(this.IsShow&&this.Data&&this.Data.Data)switch(this.CalculateDataMaxMin(),this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.GetYFromData=function(t){var e=!0===this.ChartFrame.IsHScreen;if(e){if(t<=this.SubFrame.Min)return this.ChartBorder.GetLeftEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetRightEx();var a=this.ChartBorder.GetWidthEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetLeftEx()+a}if(t<=this.SubFrame.Min)return this.ChartBorder.GetBottomEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetTopEx();var i=this.ChartBorder.GetHeightEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetBottomEx()-i},this.CalculateDataMaxMin=function(){this.SubFrame={Max:null,Min:null};var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());for(var a=this.ChartFrame.XPointCount,i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var o=this.ChartFrame.GetXFromIndex(r);if(o>e)break;(null==this.SubFrame.Min||this.SubFrame.Min>n)&&(this.SubFrame.Min=n),(null==this.SubFrame.Max||this.SubFrame.Max<n)&&(this.SubFrame.Max=n)}}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function Ut(){this.newMethod=Vt,this.newMethod(),delete this.newMethod,this.MainData=new dt,this.Draw=function(){if(this.Data&&this.Data.Data&&this.MainData&&this.MainData.Data)switch(this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.GetFirstVaildIndex=function(){for(var t=this.Data.DataOffset,e=t,a=0;e<this.MainData.Data.length&&e<this.Data.Data.length;++e,++a){var i=this.MainData.Data[e],r=this.Data.Data[e];if(sa.IsNumber(i)&&sa.IsNumber(r))return{Index:a,DataOffset:e,OverlayValue:r,MainValue:i}}return null},this.DrawStraightLine=function(){var t=this.GetFirstVaildIndex();if(t){var e=!0===this.ChartFrame.IsHScreen,a=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());e&&(a=this.ChartBorder.GetBottom());var i=this.ChartFrame.XPointCount,r=this.GetLockRect();r&&(a=e?r.Top:r.Left),this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash([3,5]);for(var n=!0,o=0,s=0,h=t.DataOffset,l=t.Index;h<this.Data.Data.length&&l<i;++h,++l){var u=this.Data.Data[h];if(null!=u){var C=this.ChartFrame.GetXFromIndex(l),D=u-t.OverlayValue;s=0!=t.OverlayValue?1+D/Math.abs(t.OverlayValue):1+D;var f=t.MainValue*s,c=this.GetYFromData(f);if(C>a)break;n?(this.Canvas.beginPath(),e?this.Canvas.moveTo(c,C):this.Canvas.moveTo(C,c),n=!1):e?this.Canvas.lineTo(c,C):this.Canvas.lineTo(C,c),++o}else o>0&&this.Canvas.stroke(),n=!0,o=0}o>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.GetFirstVaildIndex();if(!a)return e;for(var i=a.DataOffset,r=a.Index;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];if(sa.IsNumber(n)){var o=n-a.OverlayValue;0!=a.OverlayValue?rate=1+o/Math.abs(a.OverlayValue):rate=1+o;var s=a.MainValue*rate;null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s)}}return e}}function Kt(){this.newMethod=Vt,this.newMethod(),delete this.newMethod,this.ClassName="ChartSingleLine",this.MaxMin=null,this.Draw=function(){if(this.MaxMin=null,this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.Data&&this.Data.Data&&(this.MaxMin=this.GetCurrentMaxMin(),this.MaxMin&&sa.IsNumber(this.MaxMin.Max)&&sa.IsNumber(this.MaxMin.Min)))switch(this.DrawType){default:return this.DrawStraightLine()}},this.GetCurrentMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Max:null,Min:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];sa.IsNumber(r)&&(null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r))}return e},this.GetMaxMin=function(){return{Max:null,Min:null}},this.GetYFromData=function(t){var e=!0===this.ChartFrame.IsHScreen;if(e){if(t<=this.MaxMin.Min)return this.ChartBorder.GetLeftEx();if(t>=this.MaxMin.Max)return this.ChartBorder.GetRightEx();var a=this.ChartBorder.GetWidthEx()*(t-this.MaxMin.Min)/(this.MaxMin.Max-this.MaxMin.Min);return this.ChartBorder.GetLeftEx()+a}if(t<=this.MaxMin.Min)return this.ChartBorder.GetBottomEx();if(t>=this.MaxMin.Max)return this.ChartBorder.GetTopEx();var i=this.ChartBorder.GetHeightEx()*(t-this.MaxMin.Min)/(this.MaxMin.Max-this.MaxMin.Min);return this.ChartBorder.GetBottomEx()-i}}function zt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartPartLine",this.LineWidth,this.IsDotLine=!1,this.LineDash=[3,5],this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawLine()))},this.DrawLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth;if(t)var i=this.ChartBorder.GetHScreenBorder(),r=i.BottomEx,n=i.TopEx+a/2+qi.FrameLeftMargin;else i=this.ChartBorder.GetBorder(),n=i.LeftEx+a/2+qi.FrameLeftMargin,r=i.RightEx;var o=this.ChartFrame.XPointCount,s=this.IsMinuteFrame();this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.IsDotLine&&this.Canvas.setLineDash(this.LineDash);for(var h,l=0,u={X:null,Y:null},C=!1,D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<o;++D,++f,n+=e+a){var c=this.Data.Data[D];if(null!=c&&null!=c.Value){if(s)var m=this.ChartFrame.GetXFromIndex(f);else{var d=n,I=n+e;if(I>r)break;m=d+(I-d)/2}var S=c.Value,T=c.RGB,v=this.ChartFrame.GetYFromData(S);if(m>r)break;T!=h||1==C?(h&&l>0&&this.Canvas.stroke(),l=0,h=T,this.Canvas.strokeStyle=T,this.Canvas.beginPath(),null!=u.X&&null!=u.Y?(t?this.Canvas.moveTo(u.Y,u.X):this.Canvas.moveTo(u.X,u.Y),t?this.Canvas.lineTo(v,m):this.Canvas.lineTo(m,v),++l):t?this.Canvas.moveTo(v,m):this.Canvas.moveTo(m,v)):(t?this.Canvas.lineTo(v,m):this.Canvas.lineTo(m,v),++l),u.X=m,u.Y=v,C=!1}else u.X=null,u.Y=null,C=!0}l>0&&this.Canvas.stroke(),this.Canvas.restore()},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];r&&r.Value&&((null==e.Max||e.Max<r.Value)&&(e.Max=r.Value),(null==e.Min||e.Min>r.Value)&&(e.Min=r.Value))}return e},this.ExportData=function(t,e){var a=[],i=[];if(sa.IsNonEmptyArray(this.Data.Data)){var r=0,n=this.Data.length-1;e&&e.Start&&e.End&&sa.IsNumber(e.Start.Index)&&sa.IsNumber(e.End.Index)&&(r=e.Start.Index,n=e.End.Index);for(var o=r;o<=n&&o<this.Data.Data.length;++o){var s=this.Data.Data[o];a[o]=null,i[o]=null,s&&sa.IsNumber(s.Value)&&(a[o]=s.Value,i[o]=s.RGB)}}return[{Name:"".concat(this.Name,"-Value"),Data:a},{Name:"".concat(this.Name,"-Color"),Data:i}]}}function Jt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartStepLine",this.LineWidth=1,this.DotLine,this.IsHScreen,this.IsDotLine=!1,this.PtInChart=function(t,e){if(this.IsShow&&!this.ChartFrame.IsMinSize){var a=!0===this.ChartFrame.IsHScreen;if(!a){var i=this.IsMinuteFrame(),r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,o=this.ChartFrame.XPointCount,s=this.GetLockRect();if(a){var h=this.ChartBorder.GetHScreenBorder(),l=h.BottomEx,u=h.TopEx+n/2+qi.FrameLeftMargin;s&&(l=s.Top)}else{h=this.ChartBorder.GetBorder(),u=h.LeftEx+n/2+qi.FrameLeftMargin,l=h.RightEx;s&&(l=s.Left)}if(t<u||t>l)return null;if(e>h.BottomEx||e<h.TopEx)return null;for(var C={},D={},f=this.Data.DataOffset;f>=0;--f){var c=this.Data.Data[f];if(sa.IsNumber(c)){var m=this.GetYFromData(c,!1),d=null;d=i?this.ChartFrame.GetXFromIndex(0):u,C.Y=m,C.X=d}}f=this.Data.DataOffset;for(var I=0;f<this.Data.Data.length&&I<o;++f,++I,u+=r+n){c=this.Data.Data[f];if(sa.IsNumber(c)){if(i)var S=this.ChartFrame.GetXFromIndex(I);else{var T=u,v=u+r;if(v>l)break;S=T+(v-T)/2}var p=this.GetYFromData(c,!1);if(!(S<t)){if(S==t){C.X=D.X=S,C.Y=D.Y=p;break}D.X=S,D.Y=p;break}if(C.X=S,C.Y=p,t>l)break}}return sa.IsNumber(C.X)&&sa.IsNumber(C.Y)&&sa.IsNumber(D.X)&&sa.IsNumber(D.Y)&&(t==C.X||e==C.Y||t==D.X||e==D.Y||t>=C.X&&t<=D.X&&e>=C.Y-3&&e<=C.Y+3||t>=D.X-3&&t<=D.X+3&&e>=Math.min(C.Y,D.Y)&&e<Math.max(C.Y,D.Y))?{Identify:this.Identify,Chart:this}:null}}},this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.save(),this.ClipClient(this.IsHScreen),this.DrawLine(),this.Canvas.restore()))},this.DrawLine=function(){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=this.GetLockRect();if(this.IsHScreen){var n=this.ChartBorder.GetHScreenBorder(),o=n.BottomEx,s=n.TopEx+a/2+qi.FrameLeftMargin;r&&(o=r.Top)}else{n=this.ChartBorder.GetBorder(),s=n.LeftEx+a/2+qi.FrameLeftMargin,o=n.RightEx;r&&(o=r.Left)}this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F()),this.IsDotLine&&this.Canvas.setLineDash(qi.DOTLINE.LineDash),this.DotLine&&this.Canvas.setLineDash(this.DotLine),this.Canvas.strokeStyle=this.Color;for(var h=!0,l=0,u={X:null,Y:null},C=this.Data.DataOffset;C>=0;--C){var D=this.Data.Data[C];if(sa.IsNumber(D)){var f=this.GetYFromData(D,!1),c=null;c=t?this.ChartFrame.GetXFromIndex(0):s,this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(f,c):this.Canvas.moveTo(c,f),h=!1,u.Y=f,u.X=c}}C=this.Data.DataOffset;for(var m=0;C<this.Data.Data.length&&m<i;++C,++m,s+=e+a){if(t)c=this.ChartFrame.GetXFromIndex(m);else{var d=s,I=s+e;if(I>o)break;c=d+(I-d)/2}if(c>o)break;D=this.Data.Data[C];if(sa.IsNumber(D)){f=this.GetYFromData(D,!1);h?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(f,c):this.Canvas.moveTo(c,f),h=!1,u.X=c,u.Y=f):(this.IsHScreen?(this.Canvas.lineTo(u.Y,c),this.Canvas.lineTo(f,c)):(this.Canvas.lineTo(c,u.Y),this.Canvas.lineTo(c,f)),u.X=c,u.Y=f),++l}}l>0&&this.Canvas.stroke()},this.DrawSelectedStatus=function(){this.DrawLinePoint()}}function Zt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartSlopeLine",this.Color="rgb(255,193,37)",this.IsDotLine=!1,this.LineWidth,this.Option,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(qi.DOTLINE.LineDash);var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;this.Canvas.beginPath(),this.Canvas.rect(t,e,a-t,i-e),this.Canvas.clip();for(var o=this.Data.DataOffset,s=0;o<this.Data.Data.length&&s<n;++o,++s){var h=this.Data.Data[o];if(sa.IsNumber(h)){var l=this.Option[o];if(l){var u=this.ChartFrame.GetXFromIndex(s),C=this.ChartFrame.GetYFromData(h),D=l.Length*qi.DRAWSL.PixelWidth;if(u>r)break;var f=Math.sqrt(D*D/(1+l.Slope*l.Slope)),c=f*l.Slope;this.Canvas.beginPath(),2==l.Direct?(this.Canvas.moveTo(u-f,C+c),this.Canvas.lineTo(u+f,C-c)):1==l.Direct?(this.Canvas.moveTo(u,C),this.Canvas.lineTo(u-f,C+c)):(this.Canvas.moveTo(u,C),this.Canvas.lineTo(u+f,C-c)),this.Canvas.stroke()}}}this.Canvas.restore()}}}function Qt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartPointDot",this.Color="rgb(255,193,37)",this.Radius=1,this.EnableUpDownColor=!1,this.HistoryData,this.ExportData=this.ExportArrayData,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a,i=this.ChartFrame.XPointCount;this.Canvas.save(),this.ClipClient(t),this.Canvas.fillStyle=this.Color;for(var r=this.Data.DataOffset,n=0;r<this.Data.Data.length&&n<i;++r,++n){var o=this.Data.Data[r];if(null!=o){var s=this.ChartFrame.GetXFromIndex(n),h=this.ChartFrame.GetYFromData(o,!1);if(s>e)break;if(this.EnableUpDownColor){var l=this.HistoryData.Data[r];a=l.Close>o?"rgb(255,61,61)":"rgb(0,199,65)",this.Canvas.fillStyle=a}this.Canvas.beginPath(),t?this.Canvas.arc(h,s,this.Radius,0,2*Math.PI,!0):this.Canvas.arc(s,h,this.Radius,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}this.Canvas.restore()}}}function qt(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.LineWidth,this.ClassName="ChartStick",this.ExportData=this.ExportArrayData,this.DrawLine=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F());for(var i=!0,r=0,n=this.Data.DataOffset,o=0;n<this.Data.Data.length&&o<a;++n,++o){var s=this.Data.Data[n];if(null!=s){var h=this.ChartFrame.GetXFromIndex(o),l=this.ChartFrame.GetYFromData(s);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.DrawStick=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetLeft();this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineWidth&&(this.Canvas.lineWidth=this.LineWidth*F());for(var n=this.Canvas.lineWidth,o=this.Data.DataOffset,s=0;o<this.Data.Data.length&&s<a;++o,++s){var h=this.Data.Data[o];if(null!=h){var l=this.ChartFrame.GetXFromIndex(s),u=this.ChartFrame.GetYFromData(h);if(l>e)break;if(this.Canvas.beginPath(),t)this.Canvas.moveTo(r,l),this.Canvas.lineTo(u,l),this.Canvas.stroke();else{var C=O(n,l);this.Canvas.moveTo(C,u),this.Canvas.lineTo(C,i)}this.Canvas.stroke()}}this.Canvas.restore()}},this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.IsHideScriptIndex()||(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawStick()))}}function jt(){this.newMethod=qt,this.newMethod(),delete this.newMethod,this.ClassName="ChartLineStick",this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||(this.NotSupportMessage?this.DrawNotSupportmessage():(this.DrawStick(),this.DrawLine())))}}function $t(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.HistoryData,this.KLineDrawType=0,this.ClassName="ChartVolStick",this.BarWidth,this.BarType,this.BarColorType=0,this.PtInChart=this.PtInBar,this.DrawSelectedStatus=this.DrawLinePoint,this.ExportData=this.ExportArrayData,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(!0!==this.ChartFrame.IsHScreen){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetBorder(),i=a.LeftEx+e/2+qi.FrameLeftMargin,r=a.RightEx,n=this.ChartFrame.XPointCount,o=this.GetLockRect();o&&(r=o.Left);var s=this.IsMinuteFrame(),h=this.ChartFrame.GetYFromData(0);if(this.Canvas.save(),t>=4&&1!==this.BarWidth){h=b(h);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=t+e){var C=this.Data.Data[l],D=this.HistoryData.Data[l];if(null!=C&&null!=D&&(sa.IsNumber(C)&&0!=C)){var f=i,c=i+t;if(c>r)break;var m=this.ChartFrame.GetYFromData(C),d=this.GetBarColor(D,C),I=d.IsUp,S=b(Math.abs(h-m)>=1?h-m:1);m=h-S;var T=this.IsSolidBar(I);T?(this.Canvas.fillStyle=d.Color,this.Canvas.fillRect(b(f),m,b(t),S)):(this.Canvas.strokeStyle=d.Color,this.Canvas.beginPath(),this.Canvas.rect(A(f),A(m),b(t),S),this.Canvas.stroke())}}}else{var v=null;d=null;this.Canvas.linewidth=1*F();for(l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=t+e){C=this.Data.Data[l],D=this.HistoryData.Data[l];if(null!=C&&null!=D){m=this.ChartFrame.GetYFromData(C);if(s)var p=this.ChartFrame.GetXFromIndex(u);else f=i,c=i+t,p=f+(c-f)/2;if(p>r)break;d=s?this.GetMinuteBarColor(D,v):this.GetBarColor(D,C),this.Canvas.strokeStyle=d.Color,this.Canvas.beginPath(),this.Canvas.moveTo(A(p),m),this.Canvas.lineTo(A(p),h),this.Canvas.stroke(),v=D}}}this.Canvas.restore()}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetHScreenBorder(),i=a.TopEx+e/2+qi.FrameLeftMargin,r=a.BottomEx,n=this.ChartFrame.XPointCount,o=this.GetLockRect();o&&(r=o.Top);var s=this.IsMinuteFrame(),h=this.ChartFrame.GetYFromData(0);if(t>=4){h=b(h);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=t+e){var C=this.Data.Data[l],D=this.HistoryData.Data[l];if(null!=C&&null!=D){var f=i,c=i+t;if(c>r)break;var m=this.ChartFrame.GetYFromData(C),d=this.GetBarColor(D,C),I=d.IsUp,S=b(m-h),T=this.IsSolidBar(I);T?(this.Canvas.fillStyle=d.Color,this.Canvas.fillRect(h,b(f),S,b(t))):(this.Canvas.strokeStyle=d.Color,this.Canvas.beginPath(),this.Canvas.rect(A(h),A(f),S,b(t)),this.Canvas.stroke())}}}else{var v=null;for(d=null,l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=t+e){C=this.Data.Data[l],D=this.HistoryData.Data[l];if(null!=C&&null!=D){m=this.ChartFrame.GetYFromData(C);if(s)var p=this.ChartFrame.GetXFromIndex(u);else f=i,c=i+t,p=f+(c-f)/2;if(p>r)break;d=s?this.GetMinuteBarColor(D,v):this.GetBarColor(D,C);I=d.IsUp;this.Canvas.strokeStyle=d.Color,this.Canvas.beginPath(),this.Canvas.moveTo(m,A(p)),this.Canvas.lineTo(h,A(p)),this.Canvas.stroke(),v=D}}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(e=0,t=this.Data.Data.length);for(var a={Min:null,Max:null},i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];sa.IsNumber(n)&&((!sa.IsNumber(a.Max)||a.Max<n)&&(a.Max=n),(!sa.IsNumber(a.Min)||a.Min>n)&&(a.Min=n))}return a.Max>0&&a.Min>0?a.Min=0:a.Max<0&&a.Min<0&&(a.Max=0),a},this.GetBarColor=function(t,e){return 1===this.BarColorType?e>=0?{Color:this.UpColor,IsUp:!0}:{Color:this.DownColor,IsUp:!1}:t.Close>t.Open?{Color:this.UpColor,IsUp:!0}:t.Close<t.Open?{Color:this.DownColor,IsUp:!1}:t.Close>=t.YClose?{Color:this.UpColor,IsUp:!0}:{Color:this.DownColor,IsUp:!1}},this.IsSolidBar=function(t){var e=!0;return 0===this.BarType||1===this.BarType||2===this.BarType?0===this.BarType?e=!1:2===this.BarType&&(e=t):6==this.KLineDrawType?e=!1:!t||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType||(e=!1),e},this.GetMinuteBarColor=function(t,e){var a=t.YClose;return e&&(a=e.Close),t.Close>=a?{Color:this.UpColor,IsUp:!0}:{Color:this.DownColor,IsUp:!1}},this.GetItemData=function(t){if(!t)return null;if(!sa.IsNumber(t.Index))return null;if(!this.HistoryData||!sa.IsNonEmptyArray(this.HistoryData.Data))return null;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return null;var e=t.Index;if(e<0||e>=this.Data.Data.length||e>=this.HistoryData.Data.length)return null;var a=this.Data.Data[e],i=this.HistoryData.Data[e];return[{Value:a,Color:this.GetBarColor(i).Color,Name:this.Name}]}}function te(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartVericaltLine",this.LineWidth=2,this.LineCap,this.Draw=function(){if(!this.ChartFrame.IsMinSize){var t=1==this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.GetBorder(),r=this.ChartFrame.XPointCount;if(t)var n=i.RightEx,o=i.LeftEx,s=i.TopEx+a/2+qi.FrameLeftMargin;else n=i.TopEx,o=i.BottomEx,s=i.LeftEx+a/2+qi.FrameLeftMargin;this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineType&&this.Canvas.setLineDash(this.LineType),this.LineCap&&(this.Canvas.lineCap=this.LineCap),this.Canvas.beginPath();var h=this.Canvas.lineWidth;this.LineWidth>0&&(h=this.LineWidth*F(),this.Canvas.lineWidth=h);for(var l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<r;++u,++C,s+=e+a){var D=this.Data.Data[u];if(D){var f=s+e/2;f=O(h,f),t?(this.Canvas.moveTo(n,f),this.Canvas.lineTo(o,f)):(this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,o)),++l}}l>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function ee(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartHorizontalLine",this.LineWidth=2,this.LineCap,this.ExtendType=0,this.Draw=function(){if(!this.ChartFrame.IsMinSize){var t=1==this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.GetBorder(),r=this.ChartFrame.XPointCount;if(t)var n=i.TopEx,o=i.BottomEx,s=i.TopEx+a/2+qi.FrameLeftMargin;else n=i.LeftEx,o=i.RightEx,s=i.LeftEx+a/2+qi.FrameLeftMargin;this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineType&&this.Canvas.setLineDash(this.LineType),this.LineCap&&(this.Canvas.lineCap=this.LineCap),this.Canvas.beginPath();var h=this.Canvas.lineWidth;this.LineWidth>0&&(h=this.LineWidth*F(),this.Canvas.lineWidth=h);for(var l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<r;++u,++C,s+=e+a){var D=this.Data.Data[u];if(D&&sa.IsNumber(D)){var f=this.ChartFrame.GetYFromData(D);f=O(h,f);var c=s+e/2;c=O(h,c),3==this.ExtendType?t?(this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,o)):(this.Canvas.moveTo(n,f),this.Canvas.lineTo(o,f)):1==this.ExtendType?t?(this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,c)):(this.Canvas.moveTo(n,f),this.Canvas.lineTo(c,f)):t?(this.Canvas.moveTo(f,c),this.Canvas.lineTo(f,o)):(this.Canvas.moveTo(c,f),this.Canvas.lineTo(o,f)),++l}}l>0&&this.Canvas.stroke(),this.Canvas.restore()}}}function ae(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartLineMultiData",this.Color="rgb(255,193,37)",this.PointColor,this.PointRadius,this.LineWidth,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),sa.IsPlusNumber(this.LineWidth)&&(this.Canvas.lineWidth=this.LineWidth*F());for(var i,r=!0,n=0,o=[],s=this.Data.DataOffset,h=0;s<this.Data.Data.length&&h<a;++s,++h){var l=this.Data.Data[s];if(l){var u=this.ChartFrame.GetXFromIndex(h);if(u>e)break;i=Array.isArray(l)?l:[l];for(var C=0;C<i.length;++C){var D=i[C];if(D){var f=D.Value,c=this.ChartFrame.GetYFromData(f);r?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(c,u):this.Canvas.moveTo(u,c),r=!1,1===D.Type&&o.push({X:u,Y:c})):(t?this.Canvas.lineTo(c,u):this.Canvas.lineTo(u,c),1===D.Type&&o.push({X:u,Y:c})),++n}}}}n>0&&this.Canvas.stroke(),this.DrawPoint(o),this.Canvas.restore()}},this.DrawPoint=function(t){if(this.PointColor&&sa.IsPlusNumber(this.PointRadius))for(var e=this.PointRadius*F(),a=0;a<t.length;++a){var i=t[a];this.Canvas.beginPath(),this.Canvas.arc(i.X,i.Y,e,0,360,!1),this.Canvas.fillStyle=this.PointColor,this.Canvas.fill(),this.Canvas.closePath()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r){var n;n=Array.isArray(r)?r:[r];for(i=0;i<n.length;++i){var o=n[i].Value;sa.IsNumber(o)&&(null==e.Max&&(e.Max=o),null==e.Min&&(e.Min=o),e.Max<o&&(e.Max=o),e.Min>o&&(e.Min=o))}}}return e}}function ie(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartStickLine",this.Color="rgb(255,193,37)",this.BarType=0,this.LineDotted=[3,3],this.Width=0,this.IsHScreen=!1,this.BarCache={Type:0},this.SetEmptyBar=function(){if(1!=this.BarType&&-1!=this.BarType)return!1;var t=qi.EmptyBarBGColor;return t&&(this.BarCache.EmptyBGColor=t),-1==this.BarType&&(this.BarCache.LineDotted=this.LineDotted),!0},this.IsEmptyBar=function(){return 1==this.BarType||-1==this.BarType},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=F();this.BarCache={Color:this.Color,EmptyBGColor:null,Width:1*t,Type:0,LineDotted:null},this.IsHScreen=!0===this.ChartFrame.IsHScreen;var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+a/2+qi.FrameLeftMargin;this.IsHScreen&&(i=this.ChartBorder.GetBottom(),n=this.ChartBorder.GetTop()+a/2+qi.FrameLeftMargin);var o=this.IsMinuteFrame();if(o)this.Width>1&&(this.BarCache.Width=2*t),this.BarCache.Type=1;else if(this.Width<=0)this.BarCache.Type=1,this.SetEmptyBar();else if(3==this.Width||50==this.Width)this.BarCache.Type=1,e>=4&&(this.BarCache.Type=2,this.BarCache.Width=e,this.SetEmptyBar());else if(101==this.Width){this.BarCache.Type=1;var s=e+a+1*t;s>=4&&(this.BarCache.Type=2,this.BarCache.Width=s,this.SetEmptyBar())}else if(this.Width<=3){var h=2*t,l=e*(this.Width/3);l<h&&(l=h),this.BarCache.Type=1,l>=4&&(this.BarCache.Type=2,this.BarCache.Width=l,this.SetEmptyBar())}else{l=this.Width*t+e;this.BarCache.Type=2,this.BarCache.Width=l,this.SetEmptyBar()}this.Canvas.save(),this.ClipClient(this.IsHScreen),this.Canvas.strokeStyle=this.BarCache.Color,this.BarCache.EmptyBGColor?this.Canvas.fillStyle=this.BarCache.EmptyBGColor:this.Canvas.fillStyle=this.BarCache.Color,sa.IsNonEmptyArray(this.BarCache.LineDotted)&&this.Canvas.setLineDash(this.BarCache.LineDotted),1==this.BarCache.Type&&(this.Canvas.lineWidth=this.BarCache.Width);for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<r;++u,++C,n+=e+a){var D=this.Data.Data[u];if(D&&sa.IsNumber(D.Value)){var f=D.Value,c=0;if(sa.IsNumber(D.Value2)&&(c=D.Value2),o)var m=this.ChartFrame.GetXFromIndex(C);else{var d=n,I=n+e;m=d+(I-d)/2}var S=this.ChartFrame.GetYFromData(f,!1),T=this.ChartFrame.GetYFromData(c,!1);if(m>i)break;var v=m,p=Math.min(S,T),g=Math.abs(S-T);this.DrawBar(v,p,g)}}this.Canvas.restore()}},this.DrawBar=function(t,e,a){if(a<1&&(a=1),1==this.BarCache.Type)this.IsHScreen?(this.Canvas.beginPath(),this.Canvas.moveTo(e,A(t)),this.Canvas.lineTo(e+a,A(t)),this.Canvas.stroke()):(this.Canvas.beginPath(),this.Canvas.moveTo(A(t),e),this.Canvas.lineTo(A(t),e+a),this.Canvas.stroke());else if(2==this.BarCache.Type)if(this.IsHScreen){var i=t-this.BarCache.Width/2;this.IsEmptyBar()?(this.BarCache.EmptyBGColor&&this.Canvas.fillRect(b(e),b(i),b(a),b(this.BarCache.Width)),this.Canvas.beginPath(),this.Canvas.rect(A(e),A(i),b(a),b(this.BarCache.Width)),this.Canvas.stroke()):this.Canvas.fillRect(b(e),b(i),b(a),b(this.BarCache.Width))}else{i=t-this.BarCache.Width/2;this.IsEmptyBar()?(this.BarCache.EmptyBGColor&&this.Canvas.fillRect(b(i),b(e),b(this.BarCache.Width),b(a)),this.Canvas.beginPath(),this.Canvas.rect(A(i),A(e),b(this.BarCache.Width),b(a)),this.Canvas.stroke()):this.Canvas.fillRect(b(i),b(e),b(this.BarCache.Width),b(a))}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r){var n=r.Value2;if(null==n&&(n=0),null!=r&&!isNaN(r.Value)&&!isNaN(n)){var o=Math.max(r.Value,n),s=Math.min(r.Value,n);null==e.Max&&(e.Max=o),null==e.Min&&(e.Min=s),e.Max<o&&(e.Max=o),e.Min>s&&(e.Min=s)}}}return e}}function re(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartSingleText",this.Color="rgb(255,193,37)",this.TextFont="14px 微软雅黑",this.Text,this.TextAlign="left",this.TextBG,this.Direction=0,this.FixedFontSize=-1,this.YOffset=0,this.Position,this.ShowOffset={X:0,Y:0},this.IconFont,this.IconSize={Max:qi.DRAWICON.Icon.MaxSize,Min:qi.DRAWICON.Icon.MinSize,Zoom:{Type:qi.DRAWICON.Icon.Zoom.Type,Value:qi.DRAWICON.Icon.Zoom.Value},YOffset:qi.DRAWICON.Icon.YOffset},this.TextSize={Max:qi.DRAWICON.Text.MaxSize,Min:qi.DRAWICON.Text.MinSize,Zoom:{Type:qi.DRAWICON.Text.Zoom.Type,Value:qi.DRAWICON.Text.Zoom.Value},FontName:qi.DRAWICON.Text.FontName,YOffset:qi.DRAWICON.Text.YOffset},this.Font={DRAWTEXT_FIX:qi.DRAWTEXT_FIX.Font,DRAWNUMBER_FIX:qi.DRAWNUMBER_FIX.Font},this.ExportData=this.ExportBoolData,this.ReloadResource=function(t){"DRAWTEXT"==this.Name?this.TextSize={Max:qi.DRAWTEXT.MaxSize,Min:qi.DRAWTEXT.MinSize,Zoom:{Type:qi.DRAWTEXT.Zoom.Type,Value:qi.DRAWTEXT.Zoom.Value},FontName:qi.DRAWTEXT.FontName,YOffset:qi.DRAWTEXT.YOffset}:"DRAWNUMBER"==this.Name?this.TextSize={Max:qi.DRAWNUMBER.MaxSize,Min:qi.DRAWNUMBER.MinSize,Zoom:{Type:qi.DRAWNUMBER.Zoom.Type,Value:qi.DRAWNUMBER.Zoom.Value},FontName:qi.DRAWNUMBER.FontName,YOffset:qi.DRAWNUMBER.YOffset}:"DRAWTEXT_FIX"==this.Name?this.Font.DRAWTEXT_FIX=qi.DRAWTEXT_FIX.Font:"DRAWNUMBER_FIX"==this.Name&&(this.Font.DRAWNUMBER_FIX=qi.DRAWNUMBER_FIX.Font)},this.SuperGetMaxMin=this.GetMaxMin,this.GetMaxMin=function(){return"DRAWTEXT_FIX"==this.Name||"DRAWNUMBER_FIX"==this.Name||"DRAWTEXTREL"==this.Name||"DRAWTEXTABS"==this.Name?{Min:null,Max:null}:this.SuperGetMaxMin()},this.DrawRectText=function(){if(this.DrawData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.GetBorder();if("DRAWTEXTREL"==this.Name)if(t)var a=e.RightTitle-e.LeftEx,i=e.BottomEx-e.TopEx,r=this.DrawData.Point.X/1e3*i+e.TopEx,n=e.RightTitle-this.DrawData.Point.Y/1e3*i;else i=e.RightEx-e.LeftEx,a=e.BottomEx-e.TopTitle,r=this.DrawData.Point.X/1e3*i+e.LeftEx,n=this.DrawData.Point.Y/1e3*a+e.TopTitle;else{if("DRAWTEXTABS"!=this.Name)return;if(t)r=this.DrawData.Point.X+e.TopEx,n=e.RightTitle-this.DrawData.Point.Y;else r=this.DrawData.Point.X+e.LeftEx,n=this.DrawData.Point.Y+e.TopTitle}1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",this.Canvas.textAlign=this.TextAlign,this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.Color,this.DrawText(this.DrawData.Text,r,n,t)}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else if("DRAWTEXTREL"!=this.Name&&"DRAWTEXTABS"!=this.Name){if(this.Position)this.DrawPosition();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+qi.FrameLeftMargin,n=this.ChartBorder.GetRight(),o=this.ChartBorder.GetTopEx(),s=this.ChartBorder.GetBottomEx();this.Canvas.save(),this.ClipClient(this.ChartFrame.IsHScreen),t&&(n=this.ChartBorder.GetBottom(),o=this.ChartBorder.GetRightEx(),s=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop()+i/2+qi.FrameLeftMargin);var h=this.ChartFrame.XPointCount,l=Array.isArray(this.Text),u=F(),C={Text:{},Font:{}};if(1==this.Direction?(this.Canvas.textBaseline="bottom",C.Text={Baseline:"bottom"}):2==this.Direction?(this.Canvas.textBaseline="top",C.Text={Baseline:"top"}):(this.Canvas.textBaseline="middle",C.Text={Baseline:"middle"}),this.IconFont){if(this.Color=this.IconFont.Color,this.Text=this.IconFont.Text,this.FixedFontSize>0)var D=this.FixedFontSize;else D=this.GetDynamicIconSize(a,i,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom);this.Canvas.font=D+"px "+this.IconFont.Family}else this.FixedFontSize>0?this.TextFont="".concat(this.FixedFontSize,"px ").concat(this.TextSize.FontName):this.TextFont=this.GetDynamicFont(a,i,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),this.Canvas.font=this.TextFont;C.Font={Height:this.GetFontHeight()};for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<h;++f,++c,r+=a+i){var m=this.Data.Data[f];if(null!=m){if(e)var d=this.ChartFrame.GetXFromIndex(c);else{var I=r,S=r+a;if(S>n)break;d=I+(S-I)/2}var T=this.ChartFrame.GetYFromData(m,!1);if(d>n)break;if(T+=this.ShowOffset.Y,d+=this.ShowOffset.X,this.Canvas.textAlign=this.TextAlign,this.Canvas.fillStyle=this.Color,C.Text.Color=this.Color,C.Text.Align=this.TextAlign,C.X=d,C.Y=T,this.YOffset>0&&this.Direction>0){var v=T;this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?(1==this.Direction?(T=o-this.YOffset*u,v+=5*u):(T=s+this.YOffset*u,v-=5*u),this.Canvas.moveTo(A(v),A(d)),this.Canvas.lineTo(A(T),A(d))):(1==this.Direction?(T=o+this.YOffset*u,v+=5*u):(T=s-this.YOffset*u,v-=5*u),this.Canvas.moveTo(A(d),A(v)),this.Canvas.lineTo(A(d),A(T))),this.Canvas.stroke(),this.Canvas.setLineDash([])}if(l){var p=this.Text[f];if(!p)continue;"DRAWNUMBER"==this.Name&&(1==this.Direction?T-=qi.DRAWABOVE.YOffset*u:2==this.Direction&&(T+=this.TextSize.YOffset*u)),"DRAWTEXT"==this.Name?this.DrawTextV2(p,C,t):this.DrawText(p,d,T,t)}else"DRAWICON"==this.Name?1==this.Direction?T-=qi.DRAWABOVE.YOffset*u:2==this.Direction&&(this.IconFont?T+=this.IconSize.YOffset*u:T+=this.TextSize.YOffset*u):"DRAWTEXT"==this.Name&&(1==this.Direction?T-=qi.DRAWABOVE.YOffset*u:2==this.Direction&&(T+=this.TextSize.YOffset*u)),"DRAWTEXT"==this.Name?this.DrawTextV2(this.Text,C,t):this.DrawText(this.Text,d,T,t)}}this.Canvas.restore()}}else this.DrawRectText()},this.DrawPosition=function(){if(this.Text){var t=!0===this.ChartFrame.IsHScreen;if(t)var e=this.ChartBorder.GetRightEx()-this.ChartBorder.GetWidthEx()*this.Position.Y,a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*this.Position.X;else a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*this.Position.X,e=this.ChartBorder.GetTopEx()+this.ChartBorder.GetHeightEx()*this.Position.Y;if(this.Canvas.fillStyle=this.Color,"DRAWTEXT_FIX"==this.Name?this.Canvas.font=this.Font.DRAWTEXT_FIX:"DRAWNUMBER_FIX"==this.Name&&(this.Canvas.font=this.Font.DRAWNUMBER_FIX),0==this.Position.Type?this.Canvas.textAlign="left":1==this.Position.Type?this.Canvas.textAlign="right":this.Canvas.textAlign="center",1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",Array.isArray(this.Text)){if(!this.Data||!this.Data.Data)return;for(var i=this.ChartFrame.XPointCount,r=this.Data.DataOffset,n=0;r<this.Data.Data.length&&n<i;++r,++n){var o=this.Text[r];if(o){this.DrawText(o,a,e,t);break}}}else this.DrawText(this.Text,a,e,t)}},this.DrawText=function(t,e,a,i){i?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()):this.Canvas.fillText(t,e,a)},this.DrawTextV2=function(t,e,a){var i=this.Canvas.measureText(t).width;if(a){var r=e.Y,n=e.X;if("right"==e.Text.Align?n-=i:"center"==e.Text.Align&&(n-=i/2),"top"==e.Text.Baseline?r-=e.Font.Height:"middle"==e.Text.Baseline&&(r-=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){var o=this.TextBG.Margin,s=r-o[0],h=n-o[2],l=i+o[2]+o[3],u=e.Font.Height+o[0]+o[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(s,h,u,l)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(A(s),A(h),b(u),b(l)))}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()}else{r=e.X,n=e.Y;if("right"==e.Text.Align?r-=i:"center"==e.Text.Align&&(r-=i/2),"top"==e.Text.Baseline?n+=e.Font.Height:"middle"==e.Text.Baseline&&(n+=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){o=this.TextBG.Margin,s=r-o[2],h=n-e.Font.Height-o[1],l=i+o[2]+o[3],u=e.Font.Height+o[0]+o[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(s,h,l,u)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(A(s),A(h),b(l),b(u)))}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.fillText(t,r,n)}}}function ne(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartTradeIcon",this.TextAlign="center",this.TextBaseline="middle",this.SVG={Family:"iconfont",Size:12},this.AryIcon,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.Data&&this.Data.Data&&sa.IsNonEmptyArray(this.AryIcon)){var t=!0===this.ChartFrame.IsHScreen;this.Canvas.font="".concat(this.SVG.Size,"px ").concat(this.SVG.Family),this.Canvas.textAlign=this.TextAlign,this.Canvas.textBaseline="middle";var e=0;"BUY"==this.TradeType||"BUYSHORT"==this.TradeType?(this.Canvas.textBaseline="top",e+=t?-2:2):"SELL"!=this.TradeType&&"SELLSHORT"!=this.TradeType||(this.Canvas.textBaseline="bottom",e=t?2:-2);var a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount,o=this.ChartFrame.GetBorder(),s=o.LeftEx+i/2+qi.FrameLeftMargin;t&&(r=this.ChartBorder.GetBottom(),s=this.ChartBorder.GetTop()+i/2+qi.FrameLeftMargin);for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<n;++h,++l,s+=a+i){var u=this.Data.Data[h];if(sa.IsNumber(u)&&!(u<=0)){var C=this.AryIcon[h];if(sa.IsNumber(C.Value)&&C.Icon){var D=s,f=s+a;if(f>r)break;var c=D+(f-D)/2,m=this.GetYFromData(C.Value,!1);this.Canvas.fillStyle=C.Color,a>2&&(c=A(c)),this.DrawTradeIcon(C.Icon,c,m+e,t)}}}}},this.DrawTradeIcon=function(t,e,a,i){i?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()):this.Canvas.fillText(t,e,a)},this.GetMaxMin=function(){var t={Max:null,Min:null};if(!this.Data||!this.Data.Data)return t;if(!sa.IsNonEmptyArray(this.AryIcon))return t;var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(a=0,e=this.Data.Data.length);for(var i=a,r=0;i<this.Data.Data.length&&r<e;++i,++r){var n=this.Data.Data[i];if(sa.IsNumber(n)&&!(n<=0)){var o=this.AryIcon[i];sa.IsNumber(o.Value)&&o.Icon&&((null==t.Max||t.Max<o.Value)&&(t.Max=o.Value),(null==t.Min||t.Min>o.Value)&&(t.Min=o.Value))}}return t}}function oe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawText",this.Color="rgb(255,193,37)",this.TextFont="14px 微软雅黑",this.TextBaseline="middle",this.TextAlign="left",this.Text,this.TextBG,this.FixedFontSize=-1,this.YOffset=0,this.FixedPosition=-1,this.VerticalLine,this.ShowOffset={X:0,Y:0},this.ExportData=this.ExportBoolData,this.TextSize={Max:qi.DRAWICON.Text.MaxSize,Min:qi.DRAWICON.Text.MinSize,Zoom:{Type:qi.DRAWICON.Text.Zoom.Type,Value:qi.DRAWICON.Text.Zoom.Value},FontName:qi.DRAWICON.Text.FontName,YOffset:qi.DRAWICON.Text.YOffset},this.ReloadResource=function(t){this.TextSize={Max:qi.DRAWTEXT.MaxSize,Min:qi.DRAWTEXT.MinSize,Zoom:{Type:qi.DRAWTEXT.Zoom.Type,Value:qi.DRAWTEXT.Zoom.Value},FontName:qi.DRAWTEXT.FontName,YOffset:qi.DRAWTEXT.YOffset}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+qi.FrameLeftMargin,n=this.ChartBorder.GetRight(),o=this.ChartBorder.GetTopEx(),s=this.ChartBorder.GetBottomEx();this.Canvas.save(),this.ClipClient(t),t&&(n=this.ChartBorder.GetBottom(),o=this.ChartBorder.GetRightEx(),s=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop()+i/2+qi.FrameLeftMargin);var h=this.ChartFrame.XPointCount,l=Array.isArray(this.Text),u={Text:{Color:this.Color,Align:this.TextAlign,Baseline:this.TextBaseline},Font:{}};this.FixedFontSize>0?this.TextFont="".concat(this.FixedFontSize,"px ").concat(this.TextSize.FontName):this.TextFont=this.GetDynamicFont(a,i,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),this.Canvas.font=this.TextFont,u.Font={Height:this.GetFontHeight()};for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<h;++C,++D,r+=a+i){var f=this.Data.Data[C];if(null!=f){if(e)var c=this.ChartFrame.GetXFromIndex(D);else{var m=r,d=r+a;if(d>n)break;c=m+(d-m)/2}var I;if(I=1===this.FixedPosition?o:2===this.FixedPosition?s:this.ChartFrame.GetYFromData(f,!1),c>n)break;if(I+=this.ShowOffset.Y,c+=this.ShowOffset.X,u.X=c,u.Y=I,l){var S=this.Text[C];if(!S)continue;this.DrawText(S,u,t)}else this.DrawText(this.Text,u,t);this.DrawVerticalLine(C,u,t)}}this.Canvas.restore()}},this.DrawText=function(t,e,a){var i=this.Canvas.measureText(t).width;if(a){var r=e.Y,n=e.X;if("right"==e.Text.Align?n-=i:"center"==e.Text.Align&&(n-=i/2),"top"==e.Text.Baseline?r-=e.Font.Height:"middle"==e.Text.Baseline&&(r-=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){var o=this.TextBG.Margin,s=r-o[0],h=n-o[2],l=i+o[2]+o[3],u=e.Font.Height+o[0]+o[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(s,h,u,l)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(A(s),A(h),b(u),b(l))),e.Rect={Bottom:s,Top:s+u}}else{s=r,u=e.Font.Height;e.Rect={Bottom:s,Top:s+u}}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()}else{r=e.X,n=e.Y;if("right"==e.Text.Align?r-=i:"center"==e.Text.Align&&(r-=i/2),"top"==e.Text.Baseline?n+=e.Font.Height:"middle"==e.Text.Baseline&&(n+=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){o=this.TextBG.Margin,s=r-o[2],h=n-e.Font.Height-o[1],l=i+o[2]+o[3],u=e.Font.Height+o[0]+o[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(s,h,l,u)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(A(s),A(h),b(l),b(u))),e.Rect={Top:h,Bottom:h+u}}else{h=n-e.Font.Height,u=e.Font.Height;e.Rect={Top:h,Bottom:h+u}}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.fillText(t,r,n)}},this.DrawVerticalLine=function(t,e,a){if(this.VerticalLine){var i=this.VerticalLine.Data[t];if(i&&sa.IsNumber(i.High)&&sa.IsNumber(i.Low)){var r,n,o=this.ChartFrame.GetYFromData(i.High),s=this.ChartFrame.GetYFromData(i.Low);if(a)if(e.Rect.Bottom>o)r=e.Rect.Bottom-1,n=o+1;else{if(!(e.Rect.Top<s))return;r=e.Rect.Top-1,n=s-1}else if(e.Rect.Bottom<o)r=e.Rect.Bottom+1,n=o-1;else{if(!(e.Rect.Top>s))return;r=e.Rect.Top-1,n=s+1}this.Canvas.save();var h=F(),l=e.X;1==this.VerticalLine.LineType&&(this.VerticalLine.LineDotted?this.Canvas.setLineDash(this.VerticalLine.LineDotted):this.Canvas.setLineDash([5,10])),sa.IsPlusNumber(this.VerticalLine.LineWidth)&&(this.Canvas.lineWidth=this.VerticalLine.LineWidth*h),this.Canvas.strokeStyle=this.VerticalLine.Color,this.Canvas.beginPath(),a?(this.Canvas.moveTo(A(r),A(l)),this.Canvas.lineTo(A(n),A(l))):(this.Canvas.moveTo(A(l),A(r)),this.Canvas.lineTo(A(l),A(n))),this.Canvas.stroke(),this.Canvas.restore()}}}}function se(){this.newMethod=oe,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawNumber",this.ReloadResource=function(t){this.TextSize={Max:qi.DRAWNUMBER.MaxSize,Min:qi.DRAWNUMBER.MinSize,Zoom:{Type:qi.DRAWNUMBER.Zoom.Type,Value:qi.DRAWNUMBER.Zoom.Value},FontName:qi.DRAWNUMBER.FontName,YOffset:qi.DRAWNUMBER.YOffset}}}function he(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawLastBarText",this.LastBarItem=null,this.TextSize={Max:qi.DRAWICON.Text.MaxSize,Min:qi.DRAWICON.Text.MinSize,Zoom:{Type:qi.DRAWICON.Text.Zoom.Type,Value:qi.DRAWICON.Text.Zoom.Value},FontName:qi.DRAWICON.Text.FontName,YOffset:qi.DRAWICON.Text.YOffset},this.IconSize={Max:qi.DRAWICON.Icon.MaxSize,Min:qi.DRAWICON.Icon.MinSize,Zoom:{Type:qi.DRAWICON.Icon.Zoom.Type,Value:qi.DRAWICON.Icon.Zoom.Value},YOffset:qi.DRAWICON.Icon.YOffset},this.ReloadResource=function(t){this.TextSize={Max:qi.DRAWTEXT.MaxSize,Min:qi.DRAWTEXT.MinSize,Zoom:{Type:qi.DRAWTEXT.Zoom.Type,Value:qi.DRAWTEXT.Zoom.Value},FontName:qi.DRAWTEXT.FontName},this.IconSize={Max:qi.DRAWICON.Icon.MaxSize,Min:qi.DRAWICON.Icon.MinSize,Zoom:{Type:qi.DRAWICON.Icon.Zoom.Type,Value:qi.DRAWICON.Icon.Zoom.Value}}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.LastBarItem&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=e+t;if(!(a<this.Data.Data.length)){var i=this.Data.Data.length-1-e,r=this.ChartFrame.GetXFromIndex(i),n=this.LastBarItem;"Top"==n.Value?y=top:"Bottom"==n.Value?y=bottom:y=this.ChartFrame.GetYFromData(n.Value,!1),sa.IsNumber(n.YOffset)&&(y+=n.YOffset),sa.IsNumber(n.XOffset)&&(r+=n.XOffset),this.Canvas.save(),this.ClipClient(this.IsHScreen),n.Text?this.DrawLastText(n,r,y):n.Icon&&this.DrawLastIcon(n,r,y),this.Canvas.restore()}}},this.DrawLastText=function(t,e,a){var i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth,n=this.GetDynamicFont(i,r,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),o="bottom";t.TextBaseline&&(o=t.TextBaseline);var s="center";t.TextAlign&&(s=t.TextAlign),this.Canvas.font=n,this.Canvas.textBaseline=o,this.Canvas.textAlign=s,this.Canvas.fillStyle=t.Color,this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t.Text,0,0),this.Canvas.restore()):this.Canvas.fillText(t.Text,e,a)},this.DrawLastIcon=function(t,e,a){var i=t.Icon,r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,o=this.GetDynamicIconSize(r,n,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom),s="".concat(o,"px ").concat(i.Family),h="bottom";t.TextBaseline&&(h=t.TextBaseline);var l="center";t.TextAlign&&(l=t.TextAlign),this.Canvas.font=s,this.Canvas.textBaseline=h,this.Canvas.textAlign=l,this.Canvas.fillStyle=t.Color,this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(i.Symbol,0,0),this.Canvas.restore()):this.Canvas.fillText(i.Symbol,e,a)},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;return i<this.Data.Data.length?t:this.LastBarItem?(sa.IsNumber(this.LastBarItem.Value)&&(t.Max=t.Min=this.LastBarItem.Value),t):t}}function le(){this.newMethod=Vt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinutePriceLine",this.YClose,this.IsDrawArea=!0,this.AreaColor="rgba(0,191,255,0.1)",this.IsShowLead=!1,this.LeadData,this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.BeforeOpenData,this.BeforeLineColor=qi.Minute.Before.LineColor,this.BeforeAvPriceColor=qi.Minute.Before.AvPriceColor,this.BeforePoint=P(qi.Minute.Before.Point),this.AfterCloseData,this.AfterLineColor=qi.Minute.After.LineColor,this.AfterAvPriceColor=qi.Minute.After.AvPriceColor,this.AfterPoint=P(qi.Minute.After.Point),this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.ColorLineData,this.Source,this.PtInChart=this.PtInLine,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=this.PtInLine,this.DrawSelectedStatus=this.DrawLinePoint,this.DayOffset,this.LastPoint={},this.FFMChart,this.DrawType=0,this.UpdateLastPoint=function(t,e,a,i){sa.IsNumber(this.LastPoint.DateTime)&&this.LastPoint.DateTime>t||(this.LastPoint.DateTime=t,this.LastPoint.X=e,this.LastPoint.Y=a,this.LastPoint.Data=i,this.LastPoint.Value=i.Value)},this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.LastPoint={},this.IsShow)if(14!=this.DrawType){var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetLeft(),n=this.Data;if(this.DrawBeforeOpen(),this.DrawMultiDayBeforeOpen(),this.IsShowLead&&this.DrawLead(),n){var o=!0,s={},h=0,l=0;this.Canvas.save(),this.ClipClient(t),sa.IsPlusNumber(this.LineWidth>0)&&(this.Canvas.lineWidth=this.LineWidth);for(var u=n.DataOffset,C=0;u<n.Data.length&&C<e;++u,++C){var D;if(D=n.Data[u],++l,null!=D){var f=this.ChartFrame.GetXFromIndex(C),c=this.ChartFrame.GetYFromData(D,!1);if(o?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(c,f):this.Canvas.moveTo(f,c),o=!1,s={X:f,Y:c}):t?this.Canvas.lineTo(c,f):this.Canvas.lineTo(f,c),this.Source){var d=this.Source.Data[u],I=1e6*d.Date+100*d.Time;this.UpdateLastPoint(I,f,c,{Value:D,Index:u,Date:d.Date,Time:d.Time,Type:0,Explain:"盘中"})}++h,l>=a&&(o=!0,this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,f),this.Canvas.lineTo(r,s.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(f,i),this.Canvas.lineTo(s.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()),l=0,h=0)}}if(h>0&&(1==h?(this.Canvas.beginPath(),t?this.Canvas.arc(s.Y,s.X,1,0,360,!1):this.Canvas.arc(s.X,s.Y,1,0,360,!1),this.Canvas.closePath(),this.Canvas.fillStyle=this.Color,this.Canvas.fill()):(this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,f),this.Canvas.lineTo(r,s.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(f,i),this.Canvas.lineTo(s.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()))),this.Canvas.restore(),this.DrawColorLine(),this.DrawAfterClose(),this.DrawMultiDayAfterClose(),this.GetEventCallback){var S=this.GetEventCallback(m.ON_DRAW_MINUTE_LAST_POINT);if(S){var T=F();n={InterLastPoint:{X:this.LastPoint.X,Y:this.LastPoint.Y},LastPoint:{X:this.LastPoint.X/T,Y:this.LastPoint.Y/T},Price:this.LastPoint.Price,Data:this.LastPoint.Data,PixelRatio:T};S.Callback(S,n,this)}}}}else this.FFMChart&&this.FFMChart.Draw&&this.FFMChart.Draw(this)},this.DrawLead=function(){if(this.LeadData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=(this.ChartBorder.GetBottomEx(),this.ChartBorder.GetTopEx());if(!0===t&&(i=this.ChartBorder.GetRightEx()),!(e>a)){for(var r=[],n=null,o=null,s=this.ChartFrame.GetYFromData(this.YClose),h=(s-i)/3,l=this.LeadData,u=l.DataOffset,C=0;u<l.Data.length&&C<e;++u,++C){var D=l.Data[u];if(sa.IsNumber(D)&&0!=D){var f=this.ChartFrame.GetXFromIndex(C);(null==n||n<D)&&(n=D),(null==o||o>D)&&(o=D),r.push({X:f,Value:D})}}if(!(r.length<=0)){var c=Math.max(Math.abs(n),Math.abs(o));for(var u in r){var m=r[u];m.Value>0?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;var d=s-m.Value*h/c;f=A(m.X);this.Canvas.beginPath(),!0===t?(this.Canvas.moveTo(s,f),this.Canvas.lineTo(d,f)):(this.Canvas.moveTo(f,s),this.Canvas.lineTo(f,d)),this.Canvas.stroke()}}}}},this.DrawBeforeOpen=function(){this.ChartBorder.LeftExtendWidth<10||this.BeforeOpenData&&this.DrawCallAuction(-1,this.BeforeOpenData,!0)},this.DrawAfterClose=function(){this.ChartBorder.RightExtendWidth<10||this.AfterCloseData&&this.DrawCallAuction(-1,this.AfterCloseData,!1)},this.DrawMultiDayBeforeOpen=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Left<=0)&&this.MultiDayBeforeOpenData){var t=0,e=this.MultiDayBeforeOpenData.length;this.DayOffset&&(sa.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayBeforeOpenData.length&&i<e;++a,++i){var r=this.MultiDayBeforeOpenData[a];this.DrawCallAuction(i,r,!0)}}},this.DrawMultiDayAfterClose=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Right<=0)&&this.MultiDayAfterCloseData){var t=0,e=this.MultiDayAfterCloseData.length;this.DayOffset&&(sa.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayAfterCloseData.length&&i<e;++a,++i){var r=this.MultiDayAfterCloseData[a];this.DrawCallAuction(i,r,!1)}}},this.DrawCallAuction=function(t,e,a){if(e){e.Index=t;var i=!0===this.ChartFrame.IsHScreen,r=!0,n=0;e.TotalCount;if(3==e.Ver){for(var o=0;o<e.Data.length;++o){var s=e.Data[o];if(s&&sa.IsNumber(s.AvPrice)){if(a)var h=this.ChartFrame.GetLeftExtendXFromIndex(o,e),l=this.ChartFrame.GetLeftExtendYFromData(s.AvPrice);else h=this.ChartFrame.GetRightExtendXFromIndex(o,e),l=this.ChartFrame.GetRightExtendYFromData(s.AvPrice);r?(this.Canvas.strokeStyle=this.BeforeAvPriceColor,this.Canvas.beginPath(),i?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),r=!1):i?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++n}}n>0&&this.Canvas.stroke()}r=!0,n=0;var u=[];for(o=0;o<e.Data.length;++o){s=e.Data[o];if(s&&sa.IsNumber(s.Price)){if(a)h=this.ChartFrame.GetLeftExtendXFromIndex(o,e),l=this.ChartFrame.GetLeftExtendYFromData(s.Price);else h=this.ChartFrame.GetRightExtendXFromIndex(o,e),l=this.ChartFrame.GetRightExtendYFromData(s.Price);r?(this.Canvas.strokeStyle=a?this.BeforeLineColor:this.AfterLineColor,this.Canvas.beginPath(),i?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),r=!1,u.push({X:h,Y:l})):(i?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),u.push({X:h,Y:l}));var C=1e6*s.Date+s.Time;this.UpdateLastPoint(C,h,l,{Value:s.Price,Index:o,Date:s.Date,Time:s.Time,Type:a?1:2,Explain:a?"盘前":"盘后"}),++n}else if(0==o&&a&&sa.IsNumber(this.YClose)){var h=this.ChartFrame.GetLeftExtendXFromIndex(o,e),l=this.ChartFrame.GetLeftExtendYFromData(this.YClose);this.Canvas.strokeStyle=this.BeforeLineColor,this.Canvas.beginPath(),i?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),r=!1}}if(n>0&&this.Canvas.stroke(),2==e.Ver&&this.BeforePoint.Radius>0)for(var o in this.Canvas.fillStyle=a?this.BeforePoint.Color:this.AfterPoint.Color,u){s=u[o];this.Canvas.beginPath(),i?this.Canvas.arc(s.Y,s.X,this.BeforePoint.Radius,0,2*Math.PI):this.Canvas.arc(s.X,s.Y,this.BeforePoint.Radius,0,2*Math.PI),this.Canvas.fill()}}},this.FindColorLineItem=function(t){if(!t||!this.ColorLineData)return null;for(var e in this.ColorLineData){var a=this.ColorLineData[e];if(a.Date==t.Date&&t.Time>=a.Start&&t.Time<=a.End)return a}return null},this.DrawColorLine=function(){if(this.ColorLineData&&this.Source&&this.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartBorder.GetBorder(),this.ChartFrame.XPointCount),a=(this.ChartFrame.MinuteCount,this.Data),i=!0,r={},n=0,o=null;this.Canvas.save();for(var s=a.DataOffset,h=0;s<a.Data.length&&h<e;++s,++h){var l;l=a.Data[s];var u=this.Source.Data[s];if(l&&u){var C=this.FindColorLineItem(u);if(C){o&&o!=C.Color&&(this.Canvas.stroke(),i=!0);var D=this.ChartFrame.GetXFromIndex(h),f=this.ChartFrame.GetYFromData(l);i?(this.Canvas.strokeStyle=C.Color,sa.IsNumber(C.LineWidth)&&(this.Canvas.lineWidth=C.LineWidth),this.Canvas.beginPath(),t?this.Canvas.moveTo(f,D):this.Canvas.moveTo(D,f),i=!1,{X:D,Y:f},o=C.Color):t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),r.X=D,r.Y=f,r.Price=l,++n}else n>0&&(this.Canvas.stroke(),i=!0)}}n>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){if(14==this.DrawType&&this.FFMChart&&this.FFMChart.GetMaxMin)return this.FFMChart.GetMaxMin(this);var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;if(!this.IsShow)return e;if(e.Min=this.YClose,e.Max=this.YClose,this.ChartBorder.LeftExtendWidth>10&&this.BeforeOpenData)for(var a in this.BeforeOpenData.Data){var i=this.BeforeOpenData.Data[a];i&&(sa.IsNumber(i.Price)&&(null==e.Max&&(e.Max=i.Price),null==e.Min&&(e.Min=i.Price),e.Max<i.Price&&(e.Max=i.Price),e.Min>i.Price&&(e.Min=i.Price)),3==this.BeforeOpenData.Ver&&sa.IsNumber(i.AvPrice)&&(null==e.Max&&(e.Max=i.AvPrice),null==e.Min&&(e.Min=i.AvPrice),e.Max<i.AvPrice&&(e.Max=i.AvPrice),e.Min>i.AvPrice&&(e.Min=i.AvPrice)))}for(var r=this.Data,n=(a=r.DataOffset,0);a<r.Data.length&&n<t;++a,++n){var o;o=r.Data[a],null!=o&&(null==e.Max&&(e.Max=o),null==e.Min&&(e.Min=o),e.Max<o&&(e.Max=o),e.Min>o&&(e.Min=o))}if(e.Max==this.YClose&&e.Min==this.YClose)return e.Max=this.YClose+.1*this.YClose,e.Min=this.YClose-.1*this.YClose,e;var s=Math.max(Math.abs(this.YClose-e.Max),Math.abs(this.YClose-e.Min));return e.Max=this.YClose+s,e.Min=this.YClose-s,e},this.GetTooltipData=function(t,e,a){var i=!0===this.ChartFrame.IsHScreen;if(i)return!1;if(!this.IsShow)return!1;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var r=this.ChartBorder.PtInClient(t,e,this.Canvas,i);if(1!=r)return!1;var n=this.Data,o=this.ChartFrame.GetXData(t),s=Math.ceil(o),h=Math.floor(o);if(s>=n.Data.length||h>=n.Data.length)return!1;if(s==h)n.Data[h];else{var l=n.Data[h],u=n.Data[s],C={X:this.ChartFrame.GetXFromIndex(h),Y:this.ChartFrame.GetYFromData(l)},D={X:this.ChartFrame.GetXFromIndex(s),Y:this.ChartFrame.GetYFromData(u)};if(this.Canvas.beginPath(),this.Canvas.moveTo(C.X,C.Y+5),this.Canvas.lineTo(C.X,C.Y-5),this.Canvas.lineTo(D.X,D.Y-5),this.Canvas.lineTo(D.X,D.Y+5),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return a.Data={Index:o,Start:{Index:h,Item:n.Data[h]},End:{Index:s,Value:n.Data[s]}},a.ChartPaint=this,a.Type=5,!0}return!1}}function ue(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.Color="rgb(65,105,225)",this.MainData,this.SourceData,this.ClassName="ChartOverlayMinutePriceLine",this.Title,this.Symbol,this.Status=Rt.STATUS_NONE_ID,this.OverlayType=0,this.IsCalcuateMaxMin=!0,this.SetOption=function(t){t&&(sa.IsNumber(t.OverlayType)&&(this.OverlayType=t.OverlayType),sa.IsBool(t.IsCalcuateMaxMin)&&(this.IsCalcuateMaxMin=t.IsCalcuateMaxMin))},this.PtInChart=function(t,e){var a={MinuteOverlayPrice:!0,OverlayType:this.OverlayType};return this.PtInLine(t,e,a)},this.DrawSelectedStatus=function(){var t={MinuteOverlayPrice:!0,OverlayType:this.OverlayType};this.DrawLinePoint(t)},this.Draw=function(){if(this.Data&&sa.IsNonEmptyArray(this.Data.Data))if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount;this.Canvas.save(),this.ClipClient(t);for(var i=!0,r=0,n=0,o=null,s=null,h=0,l=this.Data.DataOffset+0,u=0;l<this.Data.Data.length&&u<e;++l,++u){var C=this.Data.Data[l];if(C&&sa.IsNumber(C.Close)){if(i){o=C.YClose;var D=this.MainData.Data[l];s=D.YClose}var f=C.Close;n=f,0==this.OverlayType&&(n=f/o*s);var c=this.ChartFrame.GetXFromIndex(u),m=this.ChartFrame.GetYFromData(n,!1);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(m,c):this.Canvas.moveTo(c,m),i=!1):t?this.Canvas.lineTo(m,c):this.Canvas.lineTo(c,m),++r}++h,h>=a&&(i=!0,h=0,r>0&&this.Canvas.stroke(),r=0)}r>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.IsCalcuateMaxMin)return e;for(var a=this.ChartFrame.MinuteCount,i=null,r=null,n=!0,o=0,s=this.Data.DataOffset,h=0;s<this.Data.Data.length&&h<t;++s,++h){var l=this.Data.Data[s];if(l&&sa.IsNumber(l.Close)){if(n){i=l.YClose;var u=this.MainData.Data[s];r=u.YClose,n=!1}var C=l.Close;0==this.OverlayType&&(C=C/i*r),null==e.Max&&(e.Max=C),null==e.Min&&(e.Min=C),e.Max<C&&(e.Max=C),e.Min>C&&(e.Min=C),++o,o>=a&&(n=!0,o=0)}else++o}return e},this.GetTooltipData=function(t,e,a){var i=!0===this.ChartFrame.IsHScreen;if(i)return!1;if(!this.IsShow)return!1;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;if(!sa.IsNumber(this.YClose)||!sa.IsNumber(this.MainYClose))return!1;var r=this.ChartBorder.PtInClient(t,e,this.Canvas,i);if(1!=r)return!1;var n=this.Data,o=this.ChartFrame.GetXData(t),s=Math.ceil(o),h=Math.floor(o);if(s>=n.Data.length||h>=n.Data.length)return!1;if(s==h)n.Data[h];else{var l=n.Data[h].Close;l=l/this.YClose*this.MainYClose;var u=n.Data[s].Close;u=u/this.YClose*this.MainYClose;var C={X:this.ChartFrame.GetXFromIndex(h),Y:this.ChartFrame.GetYFromData(l)},D={X:this.ChartFrame.GetXFromIndex(s),Y:this.ChartFrame.GetYFromData(u)};if(this.Canvas.beginPath(),this.Canvas.moveTo(C.X,C.Y+5),this.Canvas.lineTo(C.X,C.Y-5),this.Canvas.lineTo(D.X,D.Y-5),this.Canvas.lineTo(D.X,D.Y+5),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return a.Data={Index:o,Start:{Index:h,Item:n.Data[h]},End:{Index:s,Value:n.Data[s]}},a.ChartPaint=this,a.Type=6,!0}return!1}}function Ce(){this.newMethod=Vt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinutePositionLine",this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.IsShow){var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=(this.ChartBorder.GetBottomEx(),this.ChartBorder.GetLeftEx(),this.Data);if(i){var r=!0,n={},o={},s=0,h=0;this.Canvas.save(),sa.IsPlusNumber(this.LineWidth>0)&&(this.Canvas.lineWidth=this.LineWidth),this.IsDotLine&&this.Canvas.setLineDash(qi.DOTLINE.LineDash);for(var l=i.DataOffset,u=0;l<i.Data.length&&u<e;++l,++u){var C;if(C=i.Data[l],++h,null!=C){var D=this.ChartFrame.GetXFromIndex(u),f=this.ChartFrame.GetYFromData(C);r?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(f,D):this.Canvas.moveTo(D,f),r=!1,n={X:D,Y:f}):t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),o.X=D,o.Y=f,o.Price=C,++s,h>=a&&(r=!0,this.Canvas.stroke(),h=0,s=0)}}s>0&&(1==s?(this.Canvas.beginPath(),t?this.Canvas.arc(n.Y,n.X,1,0,360,!1):this.Canvas.arc(n.X,n.Y,1,0,360,!1),this.Canvas.closePath(),this.Canvas.fillStyle=this.Color,this.Canvas.fill()):this.Canvas.stroke()),this.Canvas.restore()}}}}function De(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.BuyColor=qi.Minute.BuySellBar.BuyColor,this.SellColor=qi.Minute.BuySellBar.SellColor,this.BarWidth=qi.Minute.BuySellBar.BarWidth,this.AryBarRange=qi.Minute.BuySellBar.AryBarRange,this.YOffset=qi.Minute.BuySellBar.YOffset,this.Font=qi.Minute.BuySellBar.Font,this.TextColor=qi.Minute.BuySellBar.TextColor,this.IsDrawFirst=!0,this.IsShow=!1,this.BuySellData=null,this.ReloadResource=function(t){this.BuyColor=qi.Minute.BuySellBar.BuyColor,this.SellColor=qi.Minute.BuySellBar.SellColor,this.BarWidth=qi.Minute.BuySellBar.BarWidth,this.AryBarRange=qi.Minute.BuySellBar.AryBarRange,this.YOffset=qi.Minute.BuySellBar.YOffset,this.Font=qi.Minute.BuySellBar.Font,this.TextColor=qi.Minute.BuySellBar.TextColor},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.BuySellData){var t=this.GetVolRange();if(t){var e=this.HQChart.GetKData();if(e&&sa.IsNonEmptyArray(e.Data)){for(var a=!0===this.ChartFrame.IsHScreen,i=this.ChartFrame.XPointCount,r=this.ChartFrame.MinuteCount,n=(e.Data.length-1)%r,o=i-1-120,s=i-1,h=0;h<this.AryBarRange.length;++h){var l=this.AryBarRange[h];if(n<r-1-l.End){o=i-1-l.Start,s=i-1-l.End;break}}var u=this.ChartFrame.GetXFromIndex(o),C=this.ChartFrame.GetXFromIndex(s);this.Canvas.save(),this.ClipClient(a);var D=this.BuySellData.AryBuy;if(sa.IsNonEmptyArray(D)){this.Canvas.beginPath();var f=0;for(h=0;h<D.length;++h){l=D[h];if(l&&sa.IsNumber(l.Vol)&&sa.IsNumber(l.Price)){var c=this.GetYFromData(l.Price,!1),m=I(l.Vol);a?(c-=-this.YOffset,this.Canvas.moveTo(c,m),this.Canvas.lineTo(c,C)):(c-=-this.YOffset,this.Canvas.moveTo(m,c),this.Canvas.lineTo(C,c)),++f}}f>0&&(this.Canvas.strokeStyle=this.BuyColor,sa.IsPlusNumber(this.BarWidth)&&(this.Canvas.lineWidth=this.BarWidth),this.Canvas.stroke())}var d=this.BuySellData.ArySell;if(sa.IsNonEmptyArray(d)){this.Canvas.beginPath();for(f=0,h=0;h<d.length;++h){l=d[h];if(l&&sa.IsNumber(l.Vol)&&sa.IsNumber(l.Price)){c=this.GetYFromData(l.Price,!1),m=I(l.Vol);a?(c-=-this.YOffset,this.Canvas.moveTo(c,m),this.Canvas.lineTo(c,C)):(c-=-this.YOffset,this.Canvas.moveTo(m,c),this.Canvas.lineTo(C,c)),++f}}f>0&&(this.Canvas.strokeStyle=this.SellColor,sa.IsPlusNumber(this.BarWidth)&&(this.Canvas.lineWidth=this.BarWidth),this.Canvas.stroke())}this.DrawMaxVolText(t.Max,u),this.Canvas.restore()}}}function I(e){var a=C-u,i=a*(e-t.Min)/(t.Max-t.Min);return C-i}},this.DrawMaxVolText=function(t,e){if(sa.IsNumber(t)){var a=this.ChartFrame.GetBorder(),i=t.toFixed(0);if(this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextColor,!0===this.ChartFrame.IsHScreen){var r=a.LeftEx+1;this.Canvas.save(),this.Canvas.translate(r,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(i,0,0),this.Canvas.restore()}else{r=a.Bottom-1;this.Canvas.fillText(i,e,r)}}},this.GetVolRange=function(){if(!this.BuySellData)return null;var t={Min:0,Max:null},e=this.BuySellData.AryBuy,a=this.BuySellData.ArySell,i=0;if(sa.IsNonEmptyArray(e))for(var r=0;r<e.length;++r){var n=e[r];sa.IsNumber(n.Vol)&&((null==t.Min||t.Min>n.Vol)&&(t.Min=n.Vol),(null==t.Max||t.Max<n.Vol)&&(t.Max=n.Vol),++i)}if(sa.IsNonEmptyArray(a))for(r=0;r<a.length;++r){n=a[r];sa.IsNumber(n.Vol)&&((null==t.Min||t.Min>n.Vol)&&(t.Min=n.Vol),(null==t.Max||t.Max<n.Vol)&&(t.Max=n.Vol),++i)}return i<=0?null:t},this.GetMaxMin=function(){return{Min:null,Max:null}}}function fe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteInfo",this.Data=new Map,this.SourceData,this.ChartMinutePrice,this.YClose,this.HQChartBorder,this.TextColor=qi.MinuteInfo.TextColor,this.Font=qi.MinuteInfo.Font,this.PointColor=qi.MinuteInfo.PointColor,this.PointRadius=qi.MinuteInfo.PointRadius,this.LineColor=qi.MinuteInfo.LineColor,this.TextBGColor=qi.MinuteInfo.TextBGColor,this.PixelTatio=F(),this.TextHeight=20,this.TextRectCache=[],this.InfoDrawCache=[],this.FrameBottom,this.FrameTop,this.FrameLeft,this.FrameRight,this.YOffset=5,this.IsHScreen=!1,this.IsDrawFull=!1,this.TooltipRect=[],this.SetOption=function(t){t.TextColor&&(this.TextColor=t.TextColor),t.TextBGColor&&(this.TextBGColor=t.TextBGColor),t.Font&&(this.Font=t.Font),t.PointColor&&(this.PointColor=t.PointColor),t.LineColor&&(this.LineColor=t.LineColor),t.TextHeight>0&&(this.TextHeight=t.TextHeight),1==t.IsDrawFull&&(this.IsDrawFull=!0)},this.Draw=function(){if(this.TooltipRect=[],this.ChartMinutePrice&&this.Data&&!(this.Data.size<=0)){this.TextRectCache=[],this.InfoDrawCache=[],this.PixelTatio=F(),this.YOffset=5*this.PixelTatio,this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount;this.ChartFrame.MinuteCount;this.FrameBottom=this.ChartBorder.GetBottom(),this.IsDrawFull&&this.HQChartBorder&&(this.FrameBottom=this.HQChartBorder.GetBottom()),this.FrameTop=this.ChartBorder.GetTop(),this.FrameLeft=this.ChartBorder.GetLeft(),this.FrameRight=this.ChartBorder.GetRight(),this.IsHScreen&&(this.FrameRight=this.ChartBorder.GetBottom(),this.FrameLeft=this.ChartBorder.GetTop(),this.FrameBottom=this.ChartBorder.GetLeft(),this.FrameTop=this.ChartBorder.GetRight()),this.YClose=this.ChartMinutePrice.YClose;for(var e=this.ChartMinutePrice.Source,a=e.DataOffset,i=0;a<e.Data.length&&i<t;++a,++i){var r=e.Data[a];if(r){var n=r.DateTime;this.Data.has(n)&&(this.IsHScreen?this.CalcuateInfoHScreenPosition(this.Data.get(n),i,r):this.CalcuateInfoPosition(this.Data.get(n),i,r))}}for(var a in this.InfoDrawCache){r=this.InfoDrawCache[a];this.DrawInfoLines(r)}for(var a in this.InfoDrawCache){r=this.InfoDrawCache[a];if(this.DrawInfoText(r),!this.IsHScreen){var o=r.Border,s=new gt(o.X,o.Y,o.Width,o.Height),h={Data:{Item:r},Rect:s};this.TooltipRect.push(h)}}this.TextRectCache=[],this.InfoDrawCache=[]}},this.CalcuateInfoPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0];this.Canvas.font=this.Font;var r,n=this.Canvas.measureText(i.Title).width+4*this.PixelTatio,o=this.TextHeight*this.PixelTatio,s=this.ChartFrame.GetXFromIndex(e);r=sa.IsNumber(i.Price)?this.ChartFrame.GetYFromData(i.Price):this.ChartFrame.GetYFromData(a.Close),s=A(s);var h=s<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,6,8,3,5,7],u=o+l[e%l.length]*this.PixelTatio,C={Y:[{Value:r+(o+this.YOffset),Offset:u},{Value:r-(2*o+this.YOffset),Offset:-u}]};a.Close<this.YClose&&(C.Y=C.Y.reverse());var D={X:s,Y:null,Width:n,Height:o};h||(D.X-=D.Width),this.FixTextRect(D,C);var f={Border:D,Start:{X:s,Y:r},IsLeft:h,Title:i.Title,Date:i.Date,Time:i.Time};i.Content&&(f.Content=i.Content),i.Link&&(f.Link=i.Link),i.Color&&(f.Color=i.Color),i.BGColor&&(f.BGColor=i.BGColor),this.InfoDrawCache.push(f),this.TextRectCache.push(D)}},this.CalcuateInfoHScreenPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0];this.Canvas.font=this.Font;var r,n=this.Canvas.measureText(i.Title).width+4*this.PixelTatio,o=this.TextHeight*this.PixelTatio,s=this.ChartFrame.GetXFromIndex(e);r=sa.IsNumber(i.Price)?this.ChartFrame.GetYFromData(i.Price):this.ChartFrame.GetYFromData(a.Close),s=A(s);var h=s<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,6,8,3,5,7],u=o+l[e%l.length]*this.PixelTatio,C={X:[{Value:r+(o+this.YOffset),Offset:u},{Value:r-(2*o+this.YOffset),Offset:-u}]};a.Close>this.YClose&&(C.X=C.X.reverse());var D={X:null,Y:s,Width:o,Height:n};h||(D.Y-=D.Height),this.FixHScreenTextRect(D,C);var f={Border:D,Start:{X:r,Y:s},IsLeft:h,Title:i.Title};i.Content&&(f.Content=i.Content),i.Link&&(f.Link=i.Link),i.Color&&(f.Color=i.Color),i.BGColor&&(f.BGColor=i.BGColor),this.InfoDrawCache.push(f),this.TextRectCache.push(D)}},this.DrawInfoLines=function(t){var e=t.Border,a=t.IsLeft;this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(t.Start.X),t.Start.Y),a?this.Canvas.lineTo(A(t.Start.X),e.Y):this.IsHScreen?this.Canvas.lineTo(e.X,e.Y+e.Height):this.Canvas.lineTo(A(t.Start.X),e.Y),this.Canvas.stroke(),this.Canvas.fillStyle=this.PointColor,this.Canvas.beginPath(),this.Canvas.arc(t.Start.X,t.Start.Y,this.PointRadius,0,2*Math.PI),this.Canvas.closePath(),this.Canvas.fill()},this.DrawInfoText=function(t){var e=t.Border,a=e.X,i=e.Y;t.BGColor?this.Canvas.fillStyle=t.BGColor:this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(a,i,e.Width,e.Height),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.rect(a,i,e.Width,e.Height),this.Canvas.stroke(),this.IsHScreen&&(this.Canvas.save(),this.Canvas.translate(e.X,e.Y),this.Canvas.rotate(90*Math.PI/180),a=0,i=0),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",t.Color?this.Canvas.fillStyle=t.Color:this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.IsHScreen?this.Canvas.fillText(t.Title,a+2*this.PixelTatio,i-e.Width/2):this.Canvas.fillText(t.Title,a+2*this.PixelTatio,i+e.Height/2),this.IsHScreen&&this.Canvas.restore()},this.FixTextRect=function(t,e){for(var a in e.Y){var i,r=e.Y[a];t.Y=r.Value;for(var n=0;n<10;++n){var o=!1;for(var s in this.TextRectCache){var h=this.TextRectCache[s];if(this.IsOverlap(h,t)){o=!0;break}}if(0==o)return;if(i=t.Y,i+=r.Offset,i+t.Height>this.FrameBottom||i<this.FrameTop)break;t.Y=i}}},this.FixHScreenTextRect=function(t,e){for(var a in e.X){var i,r=e.X[a];t.X=r.Value;for(var n=0;n<10;++n){var o=!1;for(var s in this.TextRectCache){var h=this.TextRectCache[s];if(this.IsOverlap(h,t)){o=!0;break}}if(0==o)return;if(i=t.X,i+=r.Offset,i+t.Width<this.FrameBottom||i>this.FrameTop)break;t.X=i}}},this.IsOverlap=function(t,e){return t.X+t.Width>e.X&&e.X+e.Width>t.X&&t.Y+t.Height>e.Y&&e.Y+e.Height>t.Y},this.GetMaxMin=function(){return{Min:null,Max:null}},this.GetTooltipData=function(t,e,a){for(var i in this.TooltipRect){var r=this.TooltipRect[i];if(r.Rect){var n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return a.Data=r,a.ChartPaint=this,a.Type=3,!0}}return!1}}function ce(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMACD",this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.LineWidth=1,this.DrawSelectedStatus=this.DrawLinePoint,this.ExportData=this.ExportArrayData,this.PtInChart=function(t,e){var a=this.ChartFrame.DataWidth,i=this.LineWidth*F();return 50==this.barWidth?i=null:i>a&&(i=a),i<4&&(i=4),this.PtInBar(t,e,{BarWidth:i})},this.DrawBars=function(t,e){var a=this.IsMinuteFrame(),i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth,n=this.ChartFrame.XPointCount,o=!0===this.ChartFrame.IsHScreen;if(o){var s=this.ChartBorder.GetHScreenBorder(),h=s.TopEx+r/2+qi.FrameLeftMargin,l=s.BottomEx,u=this.GetLockRect();u&&(l=u.Top)}else{s=this.ChartBorder.GetBorder(),h=s.LeftEx+r/2+qi.FrameLeftMargin,l=s.RightEx,u=this.GetLockRect();u&&(l=u.Left)}this.Canvas.strokeStyle=e?this.UpColor:this.DownColor;var C=this.ChartFrame.GetYFromData(0);this.Canvas.beginPath();for(var D=0,f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<n;++f,++c,h+=i+r){var m=this.Data.Data[f];if(null!=m){if(e){if(m<0)continue}else if(m>=0)continue;if(a)var d=this.ChartFrame.GetXFromIndex(c);else{var I=h,S=h+i;if(S>l)break;d=I+(S-I)/2}if(d>l)break;var T=this.ChartFrame.GetYFromData(m),v=O(t,d);o?(this.Canvas.moveTo(C,A(d)),this.Canvas.lineTo(T,A(d))):(this.Canvas.moveTo(v,C),this.Canvas.lineTo(v,T)),++D}}D>0&&this.Canvas.stroke()},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=this.ChartFrame.DataWidth,e=this.LineWidth*F();(50==this.LineWidth||e>t)&&(e=t);var a=this.Canvas.lineWidth;this.Canvas.lineWidth=e,this.DrawBars(e,!0),this.DrawBars(e,!1),this.Canvas.lineWidth=a}},this.GetItemData=function(t){if(!t)return null;if(!sa.IsNumber(t.Index))return null;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return null;var e=t.Index;if(e<0||e>=this.Data.Data.length)return null;var a=this.Data.Data[e];return[{Value:a,Color:a>0?this.UpColor:this.DownColor,Name:this.Name}]}}function me(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartClipColorStick",this.UpColor=qi.UpBarColor,this.DownColor=qi.DownBarColor,this.LineWidth=1,this.Style=0,this.DownDiffColor=qi.DownBarColor,this.UpDiffColor=qi.UpBarColor,this.TextLabelConfig={Font:"".concat(12*F(),"px 微软雅黑"),TextMargin:{Left:2,Right:2,Bottom:2,Top:2},TextColor:"rgb(230,230,230)",UpColor:"rgb(137,16,19)",DownColor:"rgb(44,104,57)",UnchangeColor:"rgb(111,112,115)",BorderColor:"rgb(0,0,0)",LabelWidth:0,TextHeight:0,MaxTextWidth:0},this.BaseLineColor,this.BaseValue=0,this.Super_GetMaxMin=this.GetMaxMin,this.ValueRange,this.IsShowText=!1,this.SetOption=function(t){t&&(t.UpColor&&(this.UpColor=t.UpColor),t.DownColor&&(this.DownColor=t.DownColor),t.DownDiffColor&&(this.DownDiffColor=t.DownDiffColor),t.UpDiffColor&&(this.UpDiffColor=t.UpDiffColor),t.BaseLineColor&&(this.BaseLineColor=t.BaseLineColor),sa.IsNumber(t.BaseValue)&&(this.BaseValue=t.BaseValue),sa.IsNumber(t.Style)&&(this.Style=t.Style),t.ValueRange&&(this.ValueRange=t.ValueRange))},this.Draw=function(){if(this.IsShowText=!1,this.TextLabelConfig.LabelWidth=0,this.TextLabelConfig.TextHeight=0,this.TextLabelConfig.MaxTextWidth=0,this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=!0===this.ChartFrame.IsHScreen,r=this.LineWidth*F();if((50==this.LineWidth||r>t)&&(r=t),!i){var n=t+e,o=this.IsMinuteFrame();if(o){var s=this.ChartBorder.GetBorder();n=(s.Right-s.Left)/(a-1)}this.Canvas.font=this.TextLabelConfig.Font,this.TextLabelConfig.MaxTextWidth=this.Canvas.measureText("-888").width,this.TextLabelConfig.LabelWidth=this.TextLabelConfig.MaxTextWidth+this.TextLabelConfig.TextMargin.Left+this.TextLabelConfig.TextMargin.Right,this.IsShowText=n>this.TextLabelConfig.LabelWidth,this.TextLabelConfig.TextHeight=this.Canvas.measureText("擎").width}this.Canvas.save(),sa.IsNumber(this.BaseValue)&&0!=this.BaseValue?(this.DrawBaseLine(),this.BaseValue>0?this.DrawBars(r,!0,!0):this.DrawBars(r,!1,!0)):(this.DrawBars(r,!0,!0),this.DrawBars(r,!1)),this.Canvas.restore()}},this.DrawBars=function(t,e,a){var i=this.IsMinuteFrame(),r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,o=this.ChartFrame.XPointCount,s=!0===this.ChartFrame.IsHScreen;if(s){var h=this.ChartBorder.GetHScreenBorder(),l=h.TopEx+n/2+qi.FrameLeftMargin,u=h.BottomEx,C=this.GetLockRect();C&&(u=C.Top)}else{h=this.ChartBorder.GetBorder(),l=h.LeftEx+n/2+qi.FrameLeftMargin,u=h.RightEx,C=this.GetLockRect();C&&(u=C.Left)}var D=this.ChartFrame.GetYFromData(this.BaseValue),f=[],c=[],m=[],d=null,I=this.Data.DataOffset;I-1>0&&(d=this.Data.Data[I-1]);for(var S=I,T=0;S<this.Data.Data.length&&T<o;++S,++T,l+=r+n){var v=this.Data.Data[S];if(null!=v){if(i)var p=this.ChartFrame.GetXFromIndex(T);else{var g=l,x=l+r;if(x>u)break;p=g+(x-g)/2}if(p>u)break;var F={X:p,Value:v};if(sa.IsNumber(d)&&(F.DiffValue=v-d),m.push(F),d=v,e){if(v<0)continue}else if(v>=0)continue;var E=!1,L=null;if(this.BaseValue>0?v<this.BaseValue&&(E=!0,L=1==this.Style?this.BaseValue+(this.BaseValue-v):this.BaseValue-(this.BaseValue-v)):this.BaseValue<0&&v>this.BaseValue&&(E=!0,L=1==this.Style?this.BaseValue-(v-this.BaseValue):this.BaseValue+(v-this.BaseValue)),E){M=this.ChartFrame.GetYFromData(L);c.push({X:p,Y:M})}else{var M=this.ChartFrame.GetYFromData(v);f.push({X:p,Y:M})}}}this.Canvas.lineWidth=t,this.Canvas.strokeStyle=e?this.UpColor:this.DownColor,this.DrawStick(f,t,D),this.BaseValue>0?(this.Canvas.strokeStyle=this.UpDiffColor,this.DrawStick(c,t,D)):this.BaseValue<0&&(this.Canvas.strokeStyle=this.DownDiffColor,this.DrawStick(c,t,D)),this.IsShowText&&a&&this.DrawStickText(m)},this.DrawStick=function(t,e,a){if(sa.IsNonEmptyArray(t)){var i=!0===this.ChartFrame.IsHScreen,r=0;this.Canvas.beginPath();for(var n=0;n<t.length;++n){var o=t[n],s=o.Y,h=O(e,o.X);i?(this.Canvas.moveTo(a,A(x)),this.Canvas.lineTo(s,A(x))):(this.Canvas.moveTo(h,a),this.Canvas.lineTo(h,s)),++r}r>0&&this.Canvas.stroke()}},this.DrawBaseLine=function(){if(sa.IsNumber(this.BaseValue)&&0!=this.BaseValue&&this.BaseLineColor){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.GetBorder(),a=this.ChartFrame.GetYFromData(this.BaseValue);if(this.Canvas.strokeStyle=this.BaseLineColor,this.Canvas.lineWidth=1*F(),t);else{var i=A(a);this.Canvas.beginPath(),this.Canvas.moveTo(e.Left,i),this.Canvas.lineTo(e.Right,i),this.Canvas.stroke()}}},this.DrawStickText=function(t){var e=this.TextLabelConfig;this.Canvas.font=e.Font;for(var a=this.ChartBorder.GetBorder(),i=2*e.TextHeight+e.TextMargin.Bottom+e.TextMargin.Top,r=0;r<t.length;++r){var n=t[r],o=n.Value,s=n.X,h=s-e.LabelWidth/2,l={Left:h,Width:e.LabelWidth,Top:a.BottomEx+1,Height:i};if(l.Right=l.Left+l.Width,l.Bottom=l.Top+l.Height,sa.IsNumber(o)){var u=e.UnchangeColor;o>0?u=e.UpColor:o<0&&(u=e.DownColor),this.DrawTextLabel(o,u,e.BorderColor,e.TextColor,l,e.TextHeight,e.MaxTextWidth,e.TextMargin)}o=n.DiffValue,l={Left:h,Width:e.LabelWidth,Bottom:a.TopEx-1,Height:i};if(l.Right=l.Left+l.Width,l.Top=l.Bottom-l.Height,sa.IsNumber(o)){u=e.UnchangeColor;o>0?u=e.UpColor:o<0&&(u=e.DownColor),this.DrawTextLabel(o,u,e.BorderColor,e.TextColor,l,e.TextHeight,e.MaxTextWidth,e.TextMargin)}}},this.DrawTextLabel=function(t,e,a,i,r,n,o,s){e&&(this.Canvas.fillStyle=e,this.Canvas.fillRect(r.Left,r.Top,r.Width,r.Height)),a?(this.Canvas.lineWidth=2,this.Canvas.strokeStyle=a,this.Canvas.strokeRect(r.Left,r.Top,r.Width,r.Height)):(this.Canvas.lineWidth=1,this.Canvas.strokeStyle="rgb(0,0,0)",this.Canvas.strokeRect(r.Left,r.Top,r.Width,r.Height));var h=[null,null],l="";if(t<0&&(t=Math.abs(t),l="-"),t>999){var u=parseInt(t/1e3),C=parseInt(t%1e3);h[0]="".concat(l).concat(u),h[1]="".concat(C),C<10?h[1]="00".concat(C):C<100&&(h[1]="0".concat(C))}else h[1]="".concat(l).concat(t.toFixed(0));this.Canvas.textAlign="right",this.Canvas.textBaseline="top";var D=r.Right-(r.Right-r.Left-o)/2;this.Canvas.fillStyle=i;for(var f=s.Top+r.Top,c=0;c<h.length;++c){var m=h[c];m&&this.Canvas.fillText(m,D,f),f+=n}},this.GetMaxMin=function(){if(!sa.IsNumber(this.BaseValue)||0==this.BaseValue)return this.Super_GetMaxMin();if(this.ValueRange){var t={Min:this.ValueRange.Min,Max:this.ValueRange.Max};return t}var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(a=0,e=this.Data.Data.length);t={Min:null,Max:null};var i=null;if(!this.Data||!this.Data.Data)return t;this.BaseValue>0?t.Min=this.BaseValue:t.Max=this.BaseValue;for(var r=a,n=0;r<this.Data.Data.length&&n<e;++r,++n){var o=this.Data.Data[r];if(null!=o&&!isNaN(o)){if(this.BaseValue>0){if(o<0)continue;if(o<this.BaseValue){var s=this.BaseValue-o;(null==i||i<s)&&(i=s);continue}}else{if(o>0)continue;if(o>this.BaseValue){s=o-this.BaseValue;(null==i||i<s)&&(i=s);continue}}null==t.Max&&(t.Max=o),null==t.Min&&(t.Min=o),t.Max<o&&(t.Max=o),t.Min>o&&(t.Min=o)}}if(this.BaseValue>0)if(1==this.Style){if(sa.IsNumber(i)){o=this.BaseValue+i;(sa.IsNumber(t.Max)||t.Max<o)&&(t.Max=o)}}else sa.IsNumber(i)&&sa.IsNumber(t.Min)&&(t.Min-=i);else if(1==this.Style){if(sa.IsNumber(i)){o=this.BaseValue-i;(sa.IsNumber(t.Min)||t.Min>o)&&(t.Min=o)}}else sa.IsNumber(i)&&sa.IsNumber(t.Max)&&(t.Max+=i);return t}}function de(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartBand",this.FirstColor=qi.Index.LineColor[0],this.SecondColor=qi.Index.LineColor[1],this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex())if(this.NotSupportMessage)this.DrawNotSupportmessage();else for(var t=this.IsMinuteFrame(),e=this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+i/2+2,o=0,s=0,h=0,l=[],u=[],C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<r;++C,++D,n+=a+i){for(l=[],u=[];C<this.Data.Data.length&&D<r;++C,++D,n+=a+i){var f=this.Data.Data[C];if(null==f||null==f.Value||null==f.Value2)break;if(t)o=this.ChartFrame.GetXFromIndex(D);else{var c=n,m=n+a;o=c+(m-c)/2}s=this.ChartFrame.GetYFromData(f.Value),h=this.ChartFrame.GetYFromData(f.Value2),e?(l.push({x:s,y:o}),u.push({x:h,y:o})):(l.push({x:o,y:s}),u.push({x:o,y:h}))}l.length>1&&u.length>1&&this.DrawBand(l,u)}},this.ClipTop=function(t){var e=this.ChartFrame.IsHScreen;this.Canvas.beginPath();for(var a=0;a<t.length;++a)0==a?this.Canvas.moveTo(t[a].x,t[a].y):this.Canvas.lineTo(t[a].x,t[a].y);var i=t[0],r=t[t.length-1];if(e){var n=this.ChartBorder.GetRightEx();this.Canvas.lineTo(n,r.y),this.Canvas.lineTo(n,i.y)}else{var o=this.ChartBorder.GetTopEx();this.Canvas.lineTo(r.x,o),this.Canvas.lineTo(i.x,o)}this.Canvas.closePath(),this.Canvas.clip()},this.ClipBottom=function(t){var e=this.ChartFrame.IsHScreen;this.Canvas.beginPath();for(var a=0;a<t.length;++a)0==a?this.Canvas.moveTo(t[a].x,t[a].y):this.Canvas.lineTo(t[a].x,t[a].y);var i=t[0],r=t[t.length-1];if(e){var n=this.ChartBorder.GetLeftEx();this.Canvas.lineTo(n,r.y),this.Canvas.lineTo(n,i.y)}else{var o=this.ChartBorder.GetBottomEx();this.Canvas.lineTo(r.x,o),this.Canvas.lineTo(i.x,o)}this.Canvas.closePath(),this.Canvas.clip()},this.DrawArea=function(t,e,a){this.Canvas.beginPath();for(var i=0;i<t.length;++i)0==i?this.Canvas.moveTo(t[i].x,t[i].y):this.Canvas.lineTo(t[i].x,t[i].y);for(i=e.length-1;i>=0;--i)this.Canvas.lineTo(e[i].x,e[i].y);this.Canvas.closePath(),this.Canvas.fillStyle=a,this.Canvas.fill()},this.DrawBand=function(t,e){this.FirstColor&&(this.Canvas.save(),this.ClipTop(t),this.DrawArea(t,e,this.FirstColor),this.Canvas.restore()),this.SecondColor&&(this.Canvas.save(),this.ClipBottom(t),this.DrawArea(t,e,this.SecondColor),this.Canvas.restore())},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,o=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>o)&&(e.Min=o)}}return e}}function Ie(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartLineArea",this.Color="rgb(56,67,99)",this.IsHScreen=!1,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+qi.FrameLeftMargin,r=0,n=0,o=0,s=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var u=this.Data.Data[h];s[h]=null,null!=u&&null!=u.Value&&null!=u.Value2&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(u.Value),o=this.ChartFrame.GetYFromData(u.Value2),this.IsHScreen?s[h]={Line:{X:n,Y:r},Line2:{X:o,Y:r}}:s[h]={Line:{X:r,Y:n},Line2:{X:r,Y:o}})}this.Canvas.fillStyle=this.Color;var C=!0,D=0,f=[];for(var h in s){var c=s[h];if(c)C?(this.Canvas.beginPath(),this.Canvas.moveTo(c.Line.X,c.Line.Y),C=!1):this.Canvas.lineTo(c.Line.X,c.Line.Y),f.push(c),++D;else{if(D>0){for(l=f.length-1;l>=0;--l){var m=f[l];this.Canvas.lineTo(m.Line2.X,m.Line2.Y)}this.Canvas.closePath(),this.Canvas.fill()}C=!0,D=0,f=[]}}if(D>0){for(l=f.length-1;l>=0;--l){m=f[l];this.Canvas.lineTo(m.Line2.X,m.Line2.Y)}this.Canvas.closePath(),this.Canvas.fill()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,o=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>o)&&(e.Min=o)}}return e}}function Se(){this.newMethod=Ie,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.IsHScreen=!1,this.ClassName="ChartFillRGN",this.DrawRGB=function(t){var e=!0,a=0,i=[],r=null;for(var n in t){var o=t[n];if(!o||r&&o.Color!=r){if(a>0){for(var s=i.length-1;s>=0;--s){var h=i[s];this.Canvas.lineTo(h.Line2.X,h.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}e=!0,a=0,i=[],r=null}o&&(e?(this.Canvas.beginPath(),this.Canvas.moveTo(o.Line.X,o.Line.Y),e=!1,r=o.Color):this.Canvas.lineTo(o.Line.X,o.Line.Y),i.push(o),++a)}if(a>0){for(s=i.length-1;s>=0;--s){h=i[s];this.Canvas.lineTo(h.Line2.X,h.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+qi.FrameLeftMargin,r=0,n=0,o=0,s=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var u=this.Data.Data[h];s[h]=null,null!=u&&null!=u.Value&&null!=u.Value2&&u.Color&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(u.Value),o=this.ChartFrame.GetYFromData(u.Value2),this.IsHScreen?s[h]={Line:{X:n,Y:r},Line2:{X:o,Y:r},Color:u.Color}:s[h]={Line:{X:r,Y:n},Line2:{X:r,Y:o},Color:u.Color})}this.DrawRGB(s)}}}function Te(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!1,this.ClassName="ChartFLOATRGN",this.Color="rgb(56,67,99)",this.IsHScreen=!1,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+qi.FrameLeftMargin,r=0,n=0,o=0,s=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var u=this.Data.Data[h];s[h]=null,u&&sa.IsNumber(u.Value)&&sa.IsNumber(u.Value2)&&u.Color&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(u.Value),this.IsHScreen?s[h]={Line:{X:n,Y:r},Line2:{X:n+u.Value2*F(),Y:r},Color:u.Color}:s[h]={Line:{X:r,Y:n},Line2:{X:r,Y:n-u.Value2*F()},Color:u.Color})}var C=null;for(var h in s){u=s[h];if(C&&u)if(this.IsHScreen){var D=u.Line.Y-C.Line.Y;r=C.Line.Y+D/2,n=C.Line.X+(u.Line.X-C.Line.X)/2,o=C.Line2.X+(u.Line2.X-C.Line2.X)/2,C.RightLine={X:n,Y:r},C.RightLine2={X:o,Y:r},u.LeftLine={X:n,Y:r},u.LeftLine2={X:o,Y:r}}else{D=u.Line.X-C.Line.X;r=C.Line.X+D/2,n=C.Line.Y+(u.Line.Y-C.Line.Y)/2,o=C.Line2.Y+(u.Line2.Y-C.Line2.Y)/2,C.RightLine={X:r,Y:n},C.RightLine2={X:r,Y:o},u.LeftLine={X:r,Y:n},u.LeftLine2={X:r,Y:o}}C=u}this.DrawRGB(s)}},this.DrawRGB=function(t){var e=!0,a=0,i=[],r=null;if(this.IsHScreen)var n=this.ChartBorder.GetLeftEx(),o=this.ChartBorder.GetRightEx(),s=this.ChartBorder.GetTop(),h=this.ChartBorder.GetBottom();else n=this.ChartBorder.GetLeft(),o=this.ChartBorder.GetRight(),s=this.ChartBorder.GetTopEx(),h=this.ChartBorder.GetBottomEx();for(var l in this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(n,s,o-n,h-s),this.Canvas.clip(),t){var u=t[l];if(!u||r&&u.Color!=r){if(a>0){var C=i[i.length-1],D=i[0];C.RightLine&&(this.Canvas.lineTo(C.RightLine.X,C.RightLine.Y),this.Canvas.lineTo(C.RightLine2.X,C.RightLine2.Y));for(var f=i.length-1;f>=0;--f){var c=i[f];this.Canvas.lineTo(c.Line2.X,c.Line2.Y)}D.LeftLine2&&this.Canvas.lineTo(D.LeftLine2.X,D.LeftLine2.Y),this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}e=!0,a=0,i=[],r=null}u&&(e?(this.Canvas.beginPath(),u.LeftLine?(this.Canvas.moveTo(u.LeftLine.X,u.LeftLine.Y),this.Canvas.lineTo(u.Line.X,u.Line.Y)):this.Canvas.moveTo(u.Line.X,u.Line.Y),e=!1,r=u.Color):this.Canvas.lineTo(u.Line.X,u.Line.Y),i.push(u),++a)}if(a>0){C=i[i.length-1],D=i[0];C.RightLine&&(this.Canvas.lineTo(C.RightLine.X,C.RightLine.Y),this.Canvas.lineTo(C.RightLine2.X,C.RightLine2.Y));for(f=i.length-1;f>=0;--f){c=i[f];this.Canvas.lineTo(c.Line2.X,c.Line2.Y)}D.LeftLine2&&this.Canvas.lineTo(D.LeftLine2.X,D.LeftLine2.Y),this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}this.Canvas.restore()},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&sa.IsNumber(r.Value)){var n=r.Value;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>n)&&(e.Min=n)}}return e}}function ve(){this.newMethod=Se,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.IsHScreen=!1,this.ClassName="ChartFillBGRGN",this.DrawVerticalRGN=function(){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+qi.FrameLeftMargin,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx(),o=r,s=n,h=[],l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<a;++l,++u,i+=t+e){var C=this.Data.Data[l];h[l]=null,C&&C.Color&&(x=this.ChartFrame.GetXFromIndex(u),this.IsHScreen?h[l]={Line:{X:o,Y:x},Line2:{X:s,Y:x},Color:C.Color}:h[l]={Line:{X:x,Y:o},Line2:{X:x,Y:s},Color:C.Color})}this.DrawRGB(h)},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)if("FILLVERTICALRGN"!=this.Name){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+qi.FrameLeftMargin,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx(),o=0,s=0,h=r;"FILLBOTTOMRGN"==this.Name&&(h=n);for(var l=[],u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<a;++u,++C,i+=t+e){var D=this.Data.Data[u];l[u]=null,null!=D&&null!=D.Value&&D.Color&&(o=this.ChartFrame.GetXFromIndex(C),s=this.ChartFrame.GetYFromData(D.Value),this.IsHScreen?l[u]={Line:{X:s,Y:o},Line2:{X:h,Y:o},Color:D.Color}:l[u]={Line:{X:o,Y:s},Line2:{X:o,Y:h},Color:D.Color})}this.DrawRGB(l)}else this.DrawVerticalRGN()},this.DrawRGB=function(t){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=(a+e)/2,r=!0,n=0,o=[],s=null;for(var h in t){var l=t[h];if(!l||s&&l.Color!=s){if(n>0){for(var u=o.length-1;u>=0;--u){var C=o[u];this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=s,this.Canvas.fill()}r=!0,n=0,o=[],s=null}l&&(r?(this.Canvas.beginPath(),this.Canvas.moveTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y),r=!1,s=l.Color):(this.Canvas.lineTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),o.push(l),++n)}if(n>0){for(u=o.length-1;u>=0;--u){C=o[u];this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=s,this.Canvas.fill()}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&null!=r.Value){r=r.Value;(null==e.Max||e.Max<r)&&(e.Max=r),(null==e.Min||e.Min>r)&&(e.Min=r)}}return e}}function pe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartChannel",this.IsHScreen=!1,this.PointCount=0,this.DataWidth=0,this.DistanceWidth=0,this.ChartRight=0,this.LineColor="RGB(255,0,0)",this.LineDotted=[3,3],this.AreaColor="RGB(255,222,173)",this.LineWidth=1,this.CalculateData=function(){for(var t=[],e=[],a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<this.PointCount;++a,++i){var r=this.Data.Data[a];if(r&&sa.IsNumber(r.Value)&&sa.IsNumber(r.Value2)){var n=this.ChartFrame.GetXFromIndex(i);if(n>this.ChartRight)break;var o=this.ChartFrame.GetYFromData(r.Value),s=this.ChartFrame.GetYFromData(r.Value2);e.push({X:n,Y:o,Y2:s})}else e.length>0&&(t.push(e),e=[])}return e.length>0&&t.push(e),t},this.DrawArea=function(t){if(!(t.length<=0)){this.Canvas.beginPath();var e=t[0];this.IsHScreen?this.Canvas.moveTo(e.Y,e.X):this.Canvas.moveTo(e.X,e.Y);for(var a=1;a<t.length;++a){var i=t[a];this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y)}for(a=t.length-1;a>=0;--a){i=t[a];this.IsHScreen?this.Canvas.lineTo(i.Y2,i.X):this.Canvas.lineTo(i.X,i.Y2)}this.Canvas.closePath(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.fill()}},this.DrawLine=function(t){this.Canvas.strokeStyle=this.LineColor;for(var e=0;e<2;++e){for(var a=!0,i=0,r=0;r<t.length;++r){var n=t[r];a?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(0===e?n.Y:n.Y2,n.X):this.Canvas.moveTo(n.X,0===e?n.Y:n.Y2),a=!1):this.IsHScreen?this.Canvas.lineTo(0===e?n.Y:n.Y2,n.X):this.Canvas.lineTo(n.X,0===e?n.Y:n.Y2),++i}i>0&&this.Canvas.stroke()}},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else{this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.PointCount=this.ChartFrame.XPointCount,this.DataWidth=this.ChartFrame.DataWidth,this.DistanceWidth=this.ChartFrame.DistanceWidth,this.IsHScreen?this.ChartRight=this.ChartBorder.GetBottom():this.ChartRight=this.ChartBorder.GetRight();var t=this.CalculateData();if(t&&!(t.length<=0)){this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth*F(),this.Canvas.setLineDash(this.LineDotted);for(var e=0;e<t.length;++e){var a=t[e];this.DrawArea(a),this.DrawLine(a)}this.Canvas.restore()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,o=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>o)&&(e.Min=o)}}return e}}function ge(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartBackground",this.Color=null,this.ColorAngle=0,this.IsDrawFirst=!0,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Color&&!(this.Color.length<=0)){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,2==this.Color.length){if(this.IsHScreen)if(0==this.ColorAngle)var t={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else if(0==this.ColorAngle)t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()};var a=this.Canvas.createLinearGradient(t.X,t.Y,e.X,e.Y);a.addColorStop(0,this.Color[0]),a.addColorStop(1,this.Color[1]),this.Canvas.fillStyle=a}else{if(1!=this.Color.length)return;this.Canvas.fillStyle=this.Color[0]}if("DRAWGBK2"!=this.Name&&"KLINE_BG"!=this.Name){if(this.IsHScreen)var i=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetWidthEx(),o=this.ChartBorder.GetHeight();else i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetWidth(),o=this.ChartBorder.GetHeightEx();this.Canvas.fillRect(i,r,n,o)}else this.DrawRegion()}},this.DrawRegion=function(){var t=this.ChartFrame.XPointCount,e=this.ChartBorder.GetLeft()+i/2+qi.FrameLeftMargin,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx();this.IsHScreen&&(r=this.ChartBorder.GetRightEx(),n=this.ChartBorder.GetLeftEx());for(var o=[],s=this.Data.DataOffset,h=0;s<this.Data.Data.length&&h<t;++s,++h,e+=a+i){var l=this.Data.Data[s];if(o[s]=null,sa.IsNumber(l)&&!(l<=0)){var u=this.ChartFrame.GetXFromIndex(h);this.ChartFrame.GetYFromData(l.Value);this.IsHScreen?o[s]={Line:{X:n,Y:u},Line2:{X:r,Y:u}}:o[s]={Line:{X:u,Y:r},Line2:{X:u,Y:n}}}}this.DrawBG(o)},this.DrawBG=function(t){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=(a+e)/2,r=!0,n=0,o=[],s=null;for(var h in t){var l=t[h];if(!l||s&&l.Color!=s){if(n>0){for(var u=o.length-1;u>=0;--u){var C=o[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}r=!0,n=0,o=[],s=null}l&&(r?(this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.moveTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),r=!1,s=l.Color):this.IsHScreen?(this.Canvas.lineTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.lineTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),o.push(l),++n)}if(n>0){for(u=o.length-1;u>=0;--u){C=o[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function xe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartBackgroundDiv",this.AryColor,this.ColorType=0,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&sa.IsNonEmptyArray(this.AryColor)&&this.Data&&this.Data.Data){var t,e,a,i,r,n=!0===this.ChartFrame.IsHScreen,o=this.ChartFrame.DataWidth,s=this.ChartFrame.DistanceWidth,h=this.ChartFrame.XPointCount;n?(t=this.ChartBorder.GetHScreenBorder(),e=t.TopEx+s/2+qi.FrameLeftMargin,a=t.BottomEx,i=t.LeftEx,r=t.RightEx):(t=this.ChartBorder.GetBorder(),e=t.LeftEx+s/2+qi.FrameLeftMargin,a=t.RightEx,i=t.TopEx,r=t.BottomEx);for(var l=null,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<h;++u,++C,e+=o+s){var D=this.Data.Data[u],f=e,c=e+o;if(c>a)break;if(D){var m=i,d=r;if(sa.IsNonEmptyArray(D.AryValue)){var I=this.ChartFrame.GetYFromData(D.AryValue[0]),S=this.ChartFrame.GetYFromData(D.AryValue[1]);m=Math.min(I,S),d=Math.max(I,S)}n?l?(l.Bottom=c,l.Left>m&&(l.Left=m),l.Right<d&&(l.Right=d)):l={Left:m,Right:d,Top:f,Bottom:c}:l?(l.Right=c,l.Top>m&&(l.Top=m),l.Bottom<d&&(l.Bottom=d)):l={Left:f,Right:c,Top:m,Bottom:d}}else l&&this.DrawDiv(l,n),l=null}}},this.DrawDiv=function(t,e){if(2==this.ColorType)this.Canvas.strokeStyle=this.AryColor[0],this.Canvas.strokeRect(A(t.Left),A(t.Top),b(t.Right-t.Left),b(t.Bottom-t.Top));else if(3==this.ColorType)this.Canvas.fillStyle=this.AryColor[1],this.Canvas.fillRect(b(t.Left),b(t.Top),b(t.Right-t.Left),b(t.Bottom-t.Top)),this.Canvas.strokeStyle=this.AryColor[0],this.Canvas.strokeRect(A(t.Left),A(t.Top),b(t.Right-t.Left),b(t.Bottom-t.Top));else{if(0!=this.ColorType&&1!=this.ColorType)return;var a=null;a=e?0==this.ColorType?this.Canvas.createLinearGradient(t.Left,t.Top,t.Right,t.Top):this.Canvas.createLinearGradient(t.Left,t.Top,t.Left,t.Bottom):0==this.ColorType?this.Canvas.createLinearGradient(t.Left,t.Top,t.Left,t.Bottom):this.Canvas.createLinearGradient(t.Left,t.Top,t.Right,t.Top),a.addColorStop(.5,this.AryColor[0]),a.addColorStop(1,this.AryColor[1]),this.Canvas.fillStyle=a,this.Canvas.fillRect(b(t.Left),b(t.Top),b(t.Right-t.Left),b(t.Bottom-t.Top))}}}function Fe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartRectangle",this.Color=[],this.Rect,this.BorderColor=qi.FrameBorderPen,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Color&&this.Rect&&!(this.Color.length<=0)){this.Canvas.strokeStyle=this.BorderColor;var t=!1;if(2==this.Color.length)this.Canvas.fillStyle=this.Color[0],t=!0;else{if(1!=this.Color.length)return;this.Color[0]&&(this.Canvas.fillStyle=this.Color[0],t=!0)}var e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetHeightEx(),i=this.Rect.Left/1e3*e,r=this.Rect.Top/1e3*a,n=this.Rect.Right/1e3*e,o=this.Rect.Bottom/1e3*a;i=this.ChartBorder.GetLeft()+i,r=this.ChartBorder.GetTopEx()+r,n=this.ChartBorder.GetLeft()+n,o=this.ChartBorder.GetTopEx()+o;var s=Math.abs(i-n),h=Math.abs(r-o);t&&this.Canvas.fillRect(i,r,s,h),this.Canvas.beginPath(),this.Canvas.rect(A(i),A(r),b(s),b(h)),this.Canvas.stroke()}}}function Ee(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartTextLine",this.Text,this.Line,this.Price,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Text&&this.Line&&sa.IsNumber(this.Price)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottomEx(),i=this.ChartBorder.GetTopEx(),r=this.ChartFrame.GetYFromData(this.Price);this.Canvas.save(),this.ClipClient(this.IsHScreen);var n=0;if(this.Text.Title){var o=t+2*F(),s=r;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var h=8*F();r-h<i?(this.Canvas.textBaseline="top",s=i):r+h>a&&(this.Canvas.textBaseline="bottom",s=a),this.Canvas.fillStyle=this.Text.Color,this.Canvas.font=this.Text.Font,this.Canvas.fillText(this.Text.Title,o,s),n=this.Canvas.measureText(this.Text.Title).width+4*F()}if(this.Line.Type>0){2==this.Line.Type&&(sa.IsNonEmptyArray(this.Line.LineDash)?this.Canvas.setLineDash(this.Line.LineDash):this.Canvas.setLineDash([3,5])),sa.IsNumber(this.Line.Width)&&(this.Canvas.lineWidth=this.Line.Width);o=t+n;this.Canvas.strokeStyle=this.Line.Color,this.Canvas.beginPath(),this.Canvas.moveTo(o,A(r)),this.Canvas.lineTo(e,A(r)),this.Canvas.stroke()}this.Canvas.restore()}},this.GetMaxMin=function(){var t={Min:null,Max:null};return sa.IsNumber(this.Price)&&(t.Min=this.Price,t.Max=this.Price),t}}function Le(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiBar",this.Bars=[],this.IsHScreen=!1,this.MapCache=null,this.GetKValue=dt.GetKValue,this.GetItem=function(t){if(!this.MapCache||this.MapCache.size<=0)return null;var e=this.BuildKey(t);return this.MapCache.has(e)?this.MapCache.get(e):null},this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.Bars))for(var e=0;e<this.Bars.length;++e){var a=this.Bars[e];if(a&&sa.IsNonEmptyArray(a.Point)){var i={Color:a.Color,BGColor:null,Width:null,Name:a.Name,Type:0};sa.IsNumber(a.Width)&&(i.Width=a.Width),sa.IsNumber(a.Type)&&(i.Type=a.Type),a.BorderColor&&(i.BorderColor=a.BorderColor);for(var r=0;r<a.Point.length;++r){var n=a.Point[r],o=this.BuildKey(n),s={Data:n,ColorConfig:i};if(t.has(o)){var h=t.get(o);h.Data.push(s)}else t.set(o,{Data:[s]})}}}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)&&sa.IsNonEmptyArray(this.Bars)&&this.MapCache&&!(this.MapCache.size<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.IsMinuteFrame(),r=this.GetBorder();if(this.IsHScreen){var n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx;r.TopEx}else n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,r.LeftEx;for(var s=new Map,h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<t;++h,++l,n+=e+a){var u=this.Data.Data[h],C=this.BuildKey(u);if(this.MapCache.has(C)){var D=this.MapCache.get(C);if(sa.IsNonEmptyArray(D.Data)){if(i)var f=this.ChartFrame.GetXFromIndex(l);else{var c=n,m=n+e;if(m>o)break;f=c+(m-c)/2}this.CalculateItem(D,u,f,s)}}}s.size<=0||(this.Canvas.save(),this.ClipClient(this.IsHScreen),this.DrawAllBar(s),this.Canvas.restore())}},this.CalculateItem=function(t,e,a,i){for(var r=0;r<t.Data.length;++r){var n=t.Data[r],o=n.Data.Value;if(sa.IsString(n.Data.Value)&&(o=this.GetKValue(e,n.Data.Value)),sa.IsNumber(o)){var s=n.Data.Value2;if(sa.IsString(n.Data.Value2)&&(s=this.GetKValue(e,n.Data.Value2)),sa.IsNumber(s)){var h=this.ChartFrame.GetYFromData(o,!1),l=this.ChartFrame.GetYFromData(s,!1),u=JSON.stringify(n.ColorConfig);i.has(u)||i.set(u,{AryBar:[]});var C=i.get(u);C.AryBar.push({X:a,Y:h,Y2:l,Data:n})}}}},this.DrawAllBar=function(t){var e,a=F(),i=this.ChartFrame.DataWidth,r=(0,l.default)(t);try{for(r.s();!(e=r.n()).done;){var n=e.value,o=n[1].AryBar;if(sa.IsNonEmptyArray(o)){var s=null,h=new Path2D,u=new Path2D,C=0,D=-1,f=i;this.Canvas.beginPath();for(var c=0;c<o.length;++c){var m=o[c];if(!s)if(f=i,s=m.Data.ColorConfig,sa.IsNumber(s.Width)&&(f=s.Width*a),f>4)if(0==s.Type)D=2;else if(1==s.Type)D=3;else{if(2!=s.Type)continue;D=4}else D=1;if(!(D<=0))if(1==D)this.IsHScreen?(this.Canvas.moveTo(A(m.Y),A(m.X)),this.Canvas.lineTo(A(m.Y2),A(m.X))):(this.Canvas.moveTo(A(m.X),A(m.Y)),this.Canvas.lineTo(A(m.X),A(m.Y2))),++C;else if(2==D){var d=m.X-f/2,I=Math.min(m.Y,m.Y2),S=(f=f,Math.abs(m.Y-m.Y2)),T=new Path2D;this.IsHScreen?T.rect(b(I),b(d),b(S),b(f)):T.rect(b(d),b(I),b(f),b(S)),h.addPath(T),++C}else if(3==D){d=m.X-f/2,I=Math.min(m.Y,m.Y2),f=f,S=Math.abs(m.Y-m.Y2),T=new Path2D;this.IsHScreen?T.rect(A(I),A(d),A(S),A(f)):T.rect(A(d),A(I),A(f),A(S)),h.addPath(T),++C}else if(4==D){d=m.X-f/2,I=Math.min(m.Y,m.Y2),f=f,S=Math.abs(m.Y-m.Y2),T=new Path2D;this.IsHScreen?T.rect(b(I),b(d),b(S),b(f)):T.rect(b(d),b(I),b(f),b(S)),u.addPath(T);T=new Path2D;this.IsHScreen?T.rect(A(I),A(d),A(S),A(f)):T.rect(A(d),A(I),A(f),A(S)),h.addPath(T),++C}}C>0&&D>0&&s&&(1==D?(this.Canvas.lineWidth=1*a,this.Canvas.strokeStyle=s.Color,this.Canvas.stroke()):2==D?(this.Canvas.fillStyle=s.Color,this.Canvas.fill(h)):3==D?(this.Canvas.lineWidth=1*a,this.Canvas.strokeStyle=s.Color,this.Canvas.stroke(h)):4==D&&(s.Color&&(this.Canvas.fillStyle=s.Color,this.Canvas.fill(h)),s.BorderColor&&(this.Canvas.lineWidth=1*a,this.Canvas.strokeStyle=s.BorderColor,this.Canvas.stroke(h))))}}}catch(v){r.e(v)}finally{r.f()}},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;if(!this.MapCache||this.MapCache.size<=0)return t;for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0,r=0;a<this.Data.Data.length&&i<e;++a,++i){var n=this.Data.Data[a],o=this.BuildKey(n);if(this.MapCache.has(o)){var s=this.MapCache.get(o);if(sa.IsNonEmptyArray(s.Data))for(r=0;r<s.Data.length;++r){var h=s.Data[r],l=h.Data.Value;if(sa.IsString(h.Data.Value)&&(l=this.GetKValue(n,h.Data.Value)),sa.IsNumber(l)){var u=h.Data.Value2;if(sa.IsString(h.Data.Value2)&&(u=this.GetKValue(n,h.Data.Value2)),sa.IsNumber(u)){var C=Math.min(l,u),D=Math.max(l,u);(null==t.Max||t.Max<D)&&(t.Max=D),(null==t.Min||t.Min>C)&&(t.Min=C)}}}}}return t}}function Me(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiLine",this.Lines=[],this.LineDash,this.LineWidth=1,this.IsHScreen=!1,this.ArrawAngle=35,this.ArrawLength=10,this.ArrawLineWidth=5,this.Arrow={Start:!1,End:!1},this.IsFullRangeMaxMin=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.Data&&!(this.Data.length<=0)&&sa.IsNonEmptyArray(this.Lines)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;for(var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=[],i=[],r=0;r<this.Lines.length;++r){var n=this.Lines[r],o={Point:[],Color:n.Color,AryCircle:null},s={Start:[],End:[]};n.BGColor&&(o.BGColor=n.BGColor),sa.IsNonEmptyArray(n.Circle)&&(o.AryCircle=n.Circle);var h=!1;if(sa.IsBool(n.IsExtendLine)&&(h=n.IsExtendLine),h){for(var l=null,u=!0,C=0;C<n.Point.length;++C){var D=n.Point[C];if(sa.IsNumber(D.Index)){var f=D.Index-e;if(f>0&&f<t){if(u){if(l){var c=l.Index-e,m=this.ChartFrame.GetXFromIndex(c,!1),d=this.ChartFrame.GetYFromData(l.Value,!1),I={X:m,Y:d,End:!1};o.Point.push(I)}u=!1}m=this.ChartFrame.GetXFromIndex(f,!1),d=this.ChartFrame.GetYFromData(D.Value,!1),I={X:m,Y:d,End:!1};o.Point.push(I)}else if(o.Point.length>0){m=this.ChartFrame.GetXFromIndex(f,!1),d=this.ChartFrame.GetYFromData(D.Value,!1),I={X:m,Y:d,End:!0};o.Point.push(I),u=!0,l=null}l=D}}o.Point.length>=2&&(a.push(o),i.push(s))}else{for(C=0;C<n.Point.length;++C){D=n.Point[C];if(sa.IsNumber(D.Index)){f=D.Index-e;if(f>=0&&f<t){m=this.ChartFrame.GetXFromIndex(f),d=this.ChartFrame.GetYFromData(D.Value,!1),I={X:m,Y:d,End:!1};o.Point.push(I),0!=C&&1!=C||s.Start.push(I),C!=n.Point.length-1&&C!=n.Point.length-2||s.End.push(I)}else o.Point.length>0&&(o.Point[o.Point.length-1].End=!0)}}o.Point.length>=2&&(a.push(o),i.push(s))}}var S=F();this.Canvas.save(),this.ClipClient(this.IsHScreen);for(r=0;r<a.length;++r){this.LineDash&&this.Canvas.setLineDash(this.LineDash),sa.IsPlusNumber(this.LineWidth)?this.Canvas.lineWidth=this.LineWidth*S:this.Canvas.lineWidth=1*S;var T=a[r];this.DrawLine(T,i[r]),T.AryCircle&&this.DrawCircle(T)}this.Canvas.restore()}},this.DrawCircle=function(t){for(var e=F(),a=0;a<t.Point.length;++a)for(var i=t.Point[a],r=0;r<t.AryCircle.length;++r){var n=t.AryCircle[r],o=0;sa.IsNumber(n.Type)&&(o=n.Type),this.Canvas.beginPath(),this.Canvas.arc(i.X,i.Y,n.Radius,0,2*Math.PI),1==o?(sa.IsPlusNumber(n.LineWidth)&&(this.Canvas.lineWidth=n.LineWidth*e),this.Canvas.strokeStyle=n.Color,this.Canvas.stroke()):(this.Canvas.fillStyle=n.Color,this.Canvas.fill())}},this.DrawLine=function(t,e){if(t.BGColor){this.Canvas.fillStyle=t.BGColor;for(var a=0;a<t.Point.length;++a){var i=t.Point[a];0==a?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(i.Y,i.X):this.Canvas.moveTo(i.X,i.Y)):this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y)}this.Canvas.closePath(),this.Canvas.fill()}this.Canvas.strokeStyle=t.Color;var r=0;for(a=0;a<t.Point.length;++a){i=t.Point[a];0==r?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(i.Y,i.X):this.Canvas.moveTo(i.X,i.Y),++r):(this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y),++r),1==i.End&&(r>0&&this.Canvas.stroke(),r=0)}r>0&&this.Canvas.stroke(),2==e.End.length&&1==this.Arrow.End&&this.DrawArrow(e.End[0],e.End[1]),2==e.Start.length&&1==this.Arrow.Start&&this.DrawArrow(e.Start[1],e.Start[0])},this.DrawArrow=function(t,e){var a=this.ArrawAngle,i=this.ArrawLength,r=180*Math.atan2(t.Y-e.Y,t.X-e.X)/Math.PI,n=(r+a)*Math.PI/180,o=(r-a)*Math.PI/180,s=i*Math.cos(n),h=i*Math.sin(n),l=i*Math.cos(o),u=i*Math.sin(o);this.Canvas.beginPath();var C=e.X+s,D=e.Y+h;this.Canvas.moveTo(C,D),this.Canvas.lineTo(e.X,e.Y),C=e.X+l,D=e.Y+u,this.Canvas.lineTo(C,D),this.Canvas.setLineDash([]),this.Canvas.lineWidth=this.ArrawLineWidth*F(),this.Canvas.stroke()},this.GetMaxMin=function(){if(this.IsFullRangeMaxMin)return this.GetFullRangeMaxMin();var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Lines){var n=this.Lines[r];for(var o in n.Point){var s=n.Point[o];s.Index>=a&&s.Index<i&&((null==t.Max||t.Max<s.Value)&&(t.Max=s.Value),(null==t.Min||t.Min>s.Value)&&(t.Min=s.Value))}}return t},this.GetFullRangeMaxMin=function(){var t={Min:null,Max:null};if(!sa.IsNonEmptyArray(this.Lines))return t;for(var e=0;e<this.Lines.length;++e){var a=this.Lines[e];if(sa.IsNonEmptyArray(a.Point))for(var i=0;i<a.Point.length;++i){var r=a.Point[i];(null==t.Max||t.Max<r.Value)&&(t.Max=r.Value),(null==t.Min||t.Min>r.Value)&&(t.Min=r.Value)}}return t}}function ye(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiPoint",this.PointGroup=[],this.IsHScreen=!1,this.LineWidth=1,this.PointRadius=5,this.MapCache=null,this.GetKValue=dt.GetKValue,this.GetItem=function(t){if(!this.MapCache||this.MapCache.size<=0)return null;var e=this.BuildKey(t);return this.MapCache.has(e)?this.MapCache.get(e):null},this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.PointGroup))for(var e=0;e<this.PointGroup.length;++e){var a=this.PointGroup[e];if(a&&sa.IsNonEmptyArray(a.Point)){var i={Color:a.Color,BGColor:a.BGColor,LineWidth:this.LineWidth,Radius:this.PointRadius,Name:a.Name};sa.IsNumber(a.PointRadius)&&(i.Radius=a.PointRadius),sa.IsNumber(a.LineWidth)&&(i.LineWidth=a.LineWidth);for(var r=0;r<a.Point.length;++r){var n=a.Point[r],o=this.BuildKey(n),s={Data:n,ColorConfig:i};if(t.has(o)){var h=t.get(o);h.Data.push(s)}else t.set(o,{Data:[s]})}}}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)&&sa.IsNonEmptyArray(this.PointGroup)&&this.MapCache&&!(this.MapCache.size<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.IsMinuteFrame(),r=this.GetBorder();if(this.IsHScreen){var n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx;r.TopEx}else n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,r.LeftEx;for(var s=new Map,h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<t;++h,++l,n+=e+a){var u=this.Data.Data[h],C=this.BuildKey(u);if(this.MapCache.has(C)){var D=this.MapCache.get(C);if(sa.IsNonEmptyArray(D.Data)){if(i)var f=this.ChartFrame.GetXFromIndex(l);else{var c=n,m=n+e;if(m>o)break;f=c+(m-c)/2}this.CalculateItem(D,u,f,s)}}}s.size<=0||(this.Canvas.save(),this.ClipClient(this.IsHScreen),this.DrawAllPoint(s),this.Canvas.restore())}},this.CalculateItem=function(t,e,a,i){for(var r=0;r<t.Data.length;++r){var n=t.Data[r],o=n.Data.Value;if(sa.IsString(n.Data.Value)&&(o=this.GetKValue(e,n.Data.Value)),sa.IsNumber(o)){var s=this.ChartFrame.GetYFromData(o,!1),h=JSON.stringify(n.ColorConfig);i.has(h)||i.set(h,{AryPoint:[]});var l=i.get(h);l.AryPoint.push({X:a,Y:s,Data:n})}}},this.DrawAllPoint=function(t){var e,a=F(),i=(0,l.default)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value,n=r[1].AryPoint;if(sa.IsNonEmptyArray(n)){for(var o=null,s=new Path2D,h=0,u=0;u<n.length;++u){var C=n[u];o||(o=C.Data.ColorConfig);var D=new Path2D;this.IsHScreen?D.arc(C.Y,C.X,o.Radius*a,0,360,!1):D.arc(C.X,C.Y,o.Radius*a,0,360,!1),s.addPath(D),++h}h>0&&o&&(o.BGColor&&(this.Canvas.fillStyle=o.BGColor,this.Canvas.fill(s)),o.Color&&(this.Canvas.lineWidth=o.LineWidth*a,this.Canvas.strokeStyle=o.Color,this.Canvas.stroke(s)))}}}catch(f){i.e(f)}finally{i.f()}},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;if(!this.MapCache||this.MapCache.size<=0)return t;for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0,r=0;a<this.Data.Data.length&&i<e;++a,++i){var n=this.Data.Data[a],o=this.BuildKey(n);if(this.MapCache.has(o)){var s=this.MapCache.get(o);if(sa.IsNonEmptyArray(s.Data))for(r=0;r<s.Data.length;++r){var h=s.Data[r],l=h.Data.Value;sa.IsString(h.Data.Value)&&(l=this.GetKValue(n,h.Data.Value)),sa.IsNumber(l)&&((null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>l)&&(t.Min=l))}}}return t}}function Re(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiText",this.Texts=[],this.Font=qi.DefaultTextFont,this.Color=qi.DefaultTextColor,this.IsHScreen=!1,this.MapCache=null,this.GetKValue=dt.GetKValue,this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.Texts))for(var e=0;e<this.Texts.length;++e){var a=this.Texts[e],i=this.BuildKey(a);if(t.has(i)){var r=t.get(i);r.Data.push(a)}else t.set(i,{Data:[a]})}},this.DrawAllText=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount;if(t)var n=this.ChartBorder.GetHScreenBorder(),o=n.BottomEx,s=n.TopEx,h=n.TopEx+i/2+qi.FrameLeftMargin,l=this.ChartBorder.GetTop(),u=this.ChartBorder.GetBottom(),C=n.RightEx,D=n.LeftEx;else n=this.ChartBorder.GetBorder(),h=n.LeftEx+i/2+qi.FrameLeftMargin,o=n.RightEx,s=n.LeftEx,l=this.ChartBorder.GetLeft(),u=this.ChartBorder.GetRight(),C=n.TopEx,D=n.BottomEx;for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<r;++f,++c,h+=a+i){var m=this.Data.Data[f];if(m){var d=this.BuildKey(m);if(this.MapCache.has(d)){var I=this.MapCache.get(d);if(sa.IsNonEmptyArray(I.Data)){if(e)var S=this.ChartFrame.GetXFromIndex(c);else{l=h,u=h+a;if(u>o)break;S=l+(u-l)/2}for(var T=0;T<I.Data.length;++T){var v=I.Data[T],p=C;if("TOP"==v.Value)p=C;else if("BOTTOM"==v.Value)p=D;else{var g=v.Value;sa.IsString(v.Value)&&(g=this.GetKValue(m,v.Value)),p=this.ChartFrame.GetYFromData(g,!1)}v.Color?this.Canvas.fillStyle=v.Color:this.Canvas.fillStyle=this.Color,v.Font?this.Canvas.font=v.Font:this.Canvas.font=this.Font;var x=this.Canvas.measureText(v.Text).width;if(this.Canvas.textAlign="center",S+x/2>=o?(this.Canvas.textAlign="right",S=o):S-x/2<s&&(this.Canvas.textAlign="left",S=s),1==v.Baseline?this.Canvas.textBaseline="top":2==v.Baseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle",this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(p,S),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(v.Text,0,0),this.Canvas.restore()):(sa.IsNumber(v.YMove)&&(p+=v.YMove),this.Canvas.fillText(v.Text,S,p)),v.Line){g="H"==v.Line.KData?m.High:m.Low;var F=this.ChartFrame.GetYFromData(g,!1),E=p;Array.isArray(v.Line.Offset)&&2==v.Line.Offset.length&&(E>F?(E-=v.Line.Offset[1],F+=v.Line.Offset[0]):E<F&&(E+=v.Line.Offset[1],F-=v.Line.Offset[0])),this.Canvas.save(),v.Line.Dash&&this.Canvas.setLineDash(v.Line.Dash),v.Line.Width>0&&(this.Canvas.lineWidth=v.Line.Width),this.Canvas.strokeStyle=v.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(E,A(S)),this.Canvas.lineTo(F,A(S))):(this.Canvas.moveTo(A(S),E),this.Canvas.lineTo(A(S),F)),this.Canvas.stroke(),this.Canvas.restore()}}}}}}},this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||this.Data&&sa.IsNonEmptyArray(this.Data.Data)&&sa.IsNonEmptyArray(this.Texts)&&(!this.MapCache||this.MapCache.size<=0||(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.save(),this.ClipClient(this.IsHScreen),this.DrawAllText(),this.Canvas.restore())))},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Texts)return t;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;if(!this.MapCache||this.MapCache.size<=0)return t;for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0,r=0;a<this.Data.Data.length&&i<e;++a,++i){var n=this.Data.Data[a],o=this.BuildKey(n);if(this.MapCache.has(o)){var s=this.MapCache.get(o);if(sa.IsNonEmptyArray(s.Data))for(r=0;r<s.Data.length;++r){var h=s.Data[r],l=h.Value;sa.IsString(h.Value)&&(l=this.GetKValue(n,h.Value)),sa.IsNumber(l)&&((null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>l)&&(t.Min=l))}}}return t}}function Ne(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiSVGIconV2",this.AryIcon,this.IconSize={Max:qi.DRAWICON.Icon.MaxSize,Min:qi.DRAWICON.Icon.MinSize,Zoom:{Type:qi.DRAWICON.Icon.Zoom.Type,Value:qi.DRAWICON.Icon.Zoom.Value}},this.Family,this.Color=qi.DefaultTextColor,this.IsHScreen=!1,this.IconRect=[],this.MapCache=null,this.GetKValue=dt.GetKValue,this.BuildKey=function(t){return sa.IsNumber(t.Time)?"".concat(t.Date,"-").concat(t.Time):t.Date},this.BuildCacheData=function(){var t=new Map;if(this.MapCache=t,sa.IsNonEmptyArray(this.AryIcon))for(var e=0;e<this.AryIcon.length;++e){var a=this.AryIcon[e],i=this.BuildKey(a);if(t.has(i)){var r=t.get(i);r.Data.push(a)}else t.set(i,{Data:[a]})}},this.ClipClient=function(t){if(1==t)var e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();else e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();this.Canvas.beginPath(),this.Canvas.rect(e,i,a-e,r-i),this.Canvas.clip()},this.Draw=function(){if(this.IconRect=[],this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&!this.IsShowIndexTitleOnly()&&!this.IsHideScriptIndex()&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)&&this.Family&&this.MapCache&&!(this.MapCache.size<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.IsMinuteFrame(),r=this.GetBorder();if(this.IsHScreen)var n=r.TopEx+a/2+qi.FrameLeftMargin,o=r.BottomEx,s=r.TopEx;else n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,s=r.LeftEx;this.Canvas.save(),this.ClipClient(this.ChartFrame.IsHScreen);var h=this.GetDynamicIconSize(e,a,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom);this.Canvas.font=h+"px "+this.Family;for(var l={Left:s,Right:o,FontSize:h,DataWidth:e,DistanceWidth:a},u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<t;++u,++C,n+=e+a){var D=this.Data.Data[u],f=this.BuildKey(D);if(this.MapCache.has(f)){var c=this.MapCache.get(f);if(i)var m=this.ChartFrame.GetXFromIndex(C);else{var d=n,I=n+e;if(I>o)break;m=d+(I-d)/2}this.DrawItem(c,D,m,l)}}this.Canvas.restore()}},this.DrawItem=function(t,e,a,i){if(sa.IsNonEmptyArray(t.Data))for(var r=i.FontSize,n=(i.Left,i.Right,i.DataWidth,0);n<t.Data.length;++n){var o=t.Data[n],s=o.Value;if(sa.IsString(o.Value)&&(s=this.GetKValue(e,o.Value)),sa.IsNumber(s)){var h=this.ChartFrame.GetYFromData(s,!1);if(o.Image){var l=o.Image.Height,u=o.Image.Width;if(this.IsHScreen){var C=a-u/2,D=h;D=1==o.Baseline?h-l:2==o.Baseline?h:h-l/2,sa.IsNumber(o.YMove)&&(D-=o.YMove,h-=o.YMove),this.Canvas.save(),this.Canvas.translate(D+u/2,C+l/2),this.Canvas.rotate(90*Math.PI/180),this.Canvas.drawImage(o.Image.Data,-u/2,-l/2,o.Image.Width,o.Image.Height),this.Canvas.restore()}else{var f=new gt(a-u/2,h-l/2,u,l);1==o.Baseline?f.Y=h:2==o.Baseline?f.Y=h-l:f.Y=h-l/2,sa.IsNumber(o.YMove)&&(h+=o.YMove,f.Y+=o.YMove),this.Canvas.drawImage(o.Image.Data,f.X,f.Y,o.Image.Width,o.Image.Height),(o.Text||sa.IsNonEmptyArray(o.AryText))&&this.IconRect.push({Rect:f,Item:o,KItem:e})}}else{o.Color?this.Canvas.fillStyle=o.Color:this.Canvas.fillStyle=this.Color,this.Canvas.textAlign="center";f=new gt(a-r/2,h-r/2,r,r);1==o.Baseline?(this.Canvas.textBaseline="top",f.Y=h):2==o.Baseline?(this.Canvas.textBaseline="bottom",f.Y=h-r):(this.Canvas.textBaseline="middle",f.Y=h-r/2),this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(h,a),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.Symbol,0,0),this.Canvas.restore()):(sa.IsNumber(o.YMove)&&(h+=o.YMove,f.Y+=o.YMove),this.Canvas.fillText(o.Symbol,a,h),(o.Text||sa.IsNonEmptyArray(o.AryText))&&this.IconRect.push({Rect:f,Item:o,KItem:e}))}if(o.Line){var c="H"==o.Line.KData?e.High:e.Low,m=this.ChartFrame.GetYFromData(c,!1),d=h;Array.isArray(o.Line.Offset)&&2==o.Line.Offset.length&&(d>m?(d-=o.Line.Offset[1],m+=o.Line.Offset[0]):d<m&&(d+=o.Line.Offset[1],m-=o.Line.Offset[0])),this.Canvas.save(),o.Line.Dash&&this.Canvas.setLineDash(o.Line.Dash),o.Line.Width>0&&(this.Canvas.lineWidth=o.Line.Width),this.Canvas.strokeStyle=o.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(d,A(a)),this.Canvas.lineTo(m,A(a))):(this.Canvas.moveTo(A(a),d),this.Canvas.lineTo(A(a),m)),this.Canvas.stroke(),this.Canvas.restore()}}}},this.GetTooltipData=function(t,e,a){if(!sa.IsNonEmptyArray(this.IconRect))return!1;for(var i=0;i<this.IconRect.length;++i){var r=this.IconRect[i];if(r.Rect){var n=r.Rect;if(n&&n.PtInRect(t,e))return u.Chart.Log("[ChartMultiSVGIconV2::GetTooltipData] icon ",r),a.Data=r,a.ChartPaint=this,a.Type=4,!0}}return!1},this.GetMaxMin=function(){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t={Min:null,Max:null};if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;if(this.MapCache&&!(this.MapCache.size<=0)){for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0,r=0;a<this.Data.Data.length&&i<e;++a,++i){var n=this.Data.Data[a],o=this.BuildKey(n);if(this.MapCache.has(o)){var s=this.MapCache.get(o);if(sa.IsNonEmptyArray(s.Data))for(r=0;r<s.Data.length;++r){var h=s.Data[r],l=h.Value;sa.IsString(h.Value)&&(l=this.GetKValue(n,h.Value)),sa.IsNumber(l)&&((null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>l)&&(t.Min=l))}}}return t}}}function we(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiHtmlDom",this.Texts=[],this.IsHScreen=!1,this.DrawCallback,this.DrawItem=[],this.EnableDraw=!0,this.HQChart,this.IsDestroy=!1,this.Draw=function(){this.EnableDraw&&(this.IsDestroy||(this.DrawItem=[],this.DrawCallback&&this.DrawCallback(1,{Self:this}),this.DrawDom(),this.DrawCallback&&this.DrawCallback(2,{Self:this,DrawItem:this.DrawItem})))},this.OnDestroy=function(){this.IsDestroy=!0,this.DrawCallback&&this.DrawCallback(4,{Self:this})},this.DrawDom=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetBottomEx(),r=F();if(this.HQChart)var n=this.HQChart.UIElement.getBoundingClientRect().left,o=this.HQChart.UIElement.getBoundingClientRect().top;else n=null,o=null;for(var s in this.Texts){var h=this.Texts[s];if(h.Text&&sa.IsNumber(h.Index)){var l=this.IsMinuteFrame(),u=h.Index-e,C=this.Data.Data[h.Index],D={KData:C,Item:h,IsShow:!1,Self:this};if(u>=0&&u<t){var f=this.ChartFrame.GetXFromIndex(u);if("Top"==h.Value)var c=a;else if("Bottom"==h.Value)c=i;else c=this.ChartFrame.GetYFromData(h.Value);D.X=f/r,D.Y=c/r,D.UIElement={Left:n,Top:o},D.IsShow=!0}if(this.DrawItem.push(D),this.DrawCallback&&this.DrawCallback(3,D),h.Line){if(l)var m=this.Data.Data[h.Index];else C=this.Data.Data[h.Index],m="H"==h.Line.KData?C.High:C.Low;var d=this.ChartFrame.GetYFromData(m),I=c;Array.isArray(h.Line.Offset)&&2==h.Line.Offset.length&&(I>d?(I-=h.Line.Offset[1],d+=h.Line.Offset[0]):I<d&&(I+=h.Line.Offset[1],d-=h.Line.Offset[0])),this.Canvas.save(),h.Line.Dash&&this.Canvas.setLineDash(h.Line.Dash);var S=F(),T=1*S;h.Line.Width>0&&(T=h.Line.Width*S),this.Canvas.lineWidth=T,this.Canvas.strokeStyle=h.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(I,A(f)),this.Canvas.lineTo(d,A(f))):(this.Canvas.moveTo(O(T,f),I),this.Canvas.lineTo(O(T,f),d)),this.Canvas.stroke(),this.Canvas.restore()}}}}},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var n=this.Texts[r];sa.IsNumber(n.Index)&&(n.Index>=a&&n.Index<i&&((null==t.Max||t.Max<n.Value)&&(t.Max=n.Value),(null==t.Min||t.Min>n.Value)&&(t.Min=n.Value)))}return t}}function Ae(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawSVG",this.Family,this.TextFont,this.Texts=[],this.IsHScreen=!1,this.IsDestroy=!1,this.EnableTooltip=!0,this.TooltipRect=[],this.ExcludeArea=null,this.AutoPosition=null,this.AryDrawRect=[],this.AutoYOffset=0,this.BuildKeyCallback=null,this.MapCache=null,this.AryDrawDetail=[],this.EnalbeDetailNoOverlap=!1,this.EnableClick=!1,this.PixelRatio=F(),this.SelectedItemCache=null,this.BuildKey=function(t){return this.BuildKeyCallback?this.BuildKeyCallback(t):sa.IsNumber(t.Time)?"".concat(t.Date,"-").concat(t.Time):"".concat(t.Date)},this.BuildCacheData=function(){var t=new Map;this.MapCache=t;for(var e=0;e<this.Texts.length;++e){var a=this.Texts[e],i=this.BuildKey(a);if(i)if(t.has(i)){var r=t.get(i);r.Data.push(a)}else t.set(i,{Date:a.Date,Time:a.Time,Data:[a]})}},this.Draw=function(){this.TooltipRect=[],this.AryDrawRect=[],this.AryDrawDetail=[],this.AutoYOffset=0,this.SelectedItemCache=null,this.IsShow&&!this.ChartFrame.IsMinSize&&this.IsVisible&&(this.IsShowIndexTitleOnly()||this.IsHideScriptIndex()||!this.MapCache||this.MapCache.size<=0||(this.DrawSVGV2(),this.EnalbeDetailNoOverlap&&this.DrawOnVerlapDetail(),this.DrawSelectedItem(),this.AryDrawDetail=[],this.SelectedItemCache=null))},this.DrawDetail=function(t,e,a){if(sa.IsNonEmptyArray(e.Content)){var i=this.IsSelectedItem(a),r=2,n=2,o=2,s={Left:t.Right,Right:t.Right,Bottom:t.Bottom},h=0;sa.IsNumber(e.ItemSpace)&&(o=e.ItemSpace),sa.IsNumber(e.YOffset)&&(s.Bottom+=e.YOffset),sa.IsNumber(e.XOffset)&&(s.Left+=e.XOffset),sa.IsNumber(e.LeftMargin)&&(r=e.LeftMargin),sa.IsNumber(e.RightMargin)&&(n=e.RightMargin),sa.IsNumber(e.RightBorder)&&(h=e.RightBorder),e.Font?this.Canvas.font=e.Font:this.Canvas.font=this.TextFont,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";var l=this.Canvas.measureText("擎").width+2;s.Height=l+5;for(var u=s.Bottom-(s.Height-l)/2,C=s.Left+r,D=[],f=0;f<e.Content.length;++f){D.length>0&&(C+=o);var c=e.Content[f];if(c.Text){var m=this.Canvas.measureText(c.Text).width+2;D.push({X:C,Y:u,Width:m,Data:c}),C+=m,s.Right=C}}s.Right+=n,s.Width=s.Right-s.Left,s.Top=s.Bottom-s.Height;var d=this.ChartBorder.GetChartWidth()-1;if(1==h&&(d=this.ChartBorder.GetRight()),s.Right>d){s.Right=t.Left,sa.IsNumber(e.XOffset)&&(s.Right-=e.XOffset),s.Left=s.Right-s.Width;for(C=s.Left+r,f=0;f<D.length;++f){f>0&&(C+=o);c=D[f];c.X=C,C+=c.Width}}i&&(this.SelectedItemCache.Detail={AryText:D,Rect:s,Data:a}),this.EnalbeDetailNoOverlap?this.AryDrawDetail.push({Rect:s,AryText:D,Data:a}):(i||this.DrawDetailText(e,D,s),this.AryDrawRect.push({Left:s.Left,Top:s.Top,Right:s.Right,Bottom:s.Bottom,Type:"Detail",Data:a}))}},this.DrawDetailText=function(t,e,a){if(t){t.Font?this.Canvas.font=t.Font:this.Canvas.font=this.TextFont,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",t.BGColor&&(this.Canvas.fillStyle=t.BGColor,this.Canvas.fillRect(a.Left,a.Top,a.Width,a.Height)),t.BorderColor&&(this.Canvas.strokeStyle=t.BorderColor,this.Canvas.strokeRect(A(a.Left),A(a.Top),b(a.Width),b(a.Height)));for(var i=0;i<e.length;++i){var r=e[i];this.Canvas.fillStyle=r.Data.Color,this.Canvas.fillText(r.Data.Text,r.X,r.Y)}}},this.DrawOnVerlapDetail=function(){if(sa.IsNonEmptyArray(this.AryDrawDetail))for(var t=this.AryDrawDetail.length-1;t>=0;--t){var e=this.AryDrawDetail[t],a=e.Rect;if(!this.IsRectOverlap(a)){var i=this.IsSelectedItem(e.Data);i||this.DrawDetailText(e.Data.Detail,e.AryText,a),this.AryDrawRect.push({Left:a.Left,Top:a.Top,Right:a.Right,Bottom:a.Bottom,Type:"Detail",Data:e.Data})}}},this.GetDetailPosition=function(t,e){if(!sa.IsNonEmptyArray(e.Content))return null;var a=2,i=2,r=2,n={Left:t.Right,Right:t.Right,Bottom:t.Bottom},o=0;sa.IsNumber(e.ItemSpace)&&(r=e.ItemSpace),sa.IsNumber(e.YOffset)&&(n.Bottom+=e.YOffset),sa.IsNumber(e.XOffset)&&(n.Left+=e.XOffset),sa.IsNumber(e.LeftMargin)&&(a=e.LeftMargin),sa.IsNumber(e.RightMargin)&&(i=e.RightMargin),sa.IsNumber(e.RightBorder)&&(o=e.RightBorder),e.Font?this.Canvas.font=e.Font:this.Canvas.font=this.TextFont;var s=this.Canvas.measureText("擎").width+2;n.Height=s+5;n.Bottom,n.Height;for(var h=n.Left+a,l=!0,u=0;u<e.Content.length;++u){l||(h+=r);var C=e.Content[u];if(C.Text){var D=this.Canvas.measureText(C.Text).width+2;h+=D,n.Right=h,l=!1}}n.Right+=i,n.Width=n.Right-n.Left,n.Top=n.Bottom-n.Height;var f=this.ChartBorder.GetChartWidth()-1;return 1==o&&(f=this.ChartBorder.GetRight()),n.Right>f&&(n.Right=t.Left,sa.IsNumber(e.XOffset)&&(n.Right-=e.XOffset),n.Left=n.Right-n.Width),n},this.CalculateShowPosition=function(t,e){var a=e.X,i=e.Y,r=t.SVG;sa.IsNumber(r.YOffset)&&(i+=r.YOffset);var n="".concat(r.Size,"px ").concat(this.Family);this.Canvas.font=n;var o=r.Size/2,s={Left:a-o,Right:a+o,Top:i-r.Size,Bottom:i,Height:r.Size,Width:r.Size};0===r.VAlign?(s.Top=i,s.Bottom=s.Top+r.Size):1===r.VAlign&&(s.Top=i-r.Size/2,s.Bottom=s.Top+r.Size),s.Top<0&&(s.Top=0,s.Bottom=r.Size,i=s.Bottom);var h=null;t.Detail&&(h=this.GetDetailPosition(s,t.Detail));var l=0,u=-5;sa.IsNumber(this.AutoPosition.MoveYStep)&&(u=-Math.abs(this.AutoPosition.MoveYStep));for(var C=0;C<20;++C){if(s&&!h){if(!this.IsRectOverlap(s))break}else if(s&&h&&!this.IsRectOverlap(s)&&!this.IsRectOverlap(h))break;if(l+=u,Math.abs(l)>=this.AutoPosition.MaxYOffset)break;s.Top+=u,s.Bottom+=u,h&&(h.Top+=u,h.Bottom+=u)}e.X=a,e.Y=i+l},this.IsRectOverlap=function(t){for(var e=0;e<this.AryDrawRect.length;++e){var a=this.AryDrawRect[e];if((t.Left>=a.Left&&t.Left<=a.Right||t.Right>=a.Left&&t.Right<=a.Right)&&(t.Top>=a.Top&&t.Top<=a.Bottom||t.Bottom>=a.Top&&t.Bottom<=a.Bottom))return!0}return!1},this.GetKValue=function(t,e){switch(e){case"HIGH":case"H":return t.High;case"L":case"LOW":return t.Low;case"C":case"CLOSE":return t.Close;case"O":case"OPEN":return KItem.Open;default:return null}},this.IsSelectedItem=function(t){return!!this.SelectedItemCache&&this.SelectedItemCache.ID==t.ID},this.DrawSVGV2=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)&&sa.IsNonEmptyArray(this.Texts)&&this.Family&&(this.IsHScreen=!0===this.ChartFrame.IsHScreen,!this.IsHScreen)){var t=this.ChartFrame.XPointCount,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.IsMinuteFrame(),r=this.GetBorder();if(this.PixelRatio=F(),this.IsHScreen);else var n=r.LeftEx+a/2+qi.FrameLeftMargin,o=r.RightEx,s=(r.LeftEx,r.TopEx),h=r.BottomEx;var l,u={};this.GetCacheData(Ft.CACHE_KEY.SELECTED,u)&&(this.SelectedItemCache={ID:u.Data.ID});for(var C=new Set,D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<t;++D,++f,n+=e+a){var c=this.Data.Data[D],m=this.BuildKey(c);if(!C.has(m)&&this.MapCache.has(m)){var d=this.MapCache.get(m);if(i)l=this.ChartFrame.GetXFromIndex(f);else{var I=n,S=n+e;if(S>o)break;l=I+(S-I)/2}for(var T=0;T<d.Data.length;++T){var v=d.Data[T];this.IsSelectedItem(v)&&(this.SelectedItemCache.Item=v,this.SelectedItemCache.KItem=c,this.SelectedItemCache.Index=D,this.SelectedItemCache.X=l,this.SelectedItemCache.Top=s,this.SelectedItemCache.Bottom=h),this.DrawSVGItem(v,c,D,l,s,h)}C.add(m)}}}},this.GetYFromData=function(t,e,a,i){if("Top"==t)return a;if("Bottom"==t)return i;var r;r=sa.IsString(t)?this.GetKValue(e,t):t;var n=this.ChartFrame.GetYFromData(r,!1);return n},this.DrawSVGItem=function(t,e,a,i,r,n){var o=this.GetYFromData(t.Value,e,r,n);sa.IsNumber(t.YOffset)&&(o+=t.YOffset);var s=t.SVG;if(sa.IsNumber(s.YOffset)&&(o+=s.YOffset),this.AutoPosition){var h={X:i,Y:o};this.CalculateShowPosition(t,h),i=h.X,o=h.Y}var l=this.IsSelectedItem(t),u="".concat(s.Size,"px ").concat(this.Family);this.Canvas.font=u;var C=s.Size/2,D="bottom",f={Left:i-C,Right:i+C,Top:o-s.Size,Bottom:o,Height:s.Size,Width:s.Size};if(0===s.VAlign?(D="top",f.Top=o,f.Bottom=f.Top+s.Size):1===s.VAlign&&(D="middle",f.Top=o-s.Size/2,f.Bottom=f.Top+s.Size),f.Top<0&&(f.Top=0,f.Bottom=s.Size,o=f.Bottom),l?(this.SelectedItemCache.RectSVG=f,this.SelectedItemCache.SVGConfig={Font:u,TextBaseline:D,X:i,Y:o}):(this.Canvas.textBaseline=D,this.Canvas.textAlign="center",this.Canvas.fillStyle=s.Color,this.Canvas.fillText(s.Symbol,i,o)),this.AryDrawRect.push({Left:f.Left,Top:f.Top,Right:f.Right,Bottom:f.Bottom,Type:"SVG",Data:t}),this.EnableTooltip&&this.TooltipRect.push({Rect:f,Index:a,Item:t}),!l&&t.Text&&t.Text.Content&&this.TextFont){var c=t.Text;this.Canvas.font=this.TextFont,this.Canvas.fillStyle=c.Color;var m=o;sa.IsNumber(c.YOffset)&&(m+=c.YOffset),this.Canvas.fillText(c.Content,i,m)}t.Detail&&this.DrawDetail(f,t.Detail,t),!l&&t.Line&&this.DrawVerticalLine(t,e,i,f,r,n)},this.DrawVerticalLine=function(t,e,a,i,r,n){if(t.Line){var o=t.Line,s=this.GetYFromData(o.Value,e,r,n);if(!(s>=i.Top&&s<=i.Bottom)){var h;s<i.Top?(h=i.Top,sa.IsNumber(o.SVGBlank)&&(h-=o.SVGBlank)):(h=i.Bottom,sa.IsNumber(o.SVGBlank)&&(h+=o.SVGBlank)),o.Dash&&this.Canvas.setLineDash(o.Dash);var l=1*this.PixelRatio;o.Width>0&&(l=o.Width*this.PixelRatio),this.Canvas.lineWidth=l,this.Canvas.strokeStyle=o.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(h,A(a)),this.Canvas.lineTo(s,A(a))):(this.Canvas.moveTo(O(l,a),h),this.Canvas.lineTo(O(l,a),s)),this.Canvas.stroke(),this.Canvas.setLineDash([])}}},this.DrawSelectedItem=function(){if(this.SelectedItemCache&&this.SelectedItemCache.Item){var t=this.SelectedItemCache,e=t.Item,a=t.KItem,i=t.Top,r=t.Bottom,n=t.RectSVG,o=e.SVG,s=t.SVGConfig,h=s.X,l=s.Y;if(this.Canvas.font=s.Font,this.Canvas.textBaseline=s.TextBaseline,this.Canvas.textAlign="center",this.Canvas.fillStyle=o.Color,this.Canvas.fillText(o.Symbol,s.X,s.Y),e.Text&&e.Text.Content&&this.TextFont){var u=e.Text;this.Canvas.font=this.TextFont,this.Canvas.fillStyle=u.Color;var C=l;sa.IsNumber(u.YOffset)&&(C+=u.YOffset),this.Canvas.fillText(u.Content,h,C)}e.Line&&this.DrawVerticalLine(e,a,h,n,i,r),t.Detail&&this.DrawDetailText(t.Item.Detail,t.Detail.AryText,t.Detail.Rect)}},this.GetMaxMin=function(){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t={Min:null,Max:null};if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;if(this.MapCache&&!(this.MapCache.size<=0)){for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0,r=0;a<this.Data.Data.length&&i<e;++a,++i){var n=this.Data.Data[a],o=this.BuildKey(n);if(this.MapCache.has(o)){var s=this.MapCache.get(o);if(sa.IsNonEmptyArray(s.Data))for(r=0;r<s.Data.length;++r){var h=s.Data[r],l=h.Value;sa.IsString(h.Value)&&(l=this.GetKValue(n,h.Value)),sa.IsNumber(l)&&((null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>l)&&(t.Min=l))}}}return t}},this.GetTooltipData=function(t,e,a){if(!this.IsShow)return!1;if(sa.IsNonEmptyArray(this.TooltipRect)){for(var i=this.TooltipRect.length-1;i>=0;--i){var r=this.TooltipRect[i];if(r.Rect){var n=r.Rect;if(t>=n.Left&&t<=n.Right&&e>=n.Top&&e<=n.Bottom){var o=r.Item;return u.Chart.Log("[ChartDrawSVG::GetTooltipData] svg icon.",r),a.Data={Rect:r.Rect,Item:o,Index:r.Index},a.ChartPaint=this,a.Type=7,o.Tooltip&&2==o.Tooltip.Ver&&(a.Type=8),!0}}}return!1}},this.ClickCell=function(t,e,a){if(!this.IsShow)return null;if(!this.EnableClick)return null;for(var i=this.TooltipRect.length-1;i>=0;--i){var r=this.TooltipRect[i];if(r.Rect){var n=r.Rect;if(t>=n.Left&&t<=n.Right&&e>=n.Top&&e<=n.Bottom){var o=r.Item,s=o.ID,h={Data:o,Redraw:!1,ChartPaint:this},l=null,u={};return this.GetCacheData(Ft.CACHE_KEY.SELECTED,u)&&(l=u.Data.ID),s!=l&&(this.SaveCacheData(Ft.CACHE_KEY.SELECTED,{ID:s}),h.Redraw=!0),h}}}return null}}function Oe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartOX",this.Font,this.Family=qi.ChartOX.Family,this.Color=[qi.ChartOX.Up.Color,qi.ChartOX.Down.Color],this.Text=[qi.ChartOX.Up.Text,qi.ChartOX.Down.Text],this.IsHScreen=!1,this.SquareSize=10,this.OXData=null,this.SquareLineColor=qi.ChartOX.SquareLineColor,this.TooltipData=[],this.CalcualteSquare=function(){if(this.IsHScreen)var t=this.ChartBorder.GetHScreenBorder(),e=t.LeftEx,a=t.RightEx;else t=this.ChartBorder.GetBorder(),e=t.TopEx,a=t.BottomEx;this.SquareSize=(a-e)/(this.OXData.Max-this.OXData.Min)*this.OXData.BlockSize;var i=parseInt(this.SquareSize);this.Font="".concat(i,"px ").concat(this.Family)},this.DrawSquares=function(){if(this.Canvas.beginPath(),this.Canvas.strokeStyle=this.SquareLineColor,this.IsHScreen)var t=this.ChartBorder.GetHScreenBorder(),e=t.Top,a=t.Bottom;else{t=this.ChartBorder.GetBorder(),e=t.Left,a=t.Right;var i=t.TopEx,r=t.BottomEx}for(var n=this.OXData.StartPrice;n<this.OXData.Max;n+=this.OXData.BlockSize){var o=this.ChartFrame.GetYFromData(n);this.IsHScreen?(this.Canvas.moveTo(A(o),t.Top),this.Canvas.lineTo(A(o),t.Bottom)):(this.Canvas.moveTo(e,A(o)),this.Canvas.lineTo(a,A(o)))}for(n=this.OXData.StartPrice;n>this.OXData.Min;n-=this.OXData.BlockSize){o=this.ChartFrame.GetYFromData(n);this.IsHScreen?(this.Canvas.moveTo(A(o),t.Top),this.Canvas.lineTo(A(o),t.Bottom)):(this.Canvas.moveTo(e,A(o)),this.Canvas.lineTo(a,A(o)))}for(var s=e+qi.FrameLeftMargin,h=s;h<a;h+=this.SquareSize)this.IsHScreen?(this.Canvas.moveTo(t.LeftEx,A(h)),this.Canvas.lineTo(t.RightEx,A(h))):(this.Canvas.moveTo(A(h),i),this.Canvas.lineTo(A(h),r));this.Canvas.stroke()},this.Draw=function(){if(this.TooltipData=[],!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.OXData&&this.OXData.Data)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.CalcualteSquare(),this.DrawSquares(),this.IsHScreen){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=t+qi.FrameLeftMargin;this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=this.Font;for(var i=0;i<this.OXData.Data.length;++i,a+=this.SquareSize){if(a>e)break;var r=this.OXData.Data[i];this.Canvas.fillStyle=this.Color[r.Type];var n=this.Text[r.Type];if(sa.IsNonEmptyArray(r.Data))for(var o=0;o<r.Data.length;++o){var s=r.Data[o],h=this.ChartFrame.GetYFromData(s+this.OXData.BlockSize/2);this.Canvas.fillText(n,h,a+this.SquareSize/2)}}}else{t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=t+qi.FrameLeftMargin;this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=this.Font;for(i=0;i<this.OXData.Data.length;++i,a+=this.SquareSize){if(a>e)break;r=this.OXData.Data[i];this.Canvas.fillStyle=this.Color[r.Type];n=this.Text[r.Type];var l={X:a,Width:this.SquareSize},u=null,C=null;if(sa.IsNonEmptyArray(r.Data)){for(o=0;o<r.Data.length;++o){s=r.Data[o],h=this.ChartFrame.GetYFromData(s+this.OXData.BlockSize/2);this.Canvas.fillText(n,a+this.SquareSize/2,h),(null==u||u<s)&&(u=s),(null==C||C>s)&&(C=s)}l.Y=this.ChartFrame.GetYFromData(u+this.OXData.BlockSize),l.Height=this.ChartFrame.GetYFromData(C)-l.Y;var D={Data:r,Rect:l};this.TooltipData.push(D)}}}},this.GetTooltipData=function(t,e,a){for(var i in this.TooltipData){var r=this.TooltipData[i];if(r.Rect){var n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return u.Chart.Log("[ChartOX::GetTooltipData] item ",r),a.Data=r,a.ChartPaint=this,a.Type=5,!0}}return!1},this.GetMaxMin=function(){var t={Min:null,Max:null};return this.OXData&&(sa.IsNumber(this.OXData.Max)&&(t.Max=this.OXData.Max),sa.IsNumber(this.OXData.Min)&&(t.Min=this.OXData.Min)),t}}function be(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartVolProfileVisibleRange",this.IsDrawFirst=!0,this.IsShowText=!0,this.VolType=0,this.BarPosition=1,this.BarWidthRate=.3,this.VolFont,this.HQChart,this.IsDestroy=!1,this.Data=null,this.MaxVol,this.MaxVolPrice,this.VolLineColor=qi.ChartVolProfileVisibleRange.VolLineColor,this.VolLineFont=qi.ChartVolProfileVisibleRange.VolLineFont,this.VolLineTextColor=qi.ChartVolProfileVisibleRange.VolLineTextColor,this.VAHLineColor=qi.ChartVolProfileVisibleRange.VAHLineColor,this.VAHTextColor=qi.ChartVolProfileVisibleRange.VAHTextColor,this.VALLineColor=qi.ChartVolProfileVisibleRange.VALLineColor,this.VALTextColor=qi.ChartVolProfileVisibleRange.VALTextColor,this.VAFont=qi.ChartVolProfileVisibleRange.VAFont,this.TextConfig=(0,h.default)({Color:qi.ChartVolProfileVisibleRange.Text.Color,Family:qi.ChartVolProfileVisibleRange.Text.Family,FontMaxSize:qi.ChartVolProfileVisibleRange.Text.FontMaxSize,FontMinSize:qi.ChartVolProfileVisibleRange.Text.FontMinSize},"Color",qi.ChartVolProfileVisibleRange.Text.Color),this.BarColor=[qi.ChartVolProfileVisibleRange.UpVolColor,qi.ChartVolProfileVisibleRange.DownVolColor,qi.ChartVolProfileVisibleRange.AreaUpColor,qi.ChartVolProfileVisibleRange.AreaDonwColor],this.MaxVolLine,this.OnDestroy=function(){this.IsDestroy=!0},this.SetOption=function(t){t&&(sa.IsBool(t.IsShowText)&&(this.IsShowText=t.IsShowText),sa.IsNumber(t.VolType)&&(this.IsShowText=t.VolType),sa.IsNumber(t.BarPosition)&&(this.BarPosition=t.BarPosition),sa.IsNumber(t.BarWidthRate)&&(this.IsShowText=t.BarWidthRate))},this.PtInChart=function(t,e){return this.MaxVolLine&&t>=this.MaxVolLine.Start.X&&t<=this.MaxVolLine.End.X&&e>=this.MaxVolLine.Start.Y-5&&e<this.MaxVolLine.Start.Y+5?{Identify:this.Identify,Chart:this}:null},this.SetSelectedStatus=function(t){this.IsDrawFirst=0==t},this.DrawSelectedStatus=function(){var t=this.SelectedRadius,e=F();if(this.Canvas.save(),this.MaxVolLine){this.Canvas.lineWidth=this.SelectedLineWidth*e,this.Canvas.strokeStyle=this.SelectedLineColor,this.SelectedBGColor&&(this.Canvas.fillStyle=this.SelectedBGColor);for(var a=(this.MaxVolLine.End.X-this.MaxVolLine.Start.X)/6,i=[],r=this.MaxVolLine.Start.X+a;r<this.MaxVolLine.End.X;r+=a)i.push({X:r,Y:this.MaxVolLine.Start.Y});for(var n=0;n<i.length;++n){var o=i[n];this.Canvas.beginPath(),this.Canvas.arc(o.X,o.Y,t,0,360,!1),this.Canvas.closePath(),this.SelectedBGColor&&this.Canvas.fill(),this.Canvas.stroke()}}this.Canvas.restore()},this.Draw=function(){this.VolFont=null,this.MaxVolLine=null,this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.ChartFrame.IsMinSize||(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&(this.Canvas.save(),this.DrawVolBar(),this.Canvas.restore()))},this.DrawPriceLine=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=F(),i=[],r=this.MaxVolPrice;sa.IsNumber(this.Data.MaxVolPrice)&&(r=this.Data.MaxVolPrice),r>=this.ChartFrame.HorizontalMin&&r<=this.ChartFrame.HorizontalMax&&i.push({Price:r,Font:this.VolLineFont,LineColor:this.VolLineColor,LineWidth:2,TextColor:this.VolLineTextColor,Type:1}),sa.IsNumber(this.Data.VAHPrice)&&this.Data.VAHPrice>=this.ChartFrame.HorizontalMin&&this.Data.VAHPrice<=this.ChartFrame.HorizontalMax&&i.push({Price:this.Data.VAHPrice,Font:this.VAFont,LineColor:this.VAHLineColor,LineWidth:2,TextColor:this.VAHTextColor,Type:2}),sa.IsNumber(this.Data.VALPrice)&&this.Data.VALPrice>=this.ChartFrame.HorizontalMin&&this.Data.VALPrice<=this.ChartFrame.HorizontalMax&&i.push({Price:this.Data.VALPrice,Font:this.VAFont,LineColor:this.VALLineColor,LineWidth:2,TextColor:this.VALTextColor,Type:3});for(var n=0;n<i.length;++n){var o=i[n],s=O(o.LineWidth,this.ChartFrame.GetYFromData(o.Price,!1));if(this.Canvas.lineWidth=o.LineWidth,this.Canvas.strokeStyle=o.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,s),this.Canvas.lineTo(e,s),this.Canvas.stroke(),1==o.Type&&(this.MaxVolLine={Start:{X:t,Y:s},End:{X:e,Y:s}}),this.ChartBorder.Right>10){var h=Jr(this.HQChart.Symbol),l=o.Price.toFixed(h);this.Canvas.font=o.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var u=this.GetFontHeight(),C=this.Canvas.measureText(l).width+2*a;this.Canvas.fillStyle=o.LineColor,this.Canvas.fillRect(e,s-u/2,C,u),this.Canvas.fillStyle=o.TextColor,this.Canvas.fillText(l,e+1*a,s)}}},this.DrawVolBar=function(){var t=this.GetPriceYOffset(this.Data.PriceOffset),e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=(this.ChartFrame.GetYFromData(this.Data.MaxPrice),this.ChartFrame.GetYFromData(this.Data.MinPrice),a-e),r=i*this.BarWidthRate;this.IsShowText&&(this.VolFont=this.GetDynamicVolTextFont(t,r),this.VolFont&&(this.Canvas.font=this.VolFont));for(var n=0;n<this.Data.Data.length;++n){var o=this.Data.Data[n];o.Price<this.ChartFrame.HorizontalMin||o.Price>this.ChartFrame.HorizontalMax||this.DrawVolBarItem(o,e,a,r,t)}this.DrawPriceLine()},this.DrawVolBarItem=function(t,e,a,i,r){var n=e,o=a,s=this.ChartFrame.GetYFromData(t.Price)-r/2,h=r-1;if(h<1&&(h=1),1==this.VolType){if(!t.TotalVol)return;if(!sa.IsNumber(t.TotalVol.Value))return;var l=t.TotalVol.Value*i/this.MaxVol;if(sa.IsNumber(t.TotalVol.ColorID)?D=this.BarColor[t.TotalVol.ColorID]:t.TotalVol.Color&&(D=t.TotalVol.Color),this.Canvas.fillStyle=D,1==this.BarPosition?this.Canvas.fillRect(o,b(s),-l,b(h)):this.Canvas.fillRect(n,b(s),l,b(h)),this.IsShowText&&this.VolFont){var u=sa.FormatVolString(t.TotalVol.Value,this.HQChart.LanguageID);this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,s+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,s+r/2))}}else{u="";for(var C=0;C<t.Vol.length;++C){var D,f=t.Vol[C];if(sa.IsNumber(f.Value))if(sa.IsNumber(f.ColorID)?D=this.BarColor[f.ColorID]:f.Color&&(D=f.Color),D){l=f.Value*i/this.MaxVol;this.Canvas.fillStyle=D,1==this.BarPosition?(this.Canvas.fillRect(o,b(s),-l,b(h)),o-=l):(this.Canvas.fillRect(n,b(s),l,b(h)),n+=l);var c=sa.FormatVolString(f.Value,this.HQChart.LanguageID);u.length>0&&(u+="x"),u+=c}}this.IsShowText&&this.VolFont&&(this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,s+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,s+r/2)))}},this.GetPriceYOffset=function(t){var e=this.ChartFrame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a},this.GetDynamicVolTextFont=function(t,e,a){var i=parseInt(t)-2;if(t<5&&(i=parseInt(t)),i>this.TextConfig.FontMaxSize?i=this.TextConfig.FontMaxSize:i<=0&&(i=1),i<this.TextConfig.FontMinSize)return null;var r=this.FormatFontString(i,this.TextConfig.Family,a);return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i="".concat(a.Weight," ").concat(t,"px ").concat(e)):i="".concat(t,"px ").concat(e),i},this.GetMaxMin=function(){return{Min:null,Max:null}}}function Be(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartStackedBar",this.Data,this.BarName=[],this.BarColor=["rgb(255,165,0)","rgb(95,158,160)"],this.LineWidth=1,this.BarType=0,this.IsHScreen,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount;if(this.IsHScreen)var i=this.ChartBorder.GetHScreenBorder(),r=i.TopEx+e/2+qi.FrameLeftMargin,n=i.BottomEx,o=i.RightEx,s=i.LeftEx;else{i=this.ChartFrame.GetBorder(),r=i.LeftEx+e/2+qi.FrameLeftMargin,n=i.RightEx,o=i.TopEx,s=i.BottomEx;var h=this.GetLockRect();h&&(n=h.Left)}var l=this.IsMinuteFrame();if(this.Canvas.save(),1==this.BarType);else{this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F());var u=this.Canvas.lineWidth}for(var C=this.ChartFrame.GetYFromData(0),D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<a;++D,++f,r+=t+e){var c=this.Data.Data[D];if(sa.IsNonEmptyArray(c)){if(l)var m=this.ChartFrame.GetXFromIndex(f);else{var d=r,I=r+t;if(I>n)break;m=d+(I-d)/2}if(m>n)break;1==this.BarType&&t>=4?this.DrawKBarItem(c,m,d,I,o,s,C,t):this.DrawBarItem(c,m,o,s,C,u)}}this.Canvas.restore()}},this.DrawKBarItem=function(t,e,a,i,r,n,o,s){for(var h=0,l=o,u=0,C=o,D=0;D<t.length;++D){var f=t[D];if(sa.IsNumber(f)&&0!=f){if(this.Canvas.fillStyle=this.BarColor[D],f>0){h+=f;var c=this.ChartFrame.GetYFromData(h),m={Left:a,Top:c,Width:s,Height:l-c};l=c}else{u+=f;c=this.ChartFrame.GetYFromData(u),m={Left:a,Top:c,Width:s,Height:C-c};C=c}this.IsHScreen?this.Canvas.fillRect(m.Top,m.Left,m.Height,m.Width):this.Canvas.fillRect(m.Left,m.Top,m.Width,m.Height)}}},this.DrawBarItem=function(t,e,a,i,r,n){e=O(n,e);for(var o=0,s=r,h=0,l=r,u=0;u<t.length;++u){var C=t[u];if(sa.IsNumber(C)&&0!=C){var D={};if(C>0){o+=C;var f=this.ChartFrame.GetYFromData(o);D={X:e,Y:s,X2:e,Y2:f};s=f}else{h+=C;f=this.ChartFrame.GetYFromData(h),D={X:e,Y:l,X2:e,Y2:f};l=f}this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(D.Y,D.X),this.Canvas.lineTo(D.Y2,D.X2)):(this.Canvas.moveTo(D.X,D.Y),this.Canvas.lineTo(D.X2,D.Y2)),this.Canvas.strokeStyle=this.BarColor[u],this.Canvas.stroke()}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&sa.IsNonEmptyArray(r)){for(var n=0,o=0,s=0;s<r.length;++s){var h=r[s];sa.IsNumber(h)&&(0!=h&&(h>0?n+=h:h<0&&(o+=h)))}null==e.Max&&(e.Max=n,e.Min=o),e.Max<n&&(e.Max=n),e.Min>o&&(e.Min=o)}}return e},this.PtInChart=function(t,e){var a={StackedBar:!0};return 0==this.BarType&&(a.BarWidth=4),this.PtInBar(t,e,a)},this.DrawSelectedStatus=function(){this.DrawLinePoint({StackedBar:!0})}}function Pe(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartLock",this.WidthDiv=.2,this.LockCount=20,this.BGColor=qi.IndexLock.BGColor,this.TextColor=qi.IndexLock.TextColor,this.Font=qi.IndexLock.Font,this.Title=qi.IndexLock.Title,this.LockRect=null,this.LockID,this.Callback,this.IndexName,this.MinWidth=null,this.Draw=function(t){if(this.LockRect=null,this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var e=this.ChartBorder.GetRight(),a=0;if(null!=this.ChartFrame.Data){var i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth;e=this.ChartBorder.GetLeft()+r/2+2;for(var n=this.ChartBorder.GetRight(),o=this.ChartFrame.XPointCount,s=this.ChartFrame.Data.DataOffset,h=0;s<this.ChartFrame.Data.Data.length&&h<o;++s,++h,e+=i+r){var l=this.ChartFrame.Data.Data[s];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=e+i;if(u>n)break}}a=(i+r)*this.LockCount}0==a&&(a=(e-this.ChartBorder.GetLeft())*this.WidthDiv);var C=e-a;C<this.ChartBorder.GetLeft()&&(C=this.ChartBorder.GetLeft());var D=this.ChartBorder.GetBottom()-this.ChartBorder.GetTop(),f=this.ChartBorder.GetRight()-C;if(this.MinWidth>10&&f<this.MinWidth&&(f=this.MinWidth,C=this.ChartBorder.GetRight()-f,C<this.ChartBorder.GetLeft()&&(C=this.ChartBorder.GetLeft())),t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(C,this.ChartBorder.GetTop(),f,D);var c=C+f/2,m=this.ChartBorder.GetTop()+D/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,c,m)}this.LockRect={Left:C,Top:this.ChartBorder.GetTop(),Width:f,Heigh:D}}else this.HScreenDraw(t)},this.HScreenDraw=function(t){var e=this.ChartBorder.GetBottom(),a=0;if(null!=this.ChartFrame.Data){var i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth;e=this.ChartBorder.GetTop()+r/2+2;for(var n=this.ChartBorder.GetBottom(),o=this.ChartFrame.XPointCount,s=this.ChartFrame.Data.DataOffset,h=0;s<this.ChartFrame.Data.Data.length&&h<o;++s,++h,e+=i+r){var l=this.ChartFrame.Data.Data[s];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=e+i;if(u>n)break}}a=(i+r)*this.LockCount}0==a&&(a=(e-this.ChartBorder.GetTop())*this.WidthDiv);var C=e-a;C<this.ChartBorder.GetTop()&&(C=this.ChartBorder.GetTop());var D=this.ChartBorder.GetRight()-this.ChartBorder.GetLeft(),f=this.ChartBorder.GetBottom()-C;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(this.ChartBorder.GetLeft(),C,D,f);var c=this.ChartBorder.GetLeft()+D/2,m=C+f/2;this.Canvas.save(),this.Canvas.translate(c,m),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore(),this.LockRect={Left:this.ChartBorder.GetLeft(),Top:C,Width:D,Heigh:f}},this.GetTooltipData=function(t,e,a){return null!=this.LockRect&&(this.Canvas.beginPath(),this.Canvas.rect(this.LockRect.Left,this.LockRect.Top,this.LockRect.Width,this.LockRect.Heigh),!!this.Canvas.isPointInPath(t,e)&&(a.Data={ID:this.LockID,Callback:this.Callback,IndexName:this.IndexName},a.ChartPaint=this,!0))}}function Ge(){this.newMethod=re,this.newMethod(),delete this.newMethod,this.ClassName="ChartBuySell",this.TextFont=qi.KLineTrain.Font,this.LastDataIcon=qi.KLineTrain.LastDataIcon,this.BuyIcon=qi.KLineTrain.BuyIcon,this.SellIcon=qi.KLineTrain.SellIcon,this.BuySellData=new Map,this.IconFont=qi.KLineTrain.IconFont,this.LastDataDrawType=0,this.LastDataIndex=-1,this.AddTradeItem=function(t){if(this.BuySellData.has(t.Key)){var e=this.BuySellData.get(t.Key);e.Data.push(t)}else this.BuySellData.set(t.Key,{Data:[t]})},this.ClearTradeData=function(){this.BuySellData=new Map},this.Draw=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();!0===t&&(i=this.ChartBorder.GetBottom());var r=this.ChartFrame.XPointCount;if(this.IconFont){var n=F(),o=e+a,s=18*n;o<s&&(o=s),this.Canvas.font=o+"px "+this.IconFont.Family}else this.Canvas.font=this.TextFont;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<r;++h,++l){var u=this.Data.Data[h];if(null!=u){var C=this.ChartFrame.GetXFromIndex(l);if(C>i)break;var D=!1;if(1==this.LastDataDrawType?h==this.LastDataIndex&&(D=!0):h==this.Data.Data.length-1&&(D=!0),D){C=this.ChartFrame.GetXFromIndex(l);var f=this.ChartFrame.GetYFromData(u.High);this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.IconFont?(this.Canvas.fillStyle=this.IconFont.Last.Color,this.DrawText(this.IconFont.Last.Text,C,f,t)):(this.Canvas.fillStyle=this.LastDataIcon.Color,this.Canvas.font=this.TextFont,this.DrawText(this.LastDataIcon.Text,C,f,t))}var c=h;if(this.BuySellData.has(c)){var m=this.BuySellData.get(c),d=(f=this.ChartFrame.GetYFromData(u.High),this.ChartFrame.GetYFromData(u.Low)),I=[!1,!1];for(var S in m.Data){if(1==I[0]&&1==I[1])break;var T=m.Data[S];0==T.Op&&0==I[0]?(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.IconFont?(this.Canvas.fillStyle=this.IconFont.Buy.Color,this.DrawText(this.IconFont.Buy.Text,C,d,t)):(this.Canvas.fillStyle=this.BuyIcon.Color,this.DrawText(this.BuyIcon.Text,C,d,t)),I[0]=!0):1==T.Op&&0==I[1]&&(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.IconFont?(this.Canvas.fillStyle=this.IconFont.Sell.Color,this.DrawText(this.IconFont.Sell.Text,C,f,t)):(this.Canvas.fillStyle=this.SellIcon.Color,this.DrawText(this.SellIcon.Text,C,f,t)),I[1]=!0)}}}}}}}function _e(){this.newMethod=Ft,this.newMethod(),delete this.newMethod,this.ClassName="ChartOrderbookDepth",this.Data=null,this.AskColor={Line:qi.DepthChart.AskColor.Line,Area:qi.DepthChart.AskColor.Area},this.BidColor={Line:qi.DepthChart.BidColor.Line,Area:qi.DepthChart.BidColor.Area},this.LineWidth=qi.DepthChart.LineWidth,this.Draw=function(){if(this.Data){var t=this.Canvas.lineWidth;this.Canvas.lineWidth=this.LineWidth*F(),this.DrawArea(this.Data.Bids,this.BidColor.Line,this.BidColor.Area,!0),this.DrawArea(this.Data.Asks,this.AskColor.Line,this.AskColor.Area,!1),this.Canvas.lineWidth=t}},this.DrawArea=function(t,e,a,i){var r=this.ChartFrame.VerticalRange,n=[];for(var o in t){var s=t[o];if(i){if(s.Price<r.Min)break}else if(s.Price>r.Max)break;var h=this.ChartFrame.GetXFromIndex(s.Price),l=this.ChartFrame.GetYFromData(s.Vol);n.push({X:h,Y:l})}if(!(n.length<=1)){var u=this.ChartBorder.GetLeft(),C=this.ChartBorder.GetBottom(),D=this.ChartBorder.GetRight();for(var o in this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){s=n[o];this.Canvas.lineTo(s.X,s.Y)}for(var o in this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.lineTo(i?u:D,C),this.Canvas.lineTo(n[0].X,C),this.Canvas.closePath(),this.Canvas.fillStyle=a,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){s=n[o];this.Canvas.lineTo(s.X,s.Y)}this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.strokeStyle=e,this.Canvas.stroke()}},this.GetMaxMin=function(){var t={Min:null,Max:null,XMin:null,XMax:null},e=this.ChartFrame.VerticalRange;for(var a in this.Data.Asks){var i=this.Data.Asks[a];if(i.Price>e.Max)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}for(var a in this.Data.Bids){i=this.Data.Bids[a];if(i.Price<e.Min)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}return t}}var Ve=new function(){this.DataMap=new Map([["FrameSplitPaint",{Create:function(){return new ze}}],["RectSelectPaint",{Create:function(){return new Je}}],["RectDragPaint",{Create:function(){return new Ze}}],["DragMovePaint",{Create:function(){return new ea}}],["SessionBreaksPaint",{Create:function(){return new aa}}],["FrameButtomToolbarPaint",{Create:function(){return new ia}}]]),this.SetCallbackDraw=new Set,this.Create=function(t){if(!this.DataMap.has(t))return null;var e=this.DataMap.get(t);return e.Create()},this.Add=function(t,e){this.DataMap.set(t,{Create:e.Create})},this.AddCallbackDrawClassName=function(t){t&&this.SetCallbackDraw.add(t)},this.IsCallbackDraw=function(t){return this.SetCallbackDraw.has(t)}};function He(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.Data,this.IsDynamic=!1,this.IsAnimation=!1,this.ClassName="IExtendChartPainting",this.SizeChange=!0,this.IsEraseBG=!1,this.DrawAfterTitle=!1,this.DrawAfterPicture=!1,this.IsCallbackDraw=!1,this.ID=N(),this.DrawPriority=null,this.Left=5,this.Right=5,this.Top=5,this.Bottom=5,this.GetPriority=function(){return sa.IsNumber(this.DrawPriority)?this.DrawPriority:this.IsDynamic||this.DrawAfterPicture?!1===this.DrawAfterTitle&&0==this.IsAnimation?He.DRAW_PRIORITY_ID.LEVEL_20:!0===this.DrawAfterTitle?He.DRAW_PRIORITY_ID.LEVEL_25:!0===this.IsAnimation?He.DRAW_PRIORITY_ID.LEVEL_35:(!0===this.DrawAfterPicture&&He.DRAW_PRIORITY_ID.LEVEL_50,He.DRAW_PRIORITY_ID.LEVEL_50):He.DRAW_PRIORITY_ID.LEVEL_10},this.Draw=function(){},this.SetOption=function(t){},this.GetFontHeight=function(t){return E(this.Canvas,t,"擎")},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){for(var n=this.Canvas.createLinearGradient(e,a,i,r),o=1/(t.length-1),s=0;s<t.length;++s){var h=s*o;n.addColorStop(h,t[s])}this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t}}function Ye(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.IsEraseBG=!0,this.DrawAfterTitle=!0,this.ClassName="KLineTooltipPaint",this.BorderColor=qi.TooltipPaint.BorderColor,this.BGColor=qi.TooltipPaint.BGColor,this.TitleColor=qi.TooltipPaint.TitleColor,this.DateTimeColor=qi.TooltipPaint.DateTimeColor,this.VolColor=qi.TooltipPaint.VolColor,this.AmountColor=qi.TooltipPaint.AmountColor,this.LatestPoint,this.ShowPosition=0,this.DrawPriority=He.DRAW_PRIORITY_ID.LEVEL_25,this.Left=1*F(),this.Top=5*F(),this.Width=50,this.Height=100,this.LineHeight=15*F(),this.LineSpace=2,this.Mergin={Left:2,Top:3,Bottom:5,Right:5},this.ExtendLineWidth=2,this.Font=[qi.TooltipPaint.TitleFont],this.HQChart,this.KLineTitlePaint,this.IsHScreen=!1,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.ReloadResource=function(t){this.BorderColor=qi.TooltipPaint.BorderColor,this.BGColor=qi.TooltipPaint.BGColor,this.TitleColor=qi.TooltipPaint.TitleColor,this.DateTimeColor=qi.TooltipPaint.DateTimeColor,this.VolColor=qi.TooltipPaint.VolColor,this.AmountColor=qi.TooltipPaint.AmountColor},this.GetLeft=function(){return this.IsHScreen?this.ChartBorder.GetRightEx()-this.Height-this.Top:0==this.ShowPosition?this.ChartBorder.GetLeft()+this.Left:this.ChartBorder.GetRight()-this.Width-this.Left},this.GetTop=function(){return this.IsHScreen?0==this.ShowPosition?this.ChartBorder.GetTop()+this.Left:this.ChartBorder.GetBottom()-this.Width-this.Left:this.ChartBorder.GetTopEx()+this.Top},this.IsEnableDraw=function(){if(!this.HQChart||!this.HQChart.TitlePaint||!this.HQChart.TitlePaint[0])return!1;if(this.HQChart.DragMode==I.CLICK_TOUCH_MODE_ID){if(0==this.HQChart.TouchStatus.CorssCursorShow)return!1}else if(this.HQChart.EnableClickModel){if(!1===this.HQChart.ClickModel.IsShowCorssCursor)return!1}else if(this.HQChart.VerticalDrag){if(this.HQChart.VerticalDrag.IsDrag)return!1}else if(!this.HQChart.IsOnTouch)return!1;return!this.HQChart.CurrentChartDrawPicture},this.Draw=function(){if(this.IsEnableDraw()){this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.KLineTitlePaint=this.HQChart.TitlePaint[0];var t=this.KLineTitlePaint.GetCurrentKLineData();if(t){var e=this.GetFormatTitle({Data:t});e&&sa.IsNonEmptyArray(e.AryText)&&(this.CalculateTooltipSize(e),this.CalculateShowPosition(),this.DrawBG(),this.DrawTooltipData(e),this.DrawBorder())}}},this.CalculateTooltipSize=function(t){this.Canvas.font=this.Font[0],this.LineHeight=this.Canvas.measureText("擎").width;for(var e=F(),a=0,i=0,r=0,n=0,o=0;o<t.AryText.length;++o){var s=t.AryText[o];a>0&&(a+=this.LineSpace);var h=0;if(s.Title){var l=this.Canvas.measureText(s.Title).width+2;i<l&&(i=l),h+=l}if(s.Text){l=this.Canvas.measureText(s.Text).width+2;r<l&&(r=l),h+=l}n<h&&(n=h),a+=this.LineHeight}return this.Height=a+(this.Mergin.Top+this.Mergin.Bottom)*e,this.Width=n+(this.Mergin.Left+this.Mergin.Right+this.ExtendLineWidth)*e,{Height:this.Height,Width:this.Width,MaxTitleWidth:i,MaxTextWidth:r}},this.CalculateShowPosition=function(){if(this.ShowPosition=0,this.LatestPoint)if(this.IsHScreen){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=t+e/2;this.LatestPoint.Y<a&&(this.ShowPosition=1)}else{var i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetWidth(),n=i+r/2;this.LatestPoint.X<n&&(this.ShowPosition=1)}},this.GetFormatTitle=function(t){if(t&&t.Data){var e,a=t.Data;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase());var i,r,n=Jr(this.HQChart.Symbol),o=Pr.GetVolUnit(e),s=[],h={AryText:s};D=sa.FormatDateString(a.Date),s.push({Text:D,Color:this.DateTimeColor});var l=this.HQChart.Period;if(dt.IsMinutePeriod(l,!0)&&sa.IsNumber(a.Time)?(D=sa.FormatTimeString(a.Time),s.push({Text:D,Color:this.DateTimeColor})):dt.IsSecondPeriod(l)&&sa.IsNumber(a.Time)?(D=sa.FormatTimeString(a.Time,"HH:MM:SS"),s.push({Text:D,Color:this.DateTimeColor})):dt.IsMilliSecondPeriod(l)&&sa.IsNumber(a.Time)&&(D=sa.FormatTimeString(a.Time,"HH:MM:SS.fff"),s.push({Text:D,Color:this.DateTimeColor})),sa.IsNumber(a.Open)&&(i=$i.GetText("Tooltip-Open",this.LanguageID),r=this.KLineTitlePaint.GetColor(a.Open,a.YClose),D=a.Open.toFixed(n),s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:r})),sa.IsNumber(a.High)&&(i=$i.GetText("Tooltip-High",this.LanguageID),r=this.KLineTitlePaint.GetColor(a.High,a.YClose),D=a.High.toFixed(n),s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:r})),sa.IsNumber(a.Low)&&(i=$i.GetText("Tooltip-Low",this.LanguageID),r=this.KLineTitlePaint.GetColor(a.Low,a.YClose),D=a.Low.toFixed(n),s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:r})),sa.IsNumber(a.Close)&&(i=$i.GetText("Tooltip-Close",this.LanguageID),r=this.KLineTitlePaint.GetColor(a.Close,a.YClose),D=a.Close.toFixed(n),s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:r})),i=$i.GetText("Tooltip-Increase",this.LanguageID),sa.IsNumber(a.YFClose)&&Pr.IsChinaFutures(e)){var u=(a.Close-a.YFClose)/a.YFClose*100;r=this.KLineTitlePaint.GetColor(u,0),D=u.toFixed(2)+"%"}else if(sa.IsNumber(a.YClose)){u=(a.Close-a.YClose)/a.YClose*100;r=this.KLineTitlePaint.GetColor(u,0),D=u.toFixed(2)+"%"}else D="--.--",r=this.KLineTitlePaint.GetColor(0,0);if(s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:r}),sa.IsNumber(a.Vol)){i=$i.GetText("Tooltip-Vol",this.LanguageID);var C=a.Vol;e&&Pr.IsSHSZ(e)&&(C/=100),D=sa.FromatIntegerString(C/o,2,this.LanguageID),s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:this.VolColor})}if(sa.IsNumber(a.Amount)){i=$i.GetText("Tooltip-Amount",this.LanguageID);var D=sa.FormatValueString(a.Amount,2,this.LanguageID);s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:this.AmountColor})}if(sa.IsNumber(a.FlowCapital)){D="--.--";if(i=$i.GetText("Tooltip-Exchange",this.LanguageID),0!=a.FlowCapital)u=a.Vol/a.FlowCapital*100,D=u.toFixed(2)+"%";s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:this.TitleColor})}if(Pr.IsFutures(e)&&sa.IsNumber(a.Position)){i=$i.GetText("Tooltip-Position",this.LanguageID);D=sa.FromatIntegerString(a.Position,2,this.LanguageID);s.push({Title:i,TitleColor:this.TitleColor,Text:D,Color:this.TitleColor})}return h}},this.DrawTooltipData=function(t){if(t&&sa.IsNonEmptyArray(t.AryText)){var e=F(),a=this.GetLeft()+2*e,i=this.GetTop()+3*e;if(this.IsHScreen){this.Canvas.save();var r=this.GetLeft()+this.Height,n=this.GetTop();this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),a=2*e,i=3*e}this.Canvas.textBaseline="top";var o=a+this.Width-this.Mergin.Right*e;a+=this.Mergin.Left*e,i+=this.Mergin.Top*e;for(var s=0;s<t.AryText.length;++s){var h=t.AryText[s];h.Title&&(this.Canvas.textAlign="left",this.Canvas.fillStyle=h.TitleColor,this.Canvas.fillText(h.Title,a,i)),h.Text&&(this.Canvas.textAlign="right",this.Canvas.fillStyle=h.Color,this.Canvas.fillText(h.Text,o,i)),i+=this.LineHeight+this.LineSpace}this.IsHScreen&&this.Canvas.restore()}},this.DrawBorder=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.strokeStyle=this.BorderColor,t?this.Canvas.strokeRect(A(e),A(a),this.Height,this.Width):this.Canvas.strokeRect(A(e),A(a),b(this.Width),b(this.Height))},this.DrawBG=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.fillStyle=this.BGColor,t?this.Canvas.fillRect(e,a,this.Height,this.Width):this.Canvas.fillRect(e,a,this.Width,this.Height)},this.SetOption=function(t){t&&(t.LineHeight>0&&(this.LineHeight=t.LineHeight*F()),t.BGColor&&(this.BGColor=t.BGColor),t.LanguageID>0&&(this.LanguageID=t.LanguageID),sa.IsNumber(t.LineSpace)&&(this.LineSpace=t.LineSpace),sa.IsNumber(t.ExtendLineWidth)&&(this.ExtendLineWidth=t.ExtendLineWidth),G(this.Mergin,t.Mergin))}}function ke(){this.newMethod=Ye,this.newMethod(),delete this.newMethod,this.ClassName="MinuteTooltipPaint",this.Left=1*F(),this.Top=1*F(),this.YClose,this.IsShowAveragePrice=!0,this.TitlePaint,this.GetTop=function(){if(this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder();return 0==this.ShowPosition?t.TopEx+this.Left:t.BottomEx-this.Width-this.Left}t=this.ChartBorder.GetBorder();return t.Top+this.Top},this.GetLeft=function(){if(this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder();return t.Right-this.Height-this.Top}t=this.ChartBorder.GetBorder();return 0==this.ShowPosition?t.LeftEx+this.Left:t.RightEx-this.Width-this.Left},this.Draw=function(){if(this.IsEnableDraw()&&(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.TitlePaint=this.HQChart.TitlePaint[0],this.TitlePaint)){var t,e=this.TitlePaint.PointInfo;if(e&&(2==e.ClientPos||3==e.ClientPos||e.ClientPos>=200&&e.ClientPos<=299||e.ClientPos>=300&&e.ClientPos<=399)){var a=this.TitlePaint.GetCurrentAuctionData();if(!a)return;t={Type:1,Data:a}}else{var i=this.TitlePaint.GetCurrentKLineData();if(!i)return;t={Type:0,Data:i}}var r=this.GetFormatTitle(t);r&&sa.IsNonEmptyArray(r.AryText)&&(this.CalculateTooltipSize(r),this.CalculateShowPosition(),this.DrawBG(),this.DrawTooltipData(r),this.DrawBorder())}},this.GetFormatTitle=function(t){if(t&&t.Data){var e,a,i,r,n;if(0==t.Type)e=t.Data,a=e.Close,i=e.Vol,r=e.Amount;else if(1==t.Type){if(e=t.Data.Data,!e)return;a=e.Price}this.HQChart.Symbol&&(n=this.HQChart.Symbol.toUpperCase());var o=Pr.IsFutures(n),s=Jr(this.HQChart.Symbol),h=Pr.GetVolUnit(n);this.YClose=this.TitlePaint.YClose,this.YClose=e.YClose,o&&sa.IsNumber(e.YClearing)&&(this.YClose=e.YClearing);var l,u=[],C={AryText:u};sa.IsNumber(e.Date)&&(m=sa.FormatDateString(e.Date),u.push({Text:m,Color:this.DateTimeColor})),sa.IsNumber(e.Time)&&(m=sa.FormatTimeString(e.Time),u.push({Text:m,Color:this.DateTimeColor})),sa.IsNumber(a)&&(l=$i.GetText("Tooltip-Price",this.LanguageID),f=this.TitlePaint.GetColor(a,this.YClose),m=a.toFixed(s),u.push({Title:l,TitleColor:this.TitleColor,Text:m,Color:f}));var D=!0;if((Pr.IsForeignExchange(n)||Pr.IsET(n)&&!Pr.IsETShowAvPrice(n)||Pr.IsShowAvPrice&&!Pr.IsShowAvPrice(n))&&(D=!1),D&&sa.IsNumber(e.AvPrice)&&this.IsShowAveragePrice){l=$i.GetText("Tooltip-AvPrice",this.LanguageID);var f=this.TitlePaint.GetColor(e.AvPrice,this.YClose);m=e.AvPrice.toFixed(s),u.push({Title:l,TitleColor:this.TitleColor,Text:m,Color:f})}if(sa.IsNumber(a)&&sa.IsNumber(this.YClose)){if(l=$i.GetText("Tooltip-Increase",this.LanguageID),0===this.YClose)m="--.--",f=this.TitleColor;else{var c=(a-this.YClose)/this.YClose*100;f=this.TitlePaint.GetColor(c,0),m=c.toFixed(2)+"%"}u.push({Title:l,TitleColor:this.TitleColor,Text:m,Color:f})}if(sa.IsNumber(i)){l=$i.GetText("Tooltip-Vol",this.LanguageID);var m=sa.FromatIntegerString(i/h,2,this.LanguageID);u.push({Title:l,TitleColor:this.TitleColor,Text:m,Color:this.VolColor})}if(sa.IsNumber(r)){l=$i.GetText("Tooltip-Amount",this.LanguageID);m=sa.FormatValueString(r,2,this.LanguageID);u.push({Title:l,TitleColor:this.TitleColor,Text:m,Color:this.AmountColor})}if(sa.IsNumber(e.Position)){l=$i.GetText("Tooltip-Position",this.LanguageID);m=sa.FormatValueString(e.Position,2,this.LanguageID);u.push({Title:l,TitleColor:this.TitleColor,Text:m,Color:this.TitleColor})}return C}}}function Xe(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.IsEraseBG=!0,this.DrawAfterTitle=!0,this.DrawPriority=He.DRAW_PRIORITY_ID.LEVEL_25,this.ClassName="MinuteLeftTooltipPaint",this.BorderColor=qi.PCTooltipPaint.BorderColor,this.BGColor=qi.PCTooltipPaint.BGColor,this.TitleColor=qi.PCTooltipPaint.TitleColor,this.DateTimeColor=qi.PCTooltipPaint.DateTimeColor,this.VolColor=qi.PCTooltipPaint.VolColor,this.AmountColor=qi.PCTooltipPaint.AmountColor,this.PositionColor=qi.PCTooltipPaint.PositionColor,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.TitlePaint,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchagneColor=qi.UnchagneTextColor,this.YClose,this.Mergin={Left:2,Top:3,Bottom:2,Right:2},this.LineHeight=15,this.FixedWidth,this.Font=qi.PCTooltipPaint.TitleFont,this.HQChart,this.SetOption=function(t){t.BGColor&&(this.BGColor=t.BGColor),t.LanguageID>0&&(this.LanguageID=t.LanguageID),sa.IsNumber(t.FixedWidth)&&(this.FixedWidth=t.FixedWidth)},this.ReloadResource=function(t){this.BorderColor=qi.PCTooltipPaint.BorderColor,this.BGColor=qi.PCTooltipPaint.BGColor,this.TitleColor=qi.PCTooltipPaint.TitleColor,this.DateTimeColor=qi.PCTooltipPaint.DateTimeColor,this.VolColor=qi.PCTooltipPaint.VolColor,this.AmountColor=qi.PCTooltipPaint.AmountColor,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchagneColor=qi.UnchagneTextColor,this.Font=qi.PCTooltipPaint.TitleFont},this.IsEnableDraw=function(){if(!this.HQChart||!this.HQChart.TitlePaint||!this.HQChart.TitlePaint[0])return!1;var t=this.HQChart.LastPoint;return!!t&&(!(this.HQChart.ChartCorssCursor&&!this.HQChart.ChartCorssCursor.IsShowCorss)&&this.HQChart.IsMouseOnClient(t.X,t.Y))},this.Draw=function(){if(this.IsEnableDraw()&&(!this.ChartFrame||!0!==this.ChartFrame.IsHScreen)&&(this.TitlePaint=this.HQChart.TitlePaint[0],this.TitlePaint)){var t,e=this.TitlePaint.PointInfo;if(e&&(2==e.ClientPos||3==e.ClientPos||e.ClientPos>=200&&e.ClientPos<=299||e.ClientPos>=300&&e.ClientPos<=399)){var a=this.TitlePaint.GetCurrentAuctionData();if(!a)return;t={Type:1,Data:a}}else{var i=this.TitlePaint.GetCurrentKLineData();if(!i)return;t={Type:0,Data:i}}this.YClose=this.TitlePaint.YClose;var r=this.GetForamtTitle(t);if(sa.IsNonEmptyArray(r)){this.Canvas.font=this.Font,this.Canvas.textBaseline="top",this.LineHeight=E(this.Canvas,null,"擎");var n=this.ChartBorder.GetBorder(),o=this.LineHeight*r.length*2,s={Left:1,Top:1,Right:n.Left};s.Bottom=s.Top+o,s.Width=s.Right-s.Left,s.Height=s.Bottom-s.Top,s.Height+=this.Mergin.Top+this.Mergin.Bottom,s.Bottom=s.Top+s.Height,sa.IsNumber(this.FixedWidth)&&(s.Width=this.FixedWidth),this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(s.Left,s.Top,s.Width,s.Height),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(A(s.Left),A(s.Top),b(s.Width),b(s.Height));var h=s.Left+s.Width-this.Mergin.Right,l=this.Mergin.Left+s.Left,u=this.Mergin.Top+s.Top,C={Left:l,Top:u,Right:h};C.Width=C.Right-C.Left;for(var D=0;D<r.length;++D){var f=r[D];this.DrawText(f,C)}}}},this.DrawText=function(t,e){this.Canvas.fillStyle=t.TitleColor,this.Canvas.textAlign="left",this.Canvas.fillText(t.Title,e.Left,e.Top),e.Top+=this.LineHeight,e.Bottom=e.Top+this.LineHeight,this.Canvas.textAlign="right",this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Text,e.Right,e.Top),e.Top+=this.LineHeight,e.Bottom=e.Top+this.LineHeight},this.GetForamtTitle=function(t){if(!t||!t.Data)return null;var e,a=[],i=!1;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase());var r=Jr(e);e&&(i=Pr.IsFutures(e));var n=Pr.GetVolUnit(e);if(0==t.Type){var o=t.Data;if(!o)return;this.YClose=o.YClose,i&&sa.IsNumber(o.YClearing)&&(this.YClose=o.YClearing);var s=this.FormatDate(o.Date);s&&a.push(s);s=this.ForamtTime(o.Time,"HH:MM","PCTooltip-Time");s&&a.push(s);s=this.ForamtPrice(o.Close,r,"PCTooltip-Price");s&&a.push(s);s=this.ForamtPrice(o.AvPrice,r,"PCTooltip-AvPrice");s&&a.push(s);s=this.ForamtIncrease(o.Close,"PCTooltip-Increase");s&&a.push(s);s=this.FormatVol(o.Vol/n,"PCTooltip-Vol");if(s&&a.push(s),sa.IsNumber(o.Amount)){s={Title:$i.GetText("PCTooltip-Amount",this.LanguageID),TitleColor:this.TitleColor,Text:sa.FromatIntegerString(o.Amount,2,this.LanguageID),TextColor:this.AmountColor};a.push(s)}if(i&&sa.IsNumber(o.Position)){s=this.FormatPosition(o.Position,"PCTooltip-Position");s&&a.push(s)}}else if(1==t.Type){o=t.Data.Data;if(!o)return;this.YClose=o.YClose,i&&sa.IsNumber(o.YClearing)&&(this.YClose=o.YClearing);s=this.FormatDate(o.Date);s&&a.push(s);var h="HH:MM:SS";1===o.Ver&&(h="HH:MM");s=this.ForamtTime(o.Time,h,"PCTooltip-Time");s&&a.push(s);s=this.ForamtPrice(o.Price,r,"PCTooltip-AC-Price");s&&a.push(s);s=this.ForamtIncrease(o.Price,"PCTooltip-AC-Increase");if(s&&a.push(s),sa.IsNonEmptyArray(o.Vol)){s=this.FormatVol(o.Vol[0]/n,"PCTooltip-AC-Vol");s&&a.push(s);s=this.FormatVol(o.Vol[1]/n,"PCTooltip-AC-NotMatchVol");s&&a.push(s)}}return a},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.FormatDate=function(t){if(!sa.IsNumber(t))return null;var e={Title:$i.GetText("PCTooltip-Date",this.LanguageID),TitleColor:this.TitleColor,Text:sa.FormatDateString(t,"MM-DD",this.LanguageID),TextColor:this.DateTimeColor};return e},this.ForamtTime=function(t,e,a){if(!sa.IsNumber(t))return null;var i={Title:$i.GetText(a,this.LanguageID),TitleColor:this.TitleColor,Text:sa.FormatTimeString(t,e,this.LanguageID),TextColor:this.DateTimeColor};return i},this.ForamtPrice=function(t,e,a){if(!sa.IsNumber(t))return null;var i={Title:$i.GetText(a,this.LanguageID),TitleColor:this.TitleColor,Text:t.toFixed(e),TextColor:this.GetColor(t,this.YClose)};return i},this.ForamtIncrease=function(t,e){if(!sa.IsNumber(t)||0==t)return null;var a=(t-this.YClose)/this.YClose*100,i={Title:$i.GetText(e,this.LanguageID),TitleColor:this.TitleColor,Text:a.toFixed(2)+"%",TextColor:this.GetColor(a,0)};return 0===this.YClose&&(i.Text="--.--",i.TextColor=this.TitleColor),i},this.FormatVol=function(t,e){if(!sa.IsNumber(t))return null;var a={Title:$i.GetText(e,this.LanguageID),TitleColor:this.TitleColor,Text:sa.FromatIntegerString(t,2,this.LanguageID),TextColor:this.VolColor};return a},this.FormatPosition=function(t,e){if(!sa.IsNumber(t))return null;var a={Title:$i.GetText(e,this.LanguageID),TitleColor:this.TitleColor,Text:t.toFixed(0),TextColor:this.PositionColor};return a}}function We(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.Left=80,this.Right=1,this.Top=1,this.Bottom=1,this.BorderColor=qi.FrameBorderPen,this.Symbol,this.Name,this.TitleFont=["14px 微软雅黑"],this.Draw=function(){var t=this.ChartBorder.GetRight()+this.Left,e=this.ChartBorder.GetChartWidth()-this.Right,a=this.Top+18,i=t+(e-t)/2;this.Symbol&&this.Name&&(this.Canvas.font=this.TitleFont[0],this.Canvas.textAlign="right",this.Canvas.textBaseline="bottom",this.Canvas.fillText(this.Symbol,i-2,a),this.Canvas.textAlign="left",this.Canvas.fillText(this.Name,i+2,a)),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.moveTo(t,a),this.Canvas.lineTo(e,a),this.Canvas.stroke(),a+=30,this.DrawBorder()},this.DrawBorder=function(){var t=this.ChartBorder.GetRight()+this.Left,e=this.ChartBorder.GetChartWidth()-this.Right,a=this.Top,i=this.ChartBorder.GetChartHeight()-this.Bottom;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,a,e-t,i-a)}}function Ue(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.Name="筹码分布",this.ClassName="StockChip",this.HQChart,this.PenBorder=qi.FrameBorderPen,this.ColorProfit="rgb(255,0,0)",this.ColorNoProfit="rgb(90,141,248)",this.ColorAveragePrice="rgb(0,139,0)",this.ColorBG="rgb(190,190,190)",this.PixelRatio=F(),this.ShowType=0,this.IsDynamic=!0,this.DrawPriority=He.DRAW_PRIORITY_ID.LEVEL_20,this.ClientRect={},this.Font=qi.StockChip.Font,this.InfoColor=qi.StockChip.InfoColor,this.DayInfoColor=qi.StockChip.DayInfoColor,this.LineHeight=16,this.Left=50*this.PixelRatio,this.IsShowX=!1,this.ShowXCount=3,this.Width=150*this.PixelRatio,this.CalculateType=0,this.PriceZoom=100,this.NotSupportMessage="不支持筹码图",this.Buttons=[],this.DefaultButton=P(qi.StockChip.DefaultButton),this.LongButton=P(qi.StockChip.LongButton),this.RecentButton=P(qi.StockChip.RecentButton),this.CloseButton=P(qi.StockChip.CloseButton),this.ButtonTooltip=P(qi.Buttons.Tooltip),this.DAY_COLOR=[["rgb(255,0,0)","rgb(255,128,128)","rgb(255,0,128)","rgb(255,100,0)","rgb(192,128,0)","rgb(255,192,0)"],["rgb(120,80,225)","rgb(160,160,225)","rgb(80,80,255)","rgb(120,120,255)","rgb(32,64,192)","rgb(0,64,128)"]],this.SetOption=function(t){t&&(t.ShowType>0&&(this.ShowType=t.ShowType),t.IsShowX&&(this.IsShowX=t.IsShowX),t.ShowXCount>0&&(this.ShowXCount=t.ShowXCount),t.Width>100&&(this.Width=t.Width*F()),t.CalculateType>0&&(this.CalculateType=t.CalculateType),sa.IsNumber(t.PriceZoom)&&(this.PriceZoom=t.PriceZoom))},this.ReloadResource=function(t){this.PenBorder=qi.FrameBorderPen,this.Font=qi.StockChip.Font,this.InfoColor=qi.StockChip.InfoColor,this.DayInfoColor=qi.StockChip.DayInfoColor,this.DefaultButton=P(qi.StockChip.DefaultButton),this.LongButton=P(qi.StockChip.LongButton),this.RecentButton=P(qi.StockChip.RecentButton),this.CloseButton=P(qi.StockChip.CloseButton),this.ButtonTooltip=P(qi.Buttons.Tooltip)},this.Draw=function(){this.PixelRatio=F();var t=A(this.ChartBorder.GetRight()+this.Left),e=A(this.ChartBorder.GetTop()),a=A(t+this.Width-1*this.PixelRatio),i=A(this.ChartBorder.GetBottom()),r=a-t,n=i-e;if(this.ClientRect={Left:t,Top:e,Width:r,Height:n},dt.IsTickPeriod(this.HQChart.Period)){this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor;var o=t+r/2,s=e+n/2;return this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.NotSupportMessage,o,s),void this.DrawBorder()}this.CalculateChip()?(this.DrawFrame(),this.DrawAllChip(),1!=this.ShowType&&2!=this.ShowType||this.DrawDayChip(),this.CalculateCast(),this.DrawChipInfo()):u.Chart.Log("[StockChip::Draw] no data"),this.DrawBorder(),this.SizeChange=!1},this.DrawChipInfo=function(){var t=this.ClientRect.Top+this.ClientRect.Height-1,e=this.ClientRect.Left+2,a=this.ClientRect.Left+this.ClientRect.Width;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";var i=this.LineHeight*F(),r="70%成本价 --.--";sa.IsNonEmptyArray(this.Data.Cast)&&(r="70%成本价"+this.Data.Cast[1].MinPrice.toFixed(2)+"-"+this.Data.Cast[1].MaxPrice.toFixed(2)+"集中"+this.Data.Cast[1].Rate.toFixed(2)+"%"),this.Canvas.fillText(r,e,t),t-=i,r="90%成本价 --.--",sa.IsNonEmptyArray(this.Data.Cast)&&(r="90%成本价"+this.Data.Cast[0].MinPrice.toFixed(2)+"-"+this.Data.Cast[0].MaxPrice.toFixed(2)+"集中"+this.Data.Cast[0].Rate.toFixed(2)+"%"),this.Canvas.fillText(r,e,t),t-=i,r="平均成本："+this.Data.ChipInfo.AveragePrice.toFixed(2)+"元",this.Canvas.fillText(r,e,t),t-=i,r=+this.Data.YPrice.toFixed(2)+"处获利盘："+this.Data.ChipInfo.YProfitRate.toFixed(2)+"%",this.Canvas.fillText(r,e,t),t-=i,r="获利比例：",this.Canvas.fillText(r,e,t);var n=this.Canvas.measureText(r).width+2,o=e+n,s=a-5-o;if(this.Canvas.strokeStyle=this.ColorNoProfit,this.Canvas.strokeRect(o,t-i,s,i),this.Canvas.strokeStyle=this.ColorProfit,this.Canvas.strokeRect(o,t-i,s*(this.Data.ChipInfo.ProfitRate/100),i),r=this.Data.ChipInfo.ProfitRate.toFixed(2)+"%",this.Canvas.textAlign="center",this.Canvas.fillText(r,o+s/2,t),t-=i,this.Canvas.textAlign="left",r="成本分布,日期："+sa.FormatDateString(this.Data.SelectData.Date),this.Data.SelectData.Time&&(r+=" "+sa.FormatTimeString(this.Data.SelectData.Time)),this.Canvas.fillText(r,e,t),t-=i,1==this.ShowType||2==this.ShowType){a=this.ClientRect.Left+this.ClientRect.Width-1;this.Canvas.textAlign="right";n=50;for(var h in this.Data.DayChip.sort((function(t,e){return e.Day-t.Day})),this.Data.DayChip){var l=this.Data.DayChip[h],u=0;this.Data.ChipInfo&&this.Data.ChipInfo.Vol>0&&(u=l.Vol/this.Data.ChipInfo.Vol*100),r=l.Day+"周期"+(1==this.ShowType?"前":"内")+"成本"+(sa.IsNumber(u)?u.toFixed(2)+"%":"--.--%"),0==h&&(n=this.Canvas.measureText(r).width+8),this.Canvas.fillStyle=l.Color,this.Canvas.fillRect(a-n,t-i,n,i),this.Canvas.fillStyle=this.DayInfoColor,this.Canvas.fillText(r,a,t),t-=i}}},this.DrawDayChip=function(){var t=this.HQChart.Frame.SubFrame[0].Frame;for(var e in this.Data.DayChip){var a=[],i=this.Data.DayChip[e].Chip;if(i){for(var r=0,n=0;n<i.length;++n){var o=i[n];if(o){r+=o;var s=(n+this.Data.MinPrice)/100,h=t.GetYFromData(s),l=o/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;a.push({X:l,Y:h})}}this.Data.DayChip[e].Vol=r,this.DrawArea(a,this.Data.DayChip[e].Color)}}},this.DrawToolbar=function(t,e){this.Buttons=[];this.ClientRect.Left;for(var a=this.ClientRect.Left+this.ClientRect.Width,i=this.ClientRect.Top+this.ChartBorder.TitleHeight/2,r=[{ID:S.CHIP_CLOSE,Style:this.CloseButton},{ID:S.CHIP_RECENT,Style:this.RecentButton,ShowType:2},{ID:S.CHIP_LONG,Style:this.LongButton,ShowType:1},{ID:S.CHIP_DEFULT,Style:this.DefaultButton,ShowType:0}],n=0;n<r.length;++n){var o=r[n],s=o.Style.Size,h=a-s-o.Style.MerginLeft,l="".concat(s,"px ").concat(o.Style.Family),u={Left:h,Top:i-s/2,Right:h+s+o.Style.MerginLeft,Bottom:i+s/2,Width:s+o.Style.MerginLeft,Height:s},C=o.Style.Color,D={ID:o.ID,Rect:u};this.ShowType==o.ShowType?(C=o.Style.SelectedColor,e&&t&&t.X>=u.Left&&t.X<u.Right&&t.Y>=u.Top&&t.Y<=u.Bottom&&(e.MouseOnToolbar={Rect:u,Item:D,Frame:this,Point:{X:t.X,Y:t.Y}})):t&&t.X>=u.Left&&t.X<u.Right&&t.Y>=u.Top&&t.Y<=u.Bottom&&(C=o.Style.MoveOnColor,e&&(e.MouseOnToolbar={Rect:u,Item:D,Frame:this,Point:{X:t.X,Y:t.Y}})),this.Canvas.fillStyle=C,this.Canvas.font=l,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(o.Style.Text,h,i),this.Buttons.push(D),a=h}},this.DrawToolbarTooltip=function(t){if(t){this.ClientRect.Left;var e=this.ClientRect.Left+this.ClientRect.Width,a="Toolbar-"+t.Item.ID,i=$i.GetText(a,0);if(i){var r=t.Rect,n=r.Left+r.Width/2;this.Canvas.font=this.ButtonTooltip.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var o=this.Canvas.measureText(i).width+8,s=this.GetFontHeight(),h=s+8,l=n-o/2,u=r.Top-h;u<0&&(u=r.Bottom+1),l+o>e&&(l=e-o-2),this.Canvas.fillStyle=this.ButtonTooltip.ColorBG,this.Canvas.fillRect(l,u,o,h),this.Canvas.fillStyle=this.ButtonTooltip.Color,this.Canvas.fillText(i,l+4,u+h/2)}}},this.PtInButtons=function(t,e){for(var a=0;a<this.Buttons.length;++a){var i=this.Buttons[a];if(i.Rect){var r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,r.Top,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return{ID:i.ID,Rect:r}}}return null},this.DrawAllChip=function(){for(var t=this.HQChart.Frame.SubFrame[0].Frame,e=this.Data.SelectData.Close,a=[],i=[],r=0,n=0,o=0,s=0,h=this.Data.YPrice,l=t.HorizontalMax,u=t.HorizontalMin,C=1,D=0;D<this.Data.AllChip.length;++D){var f=this.Data.AllChip[D];if(f){var c=(D+this.Data.MinPrice)/this.PriceZoom;r+=f,n+=c*f,c<h&&(s+=f),c<e&&(o+=f),c<=l&&c>=u&&C<f&&(C=f)}}this.Data.MaxVol=C;for(D=0;D<this.Data.AllChip.length;++D){f=this.Data.AllChip[D];if(f){c=(D+this.Data.MinPrice)/this.PriceZoom;if(!(c>l||c<u)){var m=t.GetYFromData(c),d=f/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;c<e?a.push({X:d,Y:m}):i.push({X:d,Y:m})}}}if(this.Data.ChipInfo={Vol:r,AveragePrice:n/r,ProfitVol:o,ProfitRate:r>0?o/r*100:0,YProfitRate:r>0?s/r*100:0},0==this.ShowType){this.DrawLines(a,this.ColorProfit),this.DrawLines(i,this.ColorNoProfit);var I=this.Data.ChipInfo.AveragePrice;I>0&&I<=l&&I>=u&&(I=I.toFixed(2),this.DrawAveragePriceLine(a,i,t.GetYFromData(I),this.ColorAveragePrice))}else this.DrawLines(a,this.ColorBG),this.DrawLines(i,this.ColorBG)},this.CalculateCast=function(){if(this.Data.ChipInfo&&this.Data.ChipInfo.Vol){for(var t=[{Start:.05,End:.95,MaxPrice:0,MinPrice:0,Rate:0},{Start:.15,End:.85,MaxPrice:0,MinPrice:0,Rate:0}],e=(this.Data.ChipInfo.AveragePrice,this.Data.ChipInfo.ProfitVol),a=0,i=0,r=0;i<this.Data.AllChip.length;++i){if(4==r)break;var n=this.Data.AllChip[i];if(!(n<=0)){var o=(i+this.Data.MinPrice)/this.PriceZoom;a+=n;var s=a/e;for(var h in t){var l=t[h];l.MinPrice<=0&&s>l.Start&&(l.MinPrice=o,++r),l.MaxPrice<=0&&s>l.End&&(l.MaxPrice=o,++r)}}}for(var i in t){var u=t[i],C=u.MaxPrice+u.MinPrice;C&&(u.Rate=Math.abs(u.MaxPrice-u.MinPrice)/C*100)}this.Data.Cast=t}},this.DrawArea=function(t,e){if(!(t.length<=0)){for(var a in this.Canvas.fillStyle=e,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,t[0].Y),t){var i=t[a];this.Canvas.lineTo(i.X,i.Y)}this.Canvas.lineTo(this.ClientRect.Left,t[t.length-1].Y),this.Canvas.fill()}},this.DrawLines=function(t,e){if(!(t.length<=0)){for(var a in this.Canvas.strokeStyle=e,this.Canvas.beginPath(),t){var i=t[a];this.Canvas.moveTo(this.ClientRect.Left,i.Y),this.Canvas.lineTo(i.X,i.Y)}this.Canvas.stroke()}},this.DrawAveragePriceLine=function(t,e,a,i){for(var r in t){var n=t[r];if(n.Y==a)return this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y),void this.Canvas.stroke()}for(var r in e){n=e[r];if(n.Y==a)return this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y),void this.Canvas.stroke()}},this.DrawBorder=function(){this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(this.ClientRect.Left,this.ClientRect.Top,this.ClientRect.Width,this.ClientRect.Height)},this.EvenlyDistribute=function(t,e){var a=e.Low,i=e.High,r=e.MaxPrice,n=e.MinPrice,o=1;if(i-a!=0){for(var s=e.Vol/(i-a),h=a;h<=i&&h<=r;++h){var l=h-n;t[l]+=s,o<t[l]&&(o=t[l])}e.MaxVol=o}},this.TriangleDistribute=function(t,e){for(var a=e.Low,i=e.High,r=(e.MaxPrice,e.MinPrice),n=1,o=3.1415926535,s=(i-a)/2+a,h=0,l=[],u=a+1,C=1;u<=s;++u,++C){var D=Math.tan(45*o/180)*C;h+=D,l.push({Index:u-r,Value:D})}for(u=i-1,C=1;u>s;--u,++C){D=Math.tan(45*o/180)*C;h+=D,l.push({Index:u-r,Value:D})}if(h>0){for(u=0;u<l.length;++u){var f=l[u];t[f.Index]+=f.Value*e.Vol/h,n<t[f.Index]&&(n=t[f.Index])}e.MaxVol=n}},this.CalculateDistribute=function(t,e){1==this.CalculateType?this.TriangleDistribute(t,e):this.EvenlyDistribute(t,e)},this.SendCalculateChipEvent=function(){var t=this.HQChart.GetEventCallback(m.ON_CALCULATE_CHIP_DATA);if(!t)return null;var e=this.HQChart.ChartPaint[0].Data,a=e.DataOffset+parseInt(this.HQChart.CursorIndex),i={Symbol:this.HQChart.Symbol,Period:this.HQChart.Period,KData:e,CurrentIndex:a,Y:this.HQChart.LastPoint.Y,HQChart:this.HQChart,ShowType:this.ShowType,CalculateType:this.CalculateType,PreventDefault:!1,Result:null};return t.Callback(t,i,this),i},this.CalculateChip=function(){if(!this.HQChart)return!1;if(!this.HQChart.FlowCapitalReady)return!1;var t=this.HQChart.Symbol;if(!t)return!1;var e=this.SendCalculateChipEvent();if(e&&e.PreventDefault)return e.Result;if(Pr.IsSHSZIndex(t))return!1;var a=this.HQChart.ChartPaint[0].Data,i=a.DataOffset+parseInt(this.HQChart.CursorIndex);i>=a.Data.length&&(i=a.Data.length-1);var r=a.Data[i],n=r.Close,o=this.HQChart.LastPoint.Y;o&&(n=this.HQChart.Frame.SubFrame[0].Frame.GetYData(o));for(var s,h,l,u=[],C=1,D=i;D>=0;--D){var f=a.Data[D],c=1;f.FlowCapital>0&&(c=f.Vol/f.FlowCapital),s=D==i?f.Vol*c:f.Vol*C;var m={Vol:s,High:f.High,Low:f.Low};u.push(m),C*=1-1*c,(!h||h<f.High)&&(h=f.High),(!l||l>f.Low)&&(l=f.Low)}if(!h||!l)return!0;var d=this.PriceZoom;h=parseInt(h*d),l=parseInt(l*d);for(var I=h-l,S=new Array,T=0;T<=I;++T)S.push(0);var v,p=[];if(2==this.ShowType){p=[{Day:100,Color:this.DAY_COLOR[1][5]},{Day:60,Color:this.DAY_COLOR[1][4]},{Day:30,Color:this.DAY_COLOR[1][3]},{Day:20,Color:this.DAY_COLOR[1][2]},{Day:10,Color:this.DAY_COLOR[1][1]},{Day:5,Color:this.DAY_COLOR[1][0]}];for(var g in u){f=u[g];var x=parseInt(f.High*d),F=parseInt(f.Low*d),E=f.Vol;if(x-F>0&&(E=f.Vol/(x-F)),!(E<=1e-9)){for(var L=0;L<p.length;++L)if(g==p[L].Day){p[L].Chip=S.slice(0);break}v={Low:F,High:x,Vol:f.Vol,MaxPrice:h,MinPrice:l},this.CalculateDistribute(S,v)}}}else if(1==this.ShowType){p=[{Day:5,Color:this.DAY_COLOR[0][0]},{Day:10,Color:this.DAY_COLOR[0][1]},{Day:20,Color:this.DAY_COLOR[0][2]},{Day:30,Color:this.DAY_COLOR[0][3]},{Day:60,Color:this.DAY_COLOR[0][4]},{Day:100,Color:this.DAY_COLOR[0][5]}];for(var M=u.length-1;M>=0;--M){f=u[M],x=parseInt(f.High*d),F=parseInt(f.Low*d),E=f.Vol;if(x-F>0&&(E=f.Vol/(x-F)),!(E<=1e-9)){for(L=0;L<p.length;++L)if(M==p[L].Day){p[L].Chip=S.slice(0);break}v={Low:F,High:x,Vol:f.Vol,MaxPrice:h,MinPrice:l},this.CalculateDistribute(S,v)}}}else for(var y in u){f=u[y],x=parseInt(f.High*d),F=parseInt(f.Low*d),E=f.Vol;x-F>0&&(E=f.Vol/(x-F)),E<=1e-9||(v={Low:F,High:x,Vol:f.Vol,MaxPrice:h,MinPrice:l},this.CalculateDistribute(S,v))}return!!v&&(this.Data={AllChip:S,MaxVol:v.MaxVol,MaxPrice:h,MinPrice:l,SelectData:r,DayChip:p,YPrice:n},!0)},this.DrawFrame=function(){if(0!=this.IsShowX&&!(this.Data.MaxVol<=0)){var t=1!==this.HQChart.Frame.SubFrame.length,e=this.HQChart.Frame.SubFrame[0].Frame,a=e.ChartBorder,i=A(a.GetBottomEx()+1);t||(i=this.ClientRect.Top+this.ClientRect.Height);var r=this.ClientRect.Left,n=r+this.ClientRect.Width;this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),t&&(this.Canvas.moveTo(r,i),this.Canvas.lineTo(n,i));var o=this.ShowXCount,s=this.Data.MaxVol,h=Math.floor(s/o);this.Canvas.font=this.Font,this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.InfoColor;F();for(var l=1;l<=o;++l){var u=h*l,C=u/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;if(C=A(C),l==o){this.Canvas.textAlign="right";var D=sa.FormatValueString(s,1);this.Canvas.fillText(D,C,i+2)}else{this.Canvas.moveTo(C,this.ClientRect.Top),this.Canvas.lineTo(C,i),this.Canvas.textAlign="center";D=sa.FormatValueString(u,1);var f=this.Canvas.measureText(D).width;this.Canvas.fillText(D,Math.floor(C-.25*f),i+2)}}this.Canvas.stroke()}}}function Ke(){this.newMethod=Ue,this.newMethod(),delete this.newMethod,this.Name="筹码分布手机版",this.ClassName="StockChipPhone",this.ShowType=0,this.DrawToolbar=function(t,e){},this.CloseButtonConfig=P(qi.StockChip.PhoneCloseButton),this.Draw=function(){if(this.Buttons=[],this.IsHScreen=1==this.ChartFrame.IsHScreen,this.PixelRatio=F(),this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder(),e=A(t.Left),a=A(t.Right),i=A(t.Bottom+this.Left),r=A(t.ChartHeight-2*this.PixelRatio);this.ClientRect={Left:e,Top:i,Right:a,Bottom:r},this.ClientRect.Width=this.ClientRect.Right-this.ClientRect.Left,this.ClientRect.Height=this.ClientRect.Bottom-this.ClientRect.Top}else{e=A(this.ChartBorder.GetRight()+this.Left),i=A(this.ChartBorder.GetTop()),a=A(e+this.Width-1*this.PixelRatio),r=A(this.ChartBorder.GetBottom());this.ClientRect={Left:e,Top:i,Right:a,Bottom:r},this.ClientRect.Width=this.ClientRect.Right-this.ClientRect.Left,this.ClientRect.Height=this.ClientRect.Bottom-this.ClientRect.Top}dt.IsTickPeriod(this.HQChart.Period)||this.CalculateChip()&&(this.DrawAllChip(),1!=this.ShowType&&2!=this.ShowType||this.DrawDayChip(),this.CalculateCast(),this.IsHScreen?this.DrawHScreenChipInfo():this.DrawChipInfo()),this.DrawBorder(),this.DrawCloseButton(),this.SizeChange=!1},this.DrawAllChip=function(){for(var t=this.HQChart.Frame.SubFrame[0].Frame,e=this.Data.SelectData.Close,a=[],i=[],r=0,n=0,o=0,s=0,h=this.Data.YPrice,l=t.HorizontalMax,u=t.HorizontalMin,C=1,D=0;D<this.Data.AllChip.length;++D){var f=this.Data.AllChip[D];if(f){var c=(D+this.Data.MinPrice)/this.PriceZoom;r+=f,n+=c*f,c<h&&(s+=f),c<e&&(o+=f),c<=l&&c>=u&&C<f&&(C=f)}}this.Data.MaxVol=C;for(D=0;D<this.Data.AllChip.length;++D){f=this.Data.AllChip[D];if(f){c=(D+this.Data.MinPrice)/this.PriceZoom;if(!(c>l||c<u)){if(this.IsHScreen)var m=t.GetYFromData(c,!1),d=f/this.Data.MaxVol*this.ClientRect.Height+this.ClientRect.Top;else m=t.GetYFromData(c,!1),d=f/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;c<e?a.push({X:d,Y:m}):i.push({X:d,Y:m})}}}if(this.Data.ChipInfo={Vol:r,AveragePrice:n/r,ProfitVol:o,ProfitRate:r>0?o/r*100:0,YProfitRate:r>0?s/r*100:0},0==this.ShowType){this.DrawLines(a,this.ColorProfit),this.DrawLines(i,this.ColorNoProfit);var I=this.Data.ChipInfo.AveragePrice;I>0&&I<=l&&I>=u&&(I=I.toFixed(2),this.DrawAveragePriceLine(a,i,t.GetYFromData(I),this.ColorAveragePrice))}else this.DrawLines(a,this.ColorBG),this.DrawLines(i,this.ColorBG)},this.DrawLines=function(t,e){if(sa.IsNonEmptyArray(t)){this.Canvas.strokeStyle=e,this.Canvas.beginPath();for(var a=0;a<t.length;++a){var i=t[a];this.IsHScreen?(this.Canvas.moveTo(i.Y,this.ClientRect.Top),this.Canvas.lineTo(i.Y,i.X)):(this.Canvas.moveTo(this.ClientRect.Left,i.Y),this.Canvas.lineTo(i.X,i.Y))}this.Canvas.stroke()}},this.DrawAveragePriceLine=function(t,e,a,i){for(var r=0;r<t.length;++r){var n=t[r];if(n.Y==a)return this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(n.Y,this.ClientRect.Top),this.Canvas.lineTo(n.Y,n.X)):(this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y)),void this.Canvas.stroke()}for(r=0;r<e.length;++r){n=e[r];if(n.Y==a)return this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(n.Y,this.ClientRect.Top),this.Canvas.lineTo(n.Y,n.X)):(this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y)),void this.Canvas.stroke()}},this.GetChipInfoTitle=function(){var t=[];if(dt.IsDayPeriod(this.HQChart.Period,!0)){var e={Title:"日期:",Text:sa.FormatDateString(this.Data.SelectData.Date)};t.push(e)}else if(dt.IsMinutePeriod(this.HQChart.Period,!0)){e={Title:"".concat(sa.FormatDateString(this.Data.SelectData.Date)," ").concat(sa.FormatTimeString(this.Data.SelectData.Time,"HH:MM"))};t.push(e)}e={Title:"集中度:",Text:"--.--%"};sa.IsNonEmptyArray(this.Data.Cast)&&(e.Text="".concat(this.Data.Cast[0].Rate.toFixed(2),"%")),t.push(e);e={Title:"90%成本:",Text:"--.--"};sa.IsNonEmptyArray(this.Data.Cast)&&(e.Text="".concat(this.Data.Cast[0].MinPrice.toFixed(2),"-").concat(this.Data.Cast[0].MaxPrice.toFixed(2))),t.push(e);e={Title:"平均成本：:",Text:"--.--"};if(this.Data.ChipInfo&&sa.IsNumber(this.Data.ChipInfo.AveragePrice)&&(e.Text="".concat(this.Data.ChipInfo.AveragePrice.toFixed(2))),sa.IsNumber(this.Data.YPrice)&&sa.IsNumber(this.Data.ChipInfo.YProfitRate)){e={Title:"".concat(this.Data.YPrice.toFixed(2),"获利:"),Text:"".concat(this.Data.ChipInfo.YProfitRate.toFixed(2),"%")};t.push(e)}if(this.IsHScreen){e={Title:"获利比例:",Text:"".concat(this.Data.ChipInfo.ProfitRate.toFixed(2),"%")};t.push(e)}else{e={Title:"获利比例:",Type:1};t.push(e)}return t},this.DrawHScreenChipInfo=function(){var t=this.GetChipInfoTitle();if(sa.IsNonEmptyArray(t)){this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";var e=this.ClientRect.Top+2*this.PixelRatio,a=this.ClientRect.Left+2*this.PixelRatio,i=(this.ClientRect.Bottom,this.LineHeight*F());this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180);for(var r=0,n=0,o=0;o<t.length;++o){var s=t[o];r=0;var h=s.TitleColor;s.TitleColor&&(h=s.TitleColor),this.Canvas.fillStyle=h,this.Canvas.fillText(s.Title,r,n);var l=this.Canvas.measureText(s.Title).width+4*this.PixelRatio;r=l;if(s.Text){h=s.TitleColor;s.TextColor&&(h=s.TextColor),this.Canvas.fillStyle=h,this.Canvas.fillText(s.Text,r,n)}n-=i}this.Canvas.restore()}},this.DrawChipInfo=function(){var t=this.GetChipInfoTitle();if(sa.IsNonEmptyArray(t)){var e=this.ClientRect.Top+this.ClientRect.Height-1,a=this.ClientRect.Left+2,i=this.ClientRect.Left+this.ClientRect.Width;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";for(var r=this.LineHeight*F(),n=e,o=0;o<t.length;++o){var s=t[o],h=s.TitleColor;s.TitleColor&&(h=s.TitleColor),this.Canvas.fillStyle=h,this.Canvas.fillText(s.Title,a,n);var l=this.Canvas.measureText(s.Title).width+4,u=a+l;if(s.Text){h=s.TitleColor;s.TextColor&&(h=s.TextColor),this.Canvas.fillStyle=h,this.Canvas.fillText(s.Text,u,n)}if(1==s.Type){var C=a+l+2,D=i-5-C;this.Canvas.strokeStyle=this.ColorNoProfit,this.Canvas.strokeRect(C,n-r,D,r),this.Canvas.strokeStyle=this.ColorProfit,this.Canvas.strokeRect(C,n-r,D*(this.Data.ChipInfo.ProfitRate/100),r);var f=this.Data.ChipInfo.ProfitRate.toFixed(2)+"%";this.Canvas.textAlign="center",this.Canvas.fillText(f,C+D/2,n)}n-=r}}},this.DrawDayChip=function(){if(sa.IsNonEmptyArray(this.Data.DayChip))for(var t=this.HQChart.Frame.SubFrame[0].Frame,e=0;e<this.Data.DayChip.length;++e){var a=[],i=this.Data.DayChip[e].Chip;if(i){for(var r=0,n=0;n<i.length;++n){var o=i[n];if(o){r+=o;var s=(n+this.Data.MinPrice)/100;if(this.IsHScreen)var h=t.GetYFromData(s),l=o/this.Data.MaxVol*this.ClientRect.Height+this.ClientRect.Top;else h=t.GetYFromData(s),l=o/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;a.push({X:l,Y:h})}}this.Data.DayChip[e].Vol=r,this.DrawArea(a,this.Data.DayChip[e].Color)}}},this.DrawArea=function(t,e){if(sa.IsNonEmptyArray(t)){if(this.Canvas.fillStyle=e,this.Canvas.beginPath(),this.IsHScreen){this.Canvas.moveTo(t[0].Y,this.ClientRect.Top);for(var a=0;a<t.length;++a){var i=t[a];this.Canvas.lineTo(i.Y,i.X)}this.Canvas.lineTo(t[t.length-1].Y,this.ClientRect.Top)}else{this.Canvas.moveTo(this.ClientRect.Left,t[0].Y);for(a=0;a<t.length;++a){i=t[a];this.Canvas.lineTo(i.X,i.Y)}this.Canvas.lineTo(this.ClientRect.Left,t[t.length-1].Y)}this.Canvas.fill()}},this.DrawCloseButton=function(){var t=this.CloseButtonConfig,e="".concat(t.Size,"px ").concat(t.Family),a=null;if(this.IsHScreen){var i=this.ChartBorder.GetHScreenBorder(),r=i.Left-2,n=i.ChartHeight-2,o=r-t.Size,s=n-t.Size;a={Left:o,Top:s,Bottom:n,Right:r};a.Width=a.Right-a.Left,a.Height=a.Bottom-a.Top}else{i=this.ChartBorder.GetBorder(),s=i.Bottom+2,n=s+t.Size,r=i.ChartWidth-2,o=r-t.Size,a={Left:o,Top:s,Bottom:n,Right:r};a.Width=a.Right-a.Left,a.Height=a.Bottom-a.Top}if(a){if(t.Border&&t.Border.BGColor&&(this.Canvas.fillStyle=t.Border.BGColor,this.Canvas.fillRect(a.Left,a.Top,a.Width,a.Height)),this.Canvas.fillStyle=t.Color,this.Canvas.font=e,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.IsHScreen){var h=t.Size/2,l=a.Left+h,u=a.Bottom-h;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t.Text,-h,h),this.Canvas.restore()}else this.Canvas.fillText(t.Text,a.Left,a.Bottom);var C={ID:S.CHIP_CLOSE,Rect:a};this.Buttons.push(C)}}}function ze(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="FrameSplitPaint",this.LineColor="rgb(255,0,0)",this.TextColor="rgb(255,0,0)",this.LineWidth=2,this.Font="bold "+18*F()+"px 微软雅黑",this.TextTopOffset=10*F(),this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.TextColor&&(this.TextColor=t.TextColor),t.Font&&(this.Font=t.Font),sa.IsNumber(t.LineWidth)&&(this.LineWidth=t.LineWidth),sa.IsNumber(t.TextTopOffset)&&(this.TextTopOffset=t.TextTopOffset))},this.Draw=function(){if(this.HQChart&&(0==this.HQChart.Period||1==this.HQChart.Period)&&this.HQChart.ChartPaint[0]){var t=this.HQChart.ChartPaint[0].Data;if(t&&(this.Data=t,this.ChartFrame&&this.ChartFrame.SubFrame)){var e=this.ChartFrame.SubFrame[0].Frame;if(e){var a=!0===e.IsHScreen,i=e.DataWidth,r=e.DistanceWidth,n=e.XPointCount,o=this.LineWidth*F();if(a)var s=this.ChartBorder.GetHScreenBorder(),h=s.TopEx+r/2+qi.FrameLeftMargin,l=s.BottomEx;else{s=this.ChartBorder.GetBorder(),h=s.LeftEx+r/2+qi.FrameLeftMargin,l=s.RightEx;var u=s.ChartHeight-s.TopTitle-5*F()}this.Canvas.save(),this.Canvas.lineWidth=o,this.Canvas.font=this.Font,this.Canvas.textAlign="center",this.Canvas.textBaseline="top";for(var C={Left:s.LeftEx,Top:O(o,s.TopTitle),Height:u,LineWidth:o},D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<n;++D,++f,h+=i+r){var c=this.Data.Data[D];if(c){var m=this.GetQuarter(c.Date);if(m){var d=h,I=h+i;if(I>l)break;var S=d+(I-d)/2;if(C.DateInfo){var T=C.DateInfo;T.Year!=m.Year||T.Quarter!=m.Quarter?(C.Right=S,this.DrawQuarter(C),C.Left=S,C.Right=null,C.DateInfo=m):C.Right=S}else C.DateInfo=m,C.Right=S}}}this.DrawQuarter(C),this.Canvas.restore()}}}},this.DrawQuarter=function(t){if(sa.IsNumber(t.Left)&&sa.IsNumber(t.Right)){var e=O(t.LineWidth,t.Left),a=O(t.LineWidth,t.Right),i=a-e;this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(e,t.Top,i,t.Height);var r=t.DateInfo,n=r.Year%100;if(n<10)var o="0"+n;else o=n.toString();var s="".concat(o,"年").concat(r.Quarter,"季度"),h=this.Canvas.measureText(s).width;if(h<i+5){var l=e+i/2,u=t.Top+this.TextTopOffset;this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(s,l,u)}}},this.GetQuarter=function(t){if(!sa.IsNumber(t))return null;var e=parseInt(t/1e4),a=parseInt(t%1e4/100);switch(a){case 1:case 2:case 3:var i=1;break;case 4:case 5:case 6:i=2;break;case 7:case 8:case 9:i=3;break;case 10:case 11:case 12:i=4;break;default:return null}return{Year:e,Month:a,Quarter:i}}}function Je(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="RectSelectPaint",this.LineColor=qi.RectSelect.LineColor,this.LineWidth=qi.RectSelect.LineWidth,this.LineDotted=qi.RectSelect.LineDotted,this.AreaColor=qi.RectSelect.AreaColor,this.SubAreaColor=qi.RectSelect.SubAreaColor,this.MarkConfig={Family:qi.RectSelect.Mark.Family,Text:qi.RectSelect.Mark.Text,Color:qi.RectSelect.Mark.Color,Size:qi.RectSelect.Mark.Size,IsShow:!1,Position:{Index:qi.RectSelect.Mark.Position.Index,Top:qi.RectSelect.Mark.Position.Top}},this.FirstPoint,this.SecondPoint,this.CenterPoint,this.PreventClose=!1,this.SpaceReselected=!1,this.SubClient={FirstPoint:null,SecondPoint:null,Start:null,End:null},this.StartDate,this.EndDate,this.CenterDate,this.HQChart,this.DragRect,this.ShowRangeText={Enable:!1,Position:0,Font:qi.RectSelect.RangeTextFont,Color:qi.RectSelect.RangeTextColor,BGColor:qi.RectSelect.RangeTextBGColor,SubPosition:0,SubFont:qi.RectSelect.RangeTextSubFont,SubColor:qi.RectSelect.RangeTextSubColor,SubBGColor:qi.RectSelect.RangeTextSubBGColor},this.BorderCache,this.IsOnlyOnePoint=!1,this.IsFullFrame=!1,this.SetOption=function(t){if(t){if(t.LineColor&&(this.LineColor=t.LineColor),t.AreaColor&&(this.AreaColor=t.AreaColor),sa.IsBool(t.SpaceReselected)&&(this.SpaceReselected=t.SpaceReselected),t.ShowRangeText){var e=t.ShowRangeText;sa.IsBool(e.Enable)&&(this.ShowRangeText.Enable=e.Enable),sa.IsNumber(e.Position)&&(this.ShowRangeText.Position=e.Position),sa.IsNumber(e.SubPosition)&&(this.ShowRangeText.SubPosition=e.SubPosition)}if(t.Mark){e=t.Mark;sa.IsBool(e.IsShow)&&(this.MarkConfig.IsShow=e.IsShow),e.Position&&(sa.IsNumber(e.Position.Index)&&(this.MarkConfig.Position.Index=e.Position.Index),e.Position.Top&&(this.MarkConfig.Position.Top=e.Position.Top))}}},this.ReloadResource=function(t){this.LineColor=qi.RectSelect.LineColor,this.LineWidth=qi.RectSelect.LineWidth,this.LineDotted=qi.RectSelect.LineDotted,this.AreaColor=qi.RectSelect.AreaColor,this.ShowRangeText.Font=qi.RectSelect.RangeTextFont,this.ShowRangeText.Color=qi.RectSelect.RangeTextColor,this.ShowRangeText.BGColor=qi.RectSelect.RangeTextBGColor},this.IsMinuteChart=function(){var t=this.HQChart.ClassName,e="MinuteChartContainer"==t||"MinuteChartHScreenContainer"==t;return e},this.GetKData=function(){if(!this.HQChart)return null;var t=this.IsMinuteChart(),e=null;if(t){if(!this.HQChart.SourceData)return null;e=this.HQChart.SourceData}else{if(!this.HQChart.ChartPaint[0])return null;if(e=this.HQChart.ChartPaint[0].Data,!e)return null}return e},this.GetPointCount=function(){var t=0;return this.FirstPoint&&++t,this.SecondPoint&&++t,t},this.DateToNumber=function(t,e){if(e)return sa.IsNumber(t.Date)?1e4*t.Date+t.Time:t.Time;var a=this.HQChart.Period;return dt.IsDayPeriod(a,!0)?t.Date:dt.IsMinutePeriod(a,!0)?1e4*t.Date+t.Time:dt.IsSecondPeriod(a)||dt.IsTickPeriod(a)?1e6*t.Date+t.Time:dt.IsMilliSecondPeriod(a)?1e9*t.Date+t.Time:null},this.GetSelectRectDataByOnePoint=function(){if(!this.FirstPoint)return null;var t=this.GetKData();if(!t)return null;for(var e=this.IsMinuteChart(),a=this.DateToNumber(this.FirstPoint,e),i={Start:null,End:null,Data:t},r=0;r<t.Data.length;++r){var n=t.Data[r];if(n){var o=this.DateToNumber(n,e);if(a==o)return i.Start=r,i.End=r,i}}return null},this.GetSelectRectData=function(){if(this.IsOnlyOnePoint)return this.GetSelectRectDataByOnePoint();if(!this.FirstPoint||!this.SecondPoint)return null;var t=this.GetKData();if(!t)return null;for(var e=this.IsMinuteChart(),a=this.DateToNumber(this.FirstPoint,e),i=this.DateToNumber(this.SecondPoint,e),r={Start:null,End:null,Data:t,Stock:{Symbol:this.HQChart.Symbol,Name:this.HQChart.Name}},n=0;n<t.Data.length;++n){var o=t.Data[n];if(o){var s=this.DateToNumber(o,e);if(a==s&&(r.Start=n),i==s&&(r.End=n),sa.IsNumber(r.Start)&&sa.IsNumber(r.End)){if(r.Start>r.End){var h=r.Start;r.Start=r.End,r.End=h}return r}}}return null},this.SortPoint=function(){var t=this.IsMinuteChart();if(this.CenterData=null,this.FirstPoint&&!this.SecondPoint)this.StartDate={Date:this.DateToNumber(this.FirstPoint,t),Index:0};else if(this.FirstPoint&&this.SecondPoint){var e=this.DateToNumber(this.FirstPoint,t),a=this.DateToNumber(this.SecondPoint,t);if(e<a?(this.StartDate={Date:e,Index:0},this.EndDate={Date:a,Index:1}):(this.StartDate={Date:a,Index:1},this.EndDate={Date:e,Index:0}),this.CenterPoint){var i=this.DateToNumber(this.CenterPoint,t);this.CenterDate={Date:i,Index:2}}if(this.SubClient.FirstPoint&&this.SubClient.SecondPoint){e=this.DateToNumber(this.SubClient.FirstPoint,t),a=this.DateToNumber(this.SubClient.SecondPoint,t);e<a?(this.SubClient.Start={Date:e,Index:3},this.SubClient.End={Date:a,Index:4}):(this.SubClient.Start={Date:a,Index:4},this.SubClient.End={Date:e,Index:3}),this.SubClient.End.Date<=this.StartDate.Date||this.SubClient.Start.Date>=this.EndDate.Date?(this.SubClient.Start=null,this.SubClient.End=null):(this.SubClient.Start.Date<this.StartDate.Date&&(this.SubClient.Start.Date=this.StartDate.Date),this.SubClient.End.Date>this.EndDate.Date&&(this.SubClient.End.Date=this.EndDate.Date))}}},this.GetCenterPoint=function(){if(!this.FirstPoint||!this.SecondPoint)return null;if(!sa.IsNumber(this.FirstPoint.DataIndex))return null;if(!sa.IsNumber(this.SecondPoint.DataIndex))return null;var t=this.FirstPoint.DataIndex-this.SecondPoint.DataIndex;if(Math.abs(t)<3)return null;var e=parseInt(this.FirstPoint.DataIndex+(this.SecondPoint.DataIndex-this.FirstPoint.DataIndex)/2);if(e<0)return null;var a=this.GetKData();if(!a||!a.Data)return null;var i=a.Data[e];return i?{Date:i.Date,Time:i.Time,DataIndex:e}:null},this.MovePoint=function(t){if(!this.FirstPoint||!this.SecondPoint)return!1;var e=this.GetKData();if(!e||!e.Data)return!1;var a=this.FirstPoint.DataIndex+t,i=e.Data[a];if(!i)return!1;var r={Date:i.Date,Time:i.Time,DataIndex:a};a=this.SecondPoint.DataIndex+t,i=e.Data[a];if(!i)return!1;var n={Date:i.Date,Time:i.Time,DataIndex:a};a=this.CenterPoint.DataIndex+t,i=e.Data[a];if(!i)return!1;var o={Date:i.Date,Time:i.Time,DataIndex:a};return this.FirstPoint=r,this.SecondPoint=n,this.CenterPoint=o,!0},this.MoveSubRect=function(t,e){if(!this.FirstPoint||!this.SecondPoint)return!1;if(!this.SubClient||!this.SubClient.FirstPoint||!this.SubClient.SecondPoint)return!1;var a=this.GetKData();if(!a||!a.Data)return!1;var i=Math.min(this.FirstPoint.DataIndex,this.SecondPoint.DataIndex),r=Math.max(this.FirstPoint.DataIndex,this.SecondPoint.DataIndex),n=this.SubClient.FirstPoint,o=this.SubClient.SecondPoint;if(this.SubClient.FirstPoint.DataIndex>this.SubClient.SecondPoint.DataIndex)n=this.SubClient.SecondPoint,o=this.SubClient.FirstPoint;var s=n.DataIndex,h=o.DataIndex;if(e){if(s<=i)return!1;s-=t,h-=t}else{if(o.DataIndex>=r)return!1;s+=t,h+=t}var l=!1;if(s!=n.DataIndex){n.DataIndex=s;var u=a.Data[s];n.Date=u.Date,n.Time=u.Time,l=!0}if(h!=n.DataIndex){o.DataIndex=h;u=a.Data[h];o.Date=u.Date,o.Time=u.Time,l=!0}return l},this.SetPoint=function(t,e){var a=null;if(e&&sa.IsNumber(e.DataIndex)&&(a=e.DataIndex),!e||!sa.IsNumber(e.Index))return this.IsOnlyOnePoint?(this.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0):this.FirstPoint?!this.SecondPoint&&(this.SecondPoint={Date:t.Date,Time:t.Time,DataIndex:a},this.CenterPoint=this.GetCenterPoint(),!0):(this.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0);switch(e.Index){case 0:return this.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},this.CenterPoint=this.GetCenterPoint(),!0;case 1:return this.SecondPoint={Date:t.Date,Time:t.Time,DataIndex:a},this.CenterPoint=this.GetCenterPoint(),!0;case 2:var i=a-this.CenterPoint.DataIndex;return Math.abs(i)>0&&this.MovePoint(i);case 3:return this.SubClient.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0;case 4:return this.SubClient.SecondPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0;default:return!1}},this.ClearPoint=function(){if(this.PreventClose)return!1;var t=!1;return this.FirstPoint&&(this.FirstPoint=null,t=!0),this.SecondPoint&&(this.SecondPoint=null,t=!0),this.SubClient.FirstPoint=null,this.SubClient.SecondPoint=null,t},this.Draw=function(){if(this.BorderCache=null,this.StartDate=null,this.EndDate=null,this.CenterDate=null,this.DragRect=[],this.SubClient.Start=null,this.SubClient.End=null,this.FirstPoint||this.SecondPoint){this.SortPoint();var t=this.GetKData();if(t&&(this.Data=t,this.ChartFrame&&this.ChartFrame.SubFrame)){var e=this.ChartFrame.SubFrame[0].Frame;if(e){var a=!0===e.IsHScreen,i=e.DataWidth,r=e.DistanceWidth,n=e.XPointCount;if(a){var o=e.GetBorder(),s=o.TopEx+r/2+qi.FrameLeftMargin;o.BottomEx;this.BorderCache=o}else{o=e.GetBorder();this.IsFullFrame&&(o=this.ChartFrame.ChartBorder.GetBorder());s=o.LeftEx+r/2+qi.FrameLeftMargin,o.RightEx,o.ChartHeight,o.TopTitle,F();var h=o.TopEx,l=o.BottomEx;this.BorderCache=o}this.Canvas.save();dt.IsDayPeriod(this.HQChart.Period,!0);for(var u=this.IsMinuteChart(),C=null,D=null,f=null,c=null,m=[],d=this.Data.DataOffset,I=0;d<this.Data.Data.length&&I<n;++d,++I,s+=i+r){var S=this.Data.Data[d];if(S){var T=s,v=s+i;if(u)var p=e.GetXFromIndex(I);else p=T+(v-T)/2;var g=this.DateToNumber(S,u);if(this.StartDate&&g==this.StartDate.Date&&(C={XIndex:d,X:p,Top:h,Bottom:l,PointIndex:this.StartDate.Index,Type:0,Item:S},m.push(C)),this.EndDate&&g==this.EndDate.Date&&(D={XIndex:d,X:p,Top:h,Bottom:l,PointIndex:this.EndDate.Index,Type:1,Item:S},m.push(D)),this.CenterDate&&g==this.CenterDate.Date){var x={XIndex:d,X:p,Top:h,Bottom:l,PointIndex:this.CenterDate.Index,Type:2,Item:S};m.push(x)}if(this.SubClient&&this.SubClient.Start&&this.SubClient.End&&(g==this.SubClient.Start.Date&&(this.SubClient.Start.Point={Date:g,X:p,Top:h,Bottom:l,KItem:S}),g==this.SubClient.End.Date&&(this.SubClient.End.Point={Date:g,X:p,Top:h,Bottom:l,kItem:S})),f?(c.Date=g,c.X=p):(f={Date:g,X:p,Top:h,Bottom:l},c={Date:g,X:p,Top:h,Bottom:l}),C&&D)break}}if(this.DrawLines(m),this.DrawArea(C,D,f,c,this.AreaColor),this.DrawMark(C,D),this.SubClient&&this.SubClient.Start&&this.SubClient.End&&(this.DrawArea(this.SubClient.Start.Point,this.SubClient.End.Point,f,c,this.SubAreaColor,4),this.SubClient.Start.Point)){S=this.SubClient.Start.Point;var E={X:S.X,Top:S.Top,Bottom:S.Bottom,PointIndex:S.DataIndex,Type:3,Item:S.KItem};m.push(E)}this.DrawRangeText(m),this.Canvas.restore()}}}},this.DrawRangeText=function(t){if(this.ShowRangeText&&0!=this.ShowRangeText.Enable)for(var e,a,i,r=this.BorderCache,n=this.IsMinuteChart(),o=this.HQChart.Period,s=0;s<t.length;++s){var h=t[s];if(0===h.Type||1==h.Type||3==h.Type){if(n){var l=sa.FormatDateString(h.Item.Date,"YYYY-MM-DD"),u=sa.FormatTimeString(h.Item.Time,"HH:MM");i="".concat(l," ").concat(u)}else{l=sa.FormatDateString(h.Item.Date,"YYYY-MM-DD"),u=null;dt.IsMinutePeriod(o,!0)?u=sa.FormatTimeString(h.Item.Time,"HH:MM"):(dt.IsSecondPeriod(o)||dt.IsTickPeriod(o))&&(u=sa.FormatTimeString(h.Item.Time,"HH:MM:SS")),i=u?"".concat(l," ").concat(u):l}if(3==h.Type){var C=this.ShowRangeText.SubPosition,D=this.ShowRangeText.SubBGColor,f=this.ShowRangeText.SubColor;this.Canvas.font=this.ShowRangeText.SubFont;var c=this.GetFontHeight()}else{C=this.ShowRangeText.Position,D=this.ShowRangeText.BGColor,f=this.ShowRangeText.Color;this.Canvas.font=this.ShowRangeText.Font;c=this.GetFontHeight()}var m=this.Canvas.measureText(i).width+4,d={Height:c,Width:m};0==h.Type||3==h.Type?m>h.X?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e=h.X+2,d.X=h.X):(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e=h.X-2,d.X=h.X-m):1==h.Type&&(m>r.Right-h.X?(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e=h.X-2,d.X=h.X-m):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e=h.X+2,d.X=h.X)),1==C?(a=h.Top+(h.Bottom-h.Top)/2,3==h.Type&&(a+=c),d.Y=a-c/2):2==C?(a=h.Bottom,d.Y=a-c/2):(a=h.Top,d.Y=a-c/2),D&&(this.Canvas.fillStyle=D,this.Canvas.fillRect(A(d.X),A(d.Y),b(d.Width),b(d.Height))),f&&(this.Canvas.fillStyle=f,this.Canvas.fillText(i,e,a,m))}}},this.DrawLines=function(t){if(sa.IsNonEmptyArray(t)){var e=this.LineWidth*F();this.Canvas.strokeStyle=this.LineColor,this.Canvas.lineWidth=e;for(var a=0;a<t.length;++a){var i=t[a],r=O(e,i.X);0==i.Type||1==i.Type?(this.LineDotted&&this.Canvas.setLineDash(this.LineDotted),this.Canvas.beginPath(),this.Canvas.moveTo(r,i.Top),this.Canvas.lineTo(r,i.Bottom),this.Canvas.stroke(),this.LineDotted&&this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(r,i.Top),this.Canvas.lineTo(r,i.Bottom),this.Canvas.stroke());var n=new gt(r-3,i.Top,10,i.Bottom-i.Top);this.DragRect[a]={Rect:n,PointIndex:i.PointIndex,Type:i.Type}}}},this.PtInPaint=function(t,e){if(!sa.IsNonEmptyArray(this.DragRect))return null;for(var a=0;a<this.DragRect.length;++a){var i=this.DragRect[a],r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return(0,h.default)({Index:a,PointIndex:i.PointIndex,Type:i.Type,Self:this},"Type",i.Type)}return null},this.DrawArea=function(t,e,a,i,r,n){var o;if(a&&i&&this.StartDate&&this.EndDate&&(t&&e?o=[t,e]:!t&&e?o=[a,e]:t&&!e?o=[t,i]:a.Date>this.StartDate.Date&&i.Date<this.EndDate.Date&&(o=[a,i]),o&&2==o.length)){var s=o[0],h=o[1],l=A(s.X),u=A(h.X),C=u-l,D=s.Bottom-s.Top;this.Canvas.fillStyle=r,this.Canvas.fillRect(l,s.Top,C,D);var f={X:l,Y:s.Top,Right:u,Bottom:s.Top+D,Width:C,Height:D};sa.IsNumber(n)&&this.DragRect.push({Rect:f,Type:n})}},this.DrawMark=function(t,e){if(t&&e&&this.ChartFrame&&this.ChartFrame.SubFrame){var a=this.ChartFrame.SubFrame[0].Frame;if(a&&this.MarkConfig){var i=this.MarkConfig;if(i.IsShow){var r="".concat(i.Size,"px ").concat(i.Family);this.Canvas.font=r;var n=null;switch(i.Position.Top){case"TopEx":n=a.ChartBorder.GetTopEx();break;case"Top":n=a.ChartBorder.GetTop();break;case"TopTitle":n=a.ChartBorder.GetTopTitle();break;default:return}var o=t.X,s=n;this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=i.Color,this.Canvas.fillText(i.Text,o,s)}}}}}function Ze(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="RectDragPaint",this.LineColor=qi.RectDrag.LineColor,this.LineWidth=qi.RectDrag.LineWidth,this.BGColor=qi.RectDrag.BGColor,this.ShowMode=0,this.EnableRButton=!1,this.EnableLButton=!1,this.FirstPoint,this.SecondPoint,this.IsClearCanvas=!0,this.IsEnable=function(){return this.EnableRButton||this.EnableLButton},this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.BGColor&&(this.BGColor=t.BGColor),sa.IsNumber(t.ShowMode)&&(this.ShowMode=t.ShowMode),sa.IsBool(t.EnableRButton)&&(this.EnableRButton=t.EnableRButton),sa.IsBool(t.EnableLButton)&&(this.EnableLButton=t.EnableLButton))},this.ReloadResource=function(t){this.LineColor=qi.RectDrag.LineColor,this.LineWidth=qi.RectDrag.LineWidth,this.BGColor=qi.RectDrag.BGColor},this.ClearPoint=function(){this.FirstPoint=null,this.SecondPoint=null,this.IsClearCanvas||this.Draw()},this.SetFirstPoint=function(t,e){this.FirstPoint={X:t,Y:e}},this.SetSecondPoint=function(t,e){this.SecondPoint={X:t,Y:e}},this.DrawSelectedBorderMode=function(t){this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(A(t.Left),A(t.Top),b(t.Width),b(t.Height))},this.DrawUnselectedMaskMode=function(t,e){if(this.BGColor){this.Canvas.save();var a=new Path2D;a.rect(e.Left,e.Top,e.Width,t.Top-e.Top);var i=new Path2D;i.rect(e.Left,t.Top,t.Left-e.Left,t.Height),a.addPath(i);var r=new Path2D;r.rect(t.Right,t.Top,e.Right-t.Right,t.Height),a.addPath(r);var n=new Path2D;n.rect(e.Left,t.Bottom,e.Width,e.Bottom-t.Bottom),a.addPath(n),this.Canvas.clip(a),this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(e.Left,e.Top,e.Width,e.Height),this.Canvas.restore()}this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(A(t.Left),A(t.Top),b(t.Width),b(t.Height))},this.DrawFullselectedMode=function(t,e){if(this.BGColor){this.Canvas.save();var a=new Path2D;a.rect(e.Left,e.Top,t.Left-e.Left,e.Height);var i=new Path2D;i.rect(t.Right,e.Top,e.Right-t.Right,e.Height),a.addPath(i),this.Canvas.clip(a),this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(e.Left,e.Top,e.Width,e.Height),this.Canvas.restore()}this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(A(t.Left),A(e.Top),b(t.Width),b(e.Height))},this.Draw=function(){if(this.IsEnable()&&this.HQChart){var t=this.HQChart.GetExtraCanvas(c.RectDragCanvasKey);if(t&&(this.Canvas=t.Canvas,this.HQChart.ClearCanvas(this.Canvas),this.IsClearCanvas=!0,this.FirstPoint||this.SecondPoint)){var e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetRight(),n={Left:i,Top:e,Right:r,Bottom:a};n.Width=n.Right-n.Left,n.Height=n.Bottom-n.Top;var o={Left:Math.min(this.FirstPoint.X,this.SecondPoint.X),Right:Math.max(this.FirstPoint.X,this.SecondPoint.X),Top:Math.min(this.FirstPoint.Y,this.SecondPoint.Y),Bottom:Math.max(this.FirstPoint.Y,this.SecondPoint.Y)};switch(o.Top<e?o.Top=e:o.Top>a&&(o.Top=a),o.Bottom<e?o.Bottom=e:o.Bottom>a&&(o.Bottom=a),o.Left<i?o.Left=i:o.Left>r&&(o.Left=r),o.Right<i?o.Right=i:o.Right>r&&(o.Right=r),o.Width=o.Right-o.Left,o.Height=o.Bottom-o.Top,this.ShowMode){case 1:this.DrawUnselectedMaskMode(o,n);break;case 2:this.DrawFullselectedMode(o,n);break;default:this.DrawSelectedBorderMode(o);break}this.IsClearCanvas=!1}}}}function Qe(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="DepthMapPaint",this.LineColor=qi.DepthMapPaint.LineColor,this.AreaColor=P(qi.DepthMapPaint.AreaColor),this.TextColor=qi.DepthMapPaint.TextColor,this.TextBGColor=qi.DepthMapPaint.TextBGColor,this.FrameID=0,this.ID=N(),this.IsDynamic=!1,this.IsCallbackDraw=!0,this.YRange,this.WidthRate=.8,this.IsShow=!0,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),sa.IsObjectExist(t.ID)&&(this.ID=t.ID),t.IsShowCorssCursor&&(this.IsShowCorssCursor=t.IsShowCorssCursor),sa.IsNumber(t.WidthRate)&&(this.WidthRate=t.WidthRate)},this.Draw=function(){if(this.Data&&sa.IsNonEmptyArray(this.Data)&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.SubFrame[this.FrameID].Frame,a=e.ChartBorder,i=a.GetHeightEx(),r=a.GetRight(),n=a.GetTopEx(),o=a.GetBottomEx(),s=this.ChartBorder.Right*this.WidthRate;if(t){r=a.GetBottom(),n=a.GetRight(),o=a.GetLeft();s=this.Width;s>this.ChartBorder.Bottom&&(s=this.ChartBorder.Bottom)}var h={Left:r,Top:n,Right:r+s,Bottom:o,Height:i,Width:s};this.YRange={Max:null,Min:0};for(var l=0;l<this.Data.length;++l){var u=this.Data[l];this.CalculateYRange(u,this.YRange)}for(l=0;l<this.Data.length;++l){u=this.Data[l];u.Height>0&&u.Height<=1?h.Height=i*u.Height:h.Height=i,1==u.Type?(h.Top=n,h.Bottom=n+h.Height,this.DrawUpArea(u,h)):2==u.Type?(h.Bottom=o,h.Top=h.Bottom-h.Height,this.DrawDownArea(u,h)):(h.Top=n,h.Bottom=o,this.DrawDefaultArea(u,h))}}},this.CalculateYRange=function(t,e){for(var a in t.Data){var i=t.Data[a];(null==e.Max||e.Max<i.Y)&&(e.Max=i.Y),(null==e.Min||e.Min>i.Y)&&(e.Min=i.Y)}},this.GetXFromData=function(t,e,a){var i=e.Width*(t-a.Min)/(a.Max-a.Min);return e.Left+i},this.GetYFromData=function(t,e,a,i){if(i){var r=e.Height*(t-a.Min)/(a.Max-a.Min);return e.Bottom-r}r=e.Height*(t-a.Min)/(a.Max-a.Min);return e.Top+r},this.DrawDefaultArea=function(t,e){for(var a=this.ChartFrame.SubFrame[this.FrameID].Frame,i=t.Range&&t.Range.Y?t.Range.Y:this.YRange,r=[],n=0;n<t.Data.length;++n){var o=t.Data[n],s=this.GetXFromData(o.Y,e,i);if(!(o.X>a.HorizontalMax||o.X<a.HorizontalMin)){var h=a.GetYFromData(o.X);r.push({X:s,Y:h})}}var l=t.LineColor?t.LineColor:this.LineColor,u=t.AreaColor?t.AreaColor:this.AreaColor;r.length>0&&(1==t.DrawType?this.DrawHLine(r,l,e):this.DrawLine(r,l,u,e))},this.DrawUpArea=function(t,e){var a=[];for(var i in t.Data){var r=t.Data[i],n=this.GetXFromData(r.Y,e,t.Range.Y),o=this.GetYFromData(r.X,e,t.Range.X,t.IsASC);a.push({X:n,Y:o})}var s=t.LineColor?t.LineColor:this.LineColor,h=t.AreaColor?t.AreaColor:this.AreaColor;a.length>0&&this.DrawLine(a,s,h,e)},this.DrawDownArea=function(t,e){var a=[];for(var i in t.Data){var r=t.Data[i],n=this.GetXFromData(r.Y,e,t.Range.Y),o=this.GetYFromData(r.X,e,t.Range.X,t.IsASC);a.push({X:n,Y:o})}var s=t.LineColor?t.LineColor:this.LineColor,h=t.AreaColor?t.AreaColor:this.AreaColor;a.length>0&&this.DrawLine(a,s,h,e)},this.DrawHLine=function(t,e,a){var i=!0===this.ChartFrame.IsHScreen;this.Canvas.strokeStyle=e,this.Canvas.beginPath();for(var r=0,n=0;n<t.length;++n){var o=t[n];i||(this.Canvas.moveTo(a.Left,o.Y),this.Canvas.lineTo(o.X,o.Y)),++r}r>0&&this.Canvas.stroke()},this.DrawLine=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=!0,o=0;for(var s in this.Canvas.strokeStyle=e,t){var h=t[s];n?(this.Canvas.beginPath(),r?this.Canvas.moveTo(h.Y,h.X):this.Canvas.moveTo(h.X,h.Y),n=!1):r?this.Canvas.lineTo(h.Y,h.X):this.Canvas.lineTo(h.X,h.Y),++o}o>0&&this.Canvas.stroke();var l=t[0],u=t[t.length-1];if(r?(this.Canvas.lineTo(u.Y,i.Left),this.Canvas.lineTo(l.Y,i.Left)):(this.Canvas.lineTo(i.Left,u.Y),this.Canvas.lineTo(i.Left,l.Y)),this.Canvas.closePath(),Array.isArray(a))if(r){var C=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());C.addColorStop(0,a[0]),C.addColorStop(1,a[1]),this.Canvas.fillStyle=C}else{var D=this.Canvas.createLinearGradient(i.Right,i.Top,i.Left,i.Top),f=1/a.length;for(s=0;s<a.length;++s)D.addColorStop(s*f,a[s]);this.Canvas.fillStyle=D}else this.Canvas.fillStyle=a;this.Canvas.fill()},this.GetYValueByXValue=function(t,e){for(var a=[],i=0,r=Ta[e],n=0;n<this.Data.length;++n){var o=this.Data[n];if(0==o.Type&&o.Data&&!(o.Data.length<0)&&0!=o.IsShowCorssCursor){for(var s=!1,h=0;h<o.Data.length;++h){var l=o.Data[h];if(i=parseInt(l.X*r),i==t){s=!0;var u={X:l.X,Y:l.Y,TextColor:o.TextColor?o.TextColor:this.TextColor,TextBGColor:o.TextBGColor?o.TextBGColor:this.TextBGColor};l.YText&&(u.YText=l.YText),a.push(u);break}}if(!s){var C=o.Data[0],D=o.Data[o.Data.length-1];t>C.X*r&&t<D.X*r&&a.push({X:null,Y:null,TextColor:o.TextColor?o.TextColor:this.TextColor,TextBGColor:o.TextBGColor?o.TextBGColor:this.TextBGColor})}}}return a}}function qe(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="KLineYAxisBGPaint",this.SplitData=[],this.Font=qi.KLineYAxisBGPaint.Font,this.FrameID=0,this.ID=N(),this.IsDynamic=!1,this.IsCallbackDraw=!0,this.IsShow=!0,this.BGWidth=50,this.LineColor=qi.KLineYAxisBGPaint.LineColor,this.DiffValutTextColor=qi.KLineYAxisBGPaint.DiffValutTextColor,this.DiffValueBGColor=qi.KLineYAxisBGPaint.DiffValueBGColor,this.KLineFrame,this.KLineData,this.Range={Max:null,Min:null},this.SetOption=function(t){t&&sa.IsNonEmptyArray(t.SplitData)&&(this.SplitData=t.SplitData)},this.Draw=function(){if(this.IsShow&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=this.HQChart.ChartPaint[0];if(t){var e=!0===this.ChartFrame.IsHScreen;if(!e){this.KLineFrame=this.ChartFrame.SubFrame[this.FrameID].Frame;var a=this.KLineFrame.ChartBorder,i=this.KLineFrame.DataWidth,r=this.KLineFrame.DistanceWidth,n=this.KLineFrame.XPointCount,o=a.GetBorder(),s=o.LeftEx+r/2+qi.FrameLeftMargin,h=o.RightEx;this.KLineData=t.Data;for(var l=null,u=null,C=this.KLineData.DataOffset,D=0;C<this.KLineData.Data.length&&D<n;++C,++D,s+=i+r){var f=this.KLineData.Data[C];if(null!=f.Open&&null!=f.High&&null!=f.Low&&null!=f.Close){var c=s+i;if(c>h)break;(null==l||l<f.High)&&(l=f.High),(null==u||u>f.Low)&&(u=f.Low)}}sa.IsNumber(l)&&sa.IsNumber(u)&&(this.Range.Max=l,this.Range.Min=u,this.DrawBackground())}}}},this.DrawBackground=function(){var t=this.Range.Min,e=this.KLineFrame.ChartBorder.GetBorder(),a=this.KLineFrame.GetYFromData(t,!1),i=e.Right,r=i+this.BGWidth;this.Canvas.font=this.Font,this.Canvas.textBaseline="top",this.Canvas.textAlign="left";for(var n=0;n<this.SplitData.length;++n){var o=this.SplitData[n];if(o.Value+t>this.KLineFrame.HorizontalMax)break;var s=this.KLineFrame.GetYFromData(t+o.Value,!1);this.Canvas.fillStyle=o.Color,this.Canvas.fillRect(b(i),b(s),b(r-i),b(a-s)),o.Text&&o.TextColor&&(this.Canvas.fillStyle=o.TextColor,this.Canvas.fillText(o.Text,r+1,s)),a=s}var h=this.Range.Max-this.Range.Min,l=Jr(this.HQChart.Symbol),u=h.toFixed(l),C=this.KLineFrame.GetYFromData(this.Range.Max,!1);this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(i),A(C)),this.Canvas.lineTo(A(r),A(C)),this.Canvas.stroke();var D=this.Canvas.measureText(u).width+4,f=this.Canvas.measureText("擎").width+2,c={Left:r+1,Top:C-f,Width:D,Height:f};this.DiffValueBGColor&&(this.Canvas.fillStyle=this.DiffValueBGColor,this.Canvas.fillRect(c.Left,c.Top,c.Width,c.Height)),this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.DiffValutTextColor,this.Canvas.fillText(u,c.Left+1,C)}}function je(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="BackgroundPaint",this.IsDynamic=!1,this.IsCallbackDraw=!0,this.IsDrawAllFrame=!1,this.SetDrawFrameID=new Set([0]),this.FrameID=0,this.Data,this.IsShow=!0,this.SubFrame=null,this.ID=N(),this.HQChart,this.SetOption=function(t){t&&(sa.IsNumber(t.FrameID)&&(this.FrameID=t.FrameID),sa.IsObjectExist(t.ID)&&(this.ID=t.ID),sa.IsBool(t.IsDrawAllFrame)&&(this.IsDrawAllFrame=t.IsDrawAllFrame),sa.IsNonEmptyArray(t.AryFrameID)&&(this.SetDrawFrameID=new Set(t.AryFrameID)))},this.Draw=function(){if(this.SubFrame=null,!(this.FrameID<0)&&this.HQChart&&this.ChartFrame&&sa.IsNonEmptyArray(this.ChartFrame.SubFrame)&&this.IsShow&&sa.IsNonEmptyArray(this.Data)&&this.ChartFrame.SubFrame[this.FrameID]&&(this.SubFrame=this.ChartFrame.SubFrame[this.FrameID].Frame,this.SubFrame)){var t=this.HQChart.GetKData();if(t&&sa.IsNonEmptyArray(t.Data)){var e=!0===this.SubFrame.IsHScreen;this.IsHScreen=e;var a=this.SubFrame.IsMinuteFrame(),i=this.SubFrame.DataWidth,r=this.SubFrame.DistanceWidth,n=this.SubFrame.XPointCount,o=this.SubFrame.GetBorder();if(e){o.BottomEx;var s=o.TopEx+r/2+qi.FrameLeftMargin}else s=o.LeftEx+r/2+qi.FrameLeftMargin,o.RightEx;for(var h=new Map,l=t.DataOffset,u=l,C=0;u<t.Data.length&&C<n;++u,++C,s+=i+r){var D=t.Data[u],f=this.FindMatchData(D);if(f){if(a)var c=this.ChartFrame.GetXFromIndex(C),m=c,d=c;else m=s,d=s+i,c=m+(d-m)/2;for(var I=0;I<f.length;++I){var S=f[I];if(h.has(S.Index)){var T=h.get(S.Index);T.End.Left=m,T.End.Right=d,T.End.Item=S.Item}else h.set(S.Index,{Item:S.Item,Start:{Left:m,Right:d,Item:S.Item},End:{Left:m,Right:d,Item:S.Item}})}}}h.size>0&&(this.Canvas.save(),this.DrawBG(h),this.Canvas.restore())}}},this.FindMatchData=function(t){for(var e=[],a=0;a<this.Data.length;++a){var i=this.Data[a],r=i.Start,n=i.End,o=!1;sa.IsNumber(t.Date)&&sa.IsNumber(t.Time)?t.Date>r.Date&&t.Date<n.Date?o=!0:t.Date==r.Date&&t.Date==n.Date?t.Time>=r.Time&&t.Time<=n.Time&&(o=!0):t.Date==r.Date?t.Time>=r.Time&&(o=!0):t.Date==n.Date&&t.Time<=n.Time&&(o=!0):sa.IsNumber(t.Date)&&!sa.IsNumber(t.Time)&&t.Date>=r.Date&&t.Date<=n.Date&&(o=!0),o&&e.push({Index:a,Item:i})}return e.Length<=0?null:e},this.DrawBG=function(t){var e,a=(0,l.default)(t);try{for(a.s();!(e=a.n()).done;)for(var i=e.value,r=i[1],n=0;n<this.ChartFrame.SubFrame.length;++n){var o=this.ChartFrame.SubFrame[n].Frame;(this.IsDrawAllFrame||this.SetDrawFrameID.has(n))&&this.DrawBGItem(o,r)}}catch(s){a.e(s)}finally{a.f()}},this.DrawBGItem=function(t,e){var a=t.GetBorder();if(this.IsHScreen)var i=a.RightEx,r=a.LeftEx,n=a.Top;else i=a.TopEx,r=a.BottomEx,n=a.Left;if(this.IsHScreen){this.SetFillStyle(e.Item.Color,i,n,r,n);var o=e.Start,s=e.End,h={Left:r,Right:i,Top:o.Left,Bottom:s.Right};h.Width=h.Right-h.Left,h.Height=h.Bottom-h.Top,this.Canvas.fillRect(b(h.Left),b(h.Top),b(h.Width),b(h.Height))}else{this.SetFillStyle(e.Item.Color,n,i,n,r);o=e.Start,s=e.End,h={Left:o.Left,Right:s.Right,Top:i,Bottom:r};h.Width=h.Right-h.Left,h.Height=h.Bottom-h.Top,this.Canvas.fillRect(b(h.Left),b(h.Top),b(h.Width),b(h.Height))}}}function $e(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="MinuteBackgroundPaint",this.IsDynamic=!0,this.IsCallbackDraw=!1,this.HQChart,this.Data,this.Font=qi.DefaultTextFont,this.TextColor=qi.DefaultTextColor,this.MerginTop=20,this.ID=N(),this.FrameID=0,this.SetOption=function(t){t&&(t.Font&&(this.Font=t.Font),sa.IsObjectExist(t.ID)&&(this.ID=t.ID),t.FrameID>0&&(this.FrameID=t.FrameID),t.MerginTop>0&&(this.MerginTop=t.MerginTop))},this.Draw=function(){if(this.Data&&this.HQChart&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=this.ChartFrame.SubFrame[this.FrameID];if(t&&t.Frame){var e=t.Frame,a=this.HQChart.SourceData;if(a){for(var i=e.XPointCount,r=0,n=null,o=new Map,s=a.DataOffset,h=0;s<a.Data.length&&h<i;++s,++h){var l=a.Data[s];l&&(l.Date!=r&&(r=l.Date,n?(n.Right=this.ChartFrame.GetXFromIndex(h-1),o.set(n.Date,n),n={Left:this.ChartFrame.GetXFromIndex(h),Date:l.Date}):n={Left:this.ChartFrame.GetXFromIndex(h),Date:l.Date}))}n&&!n.Right&&(n.Right=this.ChartFrame.GetXFromIndex(i-1),o.set(n.Date,n)),this.Canvas.textAlign="center",this.Canvas.textBaseline="top";var u=e.ChartBorder.GetTopEx()+this.MerginTop;for(s=0;s<this.Data.length;++s){l=this.Data[s];if(o.has(l.Date)){n=o.get(l.Date);var C=n.Left+(n.Right-n.Left)/2;l.Font?this.Canvas.font=l.Font:this.Canvas.font=this.Font,l.TextColor?this.Canvas.fillStyle=l.TextColor:this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(l.Text,C,u)}}}}}}}He.DRAW_PRIORITY_ID={LEVEL_1:1,LEVEL_5:5,LEVEL_8:8,LEVEL_10:10,LEVEL_20:20,LEVEL_25:25,LEVEL_35:35,LEVEL_50:50};var ta={MAIN_KLINE:1,OVERLAY_KLINE:2,MAIN_INDEX:3,OVERLAY_INDEX:4,OVERLAY_MINUTE:5,MAIN_MINUTE:6,MAIN_AVERAGE_MINUTE:7,MAIN_MINUTE_VOL:8};function ea(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="DragMovePaint",this.DrawAfterTitle=!0,this.IsDynamic=!0,this.Info,this.IsShow=!1,this.Point,this.TextColor=qi.DragMovePaint.TextColor,this.Font=qi.DragMovePaint.Font,this.ReloadResource=function(t){this.TextColor=qi.DragMovePaint.TextColor,this.Font=qi.DragMovePaint.Font},this.Clear=function(){this.Info=null,this.IsShow=!1,this.Point=null},this.Draw=function(){if(this.Info&&this.IsShow&&this.Point){var t,e=this.Info.FrameID+1;this.Info.Type==ta.MAIN_KLINE?t="K线:".concat(this.Info.Name,", 窗口:").concat(e):this.Info.Type==ta.OVERLAY_KLINE?t="叠加K线:".concat(this.Info.Name,", 窗口:").concat(e):this.Info.Type==ta.MAIN_INDEX?t="指标:".concat(this.Info.IndexName,", 窗口:").concat(e):this.Info.Type==ta.OVERLAY_INDEX?t="叠加指标:".concat(this.Info.IndexName,", 窗口:").concat(e):this.Info.Type==ta.OVERLAY_MINUTE?t="走势图, 叠加价格线:".concat(this.Info.Name,", 窗口:").concat(e):this.Info.Type==ta.MAIN_MINUTE?t="走势图, 价格线:".concat(this.Info.Name,", 窗口:").concat(e):this.Info.Type==ta.MAIN_AVERAGE_MINUTE?t="走势图, 均线:".concat(this.Info.Name,", 窗口:").concat(e):this.Info.Type==ta.MAIN_MINUTE_VOL&&(t="走势图, 成交量:".concat(this.Info.Name,", 窗口:").concat(e)),t&&(this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillText(t,this.Point.X,this.Point.Y))}}}function aa(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="SessionBreaksPaint",this.IsDynamic=!1,this.IsCallbackDraw=!0,this.FrameID=0,this.KDataFeature,this.Data,this.ChartFrame,this.BGColor=qi.SessionBreaksPaint.BGColor.slice(),this.SplitLine={Color:qi.SessionBreaksPaint.SplitLine.Color,Width:qi.SessionBreaksPaint.SplitLine.Width,Dash:qi.SessionBreaksPaint.SplitLine.Dash},this.MapPeriod=new Map([[0,{SplitType:1}],[1,{SplitType:1}],[2,{SplitType:2}],[21,{SplitType:2}],[4,{SplitType:3}],[5,{SplitType:3}],[6,{SplitType:3}],[7,{SplitType:3}],[8,{SplitType:3}]]),this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID)},this.Draw=function(){if(this.HQChart){var t=this.HQChart.ChartOperator_Temp_GetHistoryData();if(t&&sa.IsNonEmptyArray(t.Data)&&(this.IsKDataChange(t)&&this.BuildCacheData(t),sa.IsNonEmptyArray(this.Data))){var e=this.HQChart.Frame.SubFrame[0].Frame,a=!0===this.ChartFrame.IsHScreen,i=e.DataWidth,r=e.DistanceWidth,n=e.XPointCount;if(a)var o=this.ChartBorder.GetHScreenBorder(),s=o.BottomEx,h=o.TopEx+r/2+qi.FrameLeftMargin;else o=this.ChartBorder.GetBorder(),h=o.LeftEx+r/2+qi.FrameLeftMargin,s=o.RightEx;for(var l=null,u=[],C=null,D=t.DataOffset,f=0;D<t.Data.length&&f<n;++D,++f,h+=i+r){var c=this.Data[D];if(c){var m=h,d=h+i;if(d>s)break;var I=m-r/2,S=d+r/2,T=c.ID;if(sa.IsNumber(T))if(null==l){if(C={Start:{X:I},End:{X:S},ColorIndex:T,Count:1,IsStart:!1,IsEnd:!1},l=T,D-1>=0){var v=this.Data[D-1];v&&v.ID!=T&&(C.IsStart=!0)}}else l!=T?(C.End.X=I,C.IsEnd=!0,u.push(C),C={Start:{X:I},End:{X:S},ColorIndex:T,Count:1,IsStart:!0,IsEnd:!1},l=T):(C.End.X=S,++C.Count)}}C&&C.Count>=2&&u.push(C),this.Canvas.save(),this.DrawBG(u),this.Canvas.restore()}}},this.DrawBG=function(t){if(sa.IsNonEmptyArray(t)){var e=!0===this.ChartFrame.IsHScreen;if(e)var a=this.ChartBorder.GetHScreenBorder(),i=a.RightEx,r=a.Left,n=r-i;else a=this.ChartBorder.GetBorder(),i=a.TopEx,r=a.BottomEx,n=r-i;var o=!1;this.SplitLine.Color&&(o=!0);for(var s=0,h=0;h<t.length;++h){var l=t[h],u=l.Start.X,C=l.End.X,D=l.ColorIndex%this.BGColor.length,f=this.BGColor[D];f&&(this.Canvas.fillStyle=f,e?this.Canvas.fillRect(A(i),A(u),b(n),b(C-u)):this.Canvas.fillRect(A(u),A(i),b(C-u),b(n))),o&&l.IsStart&&(0==s&&this.Canvas.beginPath(),e?(this.Canvas.moveTo(i,A(u)),this.Canvas.lineTo(r,A(u))):(this.Canvas.moveTo(A(u),i),this.Canvas.lineTo(A(u),r)),++s)}o&&s>=1&&(this.SplitLine.Width>=1&&(this.Canvas.linewidth=this.SplitLine.Width),this.SplitLine.Dash&&this.Canvas.setLineDash(this.SplitLine.Dash),this.SplitLine.Color&&(this.Canvas.strokeStyle=this.SplitLine.Color),this.Canvas.stroke())}},this.IsKDataChange=function(t){return!this.KDataFeature||(this.KDataFeature.Symbol!=this.HQChart.Symbol||(this.KDataFeature.Period!=this.HQChart.Period||this.KDataFeature.DataCount!=t.Data.length))},this.BuildCacheData=function(t){var e=this.HQChart.Period;if(!this.MapPeriod.has(e))return this.Data=[],void(this.KDataFeature={Symbol:this.HQChart.Symbol,Period:e,DataCount:t.Data.length});var a=this.MapPeriod.get(e).SplitType,i=0,r=-1;this.Data=[];for(var n=0;n<t.Data.length;++n){var o=t.Data[n];switch(a){case 1:parseInt(o.Date/100)!=parseInt(i/100)&&(i=o.Date,++r),this.Data.push({ID:r,Date:o.Date});break;case 2:parseInt(o.Date/1e4)!=parseInt(i/1e4)&&(i=o.Date,++r),this.Data.push({ID:r,Date:o.Date});break;case 3:o.Date!=i&&(i=o.Date,++r),this.Data.push({ID:r,Date:o.Date});break}}this.KDataFeature={Symbol:this.HQChart.Symbol,Period:e,DataCount:t.Data.length}}}function ia(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="FrameButtomToolbarPaint",this.FrameID=-1,this.FrameGuid=null,this.IsDynamic=!0,this.DrawAfterTitle=!0,this.DrawPriority=He.DRAW_PRIORITY_ID.LEVEL_25,this.AryButton=[],this.SelectedID=null,this.AryRectButton=[],this.BGColor=qi.FrameButtomToolbar.BGColor,this.BorderColor=qi.FrameButtomToolbar.BorderColor,this.ButtonConfig=P(qi.FrameButtomToolbar.Button),this.ReloadResource=function(t){this.BGColor=qi.FrameButtomToolbar.BGColor,this.BorderColor=qi.FrameButtomToolbar.BorderColor,this.ButtonConfig=P(qi.FrameButtomToolbar.Button)},this.SetOption=function(t){t&&(sa.IsNumber(t.FrameID)&&(this.FrameID=t.FrameID),t.FrameGuid&&(this.FrameGuid=t.FrameGuid),sa.IsNonEmptyArray(t.AryButton)&&(this.AryButton=t.AryButton.slice()),t.SelectedID&&(this.SelectedID=t.SelectedID))},this.SetSelectedID=function(t){this.SelectedID=t},this.Draw=function(t,e){this.AryRectButton=[];var a=this.GetFrame();if(a&&!a.IsHScreen&&!a.IsMinSize&&!a.ChartBorder.IsShowTitleOnly){var i=a.ChartBorder.GetBorder(),r={Left:i.Left+1,Right:i.Right-1,Top:i.BottomEx+1,Bottom:i.Bottom-1};if(r.Width=r.Right-r.Left,r.Height=r.Bottom-r.Top,!(r.Height<10)){this.BGColor&&(this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(r.Left,r.Top,r.Width,r.Height));var n=this.GetTitleFont(r.Height-this.ButtonConfig.Mergin.Top-this.ButtonConfig.Mergin.Bottom),o=this.GetSVGFont(r.Height-this.ButtonConfig.Mergin.Top-this.ButtonConfig.Mergin.Bottom);this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=n;for(var s=r.Left,h=0;h<this.AryButton.length;++h){var l=this.AryButton[h];if(!l.Title&&(!l.SVGButton||!l.SVGButton.Symbol))return;var u=0;l.Title&&(u=this.Canvas.measureText(l.Title).width+2);var C=0;l.SVGButton&&l.SVGButton.Symbol&&(C=this.ButtonConfig.SVG.Size,u>0&&(C+=this.ButtonConfig.SVG.MerginLeft));var D=u+C+this.ButtonConfig.Mergin.Left+this.ButtonConfig.Mergin.Right,f={Left:s,Top:r.Top,Bottom:r.Bottom,Height:r.Height,Width:D};f.Right=f.Left+f.Width;var c=this.ButtonConfig.BGColor.Default,m=this.ButtonConfig.TitleColor.Default;if(t&&t.X>=f.Left&&t.X<f.Right&&t.Y>=f.Top&&t.Y<=f.Bottom&&(c=this.ButtonConfig.BGColor.MoveOn,m=this.ButtonConfig.TitleColor.MoveOn,e&&(e.MouseOnToolbar={Rect:f,Item:l,Frame:a,Point:{X:t.X,Y:t.Y},ID:"TitleButton"})),this.SelectedID&&this.SelectedID==l.ID&&(c=this.ButtonConfig.BGColor.Selected,m=this.ButtonConfig.TitleColor.Selected),c&&(this.Canvas.fillStyle=c,this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height)),this.ButtonConfig.BorderColor&&(this.Canvas.strokeStyle=this.ButtonConfig.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(f.Right),f.Top),this.Canvas.lineTo(A(f.Right),f.Bottom),this.Canvas.stroke()),l.Title){this.Canvas.fillStyle=m;var d=f.Left+(f.Width-C)/2,I=f.Top+this.ButtonConfig.Mergin.Top+(f.Height-this.ButtonConfig.Mergin.Top-this.ButtonConfig.Mergin.Bottom)/2;this.Canvas.fillText(l.Title,d,I)}var S=null;if(l.SVGButton&&l.SVGButton.Symbol){this.Canvas.font=o,this.Canvas.fillStyle=m;d=f.Right-this.ButtonConfig.SVG.Size/2-this.ButtonConfig.Mergin.Right;this.Canvas.fillText(l.SVGButton.Symbol,d,I),this.Canvas.font=n,S={Left:f.Right-this.ButtonConfig.Mergin.Right-this.ButtonConfig.SVG.Size,Top:f.Top,Width:this.ButtonConfig.SVG.Size,Height:this.ButtonConfig.SVG.Size},S.Right=S.Left+S.Width,S.Bottom=S.Top+S.Height}if(u>0&&C>0){var T={Left:f.Left,Top:f.Top,Bottom:f.Bottom};T.Right=T.Left+u+this.ButtonConfig.Mergin.Left+this.ButtonConfig.SVG.MerginLeft/2;var v={Rect:T,ID:l.ID,Data:l,RectCell:f,ButtonType:0};this.AryRectButton.push(v);S={Left:T.Right,Right:f.Right,Top:f.Top,Bottom:f.Bottom},v={Rect:S,ID:l.ID,Data:l,RectCell:f,ButtonType:1};this.AryRectButton.push(v)}else{v={Rect:f,ID:l.ID,Data:l,RectCell:f};u>0?v.ButtonType=0:C>0&&(v.ButtonType=1),this.AryRectButton.push(v)}s+=D+1}this.BorderColor&&(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(i.Left,A(i.BottomEx)),this.Canvas.lineTo(i.Right,A(i.BottomEx)),this.Canvas.stroke())}}},this.GetFrame=function(){if(!this.ChartFrame)return null;if(this.FrameID>=0){var t=this.ChartFrame.SubFrame[this.FrameID];return t&&t.Frame?t.Frame:null}return null},this.GetTitleFont=function(t){var e=this.ButtonConfig.Font,a=t*F();sa.IsPlusNumber(e.Size)&&(a=e.Size);var i="".concat(a,"px ").concat(e.Family);return i},this.GetSVGFont=function(t){var e=this.ButtonConfig.SVG,a=t*F();sa.IsPlusNumber(e.Size)&&(a=e.Size);var i="".concat(a,"px ").concat(e.Family);return i},this.PtInButtons=function(t,e){for(var a=0;a<this.AryRectButton.length;++a){var i=this.AryRectButton[a],r=i.Rect;if(t>r.Left&&t<r.Right&&e>r.Top&&e<r.Bottom){var n=this.GetFrame(),o={ID:i.Data.ID,Rect:r,FrameID:this.FrameID,Frame:n,Data:i.Data,ButtonType:i.ButtonType,RectCell:i.RectCell};return o}}return null}}function ra(){this.PlayList=[],this.Cache=[],this.MinLineHeight=40*F(),this.Height,this.Step=1,this.GetPlayList=function(t){for(var e=t.Canves,a=t.Right,i=t.Left,r=a-i,n=t.IsMoveStep,o=[],s=0,h=0;h<this.PlayList.length;++h){var l=this.PlayList[h],u=this.MinLineHeight;l.Height>this.MinLineHeight&&(u=l.Height);for(var C=!0,D=!1,f=0;f<l.Data.length;++f){var c=l.Data[f],m={X:c.X,Y:s,Text:c.Text,Color:c.Color,Height:u,Font:c.Font,Info:c.Info};o.push(m),n&&(f==l.Data.length-1&&this.Cache.length>0?(C=!1,c.TextWidth||(c.Font&&c.Font.Name?e.font=c.Font.Name:e.font=t.Font,c.TextWidth=e.measureText(m.Text+"擎擎").width),c.X>=c.TextWidth&&(C=!0)):0==f&&(D=!1,c.TextWidth||(c.Font&&c.Font.Name?e.font=c.Font.Name:e.font=t.Font,c.TextWidth=e.measureText(m.Text+"擎擎").width),c.X>r+c.TextWidth&&(D=!0)),c.X+=this.Step)}if(n&&C&&this.Cache.length>0){var d=this.Cache.shift(),I={X:0,Text:d.Text,Color:d.Color,Font:d.Font,Info:d.Info};l.Data.push(I)}if(n&&D&&l.Data.length>0){var S=l.Data.shift();this.OnItemPlayEnd(t.HQChart,S)}s+=u}return o},this.CacluatePlayLine=function(t){this.Height=t;var e=parseInt(t/this.MinLineHeight);if(this.PlayList.length<e)for(var a=e-this.PlayList.length,i=0;i<a;++i)this.PlayList.push({Data:[]});else if(this.PlayList.length>e){var r=this.PlayList.length-e;for(i=0;i<r;++i)for(var n=this.PlayList.pop(),o=0;o<n.Data.length;++o){var s=n.Data[o],h={Text:s.Text,Color:s.Color,Font:s.Font,Info:s.Info};this.Cache.unshift(h)}}u.Chart.Log("[BarrageList::CacluatePlayLine] LineCount=".concat(this.PlayList.length," Height=").concat(this.Height))},this.AddBarrage=function(t){for(var e in t){var a=t[e];this.Cache.push(a)}},this.OnItemPlayEnd=function(t,e){if(t.mapEvent.has(m.BARRAGE_PLAY_END)){var a=t.mapEvent.get(m.BARRAGE_PLAY_END);a.Callback&&a.Callback(a,e,this)}},this.Count=function(){return this.Cache.length}}function na(){this.newMethod=He,this.newMethod(),delete this.newMethod,this.ClassName="BarragePaint",this.IsAnimation=!0,this.IsEraseBG=!0,this.HQChart,this.Font=qi.Barrage.Font,this.TextColor=qi.Barrage.Color,this.FontHeight=qi.Barrage.Height,this.BarrageList=new ra,this.IsMoveStep=!1,this.SetOption=function(t){t&&(t.Step>0&&(this.BarrageList.Step=t.Step),t.MinLineHeight&&(this.Barrage.MinLineHeight=t.MinLineHeight))},this.DrawHScreen=function(){var t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetRightEx();this.ChartBorder.GetChartWidth();t!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(t),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:a,Left:e,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r){this.Canvas.save(),this.Canvas.translate(this.ChartBorder.GetChartHeight(),0),this.Canvas.rotate(90*Math.PI/180);for(var n=0;n<r.length;++n){var o=r[n];o.Color?this.Canvas.fillStyle=o.Color:this.Canvas.fillStyle=this.TextColor,o.Font?this.Canvas.font=o.Font.Name:this.Canvas.font=this.Font;var s=this.FontHeight;o.Font&&o.Font.Height>0&&(s=o.Font.Height);var h=o.Y+parseInt((o.Height-s)/2);this.Canvas.fillText(o.Text,a-o.X,i+h)}this.Canvas.restore()}},this.Draw=function(){if(this.ChartFrame.IsHScreen)this.DrawHScreen();else{var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeight();i!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(i),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:e,Left:t,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r)for(var n=0;n<r.length;++n){var o=r[n];o.Color?this.Canvas.fillStyle=o.Color:this.Canvas.fillStyle=this.TextColor,o.Font?this.Canvas.font=o.Font.Name:this.Canvas.font=this.Font;var s=this.FontHeight;o.Font&&o.Font.Height>0&&(s=o.Font.Height);var h=o.Y+parseInt((o.Height-s)/2);this.Canvas.fillText(o.Text,e-o.X,a+h)}}}}var oa={LATEST_VALUE_ID:0,FIXED_VALUE_ID:1,PAGE_LAST_PRICE_ID:2,PAGE_DATA_INCREASE:3,PAGE_LAST_INDEX_VALUE_ID:4,PAGE_LAST_OVERLAY_INDEX_VALUE_ID:5};function sa(){this.ChartBorder,this.Frame,this.FrameSplitData,this.SplitCount=5,this.StringFormat=0,this.IsShowLeftText=!0,this.IsShowRightText=!0,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.GetEventCallback,this.GetKLineChartCallback,this.IntegerCoordinateSplit=function(t){var e=this.FrameSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;sa.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),sa.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var o=0,s=i;s-a<1e-8;s+=e.FixInterval)++o;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=o,!0},this.Filter=function(t,e,a){if(this.SplitCount<=0||t.length<=0||t.length<=this.SplitCount)return t;var i=parseInt(t.length/this.SplitCount);i<=1&&(i=2);var r=[];if(1==a)for(var n=0;n<t.length;n+=i)r.push(t[n]);else for(n=0;n<t.length;n+=i)n+i>=t.length&&n!=t.length-1?r.push(t[t.length-1]):r.push(t[n]);if(2==this.SplitCount&&r.length>2)for(n=1;n<r.length-1;++n){var o=r[n];o.Message[0]=null,o.Message[1]=null}if(e){var s=!1;for(n=0;n<r.length;++n){o=r[n];if(Math.abs(o.Value)<1e-8){s=!0;break}}if(0==s){var h=new Y;h.Value=0,h.Message[0]=null,h.Message[1]=null,r.push(h)}}return r},this.RemoveZero=function(t){for(var e=[!0,!0,!0,!0],a=0;a<t.length;++a){var i=t[a],r=i.Message[0];this.IsDecimalZeroEnd(r)||(e[0]=!1);r=i.Message[1];this.IsDecimalZeroEnd(r)||(e[1]=!1);r=i.Message[2];this.IsDecimalZeroEnd(r)||(e[2]=!1);r=i.Message[3];this.IsDecimalZeroEnd(r)||(e[3]=!1)}if(0!=e[0]||0!=e[1]||0!=e[2]||0!=e[3])for(a=0;a<t.length;++a){i=t[a];if(e[0]){r=i.Message[0];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[0]=r.replace(/[.][0]+/g,""))}if(e[1]){r=i.Message[1];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[1]=r.replace(/[.][0]+/g,""))}if(e[2]){r=i.Message[2];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[2]=r.replace(/[.][0]+/g,""))}if(e[3]){r=i.Message[3];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[3]=r.replace(/[.][0]+/g,""))}}},this.IsDecimalZeroEnd=function(t){if(null==t)return!0;if("number"==typeof t&&(t=t.toString()),"0"==t)return!0;var e=t.search(/[.]/);if(e<0)return!1;for(var a=e+1;a<t.length;++a){var i=t.charAt(a);if(i>="1"&&i<="9")return!1}return!0},this.GetKLinePageInfo=function(){if(!this.GetKLineChartCallback)return null;var t=this.GetKLineChartCallback();if(!t||!t.Data||!(t.Data.DataOffset>=0))return null;if(!sa.IsNonEmptyArray(t.Data.Data))return null;var e=t.Data.Data,a=t.Data.DataOffset,i=t.Data.DataOffset+t.ChartFrame.XPointCount-1;i>=e.length&&(i=e.length-1);var r={Start:{Item:e[a],Index:a},End:{Item:e[i],Index:i},IsLast:i==e.length-1};return r},this.CustomLatestIndexDataCoordinate=function(t){var e=this.GetKLinePageInfo();if(e&&this.HQChart){var a=null;this.GetEventCallback&&(a=this.GetEventCallback(m.ON_FORMAT_INDEX_Y_LABEL));var i=e.End.Index,r=2;sa.IsNumber(this.FloatPrecision)&&(r=this.FloatPrecision);for(var n=0,o=0;n<this.HQChart.ChartPaint.length;++n){var s=this.HQChart.ChartPaint[n];if(s.ChartFrame&&(s.GetItemData&&(s.ChartFrame.Identify==this.Frame.Identify||s.ChartFrame==this.Frame))){var h=s.GetItemData({Index:i});if(!sa.IsNonEmptyArray(h))continue;for(o=0;o<h.length;++o){var l=h[o],u=new Y;u.Type=1,u.TextColor=qi.FrameLatestPrice.TextColor,u.LineColor=l.Color,u.LineType=-1,u.IsLast=e.IsLast,sa.IsNumber(t.LineType)&&(u.LineType=t.LineType),u.Value=l.Value;var C=sa.FormatValueString(l.Value,r,this.LanguageID);if("left"==t.Position?u.Message[0]=C:u.Message[1]=C,!e.IsLast){var D={};e.IsLast||(D.EmptyBGColor=qi.FrameLatestPrice.EmptyBGColor),u.ExtendData={Custom:D}}if(a){var f={PreventDefault:!1,Label:u,Data:l,IndexName:s.IndexName,FrameID:this.Frame.Identify};if(a.Callback(a,f,this),f.PreventDefault)continue}this.Frame.CustomHorizontalInfo.push(u)}}}}},this.CustomLatestOverlayIndexDataCoordinate=function(t){var e=this.GetKLinePageInfo();if(e&&this.OverlayIndex&&sa.IsNonEmptyArray(this.OverlayIndex.ChartPaint)){var a=null;this.GetEventCallback&&(a=this.GetEventCallback(m.ON_FORMAT_OVERLAY_INDEX_Y_LABEL));var i=e.End.Index,r=2;sa.IsNumber(this.FloatPrecision)&&(r=this.FloatPrecision);for(var n=0,o=0;n<this.OverlayIndex.ChartPaint.length;++n){var s=this.OverlayIndex.ChartPaint[n];if(s.ChartFrame&&s.GetItemData){var h=s.GetItemData({Index:i});if(sa.IsNonEmptyArray(h))for(o=0;o<h.length;++o){var l=h[o],u=new Y;u.Type=1,u.TextColor=qi.FrameLatestPrice.TextColor,u.LineColor=l.Color,u.LineType=-1,u.IsLast=e.IsLast,sa.IsNumber(t.LineType)&&(u.LineType=t.LineType),u.Value=l.Value;var C=sa.FormatValueString(l.Value,r,this.LanguageID);if("left"==t.Position?u.Message[0]=C:u.Message[1]=C,!e.IsLast){var D={};e.IsLast||(D.EmptyBGColor=qi.FrameLatestPrice.EmptyBGColor),u.ExtendData={Custom:D}}if(a){var f={PreventDefault:!1,Label:u,Data:l,IndexName:s.IndexName,OverlayIdentify:this.OverlayIndex.Identify};if(a.Callback(a,f,this),f.PreventDefault)continue}this.Frame.CustomHorizontalInfo.push(u)}}}}},this.InvokeCustomYCoordinateCallback=function(){if(!this.GetEventCallback)return null;var t=this.GetEventCallback(m.ON_CREATE_CUSTOM_Y_COORDINATE);if(!t||!t.Callback)return null;var e={ID:this.Frame.Identify,Frame:this.Frame,PreventDefault:!1,Custom:this.Custom};return this.OverlayIdentify&&(e.OverlayIdentify=this.OverlayIdentify),t.Callback(t,e,this),e},this.Reset=function(){},this.SetOption=function(t){},this.ReservedHeight=function(t){if(this.Frame&&!this.Frame.IsHScreen){var e=this.Frame.HorizontalReserved;if(e){var a=0;if(sa.IsPlusNumber(e.Top)&&(a+=e.Top),sa.IsPlusNumber(e.Bottom)&&(a+=e.Bottom),!(a<=0)){var i=this.Frame.GetBorder(),r=i.TopEx,n=i.BottomEx,o=n-r;if(!(o<a)){var s=t.Max,h=t.Min;sa.IsPlusNumber(e.Top)&&(r-=e.Top),sa.IsPlusNumber(e.Bottom)&&(n+=e.Bottom);var l=(s-h)/(n-r);if(sa.IsPlusNumber(e.Top)){var u=l*e.Top;s+=u}if(sa.IsPlusNumber(e.Bottom)){var C=l*e.Bottom;h-=C}t.Max=s,t.Min=h,this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min}}}}}}function ha(){this.newMethod=sa,this.newMethod(),delete this.newMethod,this.CoordinateType=0,this.Symbol,this.Data,this.FrameSplitData2,this.FloatPrecision=null,this.Period,this.KLineChart,this.Custom=[],this.SplitType=0,this.DefaultSplitType=0,this.DefaultYMaxMin,this.FixedYMaxMin,this.EnableZoomUpDown=!1,this.LastMaxMin,this.PercentageTextFormat=0,this.IsEnableDragY=function(){return 0==this.CoordinateType||1==this.CoordinateType},this.Operator=function(){var t={};if(t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,t.Count=this.SplitCount,this.Frame.YMaxMin){var e=this.Frame.YMaxMin;sa.IsNumber(e.Max)&&sa.IsNumber(e.Min)&&(t.Max=e.Max,t.Min=e.Min)}t.Max==t.Min&&(t.Max+=.01*t.Max,t.Min-=.01*t.Min);var a=this.FixedYMaxMin&&sa.IsNumber(this.FixedYMaxMin.Max)&&sa.IsNumber(this.FixedYMaxMin.Min);if(a)t.Max=this.FixedYMaxMin.Max,t.Min=this.FixedYMaxMin.Min;else if(this.DefaultYMaxMin){var i=this.DefaultYMaxMin;sa.IsNumber(i.Max)&&(t.Min>i.Max?t.Min=i.Max:t.Max<i.Max&&(t.Max=i.Max)),sa.IsNumber(i.Min)&&(t.Max<i.Min?t.Max=i.Min:t.Min>i.Min&&(t.Min=i.Min))}t.Interval=(t.Max-t.Min)/(t.Count-1);var r=F(),n=this.Frame.ChartBorder.GetChartWidth(),o=n<450*r,s=Jr(this.Symbol);o&&Pr.IsSHSZIndex(this.Symbol)&&(s=0),null!=this.FloatPrecision&&(s=this.FloatPrecision),u.Chart.Log("[FrameSplitKLinePriceY::Operator] Max=".concat(t.Max," Min=").concat(t.Min," Count=").concat(t.Count," isPhoneModel=").concat(o," defaultfloatPrecision=").concat(s," ")),this.Frame.Logarithmic=null,this.Frame.MultiTextFormat=0;var h=!0;if(t.IsFixedMaxMin=a,t.IsFilter=h,dt.IsTickPeriod(this.Period))this.SplitTickData(t,s),h=t.IsFilter;else if(ha.SplitCustom)ha.SplitCustom(this,t,s),h=!1;else switch(this.CoordinateType){case 1:this.SplitPercentage(t,s,a)?(this.Frame.MultiTextFormat=this.PercentageTextFormat,h=!1):this.SplitDefault(t,s,a);break;case 3:this.SplitIncrease(t,s)?h=!1:this.SplitDefault(t,s);break;case 4:this.SplitAverage(t,s),h=!1;break;case 5:this.SplitGoldenSection(t,s),h=!1;break;case 2:this.SplitLogarithmic(t,s)?h=!1:this.SplitDefault(t,s);break;default:1==this.SplitType?(this.SplitFixed(t,s),h=!1):2==this.SplitType?(this.SplitFixedV2(t,s),h=!1):this.SplitDefault(t,s,a);break}if(this.CustomCoordinate(s),h&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,!1)),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,1!=this.EnableZoomUpDown||this.FixedYMaxMin||(this.FixedYMaxMin={Max:t.Max,Min:t.Min}),this.ReservedHeight(t),u.Chart.Log("[FrameSplitKLinePriceY::Operator] fixed . Max=".concat(t.Max," Min=").concat(t.Min," Count=").concat(t.Count)),this.GetEventCallback){var l=this.GetEventCallback(m.ON_SPLIT_YCOORDINATE);if(l&&l.Callback){var C={ID:this.Frame.Identify,Frame:this.Frame};l.Callback(l,C,this)}}},this.SplitTickData=function(t,e){switch(this.CoordinateType){case 1:this.SplitPercentage(t,e,t.IsFixedMaxMin)?(this.Frame.MultiTextFormat=this.PercentageTextFormat,t.IsFilter=!1):this.SplitDefault(t,e,t.IsFixedMaxMin);break;default:3==this.SplitType?this.SplitTickPrice(t,e):this.SplitDefault(t,e,t.IsFixedMaxMin)}},this.SplitTickPrice=function(t,e){var a=this.KLineChart.GetAllPrice();for(var i in this.Frame.HorizontalInfo=[],a){var r=a[i];this.Frame.HorizontalInfo[i]=new Y,this.Frame.HorizontalInfo[i].Value=r,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=r.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=r.toFixed(e))}},this.SplitPercentage=function(t,e,a){var i=this.GetFirstOpenPrice();if(!sa.IsNumber(i))return!1;t.Max=(t.Max-i)/i,t.Min=(t.Min-i)/i,t.Interval=(t.Max-t.Min)/(t.Count-1),a||this.IntegerCoordinateSplit2(t);var r,n=(1+t.Min)*i,o=(1+t.Max)*i;if(qi.Frame&&qi.Frame.PercentageText){var s=qi.Frame.PercentageText;r={PriceColor:s.PriceColor,PercentageColor:s.PercentageColor,SplitColor:s.SplitColor,Font:s.Font}}for(var h=[],l=0;l<=t.Max;l+=t.Interval){var u=(l+1)*i;s=new Y;s.Value=u,this.FormatPercentageItem(s,l,e,r),h.push(s)}for(l=-t.Interval;l>=t.Min;l-=t.Interval){u=(l+1)*i;if(!(u<n||u>o)){s=new Y;s.Value=u,this.FormatPercentageItem(s,l,e,r),h.push(s)}}return h.sort((function(t,e){return t.Value-e.Value})),this.Frame.HorizontalInfo=h,t.Min=n,t.Max=o,!0},this.FormatPercentageItem=function(t,e,a,i){var r=t.Value,n=r.toFixed(a);if(this.IsShowLeftText&&(t.Message[0]=n),this.IsShowRightText){var o="".concat(sa.RemoveZero(e.toFixed(2)),"%");1==this.PercentageTextFormat?t.Message[1]=[{Text:n,Color:i.PriceColor},{Text:"/",Color:i.PercentageColor},{Text:o,Color:i.SplitColor}]:3==this.PercentageTextFormat?t.Message[1]=[{Text:n,Color:i.PriceColor},{Text:o,Color:i.PercentageColor}]:2==this.PercentageTextFormat?t.Message[1]=[o,n]:t.Message[1]=o}},this.SplitIncrease=function(t,e){var a=this.GetLast2ndClose();if(!sa.IsNumber(a))return!1;this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var i=qi.FrameSplitIncrease.Increase,r=[],n=a;n<t.Max;n*=1+i){var o=new Y;o.Value=n;var s=n.toFixed(e);this.IsShowLeftText&&(o.Message[0]=s),this.IsShowRightText&&(o.Message[1]=s),r.push(o)}for(n=.9*a;n>t.Min;n*=1-i){o=new Y;o.Value=n;s=n.toFixed(e);this.IsShowLeftText&&(o.Message[0]=s),this.IsShowRightText&&(o.Message[1]=s),r.push(o)}return this.Frame.HorizontalInfo=r,!0},this.SplitAverage=function(t,e){var a=t.Max,i=t.Min;this.Frame.HorizontalInfo=[];for(var r=qi.FrameSplitAverage.Count,n=(a-i)/r,o=0;o<=r;++o){var s=new Y;s.Value=i+n*o;var h=s.Value.toFixed(e);this.IsShowLeftText&&(s.Message[0]=h),this.IsShowRightText&&(s.Message[1]=h),this.Frame.HorizontalInfo[o]=s}},this.SplitGoldenSection=function(t,e){var a=t.Max,i=t.Min;this.Frame.HorizontalInfo=[];var r=[],n=qi.FrameGoldenSection.Golden;for(var o in n){var s=(a-i)*n[o]+i;item=new Y,item.Value=s;var h=s.toFixed(e);this.IsShowLeftText&&(item.Message[0]=h),this.IsShowRightText&&(item.Message[1]=h),r.push(item)}this.Frame.HorizontalInfo=r},this.SplitLogarithmic=function(t,e){var a=qi.FrameLogarithmic.MinInterval,i=this.GetFirstOpenPrice();if(!sa.IsNumber(i))return!1;for(var r=this.ChartBorder.GetHeightEx(),n=[.01,.02,.04,.08,.1,.2],o=n[n.length-1],s=0;s<n.length;++s){var h=n[s],l=i*h*(r/(t.Max-t.Min));if(l>a){o=h;break}}var C=[],D=i;s=o;do{var f={Start:D};D=i*(1+s),f.End=D,C.push(f),s+=o}while(D<t.Max);var c=D,m=[];D=i,s=o;do{f={End:D};D=i*(1-s),f.Start=D,m.push(f),s+=o}while(D>t.Min);var d=D;t.Max=c,t.Min=d,u.Chart.Log("[FrameSplitKLinePriceY::SplitLogarithmic] up, down",C,m),this.Frame.HorizontalInfo=[];f=new Y;f.Value=i,f.Font=qi.FrameLogarithmic.OpenPriceFont;var I=f.Value.toFixed(e);for(var s in this.IsShowLeftText&&(f.Message[0]=I),this.IsShowRightText&&(f.Message[1]=I),this.Frame.HorizontalInfo.push(f),C){f=new Y;f.Value=C[s].End;I=f.Value.toFixed(e);this.IsShowLeftText&&(f.Message[0]=I),this.IsShowRightText&&(f.Message[1]=I),this.Frame.HorizontalInfo.push(f)}for(var s in m){f=new Y;f.Value=m[s].End;I=f.Value.toFixed(e);this.IsShowLeftText&&(f.Message[0]=I),this.IsShowRightText&&(f.Message[1]=I),this.Frame.HorizontalInfo.splice(0,0,f)}return this.Frame.Logarithmic={Up:C,Down:m,OpenPrice:i},!0},this.SplitDefault=function(t,e,a){a||this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var i=0,r=t.Min;i<t.Count;++i,r+=t.Interval)this.Frame.HorizontalInfo[i]=new Y,this.Frame.HorizontalInfo[i].Value=r,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=r.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=r.toFixed(e))},this.SplitFixed=function(t,e){this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new Y,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.SplitFixedV2=function(t,e){this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new Y,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e));t.IsFixedMaxMin||(0==e?(t.Max+=1,t.Min-=1):1==e?(t.Max+=.1,t.Min-=.1):2==e&&(t.Max+=.01,t.Min-=.01))},this.CustomCoordinate=function(t){if(!sa.IsNumber(t)){var e=F(),a=this.Frame.ChartBorder.GetChartWidth(),i=a<450*e;t=Jr(this.Symbol),i&&Pr.IsSHSZIndex(this.Symbol)&&(t=0),null!=this.FloatPrecision&&(t=this.FloatPrecision)}this.Frame.CustomHorizontalInfo=[];var r=this.InvokeCustomYCoordinateCallback();if(!r||1!=r.PreventDefault){for(var n,o,s=0;s<this.Custom.length;++s){var h=this.Custom[s];if(h.Type==oa.LATEST_VALUE_ID||h.Type==oa.PAGE_DATA_INCREASE||h.Type==oa.PAGE_LAST_PRICE_ID){var l=t;sa.IsNumber(h.FloatPrecision)&&h.FloatPrecision>=0&&(l=h.FloatPrecision);var u=this.GetLatestPrice(l,h);u&&(h.Type==oa.LATEST_VALUE_ID?n=u:h.Type==oa.PAGE_LAST_PRICE_ID?o=u:this.Frame.CustomHorizontalInfo.push(u))}else h.Type==oa.FIXED_VALUE_ID?this.CustomFixedCoordinate(h):h.Type==oa.PAGE_LAST_INDEX_VALUE_ID&&this.CustomLatestIndexDataCoordinate(h)}(n||o)&&(n&&o&&!0===o.IsLast?this.Frame.CustomHorizontalInfo.unshift(n):(n&&this.Frame.CustomHorizontalInfo.unshift(n),o&&this.Frame.CustomHorizontalInfo.push(o)))}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1],i=!0;if(2==e.Type){var r=this.GetKLinePageInfo();r&&(a=r.End.Item,i=r.IsLast)}var n=new Y;n.Type=0,e&&sa.IsNumber(e.Type)&&(n.Type=e.Type),n.Value=a.Close,n.TextColor=qi.FrameLatestPrice.TextColor,n.LineType=2;var o=a.Close.toFixed(t);if(a.Close>a.Open?n.LineColor=qi.FrameLatestPrice.UpBarColor:a.Close<a.Open?n.LineColor=qi.FrameLatestPrice.DownBarColor:n.LineColor=qi.FrameLatestPrice.UnchagneBarColor,3==e.Type){r=this.GetKLinePageInfo();if(r&&sa.IsNumber(r.Start.Item.YClose)){var s=(r.End.Item.Close-r.Start.Item.YClose)/r.Start.Item.YClose*100;o="".concat(s.toFixed(2),"%");n.LineColor=s>0?qi.FrameLatestPrice.UpBarColor:s<0?qi.FrameLatestPrice.DownBarColor:qi.FrameLatestPrice.UnchagneBarColor,n.Value=r.End.Item.Close,i=r.IsLast}}if("HH:MM"==e.DateTime&&dt.IsMinutePeriod(this.Period,!0)){var h=sa.FormatTimeString(a.Time,e.DateTime),l=[{Text:o},{Text:h}];"left"==e.Position?n.Message[0]=l:n.Message[1]=l}else if(sa.IsBool(e.CountDown)){l=[{Text:o},{Type:1}];"left"==e.Position?n.Message[0]=l:n.Message[1]=l}else"left"==e.Position?n.Message[0]=o:n.Message[1]=o;if(sa.IsNumber(e.LineType)&&(n.LineType=e.LineType),sa.IsPlusNumber(e.LineWidth)&&(n.LineWidth=e.LineWidth),e.LineDash&&(n.LineDash=e.LineDash),0==e.IsShowLine&&(n.LineType=-1),n.IsLast=i,!i||1===e.PositionEx){var u={};i||(u.EmptyBGColor=qi.FrameLatestPrice.EmptyBGColor),1===e.PositionEx&&(u.Position=1),n.ExtendData={Custom:u}}return n},this.GetFirstOpenPrice=function(){if(!this.Data)return null;for(var t=this.Frame.XPointCount,e=this.Data.DataOffset,a=0;e<this.Data.Data.length&&a<t;++e,++a){var i=this.Data.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return dt.IsTickPeriod(this.Period)?i.YClose:i.Open}return null},this.GetLast2ndClose=function(){if(!this.Data)return null;if(this.Data.Data.length<=0)return null;var t=this.Frame.XPointCount,e=this.Data.DataOffset+t-1;e>=this.Data.Data.length&&(e=this.Data.Data.length-1);for(var a=null,i=e,r=0;i>=0&&i<this.Data.Data.length;--i){var n=this.Data.Data[i];if(null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close&&(0==r?a=n.Open:1==r&&(a=n.Close),++r,r>=2))break}return a},this.CustomFixedCoordinate=function(t){for(var e=Jr(this.Symbol),a=0;a<t.Data.length;++a){var i,r=t.Data[a],n=new Y;n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,sa.IsNumber(t.LineType)&&(n.LineType=t.LineType),sa.IsPlusNumber(t.LineWidth)&&(n.LineWidth=t.LineWidth),t.LineDash&&(n.LineDash=t.LineDash),0==t.IsShowLine&&(n.LineType=-1),n.Value=r.Value,i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,1===t.PositionEx&&(n.ExtendData={Custom:{Position:1}}),sa.IsNonEmptyArray(r.ExtendLine)&&(n.ExtendLine=r.ExtendLine.slice()),this.Frame.CustomHorizontalInfo.push(n)}},this.IntegerCoordinateSplit2=function(t){var e=this.FrameSplitData2.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=parseInt((t.Max/e.FixInterval+.5).toFixed(0))*e.FixInterval,i=parseInt((t.Min/e.FixInterval-.5).toFixed(0))*e.FixInterval;0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var r=0,n=i;n-a<1e-8;n+=e.FixInterval)++r;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=r,!0}}function la(){this.newMethod=sa,this.newMethod(),delete this.newMethod,this.SplitCount=3,this.FloatPrecision=2,this.FLOATPRECISION_RANGE=[1,.1,.01,.001,1e-4],this.SplitType=0,this.FilterType=0,this.DefaultSplitType=0,this.Custom=[],this.DefaultYMaxMin,this.EnableRemoveZero=qi.Frame.EnableRemoveZero,this.LineType=null,this.IgnoreYValue=null,this.FixedYMaxMin,this.EnableZoomUpDown=!1,this.IsBeforeData=!1,this.BeforeOpenData,this.IsAfterData=!1,this.AfterCloseData,this.ShareAfterVol=0,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.OverlayIdentify,this.HQChart,this.OverlayIndex,this.IsEnableDragY=function(){return!0},this.Reset=function(){this.EnableRemoveZero=qi.Frame.EnableRemoveZero,this.StringFormat=qi.Frame.StringFormat},this.SetOption=function(t){t&&(sa.IsNumber(t.FloatPrecision)&&(this.FloatPrecision=t.FloatPrecision),sa.IsNumber(t.StringFormat)&&(this.StringFormat=t.StringFormat),sa.IsBool(t.EnableRemoveZero)&&(this.EnableRemoveZero=t.EnableRemoveZero))},this.GetFloatPrecision=function(t,e){if(t>this.FLOATPRECISION_RANGE[0])return e;if(e<0)return 2;for(;e<this.FLOATPRECISION_RANGE.length;++e)if(t>this.FLOATPRECISION_RANGE[e])break;return e},this.Operator=function(){var t={};if(t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,this.Frame.YMaxMin){var e=this.Frame.YMaxMin;sa.IsNumber(e.Max)&&sa.IsNumber(e.Min)&&(t.Max=e.Max,t.Min=e.Min)}t.Max==t.Min&&(0==t.Max?(t.Max=1,t.Min=-1):(t.Max+=.01*t.Max,t.Min-=.01*t.Min));var a=!1;if(this.FixedYMaxMin&&sa.IsNumber(this.FixedYMaxMin.Max)&&sa.IsNumber(this.FixedYMaxMin.Min)&&(a=!0),a)t.Max=this.FixedYMaxMin.Max,t.Min=this.FixedYMaxMin.Min;else if(this.DefaultYMaxMin){var i=this.DefaultYMaxMin;sa.IsNumber(i.Max)&&(t.Min>i.Max?t.Min=i.Max:t.Max<i.Max&&(t.Max=i.Max)),sa.IsNumber(i.Min)&&(t.Max<i.Min?t.Max=i.Min:t.Min>i.Min&&(t.Min=i.Min))}if(this.Frame.YSpecificMaxMin?(t.Count=this.Frame.YSpecificMaxMin.Count,t.Interval=(t.Max-t.Min)/(t.Count-1)):1==this.SplitType||a?(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):2==this.SplitType?(t.Max=100,t.Min=0,t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit(t)),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.Frame.HorizontalInfo=[],this.Frame.YSplitScale)for(var r in this.Frame.YSplitScale){var n=this.Frame.YSplitScale[r],o=new Y;o.Value=n,sa.IsNumber(this.LineType)&&(o.LineType=this.LineType);var s=Math.abs(n);if(s<1e-10)o.Message[1]=0;else if(s<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1])o.Message[1]=n.toExponential(2).toString();else{var h=this.GetFloatPrecision(s,this.FloatPrecision);o.Message[1]=sa.FormatValueString(n,h,this.LanguageID)}o.Message[0]=o.Message[1],0==this.IsShowLeftText&&(this.Frame.HorizontalInfo[r].Message[0]=null),0==this.IsShowRightText&&(this.Frame.HorizontalInfo[r].Message[1]=null),this.Frame.HorizontalInfo.push(o)}else for(r=0,n=t.Min;r<t.Count;++r,n+=t.Interval){o=new Y;this.Frame.HorizontalInfo[r]=o,o.Value=n,sa.IsNumber(this.LineType)&&(o.LineType=this.LineType);var l=this.FormatValueString(n);this.Frame.HorizontalInfo[r].Message[0]=this.Frame.HorizontalInfo[r].Message[1]=l,0==this.IsShowLeftText&&(this.Frame.HorizontalInfo[r].Message[0]=null),0==this.IsShowRightText&&(this.Frame.HorizontalInfo[r].Message[1]=null)}if(this.FilterIgnoreYValue(),this.CustomCoordinate(),1!=this.SplitType&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,t.Max>0&&t.Min<0,this.FilterType)),this.RightFrameSplitY(),this.MainOverlayFrameSplitY(),this.CallAcutionSplitYV2(t,this.Frame.HorizontalInfo.slice()),this.EnableRemoveZero&&this.RemoveZero(this.Frame.HorizontalInfo),this.DynamicMessageText(),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,1!=this.EnableZoomUpDown||this.FixedYMaxMin||(this.FixedYMaxMin={Max:t.Max,Min:t.Min}),this.ReservedHeight(t),this.GetEventCallback){var u=this.GetEventCallback(m.ON_SPLIT_YCOORDINATE);if(u&&u.Callback){var C={ID:this.Frame.Identify,Frame:this.Frame};this.OverlayIdentify&&(C.OverlayIdentify=this.OverlayIdentify),u.Callback(u,C,this)}}},this.FormatValueString=function(t){var e;if(1==this.StringFormat){var a=this.FloatPrecision;sa.IsNumber(t)&&Math.abs(t)>1e3&&(a=0),e=sa.FormatValueString(t,a,this.LanguageID)}else if(2==this.StringFormat)e="".concat(t.toFixed(this.FloatPrecision));else{var i=Math.abs(t);if(i<1e-10)e=0;else if(i<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1])e=t.toExponential(2).toString();else{a=this.GetFloatPrecision(i,this.FloatPrecision);e=sa.FormatValueString(t,a,this.LanguageID)}}return e},this.FilterIgnoreYValue=function(){if(this.IgnoreYValue&&!(this.IgnoreYValue.length<=0)){var t=new Set(this.IgnoreYValue);this.Frame.HorizontalInfo=this.Frame.HorizontalInfo.filter((function(e){return!t.has(e.Value)}))}},this.DynamicMessageText=function(){if(2==this.SplitType)for(var t=0;t<this.Frame.HorizontalInfo.length;++t){var e=this.Frame.HorizontalInfo[t];e.Message[0]&&(e.Message[0]+="%"),e.Message[1]&&(e.Message[1]+="%")}},this.CallAcutionSplitYV2=function(t,e){if(this.IsCallAuctionFrame()&&sa.IsNonEmptyArray(e)){var a=this.GetCallAcutionSplitYV2(t,e);if(a){for(var i=0;i<this.Frame.HorizontalInfo.length;++i){var r=this.Frame.HorizontalInfo[i];a.IsBeforeData&&(r.Message[2]=r.Message[0],r.Message[0]=null),!a.IsAfterData||0!=this.ShareAfterVol&&2!=this.ShareAfterVol||(r.Message[3]=r.Message[1],r.Message[1]=null)}for(i=0;i<a.HorizontalInfo.length;++i){r=a.HorizontalInfo[i];this.Frame.HorizontalInfo.push(r)}}}},this.GetCallAcutionSplitYV2=function(t,e){if(!this.IsCallAuctionFrame())return null;var a=1==this.IsBeforeData&&this.BeforeOpenData&&(2==this.BeforeOpenData.Ver||3==this.BeforeOpenData.Ver),i=1==this.IsAfterData&&this.AfterCloseData&&(2==this.AfterCloseData.Ver||3==this.AfterCloseData.Ver),r=this.Frame.ChartBorder.GetBottomEx(),n=this.Frame.ChartBorder.GetHeightEx(),o=this.Frame.IsHScreen;if(this.Frame.IsHScreen)var s=this.Frame.GetBorder(),h=s.RightEx-s.LeftEx;if(a||i){for(var l=[],u=0;u<e.length;++u){var C=e[u];if(C&&sa.IsNumber(C.Value)){var D=this.Frame.GetYFromData(C.Value),f=new Y;if(f.Value=C.Value,f.LineType=8,a){if(o)var c=(D-s.LeftEx)/h*(this.BeforeOpenData.VolMax-this.BeforeOpenData.VolMin)+this.BeforeOpenData.VolMin;else c=(r-D)/n*(this.BeforeOpenData.VolMax-this.BeforeOpenData.VolMin)+this.BeforeOpenData.VolMin;f.Message[0]=this.FormatValueString(c)}if(i&&(0==this.ShareAfterVol||2==this.ShareAfterVol)){if(o)c=(D-s.LeftEx)/h*(this.AfterCloseData.VolMax-this.AfterCloseData.VolMin)+this.AfterCloseData.VolMin;else c=(r-D)/n*(this.AfterCloseData.VolMax-this.AfterCloseData.VolMin)+this.AfterCloseData.VolMin;f.Message[1]=this.FormatValueString(c)}l.push(f)}}return{HorizontalInfo:l,IsBeforeData:a,IsAfterData:i}}var m=!1,d=!1,I=null,S=null;if(this.MultiDayBeforeOpenData&&sa.IsNonEmptyArray(this.MultiDayBeforeOpenData)){m=!0;var T=this.MultiDayBeforeOpenData[0];2!=T.Ver&&3!=T.Ver||(I=T)}if(this.MultiDayAfterCloseData&&sa.IsNonEmptyArray(this.MultiDayAfterCloseData)){d=!0;T=this.MultiDayAfterCloseData[0];2!=T.Ver&&3!=T.Ver||(S=T)}if(m||d){for(l=[],u=0;u<e.length;++u){C=e[u];if(C&&sa.IsNumber(C.Value)){D=this.Frame.GetYFromData(C.Value),f=new Y;f.Value=C.Value,f.LineType=9;var v=!1;if(I){if(o)c=(D-s.LeftEx)/h*(I.VolMax-I.VolMin)+I.VolMin;else c=(r-D)/n*(I.VolMax-I.VolMin)+I.VolMin;f.Message[0]=this.FormatValueString(c),v=!0}if(S&&(0==this.ShareAfterVol||2==this.ShareAfterVol)){if(o)c=(D-s.LeftEx)/h*(S.VolMax-S.VolMin)+S.VolMin;else c=(r-D)/n*(S.VolMax-S.VolMin)+S.VolMin;f.Message[1]=this.FormatValueString(c),v=!0}v&&l.push(f)}}if(sa.IsNonEmptyArray(l))return{HorizontalInfo:l,IsBeforeData:m,IsAfterData:d}}return null},this.IsCallAuctionFrame=function(){return 1==this.Frame.Identify||!(!this.HQChart||!this.HQChart.IsCallAuctionFrame)&&this.HQChart.IsCallAuctionFrame(this.Frame.Identify)},this.RightFrameSplitY=function(){if(this.Frame.RightFrame){var t=this.Frame.RightFrame;t.YSplitOperator&&t.YSplitOperator.Operator();for(var e=0;e<this.Frame.HorizontalInfo.length;++e){var a=this.Frame.HorizontalInfo[e],i=this.Frame.GetYFromData(a.Value),r=t.GetYData(i);a.Message[1]=sa.FormatValueString(r,this.FloatPrecision,this.LanguageID)}}},this.MainOverlayFrameSplitY=function(){if(this.Frame.GetMainOverlayFrame){var t=this.Frame.GetMainOverlayFrame();if(t){if(t[1]){var e=t[1],a=e.YSplitOperator;a&&a.Operator();for(var i=0;i<this.Frame.HorizontalInfo.length;++i){var r=this.Frame.HorizontalInfo[i],n=this.Frame.GetYFromData(r.Value),o=e.GetYData(n);a&&a.FormatValueString?r.Message[1]=a.FormatValueString(o):r.Message[1]=this.FormatValueString(o)}}if(t[0]){var s=t[0];a=s.YSplitOperator;a&&a.Operator();for(i=0;i<this.Frame.HorizontalInfo.length;++i){r=this.Frame.HorizontalInfo[i],n=this.Frame.GetYFromData(r.Value),o=s.GetYData(n);a&&a.FormatValueString?r.Message[0]=a.FormatValueString(o):r.Message[0]=this.FormatValueString(o)}}}}},this.CustomCoordinate=function(){this.Frame.CustomHorizontalInfo=[];var t=this.InvokeCustomYCoordinateCallback();if((!t||1!=t.PreventDefault)&&sa.IsNonEmptyArray(this.Custom))for(var e=0;e<this.Custom.length;++e){var a=this.Custom[e];a.Type==oa.PAGE_LAST_INDEX_VALUE_ID?this.CustomLatestIndexDataCoordinate(a):a.Type==oa.FIXED_VALUE_ID?this.CustomFixedCoordinate(a):a.Type==oa.PAGE_LAST_OVERLAY_INDEX_VALUE_ID&&this.CustomLatestOverlayIndexDataCoordinate(a)}},this.CustomFixedCoordinate=function(t){if(sa.IsNonEmptyArray(t.Data))for(var e=0;e<t.Data.length;++e){var a,i=t.Data[e],r=new Y;r.Type=1,r.TextColor=i.TextColor,r.LineColor=i.Color,r.LineType=2,sa.IsNumber(t.LineType)&&(r.LineType=t.LineType),0==t.IsShowLine&&(r.LineType=-1),r.Value=i.Value,a=i.Text?i.Text:r.Value.toFixed(2),"left"==t.Position?r.Message[0]=a:r.Message[1]=a,this.Frame.CustomHorizontalInfo.push(r)}}}function ua(){this.newMethod=sa,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Period,this.Symbol,this.MinTextDistance=50*F(),this.MinBarDistance=5,this.SplitDateTime=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=0,o=e;n<a&&o<this.Frame.Data.Data.length;++n,++o){i+=t,++r;var s=null;if(0==n){var h=sa.FormatDateString(this.Frame.Data.Data[o].Date,"MM-DD");s={Value:o-e,Text:h}}else if(i>this.MinTextDistance&&r>=this.MinBarDistance){var l=sa.FormatTimeString(this.Frame.Data.Data[o].Time);s={Value:o-e,Text:l}}if(s){var u=new Y;u.Value=s.Value,this.ShowText&&(u.Message[0]=s.Text),0==u.Value&&(u.LineType=-1),this.Frame.VerticalInfo.push(u),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitSecond=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=0,o=e;n<a&&o<this.Frame.Data.Data.length;++n,++o){i+=t,++r;var s=null;if(0==n){var h=sa.FormatDateString(this.Frame.Data.Data[o].Date,"MM-DD");s={Value:o-e,Text:h}}else if(i>this.MinTextDistance&&r>=this.MinBarDistance){var l=sa.FormatTimeString(this.Frame.Data.Data[o].Time,"HH:MM:SS");s={Value:o-e,Text:l}}if(s){var u=new Y;u.Value=s.Value,this.ShowText&&(u.Message[0]=s.Text),this.Frame.VerticalInfo.push(u),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitMilliSecond=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=0,o=e;n<a&&o<this.Frame.Data.Data.length;++n,++o){i+=t,++r;var s=null;if(0==n){var h=sa.FormatDateString(this.Frame.Data.Data[o].Date,"HH:MM:SS.fff");s={Value:o-e,Text:h}}else if(i>this.MinTextDistance&&r>=this.MinBarDistance){var l=sa.FormatTimeString(this.Frame.Data.Data[o].Time,"HH:MM:SS.fff");s={Value:o-e,Text:l}}if(s){var u=new Y;u.Value=s.Value,this.ShowText&&(u.Message[0]=s.Text),this.Frame.VerticalInfo.push(u),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=null,i=null,r=0,n=0,o=t,s=12;n<e&&o<this.Frame.Data.Data.length;++n,++o){var h=parseInt(this.Frame.Data.Data[o].Date/1e4),l=parseInt(this.Frame.Data.Data[o].Date/100)%100;if(i!=l&&++r,s<12||null!=a&&a==h&&null!=i&&i==l)i=l,++s;else{var u,C=new Y;C.Value=o-t,null==a||a!=h?u=h.toString():null!=i&&i==l||(u=l.toString()+"月",u=$i.GetText(u,this.LanguageID)),a=h,i=l,this.ShowText&&(C.Message[0]=u),0==C.Value&&(C.LineType=-1),this.Frame.VerticalInfo.push(C),s=0}}0==this.Period&&r<=2&&this.SplitShortDate()},this.SplitShortDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=!0,i=0,r=t,n=12;i<e&&r<this.Frame.Data.Data.length;++i,++r){var o=parseInt(this.Frame.Data.Data[r].Date/1e4);if(n<12)++n;else{var s=new Y;s.Value=r-t,a?(u=o.toString(),a=!1):u=sa.FormatDateString(this.Frame.Data.Data[r].Date,"MM-DD"),this.ShowText&&(s.Message[0]=u),0==s.Value&&(s.LineType=-1),this.Frame.VerticalInfo.push(s),n=0}}if(1==this.Frame.VerticalInfo.length){var h=this.Frame.VerticalInfo[0],l=(r=h.Value+t,this.Frame.Data.Data[r]),u=sa.FormatDateString(l.Date,"YYYY-MM");this.ShowText&&(h.Message[0]=u)}},this.Operator=function(){if(null!=this.Frame.Data&&(ua.SplitCustom?ua.SplitCustom(this):dt.IsMinutePeriod(this.Period,!0)?this.SplitDateTime():dt.IsSecondPeriod(this.Period)||dt.IsTickPeriod(this.Period)?this.SplitSecond():dt.IsMilliSecondPeriod(this.Period)?this.SplitMilliSecond():this.SplitDate(),this.GetEventCallback)){var t=this.GetEventCallback(m.ON_SPLIT_XCOORDINATE);if(t&&t.Callback){var e={ID:this.Frame.Identify,Frame:this.Frame,IsShowText:this.ShowText};t.Callback(t,e,this)}}},this.CreateCoordinateInfo=function(){return new Y}}function Ca(){this.newMethod=sa,this.newMethod(),delete this.newMethod,this.High=null,this.Low=null,this.YClose,this.Data,this.SourceData,this.OverlayChartPaint,this.SplitCount=7,this.Symbol,this.SplitType=0,this.DefaultSplitType=0,this.LimitPrice,this.Custom,this.RightTextFormat=0,this.BeforeOpenData,this.IsBeforeData=!1,this.AfterCloseData,this.IsAfterData=!1,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.DayOffset,this.AverageData,this.DayCount=1,this.GlobalOption,this.HQChart,this.FixedYMaxMin,this.EnableZoomUpDown=!1,this.IsEnableDragY=function(){return!0},this.Operator=function(){if(this.Frame.HorizontalInfo=[],this.Frame.CustomHorizontalInfo=[],this.Data){var t=null,e=this.FixedYMaxMin&&sa.IsNumber(this.FixedYMaxMin.Max)&&sa.IsNumber(this.FixedYMaxMin.Min);if(e?(t={Max:this.FixedYMaxMin.Max,Min:this.FixedYMaxMin.Min},u.Chart.Log("[FrameSplitMinutePriceY::Operator] FixedYMaxMin.Max=".concat(this.FixedYMaxMin.Max," FixedYMaxMin.Min=").concat(this.FixedYMaxMin.Min," "))):t=this.GetMaxMin(),this.Symbol&&Pr.IsUSA(this.Symbol.toUpperCase())||2==this.SplitType?this.USASplit(t,e):this.DefaultSplit(t,e),this.CustomCoordinate(),1!=this.EnableZoomUpDown||this.FixedYMaxMin||(this.FixedYMaxMin={Max:t.Max,Min:t.Min}),this.ReservedHeight({Max:this.Frame.HorizontalMax,Min:this.Frame.HorizontalMin}),this.GetEventCallback){var a=this.GetEventCallback(m.ON_SPLIT_YCOORDINATE);if(a&&a.Callback){var i={ID:this.Frame.Identify,Frame:this.Frame};a.Callback(a,i,this)}}}},this.CustomCoordinate=function(){this.Frame.CustomHorizontalInfo=[];var t=this.InvokeCustomYCoordinateCallback();if((!t||1!=t.PreventDefault)&&this.Custom){var e=Jr(this.Symbol);for(var a in this.Custom){var i=this.Custom[a];if(1==i.Type)this.CustomFixedCoordinate(i);else if(0==i.Type){var r=this.GetLatestPrice(e,i);r&&this.Frame.CustomHorizontalInfo.push(r)}}}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1];if(!sa.IsNumber(a)||!sa.IsNumber(this.YClose))return null;var i=new Y;i.Type=0,i.Value=a,i.TextColor=qi.FrameLatestPrice.TextColor,i.LineType=2;var r=a.toFixed(t);if("HH:MM"==e.DateTime){var n=this.Frame.Data.Data[this.Frame.Data.Data.length-1],o=sa.FormatTimeString(n.Time,e.DateTime),s=[{Text:r},{Text:o}];"left"==e.Position?i.Message[0]=s:i.Message[1]=s}else"left"==e.Position?i.Message[0]=r:i.Message[1]=r;return a>this.YClose?i.LineColor=qi.FrameLatestPrice.UpBarColor:a<this.YClose?i.LineColor=qi.FrameLatestPrice.DownBarColor:i.LineColor=qi.FrameLatestPrice.UnchagneBarColor,sa.IsNumber(e.LineType)&&(i.LineType=e.LineType),sa.IsPlusNumber(e.LineWidth)&&(i.LineWidth=e.LineWidth),e.LineDash&&(i.LineDash=e.LineDash),0==e.IsShowLine&&(i.LineType=-1),1===e.PositionEx&&(i.ExtendData={Custom:{Position:1}}),i},this.CustomFixedCoordinate=function(t){for(var e=Jr(this.Symbol),a=0;a<t.Data.length;++a){var i,r=t.Data[a],n=new Y;if(n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,sa.IsNumber(t.LineType)&&(n.LineType=t.LineType),sa.IsPlusNumber(t.LineWidth)&&(n.LineWidth=t.LineWidth),t.LineDash&&(n.LineDash=t.LineDash),0==t.IsShowLine&&(n.LineType=-1),1===t.PositionEx&&(n.ExtendData={Custom:{Position:1}}),sa.IsNumber(r.Increase)){if(!sa.IsNumber(this.YClose))continue;n.Value=this.YClose*(1+r.Increase)}else n.Value=r.Value;i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,this.Frame.CustomHorizontalInfo.push(n)}},this.GetCallAuctionMaxMin=function(t,e){for(var a in t.Data){var i=t.Data[a];i&&(sa.IsNumber(i.Price)&&(null==e.Max&&(e.Max=i.Price),null==e.Min&&(e.Min=i.Price),e.Max<i.Price&&(e.Max=i.Price),e.Min>i.Price&&(e.Min=i.Price)),3==t.Ver&&sa.IsNumber(i.AvPrice)&&(null==e.Max&&(e.Max=i.AvPrice),null==e.Min&&(e.Min=i.AvPrice),e.Max<i.AvPrice&&(e.Max=i.AvPrice),e.Min>i.AvPrice&&(e.Min=i.AvPrice)))}},this.GetMultiDayBeforeOpenData=function(){if(!this.MultiDayBeforeOpenData||!sa.IsNonEmptyArray(this.MultiDayBeforeOpenData))return null;if(!this.DayOffset)return this.MultiDayBeforeOpenData;if(!sa.IsNumber(this.DayOffset.Offset)||!sa.IsNumber(this.DayOffset.ShowDayCount))return null;if(this.GlobalOption&&!0===this.GlobalOption.IsValueFullRange)return this.MultiDayBeforeOpenData;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayBeforeOpenData.slice(e,e+t);return a},this.GetMultiDayAfterCloseData=function(){if(!this.MultiDayAfterCloseData||!sa.IsNonEmptyArray(this.MultiDayAfterCloseData))return null;if(!this.DayOffset)return this.MultiDayAfterCloseData;if(!sa.IsNumber(this.DayOffset.Offset)||!sa.IsNumber(this.DayOffset.ShowDayCount))return null;if(this.GlobalOption&&!0===this.GlobalOption.IsValueFullRange)return this.MultiDayAfterCloseData;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayAfterCloseData.slice(e,e+t);return a},this.GetMaxMin=function(){var t=this.YClose,e=this.YClose,a=this.Data,i=!1;if(this.SourceData&&(a=this.SourceData,i=!0),this.DayCount>1){var r=this.DayOffset.DataOffset,n=this.DayOffset.ShowDataCount;this.GlobalOption&&!0===this.GlobalOption.IsValueFullRange&&(r=0,n=a.Data.length);for(var o=r,s=0;o<a.Data.length&&s<n;++o,++s){var h=null;if(i){var l=a.Data[o];h=l.Before?l.Before.Close:l.Close}else h=a.Data[o];null!=h&&(t<h&&(t=h),e>h&&(e=h))}if(this.AverageData)for(o=r,s=0;o<this.AverageData.Data.length&&s<n;++o,++s)null!=this.AverageData.Data[o]&&(t<this.AverageData.Data[o]&&(t=this.AverageData.Data[o]),e>this.AverageData.Data[o]&&(e=this.AverageData.Data[o]))}else{for(o=0;o<a.Data.length;++o){h=null;if(i){l=a.Data[o];h=l.Before?l.Before.Close:l.Close}else h=a.Data[o];null!=h&&(t<h&&(t=h),e>h&&(e=h))}if(this.AverageData)for(o=0;o<this.AverageData.Data.length;++o)null!=this.AverageData.Data[o]&&(t<this.AverageData.Data[o]&&(t=this.AverageData.Data[o]),e>this.AverageData.Data[o]&&(e=this.AverageData.Data[o]))}for(var o in this.OverlayChartPaint){l=this.OverlayChartPaint[o];var u=l.GetMaxMin();u.Max&&u.Max>t&&(t=u.Max),u.Min&&u.Min<e&&(e=u.Min)}1==this.SplitType&&this.LimitPrice&&(t<this.LimitPrice.Max&&(t=this.LimitPrice.Max),e>this.LimitPrice.Min&&(e=this.LimitPrice.Min)),sa.IsNumber(this.High)&&sa.IsNumber(this.Low)&&(t<this.High&&(t=this.High),e>this.Low&&(e=this.Low));u={Max:null,Min:null};this.IsAfterData&&this.AfterCloseData&&this.GetCallAuctionMaxMin(this.AfterCloseData,u),this.IsBeforeData&&this.BeforeOpenData&&this.GetCallAuctionMaxMin(this.BeforeOpenData,u);var C=this.GetMultiDayBeforeOpenData();if(C&&this.ChartBorder.MultiDayMinute.Count>1&&this.ChartBorder.MultiDayMinute.Left>0)for(o=0;o<C.length;++o){var D=C[o];this.GetCallAuctionMaxMin(D,u)}var f=this.GetMultiDayAfterCloseData();if(f&&this.ChartBorder.MultiDayMinute.Count>1&&this.ChartBorder.MultiDayMinute.Right>0)for(o=0;o<f.length;++o){D=f[o];this.GetCallAuctionMaxMin(D,u)}sa.IsNumber(u.Max)&&t<u.Max&&(t=u.Max),sa.IsNumber(u.Min)&&e>u.Min&&(e=u.Min);var c=this.GetOverlayMaxMin();return c&&(sa.IsNumber(c.Max)&&c.Max>t&&(t=c.Max),sa.IsNumber(c.Min)&&c.Min<e&&(e=c.Min)),{Max:t,Min:e}},this.GetOverlayMaxMin=function(){if(!this.HQChart)return null;if(!this.HQChart.Frame||!this.HQChart.Frame.SubFrame)return null;var t=this.HQChart.Frame.SubFrame[0];if(!t)return null;if(!sa.IsNonEmptyArray(t.OverlayIndex))return null;for(var e={Max:null,Min:null},a=0;a<t.OverlayIndex.length;++a){var i=t.OverlayIndex[a];if(i&&i.Frame){var r=i.Frame;if(1==r.IsShareY&&!1!==r.IsCalculateYMaxMin)for(var n=0;n<i.ChartPaint.length;++n){var o=i.ChartPaint[n];if(0!=o.IsShow){var s=o.GetMaxMin();null!=s&&null!=s.Max&&null!=s.Min&&((null==e.Max||e.Max<s.Max)&&(e.Max=s.Max),(null==e.Min||e.Min>s.Min)&&(e.Min=s.Min))}}}}return e},this.USASplit=function(t){var e=t.Max,a=t.Min;if(e==a)e+=.1*e,a-=.1*a;else{var i=F(),r=this.Frame.ChartBorder.GetHeight(),n=5*i*(e-a)/r;e+=n,a-=n,a<0&&(a=t.Min)}var o=this.SplitCount,s=(e-a)/(o-1),h=[1,.1,.01,.001,1e-4],l=Jr(this.Symbol);s<h[l]&&(s=h[l],e=a+s*o);for(var u=0;u<o;++u){var C=a+s*u;if(!this.YClose||C!=this.YClose){var D=new Y;D.Value=C,this.FormatCoordinate(D,l),this.Frame.HorizontalInfo.push(D)}}if(this.YClose>a&&this.YClose<e){D=new Y;D.Value=this.YClose,D.LineType=2,qi.FrameDotSplitPen&&(D.LineColor=qi.FrameDotSplitPen);var f=this.YClose.toFixed(l);this.IsShowLeftText&&(D.Message[0]=f),this.IsShowRightText&&(1==this.RightTextFormat?D.Message[1]=f:D.Message[1]="0.00%"),this.Frame.HorizontalInfo.push(D)}this.Frame.HorizontalInfo.sort((function(t,e){return t.Value-e.Value})),this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a},this.DefaultSplit=function(t,e){var a=t.Max,i=t.Min;if(!e)if(this.YClose==a&&this.YClose==i)a=this.YClose+.1*this.YClose,i=this.YClose-.1*this.YClose;else{var r=Math.max(Math.abs(this.YClose-a),Math.abs(this.YClose-i));a=this.YClose+r,i=this.YClose-r}var n=F(),o=this.Frame.ChartBorder.GetChartWidth(),s=o<450*n;u.Chart.Log("[FrameSplitMinutePriceY]max="+a+" min="+i+" isPhoneModel="+s);var h=this.SplitCount,l=(a-i)/(h-1),C=[1,.1,.01,.001,1e-4],D=Jr(this.Symbol);s&&Pr.IsSHSZIndex(this.Symbol)&&(D=0),l<C[D]&&!e&&(l=C[D],a=this.YClose+l*(h-1)/2,i=this.YClose-l*(h-1)/2);for(var f=[],c=.5*l,m=this.YClose,d=0;m<=a+c&&d<30;m+=l,++d){var I=new Y;I.Value=m,this.FormatCoordinate(I,D),f.push(I)}for(m=this.YClose-l,d=0;m>=i-c&&d<30;m-=l,++d){I=new Y;I.Value=m,this.FormatCoordinate(I,D),f.push(I)}f.sort((function(t,e){return t.Value-e.Value})),this.Frame.HorizontalInfo=f,this.Frame.HorizontalMax=a,this.Frame.HorizontalMin=i},this.FormatCoordinate=function(t,e){var a=t.Value,i=a.toFixed(e);if(this.IsShowLeftText&&(t.Message[0]=i),sa.IsNumber(this.YClose)&&0!=this.YClose){var r=100*(a/this.YClose-1);r>0?t.TextColor=qi.UpTextColor:r<0&&(t.TextColor=qi.DownTextColor);var n="".concat(sa.FormatValueString(r,2),"%");this.IsShowRightText&&(1==this.RightTextFormat?t.Message[1]=i:2==this.RightTextFormat?t.Message[1]=[{Text:i},{Text:"/"},{Text:n}]:t.Message[1]=n),Math.abs(a-this.YClose)<1e-11&&(t.LineType=2,t.TextColor=qi.UnchagneTextColor,qi.FrameDotSplitPen&&(t.LineColor=qi.FrameDotSplitPen))}}}function Da(){this.newMethod=sa,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Symbol=null,this.DayCount=1,this.DateFormat=0,this.Operator=function(){this.Frame.VerticalInfo=[];this.Frame.XPointCount;var t=this.Frame.ChartBorder.GetWidth(),e=!0===this.Frame.IsHScreen;e&&(t=this.Frame.ChartBorder.GetHeight()),t/=F();var a=Vr,i=a.GetCoordinateData(this.Symbol,t),r=i.Count,n=i.MiddleCount>0?i.MiddleCount:parseInt(r/2),o=i.Data;if(this.Frame.XPointCount=r*this.DayCount,this.Frame.MinuteCount=r,this.Frame.VerticalInfo=[],this.Frame.GlobalOption){var s=this.Frame.GlobalOption;sa.IsNumber(s.XDateFormat)&&(this.DateFormat=s.XDateFormat)}if(this.DayCount<=1){this.DayOffset.DataOffset=0,this.DayOffset.ShowDataCount=r,this.DayOffset.PageInfo=null;for(var h=0;h<o.length;++h){var l=new Y;s=o[h];qi.Minute.FrameSplitTextColor&&(l.TextColor=qi.Minute.FrameSplitTextColor),l.Value=s[0],this.ShowText&&(l.Message[0]=s[3]),s[4]&&(l.LineColor=s[4]),s[5]&&(l.TextBGColor=s[5]),this.Frame.VerticalInfo[h]=l}}else if(sa.IsNonEmptyArray(this.DayData)){var u=0,C=this.DayData.length;this.DayOffset&&(sa.IsNumber(this.DayOffset.Offset)&&(u=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(C=this.DayOffset.ShowDayCount)),this.DayOffset.DataOffset=u*r,this.DayOffset.ShowDataCount=this.DayOffset.ShowDayCount*r,this.DayOffset.PageInfo={Day:[]};h=this.DayData.length-1-u;for(var D=0;h>=0&&D<C;--h,++D){l=new Y;l.Value=D*r+n,l.LineType=-1,this.ShowText&&(l.Message[0]=this.FormatDate(this.DayData[h].Date),l.BG={Index:{Start:D*r+1,End:(D+1)*r-1},Date:this.DayData[h].Date}),this.Frame.VerticalInfo.push(l);l=new Y;l.Value=(D+1)*r,this.Frame.VerticalInfo.push(l),this.DayOffset.PageInfo.Day.push({Date:this.DayData[h].Date,Index:h})}}if(this.GetEventCallback){var f=this.GetEventCallback(m.ON_SPLIT_XCOORDINATE);if(f&&f.Callback){var c={ID:this.Frame.Identify,Frame:this.Frame};f.Callback(f,c,this)}}},this.FormatDate=function(t){switch(this.DateFormat){case 1:return sa.FormatDateString(t,"MM/DD");case 2:return sa.FormatDateString(t,"MM/DD/W");default:return sa.FormatDateString(t,"MM-DD")}}}function fa(){this.newMethod=sa,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.SplitCount=3,this.Symbol,this.LineType=3,this.Operator=function(){var t=this.Frame.VerticalRange;if(t){this.Frame.VerticalInfo=[];var e=2;this.Symbol&&(e=Jr(this.Symbol));var a=t.Max,i=t.Min;if(t.Bid)for(var r=(t.Bid.Max-i)/this.SplitCount,n=0;n<this.SplitCount;++n){var o=new Y;o.Value=i+r*n,o.Value<=0||(sa.IsNumber(this.LineType)&&(o.LineType=this.LineType),this.ShowText&&(o.Message[0]=o.Value.toFixed(e)),this.Frame.VerticalInfo.push(o))}o=new Y;if(o.Value=t.Center,this.Frame.VerticalInfo.push(o),t.Ask)for(r=(a-t.Ask.Min)/this.SplitCount,n=1;n<=this.SplitCount;++n){o=new Y;o.Value=t.Ask.Min+r*n,sa.IsNumber(this.LineType)&&(o.LineType=this.LineType),this.ShowText&&(o.Message[0]=o.Value.toFixed(e)),this.Frame.VerticalInfo.push(o)}if(this.GetEventCallback){var s=this.GetEventCallback(m.ON_SPLIT_XCOORDINATE);if(s&&s.Callback){var h={ID:this.Frame.Identify,Frame:this.Frame};s.Callback(s,h,this)}}}}}function ca(){this.Frame,this.Value,this.Point,this.ClientPos,this.BeforOpeneData,this.AfterCloseData,this.X,this.Item,this.DataIndex,this.DayIndex,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.DayOffset,this.Operator=function(){return this.Item=null,this.DataIndex=null,this.DayIndex=null,2==this.ClientPos?this.GetBeforeOpenXIndex():3==this.ClientPos?this.GetAfterCloseXIndex():this.ClientPos>=200&&this.ClientPos<=299?this.GetMultiDayBeforeOpenXIndex():this.ClientPos>=300&&this.ClientPos<=399&&this.GetMultiDayAfterCloseXIndex()},this.GetBeforeOpenXIndex=function(){if(!sa.IsNumber(this.Value))return!1;if(!this.BeforeOpenData||!this.BeforeOpenData.Data)return!1;var t=this.Frame.GetLeftExtendXData(this.Value,this.BeforeOpenData);if(t=parseInt(t.toFixed(0)),t>=0&&t<this.BeforeOpenData.Data.length){var e=this.BeforeOpenData.Data[t];if(sa.IsNumber(e.Price))return this.Item=e,this.X=this.Value,this.DataIndex=t,!0}t<0?t=0:t>=this.BeforeOpenData.Data.length&&(t=this.BeforeOpenData.Data.length-1);for(var a=-1,i=t;i>=0;--i){e=this.BeforeOpenData.Data[i];if(sa.IsNumber(e.Price)){a=i;break}}if(a<0)for(i=t+1;i<this.BeforeOpenData.Data.length;++i){e=this.BeforeOpenData.Data[i];if(sa.IsNumber(e.Price)){a=i;break}}return!(a<0)&&(this.Item=e,this.DataIndex=a,this.X=this.Frame.GetLeftExtendXFromIndex(a,this.BeforeOpenData),!0)},this.GetMultiDayBeforeOpenData=function(){if(!this.MultiDayBeforeOpenData||!sa.IsNonEmptyArray(this.MultiDayBeforeOpenData))return null;if(this.DayOffset||this.MultiDayBeforeOpenData,!sa.IsNumber(this.DayOffset.Offset)||!sa.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayBeforeOpenData.slice(e,e+t);return a},this.GetMultiDayBeforeOpenXIndex=function(){var t=this.GetMultiDayBeforeOpenData();if(!t||!sa.IsNonEmptyArray(t))return!1;var e=this.ClientPos-200;if(e<0||e>=t.length)return!1;var a=t[e],i=this.Frame.GetLeftExtendXData(this.Value,t);if(!i||!sa.IsNumber(i.DataIndex))return!1;var r=parseInt(i.DataIndex.toFixed(0));e=i.DayIndex;if(r>=0&&r<a.Data.length){var n=a.Data[r];if(sa.IsNumber(n.Price))return this.Item=n,this.X=this.Value,this.DataIndex=r,this.DayIndex=e,!0}r<0?r=0:r>=a.Data.length&&(r=a.Data.length-1);for(var o=-1,s=r;s>=0;--s){n=a.Data[s];if(n&&sa.IsNumber(n.Price)){o=s;break}}return!(o<0)&&(this.Item=n,this.DataIndex=o,this.DayIndex=e,this.X=this.Frame.GetLeftExtendXFromIndex(o,a),!0)},this.GetAfterCloseXIndex=function(){if(!sa.IsNumber(this.Value))return!1;if(!this.AfterCloseData||!this.AfterCloseData.Data)return!1;var t=this.Frame.GetRightExtendXData(this.Value,this.AfterCloseData);if(t=parseInt(t.toFixed(0)),t>=0&&t<this.AfterCloseData.Data.length){var e=this.AfterCloseData.Data[t];if(sa.IsNumber(e.Price))return this.Item=e,this.X=this.Value,this.DataIndex=t,!0}t<0?t=0:t>=this.AfterCloseData.Data.length&&(t=this.AfterCloseData.Data.length-1);for(var a=-1,i=t;i>=0;--i){e=this.AfterCloseData.Data[i];if(sa.IsNumber(e.Price)){a=i;break}}if(a<0)for(i=t+1;i<this.AfterCloseData.Data.length;++i){e=this.AfterCloseData.Data[i];if(sa.IsNumber(e.Price)){a=i;break}}return!(a<0)&&(this.Item=e,this.DataIndex=a,this.X=this.Frame.GetRightExtendXFromIndex(a,this.AfterCloseData),!0)},this.GetMultiDayAfterCloseData=function(){if(!this.MultiDayAfterCloseData||!sa.IsNonEmptyArray(this.MultiDayAfterCloseData))return null;if(this.DayOffset||this.MultiDayAfterCloseData,!sa.IsNumber(this.DayOffset.Offset)||!sa.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayAfterCloseData.slice(e,e+t);return a},this.GetMultiDayAfterCloseXIndex=function(){var t=this.GetMultiDayAfterCloseData();if(t&&sa.IsNonEmptyArray(t)){var e=this.ClientPos-300;if(!(e<0||e>=t.length)){var a=t[e],i=this.Frame.GetRightExtendXData(this.Value,t);if(i){var r=parseInt(i.DataIndex.toFixed(0));e=i.DayIndex;if(r>=0&&r<a.Data.length){var n=a.Data[r];if(sa.IsNumber(n.Price))return this.Item=n,this.X=this.Value,this.DataIndex=r,this.DayIndex=e,!0}r<0?r=0:r>=a.Data.length&&(r=a.Data.length-1);for(var o=-1,s=r;s>=0;--s){n=a.Data[s];if(n&&sa.IsNumber(n.Price)){o=s;break}}return!(o<0)&&(this.Item=n,this.DataIndex=o,this.DayIndex=e,this.X=this.Frame.GetRightExtendXFromIndex(o,a),!0)}}}}}function ma(){this.ClassName="ChartCorssCursor",this.Frame,this.Canvas,this.HPenColor=qi.CorssCursorHPenColor,this.HPenType=0,this.VPenColor=qi.CorssCursorVPenColor,this.VPenType=0,this.VLineType=0,this.Font=qi.CorssCursorTextFont,this.TextColor=qi.CorssCursorTextColor,this.TextBGColor=qi.CorssCursorBGColor,this.BorderColor=qi.CorssCursorBorderColor,this.XRangeBGColor=qi.CorssCursorXRangeBGColor,this.LineDash=qi.CorssCursorLineDash.slice(),this.TextHeight=20,this.LastPoint,this.LastValue,this.CursorIndex,this.IsOnlyDrawKLine=!1,this.IsOnlyDrawMinute=!1,this.IsFixXLastTime=!1,this.IsDrawXRangeBG=!1,this.CorssPointConfig={Enable:!1,Center:P(qi.CorssCursor.CorssPoint.Center),Border:P(qi.CorssCursor.CorssPoint.Border)},this.EnableNewIndex=!1,this.CorssCursorIndex,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.HQChart,this.ShowTextMode={Left:1,Right:1,Bottom:1},this.TextFormat={Right:0},this.IsShowCorss=!0,this.IsShow=!0,this.IsShowClose=!1,this.ClientPos=-1,this.CallAcutionXOperator,this.EnableKeyboard=!1,this.EnableDBClick=!1,this.OnChangeStatusCallback,this.RightButton={Enable:!1,Rect:null,BGColor:qi.CorssCursor.RightButton.BGColor,PenColor:qi.CorssCursor.RightButton.PenColor,Icon:P(qi.CorssCursor.RightButton.Icon)},this.BottomButton={Enable:!1,Rect:null},this.BottomConfig=P(qi.CorssCursor.BottomText),this.LeftConfig=P(qi.CorssCursor.LeftText),this.RightConfig=P(qi.CorssCursor.RightText),this.RightOverlayConfig=P(qi.CorssCursor.RightOverlayText),this.Close=null,this.Status=0,this.ReloadResource=function(t){this.Font=qi.CorssCursorTextFont,this.HPenColor=qi.CorssCursorHPenColor,this.VPenColor=qi.CorssCursorVPenColor,this.TextColor=qi.CorssCursorTextColor,this.TextBGColor=qi.CorssCursorBGColor,this.BorderColor=qi.CorssCursorBorderColor,this.XRangeBGColor=qi.CorssCursorXRangeBGColor,this.LineDash=qi.CorssCursorLineDash.slice(),this.RightButton.BGColor=qi.CorssCursor.RightButton.BGColor,this.RightButton.PenColor=qi.CorssCursor.RightButton.PenColor,this.RightButton.Icon=P(qi.CorssCursor.RightButton.Icon),this.RightOverlayConfig=P(qi.CorssCursor.RightOverlayText),this.CorssPointConfig.Center=P(qi.CorssCursor.CorssPoint.Center),this.CorssPointConfig.Border=P(qi.CorssCursor.CorssPoint.Border)},this.GetCloseYPoint=function(t){if(!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return null;var i=e.Data[a];if(!i)return null;this.Close=i.Close;var r=this.Frame.GetYFromData(this.Close);return r},this.GetMinuteCloseYPoint=function(t){if(this.EnableNewIndex&&this.CorssCursorIndex){if(!this.StringFormatX||!this.StringFormatX.GetMinuteCloseYPoint)return null;var e=this.StringFormatX.GetMinuteCloseYPoint(this.CorssCursorIndex);return e?(this.Close=e.Price,e.Y):null}if(!sa.IsNumber(t))return null;if(t=parseInt(t.toFixed(0)),!this.StringFormatX.Data)return null;var a=this.StringFormatX.Data;if(!a.Data||a.Data.length<=0)return null;var i=a.DataOffset+t;if(i>=a.Data.length&&(i=a.Data.length-1),i<0)return null;var r=a.Data[i];if(!sa.IsNumber(t))return null;this.Close=r;var n=this.Frame.GetYFromData(this.Close);return n},this.GetDateTimeRange=function(t,e){if(!sa.IsNumber(t))return null;t=parseInt(t);var a=this.StringFormatX.Data;if(!a.Data||a.Data.length<=0)return null;var i=a.DataOffset+t;if(i>=a.Data.length||i<0)return null;if(!this.Frame||!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return null;var r=this.Frame.SubFrame[0].Frame,n=r.DataWidth,o=r.DistanceWidth,s=r.XPointCount,h=a.Data[i];if(!h)return null;for(var l=1e6*h.Date,u=100*parseInt(h.Time/100),C=l+u,D=l+u+59,f=i,c=i;c<a.Data.length;++c){var m=a.Data[c],d=1e6*m.Date+m.Time;if(d>D)break;if(c-a.DataOffset>=s)break;f=c}var I=i;for(c=i;c>=0&&c>=a.DataOffset;--c){m=a.Data[c],d=1e6*m.Date+m.Time;if(d<C)break;I=c}var S={StartIndex:I,EndIndex:f};return S.XStart=this.Frame.GetXFromIndex(I-a.DataOffset),S.XEnd=this.Frame.GetXFromIndex(f-a.DataOffset),S.XStart-=(o+n)/2,S.XEnd+=(o+n)/2,S},this.FixMinuteLastTimeXPoint=function(t){if(!sa.IsNumber(t))return null;if(t=parseInt(t),!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a<e.Data.length)return null;a=e.Data.length-1,a-=e.DataOffset;var i=this.Frame.GetXFromIndex(a);return{X:i,Index:a}},this.PtInClient=function(t,e){if(this.Canvas.beginPath(),!0===this.Frame.IsHScreen){var a=this.Frame.ChartBorder.GetHScreenBorder();this.Canvas.rect(a.Left,a.TopEx,a.Right-a.Left,a.BottomEx-a.TopEx)}else{a=this.Frame.ChartBorder.GetBorder();this.Canvas.rect(a.LeftEx,a.Top,a.RightEx-a.LeftEx,a.Bottom-a.Top)}return this.Canvas.isPointInPath(t,e)?1:this.Frame.ChartBorder.LeftExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.Top,a.Right-a.Left,a.TopEx-a.Top):this.Canvas.rect(a.Left,a.Top,a.LeftEx-a.Left,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?2:this.Frame.ChartBorder.RightExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.BottomEx,a.Right-a.Left,a.Bottom-a.BottomEx):this.Canvas.rect(a.RightEx,a.Top,a.Right-a.RightEx,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?3:-1},this.GetFontHeight=function(t){return E(this.Canvas,t,"擎")},this.Draw=function(){if(this.Status=0,this.RightButton.Rect=null,this.BottomButton.Rect=null,this.LastValue=null,this.LastPoint){this.Close=null;var t=this.LastPoint.X,e=this.LastPoint.Y,a=this.PtInClient(t,e);if(this.PointY=null,this.PointY,this.ClientPos=a,!(a<=0))if(!0!==this.Frame.IsHScreen){var i=this.Frame.ChartBorder.GetBorder(),r=i.Left,n=i.Right,o=i.TopTitle,s=i.Bottom,h=(this.Frame.ChartBorder.Right,i.ChartWidth);if(this.IsOnlyDrawKLine){if(t=this.Frame.GetXFromIndex(this.CursorIndex),this.IsShowClose){var l=this.GetCloseYPoint(this.CursorIndex);null!=l&&(e=l)}}else if(this.IsOnlyDrawMinute){l=this.GetMinuteCloseYPoint(this.CursorIndex);null!=l&&(e=l)}if(this.CallAcutionXOperator&&(this.CallAcutionXOperator.Value=t,this.CallAcutionXOperator.Point={X:t,Y:e},this.CallAcutionXOperator.ClientPos=a,this.CallAcutionXOperator.Operator()&&(t=this.CallAcutionXOperator.X)),this.IsFixXLastTime){var u=this.FixMinuteLastTimeXPoint(this.CursorIndex);u&&(t=u.X,this.CursorIndex=u.Index)}if(this.PointY=[[r,e],[n,e]],this.PointX=[[t,o],[t,s]],this.IsShowCorss){var C=null;this.IsDrawXRangeBG&&(C=this.GetDateTimeRange(this.CursorIndex));var D=F();if(1!=this.HPenType&&0!=this.HPenType||(this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash(this.LineDash),this.Canvas.beginPath(),this.Canvas.moveTo(r,A(e)),this.Canvas.lineTo(n,A(e)),this.Canvas.stroke(),0==this.HPenType&&this.Canvas.setLineDash([])),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash(this.LineDash);else if(2==this.VPenType){var f=this.Frame.SubFrame[0].Frame.DataWidth;f>2*D&&(this.Canvas.lineWidth=f)}if(this.Canvas.beginPath(),1==this.VLineType)C&&(this.Canvas.fillStyle=this.XRangeBGColor,this.Canvas.fillRect(C.XStart,i.Top,C.XEnd-C.XStart,i.Bottom-i.Top)),this.Canvas.moveTo(A(t),i.Top),this.Canvas.lineTo(A(t),i.Bottom);else if(this.Frame.SubFrame.length>0)for(var c in this.Frame.SubFrame){var d=this.Frame.SubFrame[c].Frame,I=d.ChartBorder.GetBorder();o=I.TopTitle,s=I.Bottom,C&&(this.Canvas.fillStyle=this.XRangeBGColor,this.Canvas.fillRect(C.XStart,o,C.XEnd-C.XStart,s-o)),this.Canvas.moveTo(A(t),o),this.Canvas.lineTo(A(t),s)}else this.Canvas.moveTo(A(t),o),this.Canvas.lineTo(A(t),s);this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.DrawCorssPoint(t,e),this.Canvas.restore()}var S=this.Frame.GetXData(t),T={},v=this.Frame.GetYData(e,T);(this.IsOnlyDrawMinute||this.IsShowClose)&&null!=this.Close&&(v=this.Close),this.LastValue={Y:{Value:v,Extend:T}},this.StringFormatX.Value=this.CursorIndex,this.StringFormatX.Point={X:t,Y:e},this.StringFormatX.ClientPos=a,this.StringFormatY.Value=v,this.StringFormatY.RValue=T.RightYValue,this.StringFormatY.FrameID=T.FrameID,this.StringFormatY.Point={X:t,Y:e},this.StringFormatY.ClientPos=a,this.Canvas.font=this.Font;var p=this.GetFontHeight();if(p>this.TextHeight&&(this.TextHeight=p),(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Left>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Right>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var g=function(t,e,a){if(1==e.ShowType){var i=a/2;if(sa.IsNonEmptyArray(L.Text)&&L.Text[0]){var r=L.Text[0];sa.IsNumber(r.Height)&&(i=r.Height/2)}t.Top=t.YCenter-i,t.Bottom=t.Top+t.Height}else t.Top=t.YCenter-t.Height/2,t.Bottom=t.Top+t.Height},x=this.StringFormatY.Text;this.Canvas.font=this.Font;var E=this.Canvas.measureText(x).width,L={Width:E+4,Height:this.TextHeight,Text:[]},M={Y:e,YValue:v,FrameID:T.FrameID},y=this.LeftConfig.Margin,R=this.LeftConfig.TextOffset,N=null;if(this.Frame.ChartBorder.Left>=30&&1==this.ShowTextMode.Left){N={Right:r,Width:E+y.Left+y.Right,YCenter:e,Height:p+y.Top+y.Bottom};N.Left=N.Right-N.Width,N.Top=N.YCenter-N.Height/2,N.Bottom=N.Top+N.Height,N.Left<0&&(N.Left=0,N.Right=N.Left+N.Width)}else if(2==this.ShowTextMode.Left){N={Left:r,Width:E+y.Left+y.Right,YCenter:e,Height:p+y.Top+y.Bottom};N.Right=N.Left+N.Width,N.Top=N.YCenter-N.Height/2,N.Bottom=N.Top+N.Height}N&&(this.DrawTextBGRect(N.Left,N.Top,N.Width,N.Height),this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(x,N.Left+R.X,N.Bottom+R.Y));var w={ShowType:0,Font:this.Font,Color:this.TextColor,Text:[{Text:x,Margin:this.RightConfig.Margin,TextOffset:this.RightConfig.TextOffset}]};this.TextHeight;if(this.StringFormatY.PercentageText&&0==this.TextFormat.Right&&(x=this.StringFormatY.PercentageText+"%",w.Text[0].Text=x),this.StringFormatY.RText&&(x=this.StringFormatY.RText,w.Text[0].Text=x),this.StringFormatY.RComplexText&&sa.IsNonEmptyArray(this.StringFormatY.RComplexText.Text)&&(w=this.StringFormatY.RComplexText,w.Font||(w.Font=this.Font),w.Color||(w.Color=this.TextColor)),this.CalculateComplexTextSize(w,L),this.Frame.ChartBorder.Right>=30&&1==this.ShowTextMode.Right){var O=!1,b=null;if(T.FrameID>=0){d=this.Frame.SubFrame[T.FrameID];if(O=d.OverlayIndex.length>0,b=null,O)for(c=0;c<=d.OverlayIndex.length;++c){var B=d.OverlayIndex[c];if(B&&B.Frame&&(!1!==B.Frame.IsShow&&B.Frame.GetXHorizontal)){var P=B.Frame.GetXHorizontal();b=P-n;break}}}if(O&&L.Width>b&&b>0){N={Right:n+b,Width:L.Width,YCenter:e,Height:L.Height};N.Left=N.Right-N.Width,g(N,w,this.TextHeight),N.Right>h&&(N.Right=h,N.Left=N.Right-N.Width);var G=n+b;G>h&&(G=h),this.DrawTextBGRect(N.Left,N.Top,N.Width,N.Height),this.DrawComplexRightText(N,w,L),this.RightButton.Enable&&this.DrawRightButtonV2(N,w,L,M)}else{N={Left:n+1,Width:L.Width,YCenter:e,Height:L.Height};N.Right=N.Left+N.Width,g(N,w,this.TextHeight),N.Right>h&&(N.Right=h,N.Left=N.Right-N.Width),this.DrawTextBGRect(N.Left,N.Top,N.Width,N.Height),this.DrawComplexRightText(N,w,L),this.RightButton.Enable&&this.DrawRightButtonV2(N,w,L,M)}}else if(2==this.ShowTextMode.Right){N={Right:n,Width:L.Width,YCenter:e,Height:L.Height};N.Left=N.Right-N.Width,g(N,w,this.TextHeight),this.Canvas.fillStyle=this.TextBGColor,this.DrawTextBGRect(N.Left,N.Top,N.Width,N.Height),this.DrawComplexRightText(N,w,L),this.RightButton.Enable&&this.DrawRightButtonV2(N,w,L,M)}}if((1==this.ShowTextMode.Bottom||2==this.ShowTextMode.Bottom||8==this.ShowTextMode.Bottom)&&this.StringFormatX.Operator()){x=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;E=this.Canvas.measureText(x).width,y=this.BottomConfig.Margin,R=this.BottomConfig.TextOffset;var _=this.BottomConfig.Align;N={Top:s,Height:y.Top+y.Bottom+p,XCenter:t,Width:E+y.Left+y.Right};N.Bottom=N.Top+N.Height,N.Left=1==_?N.XCenter-N.Width/2:N.XCenter,N.Right=N.Left+N.Width,N.Left<=0?(N.Left=0,N.Right=N.Left+N.Width):N.Right>=n&&(N.Right=n,N.Left=N.Right-N.Width);var V=!0;if(2==this.ShowTextMode.Bottom)N.Bottom=s,N.Top=N.Bottom-N.Height;else if(8==this.ShowTextMode.Bottom){var H=this.GetEventCallback(m.ON_CUSTOM_CORSSCURSOR_POSITION);if(H&&H.Callback){var Y={RectText:N,IsShowText:V,X:t,Y:e};H.Callback(H,Y,this),V=Y.IsShowText}}if(V){this.DrawTextBGRect(N.Left,N.Top,N.Width,N.Height),this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(x,N.Left+R.X,N.Bottom+R.Y,E);M={X:t,Y:e,XValue:S,FrameID:T.FrameID};this.StringFormatX.KItem&&(M.KItem=this.StringFormatX.KItem),this.BottomButton.Rect=N,this.BottomButton.Data=M}}if(T.FrameID>=0){d=this.Frame.SubFrame[T.FrameID],P=n;this.Canvas.font=this.Font;for(c=0;c<d.OverlayIndex.length;++c){B=d.OverlayIndex[c];if(!1!==B.Frame.IsShow&&B.Frame.GetXHorizontal){P=B.Frame.GetXHorizontal();v=B.Frame.GetYData(e),x=sa.FormatValueString(v,2),E=this.Canvas.measureText(x).width,y=this.RightOverlayConfig.Margin,R=this.RightOverlayConfig.TextOffset,N={Left:P+1,Width:E+y.Left+y.Right,YCenter:e,Height:p+y.Top+y.Bottom};N.Right=N.Left-N.Width,N.Top=N.YCenter-N.Height/2,N.Bottom=N.Top+N.Height,this.DrawTextBGRect(N.Left,N.Top,N.Width,N.Height),this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(x,N.Left+R.X,N.Bottom+R.Y)}}}this.Status=1}else this.HScreenDraw()}},this.DrawComplexRightText=function(t,e,a){this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var i=0;if(1==e.ShowType&&(i=e.ShowType),1==i)for(var r=t.Left,n=t.Top,o=0;o<e.Text.length;++o){var s=e.Text[o],h=a.Text[o];s.Font?this.Canvas.font=s.Font:this.Canvas.font=e.Font,s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=e.Color;var l=n+h.Height,u=r;if(s.TextOffset){var C=s.TextOffset;sa.IsNumber(C.X)&&(u+=C.X),sa.IsNumber(C.Y)&&(l+=C.Y)}this.Canvas.fillText(s.Text,u,l,h.Width),n+=h.Height}else{var D=t.Left,f=t.Bottom;for(o=0;o<e.Text.length;++o){s=e.Text[o],h=a.Text[o];s.Font?this.Canvas.font=s.Font:this.Canvas.font=e.Font,s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=e.Color;u=D,l=f;if(s.TextOffset){C=s.TextOffset;sa.IsNumber(C.X)&&(u+=C.X),sa.IsNumber(C.Y)&&(l+=C.Y)}this.Canvas.fillText(s.Text,u,l,h.Width),D+=h.Width}}},this.CalculateComplexTextSize=function(t,e){if(t&&sa.IsNonEmptyArray(t.Text)){var a=0;if(1==t.ShowType&&(a=t.ShowType),1==a){for(var i=0,r=0,n=0;n<t.Text.length;++n){var o=t.Text[n];o.Font?this.Canvas.font=o.Font:this.Canvas.font=t.Font;var s=this.Canvas.measureText(o.Text).width,h=this.GetFontHeight();if(o.Margin){var l=o.Margin;sa.IsNumber(l.Left)&&(s+=l.Left),sa.IsNumber(l.Right)&&(s+=l.Right),sa.IsNumber(l.Top)&&(h+=l.Top),sa.IsNumber(l.Bottom)&&(h+=l.Bottom)}e.Text[n]={Width:s,Height:h},i<s&&(i=s),r+=h}e.Width=i,e.Height=r}else{for(i=0,r=this.GetFontHeight(),n=0;n<t.Text.length;++n){o=t.Text[n];o.Font?this.Canvas.font=o.Font:this.Canvas.font=t.Font;s=this.Canvas.measureText(o.Text).width,h=this.Canvas.measureText("擎").width;if(o.Margin){l=o.Margin;sa.IsNumber(l.Left)&&(s+=l.Left),sa.IsNumber(l.Right)&&(s+=l.Right),sa.IsNumber(l.Top)&&(h+=l.Top),sa.IsNumber(l.Bottom)&&(h+=l.Bottom)}e.Text[n]={Width:s,Height:h},i+=s,r<h&&(r=h)}e.Width=i,e.Height=r}}},this.DrawRightButtonV2=function(t,e,a,i){this.Canvas.fillStyle=this.RightButton.BGColor;var r=t.Height,n=t.Height;if(1==e.ShowType){var o=a.Text[0];r=o.Height,n=o.Height}var s={Left:t.Left-r,Top:t.Top,Width:n,Height:r};s.Right=s.Left+s.Width,s.Bottom=s.Top+s.Height,this.RightButton.Rect=s,this.RightButton.Data=i,this.Canvas.fillRect(A(s.Left+1),A(s.Top),b(s.Width),b(s.Height));var h=F(),l=s.Top+3+(s.Height-6)/2,u=s.Left+3+(s.Width-6)/2;if(this.RightButton.Icon){var C=this.RightButton.Icon;this.Canvas.font="".concat(C.Size*h,"px ").concat(C.Family),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=C.Color,this.Canvas.fillText("",u,l)}else{this.Canvas.strokeStyle=this.RightButton.PenColor;var D=rtButtom.Left+3,f=rtButtom.Top+3;this.Canvas.save(),this.Canvas.linewidth=1*h,this.Canvas.beginPath(),this.Canvas.moveTo(A(D),A(l)),this.Canvas.lineTo(A(D+s.Width-6),A(l)),this.Canvas.moveTo(A(u),A(f)),this.Canvas.lineTo(A(u),A(f+s.Height-6)),this.Canvas.stroke(),this.Canvas.restore()}},this.DrawRightButton=function(t,e,a,i,r){this.Canvas.fillStyle=this.RightButton.BGColor;var n={Left:e-a,Top:t,Width:a,Height:i};n.Right=n.Left+n.Width,n.Bottom=n.Top+n.Height,this.RightButton.Rect=n,this.RightButton.Data=r,this.Canvas.fillRect(A(n.Left+1),A(n.Top),b(n.Width),b(n.Height));var o=F(),s=n.Top+3+(n.Height-6)/2,h=n.Left+3+(n.Width-6)/2;if(this.RightButton.Icon){var l=this.RightButton.Icon;this.Canvas.font="".concat(l.Size*o,"px ").concat(l.Family),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=l.Color,this.Canvas.fillText("",h,s)}else{this.Canvas.strokeStyle=this.RightButton.PenColor;var u=rtButtom.Left+3,C=rtButtom.Top+3;this.Canvas.save(),this.Canvas.linewidth=1*o,this.Canvas.beginPath(),this.Canvas.moveTo(A(u),A(s)),this.Canvas.lineTo(A(u+n.Width-6),A(s)),this.Canvas.moveTo(A(h),A(C)),this.Canvas.lineTo(A(h),A(C+n.Height-6)),this.Canvas.stroke(),this.Canvas.restore()}},this.PtInButton=function(t,e){var a=this.PtInRightButton(t,e);return a||(a=this.PtInButtomButton(t,e),a||null)},this.PtInRightButton=function(t,e){if(!this.RightButton.Enable)return null;if(!this.RightButton.Rect)return null;var a=this.RightButton.Rect;return t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom?{Data:this.RightButton.Data,Rect:a,Type:1}:null},this.PtInButtomButton=function(t,e){if(!this.BottomButton.Enable)return null;if(!this.BottomButton.Rect)return null;var a=this.BottomButton.Rect;return t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom?{Data:this.BottomButton.Data,Rect:a,Type:2}:null},this.DrawTextBGRect=function(t,e,a,i){this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(A(t),A(e),b(a),b(i)),this.BorderColor&&(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(A(t),A(e),b(a),b(i)))},this.HScreenDraw=function(){var t=this.LastPoint.X,e=this.LastPoint.Y;if(this.IsOnlyDrawKLine){if(e=this.Frame.GetXFromIndex(this.CursorIndex),this.IsShowClose){var a=this.GetCloseYPoint(this.CursorIndex);null!=a&&(t=a)}}else if(this.IsOnlyDrawMinute){a=this.GetMinuteCloseYPoint(this.CursorIndex);null!=a&&(t=a)}var i=this.Frame.ChartBorder.GetHScreenBorder(),r=i.Left,n=i.Right,o=i.Top,s=i.Bottom,h=this.Frame.ChartBorder.Bottom;if(this.CallAcutionXOperator&&(this.CallAcutionXOperator.Value=e,this.CallAcutionXOperator.Point={X:t,Y:e},this.CallAcutionXOperator.ClientPos=this.ClientPos,this.CallAcutionXOperator.Operator()&&(e=this.CallAcutionXOperator.X)),this.PointY=[[r,e],[n,e]],this.PointX=[[t,o],[t,s]],this.IsShowCorss){var l=F();if(this.Canvas.save(),this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash(this.LineDash),this.Canvas.beginPath(),this.Canvas.moveTo(A(t),o),this.Canvas.lineTo(A(t),s),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash(this.LineDash);else if(2==this.VPenType){var u=this.Frame.SubFrame[0].Frame.DataWidth;u>2*l&&(this.Canvas.lineWidth=u)}if(this.Canvas.beginPath(),1==this.VLineType)this.Canvas.moveTo(r,A(e)),this.Canvas.lineTo(n,A(e));else if(this.Frame.SubFrame.length>0)for(var C in this.Frame.SubFrame){var D=this.Frame.SubFrame[C].Frame,f=D.ChartBorder.GetHScreenBorder();this.Canvas.moveTo(f.Left,A(e)),this.Canvas.lineTo(f.RightEx,A(e))}else this.Canvas.moveTo(r,A(e)),this.Canvas.lineTo(n,A(e));this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.DrawCorssPoint(t,e),this.Canvas.restore()}var c=this.Frame.GetXData(e),d={},I=this.Frame.GetYData(t,d);this.StringFormatX.Value=c,this.StringFormatX.Point={X:t,Y:e},this.StringFormatX.ClientPos=this.ClientPos,this.StringFormatY.Value=I,this.StringFormatY.FrameID=d.FrameID,this.StringFormatY.RValue=d.RightYValue,this.StringFormatY.Point={X:t,Y:e},this.StringFormatY.ClientPos=this.ClientPos,this.Canvas.font=this.Font;var S=this.GetFontHeight();if(S>this.TextHeight&&(this.TextHeight=S),(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Top>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Bottom>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var T=this.StringFormatY.Text;this.Canvas.font=this.Font;var v=this.Canvas.measureText(T).width+4;if(this.Frame.ChartBorder.Top>=30&&1==this.ShowTextMode.Left){var p=t,g=o;this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,o>=v?(this.Canvas.fillRect(0,-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,-2,0,v)):(this.Canvas.fillRect(v-o,-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,v-o-2,0,v)),this.Canvas.restore()}else if(2==this.ShowTextMode.Left){p=t,g=o;this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,2,0,v),this.Canvas.restore()}if(this.StringFormatY.RText){T=this.StringFormatY.RText;v=this.Canvas.measureText(T).width+4}if(this.Frame.ChartBorder.Bottom>=30&&1==this.ShowTextMode.Right){p=t,g=s;if(this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,h>v?(this.Canvas.fillRect(0,-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,2,0,v)):(this.Canvas.fillRect(h-v,-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,h-v+2,0,v)),this.StringFormatY.RExtendText&&this.StringFormatY.RExtendText.length>0){var x=0;for(var C in this.StringFormatY.RExtendText){var E=this.StringFormatY.RExtendText[C],L="--.--";E.YText?L=E.YText:sa.IsNumber(E.Y)&&(L=E.Y.toFixed(0));var M=this.Canvas.measureText(L).width+4;if(this.Canvas.fillStyle=E.TextBGColor,h>M)this.Canvas.fillRect(0,x+this.TextHeight/2,M,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=E.TextColor,this.Canvas.fillText(L,2,x+this.TextHeight,M);else{var y=h-M;this.Canvas.fillRect(y,x+this.TextHeight/2,M,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=E.TextColor,this.Canvas.fillText(L,y+2,x+this.TextHeight,M)}x+=this.TextHeight}}this.Canvas.restore()}else if(2==this.ShowTextMode.Right){p=t,g=s;this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,-2,0,v),this.Canvas.restore()}}if((1===this.ShowTextMode.Bottom||8==this.ShowTextMode.Bottom)&&this.StringFormatX.Operator()){T=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;v=this.Canvas.measureText(T).width+4,p=r;var R=!0;if(8==this.ShowTextMode.Bottom){var N=this.GetEventCallback(m.ON_CUSTOM_CORSSCURSOR_POSITION);if(N&&N.Callback){var w={XText:p,Height:this.TextHeight,IsShowText:R};N.Callback(N,w,this),p=w.XText,R=w.IsShowText}}if(R)if(e-v/2<3){g=e;this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(0,0,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,2,this.TextHeight/2,v),this.Canvas.restore()}else if(e+v/2>=s){g=e;this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-v,0,v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,-2,this.TextHeight/2,v),this.Canvas.restore()}else{g=e;this.Canvas.save(),this.Canvas.translate(p,g),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-v/2,0,v,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,0,this.TextHeight/2,v),this.Canvas.restore()}}this.Status=1},this.OnKeyDown=function(t){if(this.EnableKeyboard){var e=t.KeyID;if(27==e){if(!this.IsShowCorss)return;this.IsShowCorss=!1,t.Draw=!0,this.OnChangeStatusCallback&&this.OnChangeStatusCallback({Type:1,IsShowCorss:this.IsShowCorss},this)}else if(37==e||39==e){if(this.IsShowCorss)return;this.IsShowCorss=!0,t.Draw=!0,this.OnChangeStatusCallback&&this.OnChangeStatusCallback({Type:1,IsShowCorss:this.IsShowCorss},this)}}},this.OnDBClick=function(t){if(this.EnableDBClick&&sa.IsNonEmptyArray(this.Frame.SubFrame)){var e=this.Frame.SubFrame[0].Frame;if(e){var a=e.GetBorder(),i={Left:a.Left,Top:a.Top,Bottom:a.Bottom,Right:a.Right},r=t.X,n=t.Y;r>=i.Left&&r<=i.Right&&n>=i.Top&&n<=i.Bottom&&(this.IsShowCorss=!this.IsShowCorss,t.Draw=!0,this.OnChangeStatusCallback&&this.OnChangeStatusCallback({Type:1,IsShowCorss:this.IsShowCorss},this))}}},this.DrawCorssPoint=function(t,e){var a=this.CorssPointConfig;a.Enable&&(this.Canvas.beginPath(),this.Canvas.arc(t,e,a.Center.Radius,0,360,!1),this.Canvas.closePath(),a.Center&&a.Center.Color&&(this.Canvas.fillStyle=a.Center.Color,this.Canvas.fill()),a.Border&&a.Border.Color&&(this.Canvas.strokeStyle=a.Border.Color,sa.IsNumber(a.Border.Width)&&(this.Canvas.lineWidth=a.Border.Width),this.Canvas.stroke()))}}function da(){this.Frame,this.HQChart,this.Canvas,this.Data,this.Symbol,this.HPenType=0,this.VPenType=0,this.LineDash=qi.DepthCorss.LineDash,this.IsShowTooltip=!0,this.AskColor=qi.DepthCorss.AskColor.Line,this.BidColor=qi.DepthCorss.BidColor.Line,this.LineWidth=qi.DepthCorss.LineWidth,this.ClassName="DepthChartCorssCursor",this.Tooltip={Border:{Top:qi.DepthCorss.Tooltip.Border.Top,Left:qi.DepthCorss.Tooltip.Border.Left,Right:qi.DepthCorss.Tooltip.Border.Right,Bottom:qi.DepthCorss.Tooltip.Border.Bottom,ItemSpace:qi.DepthCorss.Tooltip.Border.ItemSpace},Font:qi.DepthCorss.Tooltip.Font,TextColor:qi.DepthCorss.Tooltip.TextColor,BGColor:qi.DepthCorss.Tooltip.BGColor},this.Font=qi.CorssCursorTextFont,this.TextColor=qi.CorssCursorTextColor,this.TextBGColor=qi.CorssCursorBGColor,this.TextHeight=20,this.LastPoint,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.IsShowCorss=!0,this.IsShow=!0,this.GetVol=function(t,e){if(!this.Data)return null;var a=e?this.Data.Asks:this.Data.Bids;if(!a||!Array.isArray(a)||a.length<=0)return null;for(var i in a){var r=a[i];if(r.Price==t)return r.Vol}return null},this.Draw=function(){if(this.Status=0,this.LastPoint&&this.Data&&this.IsShow){var t,e=this.LastPoint.X,a=this.LastPoint.Y;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),t=this.Canvas.isPointInPath(e,a),this.PointY=null,this.PointY,t&&!0!==this.Frame.IsHScreen){var i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetRight(),n=this.Frame.ChartBorder.GetTopTitle(),o=this.Frame.ChartBorder.GetBottom(),s=(this.Frame.ChartBorder.Right,this.Frame.ChartBorder.GetChartWidth(),this.Frame.GetXData(e)),h=this.Frame.GetXFromPrice(s);if(h){var l=this.GetVol(h.Price,h.IsAsk);if(a=this.Frame.GetYFromData(l),h.Vol=l,h.Y=a,this.PointY=[[i,a],[r,a]],this.PointX=[[e,n],[e,o]],this.IsShowCorss){h.IsAsk?this.Canvas.strokeStyle=this.AskColor:this.Canvas.strokeStyle=this.BidColor;var u=this.Canvas.lineWidth,C=F();this.Canvas.lineWidth=this.LineWidth*C;var D=this.Canvas.lineWidth;if(1==this.HPenType||0==this.HPenType){0==this.HPenType&&this.Canvas.setLineDash(this.LineDash);var f=O(D,a);this.Canvas.beginPath(),this.Canvas.moveTo(i,f),this.Canvas.lineTo(r,f),this.Canvas.stroke(),0==this.HPenType&&this.Canvas.setLineDash([])}0==this.VPenType&&this.Canvas.setLineDash(this.LineDash);var c=O(D,h.X);this.Canvas.beginPath(),this.Canvas.moveTo(c,n),this.Canvas.lineTo(c,o),this.Canvas.stroke(),0==this.VPenType&&this.Canvas.setLineDash([]),this.Canvas.lineWidth=u}if(this.HQChart){var d=this.HQChart.GetEventCallback(m.ON_DRAW_DEPTH_TOOLTIP);d&&d.Callback(d,h,this)}if(this.IsShowTooltip){var I=this.GetFormatTooltip(h);this.DrawTooltip(I,h)}}}}},this.GetFormatTooltip=function(t){var e=[],a=2;this.Symbol&&(a=Jr(this.Symbol));var i={Title:$i.GetText("Depth-Price",this.HQChart.LanguageID),TitleColor:this.Tooltip.TextColor,Text:t.Price.toFixed(a),Color:this.Tooltip.TextColor};e.push(i);i={Title:$i.GetText("Depth-Sum",this.HQChart.LanguageID),TitleColor:this.Tooltip.TextColor,Text:t.Vol.toFixed(4),Color:this.Tooltip.TextColor};return e.push(i),e},this.DrawTooltip=function(t,e){if(sa.IsNonEmptyArray(t)){this.Canvas.font=this.Tooltip.Font;for(var a=0,i=0,r=0,n=0;n<t.length;++n){var o=t[n];if(o){var s=!1;if(o.Title){var h=this.Canvas.measureText(o.Title).width;a<h&&(a=h),++i,s=!0}if(o.Text){h=this.Canvas.measureText(o.Text).width;a<h&&(a=h),++i,s=!0}s&&++r}}if(!(a<=0||i<=0)){this.Tooltip.LineHeight=this.Canvas.measureText("擎").width+2;var l=F(),u=this.Tooltip.Border;this.Tooltip.Width=a+(u.Left+u.Right)*l,this.Tooltip.Height=this.Tooltip.LineHeight*i+(u.Top+u.Bottom)*l+u.ItemSpace*l*(r-1);var C=this.Frame.ChartBorder.GetRight(),D=this.Frame.ChartBorder.GetTop(),f=e.X,c=e.Y-this.Tooltip.Height;f+this.Tooltip.Width>=C&&(f=e.X-this.Tooltip.Width),c<D&&(c=e.Y),this.Canvas.fillStyle=this.Tooltip.BGColor,this.Canvas.fillRect(f,c,this.Tooltip.Width,this.Tooltip.Height),this.Canvas.textBaseline="top",this.Canvas.textAlign="left";var m=u.Left*l+f,d=u.Top*l+c;for(n=0;n<t.length;++n){o=t[n],s=!1;o.Title&&(o.TitleColor?this.Canvas.fillStyle=o.TitleColor:this.Canvas.fillStyle=this.Tooltip.TextColor,this.Canvas.fillText(o.Title,m,d),d+=this.Tooltip.LineHeight,s=!0),o.Text&&(o.Color?this.Canvas.fillStyle=o.Color:this.Canvas.fillStyle=this.Tooltip.TextColor,this.Canvas.fillText(o.Text,m,d),d+=this.Tooltip.LineHeight,s=!0),s&&(d+=u.ItemSpace*l)}}}},this.PtInButton=function(t,e){return null}}function Ia(){this.Frame,this.Canvas,this.Font=qi.SplashScreen.Font,this.TextColor=qi.SplashScreen.TextColor,this.IsEnableSplash=!1,this.SplashTitle="数据加载中",this.HQChart,this.Position=0,this.EnableSplash=function(t){if(this.IsEnableSplash=t,this.HQChart){var e=this.HQChart.GetEventCallback(m.ON_ENABLE_SPLASH_DRAW);if(e){var a={Enable:t};e.Callback(e,a,this)}}},this.SetTitle=function(t){this.SplashTitle=t},this.Draw=function(){if(this.IsEnableSplash)if(!0!==this.Frame.IsHScreen){var t=null,e=null;if(1==this.Position&&this.HQChart.Frame&&this.HQChart.Frame.SubFrame&&this.HQChart.Frame.SubFrame[0]){var a=this.HQChart.Frame.SubFrame[0].Frame;a&&(t=(a.ChartBorder.GetLeft()+a.ChartBorder.GetRight())/2,e=(a.ChartBorder.GetTop()+a.ChartBorder.GetBottom())/2)}if(!sa.IsNumber(t)||!sa.IsNumber(e))t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,t,e)}else this.HScreenDraw()},this.HScreenDraw=function(){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.save(),this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,0,0),this.Canvas.restore()}}function Sa(){this.Data,this.Value,this.Text,this.Operator=function(){return!1},this.GetMultiDayBeforeOpenData=function(){if(!this.MultiDayBeforeOpenData||!sa.IsNonEmptyArray(this.MultiDayBeforeOpenData))return null;if(this.DayOffset||this.MultiDayBeforeOpenData,!sa.IsNumber(this.DayOffset.Offset)||!sa.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayBeforeOpenData.slice(e,e+t);return a},this.GetMultiDayAfterCloseData=function(){if(!this.MultiDayAfterCloseData||!sa.IsNonEmptyArray(this.MultiDayAfterCloseData))return null;if(this.DayOffset||this.MultiDayAfterCloseData,!sa.IsNumber(this.DayOffset.Offset)||!sa.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayAfterCloseData.slice(e,e+t);return a}}sa.FormatValueThousandsString=function(t,e){if(null==t||isNaN(t)){if(e>0){for(var a="-.",i=0;i<e;++i)a+="-";return a}return"--"}var r="",n=t.toFixed(e);if(e>0){var o=n.split(".")[1],s=n.split(".")[0];while(s.length>3)r=","+s.slice(-3)+r,s=s.slice(0,s.length-3);s&&(r=s+r+"."+o)}else{while(n.length>3)r=","+n.slice(-3)+r,n=n.slice(0,n.length-3);n&&(r=n+r)}return r},sa.FormatValueString=function(t,e,a){return sa.FormatValueStringV2(t,e,e,a)},sa.FormatValueStringV2=function(t,e,a,i){if(null==t||isNaN(t)){if(e>0){for(var r="-.",n=0;n<e;++n)r+="-";return r}return"--"}if(t<1e-11&&t>-1e-11)return"0";var o=Math.abs(t);return i===ji.LANGUAGE_ENGLISH_ID?o<1e4?t.toFixed(e):o<1e6?(t/1e3).toFixed(a)+"K":o<1e9?(t/1e6).toFixed(a)+"M":o<1e12?(t/1e9).toFixed(a)+"B":(t/1e12).toFixed(a)+"T":i===ji.LANGUAGE_TRADITIONAL_CHINESE_ID?o<1e4?t.toFixed(e):o<1e8?(t/1e4).toFixed(a)+"萬":o<1e12?(t/1e8).toFixed(a)+"億":(t/1e12).toFixed(a)+"萬億":o<1e4?t.toFixed(e):o<1e6||o<1e8?(t/1e4).toFixed(a)+"万":o<1e12?(t/1e8).toFixed(a)+"亿":(t/1e12).toFixed(a)+"万亿"},sa.FormatVolString=function(t,e){var a=Math.abs(t);return a<1e5?t.toFixed(0):a<1e7?(t/1e4).toFixed(1)+"万":a<1e8?(t/1e4).toFixed(0)+"万":a<1e9?(t/1e8).toFixed(2)+"亿":a<1e12?(t/1e8).toFixed(1)+"亿":(t/1e12).toFixed(1)+"万亿"},sa.FromatIntegerString=function(t,e,a){return t<1e4&&sa.IsInteger(t)&&(e=0),sa.FormatValueString(t,e,a)},sa.NumberToString=function(t){return t<10?"0"+t.toString():t.toString()},sa.MillisecondToString=function(t){return t<10?"00"+t.toString():t<100?"0"+t.toString():t.toString()},sa.FormatDateString=function(t,e,a){var i=parseInt(t/1e4),r=parseInt(t/100)%100,n=t%100;switch(e){case"MM-DD":return sa.NumberToString(r)+"-"+sa.NumberToString(n);case"MM-DD/W":var o=new Date(i,r-1,n),s=$i.GetText(xa[o.getDay()],a);return"".concat(sa.NumberToString(r),"-").concat(sa.NumberToString(n),"/").concat(s);case"MM/DD":return"".concat(sa.NumberToString(r),"/").concat(sa.NumberToString(n));case"MM/DD/W":o=new Date(i,r-1,n),s=$i.GetText(xa[o.getDay()],a);return"".concat(sa.NumberToString(r),"/").concat(sa.NumberToString(n),"/").concat(s);case"YYYY-MM":return"".concat(i,"-").concat(sa.NumberToString(r));case"YYYY/MM/DD":return i.toString()+"/"+sa.NumberToString(r)+"/"+sa.NumberToString(n);case"YYYY/MM/DD/W":o=new Date(i,r-1,n),s=$i.GetText(xa[o.getDay()],a);return i.toString()+"/"+sa.NumberToString(r)+"/"+sa.NumberToString(n)+"/"+s.toString();case"DD/MM/YYYY":return sa.NumberToString(n)+"/"+sa.NumberToString(r)+"/"+i.toString();default:return i.toString()+"-"+sa.NumberToString(r)+"-"+sa.NumberToString(n)}},sa.FormatTimeString=function(t,e){if("HH:MM:SS"==e){var a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return sa.NumberToString(a)+":"+sa.NumberToString(i)+":"+sa.NumberToString(r)}if("hh:mm"==e){a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return sa.NumberToString(a)+":"+sa.NumberToString(i)}if("HH:MM"==e){a=parseInt(t/100),i=t%100;return sa.NumberToString(a)+":"+sa.NumberToString(i)}if("HH:MM:SS.fff"==e){var n=t%1e3,o=parseInt(t/1e3);a=parseInt(o/1e4),i=parseInt(o%1e4/100),r=o%100;return"".concat(sa.NumberToString(a),":").concat(sa.NumberToString(i),":").concat(sa.NumberToString(r),".").concat(sa.MillisecondToString(n))}if(t<1e4){a=parseInt(t/100),i=t%100;return sa.NumberToString(a)+":"+sa.NumberToString(i)}a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return sa.NumberToString(a)+":"+sa.NumberToString(i)+":"+sa.NumberToString(r)},sa.FormatReportDateString=function(t){var e,a=parseInt(t/1e4),i=parseInt(t/100)%100;switch(i){case 3:e="一季度报";break;case 6:e="半年报";break;case 9:e="三季度报";break;case 12:e="年报";break}return a.toString()+e},sa.FormatDateTimeString=function(t,e,a){var i=t.split(" ");if(i.length<2)return"";var r="";if(e){var n=parseInt(i[0]),o=parseInt(n/1e4),s=parseInt(n%1e4/100),h=n%100,l=o.toString()+"-"+(s<10?"0"+s.toString():s.toString())+"-"+(h<10?"0"+h.toString():h.toString());r+=l}if(a){var u=parseInt(i[1]);if(u<1e4){var C=u%100,D=parseInt(u/100);l=sa.NumberToString(D)+":"+sa.NumberToString(C);r.length>0&&(r+=" "),r+=l}else{D=parseInt(u/1e4),C=parseInt(u%1e4/100);var f=u%100;l=sa.NumberToString(D)+":"+sa.NumberToString(C)+":"+sa.NumberToString(f);r.length>0&&(r+=" "),r+=l}}return r},sa.FormatValueColor=function(t,e){return null!=t&&null==e?0==t?"PriceNull":t>0?"PriceUp":"PriceDown":null==t||null==e||t==e?"PriceNull":t>e?"PriceUp":"PriceDown"},sa.IsNumber=function(t){return null!=t&&(!isNaN(t)&&"number"==typeof t)},sa.IsNumberV2=function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];if(!e)return!1;if(0==e.length)return!1;for(var i=0,r=e;i<r.length;i++){var n=r[i];if(null==n)return!1;if(isNaN(n))return!1;if("number"!=typeof n)return!1}return!0},sa.IsPlusNumber=function(t){return null!=t&&(!isNaN(t)&&t>0)},sa.IsInteger=function(t){return"number"===typeof t&&t%1===0},sa.IsObjectExist=function(t){return void 0!==t&&null!=t},sa.IsBool=function(t){return!0===t||!1===t},sa.IsString=function(t){var e=(0,s.default)(t);return"string"==e},sa.IsNonEmptyArray=function(t){return!!t&&(!!Array.isArray(t)&&t.length>0)},sa.IsFloat=function(t){return void 0!==t&&(null!=t&&(!isNaN(t)&&t!=parseInt(t)))},sa.IsVaild=function(t){return!isNaN(t)&&(null!=t&&void 0!==t)},sa.IsUndefined=function(t){return void 0===t},sa.IsObject=function(t){return t instanceof Object},sa.RemoveZero=function(t){while(t.length>0){var e=t.length-1,a=t[e];if("0"!=a){if("."==a){t=t.substr(0,e);break}break}t=t.substr(0,e)}return t},sa.RemoveMarketSuffix=function(t){if(!t)return t;var e=t.lastIndexOf(".");return e>0?t.substring(0,e):t};var Ta=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10];function va(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Symbol,this.FrameID,this.Frame,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.YClose,this.PercentageText,this.RValue,this.RText,this.RComplexText,this.Point,this.ClientPos=-1,this.HQChart,this.ExtendChartPaint,this.RExtendText=[],this.BeforeOpenData,this.AfterCloseData,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.ShareAfterVol=0,this.PriceFormatType=0,this.DataFormatType=0,this.GetEventCallback,this.GetBeforeOpen=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;if(!this.BeforeOpenData)return!1;var e={Max:this.BeforeOpenData.VolMax,Min:this.BeforeOpenData.VolMin},a=this.Frame.IsHScreen?this.Point.X:this.Point.Y,i=t.Frame.GetLeftExtendYData(a,!1,{Range:e});sa.IsNumber(i)&&(this.RText=this.Text=sa.FormatValueString(i,2,this.LanguageID))},this.GetAfterClose=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;if(!this.AfterCloseData)return!1;var e={Max:this.AfterCloseData.VolMax,Min:this.AfterCloseData.VolMin},a=this.Frame.IsHScreen?this.Point.X:this.Point.Y,i=t.Frame.GetRightExtendYData(a,!1,{Range:e});sa.IsNumber(i)&&(this.RText=this.Text=sa.FormatValueString(i,2,this.LanguageID))},this.GetMultiDayBeforeOpen=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;var e=this.GetMultiDayBeforeOpenData();if(e&&sa.IsNonEmptyArray(e)){var a=this.ClientPos-200;if(a<0||a>=e.length)return!1;var i=e[a],r={Max:i.VolMax,Min:i.VolMin},n=this.Frame.IsHScreen?this.Point.X:this.Point.Y,o=t.Frame.GetLeftExtendYData(n,!1,{Range:r});sa.IsNumber(o)&&(this.RText=this.Text=sa.FormatValueString(o,2,this.LanguageID))}},this.GetMultiDayAfterClose=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;var e=this.GetMultiDayAfterCloseData();if(e&&sa.IsNonEmptyArray(e)){var a=this.ClientPos-300;if(a<0||a>=e.length)return!1;var i=e[a],r={Max:i.VolMax,Min:i.VolMin},n=this.Frame.IsHScreen?this.Point.X:this.Point.Y,o=t.Frame.GetRightExtendYData(n,!1,{Range:r});sa.IsNumber(o)&&(this.RText=this.Text=sa.FormatValueString(o,2,this.LanguageID))}},this.Operator=function(){if(this.RText=null,this.RComplexText=null,this.RExtendText=[],sa.IsString(this.RValue)&&(this.RText=this.RValue),!this.Value)return!1;this.PercentageText=null;var t=2;if(0==this.FrameID){t=Jr(this.Symbol);1==this.PriceFormatType?this.Text=sa.FormatValueThousandsString(this.Value,t):this.Text=this.Value.toFixed(t),this.YClose>0&&(this.PercentageText=(100*(this.Value-this.YClose)/this.YClose).toFixed(2)),this.GetExtendPaintData(t)}else if(1==this.FrameID)1==this.DataFormatType?(this.Text=sa.FormatValueThousandsString(this.Value,t),sa.IsNumber(this.RValue)&&(this.RText=sa.FormatValueString(this.RValue,t,this.LanguageID))):(this.Text=sa.FormatValueString(this.Value,t,this.LanguageID),sa.IsNumber(this.RValue)&&(this.RText=sa.FormatValueString(this.RValue,t,this.LanguageID))),2==this.ClientPos?this.GetBeforeOpen():3==this.ClientPos?0!=this.ShareAfterVol&&2!=this.ShareAfterVol||this.GetAfterClose():this.ClientPos>=200&&this.ClientPos<=299?this.GetMultiDayBeforeOpen():this.ClientPos>=300&&this.ClientPos<=399&&(0!=this.ShareAfterVol&&2!=this.ShareAfterVol||this.GetMultiDayAfterClose());else{1==this.DataFormatType?this.Text=sa.FormatValueThousandsString(this.Value,t):this.Text=sa.FormatValueString(this.Value,t,this.LanguageID),sa.IsNumber(this.RValue)&&(this.RText=sa.FormatValueString(this.RValue,t,this.LanguageID));var e=!1;this.HQChart&&this.HQChart.IsCallAuctionFrame&&(e=this.HQChart.IsCallAuctionFrame(this.FrameID)),e&&(2==this.ClientPos?this.GetBeforeOpen():3==this.ClientPos?0!=this.ShareAfterVol&&2!=this.ShareAfterVol||this.GetAfterClose():this.ClientPos>=200&&this.ClientPos<=299?this.GetMultiDayBeforeOpen():this.ClientPos>=300&&this.ClientPos<=399&&(0!=this.ShareAfterVol&&2!=this.ShareAfterVol||this.GetMultiDayAfterClose()))}if(this.GetEventCallback){var a=this.GetEventCallback(m.ON_FORMAT_CORSSCURSOR_Y_TEXT);if(a){var i={Value:this.Value,FrameID:this.FrameID,PreventDefault:!1};if(a.Callback(a,i,this),1==i.PreventDefault)return!1}}return!0},this.GetExtendPaintData=function(t){var e=parseInt(this.Value*Ta[t]);for(var a in this.ExtendChartPaint){var i=this.ExtendChartPaint[a];if("DepthMapPaint"==i.ClassName&&i.FrameID==this.FrameID){var r=i.GetYValueByXValue(e,t);for(var n in r)this.RExtendText.push(r[n])}}}}function pa(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.DateFormatType=0,this.LanguageID=0,this.KItem=null,this.IsShowIncrease=!1,this.Operator=function(){if(this.KItem=null,!sa.IsNumber(this.Value))return!1;if(!this.Data)return!1;var t=this.Value;if(t=parseInt(t.toFixed(0)),this.Data.DataOffset+t>=this.Data.Data.length)return!1;var e=this.Data.Data[this.Data.DataOffset+t];this.KItem=e;var a="YYYY-MM-DD";if(1==this.DateFormatType?a="YYYY/MM/DD":2==this.DateFormatType?a="YYYY/MM/DD/W":3==this.DateFormatType&&(a="DD/MM/YYYY"),this.Text=sa.FormatDateString(e.Date,a,this.LanguageID),dt.IsMinutePeriod(this.Data.Period,!0)){var i=sa.FormatTimeString(e.Time);this.Text=this.Text+"  "+i}else if(dt.IsSecondPeriod(this.Data.Period)){i=sa.FormatTimeString(e.Time,"HH:MM:SS");this.Text=this.Text+"  "+i}else if(dt.IsMilliSecondPeriod(this.Data.Period)){i=sa.FormatTimeString(e.Time,"HH:MM:SS.fff");this.Text=this.Text+"  "+i}else if(dt.IsTickPeriod(this.Data.Period)){i=sa.FormatTimeString(e.Time);this.Text=this.Text+"  "+i}if(this.IsShowIncrease&&sa.IsNonEmptyArray(this.Data.Data)){var r=this.Data.Data[this.Data.Data.length-1],n=(r.Close-e.YClose)/e.YClose*100;this.Text+=" ".concat($i.GetText("至今涨幅",this.LanguageID)).concat(n.toFixed(2),"%")}if(this.GetEventCallback){var o=this.GetEventCallback(m.ON_FORMAT_CORSSCURSOR_X_TEXT);if(o){var s={Item:e,Period:this.Data.Period,Date:e.Date,Time:e.Time,Index:this.Data.DataOffset+t,PreventDefault:!1};if(o.Callback(o,s,this),1==s.PreventDefault)return!1}}return!0}}function ga(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.ClassName="HQMinuteTimeStringFormat",this.Frame,this.Symbol,this.Point,this.ClientPos=-1,this.BeforeOpenData,this.AfterCloseData,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.GetEventCallback,this.GetBeforeOpen=function(){if(!this.BeforeOpenData||!this.BeforeOpenData.Data)return!1;var t=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,e=this.Frame.GetLeftExtendXData(t,this.BeforeOpenData);if(e=parseInt(e.toFixed(0)),e>=this.BeforeOpenData.Data.length)return!1;var a=this.BeforeOpenData.Data[e];return this.Text=this.FormatCallAcutionDateTime(a,this.BeforeOpenData),!0},this.GetAfterClose=function(){if(!this.AfterCloseData||!this.AfterCloseData.Data)return!1;var t=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,e=this.Frame.GetRightExtendXData(t,this.AfterCloseData);if(e=parseInt(e.toFixed(0)),e>=this.AfterCloseData.Data.length)return!1;var a=this.AfterCloseData.Data[e];return this.Text=this.FormatCallAcutionDateTime(a,this.AfterCloseData),!0},this.GetMultiDayBeforeOpen=function(){var t=this.GetMultiDayBeforeOpenData();if(!t)return!1;if(this.Frame.ChartBorder.MultiDayMinute.Count<=1||this.Frame.ChartBorder.MultiDayMinute.Left<=0)return!1;var e=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,a=this.Frame.GetLeftExtendXData(e,t);if(!a)return!1;if(a.DayIndex>=t.length)return!1;var i=t[a.DayIndex];if(a.DataIndex=parseInt(a.DataIndex.toFixed(0)),a.DataIndex>=i.Data.length||a.DataIndex<0)return!1;var r=i.Data[a.DataIndex];return this.Text=this.FormatCallAcutionDateTime(r,i),!0},this.GetMultiDayAfterClose=function(){var t=this.GetMultiDayAfterCloseData();if(!t)return!1;if(this.Frame.ChartBorder.MultiDayMinute.Count<=1||this.Frame.ChartBorder.MultiDayMinute.Right<=0)return!1;var e=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,a=this.Frame.GetRightExtendXData(e,t);if(!a)return!1;if(a.DayIndex>=t.length)return!1;var i=t[a.DayIndex];if(a.DataIndex=parseInt(a.DataIndex.toFixed(0)),a.DataIndex>=i.Data.length)return!1;var r=i.Data[a.DataIndex];return this.Text=this.FormatCallAcutionDateTime(r,i),!0},this.FormatCallAcutionDateTime=function(t,e){var a=t.Time;return 1==e.Ver?sa.FormatTimeString(a,"HH:MM"):sa.FormatTimeString(a,"HH:MM:SS")},this.Operator=function(){if(2==this.ClientPos)return this.GetBeforeOpen();if(3==this.ClientPos)return this.GetAfterClose();if(this.ClientPos>=200&&this.ClientPos<=299)return this.GetMultiDayBeforeOpen();if(this.ClientPos>=300&&this.ClientPos<=399)return this.GetMultiDayAfterClose();if(!sa.IsNumber(this.Value))return!1;var t=Math.abs(this.Value);t=parseInt(t.toFixed(0));var e=t;this.Frame&&this.Frame.MinuteCount&&(e=t%this.Frame.MinuteCount);var a=_r,i=a.GetTimeData(this.Symbol);if(!i)return!1;e<0?e=0:e>i.length&&(e=i.length-1),this.Frame&&t>=this.Frame.XPointCount&&(e=i.length-1);var r=i[e];if(this.Text=sa.FormatTimeString(r),this.GetEventCallback){var n=this.GetEventCallback(m.ON_FORMAT_CORSSCURSOR_X_TEXT);if(n){var o={Time:r,Index:e,PreventDefault:!1};if(n.Callback(n,o,this),1==o.PreventDefault)return!1}}return!0},this.GetMinuteCloseYPoint=function(t){var e=t.Type;if(1==e||2==e||3==e){if(1==e){if(!this.Data||this.Data.Data.length<=0)return null;var a=t.DataIndex;(a<0||a>=this.Data.Data.length)&&(a=this.Data.Data.length-1);var i=this.Data.Data[a],r=this.Frame.GetYFromData(i);return{Price:i,Y:r}}if(2==e){if(!this.BeforeOpenData||!this.BeforeOpenData.Data)return!1;if(t.DataIndex<0||t.DataIndex>=this.BeforeOpenData.Data.length)return null;var n=this.BeforeOpenData.Data[t.DataIndex];i=n.Price,r=this.Frame.GetYFromData(i);return{Price:i,Y:r}}if(3==e){if(!this.AfterCloseData||!this.AfterCloseData.Data)return!1;if(t.DataIndex<0||t.DataIndex>=this.AfterCloseData.Data.length)return null;n=this.AfterCloseData.Data[t.DataIndex],i=n.Price,r=this.Frame.GetYFromData(i);return{Price:i,Y:r}}}else if(10==e||20==e||30==e){if(10==e){if(!this.Data||this.Data.Data.length<=0)return null;a=this.Frame.MinuteCount*t.DayIndex+t.DataIndex;(a<0||a>=this.Data.Data.length)&&(a=this.Data.Data.length-1);i=this.Data.Data[a],r=this.Frame.GetYFromData(i);return{Price:i,Y:r}}if(20==e){var o=this.GetMultiDayBeforeOpenData();if(!o)return null;if(t.DayIndex<0||t.DayIndex>=o.length)return null;var s=o[t.DayIndex];if(t.DataIndex<0||t.DataIndex>=s.Data.length)return null;n=s.Data[t.DataIndex],i=n.Price,r=this.Frame.GetYFromData(i);return{Price:i,Y:r}}if(30==e){var h=this.GetMultiDayAfterCloseData();if(!h)return null;if(t.DayIndex<0||t.DayIndex>=h.length)return null;s=h[t.DayIndex];if(t.DataIndex<0||t.DataIndex>=s.Data.length)return null;n=s.Data[t.DataIndex],i=n.Price,r=this.Frame.GetYFromData(i);return{Price:i,Y:r}}}return null}}var xa=["日","一","二","三","四","五","六"];function Fa(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.ClassName="HistoryDataStringFormat",this.Symbol,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchagneColor=qi.UnchagneTextColor,this.VolColor=qi.Title.VolColor,this.AmountColor=qi.Title.AmountColor,this.TurnoverRateColor=qi.Title.TurnoverRateColor,this.PositionColor=qi.Title.PositionColor,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.LineCount=0,this.LineHeight=qi.PCTooltip.LineHeight,this.Width=157,this.Height=5*this.LineHeight,this.Operator=function(){var t=this.Value.Data;if(!t)return!1;this.Width=157,this.LanguageID==ji.LANGUAGE_ENGLISH_ID&&(this.Width=180);var e=this.GetFormatTitle(t);if(!e)return!1;var a=this.GenerateTitleHtml(e);return!!a&&(this.Text=a.Html,this.Height=a.LineCount*this.LineHeight,!0)},this.GenerateTitleHtml=function(t){var e=0,a="";if(t.Name&&(n="<span style='color:rgb(0,0,0);font:微软雅黑;font-size:12px;text-align:center;display: block;'>".concat(t.Name,"</span>"),a+=n,++e),t.Title)if(Array.isArray(t.Title))for(var i=0;i<t.Title.length;++i){var r=t.Title[i];n="<span class='tooltip-title'>".concat(r,"</span>"),a+=n,++e}else n="<span class='tooltip-title'>".concat(t.Title,"</span>"),a+=n,++e;if(sa.IsNonEmptyArray(t.AryText))for(i=0;i<t.AryText.length;++i){r=t.AryText[i];i>0&&(a+="<br/>");var n="<span class='tooltip-con'>".concat(r.Title,"</span><span class='tooltip-num' style='color:").concat(r.Color,";'>").concat(r.Text,"</span>");a+=n,++e}return{Html:a,LineCount:e}},this.GetFormatTitle=function(t){if(!t)return null;var e=this.Symbol.toUpperCase(),a=Jr(this.Symbol),i=new Date(parseInt(t.Date/1e4),t.Date/100%100-1,t.Date%100),r=sa.FormatDateString(t.Date),n=r,o=dt.IsTickPeriod(this.Value.ChartPaint.Data.Period);dt.IsDayPeriod(this.Value.ChartPaint.Data.Period,!0)?(c=$i.GetText(xa[i.getDay()],this.LanguageID),n="".concat(r,"&nbsp&nbsp").concat(c)):dt.IsMinutePeriod(this.Value.ChartPaint.Data.Period,!0)?(c=sa.FormatTimeString(t.Time),n="".concat(r,"&nbsp&nbsp").concat(c)):dt.IsSecondPeriod(this.Value.ChartPaint.Data.Period)||o?(c=sa.FormatTimeString(t.Time,"HH:MM:SS"),n="".concat(r,"&nbsp&nbsp").concat(c)):dt.IsMilliSecondPeriod(this.Value.ChartPaint.Data.Period)&&(c=sa.FormatTimeString(t.Time,"HH:MM:SS.fff"),n=["".concat(r,"&nbsp&nbsp").concat($i.GetText(xa[i.getDay()],this.LanguageID)),c]);var s={AryText:null,Title:n,Name:null};if(o){var h=[{Title:$i.GetText("DivTooltip-Price",this.LanguageID),Text:sa.IsNumber(t.Open)?t.Open.toFixed(a):"--",Color:this.GetColor(t.Open,t.YClose)}];if(sa.IsNumber(t.YClose)){var l=(t.Close-t.YClose)/t.YClose*100,u={Title:$i.GetText("DivTooltip-Increase",this.LanguageID),Text:"".concat(l.toFixed(2),"%"),Color:this.GetColor(l,0)};h.push(u)}s.AryText=h}else if(t.IsNonTrade);else{var C=t.Vol;e&&Pr.IsSHSZ(e)&&(C/=100);var D=null;this.GetEventCallback&&(D=this.GetEventCallback(m.ON_CUSTOM_UNCHANGE_KLINE_TITLE_COLOR));h=[{Title:$i.GetText("DivTooltip-Open",this.LanguageID),Text:sa.IsNumber(t.Open)?t.Open.toFixed(a):"--",Color:this.GetPriceColor("DivTooltip-Open",t.Open,t.YClose,t,D)},{Title:$i.GetText("DivTooltip-High",this.LanguageID),Text:sa.IsNumber(t.High)?t.High.toFixed(a):"--",Color:this.GetPriceColor("DivTooltip-High",t.High,t.YClose,t,D)},{Title:$i.GetText("DivTooltip-Low",this.LanguageID),Text:sa.IsNumber(t.Low)?t.Low.toFixed(a):"--",Color:this.GetPriceColor("DivTooltip-Low",t.Low,t.YClose,t,D)},{Title:$i.GetText("DivTooltip-Close",this.LanguageID),Text:sa.IsNumber(t.Close)?t.Close.toFixed(a):"--",Color:this.GetPriceColor("DivTooltip-Close",t.Close,t.YClose,t,D)},{Title:$i.GetText("DivTooltip-Vol",this.LanguageID),Text:sa.IsNumber(C)?sa.FormatValueString(C,2,this.LanguageID):"--",Color:this.VolColor},{Title:$i.GetText("DivTooltip-Amount",this.LanguageID),Text:sa.IsNumber(t.Amount)?sa.FormatValueString(t.Amount,2,this.LanguageID):"--",Color:this.AmountColor}];if(sa.IsNumber(t.YClose)){l=(t.Close-t.YClose)/t.YClose*100,u={Title:$i.GetText("DivTooltip-Increase",this.LanguageID),Text:"".concat(l.toFixed(2),"%"),Color:this.GetColor(l,0)};h.push(u)}if(sa.IsNumber(t.FlowCapital)){var f="--.--";if(0!=t.FlowCapital){var c=t.Vol/t.FlowCapital*100;f="".concat(c.toFixed(2),"%")}u={Title:$i.GetText("DivTooltip-Exchange",this.LanguageID),Text:f,Color:this.TurnoverRateColor};h.push(u)}if(Pr.IsFutures(e)&&sa.IsNumber(t.Position))u={Title:$i.GetText("DivTooltip-Position",this.LanguageID),Text:"".concat(t.Position),Color:this.PositionColor};"Overlay-KLine"==this.Value.ChartPaint.Name&&(s.Name=this.Value.ChartPaint.Title),s.AryText=h}return s},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.GetPriceColor=function(t,e,a,i,r){var n=this.GetColor(e,a);if(e==a&&r&&r.Callback){var o={Item:i,TitleName:t,DefaultColor:n,TitleColor:null,ClassName:this.ClassName};r.Callback(r,o),o.TitleColor&&(n=o.TitleColor)}return n}}function Ea(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchagneColor=qi.UnchagneTextColor,this.Width=500,this.Operator=function(){if(!this.Value)return!1;var t=this.Value.Data.Data,e=this.Value.Data.Type,a="";for(var i in t){var r=t[i],n="";switch(e){case ft.BLOCKTRADING:n=this.BlockTradingFormat(r);break;case ft.TRADEDETAIL:n=this.TradeDetailFormat(r);break;case ft.RESEARCH:n=this.ResearchFormat(r);break;case ft.PFORECAST:n=this.PerformanceForecastFormat(r);break;default:n=this.DefaultFormat(r);break}a+=n}var o="<div class='title-length'>"+a+"</div>";if(t.length>8){var s="<div class='total-list'>共"+t.length+"条</div>";o+=s}return this.Text=o,!0},this.DefaultFormat=function(t){var e=sa.FormatDateString(t.Date);if(sa.IsNumber(t.Time)){var a=sa.FormatTimeString(t.Time);e+=" "+a}var i="<span>".concat(e,"&nbsp;&nbsp;&nbsp;").concat(t.Title,"</span>");return i},this.BlockTradingFormat=function(t){var e=t.ExtendData,a=sa.FormatDateString(t.Date),i="<span><i class='date-tipbox'>"+a+"</i>&nbsp;&nbsp;<i class='tipBoxTitle'>成交价:&nbsp;"+e.Price.toFixed(2)+"</i><i class='tipBoxTitle'>收盘价:&nbsp;"+e.ClosePrice.toFixed(2)+"</i><br/><i class='rate-discount tipBoxTitle'>溢折价率:&nbsp;<strong style='color:"+this.GetColor(e.Premium.toFixed(2))+"'>"+e.Premium.toFixed(2)+"%</strong></i><i class='tipBoxTitle'>成交量(万股):&nbsp;"+e.Vol.toFixed(2)+"</i></span>";return i},this.TradeDetailFormat=function(t){var e=t.ExtendData.Detail,a=sa.FormatDateString(t.Date),i=[];for(var r in e)i+="<i>"+e[r].TypeExplain+"</i><br/>";var n="<span><i class='trade-time'>"+a+"&nbsp;&nbsp;&nbsp;上榜原因:&nbsp;&nbsp;</i><i class='reason-list'>"+i+"</i><br/><i class='trade-detall'>一周后涨幅:&nbsp;<strong style='color:"+this.GetColor(t.ExtendData.FWeek.Week1.toFixed(2))+"'>"+t.ExtendData.FWeek.Week1.toFixed(2)+"%</strong>&nbsp;&nbsp;&nbsp;四周后涨幅:&nbsp;<strong style='color:"+this.GetColor(t.ExtendData.FWeek.Week4.toFixed(2))+";'>"+t.ExtendData.FWeek.Week4.toFixed(2)+"%</strong></i></span>";return n},this.ResearchFormat=function(t){var e=t.ExtendData.Level,a="";if(0==e.length)a="<i>一般调研</i>";else{for(var i in e)0==e[i]?a+="<i style='color:#00a0e9'>证券代表&nbsp;&nbsp;&nbsp;</i>":1==e[i]?a+="<i>董秘&nbsp;&nbsp;&nbsp;</i>":2==e[i]?a+="<i style='color:#00a0e9'>总经理&nbsp;&nbsp;&nbsp;</i>":3==e[i]&&(a+="<i style='color:#00a0e9'>董事长&nbsp;&nbsp;&nbsp;</i>");a="接待:&nbsp;&nbsp;&nbsp;"+a}var r="";t.ExtendData.Type&&"其他"!=t.ExtendData.Type&&(r="&nbsp;&nbsp;&nbsp;<i>"+t.ExtendData.Type+"</i>",0==e.length&&(a=""));var n=sa.FormatDateString(t.Date),o="<span>"+n+"&nbsp;&nbsp;&nbsp;"+r+a+"</span>";return o},this.PerformanceForecastFormat=function(t){var e,a=t.ExtendData.ReportDate,i=parseInt(a/1e4),r=a%1e4;1231==r?e="年报":331==r?e="一季度报":630==r?e="半年度报":930==r&&(e="三季度报");var n="";t.ExtendData.FWeek&&(null!=t.ExtendData.FWeek.Week1&&(n+="一周后涨幅:<i class='increase' style='color:"+this.GetColor(t.ExtendData.FWeek.Week1.toFixed(2))+"'>"+t.ExtendData.FWeek.Week1.toFixed(2)+"%</i>"),null!=t.ExtendData.FWeek.Week4&&(n+="&nbsp;四周后涨幅:<i class='increase' style='color:"+this.GetColor(t.ExtendData.FWeek.Week4.toFixed(2))+"'>"+t.ExtendData.FWeek.Week4.toFixed(2)+"%</i>"),n.length>0&&(n="<br/>&nbsp;&nbsp;<i class='prorecast-week'>"+n+"</i>"));var o=sa.FormatDateString(t.Date),s="<span>"+o+"&nbsp;&nbsp;"+i+e+t.Title+"&nbsp;"+n+"</span>";return s},this.GetColor=function(t){return t>0?this.UpColor:t<0?this.DownColor:this.UnchagneColor}}function La(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Width=120,this.Operator=function(){var t=this.Value.Data;if(!t)return!1;var e,a=t.Data,i="<span class='tooltip-index-name'>".concat(a.Name).concat(a.Param,":</span>");return e=1==a.Type?"<span class='tooltip-index-buy'>买入</span>":"<span class='tooltip-index-sell'>卖出</span>",this.Text=i+e,!0}}function Ma(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Width=200,this.Operator=function(){var t=this.Value.Data;if(!t)return!1;var e=t.Data.Item,a=sa.FormatTimeString(e.Time),i="<span class='tooltip-minuteinfo-time'>".concat(a," </span>"),r="<span class='tooltip-minuteinfo-content'>".concat(e.Title,"</span>");return e.Content&&(r="<span class='tooltip-minuteinfo-content'>".concat(e.Content,"</span>")),this.Text=i+r,!0}}function ya(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Width=200,this.Operator=function(){if(!this.Value||!this.Value.Data)return!1;var t=this.Value.Data;return!!t.Item&&(!!t.Item.Text&&(this.Text=t.Item.Text,!0))}}function Ra(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Width=200,this.Operator=function(){if(!this.Value||!this.Value.Data)return!1;var t=this.Value.Data;return!!t.Item&&(!(!t.Item.Tooltip||!t.Item.Tooltip.Text)&&(this.Text=t.Item.Tooltip.Text,!0))}}function Na(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Width=200,this.Period=0,this.Operator=function(){var t=this.Value.Data;if(!t||!t.Data)return!1;if(dt.IsDayPeriod(this.Period,!0)){var e=sa.FormatDateString(t.Data.Start.Date),a=sa.FormatDateString(t.Data.End.Date);if(e==a)return this.Text="<span class='tooltip-minuteinfo-content'>".concat(e,"</span>"),!0;var i="<span class='tooltip-minuteinfo-content'>起始时间:".concat(e,"</span>"),r="<span class='tooltip-minuteinfo-content'>结束时间:".concat(a,"</span>");return this.Text=i+"<br>"+r,!0}if(dt.IsMinutePeriod(this.Period,!0)){e=sa.FormatDateString(t.Data.Start.Date);var n=sa.FormatTimeString(t.Data.Start.Time,"HH:MM"),o=(a=sa.FormatDateString(t.Data.End.Date),sa.FormatTimeString(t.Data.End.Time,"HH:MM"));i="<span class='tooltip-minuteinfo-content'>起始时间:".concat(e," ").concat(n,"</span>"),r="<span class='tooltip-minuteinfo-content'>结束时间:".concat(a," ").concat(o,"</span>");return this.Text=i+"<br>"+r,!0}return!1}}function wa(){this.newMethod=Sa,this.newMethod(),delete this.newMethod,this.Width=200,this.Operator=function(){var t=this.Value.Data;if(!t||!t.Data)return!1;if(!sa.IsNonEmptyArray(t.Data.Tooltip))return!1;this.Text="";for(var e=0;e<t.Data.Tooltip.length;++e){var a=t.Data.Tooltip[e],i="<span class='tooltip-minuteinfo-content'>".concat(a,"</span>");this.Text+=i+"<br>"}return!0}}var Aa=new function(){this.DataMap=new Map([["KLineTradeDataStringFormat",{Create:function(){return new La}}],["MinuteInfoDataStringFormat",{Create:function(){return new Ma}}],["HistoryDataStringFormat",{Create:function(){return new Fa}}],["KLineInfoDataStringFormat",{Create:function(){return new Ea}}],["IconDataStringFormat",{Create:function(){return new ya}}],["ChartOXDataStringFormat",{Create:function(){return new Na}}],["ScatterPlotDataStringFormat",{Create:function(){return new wa}}],["ChartDrawSVGDataStringFormat",{Create:function(){return new Ra}}],["CorssCursor_XStringFormat",{Create:function(){return new pa}}],["CorssCursor_YStringFormat",{Create:function(){return new va}}],["CorssCursor_Minute_XStringFormat",{Create:function(){return new ga}}]]),this.Create=function(t){if(!this.DataMap.has(t))return null;var e=this.DataMap.get(t);return e.Create()}};function Oa(){this.Frame,this.Data=new Array,this.Canvas,this.IsDynamic=!1,this.Position=0,this.CursorIndex,this.LastPoint,this.Font=qi.TitleFont,this.Title,this.TitleColor=qi.DefaultTextColor,this.ClassName="IChartTitlePainting",this.DrawStatus,this.GetEventCallback,this.GlobalOption,this.ReloadResource=function(){this.Font=qi.TitleFont,this.TitleColor=qi.DefaultTextColor}}var ba=["不复权","前复权","后复权"];function Ba(){this.newMethod=Oa,this.newMethod(),delete this.newMethod,this.ClassName="DynamicKLineTitlePainting",this.IsDynamic=!0,this.IsShow=!0,this.Period,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchagneColor=qi.UnchagneTextColor,this.VolColor=qi.Title.VolColor,this.AmountColor=qi.Title.AmountColor,this.DateTimeColor=qi.Title.DateTimeColor,this.NameColor=qi.Title.NameColor,this.SettingColor=qi.Title.SettingColor,this.TurnoverRateColor=qi.Title.TurnoverRateColor,this.PositionColor=qi.Title.PositionColor,this.Symbol,this.Name,this.SpaceWidth=2*F(),this.OverlayChartPaint,this.IsShowName=!0,this.IsShowSettingInfo=!0,this.IsShowDateTime=!0,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.ShowPositionConfig={Margin:{Bottom:2,Left:2}},this.OnDrawEvent,this.OnMouseMoveEvent,this.HQChart,this.ReloadResource=function(){this.Font=qi.TitleFont,this.TitleColor=qi.DefaultTextColor,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchagneColor=qi.UnchagneTextColor,this.VolColor=qi.Title.VolColor,this.AmountColor=qi.Title.AmountColor,this.DateTimeColor=qi.Title.DateTimeColor,this.NameColor=qi.Title.NameColor,this.SettingColor=qi.Title.SettingColor,this.TurnoverRateColor=qi.Title.TurnoverRateColor,this.PositionColor=qi.Title.PositionColor},this.GetCurrentKLineData=function(){if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.GetFormatTitle=function(t){if(t&&t.Data){var e=Jr(this.Symbol),a=this.Symbol.toUpperCase(),i=t.Data,r=[],n={AryText:r};if(this.IsShowName&&r.push({Text:this.Name,Color:this.NameColor}),this.IsShowSettingInfo){var o="";o=this.Data.Period>Tt&&this.Data.Period<=vt?this.Data.Period-Tt+$i.GetText("自定义分钟",this.LanguageID):this.Data.Period>It&&this.Data.Period<=St?this.Data.Period-It+$i.GetText("自定义日线",this.LanguageID):this.Data.Period>3e4&&this.Data.Period<=32e3?this.Data.Period-3e4+$i.GetText("自定义秒",this.LanguageID):this.Data.Period>5e4&&this.Data.Period<=6e4?this.Data.Period-5e4+$i.GetText("自定义毫秒",this.LanguageID):$i.GetText(dt.GetPeriodName(this.Data.Period),this.LanguageID);var s=$i.GetText(ba[this.Data.Right],this.LanguageID),h="("+o+" "+s+")";Pr.IsEnableRight(this.Data.Period,this.Symbol,this.HQChart.RightFormula)||(h="("+o+")"),r.push({Text:h,Color:this.SettingColor})}h=this.GetKLineCalculateTitle();if(h&&r.push({Text:h,Color:this.NameColor}),this.IsShowDateTime){h=sa.FormatDateString(i.Date);r.push({Text:h,Color:this.DateTimeColor})}var l=dt.IsTickPeriod(this.Period);if(dt.IsMinutePeriod(this.Period,!0)&&sa.IsNumber(i.Time)){h=sa.FormatTimeString(i.Time);r.push({Text:h,Color:this.DateTimeColor})}else if(dt.IsSecondPeriod(this.Period)&&sa.IsNumber(i.Time)){h=sa.FormatTimeString(i.Time,"HH:MM:SS");r.push({Text:h,Color:this.DateTimeColor})}else if(dt.IsMilliSecondPeriod(this.Period)&&sa.IsNumber(i.Time)){h=sa.FormatTimeString(i.Time,"HH:MM:SS.fff");r.push({Text:h,Color:this.DateTimeColor})}else if(l){h=sa.FormatTimeString(i.Time,"HH:MM:SS");r.push({Text:h,Color:this.DateTimeColor})}if(l){var u=this.GetColor(i.Open,i.YClose);h=$i.GetText("KTitle-Price",this.LanguageID)+i.Open.toFixed(e);if(r.push({Text:h,Color:u}),sa.IsNumber(i.YClose)&&0!=i.YClose){var C=(i.Close-i.YClose)/i.YClose*100;u=this.GetColor(C,0),h=$i.GetText("KTitle-Increase",this.LanguageID)+C.toFixed(2)+"%";r.push({Text:h,Color:u})}return n}if(i.IsNonTrade)return n;var D=null;if(this.GetEventCallback&&(D=this.GetEventCallback(m.ON_CUSTOM_UNCHANGE_KLINE_TITLE_COLOR)),sa.IsNumber(i.Open)){u=this.GetColor(i.Open,i.YClose),h=$i.GetText("KTitle-Open",this.LanguageID)+i.Open.toFixed(e);if(i.Open==i.YClose&&D){var f={Item:i,TitleName:"KTitle-Open",DefaultColor:u,TitleColor:null};this.OnUnchangeTitleColor(D,f)&&(u=f.TitleColor)}r.push({Text:h,Color:u})}if(sa.IsNumber(i.High)){u=this.GetColor(i.High,i.YClose),h=$i.GetText("KTitle-High",this.LanguageID)+i.High.toFixed(e);if(i.High==i.YClose&&D){f={Item:i,TitleName:"KTitle-High",DefaultColor:u,TitleColor:null};this.OnUnchangeTitleColor(D,f)&&(u=f.TitleColor)}r.push({Text:h,Color:u})}if(sa.IsNumber(i.Low)){u=this.GetColor(i.Low,i.YClose),h=$i.GetText("KTitle-Low",this.LanguageID)+i.Low.toFixed(e);if(i.Low==i.YClose&&D){f={Item:i,TitleName:"KTitle-Low",DefaultColor:u,TitleColor:null};this.OnUnchangeTitleColor(D,f)&&(u=f.TitleColor)}r.push({Text:h,Color:u})}if(sa.IsNumber(i.Close)){u=this.GetColor(i.Close,i.YClose),h=$i.GetText("KTitle-Close",this.LanguageID)+i.Close.toFixed(e);if(i.Close==i.YClose&&D){f={Item:i,TitleName:"KTitle-Close",DefaultColor:u,TitleColor:null};this.OnUnchangeTitleColor(D,f)&&(u=f.TitleColor)}r.push({Text:h,Color:u})}if(i.YFClose>0&&Pr.IsChinaFutures(a)){C=(i.Close-i.YFClose)/i.YFClose*100,u=this.GetColor(C,0),h=$i.GetText("KTitle-Increase",this.LanguageID)+C.toFixed(2)+"%";r.push({Text:h,Color:u})}else if(i.YClose>0){C=(i.Close-i.YClose)/i.YClose*100,u=this.GetColor(C,0),h=$i.GetText("KTitle-Increase",this.LanguageID)+C.toFixed(2)+"%";r.push({Text:h,Color:u})}if(sa.IsNumber(i.Vol)){var c=Pr.GetVolUnit(a),d=i.Vol/c;h=$i.GetText("KTitle-Vol",this.LanguageID)+sa.FromatIntegerString(d,2,this.LanguageID);r.push({Text:h,Color:this.VolColor})}if(sa.IsNumber(i.Amount)){h=$i.GetText("KTitle-Amount",this.LanguageID)+sa.FormatValueString(i.Amount,2,this.LanguageID);r.push({Text:h,Color:this.AmountColor})}if(sa.IsNumber(i.FlowCapital)){h="--.--";if(0!=i.FlowCapital)C=i.Vol/i.FlowCapital*100,h=$i.GetText("KTitle-Exchange",this.LanguageID)+sa.FormatValueString(C,2,this.LanguageID)+"%";r.push({Text:h,Color:this.TurnoverRateColor})}if(Pr.IsFutures(a)&&sa.IsNumber(i.Position)){h=$i.GetText("KTitle-Position",this.LanguageID)+i.Position;r.push({Text:h,Color:this.PositionColor})}if(sa.IsNonEmptyArray(this.OverlayChartPaint))for(var I=0;I<this.OverlayChartPaint.length;++I){i=this.OverlayChartPaint[I];if(i.Symbol&&i.Title){var S=i.Color;h="[".concat(i.Title,"]");r.push({Text:h,Color:S})}}return n}},this.GetLeft=function(t){if(t){var e=this.Frame.ChartBorder.GetTop();if(this.ShowPositionConfig){var a=this.ShowPositionConfig;1===a.Type&&(e=0),a.Margin&&sa.IsNumber(a.Margin.Left)&&(e+=a.Margin.Left)}return e}e=this.Frame.ChartBorder.Left;if(this.ShowPositionConfig){a=this.ShowPositionConfig;1===a.Type&&(e=0),a.Margin&&sa.IsNumber(a.Margin.Left)&&(e+=a.Margin.Left)}return e},this.GetRight=function(t){if(t){var e=this.Frame.ChartBorder.GetHeight();if(this.ShowPositionConfig){var a=this.ShowPositionConfig;1===a.Type&&(e=this.Frame.ChartBorder.GetChartHeight()),a.Margin&&sa.IsNumber(a.Margin.Right)&&(e-=a.Margin.Right)}return e}e=this.Frame.ChartBorder.GetRight();if(this.ShowPositionConfig){a=this.ShowPositionConfig;1===a.Type&&(e=this.Frame.ChartBorder.GetChartWidth()),a.Margin&&sa.IsNumber(a.Margin.Right)&&(e-=a.Margin.Right)}return e},this.GetBottom=function(t){if(t){var e=this.Frame.ChartBorder.GetRight();if(this.ShowPositionConfig){var a=this.ShowPositionConfig;a.Margin&&sa.IsNumber(a.Margin.Bottom)&&(e+=a.Margin.Bottom)}return e}e=this.Frame.ChartBorder.GetTop();if(this.ShowPositionConfig){a=this.ShowPositionConfig;a.Margin&&sa.IsNumber(a.Margin.Bottom)&&(e-=a.Margin.Bottom)}return e},this.DrawItem=function(t){var e=!0===this.Frame.IsHScreen,a=this.GetLeft(e),i=this.GetRight(e),r=this.GetBottom(e),n=F();if(e){if(this.Frame.ChartBorder.Right<5*n)return;var o=r,s=a;this.Canvas.translate(o,s),this.Canvas.rotate(90*Math.PI/180),a=r=0}else if(this.Frame.ChartBorder.Top<5*n)return;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var h={Left:a,MaxRight:i,Bottom:r,IsHScreen:e},l=this.GetFormatTitle({Data:t});if(l&&sa.IsNonEmptyArray(l.AryText))for(var u=0;u<l.AryText.length;++u){t=l.AryText[u];if(!this.DrawText(t.Text,t.Color,h))break}},this.Draw=function(){if(this.IsShow)if(null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null);else{this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText("0").width;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)this.OnDrawEventCallback(null);else{this.IsShowLastData()&&(e=this.Data.Data.length-1);var a=this.Data.Data[e];this.OnDrawEventCallback(a),this.Canvas.save(),this.DrawItem(a),this.Canvas.restore()}}},this.OnDrawEventCallback=function(t){var e=this.OnDrawEvent&&this.OnDrawEvent.Callback,a=this.OnMouseMoveEvent&&this.OnMouseMoveEvent.Callback;if(e||a){var i={Draw:t,Name:this.ClassName};if(this.Data&&this.Data.Data){var r=Math.abs(this.CursorIndex);r=parseInt(r.toFixed(0));var n=this.Data.DataOffset+r,o=this.Data.Data.length;i.DataIndex=n,i.DataCount=o}if(sa.IsNonEmptyArray(this.OverlayChartPaint)){i.OverlayStock=[];for(var s=0;s<this.OverlayChartPaint.length;++s){var h=this.OverlayChartPaint[s];h.Symbol&&h.Title&&i.OverlayStock.push({Symbol:h.Symbol,Name:h.Title,Data:h.Data,Color:h.Color})}}e&&this.OnDrawEvent.Callback(this.OnDrawEvent,i,this),a&&this.OnMouseMoveEvent.Callback(this.OnMouseMoveEvent,i,this)}},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.OnUnchangeTitleColor=function(t,e){return!(!t||!t.Callback)&&(e.ClassName=this.ClassName,t.Callback(t,e,this),!(!e||!e.TitleColor))},this.DrawText=function(t,e,a){if(!t)return!0;var i=!0===this.Frame.IsHScreen,r=this.Frame.ChartBorder.GetRight();i&&(r=this.Frame.ChartBorder.GetHeight()),sa.IsNumber(a.MaxRight)&&(r=a.MaxRight),this.Canvas.fillStyle=e;var n=this.Canvas.measureText(t).width;return!(a.Left+n>r)&&(this.IsShow&&this.Canvas.fillText(t,a.Left,a.Bottom,n),a.Left+=n+this.SpaceWidth,!0)},this.GetKLineCalculateTitle=function(){if(!this.HQChart)return null;var t=this.HQChart.GetKLineCalulate();return t&&t.GetTitle?t.GetTitle():null},this.IsShowLastData=function(){if(this.HQChart&&this.HQChart.EnableClickModel&&this.HQChart.ClickModel){var t=this.HQChart.ClickModel;if(t.IsShowCorssCursor)return!1}var e=!1;if(this.DrawStatus&&this.DrawStatus.IsTitleShowLatestData){var a=this.DrawStatus;(!sa.IsNumber(a.FrameID)||a.FrameID<0||a.CorssCursorTouchEnd&&0==a.IsOnTouch)&&(e=!0)}return e}}function Pa(){this.newMethod=Ba,this.newMethod(),delete this.newMethod,this.ClassName="DynamicMinuteTitlePainting",this.SpaceWidth=1*F(),this.YClose,this.IsShowDate=!1,this.IsShowTime=!0,this.IsShowName=!0,this.IsShowAveragePrice=!0,this.OverlayChartPaint,this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.LastShowData,this.OnDrawEvent,this.PointInfo=null,this.IsAlwaysShowLastData=!1,this.ShowLastDataFormat=0,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.TimeFormat,this.CallAuctionShowTitle=new Set(["MTitle-AC-Price","MTitle-AC-Vol","MTitle-AC-NotMatchVol","MTitle-AC-Increase","MTitle-AC-AvPrice"]),this.GetCurrentKLineData=function(){if(this.LastShowData)return this.LastShowData;if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=Math.abs(this.CursorIndex);t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.GetCurrentAuctionData=function(){var t=!0===this.Frame.IsHScreen,e={ClientPos:this.PointInfo.ClientPos,X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y};if(2==this.PointInfo.ClientPos){if(!this.BeforeOpenData)return e;if(!this.CallAcutionXOperator)return e;if(this.CallAcutionXOperator.Value=t?this.PointInfo.Point.Y:this.PointInfo.Point.X,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos,!this.CallAcutionXOperator.Operator())return e;var a={Explain:"BeforeOpen",Data:null,DataIndex:null,DataTotalCount:this.BeforeOpenData.TotalCount};return a.DataIndex=this.CallAcutionXOperator.DataIndex,a.Data=this.CallAcutionXOperator.Item,a.Ver=this.BeforeOpenData.Ver,a}if(3==this.PointInfo.ClientPos){if(!this.AfterCloseData)return e;if(!this.CallAcutionXOperator)return e;if(this.CallAcutionXOperator.Value=t?this.PointInfo.Point.Y:this.PointInfo.Point.X,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos,!this.CallAcutionXOperator.Operator())return e;a={Explain:"AfterClose",Data:null,DataIndex:null,DataTotalCount:this.AfterCloseData.TotalCount};return a.DataIndex=this.CallAcutionXOperator.DataIndex,a.Data=this.CallAcutionXOperator.Item,a.Ver=this.AfterCloseData.Ver,a}if(this.PointInfo.ClientPos>=200&&this.PointInfo.ClientPos<=299){if(!this.MultiDayBeforeOpenData||!sa.IsNonEmptyArray(this.MultiDayBeforeOpenData))return e;var i=1==this.Frame.IsHScreen?this.PointInfo.Point.Y:this.PointInfo.Point.X;if(this.CallAcutionXOperator.Value=i,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos,!this.CallAcutionXOperator.Operator())return e;var r=this.MultiDayBeforeOpenData[this.CallAcutionXOperator.DayIndex];a={Explain:"MultiDayBeforeOpen",Data:null,DataIndex:null};return a.DataIndex=this.CallAcutionXOperator.DataIndex,a.DayIndex=this.CallAcutionXOperator.DayIndex,a.Data=this.CallAcutionXOperator.Item,a.Ver=r.Ver,a}if(this.PointInfo.ClientPos>=300&&this.PointInfo.ClientPos<=399){if(!this.MultiDayAfterCloseData||!sa.IsNonEmptyArray(this.MultiDayAfterCloseData))return e;i=1==this.Frame.IsHScreen?this.PointInfo.Point.Y:this.PointInfo.Point.X;if(this.CallAcutionXOperator.Value=i,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos,!this.CallAcutionXOperator.Operator())return e;r=this.MultiDayAfterCloseData[this.CallAcutionXOperator.DayIndex],a={Explain:"MultiDayAfterClose",Data:null,DataIndex:null};return a.DataIndex=this.CallAcutionXOperator.DataIndex,a.DayIndex=this.CallAcutionXOperator.DayIndex,a.Data=this.CallAcutionXOperator.Item,a.Ver=r.Ver,a}return e},this.GetLatestKLineData=function(t){var e,a=null,i=1;if(sa.IsNonEmptyArray(this.MultiDayBeforeOpenData)){var r=this.MultiDayBeforeOpenData[this.MultiDayBeforeOpenData.length-1];r&&sa.IsNonEmptyArray(r.Data)&&(i=r.Ver,a=r.Data[r.Data.length-1],e="MultiDayBeforeOpen")}else this.BeforeOpenData&&sa.IsNonEmptyArray(this.BeforeOpenData.Data)&&(a=this.BeforeOpenData.Data[this.BeforeOpenData.Data.length-1],i=this.BeforeOpenData.Ver,e="BeforeOpen");var n,o=null,s=1;if(sa.IsNonEmptyArray(this.MultiDayAfterCloseData)){r=this.MultiDayAfterCloseData[this.MultiDayAfterCloseData.length-1];r&&sa.IsNonEmptyArray(r.Data)&&(s=r.Ver,o=r.Data[r.Data.length-1],n="MultiDayAfterClose",r.Data.length==r.TotalCount&&(o=null))}else this.AfterOpenData&&sa.IsNonEmptyArray(this.AfterOpenData.Data)&&(o=this.AfterOpenData.Data[this.AfterOpenData.Data.length-1],s=this.AfterOpenData.Ver,n="AfterClose");var h=null;if(this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var l=this.Data.Data.length;h=this.Data.Data[l-1]}return a||o||h?t?h?a&&h&&(a.Date>h.Date||a.Date==h.Date&&a.Time>h.Time&&1==i||a.Date==h.Date&&parseInt(a.Time>h.Time)&&2==i)?{Type:2,Data:a,Ver:i,Explain:e}:o&&h&&o.Date>=h.Date?{Type:1,Data:o,Ver:s,Explain:n}:{Type:0,Data:h}:{Type:1,Data:a,Ver:i,Explain:e}:{Type:0,Data:h}:null},this.GetFormatTitle=function(t){if(t&&t.Data){var e=this.Symbol.toUpperCase(),a=Jr(this.Symbol),i=Pr.IsFutures(e),r=Pr.GetVolUnit(e),n=t.Data,o=t.IsLastOne,s=[];if(this.IsShowName&&s.push({Text:this.Name,Color:this.NameColor}),this.IsShowDate||this.IsShowTime){var h=!1;if(o&&1==this.ShowLastDataFormat&&this.Data&&this.Data.UpdateTime&&sa.IsNumber(this.Data.UpdateTime.Date)&&sa.IsNumber(this.Data.UpdateTime.Time)){var l=sa.FormatTimeString(this.Data.UpdateTime.Time,"HH:MM:SS");s.push({Text:l,Color:this.DateTimeColor}),h=!0}if(!h)if(this.TimeFormat){var u=null,C=null;l=null;this.IsShowDate&&(u=sa.FormatDateString("YYYY-MM-DD",n.Date)),this.IsShowTime&&(C=sa.FormatTimeString(n.Time,this.TimeFormat)),u&&C?l="".concat(u," ").concat(C):u?l=u:C&&(l=C),l&&s.push({Text:l,Color:this.DateTimeColor})}else{l=sa.FormatDateTimeString(n.DateTime,this.IsShowDate,this.IsShowTime);s.push({Text:l,Color:this.DateTimeColor})}}var D=n.Close,f=n.Increase,c=n.Vol,m=n.Amount,d=n.YClose;if(sa.IsNumber(d)||(d=this.YClose),i&&sa.IsNumber(n.YClearing)&&(d=n.YClearing),sa.IsNumber(D)){var I=this.GetColor(D,d);l=$i.GetText("MTitle-Close",this.LanguageID)+D.toFixed(a);s.push({Text:l,Color:I})}if(sa.IsNumber(f)){I=this.GetColor(f,0),l=$i.GetText("MTitle-Increase",this.LanguageID)+f.toFixed(2)+"%";s.push({Text:l,Color:I})}var S=!0;e=this.Symbol.toUpperCase();if((Pr.IsET(e)&&!Pr.IsETShowAvPrice(e)||Pr.IsShowAvPrice&&!Pr.IsShowAvPrice(e))&&(S=!1),sa.IsNumber(n.AvPrice)&&S&&this.IsShowAveragePrice){I=this.GetColor(n.AvPrice,d),l=$i.GetText("MTitle-AvPrice",this.LanguageID)+n.AvPrice.toFixed(a);s.push({Text:l,Color:I})}if(sa.IsNumber(c)){l=$i.GetText("MTitle-Vol",this.LanguageID)+sa.FromatIntegerString(c/r,2,this.LanguageID);s.push({Text:l,Color:this.VolColor})}if(sa.IsNumber(m)){l=$i.GetText("MTitle-Amount",this.LanguageID)+sa.FormatValueString(m,2,this.LanguageID);s.push({Text:l,Color:this.AmountColor})}if(sa.IsNumber(n.Position)){l=$i.GetText("MTitle-Position",this.LanguageID)+sa.FromatIntegerString(n.Position,2,this.LanguageID);s.push({Text:l,Color:this.VolColor})}if(o&&0==this.ShowLastDataFormat&&this.Data&&this.Data.UpdateTime&&sa.IsNumber(this.Data.UpdateTime.Date)&&sa.IsNumber(this.Data.UpdateTime.Time)){l=$i.GetText("MTitle-UpdateTime",this.LanguageID)+sa.FormatTimeString(this.Data.UpdateTime.Time,"HH:MM:SS");s.push({Text:l,Color:this.DateTimeColor})}if(sa.IsNonEmptyArray(this.OverlayChartPaint))for(var T=0;T<this.OverlayChartPaint.length;++T){n=this.OverlayChartPaint[T];if(n.Symbol&&n.Title){var v=n.Color;l="[".concat(n.Title,"]");s.push({Text:l,Color:v})}}return{AryText:s}}},this.DrawItem=function(t,e){if(t){var a=F(),i=!0===this.Frame.IsHScreen,r=(this.Frame.GetBorder(),this.GetLeft(i)),n=this.GetRight(i),o=this.GetBottom(i);if(i){if(this.Frame.ChartBorder.Right<5*a)return;var s=o,h=r;this.Canvas.translate(s,h),this.Canvas.rotate(90*Math.PI/180),r=o=0}else if(this.Frame.ChartBorder.Top<5*a)return;this.Canvas.font=this.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var l={Left:r,MaxRight:n,Bottom:o,IsHScreen:i},u=this.GetFormatTitle({Data:t,IsLastOne:e});if(u&&sa.IsNonEmptyArray(u.AryText))for(var C=0;C<u.AryText.length;++C){t=u.AryText[C];if(!this.DrawText(t.Text,t.Color,l))break}}},this.FormatCallAuctionTitle=function(t){var e=[],a=Jr(this.Symbol),i=this.Symbol.toUpperCase(),r=Pr.GetVolUnit(i);if(this.IsShowName&&e.push({Text:this.Name,Color:this.NameColor}),t&&t.Data){var n,o,s=t.Data;o=sa.FormatDateString(s.Date);var h=s.YClose;if(n=1==t.Ver?sa.FormatTimeString(s.Time,"HH:MM"):sa.FormatTimeString(s.Time,"HH:MM:SS"),C="MultiDayBeforeOpen"==t.Explain||"MultiDayAfterClose"==t.Explain?"".concat(o," ").concat(n):n,e.push({Text:C,Color:this.DateTimeColor}),sa.IsNumber(s.Price)&&this.CallAuctionShowTitle.has("MTitle-AC-Price")){var l=this.GetColor(s.Price,h),u="MTitle-AC-Price";1==t.Ver&&(u="MTitle-Close");var C=$i.GetText(u,this.LanguageID)+s.Price.toFixed(a);e.push({Text:C,Color:l})}if(sa.IsPlusNumber(h)&&sa.IsNumber(s.Price)&&this.CallAuctionShowTitle.has("MTitle-AC-Increase")){var D=(s.Price-h)/h*100;l=this.GetColor(D,0),u="MTitle-AC-Increase";1==t.Ver&&(u="MTitle-Increase");C=$i.GetText(u,this.LanguageID)+D.toFixed(2)+"%";e.push({Text:C,Color:l})}if(sa.IsNumber(s.AvPrice)&&this.CallAuctionShowTitle.has("MTitle-AC-AvPrice")){l=this.GetColor(s.AvPrice,h),C=$i.GetText("MTitle-AC-AvPrice",this.LanguageID)+s.AvPrice.toFixed(a);e.push({Text:C,Color:l})}if(sa.IsNumber(s.Vol[0])&&this.CallAuctionShowTitle.has("MTitle-AC-Vol")){u="MTitle-AC-Vol";1==t.Ver&&(u="MTitle-Vol");C=$i.GetText(u,this.LanguageID)+sa.FromatIntegerString(s.Vol[0]/r,2);e.push({Text:C,Color:this.VolColor})}if(sa.IsNumber(s.Vol[1])&&this.CallAuctionShowTitle.has("MTitle-AC-NotMatchVol")){C=$i.GetText("MTitle-AC-NotMatchVol",this.LanguageID)+sa.FromatIntegerString(s.Vol[1]/r,2);e.push({Text:C,Color:this.VolColor})}if(s.ExtendData&&sa.IsNonEmptyArray(s.ExtendData.Amount)){var f=s.ExtendData.Amount;if(sa.IsNumber(f[0])&&this.CallAuctionShowTitle.has("MTitle-AC-Amount")){C=$i.GetText("MTitle-AC-Amount",this.LanguageID)+sa.FromatIntegerString(f[0],2);e.push({Text:C,Color:this.AmountColor})}if(sa.IsNumber(f[1])&&this.CallAuctionShowTitle.has("MTitle-AC-NotMatchAmount")){C=$i.GetText("MTitle-AC-NotMatchAmount",this.LanguageID)+sa.FromatIntegerString(f[1],2);e.push({Text:C,Color:this.AmountColor})}}}return{AryText:e}},this.DrawCallAuction=function(){var t=!0===this.Frame.IsHScreen,e=(this.Frame.GetBorder(),F()),a=this.GetLeft(t),i=this.GetRight(t),r=this.GetBottom(t),n=!0;if(t){if(this.Frame.ChartBorder.Right<5*e)return;var o=r,s=a;this.Canvas.translate(o,s),this.Canvas.rotate(90*Math.PI/180),a=r=0}else this.Frame.ChartBorder.Top<5*e&&(n=!1);this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var h={Left:a,Bottom:r,MaxRight:i,IsHScreen:t},l=this.GetCurrentAuctionData(),u=this.FormatCallAuctionTitle(l);if(n&&u&&sa.IsNonEmptyArray(u.AryText))for(var C=0;C<u.AryText.length;++C){var D=u.AryText[C];if(!this.DrawText(D.Text,D.Color,h))break}this.OnDrawCallAuctionEventCallback(l)},this.OnDrawCallAuctionEventCallback=function(t){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var e={Draw:t,Name:this.ClassName};this.OnDrawEvent.Callback(this.OnDrawEvent,e,this)}if(this.OnMouseMoveEvent&&this.OnMouseMoveEvent.Callback){e={Draw:t,Name:this.ClassName};this.OnMouseMoveEvent.Callback(this.OnDrawEvent,e,this)}},this.DrawNone=function(){this.OnDrawEventCallback(null);var t=this.IsAlwaysShowLastData;if(this.DrawStatus&&this.DrawStatus.IsTitleShowLatestData){var e=this.DrawStatus;(!sa.IsNumber(e.FrameID)||e.FrameID<0||e.CorssCursorTouchEnd&&0==e.IsOnTouch)&&(t=!0)}t&&(this.Canvas.save(),this.DrawLastDataItem(),this.Canvas.restore())},this.Draw=function(){if(this.LastShowData=null,this.GlobalOption=this.Frame.GlobalOption,!this.IsShow){var t=this.OnDrawEvent&&this.OnDrawEvent.Callback||this.OnMouseMoveEvent&&this.OnMouseMoveEvent.Callback;if(!t)return}if(this.PointInfo&&(2==this.PointInfo.ClientPos||3==this.PointInfo.ClientPos||this.PointInfo.ClientPos>=200&&this.PointInfo.ClientPos<=299||this.PointInfo.ClientPos>=300&&this.PointInfo.ClientPos<=399))return this.Canvas.save(),this.DrawCallAuction(),void this.Canvas.restore();if(!this.Data||!this.Data.Data||this.Data.Data.length<=0)this.DrawNone();else if(null!=this.CursorIndex||this.GlobalOption&&this.GlobalOption.IsDisplayLatest){this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText("0").width;var e=!1;if(this.DrawStatus&&this.DrawStatus.IsTitleShowLatestData){var a=this.DrawStatus;(!sa.IsNumber(a.FrameID)||a.FrameID<0||a.CorssCursorTouchEnd&&0==a.IsOnTouch)&&(e=!0)}else this.GlobalOption&&this.GlobalOption.IsDisplayLatest&&(e=!0);this.GlobalOption&&this.GlobalOption.LockCorssCursor&&this.GlobalOption.LockCorssCursor.X.Enable&&(e=!1);var i=!1;if(e){var r=null,n=this.GetLatestKLineData(!0);n&&0==n.Type&&(r=n.Data),i=!0}else{var o=this.CursorIndex;o=parseInt(o.toFixed(0));var s=o+this.Data.DataOffset;s>=this.Data.Data.length&&(s=this.Data.Data.length-1);r=this.Data.Data[s];s==this.Data.Data.length-1&&(i=!0)}this.LastShowData=r,this.Canvas.save(),this.OnDrawEventCallback(r),this.IsAlwaysShowLastData?this.DrawLastDataItem():this.DrawItem(r,i),this.Canvas.restore()}else this.DrawNone()},this.DrawCallAuctionItem=function(t,e){if(t){var a=t.Data,i=!0===this.Frame.IsHScreen,r=F(),n=(this.Frame.GetBorder(),this.GetLeft(i)),o=this.GetRight(i),s=this.GetBottom(i),h=!0;if(i){if(this.Frame.ChartBorder.Right<5*r)return;var l=s,u=n;this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),n=s=0}else this.Frame.ChartBorder.Top<5*r&&(h=!1);this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font;var C={Left:n,Bottom:s,MaxRight:o,IsHScreen:i},D=this.FormatCallAuctionTitle(t);if(h&&D&&sa.IsNonEmptyArray(D.AryText))for(var f=0;f<D.AryText.length;++f){a=D.AryText[f];if(!this.DrawText(a.Text,a.Color,C))break}}},this.DrawLastDataItem=function(){var t=this.GetLatestKLineData(!0);t&&(0==t.Type?this.DrawItem(t.Data,!0):1!=t.Type&&2!=t.Type||this.DrawCallAuctionItem(t,!0))}}var Ga={DEFAULT:1,ORIGINAL:2,INTEGER:3,THOUSANDS:21};function _a(t,e,a){this.Data=t,this.Name=e,this.Color=a,this.DataType,this.ChartClassName,this.StringFormat=Ga.DEFAULT,this.FloatPrecision=2,this.IsShow=!0,this.Callback,this.ExtendData}function Va(){this.newMethod=Oa,this.newMethod(),delete this.newMethod,this.ClassName="DynamicChartTitlePainting",this.IsDynamic=!0,this.Data=[],this.Explain,this.ColorIndex,this.IsShowColorIndexTitle=!0,this.IsShowUpDownArrow=!0,this.TitleArrowType=0,this.IsShowIndexName=!0,this.IsShowIndexTitle=!0,this.IsShowNameArrow=!1,this.NameArrowConfig=P(qi.IndexTitle.NameArrow),this.CustomLocation,this.TradeIndex,this.IsShowTradeIndexTitle=!0,this.OverlayIndex=new Map,this.IsShowOverlayIndexName=!0,this.OverlayIndexType={Position:0,LineSpace:5,BGColor:qi.OverlayIndexTitleBGColor},this.LanguageID=ji.LANGUAGE_CHINESE_ID,this.TitleRect,this.IsDrawTitleBG=!1,this.BGColor=qi.IndexTitleBGColor,this.BGBorderColor=qi.IndexTitleBorderColor,this.BGBorderMoveOnColor=qi.IndexTitleBorderMoveOnColor,this.BorderRoundRadius=2,this.NameButtonStyle=qi.IndexTitleBorderStyle,this.OnDrawEvent,this.ParamSpace=2,this.TitleSpace=2,this.TitleColor=qi.IndexTitleColor,this.SelectedColor=qi.IndexTitleSelectedColor,this.IsKLineFrame=!1,this.IsMinuteFrame=!1,this.Identify,this.SelectedChart,this.ArgumentsText,this.MerginLeft=qi.IndexTitleMerginLeft,this.Buttons=[],this.NameButtonHeight=0,this.UpDownArrowConfig={UpColor:qi.IndexTitle.UpDownArrow.UpColor,DownColor:qi.IndexTitle.UpDownArrow.DownColor,UnchangeColor:qi.IndexTitle.UpDownArrow.UnchangeColor},this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchangeColor=qi.UnchagneTextColor,this.VolColor=qi.Title.VolColor,this.AmountColor=qi.Title.AmountColor,this.DateTimeColor=qi.Title.DateTimeColor,this.NameColor=qi.Title.NameColor,this.PositionColor=qi.Title.PositionColor,this.DynamicTitle={OutName:null,OutValue:null},this.OverlayDynamicTitle=new Map,this.IsShowMainIndexTitle=!0,this.MainTitlePaint=null,this.ReloadResource=function(){this.Font=qi.TitleFont,this.TitleColor=qi.DefaultTextColor,this.SelectedColor=qi.IndexTitleSelectedColor,this.OverlayIndexType.BGColor=qi.OverlayIndexTitleBGColor,this.BGColor=qi.IndexTitleBGColor,this.BGBorderColor=qi.IndexTitleBorderColor,this.BGBorderMoveOnColor=qi.IndexTitleBorderMoveOnColor,this.UpColor=qi.UpTextColor,this.DownColor=qi.DownTextColor,this.UnchangeColor=qi.UnchagneTextColor,this.VolColor=qi.Title.VolColor,this.AmountColor=qi.Title.AmountColor,this.DateTimeColor=qi.Title.DateTimeColor,this.PositionColor=qi.Title.PositionColor},this.SetDynamicTitleData=function(t,e,a){a.OutName?a.OutName.clear():a.OutName=new Map,a.OutValue?a.OutValue.clear():a.OutValue=new Map;var i=new Map;for(var r in e){var n=e[r];i.set("{".concat(n.Name,"}"),n)}for(var r in t){n=t[r];if(n.DynamicName){var o=n.DynamicName.match(/{\w*}/i);if(!o||o.length<=0)a.OutName.set(n.Name,n.DynamicName);else{for(var s=n.DynamicName,h=!0,l=0;l<o.length;++l){var u=o[l];if(!i.has(u)){h=!1;break}var C=i.get(u).Value;s=s.replace(u,C.toString())}h&&a.OutName.set(n.Name,s)}}n.DynamicValue&&a.OutValue.set(n.Name,n.DynamicValue)}},this.SetDynamicTitle=function(t,e,a){if(sa.IsString(a)){var i=null;this.OverlayDynamicTitle.has(a)?i=this.OverlayDynamicTitle.get(a):(i={OutName:null,OutValue:null},this.OverlayDynamicTitle.set(a,i)),this.SetDynamicTitleData(t,e,i)}else this.SetDynamicTitleData(t,e,this.DynamicTitle)},this.GetDynamicOutName=function(t,e){if(sa.IsString(e)){if(!this.OverlayDynamicTitle.has(e))return null;var a=this.OverlayDynamicTitle.get(e),i=a.OutName}else i=this.DynamicTitle.OutName;return!i||i.size<=0?null:i.has(t)?i.get(t):null},this.GetDynamicOutValue=function(t,e){var a=this.DynamicTitle.OutValue;if(!a||a.size<=0)return null;if(!a.has(t))return null;var i=a.get(t);return i=i.replace("{Value}",e),i},this.IsClickTitle=function(t,e){return!!this.TitleRect&&(t>this.TitleRect.Left&&t<this.TitleRect.Left+this.TitleRect.Width&&e>this.TitleRect.Top&&e<this.TitleRect.Top+this.TitleRect.Height)},this.FormatValue=function(t,e){return e.StringFormat==Ga.DEFAULT?sa.FormatValueString(t,e.FloatPrecision,this.LanguageID):e.StringFormat==Ga.THOUSANDS?sa.FormatValueThousandsString(t,e.FloatPrecision):e.StringFormat==Ga.ORIGINAL?t.toFixed(e.FloatPrecision).toString():e.StringFormat==Ga.INTEGER?sa.FromatIntegerString(t,e.FloatPrecision,this.LanguageID):void 0},this.FormatMultiReport=function(t,e){if(!sa.IsNonEmptyArray(t))return null;for(var a="",i=0;i<t.length;++i){var r=t[i],n=r.Quarter,o=r.Year,s=r.Value;switch(a.length>0&&(a+=","),a+=o.toString(),n){case 1:a+="一季报 ";break;case 2:a+="半年报 ";break;case 3:a+="三季报 ";break;case 4:a+="年报 ";break}a+=this.FormatValue(s,e)}return a},this.FormatMultiDataLine=function(t,e){if(!t)return null;var a="";if(Array.isArray(t))for(var i=0;i<t.length;++i){var r=t[i];if(0!=r.Type&&sa.IsNumber(r.Value)){var n=this.FormatValue(r.Value,e);a.length>0&&(a+=","),a+=n}}else 0!=t.Type&&sa.IsNumber(t.Value)&&(a=this.FormatValue(t.Value,e));return a.length<=0?null:a},this.FormatStackedBarTitle=function(t,e){if(!sa.IsNonEmptyArray(t))return null;if(!sa.IsNonEmptyArray(e.Color))return null;for(var a=[],i=0;i<t.length;++i){var r=t[i];if(sa.IsNumber(r)){var n={Text:r.toFixed(2)};e.Name&&e.Name[i]&&(n.Name=e.Name[i]),n.Color=e.Color[i],a.push(n)}}return a.length<=0?null:a},this.FormatKLineTitle=function(t,e){if(!t)return null;var a=Jr(e.Symbol),i="";e.Symbol&&(i=e.Symbol.toUpperCase());var r=F(),n=3*r,o=[];if(sa.IsNumber(t.Date)){var s=sa.FormatDateString(t.Date);o.push({Text:s,Color:this.DateTimeColor})}if(sa.IsNumber(t.Open)){var h=this.GetColor(t.Open,t.YClose);s=$i.GetText("KTitle-Open",this.LanguageID)+t.Open.toFixed(a);o.push({Text:s,Color:h,LeftSpace:n})}if(sa.IsNumber(t.High)){h=this.GetColor(t.High,t.YClose),s=$i.GetText("KTitle-High",this.LanguageID)+t.High.toFixed(a);o.push({Text:s,Color:h,LeftSpace:n})}if(sa.IsNumber(t.Low)){h=this.GetColor(t.Low,t.YClose),s=$i.GetText("KTitle-Low",this.LanguageID)+t.Low.toFixed(a);o.push({Text:s,Color:h,LeftSpace:n})}if(sa.IsNumber(t.Close)){h=this.GetColor(t.Close,t.YClose),s=$i.GetText("KTitle-Close",this.LanguageID)+t.Close.toFixed(a);o.push({Text:s,Color:h,LeftSpace:n})}if(t.YFClose>0&&Pr.IsChinaFutures(i)){var l=(t.Close-t.YFClose)/t.YFClose*100;h=this.GetColor(l,0),s=$i.GetText("KTitle-Increase",this.LanguageID)+l.toFixed(2)+"%";o.push({Text:s,Color:h,LeftSpace:n})}else if(t.YClose>0){l=(t.Close-t.YClose)/t.YClose*100,h=this.GetColor(l,0),s=$i.GetText("KTitle-Increase",this.LanguageID)+l.toFixed(2)+"%";o.push({Text:s,Color:h,LeftSpace:n})}if(sa.IsNumber(t.Vol)){var u=Pr.GetVolUnit(i),C=t.Vol/u;s=$i.GetText("KTitle-Vol",this.LanguageID)+sa.FromatIntegerString(C,2,this.LanguageID);o.push({Text:s,Color:this.VolColor,LeftSpace:n})}if(sa.IsNumber(t.Amount)){s=$i.GetText("KTitle-Amount",this.LanguageID)+sa.FormatValueString(t.Amount,2,this.LanguageID);o.push({Text:s,Color:this.AmountColor,LeftSpace:n})}return o},this.FormatIndexTitle=function(t,e){var a=null,i=[];if(e.Name&&(i.push({Text:e.Name,Color:e.Color}),a={Text:null,ArrayText:i}),!t)return a;if(!e.Chart)return a;var r=e.Chart.GetItem(t);if(!r||!r.Data)return a;if(!sa.IsNonEmptyArray(r.Data.AryText))return a;a||(a={Text:null,ArrayText:i});for(var n=0;n<r.Data.AryText.length;++n){var o=r.Data.AryText[n];if(o){var s={Name:null,Text:null};o.Name&&(s.Name=o.Name),o.Text&&(s.Text=o.Text),o.Color&&(s.Color=o.Color),sa.IsNumber(o.LeftSpace)&&(s.LeftSpace=o.LeftSpace),i.push(s)}}return a},this.GetColor=function(t,e){return sa.IsNumber(e)?t>e?this.UpColor:t<e?this.DownColor:this.UnchangeColor:this.UnchangeColor},this.ForamtMultiLineTitle=function(t,e){if(!sa.IsNonEmptyArray(e.Lines))return null;for(var a=[],i=0;i<e.Lines.length;++i)for(var r=e.Lines[i],n=0;n<r.Point.length;++n){var o=r.Point[n];if(o.Index==t){o={Text:o.Value.toFixed(2)};0==a.length&&(o.Name=e.Name),o.Color=r.Color,a.push(o);break}}return sa.IsNonEmptyArray(a)?a:null},this.ForamtMultiPointTitle=function(t,e){if(!e.GetItemCallback)return null;if(!e.Data||!sa.IsNonEmptyArray(e.Data.Data))return null;var a=e.Data.Data[t];if(!a)return null;var i=e.GetItemCallback(a);if(!i||!sa.IsNonEmptyArray(i.Data))return null;for(var r=[],n=0;n<i.Data.length;++n){var o=i.Data[n],s=o.ColorConfig,h=null;s.BGColor?h=s.BGColor:s.Color&&(h=s.Color),s.Name&&r.push({Text:"".concat(s.Name,":"),Color:h});var l=o.Data.Value;sa.IsString(o.Data.Value)&&(l=dt.GetKValue(a,o.Data.Value)),r.push({Text:this.FormatValue(l,e),Color:h})}return sa.IsNonEmptyArray(r)?r:null},this.ForamtMultiBarTitle=function(t,e){if(!e.GetItemCallback)return null;if(!e.Data||!sa.IsNonEmptyArray(e.Data.Data))return null;var a=e.Data.Data[t];if(!a)return null;var i=e.GetItemCallback(a);if(!i||!sa.IsNonEmptyArray(i.Data))return null;for(var r=[],n=0;n<i.Data.length;++n){var o=i.Data[n],s=o.ColorConfig,h=null;s.BGColor?h=s.BGColor:s.Color&&(h=s.Color),s.Name&&r.push({Text:"".concat(s.Name,":"),Color:h});var l=o.Data.Value;sa.IsString(o.Data.Value)&&(l=dt.GetKValue(a,o.Data.Value));var u=o.Data.Value2;sa.IsString(o.Data.Value2)&&(u=dt.GetKValue(a,o.Data.Value2)),r.push({Text:"[".concat(this.FormatValue(l,e),", ").concat(this.FormatValue(u,e),"] "),Color:h})}return sa.IsNonEmptyArray(r)?r:null},this.FormatVPVRTitle=function(t,e){var a=e.Chart,i=[];if(0==a.VolType){var r={Text:" Up/Down ",Color:this.TitleColor};i.push(r)}else{r={Text:" Total ",Color:this.TitleColor};i.push(r)}if(!sa.IsNumber(t.Y))return i;var n=this.Frame.ChartBorder.GetTopEx(),o=this.Frame.ChartBorder.GetBottomEx();if(t.Y<n||t.Y>o)return i;for(var s=this.Frame.GetYData(t.Y),h=null,l=0;l<e.Data.Data.length;++l){r=e.Data.Data[l];if(s>=r.Price-e.Data.PriceOffset/2&&s<r.Price+e.Data.PriceOffset/2){h=r;break}}if(!h)return null;if(0==a.VolType){var u=0;for(l=0;l<h.Vol.length;++l){var C=h.Vol[l];if(sa.IsNumber(C.Value)){r={Text:sa.FormatVolString(C.Value,this.LanguageID)};u+=C.Value,sa.IsNumber(C.ColorID)?r.Color=a.BarColor[C.ColorID]:C.Color&&(r.Color=C.Color),i.push(r)}}r={Text:sa.FormatVolString(u,this.LanguageID),Color:this.TitleColor};i.push(r)}else if(h.TotalVol&&sa.IsNumber(h.TotalVol.Value)){r={Text:sa.FormatVolString(h.TotalVol.Value,this.LanguageID)};sa.IsNumber(h.TotalVol.ColorID)?r.Color=a.BarColor[h.TotalVol.ColorID]:h.TotalVol.Color&&(r.Color=h.TotalVol.Color),i.push(r)}return i},this.IsShowLastData=function(){if(this.HQChart&&this.HQChart.EnableClickModel&&this.HQChart.ClickModel){var t=this.HQChart.ClickModel;if(t.IsShowCorssCursor)return!1}var e=!1;if(this.DrawStatus&&this.DrawStatus.IsTitleShowLatestData){var a=this.DrawStatus;(!sa.IsNumber(a.FrameID)||a.FrameID<0||a.CorssCursorTouchEnd&&0==a.IsOnTouch)&&(e=!0)}else this.GlobalOption&&this.GlobalOption.IsDisplayLatest&&(e=!0);return this.GlobalOption&&this.GlobalOption.LockCorssCursor&&this.GlobalOption.LockCorssCursor.X.Enable&&(e=!1),e},this.OnDrawTitleEvent=function(){var t=this.GetEventCallback(m.ON_INDEXTITLE_DRAW);if(t){var e={Index:null,Data:this.Data,Title:this.Title,Script:this.Script,FrameID:this.Frame.Identify,OverlayIndex:this.OverlayIndex,IsShowTitleOnly:!1};if(this.ArgumentsText&&(e.ArgumentsText=this.ArgumentsText),this.Frame&&this.Frame.ChartBorder&&(e.IsShowTitleOnly=this.Frame.ChartBorder.IsShowTitleOnly),sa.IsNumber(this.CursorIndex)){var a=Math.abs(this.CursorIndex);a=parseInt(a.toFixed(0)),e.Index=a}var i=F(),r=this.Frame.GetBorder();e.Left=r.LeftEx/i,e.Top=r.Top/i,e.Right=r.RightEx/i,t.Callback(t,e,this)}},this.IsSelectedChart=function(t){return!!t&&(!!this.SelectedChart&&(!!this.SelectedChart.Selected&&this.SelectedChart.Selected.Identify==t))},this.Draw=function(t,e){if(this.Buttons=[],this.NameButtonHeight=0,!this.Frame.IsMinSize&&(this.IsKLineFrame=this.Frame.IsKLineFrame(!1),this.IsMinuteFrame=this.Frame.IsMinuteFrame(!1),this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,this.IsShowNameArrow=this.Frame.IsShowNameArrow,this.IsShowUpDownArrow=this.Frame.IsShowTitleArrow,this.TitleArrowType=this.Frame.TitleArrowType,this.IsShowIndexName=this.Frame.IsShowIndexName,this.IsShowOverlayIndexName=this.Frame.IsShowOverlayIndexName,this.OverlayIndexType.Position=this.Frame.OverlayIndexType.Position,this.OverlayIndexType.LineSpace=this.Frame.OverlayIndexType.LineSpace,this.ParamSpace=this.Frame.IndexParamSpace,this.TitleSpace=this.Frame.IndexTitleSpace,this.TitleRect=null,this.GlobalOption=this.Frame.GlobalOption,this.OnDrawTitleEvent(),0!=this.Frame.IsShowIndexTitle&&!0!==qi.IsDOMFrameTitle&&this.Data)){if(this.CustomLocation){if(!this.CustomLocation.IsShow)return;if(!sa.IsNumber(this.CustomLocation.Top)||!sa.IsNumber(this.CustomLocation.TitleHeight))return}else if(this.Frame.ChartBorder.TitleHeight<5)return;if(null!=this.CursorIndex||this.GlobalOption&&this.GlobalOption.IsDisplayLatest){if(!0===this.Frame.IsHScreen)return this.Canvas.save(),this.HScreenDraw(),void this.Canvas.restore();var a=this.Frame.ChartBorder.GetLeft()+this.MerginLeft,i=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2;this.CustomLocation&&(i=this.Frame.ChartBorder.GetTop()+this.CustomLocation.Top+this.CustomLocation.TitleHeight/2);var r=this.Frame.ChartBorder.GetRight(),n={Width:0,YCenter:i};this.DrawToolbar(n,t,e),a+=n.Width,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var o=F();if(this.Title&&this.IsShowIndexName&&this.IsShowMainIndexTitle)if(this.IsDrawTitleBG){var s={Left:a,YCenter:i,Width:0};this.DrawNameButton(s,t,e),this.Buttons.push({ID:S.INDEX_NAME_BUTTON,Rect:s,FrameID:this.Frame.Identify,Type:2}),this.NameButtonHeight=s.Height,this.IsSelectedChart(this.Identify)&&this.DrawSelectedLine(a,i,h),this.TitleRect=s,a+=s.Width+3*o,a+=this.TitleSpace}else{var h=this.Canvas.measureText(this.Title).width+2;this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,a,i,h),this.IsSelectedChart(this.Identify)&&this.DrawSelectedLine(a,i,h),a+=h,a+=this.TitleSpace}if(this.ArgumentsText&&this.IsShowIndexName&&this.IsShowMainIndexTitle){h=this.Canvas.measureText(this.ArgumentsText).width+2;this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.ArgumentsText,a,i,h),a+=h,a+=this.TitleSpace}var l=this.IsShowLastData(),u=this.Frame.GetLockRect();if(u){var C=Math.abs(this.CursorIndex);this.IsKLineFrame&&(C=this.CursorIndex);var D=this.Frame.GetXFromIndex(C.toFixed(0));if(D>=u.Left)return;if(l)return}var f={Left:a,Right:a};if(this.IsMinuteFrame&&this.PointInfo&&(2==this.PointInfo.ClientPos||3==this.PointInfo.ClientPos||this.PointInfo.ClientPos>=200&&this.PointInfo.ClientPos<=299||this.PointInfo.ClientPos>=300&&this.PointInfo.ClientPos<=399)){var c={PreventDefault:!1},m=r;this.Frame.ToolbarCacheSize&&this.Frame.ToolbarCacheSize.RToolbar&&(m=this.Frame.ToolbarCacheSize.RToolbar.Left-2),this.DrawMainCallAuction({Left:a,Right:m,Bottom:i},f,c),!1===c.PreventDefault&&this.DrawMainIndexTitle({Left:a,Right:m,Bottom:i},l,f),sa.IsNumber(f.Bottom)&&(i=f.Bottom)}else{m=r;this.Frame.ToolbarCacheSize&&this.Frame.ToolbarCacheSize.RToolbar&&(m=this.Frame.ToolbarCacheSize.RToolbar.Left-2),this.DrawMainIndexTitle({Left:a,Right:m,Bottom:i},l,f),sa.IsNumber(f.Bottom)&&(i=f.Bottom)}if(a=f.Left,this.Explain){this.Canvas.fillStyle=this.TitleColor;var d="说明:"+this.Explain;h=this.Canvas.measureText(d).width+2;a+h<r&&(this.Canvas.fillText(d,a,i,h),a+=h)}if(this.ColorIndex&&this.IsShowColorIndexTitle){this.Canvas.fillStyle=qi.Title.ColorIndexColor;var I=this.ColorIndex.Name+this.ColorIndex.Param;h=this.Canvas.measureText(I).width+2;this.Canvas.fillText(I,a,i,h),a+=h}if(this.TradeIndex&&this.IsShowTradeIndexTitle){this.Canvas.fillStyle=qi.Title.TradeIndexColor;I=this.TradeIndex.Name+this.TradeIndex.Param,h=this.Canvas.measureText(I).width+2;this.Canvas.fillText(I,a,i,h),a+=h}if(1==this.OverlayIndexType.Position)this.Frame.ChartBorder.IsShowTitleOnly||this.DrawOverlayIndexSingleLine(t,e,i+1);else{var T=10*F();this.IsShowMainIndexTitle||(T=0),this.DrawOverlayIndex(a+T)}}}},this.GetTitleItem=function(t,e,a){if(!t||!t.Data||!t.Data.Data)return null;if(Array.isArray(t.Data.Data)&&t.Data.Data.length<=0)return null;if(!1===t.IsShow)return null;if(!1===t.IsVisible)return null;var i=null,r=null,n=null,o=null;if("StraightLine"==t.DataType)n=t.Data.Data[0],i=this.FormatValue(n,t);else{if("ChartVolProfileVisibleRange"==t.ChartClassName)return r=this.FormatVPVRTitle(this.LastPoint,t),r?{Text:null,ArrayText:r}:null;if(e)var s=t.Data.Data.length-1;else{var h=Math.abs(this.CursorIndex);h=parseInt(h.toFixed(0)),this.IsKLineFrame&&(h=this.CursorIndex);s=t.Data.DataOffset+h;if(s>=t.Data.Data.length&&(s=t.Data.Data.length-1),s<0)return null}n=null;if(s>=0&&t.Data&&sa.IsNonEmptyArray(t.Data.Data)&&(n=t.Data.Data[s]),this.GetEventCallback){var l=this.GetEventCallback(m.ON_FORMAT_INDEX_OUT_TEXT);if(l){var u={Item:t,Index:a,Data:this.Data,FrameID:this.Frame.Identify,DataIndex:s,Value:n,PreventDefault:!1,Out:null};if(l.Callback(l,u,this),u.Out)return u.Out;if(u.PreventDefault)return u.Out}}if("ChartMultiLine"==t.DataType)return r=this.ForamtMultiLineTitle(s,t),r?{Text:null,ArrayText:r}:null;if("ChartMultiPoint"==t.DataType)return r=this.ForamtMultiPointTitle(s,t),r?{Text:null,ArrayText:r}:null;if("ChartMultiBar"==t.DataType)return r=this.ForamtMultiBarTitle(s,t),r?{Text:null,ArrayText:r}:null;if("MultiReport"==t.DataType){if(i=this.FormatMultiReport(n,t),!i)return null}else if("MULTI_POINT_LINE"==t.DataType){if(i=this.FormatMultiDataLine(n,t),!i)return null}else{if("ChartStackedBar"==t.DataType)return r=this.FormatStackedBarTitle(n,t),r?{Text:null,ArrayText:r}:null;if("DRAWKLINE"==t.DataType)return r=this.FormatKLineTitle(n,t),r?{Text:null,ArrayText:r}:null;if("ChartIndexTitle"==t.DataType){var C=this.FormatIndexTitle(n,t);return C}if("ChartBand"==t.DataType)return null;if(vn.Has(t.DataType)){var D=vn.Get(t.DataType);if(D&&D.FormatTitleCallback)return D.FormatTitleCallback(n,t,s)}else{if(null==n&&"ChartStepLine"==t.ChartClassName){if(o=this.GetPreVaildItem(t.Data.Data,s),!o)return null;if(preText=this.FormatValue(o.Item,t),t.Name){var f=this.GetDynamicOutValue(t.Name,preText);f&&(preText=f)}return i="--(".concat(preText,")"),{Text:i,ArrayText:r}}if(null==n)return null;var c=null;if(this.IsShowUpDownArrow){var d=null;s-1>=0&&(d=t.Data.Data[s-1]),sa.IsNumber(d)&&(c=d>n?{Text:"↓",TextColor:this.UpDownArrowConfig.DownColor}:d<n?{Text:"↑",TextColor:this.UpDownArrowConfig.UpColor}:{Text:"→",TextColor:this.UpDownArrowConfig.UnchangeColor},1==this.TitleArrowType&&(c.TextColor=t.Color))}if(i=this.FormatValue(n,t),t.Name){f=this.GetDynamicOutValue(t.Name,i);f&&(i=f)}if(c){var I={Name:null,Text:i,Color:t.Color,TextEx:[c]};if(t.Name){var S=t.Name,T=this.GetDynamicOutName(t.Name);T&&(S=T),I.Name=S}r=[I],i=null}}}}return{Text:i,ArrayText:r}},this.DrawMainIndexTitle=function(t,e,a){if(this.IsShowMainIndexTitle){var i=t.Left,r=this.Frame.ChartBorder.GetLeft()+this.MerginLeft+5,n=t.Right,o=t.Bottom,s=F(),h=this.Canvas.measureText("擎").width+2;h<this.NameButtonHeight&&(h=this.NameButtonHeight);for(var l=0;l<this.Data.length;++l){var u=this.Data[l],C=this.GetTitleItem(u,e,l);if(C){var D=C.Text,f=C.ArrayText;if(f)for(var c=0;c<f.length;++c){var m=f[c];L=m.Name?m.Name+":"+m.Text:m.Text,sa.IsNumber(m.LeftSpace)&&(i+=m.LeftSpace*s);var d=this.ParamSpace*s,I=this.Canvas.measureText(L).width,S=I;if(sa.IsNonEmptyArray(m.TextEx))for(var T=i,v=0;v<m.TextEx.length;++v){var p=m.TextEx[v],g=this.Canvas.measureText(p.Text).width+2;p.Width=g,p.Left=T,S+=g,T+=g}if(i+S+d>n&&(i=r,o+=h,n=this.Frame.ChartBorder.GetRight()),m.BG){var x=this.Canvas.measureText("擎").width+2,E={Left:i,Top:o-x/2,Width:S,Height:x};if(this.Canvas.fillStyle=m.BG,this.Canvas.fillRect(E.Left,E.Top-1,E.Width,E.Height),this.Canvas.fillStyle=m.Color,this.Canvas.fillText(L,E.Left+1,o,I),i+=I,sa.IsNonEmptyArray(m.TextEx))for(v=0;v<m.TextEx.length;++v){p=m.TextEx[v];this.Canvas.fillStyle=p.TextColor,this.Canvas.fillText(p.Text,i,o,p.Width),i+=p.Width}i+=d}else{if(this.Canvas.fillStyle=m.Color,this.Canvas.fillText(L,i,o,I),i+=I,sa.IsNonEmptyArray(m.TextEx))for(v=0;v<m.TextEx.length;++v){p=m.TextEx[v];this.Canvas.fillStyle=p.TextColor,this.Canvas.fillText(p.Text,i,o,p.Width),i+=p.Width}i+=d}}else{this.Canvas.fillStyle=u.Color;var L=D;if(u.Name){var M=this.GetDynamicOutName(u.Name);L=M?M+":"+D:u.Name+":"+D}d=this.ParamSpace*s,S=this.Canvas.measureText(L).width+d;i+S>n&&(i=r,o+=h,n=this.Frame.ChartBorder.GetRight()),this.Canvas.fillText(L,i,o,S),i+=S}}}a.Left=i,a.Bottom=o}},this.DrawMainCallAuction=function(t,e,a){if(this.IsShowMainIndexTitle&&this.MainTitlePaint){var i=this.MainTitlePaint.GetCurrentAuctionData();if(i&&i.Data&&this.GetEventCallback){var r=this.GetEventCallback(m.ON_FORMAT_CALL_AUCTION_INDEX_TITLE);if(r){var n={AuctionData:i,Data:this.Data,FrameID:this.Frame.Identify,Out:null,PreventDefault:!1};if(r.Callback(r,n,this),a.PreventDefault=n.PreventDefault,sa.IsNonEmptyArray(n.Out)){for(var o=t.Left,s=t.Right,h=t.Bottom,l=F(),u=n.Out,C=0;C<u.length;++C){var D=u[C];if(D.Text){var f=this.Canvas.measureText(D.Text).width+2;if(o+f>s)break;if(D.BGColor){var c=this.Canvas.measureText("擎").width+2,d={Left:o,Top:h-c/2,Width:f,Height:c};this.Canvas.fillStyle=D.BGColor,this.Canvas.fillRect(d.Left,d.Top-1,d.Width,d.Height),o+=1}this.Canvas.fillStyle=D.Color,this.Canvas.fillText(D.Text,o,h,f),o+=f,sa.IsPlusNumber(D.Space)&&(o+=D.Space*l)}}e.Left=o}}}}},this.GetCallAuctionTitleItem=function(t,e,a){if(!1===t.IsShow)return null;if(!1===t.IsVisible)return null;if(!t||!t.Data||!t.Data.Data)return null;if(vn.Has(t.DataType)){var i=vn.Get(t.DataType);if(i&&i.FormatTitleCallback)return i.FormatTitleCallback(value,t,dataIndex)}},this.GetPreVaildItem=function(t,e){for(var a=e;a>=0;--a){var i=t[a];if(i)return{Item:i,Index:a}}return null},this.DrawSelectedLine=function(t,e,a){this.Canvas.save();var i=this.GetFontHeight();this.Canvas.strokeStyle=this.SelectedColor;var r=O(4,e+i/2);this.Canvas.lineWidth=4,this.Canvas.beginPath(),this.Canvas.moveTo(t,r),this.Canvas.lineTo(t+a,r),this.Canvas.stroke(),this.Canvas.restore()},this.FormatOverlayTitle=function(t,e,a){if(!t||!t.Data||!t.Data.Data||!t.Name)return null;if(!1===t.IsVisible)return null;if(t.Data.Data.length<=0)return null;var i=null,r=null,n=null;if("StraightLine"==t.DataType)i=t.Data.Data[0],r=this.FormatValue(i,t);else{var o=Math.abs(this.CursorIndex-.5);o=parseInt(o.toFixed(0)),this.IsKLineFrame&&(o=this.CursorIndex);var s=t.Data.DataOffset+o;if(s>=t.Data.Data.length&&(s=t.Data.Data.length-1),s<0)return null;if(i=t.Data.Data[s],null==i)return null;if(this.GetEventCallback){var h=this.GetEventCallback(m.ON_FORMAT_OVERLAY_INDEX_OUT_TEXT);if(h){var l={Item:t,Index:a,Data:e,FrameID:this.Frame.Identify,DataIndex:s,Value:i,PreventDefault:!1,Out:null};if(h.Callback(h,l,this),l.Out)return l.Out;if(l.PreventDefault)return l.Out}}if("MultiReport"==t.DataType){if(r=this.FormatMultiReport(i,t),!r)return null}else if("ChartStackedBar"==t.DataType){if(n=this.FormatStackedBarTitle(i,t),!n)return null}else if("ChartMultiLine"==t.DataType){if(n=this.ForamtMultiLineTitle(s,t),!n)return null}else if("ChartMultiPoint"==t.DataType){if(n=this.ForamtMultiPointTitle(s,t),!n)return null}else if("ChartMultiBar"==t.DataType){if(n=this.ForamtMultiBarTitle(s,t),!n)return null}else if("DRAWKLINE"==t.DataType){if(n=this.FormatKLineTitle(i,t),!n)return null}else if("ChartIndexTitle"==t.DataType){var u=this.FormatIndexTitle(i,t);if(!u)return null;r=u.Text,n=u.ArrayText}else if("MULTI_POINT_LINE"==t.DataType){if(r=this.FormatMultiDataLine(i,t),!r)return null}else r=this.FormatValue(i,t)}return{Text:r,ArrayText:n}},this.DrawOverlayIndexSingleLine=function(t,e,a){var i=F(),r=this.Frame.GetBorder(),n=E(this.Canvas,this.Font,"擎");if(!0===this.Frame.IsHScreen)var o=1,s=2*i,h=this.Frame.ChartBorder.GetHeight(),u=this.Frame.ChartBorder.GetWidthEx();else{s=r.TopTitle+2*i;sa.IsNumber(a)&&a>s&&(s=a+n/2+2*i),this.IsShowMainIndexTitle||(s=this.Frame.ChartBorder.GetTop()+2*i);o=this.Frame.ChartBorder.GetLeft()+this.MerginLeft,h=r.Right,u=r.Bottom}var C=this.OverlayIndexType.LineSpace*i,D=o,f=s;f=s+n/2;var c,m=(0,l.default)(this.OverlayIndex);try{for(m.s();!(c=m.n()).done;){g=c.value;var d=g[1],I=g[0],S={Width:0,YCenter:f,ID:I};if(this.DrawOverlayToolbar(d,S,t,e),d.IsShowIndexTitle&&d.Frame.IsShowIndexTitle){if(D=o+S.Width,this.Canvas.font=this.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",d.Title&&this.IsShowOverlayIndexName){var T=this.Canvas.measureText(d.Title).width+2;if(D+T<h){if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;var v={Left:D,Top:f-n/2,Width:T,Height:n+C};this.Canvas.fillRect(v.Left,v.Top,v.Width,v.Height)}this.IsSelectedChart(I)&&this.DrawSelectedLine(D,f,T,d.Title),this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(d.Title,D,f,T)}D+=T}for(var p=0;p<d.Data.length;++p){var g=d.Data[p],x=this.FormatOverlayTitle(g,d,p);if(x){var L=x.Text,M=x.ArrayText;if(M)for(var y=0;y<M.length;++y){var R=M[y];N=R.Name?R.Name+":"+R.Text:R.Text;T=this.Canvas.measureText(N).width+2;if(D+T>h)break;if(sa.IsNumber(R.LeftSpace)&&(D+=R.LeftSpace*i),this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;v={Left:D,Top:f-n/2,Width:T,Height:n+C};this.Canvas.fillRect(v.Left,v.Top,v.Width,v.Height)}this.Canvas.fillStyle=R.Color,this.Canvas.fillText(N,D,f,T),D+=T}else{var N=L;if(g.Name){var w=this.GetDynamicOutName(g.Name,I);N=w?w+":"+L:g.Name+":"+L}T=this.Canvas.measureText(N).width+2;if(D+T>h)break;if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;v={Left:D,Top:f-n/2,Width:T,Height:n+C};this.Canvas.fillRect(v.Left,v.Top,v.Width,v.Height)}this.Canvas.fillStyle=g.Color,this.Canvas.fillText(N,D,f,T),D+=T}}}if(f+=n+C,f+n+C>=u)break}}}catch(A){m.e(A)}finally{m.f()}},this.DrawOverlayIndex=function(t){var e=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetRight();if(!0===this.Frame.IsHScreen&&(e=-this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetHeight()),!(t>a)){var i,r=5*F(),n=t,o=0,s=(0,l.default)(this.OverlayIndex);try{for(s.s();!(i=s.n()).done;){f=i.value,o>0&&(t+=r);var h=f[1],u=f[0];if(h.Title&&this.IsShowOverlayIndexName){this.Canvas.fillStyle=this.TitleColor;var C=this.Canvas.measureText(h.Title).width+2;if(n=t,t+=C,t>a)break;this.Canvas.fillText(h.Title,n,e,C),this.IsSelectedChart(u)&&this.DrawSelectedLine(n,e,C)}for(var D in h.Data){var f=h.Data[D];if(f&&f.Data&&f.Data.Data&&f.Name&&!(f.Data.Data.length<=0)){var c=null,m=null;if("StraightLine"==f.DataType)c=f.Data.Data[0],m=this.FormatValue(c,f);else{var d=Math.abs(this.CursorIndex-.5);d=parseInt(d.toFixed(0)),this.IsKLineFrame&&(d=this.CursorIndex);var I=f.Data.DataOffset+d;if(I>=f.Data.Data.length&&(I=f.Data.Data.length-1),I<0)continue;if(c=f.Data.Data[I],null==c)continue;"HistoryData-Vol"==f.DataType?(c=c.Vol,m=this.FormatValue(c,f)):m="MultiReport"==f.DataType?this.FormatMultiReport(c,f):this.FormatValue(c,f)}this.Canvas.fillStyle=f.Color;var S=f.Name+":"+m;C=this.Canvas.measureText(S).width+2;if(n=t,t+=C,t>a)break;this.Canvas.fillText(S,n,e,C)}}if(t>a)break;++o}}catch(T){s.e(T)}finally{s.f()}}},this.HScreenDraw=function(){var t=this.Frame.ChartBorder.GetHScreenBorder(),e=this.Frame.ChartBorder.GetRightTitle(),a=t.TopEx;this.Canvas.translate(e,a),this.Canvas.rotate(90*Math.PI/180);var i=1,r=-this.Frame.ChartBorder.TitleHeight/2,n=this.Frame.ChartBorder.GetHeight();this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var o=F();if(this.Title&&this.IsShowIndexName){var s=this.Canvas.measureText(this.Title).width+2;if(this.IsDrawTitleBG){var h=this.Title,l=(s=this.Canvas.measureText(h).width,0);this.IsShowNameArrow&&this.NameArrowConfig&&(l=this.Canvas.measureText(this.NameArrowConfig.Symbol).width,sa.IsNumber(this.NameArrowConfig.Space)&&(l+=this.NameArrowConfig.Space));var u=this.Canvas.measureText("擎").width+4*o,C=s+l+4*o;this.TitleRect={Top:t.Top,Left:this.Frame.ChartBorder.GetRightTitle()+this.Frame.ChartBorder.TitleHeight/2-u/2,Width:u,Height:C},this.Canvas.fillStyle=this.BGColor;var D={Left:i,Top:r-u/2,Width:C,Height:u};this.Canvas.fillRect(D.Left,D.Top,D.Width,D.Height),this.BGBorderColor&&(this.Canvas.strokeStyle=this.BGBorderColor,this.Canvas.strokeRect(A(D.Left),A(D.Top),b(D.Width),b(D.Height)));e=i+2*o;this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(h,e,r),e+=s,this.IsShowNameArrow&&this.NameArrowConfig&&(sa.IsNumber(this.NameArrowConfig.Space)&&(e+=this.NameArrowConfig.Space),this.Canvas.fillStyle=this.NameArrowConfig.Color,this.Canvas.fillText(this.NameArrowConfig.Symbol,e,r)),i+=C+2*o,i+=this.TitleSpace}else this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,i,r),i+=s,i+=this.TitleSpace}if(this.ArgumentsText&&this.IsShowIndexName){s=this.Canvas.measureText(this.ArgumentsText).width+2;this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.ArgumentsText,i,r,s),i+=s,i+=this.TitleSpace}var f=this.IsShowLastData(),c=this.Frame.GetLockRect();if(c){var m=Math.abs(this.CursorIndex-.5);this.IsKLineFrame&&(m=this.CursorIndex);var d=this.Frame.GetXFromIndex(m.toFixed(0));if(d>=c.Top)return;if(f)return}for(var I in this.Data){var S=this.Data[I],T=this.GetTitleItem(S,f);if(T){var v=T.Text,p=T.ArrayText;if(p)for(var g=0;g<p.length;++g){var x=p[g];L=x.Name?x.Name+":"+x.Text:x.Text;var E=this.ParamSpace*F();s=this.Canvas.measureText(L).width+E;if(i+s>n)break;this.Canvas.fillStyle=x.Color,this.Canvas.fillText(L,i,r,s),i+=s}else{this.Canvas.fillStyle=S.Color;var L=v;if(S.Name){var M=this.GetDynamicOutName(S.Name);L=M?M+":"+v:S.Name+":"+v}E=this.ParamSpace*F(),s=this.Canvas.measureText(L).width+E;if(i+s>n)break;this.Canvas.fillText(L,i,r,s),i+=s}}}if(this.Explain){this.Canvas.fillStyle=this.TitleColor;L="说明:"+this.Explain,s=this.Canvas.measureText(L).width+2;i+s<n&&(this.Canvas.fillText(L,i,r,s),i+=s)}1==this.OverlayIndexType.Position?this.Frame.ChartBorder.IsShowTitleOnly||this.DrawOverlayIndexSingleLine():this.DrawOverlayIndex(i+5*F())},this.OnDrawEventCallback=function(t){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var e={Draw:t,Name:"DynamicChartTitlePainting"};this.OnDrawEvent.Callback(this.OnDrawEvent,e,this)}},this.GetFontHeight=function(t){return E(this.Canvas,t,"擎")},this.DrawNameButton=function(t,e,a){var i=F(),r=this.Title,n=this.Canvas.measureText(r).width,o=0;this.IsShowNameArrow&&this.NameArrowConfig&&(o=this.Canvas.measureText(this.NameArrowConfig.Symbol).width,sa.IsNumber(this.NameArrowConfig.Space)&&(o+=this.NameArrowConfig.Space));var s=this.Canvas.measureText("擎").width+4*i,h=this.BorderRoundRadius*i,l=n+o+4*i+2*h;t.Top=t.YCenter-s/2-1,t.Width=l,t.Height=s,t.Right=t.Left+t.Width,t.Bottom=t.Top+t.Height;var u=this.BGBorderColor;if(e&&e.X>=t.Left&&e.X<t.Right&&e.Y>=t.Top&&e.Y<=t.Bottom&&(this.BGBorderMoveOnColor&&(u=this.BGBorderMoveOnColor),a)){var C={ID:S.INDEX_NAME_BUTTON};a.MouseOnToolbar={ID:"IndexNameButton",Rect:t,Item:C,Frame:this.Frame,Point:{X:e.X,Y:e.Y}}}this.Canvas.roundRect&&1==this.NameButtonStyle?(this.Canvas.beginPath(),this.Canvas.roundRect(A(t.Left),A(t.Top),b(t.Width),b(t.Height),[h]),this.Canvas.closePath(),this.Canvas.fillStyle=this.BGColor,this.Canvas.fill(),u&&(this.Canvas.strokeStyle=u,this.Canvas.stroke())):(this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(t.Left,t.Top,t.Width,t.Height),u&&(this.Canvas.strokeStyle=u,this.Canvas.strokeRect(A(t.Left),A(t.Top),b(t.Width),b(t.Height),[h])));var D=t.Left+h+2*i;this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(r,D,t.YCenter),D+=n,this.IsShowNameArrow&&this.NameArrowConfig&&(sa.IsNumber(this.NameArrowConfig.Space)&&(D+=this.NameArrowConfig.Space),this.Canvas.fillStyle=this.NameArrowConfig.Color,this.Canvas.fillText(this.NameArrowConfig.Symbol,D,t.YCenter))},this.DrawButton=function(t,e,a,i){var r=t.Style.Size;sa.IsNumber(t.Style.YMoveOffset)&&(e.YCenter+=t.Style.YMoveOffset);var n="".concat(r,"px ").concat(t.Style.Family);e.Top=e.YCenter-r/2,e.Width=r+t.Style.MerginLeft,e.Height=r,e.Bottom=e.Top+e.Height,e.Right=e.Left+e.Width;var o=t.Style.Color;return a&&a.X>=e.Left&&a.X<e.Right&&a.Y>=e.Top&&a.Y<=e.Bottom&&(o=t.Style.MoveOnColor,i&&(i.MouseOnToolbar={ID:"TitleButton",Rect:e,Item:t,Frame:this.Frame,Point:{X:a.X,Y:a.Y}})),this.Canvas.fillStyle=o,this.Canvas.font=n,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(t.Style.Text,e.Left,e.YCenter),!0},this.DrawToolbar=function(t,e,a){if(t.Width=0,this.Frame&&this.Frame.GetLeftToolbar){var i=this.Frame.GetLeftToolbar();if(sa.IsNonEmptyArray(i))if(!0===this.Frame.IsHScreen);else{for(var r=this.Frame.GetBorder(),n=(r.Right,r.Left+3),o=t.YCenter,s=0;s<i.length;++s){var h=i[s],l={Left:n,YCenter:o};this.DrawButton(h,l,e,a),this.Buttons.push({ID:h.ID,Rect:l,FrameID:this.Frame.Identify,Type:0,Data:h.Data}),n=l.Right,t.Width+=l.Width}t.Width>0&&(t.Width+=3)}}},this.DrawOverlayToolbar=function(t,e,a,i){if(e.Width=0,t&&t.Frame&&t.Frame.GetLeftToolbar){var r=t.Frame,n=r.GetLeftToolbar({Overlay:t,OverlayID:e.ID});if(sa.IsNonEmptyArray(n))if(!0===this.Frame.IsHScreen);else{for(var o=r.GetBorder(),s=(o.Right,o.Left+3),h=e.YCenter,l=0;l<n.length;++l){var u=n[l],C={Left:s,YCenter:h};this.DrawButton(u,C,a,i),this.Buttons.push({ID:u.ID,Rect:C,FrameID:this.Frame.Identify,Type:1,OverlayID:e.ID,Title:t.Title,Data:u.Data}),s=C.Right,e.Width+=C.Width}e.Width>0&&(e.Width+=3)}}},this.PtInButtons=function(t,e){for(var a=0;a<this.Buttons.length;++a){var i=this.Buttons[a];if(i.Rect){var r=i.Rect;if(t>r.Left&&t<r.Right&&e>r.Top&&e<r.Bottom){var n={ID:i.ID,Rect:r,FrameID:i.FrameID,Type:i.Type,Data:i.Data};return 1==i.Type&&(n.Title=i.Title,n.OverlayID=i.OverlayID),n}}}return null}}function Ha(){this.Frame,this.Canvas,this.Point=new Array,this.Value=new Array,this.LinePoint=[],this.PointCount=2,this.Status=0,this.PointStatus=0,this.MovePointIndex=null,this.ClassName="IChartDrawPicture",this.FinishedCallback,this.Guid=N(),this.Symbol,this.Period,this.Right,this.IsSelected=!1,this.Option,this.EnableMove=!0,this.EnableSave=!0,this.EnableCtrlMove=!1,this.OnlyMoveXIndex=!1,this.IsSupportMagnet=!1,this.EnableMoveCheck=!0,this.IsDrawFirst=!1,this.IsShowYCoordinate=!1,this.IsShow=!0,this.LineColor=qi.DrawPicture.LineColor[0],this.LineWidth=2,this.BackupLineWidth=null,this.AreaColor="rgba(25,25,25,0.4)",this.PointColor=qi.DrawPicture.PointColor[0],this.MoveOnPointColor=qi.DrawPicture.PointColor[1],this.PointBGColor=qi.DrawPicture.PointColor[2],this.PointRadius=5,this.SquareSize=8,this.PointType=qi.DrawPicture.PointType,this.IsShowPoint=qi.DrawPicture.IsShowPoint,this.LimitFrameID,this.SetLastPoint=null,this.Update=null,this.GetActiveDrawPicture=null,this.GetYCoordinatePoint=null,this.Draw=function(){},this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.LineWidth>0&&(this.LineWidth=t.LineWidth),t.AreaColor&&(this.AreaColor=t.AreaColor),t.PointColor&&(this.PointColor=t.PointColor),t.MoveOnPointColor&&(this.MoveOnPointColor=t.MoveOnPointColor),t.PointRadius&&(this.PointRadius=t.PointRadius),sa.IsNumber(t.SquareSize)&&(this.SquareSize=t.SquareSize),sa.IsBool(t.IsShowPoint)&&(this.IsShowPoint=t.IsShowPoint),sa.IsNumber(t.LimitFrameID)&&(this.LimitFrameID=t.LimitFrameID),sa.IsBool(t.EnableCtrlMove)&&(this.EnableCtrlMove=t.EnableCtrlMove),sa.IsBool(t.IsShowYCoordinate)&&(this.IsShowYCoordinate=t.IsShowYCoordinate))},this.ReloadResource=function(t){t||(this.PointColor=qi.DrawPicture.PointColor[0],this.MoveOnPointColor=qi.DrawPicture.PointColor[1],this.PointBGColor=qi.DrawPicture.PointColor[2])},this.SetLineWidth=function(){this.BackupLineWidth=null,this.LineWidth>0&&(this.BackupLineWidth=this.Canvas.lineWidth,this.Canvas.lineWidth=this.LineWidth*F())},this.GetFontHeight=function(t){return E(this.Canvas,t,"擎")},this.RestoreLineWidth=function(){null!=this.BackupLineWidth&&(this.Canvas.lineWidth=this.BackupLineWidth)},this.PointMagnetKLine=function(){if(!this.IsSupportMagnet)return!1;if(!this.Frame)return!1;if("MinuteFrame"==this.Frame.ClassName||"MinuteHScreenFrame"==this.Frame.Class)return!1;if(0!=this.Frame.Identify)return!1;var t=-1;if(2==this.Status?t=1:1==this.Status?t=0:sa.IsNumber(this.MovePointIndex)&&(t=this.MovePointIndex),t<0)return!1;if(this.Option&&this.Option.Magnet&&this.Option.Magnet.Enable){var e={IsFixedX:!1,Magnet:{Enable:!0,PointIndex:t,Distance:this.Option.Magnet.Distance,Type:this.Option.Magnet.Type}};return this.AdjustPoint(this.Point,e)}return!1},this.PointToValue=function(){return!!this.Frame&&("MinuteFrame"==this.Frame.ClassName||"MinuteHScreenFrame"==this.Frame.Class?this.PointToValue_Minute():this.PointToValue_KLine())},this.PointToKLine=function(t){if(!this.Frame)return null;var e=this.Frame.Data;if(!e)return null;var a=[],i=this.Frame.IsHScreen;if(i)for(var r in t){var n=t[r],o=parseInt(this.Frame.GetXData(n.Y))+e.DataOffset,s=this.Frame.GetYData(n.X),h={XValue:o,YValue:s},l=e.Data[o];h.DateTime={Date:l.Date},sa.IsNumber(l.Time)&&(h.DateTime.Time=l.Time),a[r]=h}else for(var r in t){n=t[r];var u=parseInt(this.Frame.GetXData(n.X,!1));o=u+e.DataOffset;o<0?o=0:o>=e.Data.length&&(o=e.Data.length-1,u=o-e.DataOffset);s=this.Frame.GetYData(n.Y,!1),h={XValue:o,YValue:s,XIndex:u},l=e.Data[o];h.DateTime={Date:l.Date},sa.IsNumber(l.Time)&&(h.DateTime.Time=l.Time),a[r]=h}return a},this.PointToValue_KLine=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=this.Frame.IsHScreen;if(e)for(var a=0;a<this.Point.length;++a){var i=this.Point[a],r=parseInt(this.Frame.GetXData(i.Y,!1))+t.DataOffset,n=this.Frame.GetYData(i.X,!1),o={XValue:r,YValue:n},s=t.Data[r];o.DateTime={Date:s.Date},sa.IsNumber(s.Time)&&(o.DateTime.Time=s.Time),this.Value[a]=o}else for(a=0;a<this.Point.length;++a){i=this.Point[a],r=parseInt(this.Frame.GetXData(i.X,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);n=this.Frame.GetYData(i.Y,!1),o={XValue:r,YValue:n},s=t.Data[r];o.DateTime={Date:s.Date},sa.IsNumber(s.Time)&&(o.DateTime.Time=s.Time),this.Value[a]=o}return!0},this.PointToValue_Minute=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=this.Frame.IsHScreen;if(e)for(var a=0;a<this.Point.length;++a){var i=this.Point[a],r=parseInt(this.Frame.GetXData(i.Y,!1)),n=this.Frame.GetYData(i.X,!1),o={XValue:r,YValue:n},s=t.Data[r];o.DateTime={Date:s.Date,Time:s.Time},this.Value[a]=o}else{var h=_r.GetTimeData(this.Symbol);for(a=0;a<this.Point.length;++a){i=this.Point[a],r=parseInt(this.Frame.GetXData(i.X,!1)),n=this.Frame.GetYData(i.Y,!1);if(r>=t.Data.length){var l=r%h.length,u=t.Data.length-1,C=(o={XValue:r,YValue:n},s=t.Data[u],h[l]);o.DateTime={Date:s.Date,Time:C},this.Value[a]=o}else{o={XValue:r,YValue:n},s=t.Data[r];o.DateTime={Date:s.Date,Time:s.Time},this.Value[a]=o}}}return!0},this.IsPointIn=function(t,e,a){return!1},this.ValueToPoint=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=this.Frame.IsHScreen;this.Point=[];for(var a=0;a<this.Value.length;++a){var i=this.Value[a],r=new V;e?(r.Y=this.Frame.GetXFromIndex(i.XValue-t.DataOffset,!1),r.X=this.Frame.GetYFromData(i.YValue,!1)):(r.X=this.Frame.GetXFromIndex(i.XValue-t.DataOffset,!1),r.Y=this.Frame.GetYFromData(i.YValue,!1)),this.Point[a]=r}},this.UpdateXValue=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;for(var e=[],a=0;a<this.Value.length;++a){var i=this.Value[a];if(!i.DateTime)break;var r={Date:i.DateTime.Date};sa.IsNumber(i.DateTime.Time)&&(r.Time=i.DateTime.Time),e[a]=r}t.FindDataIndexByDateTime(e);for(a=0;a<e.length;++a){var n=e[a],o=this.Value[a];n.Index>=0&&(o.XValue=n.Index)}},this.ResetXValue=function(){for(var t=0;t<this.Value.length;++t){var e=this.Value[t];e.XValue=null}return!0},this.Move=function(t,e){if(20!=this.Status)return!1;if(!this.Frame)return!1;var a=this.Frame.Data;if(!a)return!1;if(null==this.MovePointIndex)return!1;var i=parseInt(this.MovePointIndex);if(100===i){if(this.IsMoveOutOfBounds(this.Point,t,e))return!1;for(var r in this.Point)this.Point[r].X+=t,this.Point[r].Y+=e}else{if(0!==i&&1!==i&&2!==i&&3!==i&&4!==i&&5!==i)return!1;i<this.Point.length&&(this.Point[i].X+=t,this.Point[i].Y+=e)}},this.IsMoveOutOfBounds=function(t,e,a){if(!this.EnableMoveCheck)return!1;if(!this.Frame)return!1;if("MinuteFrame"==this.Frame.ClassName||"MinuteHScreenFrame"==this.Frame.Class)return!1;var i=this.Frame.Data;if(!i)return!1;if(!sa.IsNonEmptyArray(i.Data))return!1;if(!sa.IsNonEmptyArray(t))return!1;var r=this.Frame.IsHScreen;if(r)return!1;var n=i.DataOffset,o=0-n,s=i.Data.length-n;if(e>0)for(var h=this.Frame.GetXFromIndex(s-1,!1),l=0;l<t.length;++l){var u=t[l];if(u.X+e>h)return!0}else if(e<0){var C=this.Frame.GetXFromIndex(o,!1);for(l=0;l<t.length;++l){u=t[l];if(u.X+e<C)return!0}}return!1},this.ClipFrame=function(){if(this.Frame.IsHScreen)var t=this.Frame.ChartBorder.GetLeftEx(),e=this.Frame.ChartBorder.GetTop(),a=this.Frame.ChartBorder.GetWidthEx(),i=this.Frame.ChartBorder.GetHeight();else t=this.Frame.ChartBorder.GetLeft(),e=this.Frame.ChartBorder.GetTopEx(),a=this.Frame.ChartBorder.GetWidth(),i=this.Frame.ChartBorder.GetHeightEx();this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(t,e,a,i),this.Canvas.clip()},this.CalculateDrawPoint=function(t){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var e=[];if(10==this.Status){var a=this.Frame.Data;if(!a)return null;for(var i=this.Frame.XPointCount,r=0,n=this.Frame.IsHScreen,o=0;o<this.Value.length;++o){var s=this.Value[o];if(!sa.IsNumber(s.XValue))return null;var h=s.XValue-a.DataOffset;(h<0||h>=i)&&++r;var l=new V;n?(l.Y=this.Frame.GetXFromIndex(s.XValue-a.DataOffset,!1),l.X=this.Frame.GetYFromData(s.YValue,!1)):(l.X=this.Frame.GetXFromIndex(s.XValue-a.DataOffset,!1),l.Y=this.Frame.GetYFromData(s.YValue,!1)),e.push(l)}if(t&&!0===t.IsCheckX&&r==this.Value.length)return null}else{for(o=0;o<this.Point.length;++o){s=this.Point[o];e.push({X:s.X,Y:s.Y})}if(this.OnlyMoveXIndex){t={IsFixedX:this.OnlyMoveXIndex};if(u.Chart.Log("[IChartDrawPicture::CalculateDrawPoint] Status=".concat(this.Status," MovePointIndex=").concat(this.MovePointIndex," Identify=").concat(this.Frame.Identify)),this.Option&&this.Option.Magnet&&this.Option.Magnet.Enable&&this.IsSupportMagnet&&0==this.Frame.Identify){var C=-1;2==this.Status&&(C=1),sa.IsNumber(this.MovePointIndex)&&(C=this.MovePointIndex),C>=0&&(t.Magnet={Enable:!0,PointIndex:C,Distance:this.Option.Magnet.Distance,Type:this.Option.Magnet.Type})}this.AdjustPoint(e,t)}}return e},this.AdjustPoint=function(t,e){return!!this.Frame&&("MinuteFrame"!=this.Frame.ClassName&&"MinuteHScreenFrame"!=this.Frame.Class&&this.AdjustPoint_KLine(t,e))},this.AdjustPoint_KLine=function(t,e){if(!e)return!1;if(!this.Frame)return!1;var a=this.Frame.Data;if(!a)return!1;var i=this.Frame.IsHScreen;if(i)for(var r=0;r<t.length;++r)var n=t[r],o=parseInt(this.Frame.GetXData(n.Y))+a.DataOffset;else for(r=0;r<t.length;++r){n=t[r];var s=parseInt(this.Frame.GetXData(n.X,!1));o=s+a.DataOffset;if(o<0?o=0:o>=a.Data.length&&(o=a.Data.length-1),e.IsFixedX&&(s=o-a.DataOffset,n.X=this.Frame.GetXFromIndex(s,!1)),e.Magnet&&e.Magnet.Enable&&r==e.Magnet.PointIndex){for(var h=a.Data[o],l=[h.Open,h.High,h.Low,h.Close],u=null,C=null,D=0;D<l.length;++D){var f=this.Frame.GetYFromData(l[D]),c=Math.abs(n.Y-f);(!sa.IsNumber(u)||u>c)&&(u=c,C=f)}1==e.Magnet.Type?sa.IsNumber(C)&&(n.Y=C):u<e.Magnet.Distance&&sa.IsNumber(C)&&(n.Y=C)}}},this.IsYValueInFrame=function(t){return!!this.Frame&&!(t>this.Frame.HorizontalMax||t<this.Frame.HorizontalMin)},this.DrawPoint=function(t){if(sa.IsNonEmptyArray(t)){var e=this.PointColor,a=!1;if(this.IsShowPoint);else if(this.GetActiveDrawPicture){var i=this.GetActiveDrawPicture();if(i.Move.Guid!=this.Guid&&i.Select.Guid!=this.Guid&&i.MoveOn.Guid!=this.Guid)return;i.Select.Guid!=this.Guid&&i.MoveOn.Guid==this.Guid&&(a=!0,e=this.MoveOnPointColor)}this.ClipFrame();var r=F();this.Canvas.fillStyle=e,2==this.PointType&&(this.Canvas.fillStyle=this.PointBGColor,this.Canvas.strokeStyle=this.PointColor,this.Canvas.lineWidth=a?1*r:2*r);for(var n=0;n<t.length;++n){var o=t[n];if(1==this.PointType){var s=this.SquareSize*r,h=o.X-s/2,l=o.Y-s/2;this.Canvas.fillRect(h,l,s,s)}else if(2==this.PointType){var u=new Path2D;u.arc(o.X,o.Y,this.PointRadius*r,0,360,!1),this.Canvas.fill(u),this.Canvas.stroke(u)}else this.Canvas.beginPath(),this.Canvas.arc(o.X,o.Y,this.PointRadius*r,0,360,!1),this.Canvas.fill(),this.Canvas.closePath()}this.Canvas.restore()}},this.DrawArrow=function(t,e){var a=180*Math.atan2(t.Y-e.Y,t.X-e.X)/Math.PI,i=(a+35)*Math.PI/180,r=(a-35)*Math.PI/180,n=10*Math.cos(i),o=10*Math.sin(i),s=10*Math.cos(r),h=10*Math.sin(r);this.Canvas.beginPath();var l=e.X+n,u=e.Y+o;this.Canvas.moveTo(l,u),this.Canvas.lineTo(e.X,e.Y),l=e.X+s,u=e.Y+h,this.Canvas.lineTo(l,u),this.Canvas.stroke()},this.CalculateExtendLinePoint=function(t,e){var a={},i=(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetTopEx()),r=this.Frame.ChartBorder.GetBottom(),n=e.X-t.X,o=e.Y-t.Y;if(n>0){var s=r-t.Y,h=n*s/o,l=new V;l.X=t.X+h,l.Y=r,a.End=l;s=e.Y-i,h=n*s/o;var u=new V;u.Y=i,u.X=e.X-h,a.Start=u}else{s=r-t.Y,h=Math.abs(n)*s/o,l=new V;l.X=t.X-h,l.Y=r,a.End=l;s=e.Y-i,h=Math.abs(n)*s/o,u=new V;u.Y=i,u.X=e.X+h,a.Start=u}return a},this.CalculateExtendLineEndPoint=function(t){var e=this.Frame.ChartBorder.GetLeft(),a=this.Frame.ChartBorder.GetRight(),i=this.Frame.ChartBorder.GetBottomEx(),r=this.Frame.ChartBorder.GetTopEx(),n=t[1].X-t[0].X,o=t[1].Y-t[0].Y;if(n>0){var s=a-t[0].X,h=s*o/n,l=h+t[0].Y;if(l>=r&&l<=i){var u=new V;return u.X=a,u.Y=l,u}if(o>0){var C=i-t[0].Y,D=n*C/o,f=D+t[0].X,c=new V;return c.X=f,c.Y=i,c}if(0==o){c=new V;return c.X=a,c.Y=t[0].Y,c}C=r-t[0].Y,D=n*C/o,f=D+t[0].X,c=new V;return c.X=f,c.Y=r,c}s=t[0].X-e,h=s*o/Math.abs(n),l=h+t[0].Y;if(l>=r&&l<=i){u=new V;return u.X=e,u.Y=l,u}if(o>0){C=i-t[0].Y,D=n*C/o,f=D+t[0].X,c=new V;return c.X=f,c.Y=i,c}if(0==o){c=new V;return c.X=e,c.Y=t[0].Y,c}C=r-t[0].Y,D=n*C/o,f=D+t[0].X,c=new V;return c.X=f,c.Y=r,c},this.IsPointInXYValue=function(t,e,a){if(!this.Frame)return-1;var i=this.Frame.Data;if(!i)return-1;if(!this.Value)return-1;var r=5;a&&sa.IsNumber(a.Zoom)?r+=a.Zoom:this.Option&&sa.IsNumber(this.Option.Zoom)&&(r+=this.Option.Zoom);var n=this.Frame.IsHScreen;r*=F();for(var o=0;o<this.Value.length;++o){var s=this.Value[o],h=new V;if(n?(h.Y=this.Frame.GetXFromIndex(s.XValue-i.DataOffset),h.X=this.Frame.GetYFromData(s.YValue)):(h.X=this.Frame.GetXFromIndex(s.XValue-i.DataOffset),h.Y=this.Frame.GetYFromData(s.YValue)),this.Canvas.beginPath(),this.Canvas.arc(h.X,h.Y,r,0,360),this.Canvas.isPointInPath(t,e))return o}return-1},this.IsPointInLine=function(t,e,a){if(!this.LinePoint)return-1;var i=5;a&&sa.IsNumber(a.Zoom)?i+=a.Zoom:this.Option&&sa.IsNumber(this.Option.Zoom)&&(i+=this.Option.Zoom);var r=F();i*=r;for(var n=0;n<this.LinePoint.length;++n){var o=this.LinePoint[n],s=o.Start,h=o.End;if(this.Canvas.beginPath(),s.X==h.X?(this.Canvas.moveTo(s.X-i,s.Y),this.Canvas.lineTo(s.X+i,s.Y),this.Canvas.lineTo(h.X+i,h.Y),this.Canvas.lineTo(h.X-i,h.Y)):(this.Canvas.moveTo(s.X,s.Y+i),this.Canvas.lineTo(s.X,s.Y-i),this.Canvas.lineTo(h.X,h.Y-i),this.Canvas.lineTo(h.X,h.Y+i)),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return n}return-1},this.IsPointIn_XYValue_Line=function(t,e,a){if(10!=this.Status)return-1;var i=this.IsPointInXYValue(t,e,a);return i>=0?i:(i=this.IsPointInLine(t,e,a),i>=0?100:-1)},this.DrawLine=function(t,e,a){a&&this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke(),a&&this.Canvas.setLineDash([])},this.CreateLineData=function(t,e){var a={Start:new V,End:new V};return a.Start.Y=t.Y,a.Start.X=t.X,a.End.Y=e.Y,a.End.X=e.X,a},this.ExportStorageData=function(){for(var t={ClassName:this.ClassName,Symbol:this.Symbol,Guid:this.Guid,Period:this.Period,Value:[],FrameID:this.Frame.Identify,LineColor:this.LineColor,AreaColor:this.AreaColor,LineWidth:this.LineWidth,Right:this.Right,EnableSave:this.EnableSave,IsShowYCoordinate:this.IsShowYCoordinate},e=0;e<this.Value.length;++e){var a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue,DateTime:a.DateTime})}return this.Text&&(t.Text=this.Text),this.FontOption&&(t.FontOption=this.FontOption),t},this.ExportBaseData=function(){var t={ClassName:this.ClassName,Guid:this.Guid,FrameID:this.Frame.Identify,Symbol:this.Symbol,Period:this.Period,Right:this.Right,LineColor:this.LineColor,LineWidth:this.LineWidth,EnableSave:this.EnableSave,IsShowYCoordinate:this.IsShowYCoordinate};return this.AreaColor&&(t.AreaColor=this.AreaColor),this.Text&&(t.Text=this.Text),this.FontOption&&(t.FontOption={},this.SetFont(t.FontOption,this.FontOption)),t},this.IsFrameMinSize=function(){return this.Frame&&this.Frame.IsMinSize},this.PointRange=function(t){if(!sa.IsNonEmptyArray(t))return null;if(1==t.length){var e={Points:[{X:t[0].X,Y:t[0].Y}]};return e}for(var a=t[0].X,i=a,r=t[0].Y,n=r,o=[{X:t[0].X,Y:t[0].Y}],s=1;s<t.length;++s)a<t[s].X&&(a=t[s].X),i>t[s].X&&(i=t[s].X),r<t[s].Y&&(r=t[s].Y),n>t[s].Y&&(n=t[s].Y),o.push({X:t[s].X,Y:t[s].Y});e={X:{Max:{X:a},Min:{X:i}},Y:{Max:{Y:r},Min:{Y:n}},Points:o};return e},this.GetXYCoordinate_default=function(){if(this.IsFrameMinSize())return null;if(!this.IsShow)return null;var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});return this.PointRange(t)},this.GetXYCoordinate=function(){return null},this.CopyData_default=function(){if(!this.Frame)return null;var t=this.ExportStorageData();if(!t)return null;var e=0;if("MinuteFrame"==this.Frame.ClassName||"MinuteHScreenFrame"==this.Frame.Class);else{var a=this.Frame.Data;if(!a)return null;e=a.DataOffset}for(var i=this.Frame.ChartBorder.GetHeight(),r=this.Frame.ChartBorder.GetBottomEx()-this.Point[0].Y,n=0;n<t.Value.length;++n){var o=t.Value[n],s=this.Point[n];if(o.XIndex=o.XValue-e+1,0==n)o.XOffset=0,o.YOffset=0;else{var h=t.Value[n-1],l=this.Point[n-1];o.XOffset=o.XValue-h.XValue,o.YOffset=s.Y-l.Y}}return t.DataOffset=e,t.YFristScale=r/i,t.Height=i,t},this.SetFont=function(t,e){e&&t&&(e.Family&&(t.Family=e.Family),e.Weight&&(t.Weight=e.Weight),e.Style&&(t.Style=e.Style),sa.IsNumber(e.Size)&&(t.Size=e.Size))},this.GetFontString=function(t){var e=16*F()+"px 微软雅黑";if(!t||!t.Family||!sa.IsPlusNumber(t.Size))return e;var a="";return t.Color&&(a+=t.Color+" "),t.Style&&(a+=t.Style+" "),t.Weight&&(a+=t.Weight+" "),a+=t.Size*F()+"px ",a+=t.Family,a},this.GetMultiLineText=function(t,e,a,i){a&&(this.Canvas.font=a);var r=this.Canvas.measureText(t).width;if(r<=e)return{AryText:[{Text:t}]};var n=this.Canvas.measureText("擎").width,o=parseInt(e/n),s=0,h=[];while(s<t.length-1){var l=o,u=s+l;u>=t.length&&(u=t.length-1,l=u-s);var C=t.slice(s,s+l);r=this.Canvas.measureText(C).width;if(r>e){for(var D=l;D>=0;--D)if(C=t.slice(s,s+D),r=this.Canvas.measureText(C).width,r<e){h.push({Text:C}),s+=D;break}}else if(r<e){var f=!1;for(D=l;D+s<=t.length;++D)if(C=t.slice(s,s+D),r=this.Canvas.measureText(C).width,r>e){C=t.slice(s,s+D-1),h.push({Text:C}),s+=D-1,f=!0;break}f||(h.push({Text:C}),s=t.length-1)}else h.push({Text:C}),s+=l}return{AryText:h}},this.CloneArrayText=function(t){if(!sa.IsNonEmptyArray(t))return[];for(var e=[],a=0;a<t.length;++a){var i=t[a];i&&e.push({Text:i.Text})}return e},this.CalculateAngle=function(t,e,a,i){var r=Math.abs(t-a),n=Math.abs(e-i),o=Math.sqrt(Math.pow(r,2)+Math.pow(n,2)),s=r/o,h=Math.acos(s),l=180/(Math.PI/h);return a==t&&i<e?90:a==t&&i>e?270:a>t&&i==e?0:a<t&&i==e?180:a>t&&i>e?360-l:a<t&&i>e?180+l:a<t&&i<e?180-l:l},this.CalculateLabelSize=function(t){var e=t.Config;this.Canvas.font=e.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="top";for(var a=this.Canvas.measureText("擎").width+2,i=0,r=e.Mergin.Top+e.Mergin.Bottom,n=0;n<t.AryText.length;++n){n>0&&(r+=e.LineSpace);var o=t.AryText[n];o.NameWidth=0,o.TextWidth=0,o.Name&&(o.NameWidth=this.Canvas.measureText(o.Name).width+2),o.Text&&(o.TextWidth=this.Canvas.measureText(o.Text).width+2);var s=o.NameWidth+o.TextWidth;i<s&&(i=s),r+=a}var h=i+e.Mergin.Left+e.Mergin.Right;t.Width=h,t.Height=r,t.LineHeight=a},this.DrawDefaultLabel=function(t,e){var a=t.Config;a.BGColor&&(this.Canvas.fillStyle=a.BGColor,this.Canvas.fillRect(b(e.Left),b(e.Top),b(e.Width),b(e.Height)));for(var i=e.Left+a.Mergin.Left,r=e.Top+a.Mergin.Top,n=0;n<t.AryText.length;++n){var o=t.AryText[n];if(n>0&&(r+=a.LineSpace),o.Name&&(this.Canvas.fillStyle=o.NameColor,this.Canvas.fillText(o.Name,i,r)),o.Text){var s=i+o.NameWidth;1==a.TextAlign&&(s=e.Right-a.Mergin.Right-o.TextWidth),this.Canvas.fillStyle=o.TextColor,this.Canvas.fillText(o.Text,s,r)}r+=t.LineHeight}}}function Ya(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsShowYCoordinate=!1,this.CopyData=this.CopyData_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!1});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}},this.GetYCoordinatePoint=function(){if(this.IsFrameMinSize())return null;if(!this.IsShow)return null;if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;if(10!=this.Status)return null;for(var t=[],e=0;e<this.Value.length;++e){var a=this.Value[e],i=this.Frame.GetYFromData(a.YValue,!1);t.push({Y:i,YValue:a.YValue,Item:a,Color:this.PointColor})}return t}}function ka(){this.newMethod=Ya,this.newMethod(),delete this.newMethod,this.ClassName="ChartTrendAngle",this.AngleLineLength=100,this.AngleLineDash=[3,3],this.Font=12*F()+"px 微软雅黑",this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&(sa.IsNumber(t.AngleLineLength)&&(this.AngleLineLength=t.AngleLineLength),t.Font&&(this.Font=t.Font),t.AngleLineDash&&(this.AngleLineDash=t.AngleLineDash))},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!1});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth(),this.DrawAngle(e,a);var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawAngle=function(t,e){var a=F(),i=this.CalculateAngle(t.X,t.Y,e.X,e.Y),r=this.AngleLineLength*a,n={X:t.X+r,Y:t.Y};if(this.AngleLineDash&&this.Canvas.setLineDash(this.AngleLineDash),this.Canvas.lineWidth=1*F(),this.Canvas.beginPath(),this.Canvas.moveTo(A(t.X),A(t.Y)),this.Canvas.lineTo(A(n.X),A(n.Y)),this.Canvas.stroke(),this.Canvas.beginPath(),i<=180){this.Canvas.arc(t.X,A(t.Y),r,0,Math.PI/180*(360-i),!0);var o="".concat(i.toFixed(0),"°")}else{this.Canvas.arc(t.X,A(t.Y),r,0,Math.PI/180*(360-i),!1);o="".concat((i-360).toFixed(0),"°")}this.Canvas.stroke(),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font,this.Canvas.fillStyle=this.LineColor,this.AngleLineDash&&this.Canvas.setLineDash([]),this.Canvas.fillText(o,n.X+5,n.Y)}}function Xa(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawGraffitiLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=null,this.PointCount=2,this.EnableMoveCheck=!1,this.PointToValue=function(){if(!this.Frame)return!1;var t=this.Frame.IsHScreen;if(t)for(var e=0;e<this.Point.length;++e){var a=this.Point[e],i=this.Frame.GetYData(a.X),r={XValue:a.Y,YValue:i};this.Value[e]=r}else for(e=0;e<this.Point.length;++e){a=this.Point[e],i=this.Frame.GetYData(a.Y),r={XValue:a.X,YValue:i};this.Value[e]=r}return!0},this.ValueToPoint=function(){if(!this.Frame)return!1;var t=this.Frame.IsHScreen;for(var e in this.Point=[],this.Value){var a=this.Value[e],i=new V;t?(i.Y=a.XValue,i.X=this.Frame.GetYFromData(a.YValue)):(i.X=a.XValue,i.Y=this.Frame.GetYFromData(a.YValue,!1)),this.Point[e]=i}},this.UpdateXValue=function(){},this.CalculateDrawPoint=function(t){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var e=[];if(10==this.Status){var a=this.Frame.IsHScreen;for(var i in this.Value){var r=this.Value[i],n=new V;a?(n.Y=r.XValue,n.X=this.Frame.GetYFromData(r.YValue,!1)):(n.X=r.XValue,n.Y=this.Frame.GetYFromData(r.YValue,!1)),e.push(n)}}else e=this.Point;return e},this.IsPointInXYValue=function(t,e,a){if(!this.Frame)return-1;if(!this.Value)return-1;var i=5;a&&sa.IsNumber(a.Zoom)?i+=a.Zoom:this.Option&&sa.IsNumber(this.Option.Zoom)&&(i+=this.Option.Zoom);var r=this.Frame.IsHScreen;i*=F();for(var n=0;n<this.Value.length;++n){var o=this.Value[n],s=new V;if(r?(s.Y=o.XValue,s.X,this.Frame.GetYFromData(o.YValue)):(s.X=o.XValue,s.Y=this.Frame.GetYFromData(o.YValue)),this.Canvas.beginPath(),this.Canvas.arc(s.X,s.Y,i,0,360),this.Canvas.isPointInPath(t,e))return n}return-1},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}}}function Wa(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawArrowLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.ArrawLineWidth=5,this.ArrawLength=15,this.ArrawAngle=35,this.GetXYCoordinate=this.GetXYCoordinate_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1],i=this.ArrawAngle,r=this.ArrawLength,n=180*Math.atan2(e.Y-a.Y,e.X-a.X)/Math.PI,o=(n+i)*Math.PI/180,s=(n-i)*Math.PI/180,h=r*Math.cos(o),l=r*Math.sin(o),u=r*Math.cos(s),C=r*Math.sin(s);this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.Canvas.beginPath();var D=a.X+h,f=a.Y+l;this.Canvas.moveTo(D,f),this.Canvas.lineTo(a.X,a.Y),D=a.X+u,f=a.Y+C,this.Canvas.lineTo(D,f),this.Canvas.lineWidth=this.ArrawLineWidth*F(),this.Canvas.stroke(),this.RestoreLineWidth();var c={Start:e,End:a};this.LinePoint.push(c),this.DrawPoint([t[0]]),this.Canvas.restore()}}}}function Ua(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartArrowMarker",this.IsPointIn=this.IsPointIn_XYValue_Line,this.InsideLineConfig={Angle:25,MaxWidth:70,WidthRate:.3},this.InsideWidth=70,this.OutLineConfig={Angle:35,MaxWidth:100,WidthRate:.4},this.OutWidth=100,this.GetXYCoordinate=this.GetXYCoordinate_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption(t),t.AreaColor?this.AreaColor=t.AreaColor:this.AreaColor=Ha.ColorToRGBA(this.LineColor,.6)},this.CalculatePoint=function(t,e,a,i){var r=t,n=i,o=(t=180*Math.atan2(e.Y-a.Y,e.X-a.X)/Math.PI,(t+r)*Math.PI/180),s=(t-r)*Math.PI/180,h=n*Math.cos(o),l=n*Math.sin(o),u=n*Math.cos(s),C=n*Math.sin(s);return{Top:{X:h+a.X,Y:l+a.Y},Bottom:{X:u+a.X,Y:C+a.Y}}},this.CalculateLineWidth=function(t,e){var a=t.X-e.X,i=t.Y-e.Y,r=Math.sqrt(a*a+i*i);this.InsideWidth=r*this.InsideLineConfig.WidthRate,this.OutWidth=r*this.OutLineConfig.WidthRate,this.InsideWidth>this.InsideLineConfig.MaxWidth&&(this.InsideWidth=this.InsideLineConfig.MaxWidth),this.OutWidth>this.OutLineConfig.MaxWidth&&(this.OutWidth=this.OutLineConfig.MaxWidth)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.CalculateLineWidth(e,a);var i=this.CalculatePoint(this.OutLineConfig.Angle,e,a,this.OutWidth),r=this.CalculatePoint(this.InsideLineConfig.Angle,e,a,this.InsideWidth);this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(r.Top.X,r.Top.Y),this.Canvas.lineTo(i.Top.X,i.Top.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.lineTo(i.Bottom.X,i.Bottom.Y),this.Canvas.lineTo(r.Bottom.X,r.Bottom.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.strokeStyle=this.LineColor,this.Canvas.stroke(),this.Canvas.closePath(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.fill();var n={Start:e,End:a};this.LinePoint.push(n),this.DrawPoint([e,a]),this.Canvas.restore()}}}}function Ka(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureHaflLine",this.GetXYCoordinate=this.GetXYCoordinate_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.FullLine,this.IsPointIn=function(t,e,a){var i=this.IsPointIn_XYValue_Line(t,e,a);if(i>=0)return i;if(!this.FullLine)return i;var r=this.FullLine.Start,n=this.FullLine.End,o=F(),s=5*o;return this.Canvas.beginPath(),r.X==n.X?(this.Canvas.moveTo(r.X-s,r.Y),this.Canvas.lineTo(r.X+s,r.Y),this.Canvas.lineTo(n.X+s,n.Y),this.Canvas.lineTo(n.X-s,n.Y)):(this.Canvas.moveTo(r.X,r.Y+s),this.Canvas.lineTo(r.X,r.Y-s),this.Canvas.lineTo(n.X,n.Y-s),this.Canvas.lineTo(n.X,n.Y+s)),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e)?100:i},this.Draw=function(){if(this.LinePoint=[],this.FullLine=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!1});if(t&&2==t.length){var e=t[0],a=t[1];this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[1].X,t[1].Y);var i=this.CalculateExtendLineEndPoint(t);this.Canvas.lineTo(i.X,i.Y),this.Canvas.stroke(),this.RestoreLineWidth();var r={Start:e,End:a};this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore(),this.FullLine={Start:t[0],End:i}}}}}function za(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureHorizontalLine",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsDrawFirst=!0,this.LineWidth=1,this.Super_SetOption=this.SetOption,this.Super_ExportStorageData=this.ExportStorageData,this.LabelConfig={Left:{IsShow:!0,Margin:{Left:5,Top:4,Bottom:2,Right:5}},Right:{IsShow:!0,Margin:{Left:5,Top:4,Bottom:2,Right:5}},Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(255,255,255)"},this.InsideLabelConfig={Position:0,Font:"".concat(14*F(),"px 微软雅黑"),Margin:{Left:5,Top:4,Bottom:2,Right:5},TextColor:"rgb(255,255,255)",BGAlpha:.8},this.LabelTitle,this.SetOption=function(t){if(this.Super_SetOption&&this.Super_SetOption(t),t){if(t.LabelTitle&&(this.LabelTitle=t.LabelTitle),t.Label){var e=t.Label;if(e.Left){var a=e.Left;sa.IsBool(a.IsShow)&&(this.LabelConfig.Left.IsShow=a.IsShow)}if(e.Right){a=e.Right;sa.IsBool(a.IsShow)&&(this.LabelConfig.Right.IsShow=a.IsShow)}e.Font&&(this.LabelConfig.Font=e.Font),e.TextColor&&(this.LabelConfig.FoTextColornt=e.TextColor)}if(t.InsideLabel){e=t.InsideLabel;e.Font&&(this.InsideLabelConfig.Font=e.Font),e.TextColor&&(this.InsideLabelConfig.TextColor=e.TextColor),sa.IsNumber(e.Position)&&(this.InsideLabelConfig.Position=e.Position),sa.IsNumber(e.BGAlpha)&&(this.InsideLabelConfig.BGAlpha=e.BGAlpha)}}},this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),this.LabelTitle&&(t.LabelTitle=this.LabelTitle)),t},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();if(t&&1==t.length&&this.Frame&&1==this.Value.length){if(!this.IsYValueInFrame(this.Value[0].YValue))return null;var e=this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetRight();if(e&&(a=this.Frame.ChartBorder.GetTop(),i=this.Frame.ChartBorder.GetBottom()),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),e)this.Canvas.moveTo(t[0].X,a),this.Canvas.lineTo(t[0].X,i);else{var r=O(this.LineWidth,t[0].Y);this.Canvas.moveTo(a,r),this.Canvas.lineTo(i,r)}this.Canvas.stroke(),this.RestoreLineWidth();var n={Start:new V,End:new V};e?(n.Start.X=t[0].X,n.Start.Y=a,n.End.X=t[0].X,n.End.Y=i):(n.Start.X=a,n.Start.Y=t[0].Y,n.End.X=i,n.End.Y=t[0].Y),this.LinePoint.push(n),this.DrawPoint(t),this.DrawInsideLabel(t[0]),this.Canvas.restore(),this.DrawValueLabel(t[0])}}},this.DrawValueLabel=function(t){if(t&&!this.Frame.IsHScreen){var e=t.Y,a=this.Frame.GetYData(e),i=a.toFixed(2),r=this.Frame.GetBorder(),n=this.LabelConfig;this.Canvas.font=n.Font;var o=this.Canvas.measureText("擎").width,s=this.Canvas.measureText(i).width;if(n.Left.IsShow&&this.Frame.ChartBorder.Left>5){var h=n.Left.Margin,l={Right:r.Left-1,Height:o+h.Top+h.Bottom,Width:s+h.Left+h.Right};l.Top=e-o/2-h.Top,l.Bottom=l.Top+l.Height,l.Left=l.Right-l.Width,this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height),this.Canvas.textAlign="left",this.Canvas.textBaseline="top";var u=l.Left+h.Left,C=l.Top+h.Top;this.Canvas.fillStyle=n.TextColor,this.Canvas.fillText(i,u,C)}if(n.Right.IsShow&&this.Frame.ChartBorder.Right>5){h=n.Right.Margin,l={Left:r.Right+1,Height:o+h.Top+h.Bottom,Width:s+h.Left+h.Right};l.Top=e-o/2-h.Top,l.Bottom=l.Top+l.Height,l.Right=l.Left+l.Width,this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height),this.Canvas.textAlign="left",this.Canvas.textBaseline="top";u=l.Left+h.Left,C=l.Top+h.Top;this.Canvas.fillStyle=n.TextColor,this.Canvas.fillText(i,u,C)}}},this.DrawInsideLabel=function(t){if(t){var e=this.Frame.IsHScreen,a=this.InsideLabelConfig;if(0==a.Position||1==a.Position){var i=a.Margin;this.Canvas.fillStyle=this.LineColor,this.Canvas.font=a.Font;var r=this.Canvas.measureText("擎").width,n=this.Frame.GetBorder();if(e){var o=this.Frame.GetYData(t.X),s=o.toFixed(2);this.LabelTitle&&(s=this.LabelTitle+s);var h=this.Canvas.measureText(s).width,l=null;if(0==a.Position){l={Top:n.Top+1,Width:r+i.Top+i.Bottom,Height:h+i.Left+i.Right,Left:t.X};l.Bottom=l.Top+l.Height,l.Right=l.Left+l.Width}else if(1==a.Position){l={Bottom:n.Bottom-1,Width:r+i.Top+i.Bottom,Height:h+i.Left+i.Right,Left:t.X};l.Top=l.Bottom-l.Height,l.Right=l.Left+l.Width}var u=this.LineColor;a.BGAlpha<1&&(u=Ha.ColorToRGBA(this.LineColor,a.BGAlpha)),this.Canvas.fillStyle=u,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height);var C=l.Right-i.Top,D=l.Top+i.Left;this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillStyle=a.TextColor,this.Canvas.fillText(s,0,0)}else{o=this.Frame.GetYData(t.Y),s=o.toFixed(2);this.LabelTitle&&(s=this.LabelTitle+s);h=this.Canvas.measureText(s).width,l=null;if(0==a.Position){l={Left:n.Left+1,Height:r+i.Top+i.Bottom,Width:h+i.Left+i.Right,Bottom:t.Y};l.Top=l.Bottom-l.Height,l.Right=l.Left+l.Width}else if(1==a.Position){l={Right:n.Right-1,Height:r+i.Top+i.Bottom,Width:h+i.Left+i.Right,Bottom:t.Y};l.Top=l.Bottom-l.Height,l.Left=l.Right-l.Width}u=this.LineColor;a.BGAlpha<1&&(u=Ha.ColorToRGBA(this.LineColor,a.BGAlpha)),this.Canvas.fillStyle=u,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height);C=l.Left+i.Left,D=l.Top+i.Top;this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillStyle=a.TextColor,this.Canvas.fillText(s,C,D)}}}}}function Ja(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureHorizontalRay",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsDrawFirst=!0,this.LineWidth=1,this.Super_SetOption=this.SetOption,this.Super_ExportStorageData=this.ExportStorageData,this.LabelConfig={Right:{IsShow:!0,Margin:{Left:5,Top:4,Bottom:2,Right:5}},Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(255,255,255)"},this.SetOption=function(t){if(this.Super_SetOption&&this.Super_SetOption(t),t&&(t.LabelTitle&&(this.LabelTitle=t.LabelTitle),t.Label)){var e=t.Label;if(e.Right){var a=e.Right;sa.IsBool(a.IsShow)&&(this.LabelConfig.Right.IsShow=a.IsShow)}e.Font&&(this.LabelConfig.Font=e.Font),e.TextColor&&(this.LabelConfig.FoTextColornt=e.TextColor)}},this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData()),t},this.GetXYCoordinate=function(){if(this.IsFrameMinSize())return null;var t=this.CalculateDrawPoint(),e=this.PointRange(t);return e&&(e.IsShowYCoordinate=!1),e},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();if(t&&1==t.length&&this.Frame&&1==this.Value.length){if(!this.IsYValueInFrame(this.Value[0].YValue))return null;var e=this.Frame.IsHScreen,a=(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetRight());if(e&&(this.Frame.ChartBorder.GetTop(),a=this.Frame.ChartBorder.GetBottom()),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),e)this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[0].X,a);else{var i=O(this.LineWidth,t[0].Y);this.Canvas.moveTo(t[0].X,i),this.Canvas.lineTo(a,i)}this.Canvas.stroke(),this.RestoreLineWidth();var r={Start:new V,End:new V};e?(r.Start.X=t[0].X,r.Start.Y=t[0].Y,r.End.X=t[0].X,r.End.Y=a):(r.Start.X=t[0].X,r.Start.Y=t[0].Y,r.End.X=a,r.End.Y=t[0].Y),this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore(),this.DrawValueLabel(t[0])}}},this.DrawValueLabel=function(t){if(t&&!this.Frame.IsHScreen){var e=t.Y,a=this.Frame.GetYData(e),i=a.toFixed(2),r=this.Frame.GetBorder(),n=this.LabelConfig;this.Canvas.font=n.Font;var o=this.Canvas.measureText("擎").width,s=this.Canvas.measureText(i).width;if(n.Right.IsShow&&this.Frame.ChartBorder.Right>5){var h=n.Right.Margin,l={Left:r.Right+1,Height:o+h.Top+h.Bottom,Width:s+h.Left+h.Right};l.Top=e-o/2-h.Top,l.Bottom=l.Top+l.Height,l.Right=l.Left+l.Width,this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height),this.Canvas.textAlign="left",this.Canvas.textBaseline="top";var u=l.Left+h.Left,C=l.Top+h.Top;this.Canvas.fillStyle=n.TextColor,this.Canvas.fillText(i,u,C)}}}}function Za(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.Super_SetOption=this.SetOption,this.Super_ExportStorageData=this.ExportStorageData,this.LineWidth=1,this.Precision=2,this.ValueTextColor="rgb(250,250,250)",this.IsShowCorssCursor=!0,this.GetLabelCallback,this.PointCount=1,this.ClassName="ChartDrawHLine",this.Font=14*F()+"px 微软雅黑",this.TextFont=12*F()+"px 微软雅黑",this.RightSpaceWidth=50,this.ButtonPosition=0,this.ButtonBGColor="rgb(190,190,190)",this.ButtonSpace=3,this.TopOffset=3,this.TextMargin={Left:0,Right:0,Top:0,Bottom:0,YOffset:4*F()},this.AlwaysShowLab=!1,this.Button={CloseIcon:{Text:"",Color:"rgb(255,255,255)",Family:"iconfont",Size:16,ID:S.DRAW_PICTURE_DELETE,TooltipText:null,Margin:{Left:2,Right:2}},SettingIcon:{Text:"",Color:"rgb(255,255,255)",Family:"iconfont",Size:16,ID:S.DRAW_PICTURE_SETTING,TooltipText:null,Margin:{Left:2,Right:2}}},this.CustomButton=[],this.AryShowButton=[],this.AryButton=[],this.ExtendData,this.ShowPriceTextConfig={IsShow:[!1,!1,!0],Font:["".concat(12*F(),"px 微软雅黑"),"".concat(12*F(),"px 微软雅黑")]},this.LableInfo,this.ColseButtonSize=0,this.SettingButtonSize=0,this.ButtonBGWidth=0,this.VerticalButtonInfo={Width:0,Height:0},this.IsPointIn=this.IsPointIn_XYValue_Line,this.SetOption=function(t){if(this.Super_SetOption&&this.Super_SetOption(t),t){if(t.GetLabelCallback&&(this.GetLabelCallback=t.GetLabelCallback),sa.IsNumber(t.Precision)&&(this.Precision=t.Precision),t.Font&&(this.Font=t.Font),t.ValueTextColor&&(this.ValueTextColor=t.ValueTextColor),t.ButtonBGColor&&(this.ButtonBGColor=t.ButtonBGColor),sa.IsNumber(t.ButtonPosition)&&(this.ButtonPosition=t.ButtonPosition),sa.IsNumber(t.RightSpaceWidth)&&(this.RightSpaceWidth=t.RightSpaceWidth),sa.IsBool(t.AlwaysShowLab)&&(this.AlwaysShowLab=t.AlwaysShowLab),sa.IsNumber(t.TopOffset)&&(this.TopOffset=t.TopOffset),t.Button){var e=t.Button;e.CloseIcon?(this.Button.CloseIcon=P(e.CloseIcon),this.Button.CloseIcon.ID||(this.Button.CloseIcon.ID=S.DRAW_PICTURE_DELETE)):null===e.CloseIcon&&(this.Button.CloseIcon=null),e.SettingIcon?(this.Button.SettingIcon=P(e.SettingIcon),this.Button.SettingIcon.ID||(this.Button.SettingIcon.ID=S.DRAW_PICTURE_SETTING)):null===e.SettingIcon&&(this.Button.SettingIcon=null)}if(t.ExtendData&&(this.ExtendData=t.ExtendData),sa.IsNonEmptyArray(t.IsShowPriceText))for(var a=0;a<t.IsShowPriceText.length&&a<3;++a){var i=t.IsShowPriceText[a];sa.IsBool(i)&&(this.ShowPriceTextConfig.IsShow[a]=i)}if(t.TextMargin){e=t.TextMargin;sa.IsNumber(e.Left)&&(this.TextMargin.Left=e.Left),sa.IsNumber(e.Right)&&(this.TextMargin.Right=e.Right),sa.IsNumber(e.Top)&&(this.TextMargin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.TextMargin.Bottom=e.Bottom),sa.IsNumber(e.YOffset)&&(this.TextMargin.YOffset=e.YOffset)}}},this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),this.Label&&(t.Label=this.Label)),t},this.IsDrawMain=function(){if(!this.GetActiveDrawPicture)return!0;var t=this.GetActiveDrawPicture();return t.Select.Guid!=this.Guid},this.MainDraw=function(){this.Draw()},this.GetShowButton=function(){var t=[],e=this.Button.SettingIcon;if(e&&e.Text&&t.push({Data:e,Width:null}),e=this.Button.CloseIcon,e&&e.Text&&t.push({Data:e,Width:null}),sa.IsNonEmptyArray(this.CustomButton))for(var a=0;a<this.CustomButton.length;++a)e=this.CustomButton[a],e&&e.Text&&t.push({Data:e,Width:null});return t},this.Draw=function(t,e){if(this.AryShowButton=[],this.LinePoint=[],this.AryButton=[],this.ColseButtonSize=0,this.SettingButtonSize=0,this.ButtonBGWidth=0,this.LableInfo=null,this.VerticalButtonInfo.Width=0,this.VerticalButtonInfo.Height=0,!this.IsFrameMinSize()&&this.IsShow){var a=this.CalculateDrawPoint();if(a&&1==a.length&&this.Frame&&1==this.Value.length){var i=this.IsYValueInFrame(this.Value[0].YValue);if(this.AlwaysShowLab||i){var r=this.Frame.IsHScreen,n=this.Frame.ChartBorder.GetLeft(),o=this.Frame.ChartBorder.GetRight();r&&(n=this.Frame.ChartBorder.GetTop(),o=this.Frame.ChartBorder.GetBottom()),this.ClipFrame(),i&&(this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),r?(this.Canvas.moveTo(a[0].X,n),this.Canvas.lineTo(a[0].X,o)):(this.Canvas.moveTo(n,A(a[0].Y)),this.Canvas.lineTo(o,A(a[0].Y))),this.Canvas.stroke(),this.RestoreLineWidth());var s={Start:new V,End:new V};if(r?(s.Start.X=a[0].X,s.Start.Y=n,s.End.X=a[0].X,s.End.Y=o):(s.Start.X=n,s.Start.Y=a[0].Y,s.End.X=o,s.End.Y=a[0].Y),this.LinePoint.push(s),i){var h=this.Frame.GetYData(a[0].Y,!1),l=h.toFixed(this.Precision);this.ShowPriceTextConfig.IsShow[0]&&this.DrawPriceText(l,s.Start,s.End,0),this.ShowPriceTextConfig.IsShow[1]&&this.DrawPriceText(l,s.Start,s.End,1)}if(this.GetLabelCallback&&(this.LableInfo=this.GetLabelCallback(this)),this.AryShowButton=this.GetShowButton(),i&&this.DrawInternalLabel(a[0].Y),i){var u=n+(o-n)/2,C={X:u,Y:a[0].Y};this.DrawPoint([C])}if(this.Canvas.restore(),this.ShowPriceTextConfig.IsShow[2]){this.CalculateButtonSize(),this.DrawRightLabel(a[0].Y),i&&this.DrawCustomHLine(a[0].Y)}if(t&&e)for(var D=0;D<this.AryButton.length;++D){var f=this.AryButton[D],c=f.Rect;if(t.X>=c.Left&&t.X<c.Right&&t.Y>=c.Top&&t.Y<=c.Bottom){e.MouseOnToolbar={Rect:c,Item:f,Frame:this.Frame,Point:{X:t.X,Y:t.Y}};break}}}}}},this.CalculateLabSize=function(t){this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.font=this.TextFont;var e=this.Canvas.measureText("擎").width+2,a=0,i=0,r=0,n=0;sa.IsNumber(t.LineSpace)&&(n=t.LineSpace);a=0,i=0,r=0;for(var o=0,s=0;s<t.AryText.length;++s){var h=t.AryText[s];h.NameWidth=0,h.TextWidth=0,h.Name&&(h.NameWidth=this.Canvas.measureText(h.Name).width+2),h.Text&&(h.TextWidth=this.Canvas.measureText(h.Text).width+2),a<h.NameWidth&&(a=h.NameWidth),i<h.TextWidth&&(i=h.TextWidth);var l=h.NameWidth+h.TextWidth;o<l&&(o=l),++r}var u={Width:o,Height:r*e+(r-1)*n,NameWidth:a,TextWidth:i,LineHeight:e};if(t.LabelMargin){h=t.LabelMargin;sa.IsNumber(h.Left)&&(u.Width+=h.Left),sa.IsNumber(h.Right)&&(u.Width+=h.Right),sa.IsNumber(h.Top)&&(u.Height+=h.Top),sa.IsNumber(h.Bottom)&&(u.Height+=h.Bottom)}return u},this.DrawInternalLabel=function(t){if(this.LableInfo&&sa.IsNonEmptyArray(this.LableInfo.AryText)&&2!=this.LableInfo.Position){var e=this.Frame.GetBorder(),a=(e.Left,e.Right),i=this.CalculateLabSize(this.LableInfo),r=a-i.Width,n=r+i.Width,o=t-i.Height-1;o<=e.TopEx&&(o=t+1);var s={Left:r,Right:n,Top:o,Width:i.Width,Height:i.Height};s.Bottom=s.Top+s.Height,this.DrawLabel(this.LableInfo,i,s)}},this.DrawLabel=function(t,e,a){t.BGColor&&(this.Canvas.fillStyle=t.BGColor,this.Canvas.fillRect(b(a.Left),b(a.Top),b(a.Width),b(a.Height)));var i=t.LabelMargin,r=0;sa.IsNumber(t.LineSpace)&&(r=t.LineSpace);var n=a.Top,o=a.Left,s=a.Right;i&&(sa.IsNumber(i.Left)&&(o+=i.Left),sa.IsNumber(i.Right)&&(s-=i.Right),sa.IsNumber(i.Top)&&(n+=i.Top)),this.Canvas.font=this.TextFont,this.Canvas.textBaseline="top";for(var h=0;h<t.AryText.length;++h){h>0&&(n+=r);var l=t.AryText[h];l.Name&&(this.Canvas.textAlign="left",this.Canvas.fillStyle=l.NameColor,this.Canvas.fillText(l.Name,o,n)),l.Text&&(this.Canvas.textAlign="right",this.Canvas.fillStyle=l.TextColor,this.Canvas.fillText(l.Text,s,n)),n+=e.LineHeight}},this.DrawRightLabel=function(t){var e={};if(this.LableInfo&&sa.IsNonEmptyArray(this.LableInfo.AryText)&&2==this.LableInfo.Position){var a=this.CalculateValueText(t),i=this.CalculateLabSize(this.LableInfo),r=this.Frame.GetBorder(),n=t-a.Height/2,o=a.Height+i.Height,s=n+o,h={};s>r.Bottom&&(s=r.Bottom,n=s-o,n<this.TopOffset&&(n=this.TopOffset,s=n+o),h.Top=n),this.DrawValueText(t,e,h);var l=e.Right-i.Width;l<e.Left&&(l=e.Left);var u=l+i.Width,C=e.Bottom,D={Left:l,Right:u,Top:C,Width:i.Width,Height:i.Height};D.Bottom=D.Top+D.Height,this.DrawLabel(this.LableInfo,i,D),this.DrawVerticalButton(D)}else this.DrawValueText(t,e)},this.DrawCustomHLine=function(t){if(this.LableInfo&&sa.IsNonEmptyArray(this.LableInfo.AryLine)){for(var e=this.Frame.ChartBorder.GetLeft(),a=this.Frame.ChartBorder.GetRight(),i=F(),r=t,n=t,o=0;o<this.LableInfo.AryLine.length;++o){var s=this.LableInfo.AryLine[o];if(sa.IsNumber(s.Value)&&!(s.Width<0)){var h=this.Frame.GetYFromData(s.Value),l=A(h),u=a;sa.IsPlusNumber(s.Width)&&(u=s.Width<1?e+s.Width*(a-e):e+s.Width*i),s.Color?this.Canvas.strokeStyle=s.Color:this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e,l),this.Canvas.lineTo(u,l),this.Canvas.stroke(),r<l&&(r=l),n>l&&(n=l)}}if(r!=n&&this.LableInfo.VLine){s=this.LableInfo.VLine;var C=e+20*i;sa.IsNumber(s.XOffset)&&(C=e+s.XOffset*i),C=A(C),s.Color?this.Canvas.strokeStyle=s.Color:this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(C,r),this.Canvas.lineTo(C,n),this.Canvas.stroke()}}},this.DrawValueText=function(t,e,a){this.Frame.ChartBorder.GetLeft();var i=this.Frame.ChartBorder.GetRight(),r=this.Frame.ChartBorder.GetTopEx(),n=this.Frame.ChartBorder.GetBottomEx(),o=F(),s=this.LabelInfo;s&&sa.IsNumber(s.TopOffset)&&(r-=s.TopOffset),s&&sa.IsNumber(s.BottomOffset)&&(n+=s.BottomOffset);var h=this.Frame.GetYData(t,!1),l=h.toFixed(this.Precision);s&&s.PriceSuffixText&&(l+=s.PriceSuffixText);var u=!0;t<r?(t=r,u=!1):t>n&&(t=n,u=!1),this.RightSpaceWidth>0&&(u||this.Canvas.setLineDash([2*o,3*o]),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(i,A(t)),this.Canvas.lineTo(i+this.RightSpaceWidth,A(t)),this.Canvas.stroke(),u||this.Canvas.setLineDash([])),this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var C=this.Canvas.measureText(l).width,D=this.GetFontHeight(),f={Left:i+this.RightSpaceWidth,YCenter:t,Width:C,Height:D};f.Height+=this.TextMargin.Top+this.TextMargin.Bottom,f.Width+=this.TextMargin.Left+this.TextMargin.Right,f.Right=f.Left+f.Width,f.Top=f.YCenter-f.Height/2,f.Bottom=f.Top+f.Height,a&&sa.IsNumber(a.Top)&&(f.Top=a.Top,f.Bottom=f.Top+f.Height);var c=f.Left+this.TextMargin.Left,m=f.Top+this.TextMargin.Top+this.TextMargin.YOffset;1==this.ButtonPosition?this.Canvas.fillRect(b(f.Left),b(f.Top),b(f.Width+this.ButtonBGWidth),b(f.Height)):this.Canvas.fillRect(b(f.Left),b(f.Top),b(f.Width),b(f.Height)),this.Canvas.fillStyle=this.ValueTextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillText(l,c,m),e.Left=f.Left,e.Top=f.Top,e.Bottom=f.Bottom,e.Right=f.Right,this.DrawButton(f.Top,f.Right,D,e)},this.CalculateValueText=function(t){var e=this.Frame.GetYData(t,!1),a=e.toFixed(this.Precision);this.LableInfo&&this.LableInfo.PriceSuffixText&&(a+=this.LableInfo.PriceSuffixText),this.Canvas.font=this.Font;var i=this.Canvas.measureText(a).width,r=this.GetFontHeight(),n={Width:i,Height:r};return n.Height+=this.TextMargin.Top+this.TextMargin.Bottom,n.Width+=this.TextMargin.Left+this.TextMargin.Right,n},this.DrawPriceText=function(t,e,a,i){if(1==i||0==i){var r=this.ShowPriceTextConfig.Font[i];this.Canvas.fillStyle=this.LineColor,this.Canvas.font=r;var n=this.Canvas.measureText(t).width,o=this.GetFontHeight(),s=null;if(1==i){s={Left:e.X,Top:e.Y-o/2,Width:n+4,Height:o};s.Right=s.Left+s.Width,s.Bottom=s.Top+s.Height}else if(0==i){s={Right:a.X,Top:a.Y-o/2,Width:n+4,Height:o};s.Left=s.Right-s.Width,s.Bottom=s.Top+s.Height}this.Canvas.fillRect(b(s.Left),b(s.Top),b(s.Width+this.ButtonBGWidth),b(s.Height)),this.Canvas.fillStyle=this.ValueTextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(t,s.Left+2,e.Y)}},this.CalculateButtonSize=function(){var t=F();if(sa.IsNonEmptyArray(this.AryShowButton)){for(var e=0,a=0;a<this.AryShowButton.length;++a){var i=this.AryShowButton[a],r=i.Data,n="".concat(r.Size*t,"px ").concat(r.Family);if(this.Canvas.font=n,i.Width=this.Canvas.measureText(r.Text).width+2,i.Height=i.Width,r.Margin){var o=r.Margin;sa.IsNumber(o.Left)&&(i.Width+=o.Left),sa.IsNumber(o.Right)&&(i.Width+=o.Right),sa.IsNumber(o.Top)&&(i.Height+=o.Top),sa.IsNumber(o.Bottom)&&(i.Height+=o.Bottom)}this.VerticalButtonInfo.Width<i.Width&&(this.VerticalButtonInfo.Width=i.Width),this.VerticalButtonInfo.Height+=i.Height,e+=i.Width}this.ButtonBGWidth=e}},this.DrawVerticalButton=function(t){if(3==this.ButtonPosition&&sa.IsNonEmptyArray(this.AryShowButton)&&!(this.VerticalButtonInfo.Height<=0)){var e={Left:t.Right,Top:t.Top,Width:this.VerticalButtonInfo.Width,Height:this.VerticalButtonInfo.Height};e.Right=e.Left+e.Width,e.Bottom=e.Top+e.Height,this.Canvas.fillStyle=this.ButtonBGColor,this.Canvas.fillRect(b(e.Left),b(e.Top),b(e.Width),b(e.Height));for(var a=F(),i=t.Top,r=0;r<this.AryShowButton.length;++r){var n=this.AryShowButton[r],o=n.Data,s={Left:e.Left,Top:i,Width:this.VerticalButtonInfo.Width,Height:n.Height};s.Right=s.Left+s.Width,s.Bottom=s.Top+s.Height;var h=s.Top+s.Height/2,l=s.Left+s.Width/2,u="".concat(o.Size*a,"px ").concat(o.Family);this.Canvas.font=u,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=o.Color,this.Canvas.fillText(o.Text,l,h),this.AryButton.push({Rect:s,ID:o.ID,TooltipText:o.TooltipText,Data:o.Data}),i=s.Bottom}}},this.DrawButton=function(t,e,a,i){if(sa.IsNonEmptyArray(this.AryShowButton)&&3!=this.ButtonPosition){if(1==this.ButtonPosition){t-=a;var r=this.Frame.ChartBorder.GetChartWidth();this.Frame.ChartBorder.GetRight(),this.RightSpaceWidth;e+this.ButtonBGWidth>r&&(e=r-this.ButtonBGWidth),i.Left>e&&(e=i.Left)}else 2==this.ButtonPosition&&(t-=a,e=i.Left);this.Canvas.fillStyle=this.LineColor;var n=e,o={Left:e,Top:t,Width:this.ButtonBGWidth,Height:a};o.Right=o.Left+o.Width,o.Bottom=o.Top+o.Height,this.Canvas.fillStyle=this.ButtonBGColor,this.Canvas.fillRect(b(o.Left),b(o.Top),b(o.Width),b(o.Height));for(var s=F(),h=0;h<this.AryShowButton.length;++h){var l=this.AryShowButton[h],u=l.Data,C={Left:n,Top:t,Width:l.Width,Height:a};C.Right=C.Left+C.Width,C.Bottom=C.Top+C.Height;var D=C.Top+C.Height/2,f=C.Left+C.Width/2,c="".concat(u.Size*s,"px ").concat(u.Family);this.Canvas.font=c,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=u.Color,this.Canvas.fillText(u.Text,f,D),this.AryButton.push({Rect:C,ID:u.ID,TooltipText:u.TooltipText,Data:u.Data}),n=C.Right}}},this.PtInButtons=function(t,e){for(var a=0;a<this.AryButton.length;++a){var i=this.AryButton[a];if(i.Rect){var r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,r.Top,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return{ID:i.ID,Rect:r,Data:i.Data}}}return null}}function Qa(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureTrendLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!1});if(t&&2==t.length){var e=t[0],a=t[1],i=this.CalculateExtendLinePoint(e,a);this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.moveTo(i.Start.X,i.Start.Y),this.Canvas.lineTo(i.End.X,i.End.Y),this.Canvas.stroke(),this.RestoreLineWidth();var r={Start:e,End:a};this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore()}}}}function qa(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureRect",this.GetXYCoordinate=this.GetXYCoordinate_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.Draw=function(){if(!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});t&&2==t.length&&(this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.rect(t[0].X,t[0].Y,t[1].X-t[0].X,t[1].Y-t[0].Y),this.Canvas.stroke(),this.RestoreLineWidth(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.fillRect(t[0].X,t[0].Y,t[1].X-t[0].X,t[1].Y-t[0].Y),this.Canvas.restore(),this.DrawPoint(t))}},this.IsPointIn=function(t,e,a){if(this.IsFrameMinSize())return-1;if(!this.Frame||10!=this.Status)return-1;var i=this.Frame.Data;if(!i)return-1;var r=this.IsPointInXYValue(t,e,a);if(r>=0)return r;var n=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(!n||2!=n.length)return-1;var o=[{X:n[0].X,Y:n[0].Y},{X:n[1].X,Y:n[0].Y}];return this.IsPointInLine(o,t,e,a)?100:(o=[{X:n[1].X,Y:n[0].Y},{X:n[1].X,Y:n[1].Y}],this.IsPointInLine2(o,t,e,a)?100:(o=[{X:n[1].X,Y:n[1].Y},{X:n[0].X,Y:n[1].Y}],this.IsPointInLine(o,t,e,a)?100:(o=[{X:n[0].X,Y:n[1].Y},{X:n[0].X,Y:n[0].Y}],this.IsPointInLine2(o,t,e,a)?100:-1)))},this.IsPointInLine=function(t,e,a,i){var r=5;i&&sa.IsNumber(i.Zoom)?r+=i.Zoom:this.Option&&sa.IsNumber(this.Option.Zoom)&&(r+=this.Option.Zoom);var n=F();if(r*=n,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y+r),this.Canvas.lineTo(t[0].X,t[0].Y-r),this.Canvas.lineTo(t[1].X,t[1].Y-r),this.Canvas.lineTo(t[1].X,t[1].Y+r),this.Canvas.closePath(),this.Canvas.isPointInPath(e,a))return!0},this.IsPointInLine2=function(t,e,a,i){var r=5;i&&sa.IsNumber(i.Zoom)?r+=i.Zoom:this.Option&&sa.IsNumber(this.Option.Zoom)&&(r+=this.Option.Zoom);var n=F();if(r*=n,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X-r,t[0].Y),this.Canvas.lineTo(t[0].X+r,t[0].Y),this.Canvas.lineTo(t[1].X+r,t[1].Y),this.Canvas.lineTo(t[1].X-r,t[1].Y),this.Canvas.closePath(),this.Canvas.isPointInPath(e,a))return!0}}function ja(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureArc",this.Draw=function(){if(!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();if(t&&2==t.length){if(this.ClipFrame(),this.SetLineWidth(),t[0].X<t[1].X&&t[0].Y>t[1].Y){var e=t[1].X-t[0].X,a=t[0].Y-t[1].Y,i=e>a?1/e:1/a,r=t[0].X,n=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(var o=1.5*Math.PI;o<2*Math.PI;o+=i)this.Canvas.lineTo(r+e*Math.cos(o),n+a*Math.sin(o)*-1);for(var s=0;s<=.5*Math.PI;s+=i)this.Canvas.lineTo(r+e*Math.cos(s),n+a*Math.sin(s)*-1)}else if(t[0].X>t[1].X&&t[0].Y>t[1].Y){e=t[0].X-t[1].X,a=t[0].Y-t[1].Y,i=e>a?1/e:1/a,r=t[1].X,n=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(o=0;o<=Math.PI;o+=i)this.Canvas.lineTo(r+e*Math.cos(o),n+a*Math.sin(o)*-1)}else if(t[0].X>t[1].X&&t[0].Y<t[1].Y){e=t[0].X-t[1].X,a=t[1].Y-t[0].Y,i=e>a?1/e:1/a,r=t[0].X,n=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(o=.5*Math.PI;o<=1.5*Math.PI;o+=i)this.Canvas.lineTo(r+e*Math.cos(o),n+a*Math.sin(o)*-1)}else if(t[0].X<t[1].X&&t[0].Y<t[1].Y){e=t[1].X-t[0].X,a=t[1].Y-t[0].Y,i=e>a?1/e:1/a,r=t[1].X,n=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(o=Math.PI;o<=2*Math.PI;o+=i)this.Canvas.lineTo(r+e*Math.cos(o),n+a*Math.sin(o)*-1)}this.Canvas.strokeStyle=this.LineColor,this.Canvas.stroke(),this.RestoreLineWidth(),this.Canvas.restore(),this.DrawPoint(t)}}},this.IsPointIn=function(t,e,a){if(this.IsFrameMinSize())return-1;if(!this.Frame||10!=this.Status)return-1;var i=this.Frame.Data;if(!i)return-1;var r=this.IsPointInXYValue(t,e,a);if(r>=0)return r;var n=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(!n||2!=n.length)return-1;var o=[{X:n[0].X,Y:n[0].Y},{X:n[1].X,Y:n[1].Y}];return this.IsPointInArc(o,t,e)?100:-1},this.IsPointInArc=function(t,e,a){if(2!=t.length)return!1;if(t[0].X<t[1].X&&t[0].Y>t[1].Y){var i=t[1].X-t[0].X,r=t[0].Y-t[1].Y,n=i>r?1/i:1/r,o=.8*i,s=.8*r,h=o>s?1/o:1/s,l=t[0].X,u=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(var C=1.5*Math.PI;C<2*Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(var D=0;D<=.5*Math.PI;D+=n)this.Canvas.lineTo(l+i*Math.cos(D),u+r*Math.sin(D)*-1);for(var f=.5*Math.PI;f>=0;f-=h)this.Canvas.lineTo(l+o*Math.cos(f),u+s*Math.sin(D)*-1);for(var c=2*Math.PI;c>=1.5*Math.PI;c-=h)this.Canvas.lineTo(l+o*Math.cos(c),u+s*Math.sin(c)*-1);this.Canvas.closePath()}else if(t[0].X>t[1].X&&t[0].Y>t[1].Y){i=t[0].X-t[1].X,r=t[0].Y-t[1].Y,n=i>r?1/i:1/r,o=.8*i,s=.8*r,h=o>s?1/o:1/s,l=t[1].X,u=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(C=0;C<=Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(D=Math.PI;D>=0;D-=h)this.Canvas.lineTo(l+o*Math.cos(D),u+s*Math.sin(D)*-1);this.Canvas.closePath()}else if(t[0].X>t[1].X&&t[0].Y<t[1].Y){i=t[0].X-t[1].X,r=t[1].Y-t[0].Y,n=i>r?1/i:1/r,o=.8*i,s=.8*r,h=o>s?1/o:1/s,l=t[0].X,u=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(C=.5*Math.PI;C<=1.5*Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(D=1.5*Math.PI;D>=.5*Math.PI;D-=h)this.Canvas.lineTo(l+o*Math.cos(D),u+s*Math.sin(D)*-1);this.Canvas.closePath()}else if(t[0].X<t[1].X&&t[0].Y<t[1].Y){i=t[1].X-t[0].X,r=t[1].Y-t[0].Y,n=i>r?1/i:1/r,o=.8*i,s=.8*r,h=o>s?1/o:1/s,l=t[1].X,u=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(C=Math.PI;C<=2*Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(D=2*Math.PI;D>=Math.PI;D-=h)this.Canvas.lineTo(l+o*Math.cos(D),u+s*Math.sin(D)*-1);this.Canvas.closePath()}return!!this.Canvas.isPointInPath(e,a)}}function $a(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureWaveMW",this.PointCount=5,this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsHScreen=!1,this.Draw=function(){if(this.LinePoint=[],this.Frame&&!this.IsFrameMinSize()&&this.IsShow){this.IsHScreen=this.Frame.IsHScreen;var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(t),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.CalculateLines=function(t){if(this.Frame&&!(t.length<2))if(2==this.Status){var e={Start:new V,End:new V};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e);var a=t[1].X-t[0].X,i=t[1].Y-t[0].Y;e={Start:new V,End:new V},this.IsHScreen?(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[1].Y+i,e.End.X=t[0].X):(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[0].Y,e.End.X=t[1].X+a),this.LinePoint.push(e);var r=e.End,n=new V;n.X=r.X,n.Y=r.Y,this.Point[2]=n,e={Start:new V,End:new V},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[1].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[1].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new V;n.X=r.X,n.Y=r.Y,this.Point[3]=n,e={Start:new V,End:new V},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[0].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[0].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new V;n.X=r.X,n.Y=r.Y,this.Point[4]=n,this.PointCount=this.Point.length}else if(5==t.length){e={Start:new V,End:new V};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e);e={Start:new V,End:new V};e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[2].Y,e.End.X=t[2].X,this.LinePoint.push(e);e={Start:new V,End:new V};e.Start.Y=t[2].Y,e.Start.X=t[2].X,e.End.Y=t[3].Y,e.End.X=t[3].X,this.LinePoint.push(e);e={Start:new V,End:new V};e.Start.Y=t[3].Y,e.Start.X=t[3].X,e.End.Y=t[4].Y,e.End.X=t[4].X,this.LinePoint.push(e)}}}function ti(){this.newMethod=$a,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawHeadShouldersBT",this.CalculateLines_Backup=this.CalculateLines,this.CalculateLines=function(t){if(this.Frame&&!(t.length<2)){if(2!=this.Status)return this.CalculateLines_Backup(t);var e={Start:new V,End:new V};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e);var a=t[1].X-t[0].X,i=t[1].Y-t[0].Y;e={Start:new V,End:new V},this.IsHScreen?(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[1].Y+i,e.End.X=t[0].X-a):(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[0].Y-i,e.End.X=t[1].X+a),this.LinePoint.push(e);var r=e.End,n=new V;n.X=r.X,n.Y=r.Y,this.Point[2]=n,e={Start:new V,End:new V},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[1].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[1].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new V;n.X=r.X,n.Y=r.Y,this.Point[3]=n,e={Start:new V,End:new V},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[0].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[0].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new V;n.X=r.X,n.Y=r.Y,this.Point[4]=n,this.PointCount=this.Point.length}}}function ei(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureParallelLines",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointCount=3,this.LastPoint,this.CenterLine={LineDash:[2*F(),3*F()],Line:null,IsShow:!1},this.Super_SetOption=this.SetOption,this.Super_ExportStorageData=this.ExportStorageData,this.SetOption=function(t){if(this.Super_SetOption&&this.Super_SetOption(t),t&&t.CenterLine){var e=t.CenterLine;sa.IsNonEmptyArray(e.LineDash)&&(this.CenterLine.LineDash=e.LineDash.slice(0)),sa.IsBool(e.IsShow)&&(this.CenterLine.IsShow=e.IsShow)}},this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),this.CenterLine&&(t.CenterLine={IsShow:this.CenterLine.IsShow,LineDash:this.CenterLine.LineDash.slice(0)})),t},this.Draw=function(){if(this.LinePoint=[],this.CenterLine.Line=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!1});if(t){this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3);var e=t.slice(0);for(var a in this.CalculateLines(e),this.ClipFrame(),this.DrawArea(),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}if(this.CenterLine.IsShow&&this.CenterLine.Line){i=this.CenterLine.Line;this.Canvas.setLineDash(this.CenterLine.LineDash),this.DrawLine(i.Start,i.End),this.Canvas.setLineDash([])}this.DrawPoint(e),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){2==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new V;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a)}else if(3==t.length){a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a);var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new V,o=new V;n.X=t[0].X+i,n.Y=t[0].Y+r,o.X=t[1].X+i,o.Y=t[1].Y+r,a=this.CalculateExtendLinePoint(n,o),this.LinePoint.push(a);n=new V,o=new V;n.X=t[0].X+i/2,n.Y=t[0].Y+r/2,o.X=t[1].X+i/2,o.Y=t[1].Y+r/2,a=this.CalculateExtendLinePoint(n,o),this.CenterLine.Line=a}}}function ai(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawFlatTop",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3);var e=t.slice(0);this.CalculateLines(e),this.ClipFrame();for(var a=0;a<this.LinePoint.length;++a){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){2==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=t[1],a=new V;a.X=e.X,a.Y=this.LastPoint.Y,t[2]=a}if(2==t.length)this.LinePoint.push({Start:t[0],End:t[1]});else if(3==t.length){this.LinePoint.push({Start:t[0],End:t[1]});var i=t[2];i.X=t[1].X;var r={X:t[0].X,Y:i.Y},n={X:t[1].X,Y:i.Y};this.LinePoint.push({Start:r,End:n})}}}function ii(){this.newMethod=ai,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawDisjontChannel",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint}function ri(){this.newMethod=ei,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawParallelRaysLines",this.DrawArea=function(){},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new V;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CalculateExtendLineEndPoint([t[0],t[1]]);this.LinePoint.push({Start:t[0],End:a})}else if(3==t.length){a=this.CalculateExtendLineEndPoint([t[0],t[1]]);this.LinePoint.push({Start:t[0],End:a});var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new V,o=new V;n.X=t[0].X+i,n.Y=t[0].Y+r,o.X=t[1].X+i,o.Y=t[1].Y+r,a=this.CalculateExtendLineEndPoint([n,o]),this.LinePoint.push({Start:t[2],End:a})}}}function ni(){this.newMethod=ei,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPicturePriceChannel",this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new V;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a)}else if(3==t.length){a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a);var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new V,o=new V;n.X=t[0].X+i,n.Y=t[0].Y+r,o.X=t[1].X+i,o.Y=t[1].Y+r,a=this.CalculateExtendLinePoint(n,o),this.LinePoint.push(a);n=new V,o=new V;n.X=t[0].X-i,n.Y=t[0].Y-r,o.X=t[1].X-i,o.Y=t[1].Y-r,a=this.CalculateExtendLinePoint(n,o),this.LinePoint.push(a)}},this.DrawArea=function(){3==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.lineTo(this.LinePoint[2].Start.X,this.LinePoint[2].Start.Y),this.Canvas.closePath(),this.Canvas.fill())}}function oi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureParallelChannel",this.ChannelWidth=50,this.AreaColor="rgba(25,25,25,0.4)",this.LinePoint=[],this.CenterLine={LineDash:[2*F(),3*F()],Line:null,IsShow:!1},this.Super_SetOption=this.SetOption,this.ExportStorageData=function(){var t=this.ExportBaseData();t.ChannelWidth=this.ChannelWidth,t.Value=[];for(var e=0;e<this.Value.length&&e<2;++e){var a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue,DateTime:a.DateTime})}return this.CenterLine&&(t.CenterLine={IsShow:this.CenterLine.IsShow,LineDash:this.CenterLine.LineDash.slice(0)}),t},this.SetOption=function(t){if(this.Super_SetOption&&this.Super_SetOption(t),t&&(sa.IsNumber(t.ChannelWidth)&&(this.ChannelWidth=t.ChannelWidth),t.CenterLine)){var e=t.CenterLine;sa.IsNonEmptyArray(e.LineDash)&&(this.CenterLine.LineDash=e.LineDash.slice(0)),sa.IsBool(e.IsShow)&&(this.CenterLine.IsShow=e.IsShow)}},this.CalculateDrawPoint=function(){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var t=this.Frame.Data;if(!t)return null;var e=[];if(10==this.Status)for(var a=0;a<2;++a){var i=this.Value[a],r=new V;r.X=this.Frame.GetXFromIndex(i.XValue-t.DataOffset,!1),r.Y=this.Frame.GetYFromData(i.YValue,!1),e.push(r)}else for(a=0;a<this.Point.length;++a){i=this.Point[a],r=new V;r.X=i.X,r.Y=i.Y,e.push(r)}if(e.length>=2){var n={Start:new V,End:new V};if(n.Start.X=e[0].X,n.Start.Y=e[0].Y,n.End.X=e[1].X,n.End.Y=e[1].Y,this.LinePoint.push(n),3==e.length||10==this.Status){var o=n.End.X-n.Start.X,s=n.End.Y-n.Start.Y,h=Math.atan(Math.abs(o/s)),l=this.ChannelWidth/Math.sin(h);n={Start:new V,End:new V},n.Start.X=e[0].X,n.Start.Y=e[0].Y-l,n.End.X=e[1].X,n.End.Y=e[1].Y-l,this.LinePoint.push(n);var u=new V;u.X=n.Start.X+(n.End.X-n.Start.X)/2,u.Y=n.Start.Y+(n.End.Y-n.Start.Y)/2,e[2]=u,this.Point[2]=u;var C=parseInt(this.Frame.GetXData(u.X))+t.DataOffset,D=this.Frame.GetYData(u.Y);this.Value[2]={XValue:C,YValue:D},this.PointCount=this.Point.length,n={Start:new V,End:new V},n.Start.X=e[0].X,n.Start.Y=e[0].Y-l/2,n.End.X=e[1].X,n.End.Y=e[1].Y-l/2,this.CenterLine.Line=n}}return e},this.DrawArea=function(t,e,a,i){this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.lineTo(i.X,i.Y),this.Canvas.closePath(),this.Canvas.fill()},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();if(t){this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),2==this.LinePoint.length&&this.DrawArea(this.LinePoint[0].Start,this.LinePoint[0].End,this.LinePoint[1].End,this.LinePoint[1].Start);for(var e=0;e<this.LinePoint.length;++e){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}if(this.CenterLine.IsShow&&this.CenterLine.Line){a=this.CenterLine.Line;this.Canvas.setLineDash(this.CenterLine.LineDash),this.DrawLine(a.Start,a.End),this.Canvas.setLineDash([])}this.Canvas.restore(),this.DrawPoint(t)}}},this.Move=function(t,e){if(20!=this.Status)return!1;if(!this.Frame)return!1;var a=this.Frame.Data;if(!a)return!1;if(100==this.MovePointIndex)for(var i=0;i<this.Point.length;++i)this.Point[i].X+=t,this.Point[i].Y+=e;else if(0==this.MovePointIndex||1==this.MovePointIndex)this.MovePointIndex<this.Point.length&&(this.Point[this.MovePointIndex].X+=t,this.Point[this.MovePointIndex].Y+=e);else if(2==this.MovePointIndex){this.Point[this.MovePointIndex].X+=t,this.Point[this.MovePointIndex].Y+=e;var r=this.Point[1].X-this.Point[0].X,n=this.Point[1].Y-this.Point[0].Y,o=Math.atan(Math.abs(r/n)),s=this.ChannelWidth/Math.sin(o)-e;this.ChannelWidth=Math.sin(o)*s}},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;if(!a)return-1;for(var i=0;i<this.Value.length;++i){var r=this.Value[i],n=new V;if(i<2)n.X=this.Frame.GetXFromIndex(r.XValue-a.DataOffset),n.Y=this.Frame.GetYFromData(r.YValue);else{if(i>=this.Point.length)continue;n.X=this.Point[i].X,n.Y=this.Point[i].Y}if(this.Canvas.beginPath(),this.Canvas.arc(n.X,n.Y,5,0,360),this.Canvas.isPointInPath(t,e))return i}for(var i in this.LinePoint){r=this.LinePoint[i];var o=r.Start,s=r.End;if(this.Canvas.beginPath(),this.Canvas.moveTo(o.X,o.Y+5),this.Canvas.lineTo(o.X,o.Y-5),this.Canvas.lineTo(s.X,s.Y-5),this.Canvas.lineTo(s.X,s.Y+5),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return 100}return-1}}function si(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureText",this.Text="输入文字",this.PointCount=1,this.FontOption={Family:"微软雅黑",Size:20,Weight:null,Style:null},this.TextRect=null,this.HQChart,this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.Text&&(this.Text=t.Text),t.FontOption&&(this.FontOption=t.FontOption))},this.Draw=function(t){if(this.TextRect=null,!this.IsFrameMinSize()&&this.IsShow){var e=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(e&&1==e.length){this.ClipFrame(),this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.font=this.GetTextFont(),this.Canvas.fillText(this.Text,e[0].X,e[0].Y);var a=this.Canvas.measureText(this.Text).width,i=this.FontOption.Size*F();this.TextRect={},this.TextRect.Left=e[0].X-a/2,this.TextRect.Top=e[0].Y-i,this.TextRect.Width=a,this.TextRect.Height=i,this.Canvas.restore()}}},this.GetTextFont=function(){var t=16*F()+"px 微软雅黑";if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return t;var e="";return this.FontOption.Color&&(e+=this.FontOption.Color+" "),this.FontOption.Style&&(e+=this.FontOption.Style+" "),this.FontOption.Weight&&(e+=this.FontOption.Weight+" "),this.FontOption.Size>=0&&(e+=this.FontOption.Size*F()+"px "),e+=this.FontOption.Family,e},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;return a&&this.TextRect?(this.Canvas.beginPath(),this.Canvas.rect(this.TextRect.Left,this.TextRect.Top,this.TextRect.Width,this.TextRect.Height),this.Canvas.isPointInPath(t,e)?100:-1):-1}}function hi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureIconFont",this.PointCount=1,this.Text="",this.FontOption={Family:"iconfont",Size:24},this.TextRect=null,this.SettingMenu,this.Angle=0,this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.FontOption&&t.FontOption.Size>0&&(this.FontOption.Size=t.FontOption.Size),sa.IsNumber(t.Angle)&&(this.Angle=t.Angle))},this.Draw=function(){if(this.TextRect=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&1==t.length){var e=this.GetTextFont();if(e){this.ClipFrame();var a=this.Frame.IsHScreen,i=F();this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.font=e,a?(this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Text,0,0)):0!=this.Angle?(this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(this.Angle*(Math.PI/180)),this.Canvas.fillText(this.Text,0,0)):this.Canvas.fillText(this.Text,t[0].X,t[0].Y);var r=this.Canvas.measureText(this.Text).width;this.TextRect={},this.TextRect.Left=t[0].X-r/2,this.TextRect.Top=t[0].Y-this.FontOption.Size*i,this.TextRect.Width=r,this.TextRect.Height=this.FontOption.Size*i,this.Canvas.restore()}}}},this.GetTextFont=function(){if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return null;var t="";return this.FontOption.Size>=0&&(t+=this.FontOption.Size*F()+"px "),t+=this.FontOption.Family,t},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;if(!a)return-1;if(!this.TextRect)return-1;var i=0;return this.Option&&this.Option.Zoom>=1&&(i=this.Option.Zoom*F()),this.Canvas.beginPath(),this.Canvas.rect(this.TextRect.Left-i,this.TextRect.Top-i,this.TextRect.Width+2*i,this.TextRect.Height+2*i),this.Canvas.isPointInPath(t,e)?100:-1}}function li(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureGannFan",this.IsPointIn=this.IsPointIn_XYValue_Line,this.LinePoint=[],this.Font=16*F()+"px 微软雅黑",this.LineDash=[5,10],this.EnableDottedLine=!1,this.EnableArea=!0,this.IsShowTitle=!0,this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&(t.Font&&(this.Font=t.Font),Array.isArray(t.LineDash)&&(this.LineDash=t.LineDash),sa.IsBool(t.EnableDottedLine)&&(this.EnableDottedLine=t.EnableDottedLine),sa.IsBool(t.EnableArea)&&(this.EnableArea=t.EnableArea),sa.IsBool(t.IsShowTitle)&&(this.IsShowTitle=t.IsShowTitle))},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame();var e=this.GetQuadrant(t[0],t[1]);if(this.SetLineWidth(),1===e||2===e||3===e||4===e){this.CalculateLines(t[0],t[1],e),this.EnableArea&&this.DrawArea();for(var a=0;a<this.LinePoint.length;++a){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End,i.IsDottedLine)}if(this.IsShowTitle)for(a=0;a<this.LinePoint.length;++a){i=this.LinePoint[a];i.Text&&i.PtEnd&&this.DrawTitle(i.PtEnd,i.Text)}}else this.DrawLine(t[0],t[1],!1);this.RestoreLineWidth(),this.Canvas.restore(),this.DrawPoint(t)}}},this.GetQuadrant=function(t,e){return t.X<e.X&&t.Y>e.Y?1:t.X>e.X&&t.Y>e.Y?2:t.X<e.X&&t.Y<e.Y?4:3},this.DrawLine=function(t,e,a){a&&this.Canvas.setLineDash(this.LineDash),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke(),a&&this.Canvas.setLineDash([])},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Canvas.fillText(e,t.X,t.Y)},this.DrawArea=function(){var t=null,e=null;for(var a in this.LinePoint){var i=this.LinePoint[a];"1:8"==i.Text?t=this.LinePoint[a]:"8:1"==i.Text&&(e=this.LinePoint[a])}t&&e&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.End.X,t.End.Y),this.Canvas.lineTo(t.Start.X,t.Start.Y),this.Canvas.lineTo(e.End.X,e.End.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t,e,a){if(!this.Frame)return!1;this.Frame.ChartBorder.GetTopEx(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetBottom();var i=[.5,1/3,.25,.125,2/3],r=["1:2","1:3","1:4","1:8","2:3"],n=["2:1","3:1","4:1","8:1","3:2"],o=new V,s=new V;o.X=t.X,o.Y=t.Y,s.X=e.X,s.Y=e.Y;var h=Math.abs(t.X-e.X),l=Math.abs(t.Y-e.Y);if(1===a){var u=this.CalculateExtendLinePoint(t,e),C={Start:o,End:u.Start,IsDottedLine:!1,PtEnd:s,Text:"1:1"};this.LinePoint.push(C);for(var D=0;D<i.length;++D){if(h>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[D]},C.PtEnd.Y=e.Y,C.PtEnd.X=t.X+h*i[D];u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.Start,this.LinePoint.push(C)}if(l>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:n[D]},C.PtEnd.Y=t.Y-l*i[D],C.PtEnd.X=e.X;u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.Start,this.LinePoint.push(C)}}}else if(2==a){u=this.CalculateExtendLinePoint(t,e),C={Start:o,End:u.Start,IsDottedLine:!1,PtEnd:s,Text:"1:1"};this.LinePoint.push(C);for(D=0;D<i.length;++D){if(h>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[D]},C.PtEnd.Y=e.Y,C.PtEnd.X=t.X-h*i[D];u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.Start,this.LinePoint.push(C)}if(l>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:n[D]},C.PtEnd.Y=t.Y-l*i[D],C.PtEnd.X=e.X;u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.Start,this.LinePoint.push(C)}}}else if(3==a){u=this.CalculateExtendLinePoint(t,e),C={Start:o,End:u.End,IsDottedLine:!1,PtEnd:s,Text:"1:1"};this.LinePoint.push(C);for(D=0;D<i.length;++D){if(h>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[D]},C.PtEnd.Y=e.Y,C.PtEnd.X=t.X-h*i[D];u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.End,this.LinePoint.push(C)}if(l>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:n[D]},C.PtEnd.Y=t.Y+l*i[D],C.PtEnd.X=e.X;u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.End,this.LinePoint.push(C)}}}else{if(4!=a)return!1;u=this.CalculateExtendLinePoint(t,e),C={Start:o,End:u.End,IsDottedLine:!1,PtEnd:s,Text:"1:1"};this.LinePoint.push(C);for(D=0;D<i.length;++D){if(h>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[D]},C.PtEnd.Y=e.Y,C.PtEnd.X=t.X+h*i[D];u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.End,this.LinePoint.push(C)}if(l>5){C={Start:o,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:n[D]},C.PtEnd.Y=t.Y+l*i[D],C.PtEnd.X=e.X;u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.End,this.LinePoint.push(C)}}}return!0}}function ui(){this.newMethod=li,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureGannFanV2",this.EnableDottedLine=!0,this.LineDash=[4,8],this.EnableArea=!1,this.Super_CalculateLines=this.CalculateLines,this.CalculateLines=function(t,e,a){if(!this.Super_CalculateLines(t,e,a))return!1;var i=this.Frame.ChartBorder.GetBorder();if(1==a){var r={Start:t,End:{X:i.Right,Y:t.Y},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r);r={Start:t,End:{X:t.X,Y:i.TopEx},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r)}else if(2==a){r={Start:t,End:{X:t.X,Y:i.TopEx},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r);r={Start:t,End:{X:i.Left,Y:t.Y},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r)}else if(3==a){r={Start:t,End:{X:i.Left,Y:t.Y},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r);r={Start:t,End:{X:t.X,Y:i.BottomEx},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r)}else if(4==a){r={Start:t,End:{X:t.X,Y:i.BottomEx},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r);r={Start:t,End:{X:i.Right,Y:t.Y},IsDottedLine:!1,PtEnd:null,Text:null};this.LinePoint.push(r)}}}function Ci(){this.newMethod=li,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureResistanceLine",this.CalculateLines=function(t,e,a){if(!this.Frame)return!1;this.Frame.ChartBorder.GetTopEx(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetBottom();var i=[1/3,2/3],r=["3:1","3:2"],n=new V,o=new V;n.X=t.X,n.Y=t.Y,o.X=e.X,o.Y=e.Y;Math.abs(t.X-e.X);var s=Math.abs(t.Y-e.Y);if(1===a){var h=this.CalculateExtendLinePoint(t,e),l={Start:n,End:h.Start,IsDottedLine:!1,PtEnd:o,Text:"1:1"};this.LinePoint.push(l);for(var u=0;u<i.length;++u)if(s>5){l={Start:n,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[u]},l.PtEnd.Y=t.Y-s*i[u],l.PtEnd.X=e.X;h=this.CalculateExtendLinePoint(l.Start,l.PtEnd);l.End=h.Start,this.LinePoint.push(l)}}else if(2==a){h=this.CalculateExtendLinePoint(t,e),l={Start:n,End:h.Start,IsDottedLine:!1,PtEnd:o,Text:"1:1"};this.LinePoint.push(l);for(u=0;u<i.length;++u)if(s>5){l={Start:n,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[u]},l.PtEnd.Y=t.Y-s*i[u],l.PtEnd.X=e.X;h=this.CalculateExtendLinePoint(l.Start,l.PtEnd);l.End=h.Start,this.LinePoint.push(l)}}else if(3==a){h=this.CalculateExtendLinePoint(t,e),l={Start:n,End:h.End,IsDottedLine:!1,PtEnd:o,Text:"1:1"};this.LinePoint.push(l);for(u=0;u<i.length;++u)if(s>5){l={Start:n,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[u]},l.PtEnd.Y=t.Y+s*i[u],l.PtEnd.X=e.X;h=this.CalculateExtendLinePoint(l.Start,l.PtEnd);l.End=h.End,this.LinePoint.push(l)}}else{if(4!=a)return!1;h=this.CalculateExtendLinePoint(t,e),l={Start:n,End:h.End,IsDottedLine:!1,PtEnd:o,Text:"1:1"};this.LinePoint.push(l);for(u=0;u<i.length;++u)if(s>5){l={Start:n,End:null,IsDottedLine:this.EnableDottedLine,PtEnd:new V,Text:r[u]},l.PtEnd.Y=t.Y+s*i[u],l.PtEnd.X=e.X;h=this.CalculateExtendLinePoint(l.Start,l.PtEnd);l.End=h.End,this.LinePoint.push(l)}}return!0},this.DrawArea=function(){var t=null,e=null;for(var a in this.LinePoint){var i=this.LinePoint[a];"1:1"==i.Text?t=this.LinePoint[a]:"3:1"==i.Text&&(e=this.LinePoint[a])}t&&e&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.End.X,t.End.Y),this.Canvas.lineTo(t.Start.X,t.Start.Y),this.Canvas.lineTo(e.End.X,e.End.Y),this.Canvas.closePath(),this.Canvas.fill())}}function Di(){this.newMethod=Ci,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureResistanceLineV2",this.EnableDottedLine=!0,this.LineDash=[4,8],this.EnableArea=!1,this.IsShowTitle=!1}function fi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureGoldenSection",this.IsPointIn=this.IsPointIn_XYValue_Line,this.Font=14*F()+"px 微软雅黑",this.GetSectionData=function(){return[0,.236,.382,.5,.618,.8,1,1.236,1.382,1.5,1.618,1.8,2]},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();if(t&&2==t.length){for(var e in this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.CalculateLines(t[0],t[1]),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End,a.IsDottedLine)}for(var e in this.RestoreLineWidth(),this.LinePoint){a=this.LinePoint[e];a.Text&&this.DrawTitle(a.Start,a.Text)}this.DrawPoint(t),this.Canvas.restore()}}},this.CalculateHSCreenLines=function(t,e){for(var a=this.GetSectionData(),i=this.Frame.ChartBorder.GetTop(),r=this.Frame.ChartBorder.GetBottom(),n=t.X-e.X,o=0;o<a.length;++o){var s=n*a[o],h={Start:new V,End:new V};h.Start.X=t.X-s,h.Start.Y=i,h.End.X=t.X-s,h.End.Y=r;var l="";l=0==o?"Base ":(100*a[o]).toFixed(2)+"% ";var u=this.Frame.GetYData(h.Start.X);l+=u.toFixed(2),h.Text=l,this.LinePoint.push(h)}},this.CalculateLines=function(t,e){if(this.Frame.IsHScreen)this.CalculateHSCreenLines(t,e);else for(var a=this.GetSectionData(),i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetRight(),n=t.Y-e.Y,o=0;o<a.length;++o){var s=n*a[o],h={Start:new V,End:new V};h.Start.Y=t.Y-s,h.Start.X=i,h.End.Y=t.Y-s,h.End.X=r;var l="";l=0==o?"Base ":(100*a[o]).toFixed(2)+"% ";var u=this.Frame.GetYData(h.Start.Y);l+=u.toFixed(2),h.Text=l,this.LinePoint.push(h)}},this.DrawLine=function(t,e){this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke()},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Frame.IsHScreen?(this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,0,0),this.Canvas.restore()):this.Canvas.fillText(e,t.X,t.Y)}}function ci(){this.newMethod=fi,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPicturePercentage",this.GetSectionData=function(){return[0,.25,.333,.5,1]}}function mi(){this.newMethod=fi,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureWaveBand",this.GetSectionData=function(){return[0,.125,.25,.375,.5,.625,.75,.875,1]}}function di(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureTriangle",this.PointCount=3,this.Font=16*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){var e=t.slice(0);for(var a in this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(e),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(e),this.DrawPoint(e),this.DrawTitle(e),this.Canvas.restore()}}},this.DrawArea=function(t){3==t.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[1].X,t[1].Y),this.Canvas.lineTo(t[2].X,t[2].Y),this.Canvas.lineTo(t[0].X,t[0].Y),this.Canvas.closePath(),this.Canvas.fill())},this.DrawTitle=function(t){this.Status},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new V;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2===t.length){var a={Start:new V,End:new V};a.Start.Y=t[0].Y,a.Start.X=t[0].X,a.End.Y=t[1].Y,a.End.X=t[1].X,this.LinePoint.push(a)}else if(3===t.length){a={Start:new V,End:new V};a.Start.Y=t[0].Y,a.Start.X=t[0].X,a.End.Y=t[1].Y,a.End.X=t[1].X,this.LinePoint.push(a),a={Start:new V,End:new V},a.Start.Y=t[1].Y,a.Start.X=t[1].X,a.End.Y=t[2].Y,a.End.X=t[2].X,this.LinePoint.push(a),a={Start:new V,End:new V},a.Start.Y=t[2].Y,a.Start.X=t[2].X,a.End.Y=t[0].Y,a.End.X=t[0].X,this.LinePoint.push(a)}}}function Ii(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureSymmetryAngle",this.PointCount=2,this.Font=16*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(t),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}this.DrawArea(),this.DrawPoint(t),this.DrawTitle(t),this.Canvas.restore()}}},this.CalculateLines=function(t){if(2==t.length&&this.Frame){var e={Start:new V,End:new V};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e),e={Start:new V,End:new V},e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[0].X,this.LinePoint.push(e);var a=t[0].X-t[1].X;e={Start:new V,End:new V},e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[0].X+a,this.LinePoint.push(e)}},this.DrawArea=function(){3==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.DrawTitle=function(t){this.Status}}function Si(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureCircle",this.PointCount=2,this.CircleData,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3),this.ClipFrame();var e=t[0].X-t[1].X,a=t[0].Y-t[1].Y,i=Math.sqrt(e*e+a*a);this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.LineColor,this.DrawLine(t[0],t[1]),this.Canvas.beginPath(),this.Canvas.arc(t[0].X,t[0].Y,i,0,2*Math.PI),this.Canvas.stroke(),this.Canvas.fill(),this.CircleData={X:t[0].X,Y:t[0].Y,R:i},this.DrawPoint(t),this.Canvas.restore()}}},this.IsPointIn=function(t,e,a){if(this.IsFrameMinSize())return-1;if(10!=this.Status)return-1;var i=this.IsPointInXYValue(t,e,a);if(i>=0)return i;if(this.CircleData&&this.CircleData.R>8){var r=this.CircleData.X-t,n=this.CircleData.Y-e,o=Math.sqrt(r*r+n*n);if(o<this.CircleData.R&&o>this.CircleData.R-8)return 100}return-1}}function Ti(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureQuadrangle",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointCount=3,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=Ha.ColorToRGBA(this.LineColor,.3);var e=t.slice(0);for(var a in this.CalculateLines(e),this.ClipFrame(),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){4==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new V;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CreateLineData(t[0],t[1]);this.LinePoint.push(a)}else if(3==t.length){a=this.CreateLineData(t[0],t[1]);this.LinePoint.push(a);a=this.CreateLineData(t[1],t[2]);this.LinePoint.push(a);var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new V;n.X=t[0].X+i,n.Y=t[0].Y+r;a=this.CreateLineData(t[2],n);this.LinePoint.push(a);a=this.CreateLineData(n,t[0]);this.LinePoint.push(a)}}}function vi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureFibonacci",this.PointCount=1,this.Font=14*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();if(t&&(this.CalculateLines(),!(this.LinePoint.length<=0))){for(var e in this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End),this.DrawTitle(a.Start,a.Title)}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.font=this.Font,this.Frame.IsHScreen?(this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,2,10),this.Canvas.restore()):this.Canvas.fillText(e,t.X+2,t.Y+10)},this.CalculateHSCreenLines=function(){var t=this.Frame.Data;if(t){var e=null;if(10==this.Status){if(1!=this.Value.length)return;e=this.Value[0].XValue}else{if(1!=this.Point.length)return;e=parseInt(this.Frame.GetXData(this.Point[0].Y))+t.DataOffset}for(var a=this.Frame.ChartBorder.GetRightEx(),i=this.Frame.ChartBorder.GetLeftEx(),r=this.Frame.XPointCount,n=[1,2,3,5,8,13,21,34,55,89,144,233],o=0;o<n.length;++o){var s=e+n[o],h=s-t.DataOffset;if(!(h<0||h>=r)){var l=this.Frame.GetXFromIndex(s-t.DataOffset,!1),u={Start:new V,End:new V,Title:n[o]};u.Start.X=a,u.Start.Y=l,u.End.X=i,u.End.Y=l,this.LinePoint.push(u)}}}},this.CalculateLines=function(){if(!(this.Status<2)&&this.Frame){var t=this.Frame.Data;if(t)if(this.Frame.IsHScreen)this.CalculateHSCreenLines();else{var e=null;if(10==this.Status){if(1!=this.Value.length)return;e=this.Value[0].XValue}else{if(1!=this.Point.length)return;e=parseInt(this.Frame.GetXData(this.Point[0].X))+t.DataOffset}for(var a=this.Frame.ChartBorder.GetTopEx(),i=this.Frame.ChartBorder.GetBottom(),r=this.Frame.XPointCount,n=[1,2,3,5,8,13,21,34,55,89,144,233],o=0;o<n.length;++o){var s=e+n[o],h=s-t.DataOffset;if(!(h<0||h>=r)){var l=this.Frame.GetXFromIndex(s-t.DataOffset,!1),u={Start:new V,End:new V,Title:n[o]};u.Start.Y=a,u.Start.X=l,u.End.Y=i,u.End.X=l,this.LinePoint.push(u)}}}}}}function pi(t){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawLinearRegression",this.PointCount=2,this.IsPointIn=this.IsPointIn_XYValue_Line,this.ChartBorder,this.Lines=[],this.IsShowMaxMinLine=!1,this.IsShowExtendLine=!1,this.ExtendLineDash=[5,5],this.MaxPoint,this.MinPoint,t&&(1==t.IsShowMaxMinLine&&(this.IsShowMaxMinLine=!0),1==t.IsShowExtendLine&&(this.IsShowExtendLine=!0)),this.ImportStorageData=function(t){1==t.IsShowMaxMinLine&&(this.IsShowMaxMinLine=!0),1==t.IsShowExtendLine&&(this.IsShowExtendLine=!0),t.Lines&&(this.Lines=t.Lines),t.MaxPoint&&t.MinPoint&&(this.MaxPoint=t.MaxPoint,this.MinPoint=t.MinPoint)},this.Super_ExportStorageData=this.ExportStorageData,this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),t.IsShowMaxMinLine=this.IsShowMaxMinLine,t.IsShowExtendLine=this.IsShowExtendLine,t.Lines=this.Lines,this.IsShowMaxMinLine&&(t.MaxPoint=this.MaxPoint,t.MinPoint=this.MinPoint)),t},this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.Point[0]={X:this.Lines[0].X,Y:this.Lines[0].Y},this.Point[1]={X:this.Lines[this.Lines.length-1].X,Y:this.Lines[this.Lines.length-1].Y},this.PointToValue_Backup()},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame(),this.ChartBorder=this.Frame.ChartBorder,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor;var e=t[0],a=t[1];if(10==this.Status)this.DrawLinearLines();else{var i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetBottomEx(),n=this.PointToKLine([e,a]),o=this.Calculate(n);this.Lines=o.Points,this.MaxPoint=o.Max,this.MinPoint=o.Min,this.DrawLinearLines(),this.Canvas.beginPath(),this.Canvas.moveTo(e.X,i),this.Canvas.lineTo(e.X,r),this.Canvas.moveTo(a.X,i),this.Canvas.lineTo(a.X,r),this.Canvas.stroke()}this.RestoreLineWidth();var s={Start:e,End:a};this.LinePoint.push(s),this.DrawPoint(t),this.Canvas.restore()}else 10==this.Status&&(this.ClipFrame(),this.ChartBorder=this.Frame.ChartBorder,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.DrawLinearLines(),this.RestoreLineWidth(),this.Canvas.restore())}},this.Calculate=function(t){var e=t[0],a=t[1];e.XValue>a.XValue&&(e=t[1],a=t[0]);var i,r,n,o,s=a.XValue-e.XValue+1,h=this.Frame.Data.Data,l=a.XValue,u=0,C=0,D=0,f=0;for(n=0,T=s;n<s&&n<=l;++n,--T)u+=T,C+=h[l-n].Close;for(u/=s,C/=s,n=0,T=s;n<s&&n<=l;++n,--T)D+=(T-u)*(h[l-n].Close-C),f+=(T-u)*(T-u);r=D/f,i=C-u*r;var c=[],m=null,d=null;for(n=0,o=s;n<s&&n<=l;++n,--o){var I=a.XIndex-n,S=a.XValue-n,T=this.Frame.GetXFromIndex(I),v=r*o+i,p=this.Frame.GetYFromData(v,!1),g={X:T,Y:p,XValue:S,YValue:v};c.push(g),(null==m||m.High<h[S].High)&&(m={X:T,Y:p,XValue:S,YValue:v,High:h[S].High}),(null==d||d.Low>h[S].Low)&&(d={X:T,Y:p,XValue:S,YValue:v,Low:h[S].Low})}return{Points:c,Slope:r,Const:i,Max:m,Min:d}},this.DrawLinearLines=function(){if(!this.Frame)return null;var t=this.Frame.Data;if(!t)return null;var e=this.Frame.XPointCount,a=t.DataOffset,i=this.Frame.IsHScreen,r=[];for(var n in this.Lines){var o=this.Lines[n],s=o.XValue-a;if(!(s<0||s>=e)){var h={};i||(h.X=this.Frame.GetXFromIndex(s,!1),h.Y=this.Frame.GetYFromData(o.YValue,!1),h.YValue=o.YValue),r.push(h)}}if(r.length>1){for(var n in r){o=r[n];0==n?(this.Canvas.beginPath(),this.Canvas.moveTo(o.X,o.Y)):(this.Canvas.lineTo(o.X,o.Y),n==r.length-1&&this.Canvas.stroke())}this.DrawExtendLine(r)}if(this.IsShowMaxMinLine&&r.length>1&&this.MaxPoint&&this.MinPoint){var l=this.MaxPoint.High-this.MaxPoint.YValue;for(var n in r){o=r[n];o.Y=this.Frame.GetYFromData(o.YValue+l,!1),0==n?(this.Canvas.beginPath(),this.Canvas.moveTo(o.X,o.Y)):(this.Canvas.lineTo(o.X,o.Y),n==r.length-1&&this.Canvas.stroke())}this.DrawExtendLine(r);var u=this.MinPoint.Low-this.MinPoint.YValue;for(var n in r){o=r[n];o.Y=this.Frame.GetYFromData(o.YValue+u,!1),0==n?(this.Canvas.beginPath(),this.Canvas.moveTo(o.X,o.Y)):(this.Canvas.lineTo(o.X,o.Y),n==r.length-1&&this.Canvas.stroke())}this.DrawExtendLine(r)}},this.DrawExtendLine=function(t){if(this.IsShowExtendLine){var e,a=t[0],i=t[t.length-1];e=i.X>a.X?[a,i]:[i,a];var r=this.CalculateExtendLineEndPoint(e);this.Canvas.beginPath(),this.Canvas.moveTo(i.X,i.Y),this.Canvas.lineTo(r.X,r.Y),this.Canvas.setLineDash(this.ExtendLineDash),this.Canvas.stroke(),this.Canvas.setLineDash([])}}}function gi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawRuler",this.PointCount=2,this.Font=16*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.TitleColor=qi.ChartDrawRuler.TitleColor,this.IsHScreen=!1,this.Draw=function(){this.LinePoint=[];var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.IsHScreen=this.Frame.IsHScreen,this.ClipFrame();var e=t[0],a=t[1],i=this.PointToKLine([e,a]),r=this.Calculate(i),n=sa.IsNumber(r.Increase)?r.Increase.toFixed(2)+"%":"--",o=sa.IsNumber(r.Risefall)?r.Risefall.toFixed(2):"--",s="间距:".concat(r.Count," 涨跌:").concat(o," 涨幅:").concat(n);this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var h={Start:e,End:a};this.LinePoint.push(h),this.DrawPoint(t),this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.font=this.Font,this.TitleColor?this.Canvas.fillStyle=this.TitleColor:sa.IsNumber(r.Increase)?r.Increase>0?this.Canvas.fillStyle=qi.UpTextColor:r.Increase<0?this.Canvas.fillStyle=qi.DownTextColor:this.Canvas.fillStyle=qi.UnchagneTextColor:this.Canvas.fillStyle=qi.UnchagneTextColor;var l=3*F(),u=e.X,C=e.Y;this.IsHScreen?(this.Canvas.translate(u+l,C+l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s,0,0)):this.Canvas.fillText(s,u+l,C-l),this.Canvas.restore()}},this.Calculate=function(t){var e=t[0],a=t[1];e.XValue>a.XValue&&(e=t[1],a=t[0]);for(var i,r,n,o,s,h=this.Frame.Data.Data,l=0,u=e.XValue;u<=a.XValue;++u,++l){var C=h[u];0==l?(o=C.YClose,i=C.Open,s=C.Close,n=C.Low,r=C.High):(s=C.Close,n>C.Low&&(n=C.Low),r<C.High&&(r=C.High))}if(!sa.IsPlusNumber(o)){var D=e.XValue-1;D>=0&&D<h.length&&(o=h[D].Close)}var f={YClose:o,Open:i,High:r,Low:n,Close:s,Count:l};return sa.IsPlusNumber(o)&&(f.Increase=(s-o)/o*100,f.Risefall=s-o),f}}function xi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPriceLine",this.Font=16*F()+"px 微软雅黑",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});if(t&&1==t.length){this.IsHScreen=this.Frame.IsHScreen;var e=t[0],a=this.Frame.ChartBorder;if(this.IsHScreen){var i=a.GetLeftEx(),r=a.GetRightEx();if(e.X<i||e.X>r)return;var n=a.GetBottom(),o={X:e.X,Y:n},s=this.Frame.GetYData(e.X,!1)}else{n=a.GetBottomEx();var h=a.GetTopEx();if(e.Y<h||e.Y>n)return;r=a.GetRight(),o={X:r,Y:e.Y},s=this.Frame.GetYData(e.Y,!1)}this.ClipFrame(),this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(o.X,o.Y),this.Canvas.stroke(),this.RestoreLineWidth();var l={Start:e,End:o};this.LinePoint.push(l),this.DrawPoint(t),this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var u=2*F(),C=e.X,D=e.Y;this.IsHScreen?(this.Canvas.translate(C+u,D+u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s.toFixed(2),0,0)):this.Canvas.fillText(s.toFixed(2),C+u,D-u),this.Canvas.restore()}}}}function Fi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPriceLineV2",this.Font=12*F()+"px 微软雅黑",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.LineWidth=1,this.IsDrawFirst=!0,this.TextColor="rgb(255,255,255)",this.Title,this.TextPosition=[null,0],this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&(t.TextColor&&(this.TextColor=t.TextColor),t.Title&&(this.Title=t.Title),sa.IsNonEmptyArray(t.TextPosition)&&(this.TextPosition=t.TextPosition.slice()))},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});if(t&&1==t.length&&this.IsYValueInFrame(this.Value[0].YValue)){this.IsHScreen=this.Frame.IsHScreen;var e=this.Frame.ChartBorder,a=this.Frame.GetBorder();if(this.IsHScreen){var i=a.LeftEx,r=a.RightEx,n=a.Bottom,o=a.Top,s={X:t[0].X,Y:o};if(s.X<i||s.X>r)return;var h={X:t[0].X,Y:n},l=this.Frame.GetYData(s.X,!1)}else{n=a.BottomEx,o=a.TopTitle,i=a.Left,r=a.Right,s={X:i,Y:t[0].Y};if(s.Y<o||s.Y>n)return;h={X:r,Y:t[0].Y},l=this.Frame.GetYData(s.Y,!1)}this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(s.X),A(s.Y)),this.Canvas.lineTo(A(h.X),A(h.Y)),this.Canvas.stroke(),this.RestoreLineWidth();var u={Start:s,End:h};this.LinePoint.push(u);var C=F();this.Canvas.font=this.Font;var D=2*C,f=h.X,c=h.Y;this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var m=this.GetFontHeight(),d=l.toFixed(2),I=this.Canvas.measureText(d).width+2*D,S=null;if(this.IsHScreen){var T=this.TextPosition[1],v=!1;if(0==T?v=e.Bottom<=10:1==T?v=!0:2==T&&(v=!1),v){c-=I;var p={Left:f-m/2,Top:c,Width:m,Height:I}}else p={Left:f-m/2,Top:c,Width:m,Height:I};if(this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(p.Left,p.Top,p.Width,p.Height),this.Canvas.save(),this.Canvas.translate(f,c+1*C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,0,0),this.Canvas.restore(),this.Title){I=this.Canvas.measureText(this.Title).width+2*C;if(v)var g={Left:p.Left,Top:p.Top-I-1*C,Width:m,Height:I};else g={Left:p.Left,Top:n-I-1*C,Width:m,Height:I};this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(g.Left,g.Top,g.Width,g.Height),this.Canvas.save(),this.Canvas.translate(f,g.Top+1*C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore()}S={X:s.X,Y:s.Y+(h.Y-s.Y)/2}}else{T=this.TextPosition[1],v=!1;if(0==T?v=e.Right<=10:1==T?v=!0:2==T&&(v=!1),v)p={Left:f-I,Top:c-m/2-1*C,Width:I,Height:m};else{p={Left:f,Top:c-m/2-1*C,Width:I,Height:m};p.Left+p.Width>a.ChartWidth&&(p.Left=a.ChartWidth-p.Width-2*C)}if(this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(p.Left,p.Top,p.Width,p.Height),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,p.Left+D,c),this.Title){I=this.Canvas.measureText(this.Title).width+2*C;if(v)g={Left:p.Left-I,Top:p.Top,Width:I,Height:m};else{g={Left:r-I-1*C,Top:p.Top,Width:I,Height:m};p.Left!=r&&(g.Left=p.Left-I-1*C)}this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(g.Left,g.Top,g.Width,g.Height),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(this.Title,g.Left+1*C,c)}S={X:s.X+(h.X-s.X)/2,Y:s.Y}}S&&this.DrawPoint([S])}}},this.DrawPrice=function(){}}function Ei(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawVerticalLine",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow&&this.Frame&&this.Frame.Data){var t=this.Frame.Data,e=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(e&&1==e.length){this.IsHScreen=this.Frame.IsHScreen;var a=e[0],i=this.Frame.ChartBorder;if(this.IsHScreen){var r=Math.round(this.Frame.GetXData(a.Y,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);var n=this.Frame.GetXFromIndex(r-t.DataOffset,!1);n=O(this.LineWidth,n);var o=i.GetLeftEx(),s=i.GetRightEx(),h={X:o,Y:n},l={X:s,Y:n}}else{r=Math.round(this.Frame.GetXData(a.X,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);var u=this.Frame.GetXFromIndex(r-t.DataOffset,!1);u=O(this.LineWidth,u);var C=i.GetTopEx(),D=i.GetBottomEx();h={X:u,Y:C},l={X:u,Y:D}}this.ClipFrame(),this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(h.X,h.Y),this.Canvas.lineTo(l.X,l.Y),this.Canvas.stroke(),this.RestoreLineWidth();var f={Start:h,End:l};this.LinePoint.push(f),10==this.Status&&this.DrawPoint(e),this.Canvas.restore()}}}}function Li(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawCrosshair",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow&&this.Frame&&this.Frame.Data){var t=this.Frame.Data,e=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!1});if(e&&1==e.length){this.IsHScreen=this.Frame.IsHScreen;var a=e[0],i=(this.Frame.ChartBorder,this.Frame.GetBorder());if(this.IsHScreen){var r=Math.round(this.Frame.GetXData(a.Y,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);var n=this.Frame.GetXFromIndex(r-t.DataOffset,!1);n=O(this.LineWidth,n);var o=O(this.LineWidth,a.X),s=i.LeftEx,h=i.RightEx,l=i.Top,u=i.Bottom,C={X:s,Y:n},D={X:h,Y:n},f={X:o,Y:l},c={X:o,Y:u}}else{r=Math.round(this.Frame.GetXData(a.X,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);o=this.Frame.GetXFromIndex(r-t.DataOffset,!1);o=O(this.LineWidth,o);n=O(this.LineWidth,a.Y),l=i.TopEx,u=i.BottomEx,s=i.Left,h=i.Right,C={X:o,Y:l},D={X:o,Y:u},f={X:s,Y:n},c={X:h,Y:n}}this.ClipFrame(),this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(C.X,C.Y),this.Canvas.lineTo(D.X,D.Y),this.Canvas.moveTo(f.X,f.Y),this.Canvas.lineTo(c.X,c.Y),this.Canvas.stroke(),this.RestoreLineWidth();var m={Start:C,End:D},d={Start:f,End:c};this.LinePoint.push(m),this.LinePoint.push(d),10==this.Status&&this.DrawPoint(e),this.Canvas.restore()}}}}function Mi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawMonitorLine",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.GetXYCoordinate=this.GetXYCoordinate_default,this.FormatLabelTextCallback=null,this.LineColor="rgb(255,215,0)",this.LabelConfig={Font:"".concat(12*F(),"px 微软雅黑"),BGColor:"rgb(30,144,255)",LineColor:"rgba(255,215,0,0.8)",LineDash:[3,5],Mergin:{Left:5,Right:5,Top:5,Bottom:4},LineSpace:5,TextAlign:1},this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){if(!this.PointToValue_Backup())return!1;if(this.Frame.IsKLineFrame(!1)&&0===this.Frame.Identify){var t=this.Value[0].XValue,e=this.Frame.Data,a=e.Data[t];this.Value[0].YValue=a.Close}return!0},this.SetOption=function(t){if(t.LineColor&&(this.LineColor=t.LineColor),t.Label){var e=t.Label,a=this.LabelConfig;e.Font&&(a.Font=e.Font),e.BGColor&&(a.BGColor=e.BGColor),e.LineColor&&(a.LineColor=e.LineColor),e.LineDash&&(a.LineDash=e.LineDash),sa.IsNumber(e.LineSpace)&&(a.LineSpace=e.LineSpace),sa.IsNumber(e.TextAlign)&&(a.TextAlign=e.TextAlign),e.Mergin&&G(a.Mergin,e.Mergin)}t.FormatLabelTextCallback&&(this.FormatLabelTextCallback=t.FormatLabelTextCallback)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow&&this.Frame&&this.Frame.Data){var t=this.Frame.Data;sa.IsNonEmptyArray(t.Data)&&1==this.Point.length&&1==this.Value.length&&(this.IsHScreen=this.Frame.IsHScreen,this.IsHScreen||(20==this.Status?this.DrawMoveLine():10==this.Status&&this.DrawMonitorLine(t)))}},this.DrawMoveLine=function(){var t=this.Frame.ChartBorder.GetBorder(),e=this.Point[0],a=A(e.X);this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(a,t.TopEx),this.Canvas.lineTo(a,t.BottomEx),this.Canvas.stroke(),this.Canvas.restore()},this.DrawMonitorLine=function(t){var e=this.Frame.IsMinuteFrame(),a=this.Frame.DataWidth,i=this.Frame.DistanceWidth,r=this.Frame.XPointCount;if(this.IsHScreen);else var n=this.Frame.ChartBorder.GetBorder(),o=n.LeftEx+i/2+qi.FrameLeftMargin,s=n.RightEx;var h=this.Value[0];this.ClipFrame();for(var l=null,u=t.DataOffset,C=0;u<t.Data.length&&C<r;++u,++C,o+=a+i){t.Data[u];if(e)var D=this.Frame.GetXFromIndex(C);else{var f=o,c=o+a;if(c>s)break;D=f+(c-f)/2}if(u==h.XValue){this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(D,n.TopEx),this.Canvas.lineTo(D,n.BottomEx),this.Canvas.stroke();var m={Start:{X:D,Y:n.TopEx},End:{X:D,Y:n.BottomEx}};this.LinePoint.push(m)}else u==t.Data.length-1&&(this.LabelConfig.LineDash&&this.Canvas.setLineDash(this.LabelConfig.LineDash),this.Canvas.strokeStyle=this.LabelConfig.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(D,n.TopEx),this.Canvas.lineTo(D,n.BottomEx),this.Canvas.stroke(),this.LabelConfig.LineDash&&this.Canvas.setLineDash([]),l={Left:c,Data:t,StartIndex:h.XValue,AryText:[]})}this.Canvas.restore(),l&&this.DrawLabel(l)},this.DrawLabel=function(t){if(this.FormatLabelTextCallback&&(t.Config=this.LabelConfig,this.FormatLabelTextCallback(t),sa.IsNonEmptyArray(t.AryText)&&sa.IsNumber(t.YValue))){this.CalculateLabelSize(t);var e=this.Frame.GetYFromData(t.YValue,!1),a={Left:t.Left+1,Top:e,Width:t.Width,Height:t.Height};a.Right=a.Left+a.Width,a.Bottom=a.Top+a.Height,this.DrawDefaultLabel(t,a)}}}function yi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawWaveRuler",this.PointCount=3,this.Font=16*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.LastPoint,this.LinePoint,this.ScaleRuler=qi.ChartDrawWaveRuler.ScaleRuler,this.RulerWidth=qi.ChartDrawWaveRuler.RulerWidth,this.RulerLineWidth=qi.ChartDrawWaveRuler.RulerLineWidth,this.MaxScaleRuler=qi.ChartDrawWaveRuler.MaxScaleRuler,this.Font=qi.ChartDrawWaveRuler.MaxScaleRuler,this.IsHScreen=!1,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.IsHScreen=this.Frame.IsHScreen,this.CalculateLines(t),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}3==t.length&&this.DrawWaveRuler(t),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new V;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a={Start:{X:t[0].X,Y:t[0].Y},End:{X:t[1].X,Y:t[1].Y}};this.LinePoint.push(a)}else if(3==t.length){a={Start:{X:t[0].X,Y:t[0].Y},End:{X:t[1].X,Y:t[1].Y}};this.LinePoint.push(a),a={Start:{X:t[1].X,Y:t[1].Y},End:{X:t[2].X,Y:t[2].Y}},this.LinePoint.push(a)}},this.DrawWaveRuler=function(t){var e=t[1],a=t[0],i=t[2],r=this.RulerLineWidth*F();this.Canvas.lineWidth=r,this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var n=this.RulerWidth*F();if(this.IsHScreen){var o=a.X-e.X,s={X:i.X-this.MaxScaleRuler*o,Y:i.Y};this.DrawLine(i,s),this.LinePoint.push({Start:i,End:s});var h=i.Y-n/2,l=i.Y+n/2}else{o=a.Y-e.Y,s={X:O(r,i.X),Y:i.Y-this.MaxScaleRuler*o};this.DrawLine({X:O(r,i.X),Y:i.Y},s),this.LinePoint.push({Start:i,End:s});var u=i.X-n/2,C=i.X+n/2}var D=4*F();for(var f in this.ScaleRuler){var c=this.ScaleRuler[f];if(this.IsHScreen){u=i.X-c.Value*o;var m=this.Frame.GetYData(u,!1);this.DrawLine({X:u,Y:h},{X:u,Y:l});var d="".concat(m.toFixed(2),"  ").concat(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.save(),this.Canvas.translate(u,i.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(d,D,0),this.Canvas.restore()}else{h=i.Y-c.Value*o,m=this.Frame.GetYData(h,!1);this.DrawLine({X:u,Y:O(r,h)},{X:C,Y:O(r,h)});d="".concat(m.toFixed(2),"  ").concat(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.fillText(d,C+D,h)}}}}function Ri(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawWaveRuler2Point",this.PointCount=2,this.Font=14*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointRate=[510,517,511.4],this.LinePoint,this.CPoint,this.ScaleRuler=qi.ChartDrawWaveRuler2Point.ScaleRuler,this.RulerWidth=qi.ChartDrawWaveRuler2Point.RulerWidth,this.RulerLineWidth=qi.ChartDrawWaveRuler2Point.RulerLineWidth,this.MaxScaleRuler=qi.ChartDrawWaveRuler2Point.MaxScaleRuler,this.Font=qi.ChartDrawWaveRuler2Point.MaxScaleRuler,this.IsHScreen=!1,this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&t.PointRate&&(this.PointRate=t.PointRate)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.IsHScreen=this.Frame.IsHScreen,this.CalculateLines(t),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}var i=[t[0],t[1],this.CPoint];this.DrawWaveRuler(i),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.CalculateLines=function(t){var e={Start:{X:t[0].X,Y:t[0].Y},End:{X:t[1].X,Y:t[1].Y}};this.LinePoint.push(e);var a=t[0].Y,i=t[1].Y,r=this.PointRate[1]-this.PointRate[0],n=this.PointRate[2]-this.PointRate[0],o=a-(a-i)*n/r;this.CPoint={X:t[1].X,Y:o}},this.DrawWaveRuler=function(t){var e=t[1],a=t[0],i=t[2],r=this.RulerLineWidth*F();this.Canvas.lineWidth=r,this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var n=this.RulerWidth*F();if(this.IsHScreen){var o=a.X-e.X,s={X:i.X-this.MaxScaleRuler*o,Y:i.Y};this.DrawLine(i,s),this.LinePoint.push({Start:i,End:s});var h=i.Y-n/2,l=i.Y+n/2}else{o=a.Y-e.Y,s={X:O(r,i.X),Y:i.Y-this.MaxScaleRuler*o};this.DrawLine({X:O(r,i.X),Y:i.Y},s),this.LinePoint.push({Start:i,End:s});var u=i.X,C=i.X+n}var D=4*F();for(var f in this.ScaleRuler){var c=this.ScaleRuler[f];if(this.IsHScreen){u=i.X-c.Value*o;var m=this.Frame.GetYData(u,!1);this.DrawLine({X:u,Y:h},{X:u,Y:l});var d="".concat(m.toFixed(2),"  ").concat(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.save(),this.Canvas.translate(u,i.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(d,D,0),this.Canvas.restore()}else{h=i.Y-c.Value*o,m=this.Frame.GetYData(h,!1);this.DrawLine({X:u,Y:O(r,h)},{X:C,Y:O(r,h)});d="".concat(m.toFixed(2),"  ").concat(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.fillText(d,C+D,h)}}}}function Ni(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawBox",this.PointCount=2,this.Font=16*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.AvPriceLineDash=[5*F(),5*F()],this.KLineBorder,this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.Point[0]={X:this.KLineBorder.Left,Y:this.KLineBorder.Top},this.Point[1]={X:this.KLineBorder.Right,Y:this.KLineBorder.Bottom},this.PointToValue_Backup()},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.IsHScreen=this.Frame.IsHScreen,this.ClipFrame();var e=t[0],a=t[1],i=this.PointToKLine([e,a]);u.Chart.Log("[ChartDrawBox::Draw] kPoint",i);var r=this.Calculate(i);u.Chart.Log("[ChartDrawBox::Draw] kDataInfo",r);var n,o=this.GetKLineBorder(t,r);if(this.KLineBorder=o,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(b(o.Left),b(o.Top),b(o.Right-o.Left),b(o.Bottom-o.Top)),r.Amount>0&&r.Vol>0){var s=r.Amount/r.Vol;if(n="均价".concat(s.toFixed(2)),this.Canvas.beginPath(),this.IsHScreen){var h=this.Frame.GetYFromData(s,!1);this.Canvas.moveTo(O(this.Canvas.lineWidth,h),o.Top),this.Canvas.lineTo(O(this.Canvas.lineWidth,h),o.Bottom)}else{var l=this.Frame.GetYFromData(s,!1);this.Canvas.moveTo(o.Left,O(this.Canvas.lineWidth,l)),this.Canvas.lineTo(o.Right,O(this.Canvas.lineWidth,l))}this.Canvas.setLineDash(this.AvPriceLineDash),this.Canvas.stroke(),this.Canvas.setLineDash([])}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font,this.Canvas.fillStyle=this.LineColor;var C=2*F(),D="K线数".concat(r.Count);this.IsHScreen?this.DrawText(D,o.Right,o.Top,C,C):this.DrawText(D,o.Left,o.Top,C,C),n&&(this.IsHScreen?this.DrawText(n,h,o.Top,C,C):this.DrawText(n,o.Left,l,C,C));var f=sa.IsNumber(r.YClose)?r.YClose:r.Open,c=(r.Close-f)/f*100;D="".concat(c.toFixed(2),"%"),this.IsHScreen?this.DrawText(D,o.Right,o.Bottom,C,C):this.DrawText(D,o.Right,o.Top,C,C),c=r.Close-f,D="".concat(c.toFixed(2)),this.Canvas.textBaseline="bottom",this.IsHScreen?this.DrawText(D,o.Left,o.Bottom,C,0):this.DrawText(D,o.Right,o.Bottom,C,0),this.Canvas.restore()}}},this.Calculate=function(t){var e=t[0],a=t[1];e.XValue>a.XValue&&(e=t[1],a=t[0]);for(var i,r,n,o,s,h=this.Frame.Data.Data,l=0,u=0,C=0,D=e.XValue;D<=a.XValue;++D,++C){var f=h[D];0==C?(o=f.YClose,i=f.Open,s=f.Close,n=f.Low,r=f.High):(s=f.Close,n>f.Low&&(n=f.Low),r<f.High&&(r=f.High)),l+=f.Vol,u+=f.Amount}var c={YClose:o,Open:i,High:r,Low:n,Close:s,Count:C,Vol:l,Amount:u};return c},this.GetKLineBorder=function(t,e){var a=t[0],i=t[1],r=this.Frame.Data;if(this.IsHScreen){var n=Math.round(this.Frame.GetXData(a.Y,!1))+r.DataOffset;n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var o=this.Frame.GetXFromIndex(n-r.DataOffset,!1);n=Math.round(this.Frame.GetXData(i.Y,!1))+r.DataOffset,n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var s=this.Frame.GetXFromIndex(n-r.DataOffset,!1),h=this.Frame.GetYFromData(e.High,!1),l=this.Frame.GetYFromData(e.Low,!1),u={Left:l,Top:o,Right:h,Bottom:s};return this.LinePoint.push({Start:{X:l,Y:o},End:{X:s,Y:o}}),this.LinePoint.push({Start:{X:l,Y:s},End:{X:s,Y:s}}),this.LinePoint.push({Start:{X:l,Y:o},End:{X:l,Y:s}}),this.LinePoint.push({Start:{X:h,Y:o},End:{X:h,Y:s}}),u}n=Math.round(this.Frame.GetXData(a.X,!1))+r.DataOffset;n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var C=this.Frame.GetXFromIndex(n-r.DataOffset,!1);n=Math.round(this.Frame.GetXData(i.X,!1))+r.DataOffset,n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var D=this.Frame.GetXFromIndex(n-r.DataOffset,!1),f=this.Frame.GetYFromData(e.High,!1),c=this.Frame.GetYFromData(e.Low,!1);u={Left:C,Top:f,Right:D,Bottom:c};return this.LinePoint.push({Start:{X:C,Y:f},End:{X:D,Y:f}}),this.LinePoint.push({Start:{X:C,Y:c},End:{X:D,Y:c}}),this.LinePoint.push({Start:{X:C,Y:f},End:{X:C,Y:c}}),this.LinePoint.push({Start:{X:D,Y:f},End:{X:D,Y:c}}),u},this.DrawText=function(t,e,a,i,r){this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(e,a),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,i,r),this.Canvas.restore()):this.Canvas.fillText(t,e+i,a+r)}}function wi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawTwoPointDemo",this.PointCount=2,this.Font=16*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.PointInfo=[],this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.OnFinish(),this.PointToValue_Backup()},this.OnFinish=function(){for(var t in this.PointInfo){var e=this.PointInfo[t];e&&e.Point&&sa.IsNumber(e.Point.Y2)&&(this.Point[t].Y=this.PointInfo[t].Point.Y2)}},this.Draw=function(){if(this.LinePoint=[],this.PointInfo=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.IsHScreen=this.Frame.IsHScreen,this.ClipFrame(),this.SetLineWidth();t[0],t[1];if(this.CalculatePointInfo(t),10==this.Status)this.DrawEx();else for(var e=1;e<t.length;++e)this.DrawLine(t[e-1],t[e]);this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.CalculatePointInfo=function(t){if(this.Frame&&this.Frame.Data){var e=this.PointToKLine(t);if(3==this.PointCount&&2==this.PointStatus&&this.LastPoint){var a=new V;a.X=this.LastPoint.X,a.Y=this.LastPoint.Y,t[2]=a}var i=this.Frame.Data;for(var r in e){var n=e[r],o=(a=t[r],i.Data[n.XValue]),s={KItem:o,Data:n,Point:{X:a.X,Y:a.Y}};this.PointInfo.push(s)}this.CalculateYPoint(),u.Chart.Log("[ChartDrawTwoPointDemo::CalculateLines] kPoint",this.PointInfo)}},this.CalculateYPoint=function(){var t=this.PointInfo[0],e=this.Frame.GetYFromData(t.KItem.Low,!1);t.Point.Y2=e;var a=this.PointInfo[1],i=this.Frame.GetYFromData(a.KItem.High,!1);a.Point.Y2=i},this.DrawEx=function(){var t=this.PointInfo[0],e=this.PointInfo[1],a=this.Frame.ChartBorder,i=(a.GetRight(),{X:t.Point.X,Y:t.Point.Y2}),r={X:e.Point.X,Y:e.Point.Y2};this.DrawLine(i,r),this.LinePoint.push({Start:i,End:r}),this.Canvas.setLineDash([5,5]);var n=.09*e.KItem.YClose+e.KItem.High,o=this.Frame.GetYFromData(n,!1);this.DrawLine({X:this.ToFixedPoint(r.X),Y:r.Y},{X:this.ToFixedPoint(r.X),Y:o}),this.Canvas.textAlign="right",this.Canvas.textBaseline="center",this.Canvas.fillStyle="rgb(33,45,100)";for(var s=3;s>0;--s){var h=e.KItem.YClose*(.03*s)+e.KItem.High;o=this.Frame.GetYFromData(h,!1);o=this.ToFixedPoint(o),this.DrawLine({X:r.X,Y:o},{X:r.X+100,Y:o}),this.Canvas.fillText(h.toFixed(2),r.X-5,o)}this.Canvas.setLineDash([])},this.ToFixedPoint=function(t,e){return sa.IsNumber(e)||(e=this.LineWidth),O(e,t)}}function Ai(){this.newMethod=wi,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawThreePointDemo",this.PointCount=3,this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateYPoint=function(){var t;for(var e in this.PointInfo){var a=this.PointInfo[e];t=0==e||2==e?this.Frame.GetYFromData(a.KItem.Low,!1):this.Frame.GetYFromData(a.KItem.High,!1),a.Point.Y2=t}},this.DrawEx=function(){var t=this.PointInfo[0],e=this.PointInfo[1],a=this.PointInfo[2],i=this.Frame.ChartBorder,r=(i.GetRight(),i.GetLeft(),{X:t.Point.X,Y:t.Point.Y2}),n={X:e.Point.X,Y:e.Point.Y2},o={X:a.Point.X,Y:a.Point.Y2};this.DrawLine(r,n),this.DrawLine(n,o),this.LinePoint.push({Start:r,End:n}),this.LinePoint.push({Start:n,End:o}),this.Canvas.setLineDash([5,5]);var s=.09*a.KItem.YClose+a.KItem.High,h=this.Frame.GetYFromData(s,!1);this.DrawLine({X:this.ToFixedPoint(o.X),Y:o.Y},{X:this.ToFixedPoint(o.X),Y:h}),this.Canvas.textAlign="right",this.Canvas.textBaseline="center",this.Canvas.fillStyle="rgb(33,45,100)";for(var l=3;l>0;--l){var u=a.KItem.YClose*(.03*l)+a.KItem.High;h=this.Frame.GetYFromData(u,!1);h=this.ToFixedPoint(h),this.DrawLine({X:o.X,Y:h},{X:o.X+100,Y:h}),this.Canvas.fillText(u.toFixed(2),o.X-5,h)}this.Canvas.setLineDash([])}}function Oi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawHLineSegment",this.PointCount=2,this.IsPointIn=this.IsPointIn_XYValue_Line,this.ChartBorder,this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.Frame.IsHScreen?this.Point[1].X=this.Point[0].X:this.Point[1].Y=this.Point[0].Y,this.PointToValue_Backup()},this.GetXYCoordinate=function(){if(this.IsFrameMinSize())return null;var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});return this.PointRange(t)},this.Draw=function(){if(this.Frame&&(this.IsHScreen=this.Frame.IsHScreen,this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow)){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame(),this.ChartBorder=this.Frame.ChartBorder,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor;var e=t[0],a=t[1];10==this.Status?this.DrawLine(e,a,!1):this.DrawVerticalLine(e,a),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawVerticalLine=function(t,e){var a=this.Frame.Data;if(this.IsHScreen){var i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetRight(),n=Math.round(this.Frame.GetXData(t.Y,!1))+a.DataOffset;n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var o=this.Frame.GetXFromIndex(n-a.DataOffset,!1);n=Math.round(this.Frame.GetXData(e.Y,!1))+a.DataOffset,n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var s=this.Frame.GetXFromIndex(n-a.DataOffset,!1);this.Canvas.beginPath(),this.Canvas.moveTo(i,o),this.Canvas.lineTo(r,o),this.Canvas.moveTo(i,s),this.Canvas.lineTo(r,s),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.moveTo(t.X,o),this.Canvas.lineTo(t.X,s),this.Canvas.stroke()}else{var h=this.ChartBorder.GetTopEx(),l=this.ChartBorder.GetBottomEx();n=Math.round(this.Frame.GetXData(t.X,!1))+a.DataOffset;n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var u=this.Frame.GetXFromIndex(n-a.DataOffset,!1);n=Math.round(this.Frame.GetXData(e.X,!1))+a.DataOffset,n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var C=this.Frame.GetXFromIndex(n-a.DataOffset,!1);this.Canvas.beginPath(),this.Canvas.moveTo(u,h),this.Canvas.lineTo(u,l),this.Canvas.moveTo(C,h),this.Canvas.lineTo(C,l),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.moveTo(u,t.Y),this.Canvas.lineTo(C,t.Y),this.Canvas.stroke()}}}function bi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawVolProfile",this.PointCount=2,this.IsPointIn=this.IsPointIn_XYValue_Line,this.ChartBorder,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsShowText=!0,this.VolType=0,this.BarPosition=0,this.VolFont,this.VAVol=60,this.BarWidthRate=.3,this.Data,this.MaxVol,this.MaxVolPrice,this.DataStatus=0,this.BGColor=qi.ChartDrawVolProfile.BGColor,this.BorderColor=qi.ChartDrawVolProfile.BorderColor,this.VolLineColor=qi.ChartDrawVolProfile.VolLineColor,this.TextConfig=(0,h.default)({Color:qi.ChartDrawVolProfile.Text.Color,Family:qi.ChartDrawVolProfile.Text.Family,FontMaxSize:qi.ChartDrawVolProfile.Text.FontMaxSize,FontMinSize:qi.ChartDrawVolProfile.Text.FontMinSize},"Color",qi.ChartDrawVolProfile.Text.Color),this.BarColor=[qi.ChartDrawVolProfile.UpVolColor,qi.ChartDrawVolProfile.DownVolColor,qi.ChartDrawVolProfile.AreaUpColor,qi.ChartDrawVolProfile.AreaDonwColor],this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&(t.BGColor&&(this.BGColor=t.BGColor),t.BorderColor&&(this.BGColor=t.BorderColor),t.VolLineColor&&(this.BGColor=t.VolLineColor),t.UpVolColor&&(this.BarColor[0]=t.UpVolColor),t.DownVolColor&&(this.BarColor[1]=t.DownVolColor),t.AreaUpColor&&(this.BarColor[2]=t.AreaUpColor),t.AreaDonwColor&&(this.BarColor[3]=t.AreaDonwColor),sa.IsNumber(t.BarWidthRate)&&(this.BarWidthRate=t.BarWidthRate),sa.IsBool(t.IsShowText)&&(this.IsShowText=t.IsShowText),sa.IsNumber(t.VolType)&&(this.VolType=t.VolType),sa.IsNumber(t.BarPosition)&&(this.BarPosition=t.BarPosition),sa.IsNumber(t.VAVol)&&(this.VAVol=t.VAVol))},this.OnFinish=function(){this.RequestVolumeProfileData()},this.OnMoveFinish=function(){this.RequestVolumeProfileData()},this.IsDrawMain=function(){if(!this.GetActiveDrawPicture)return!0;var t=this.GetActiveDrawPicture();return t.Select.Guid!=this.Guid},this.RequestVolumeProfileData=function(){var t=this.Value[0],e=this.Value[1];t.XValue>e.XValue&&(t=this.Value[1],e=this.Value[0]);var a={Start:{Date:t.DateTime.Date,DataIndex:t.XValue},End:{Date:e.DateTime.Date,DataIndex:e.XValue},Chart:this};sa.IsNumber(t.DateTime.Time)&&(a.Start.Time=t.DateTime.Time),sa.IsNumber(e.DateTime.Time)&&(a.End.Time=e.DateTime.Time),a.ValueAreaVol=this.VAVol,this.DataStatus=0,this.HQChart&&this.HQChart.RequestVolumeProfileData&&this.HQChart.RequestVolumeProfileData(a)},this.OnRecvVolumeProfileData=function(t){if(t&&sa.IsNonEmptyArray(t.Data)){for(var e=0,a=0,i=null,r=0,n=0;r<t.Data.length;++r){var o=t.Data[r];for(a=0,n=0;n<o.Vol.length;++n){var s=o.Vol[n];sa.IsNumber(s.Value)&&(a+=s.Value)}e<a&&(e=a,i=o.Price)}if(this.MaxVolPrice=i,this.MaxVol=e,!(this.MaxVolPrice<=0||this.MaxVol<=0)&&sa.IsNumber(t.MaxPrice)&&sa.IsNumber(t.MinPrice)){var h=this.Frame.GetYFromData(t.MaxPrice,!1),l=this.Frame.GetYFromData(t.MinPrice,!1);this.Point[0].Y=h,this.Point[1].Y=l,this.PointToValue(),this.Data=t,this.DataStatus=1}}},this.Draw=function(){if(this.VolFont=null,this.IsDrawMain()||this.MainDraw(),!this.IsFrameMinSize()){this.Frame&&(this.ChartBorder=this.Frame.ChartBorder);var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame(),this.SetLineWidth();var e=t[0],a=t[1];10==this.Status?0==this.DataStatus&&this.DrawLineBorder(e,a):this.DrawLineBorder(e,a),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.MainDraw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&1==this.DataStatus&&10==this.Status){this.ClipFrame();this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});this.DrawVolBar(),this.Canvas.restore()}},this.DrawLineBorder=function(t,e){this.Canvas.strokeStyle=this.LineColor;var a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetBottomEx();this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.moveTo(t.X,a),this.Canvas.lineTo(t.X,i),this.Canvas.moveTo(e.X,a),this.Canvas.lineTo(e.X,i),this.Canvas.stroke()},this.DrawVolBar=function(){var t=this.Value[0],e=this.Value[1];t.XValue>e.XValue&&(t=this.Value[1],e=this.Value[0]);var a=this.GetKDataOffset(),i=this.GetPriceYOffset(this.Data.PriceOffset),r=this.Frame.GetXFromIndex(t.XValue-a,!1),n=this.Frame.GetXFromIndex(e.XValue-a,!1),o=this.Frame.GetYFromData(this.Data.MaxPrice)-i/2,s=this.Frame.GetYFromData(this.Data.MinPrice)+i/2,h=n-r,l=s-o,u=h*this.BarWidthRate;if(this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(r,o,h,l),this.MaxVolPrice>=this.Frame.HorizontalMin&&this.MaxVolPrice<=this.Frame.HorizontalMax){var C=O(2,this.Frame.GetYFromData(this.MaxVolPrice,!1));this.Canvas.lineWidth=2,this.Canvas.strokeStyle=this.VolLineColor,this.Canvas.beginPath(),this.Canvas.moveTo(r,C),this.Canvas.lineTo(n,C),this.Canvas.stroke();var D={Start:{X:r,Y:C},End:{X:n,Y:C}};this.LinePoint.push(D)}this.IsShowText&&(this.VolFont=this.GetDynamicVolTextFont(i,u),this.VolFont&&(this.Canvas.font=this.VolFont));for(var f=0;f<this.Data.Data.length;++f){var c=this.Data.Data[f];c.Price<this.Frame.HorizontalMin||c.Price>this.Frame.HorizontalMax||this.DrawVolBarItem(c,r,n,u,i)}},this.DrawVolBarItem=function(t,e,a,i,r){var n=e,o=a,s=this.Frame.GetYFromData(t.Price)-r/2,h=r-1;if(h<1&&(h=1),1==this.VolType){if(!t.TotalVol)return;if(!sa.IsNumber(t.TotalVol.Value))return;var l=t.TotalVol.Value*i/this.MaxVol;if(sa.IsNumber(t.TotalVol.ColorID)?D=this.BarColor[t.TotalVol.ColorID]:t.TotalVol.Color&&(D=t.TotalVol.Color),this.Canvas.fillStyle=D,1==this.BarPosition?this.Canvas.fillRect(o,b(s),-l,b(h)):this.Canvas.fillRect(n,b(s),l,b(h)),this.IsShowText&&this.VolFont){var u=sa.FormatVolString(t.TotalVol.Value,this.HQChart.LanguageID);this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,s+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,s+r/2))}}else{u="";for(var C=0;C<t.Vol.length;++C){var D,f=t.Vol[C];if(sa.IsNumber(f.Value))if(sa.IsNumber(f.ColorID)?D=this.BarColor[f.ColorID]:f.Color&&(D=f.Color),D){l=f.Value*i/this.MaxVol;this.Canvas.fillStyle=D,1==this.BarPosition?(this.Canvas.fillRect(o,b(s),-l,b(h)),o-=l):(this.Canvas.fillRect(n,b(s),l,b(h)),n+=l);var c=sa.FormatVolString(f.Value,this.HQChart.LanguageID);u.length>0&&(u+="x"),u+=c}}this.IsShowText&&this.VolFont&&(this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,s+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,s+r/2)))}},this.GetKDataOffset=function(){var t=this.HQChart.ChartPaint[0].Data;return t.DataOffset},this.GetPriceYOffset=function(t){var e=this.Frame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a},this.GetDynamicVolTextFont=function(t,e,a){var i=parseInt(t)-2;if(t<5&&(i=parseInt(t)),i>this.TextConfig.FontMaxSize?i=this.TextConfig.FontMaxSize:i<=0&&(i=1),i<this.TextConfig.FontMinSize)return null;var r=this.FormatFontString(i,this.TextConfig.Family,a);return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i="".concat(a.Weight," ").concat(t,"px ").concat(e)):i="".concat(t,"px ").concat(e),i}}function Bi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawNote",this.PointCount=1,this.Text=qi.ChartDrawNote.Text,this.FontOption={Family:qi.ChartDrawNote.FontOption.Family,Size:qi.ChartDrawNote.FontOption.Size},this.AryNoteText=[{Text:"输入内容 ......"}],this.NoteFontOption={Family:qi.ChartDrawNote.NoteFontOption.Family,Size:qi.ChartDrawNote.NoteFontOption.Size,Weight:qi.ChartDrawNote.NoteFontOption.Weight,Style:qi.ChartDrawNote.NoteFontOption.Style},this.NoteWidth=qi.ChartDrawNote.NoteWidth,this.NoteMargin={Left:qi.ChartDrawNote.NoteMargin.Left,Top:qi.ChartDrawNote.NoteMargin.Top,Bottom:qi.ChartDrawNote.NoteMargin.Bottom,Right:qi.ChartDrawNote.NoteMargin.Right},this.NoteBGColor=qi.ChartDrawNote.NoteBGColor,this.NoteTextColor=qi.ChartDrawNote.NoteTextColor,this.NoteBorderColor=qi.ChartDrawNote.NoteBorderColor,this.LineSpace=qi.ChartDrawNote.LineSpace,this.ArrowSize=qi.ChartDrawNote.ArrowSize,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!1,this.PtButtom,this.PtTop,this.TextRect=null,this.PtCenter,this.SetOption_Backup=this.SetOption,this.SetOption=function(t){if(this.SetOption_Backup(t),t){if(t.Text&&(this.Text=t.Text),t.FontOption&&this.SetFont(this.FontOption,t.FontOption),t.NoteFontOption&&this.SetFont(this.NoteFontOption,t.NoteFontOption),sa.IsNumber(t.NoteWidth)&&(this.NoteWidth=t.NoteWidth),t.NoteMargin){var e=t.NoteMargin;sa.IsNumber(e.Left)&&(this.NoteMargin.Left=e.Left),sa.IsNumber(e.Top)&&(this.NoteMargin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.NoteMargin.Bottom=e.Bottom),sa.IsNumber(e.Right)&&(this.NoteMargin.Right=e.Right)}t.NoteBGColor&&(this.NoteBGColor=t.NoteBGColor),t.NoteTextColor&&(this.NoteTextColor=t.NoteTextColor),t.NoteBorderColor&&(this.NoteBorderColor=t.NoteBorderColor),sa.IsNumber(t.LineSpace)&&(this.LineSpace=t.LineSpace),sa.IsNumber(t.ArrowSize)&&(this.ArrowSize=t.ArrowSize),sa.IsNonEmptyArray(t.AryNoteText)&&(this.AryNoteText=this.CloneArrayText(t.AryNoteText))}},this.ExportStorageData=function(){var t=this.ExportBaseData();if(t.Value=[],this.Value&&this.Value[0]){var e=this.Value[0];t.Value.push({XValue:e.XValue,YValue:e.YValue,DateTime:e.DateTime})}return t.NoteFont=this.NoteFont,t.NoteWidth=this.NoteWidth,t.NoteBGColor=this.NoteBGColor,t.NoteTextColor=this.NoteTextColor,t.NoteBorderColor=this.NoteBorderColor,t.LineSpace=this.LineSpace,t.ArrowSize=this.ArrowSize,t.NoteMargin={Left:this.NoteMargin.Left,Top:this.NoteMargin.Right,Bottom:this.NoteMargin.Bottom,Right:this.NoteMargin.Right},t.AryNoteText=this.CloneArrayText(this.AryNoteText),t},this.ImportStorageData=function(t){if(t.NoteFont&&(this.NoteFont=t.NoteFont),sa.IsNumber(t.NoteWidth)&&(this.NoteWidth=t.NoteWidth),t.NoteMargin){var e=t.NoteMargin;sa.IsNumber(e.Left)&&(this.NoteMargin.Left=e.Left),sa.IsNumber(e.Top)&&(this.NoteMargin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.NoteMargin.Bottom=e.Bottom),sa.IsNumber(e.Right)&&(this.NoteMargin.Right=e.Right)}t.NoteBGColor&&(this.NoteBGColor=t.NoteBGColor),t.NoteTextColor&&(this.NoteTextColor=t.NoteTextColor),this.NoteBorderColor=t.NoteBorderColor,sa.IsNumber(t.LineSpace)&&(this.LineSpace=t.LineSpace),sa.IsNumber(t.ArrowSize)&&(this.ArrowSize=t.ArrowSize),this.AryNoteText=this.CloneArrayText(t.AryNoteText)},this.Draw=function(){if(this.PtButtom=null,this.PtTop=null,this.TextRect=null,this.PtCenter=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&1==t.length){var e=this.GetTextFont();if(e){this.ClipFrame();var a=this.Frame.IsHScreen,i=F();if(this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.font=e,a){this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Text,0,0),this.PtButtom={X:t[0].X,Y:t[0].Y+this.FontOption.Size*i/2+2},this.PtTop={X:t[0].X,Y:t[0].Y-this.FontOption.Size*i/2-2},this.PtCenter=t[0];var r={X:t[0].X-this.FontOption.Size*i/2-2,Y:t[0].Y}}else{this.Canvas.fillText(this.Text,t[0].X,t[0].Y),this.PtButtom={X:t[0].X,Y:t[0].Y+this.FontOption.Size*i/2+2},this.PtTop={X:t[0].X,Y:t[0].Y-this.FontOption.Size*i/2-2};r={X:this.PtButtom.X,Y:this.PtButtom.Y}}var n=this.Canvas.measureText(this.Text).width;this.TextRect={},this.TextRect.Left=t[0].X-n/2,this.TextRect.Top=t[0].Y-this.FontOption.Size*i/2,this.TextRect.Width=n,this.TextRect.Height=this.FontOption.Size*i,this.IsShowNoteText()&&this.DrawText(),this.Canvas.restore(),this.DrawPoint([r])}}}},this.DrawText=function(){this.Canvas.font=this.GetFontString(this.NoteFontOption);var t=0,e=this.Canvas.measureText("擎").width,a=this.Frame.GetBorder(),i=F(),r=this.Frame.IsHScreen,n=this.NoteWidth,o=[];if(sa.IsNonEmptyArray(this.AryNoteText))for(var s=0;s<this.AryNoteText.length;++s){var h=this.AryNoteText[s];if(h)if(t>0&&(t+=this.LineSpace),h.Text){var l=this.GetMultiLineText(h.Text,n);if(l&&sa.IsNonEmptyArray(l.AryText))for(var u=0;u<l.AryText.length;++u){u>0&&(t+=this.LineSpace);var C=l.AryText[u];o.push(C),t+=e}}else o.push({Text:""}),t+=e}else t=e;var D={Width:n+this.NoteMargin.Left+this.NoteMargin.Right,Height:t+this.NoteMargin.Top+this.NoteMargin.Bottom,ArrowType:0};r?(D.Left=this.PtTop.X-D.Width/2-this.PtCenter.X,D.Top=this.PtTop.Y-D.Height-this.ArrowSize-this.PtCenter.Y,D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,D.Arrow={X:this.PtTop.X-this.PtCenter.X,Y:this.PtTop.Y-this.PtCenter.Y},this.PtCenter.X+t+this.FontOption.Size*i/2+2+this.ArrowSize>a.RightEx&&(D.Top=this.PtButtom.Y+this.ArrowSize+this.PointRadius*i-this.PtCenter.Y,D.Bottom=D.Top+D.Height,D.Arrow.X=this.PtButtom.X-this.PtCenter.X,D.Arrow.Y=this.PtButtom.Y-this.PtCenter.Y,D.ArrowType=1)):(D.Left=this.PtTop.X-D.Width/2,D.Top=this.PtTop.Y-D.Height-this.ArrowSize,D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,D.Arrow={X:this.PtTop.X,Y:this.PtTop.Y},D.Left<a.Left?(D.Left=a.Left,D.Right=D.Left+D.Width):D.Right>a.Right&&(D.Right=a.Right,D.Left=D.Right-D.Width),D.Top<a.TopEx&&(D.Top=this.PtButtom.Y+this.ArrowSize+this.PointRadius*i,D.Bottom=D.Top+D.Height,D.Arrow.X=this.PtButtom.X,D.Arrow.Y=this.PtButtom.Y,D.ArrowType=1)),this.DrawNoteBG(D),this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.NoteTextColor;var f=D.Left+this.NoteMargin.Left,c=D.Top+this.NoteMargin.Top;for(s=0;s<o.length;++s){h=o[s];h&&(h.Text?(this.Canvas.fillText(h.Text,f,c),c+=e):c+=e,c+=this.LineSpace)}},this.DrawNoteBG=function(t){if(this.Canvas.fillStyle=this.NoteBGColor,0==t.ArrowType||1==t.ArrowType){var e=new Path2D;if(0==t.ArrowType){e.moveTo(t.Left,t.Bottom),e.lineTo(t.Left,t.Top),e.lineTo(t.Right,t.Top),e.lineTo(t.Right,t.Bottom);var a=t.Arrow.X+.6*this.ArrowSize;e.lineTo(a,t.Bottom),e.lineTo(t.Arrow.X,t.Arrow.Y);a=t.Arrow.X-.6*this.ArrowSize;e.lineTo(a,t.Bottom)}else{e.moveTo(t.Left,t.Top),e.lineTo(t.Left,t.Bottom),e.lineTo(t.Right,t.Bottom),e.lineTo(t.Right,t.Top);a=t.Arrow.X+.6*this.ArrowSize;e.lineTo(a,t.Top),e.lineTo(t.Arrow.X,t.Arrow.Y);a=t.Arrow.X-.6*this.ArrowSize;e.lineTo(a,t.Top)}e.closePath(),this.Canvas.fill(e),this.NoteBorderColor&&(this.Canvas.strokeStyle=this.NoteBorderColor,this.Canvas.stroke(e))}else this.Canvas.fillRect(t.Left,t.Top,t.Width,t.Height)},this.IsShowNoteText=function(){if(this.GetActiveDrawPicture){var t=this.GetActiveDrawPicture();return t.Move.Guid==this.Guid||t.Select.Guid==this.Guid||t.MoveOn.Guid==this.Guid}return!1},this.GetTextFont=function(){if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return null;var t="";return this.FontOption.Size>=0&&(t+=this.FontOption.Size*F()+"px "),t+=this.FontOption.Family,t},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;if(!a)return-1;if(!this.TextRect)return-1;var i=0;this.Option&&this.Option.Zoom>=1&&(i=this.Option.Zoom*F());var r={Left:this.TextRect.Left-i,Top:this.TextRect.Top-i,Width:this.TextRect.Width+2*i,Height:this.TextRect.Height+2*i};return r.Right=r.Left+r.Width,r.Bottom=r.Top+r.Height,t>r.Left&&t<r.Right&&e>r.Top&&e<r.Bottom?100:-1},this.GetCursorType=function(t){return 100==t?"pointer":null}}function Pi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawAnchoredText",this.PointCount=1,this.AryText=[{Text:"输入内容"}],this.TextColor=qi.ChartDrawAnchoredText.TextColor,this.FontOption={Family:qi.ChartDrawAnchoredText.FontOption.Family,Size:qi.ChartDrawAnchoredText.FontOption.Size,Weight:qi.ChartDrawAnchoredText.FontOption.Weight,Style:qi.ChartDrawAnchoredText.FontOption.Style},this.TextMaxWidth=qi.ChartDrawAnchoredText.TextMaxWidth,this.LineSpace=qi.ChartDrawAnchoredText.LineSpace,this.BGColor=qi.ChartDrawAnchoredText.BGColor,this.BorderColor=qi.ChartDrawAnchoredText.BorderColor,this.TextMargin={Left:qi.ChartDrawAnchoredText.TextMargin.Left,Top:qi.ChartDrawAnchoredText.TextMargin.Top,Bottom:qi.ChartDrawAnchoredText.TextMargin.Bottom,Right:qi.ChartDrawAnchoredText.TextMargin.Right},this.TextRect,this.SetOption=function(t){t&&(t.TextColor&&(this.TextColor=t.TextColor),t.Text&&(this.Text=t.Text),t.FontOption&&this.SetFont(this.FontOption,t.FontOption),sa.IsNumber(t.TextMaxWidth)&&(this.TextMaxWidth=t.TextMaxWidth),sa.IsNonEmptyArray(t.AryText)&&(this.AryText=this.CloneArrayText(t.AryText)))},this.ExportStorageData=function(){var t=this.ExportBaseData(),e=this.Value[0];return t.Value=[{XValue:e.XValue,YValue:e.YValue}],t.FontOption={},this.SetFont(t.FontOption,this.FontOption),t.BGColor=this.BGColor,t.TextColor=this.TextColor,t.BorderColor=this.BorderColor,t.LineSpace=this.LineSpace,t.TextMaxWidth=this.TextMaxWidth,t.TextMargin={Left:this.TextMargin.Left,Top:this.TextMargin.Right,Bottom:this.TextMargin.Bottom,Right:this.TextMargin.Right},t.AryText=this.CloneArrayText(this.AryText),t},this.ImportStorageData=function(t){if(t.TextMargin){var e=t.TextMargin;sa.IsNumber(e.Left)&&(this.TextMargin.Left=e.Left),sa.IsNumber(e.Top)&&(this.TextMargin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.TextMargin.Bottom=e.Bottom),sa.IsNumber(e.Right)&&(this.TextMargin.Right=e.Right)}t.TextColor&&(this.TextColor=t.TextColor),this.BGColor=t.BGColor,this.BorderColor=t.BorderColor,this.TextMaxWidth=t.TextMaxWidth,sa.IsNumber(t.LineSpace)&&(this.LineSpace=t.LineSpace),this.AryText=this.CloneArrayText(t.AryText)},this.Draw=function(){if(this.TextRect=null,!(this.Status<2)&&1==this.Point.length&&this.Frame&&!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint();t&&1==t.length&&(this.ClipFrame(),this.DrawMultiLineText(t[0]),this.Canvas.restore())}},this.ValueToPoint=function(){if(!this.Frame)return!1;var t=this.Value[0],e=this.XYValueToPoint(t.XValue,t.YValue);this.Point=[e]},this.PointToValue=function(){if(!this.Frame)return!1;var t=this.Frame.GetBorder(),e=this.Frame.IsHScreen;if(e){var a=t.LeftEx,i=t.Top,r=t.RightEx-a,n=t.Bottom-i,o=this.Point[0],s=(o.X-a)/r,h=(o.Y-i)/n;this.Value[0]={XValue:h,YValue:s}}else{a=t.Left,i=t.TopEx,r=t.Right-a,n=t.BottomEx-i,o=this.Point[0],h=(o.X-a)/r,s=(o.Y-i)/n;this.Value[0]={XValue:h,YValue:s}}},this.XYValueToPoint=function(t,e){if(!this.Frame)return null;var a=this.Frame.IsHScreen,i=this.Frame.GetBorder();if(a){var r=i.LeftEx,n=i.Top,o=i.RightEx-r,s=i.Bottom-n,h=e*o+r,l=t*s+n;return{X:h,Y:l}}r=i.Left,n=i.TopEx,o=i.Right-r,s=i.BottomEx-n,h=t*o+r,l=e*s+n;return{X:h,Y:l}},this.CalculateDrawPoint=function(t){if(this.Status<2)return null;if(1!=this.Point.length||!this.Frame)return null;var e=[];if(10==this.Status){var a=this.Value[0],i=this.XYValueToPoint(a.XValue,a.YValue);e.push(i)}else e=this.Point;return e},this.DrawMultiLineText=function(t){if(sa.IsNonEmptyArray(this.AryText)){var e=0;this.Canvas.font=this.GetFontString(this.FontOption);var a=this.Canvas.measureText("擎").width,i=(this.Frame.GetBorder(),F(),this.Frame.IsHScreen),r={X:t.X,Y:t.Y};i&&(this.Canvas.translate(r.X,r.Y),this.Canvas.rotate(90*Math.PI/180),r.X=0,r.Y=0);for(var n=[],o=0,s=0;s<this.AryText.length;++s){var h=this.AryText[s];if(h)if(e>0&&(e+=this.LineSpace),this.TextMaxWidth>50&&h.Text){var l=this.GetMultiLineText(h.Text,this.TextMaxWidth);if(l&&sa.IsNonEmptyArray(l.AryText))for(var u=0;u<l.AryText.length;++u){u>0&&(e+=this.LineSpace);var C=l.AryText[u];n.push(C),e+=a}}else{if(h.Text){var D=this.Canvas.measureText(h.Text).width+2;o<D&&(o=D)}n.push({Text:h.Text}),e+=a}}this.TextMaxWidth>50&&(o=this.TextMaxWidth);var f={Left:r.X,Bottom:r.Y,Height:e+this.TextMargin.Top+this.TextMargin.Bottom,Width:o+this.TextMargin.Left+this.TextMargin.Right};f.Top=f.Bottom-f.Height,f.Right=f.Left+f.Width,this.DrawBG(f),this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="top";var c=f.Left+this.TextMargin.Left,m=f.Top+this.TextMargin.Top;for(s=0;s<n.length;++s){h=n[s];h&&(h.Text?(this.Canvas.fillText(h.Text,c,m),m+=a):m+=a,m+=this.LineSpace)}i&&(f.Left=t.X,f.Top=t.Y,f.Width=e+this.TextMargin.Top+this.TextMargin.Bottom,f.Height=o+this.TextMargin.Left+this.TextMargin.Right,f.Right=f.Left+f.Width,f.Bottom=f.Top+f.Height),this.TextRect=f;var d={X:f.Left+f.Width/2,Y:f.Bottom};this.DrawPoint([d])}},this.DrawBG=function(t){if(this.BGColor||this.BorderColor){var e=new Path2D;e.rect(t.Left,t.Top,t.Width,t.Height),this.BGColor&&(this.Canvas.fillStyle=this.BGColor,this.Canvas.fill(e)),this.BorderColor&&(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.stroke(e))}},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;if(!this.TextRect)return-1;var a=this.TextRect;return t>a.Left&&t<a.Right&&e>a.Top&&e<a.Bottom?100:-1},this.GetCursorType=function(t){return 100==t?"pointer":null}}function Gi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPriceLabel",this.PointCount=1,this.OnlyMoveXIndex=!0,this.TextColor=qi.ChartDrawPriceLabel.TextColor,this.FontOption={Family:qi.ChartDrawPriceLabel.FontOption.Family,Size:qi.ChartDrawPriceLabel.FontOption.Size,Weight:qi.ChartDrawPriceLabel.FontOption.Weight,Style:qi.ChartDrawPriceLabel.FontOption.Style},this.BGColor=qi.ChartDrawPriceLabel.BGColor,this.BorderColor=qi.ChartDrawPriceLabel.BorderColor,this.LabelOffset={X:10,Y:20},this.TextMargin={Left:qi.ChartDrawPriceLabel.TextMargin.Left,Top:qi.ChartDrawPriceLabel.TextMargin.Top,Bottom:qi.ChartDrawPriceLabel.TextMargin.Bottom,Right:qi.ChartDrawPriceLabel.TextMargin.Right},this.TextRect,this.SetOption=function(t){if(t&&(t.TextColor&&(this.TextColor=t.TextColor),t.BGColor&&(this.BGColor=t.BGColor),t.BorderColor&&(this.BorderColor=t.BorderColor),t.FontOption&&this.SetFont(this.FontOption,t.FontOption),t.LabelOffset)){var e=t.LabelOffset;sa.IsNumber(e.X)&&(this.LabelOffset.X=e.X),sa.IsNumber(e.Y)&&(this.LabelOffset.Y=e.Y)}},this.ExportStorageData=function(){var t=this.ExportBaseData(),e=this.Value[0];return t.Value=[{XValue:e.XValue,YValue:e.YValue}],t.BGColor=this.BGColor,t.TextColor=this.TextColor,t.BorderColor=this.BorderColor,t.TextMargin={Left:this.TextMargin.Left,Top:this.TextMargin.Right,Bottom:this.TextMargin.Bottom,Right:this.TextMargin.Right},t},this.ImportStorageData=function(t){if(t.TextMargin){var e=t.TextMargin;sa.IsNumber(e.Left)&&(this.TextMargin.Left=e.Left),sa.IsNumber(e.Top)&&(this.TextMargin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.TextMargin.Bottom=e.Bottom),sa.IsNumber(e.Right)&&(this.TextMargin.Right=e.Right)}t.TextColor&&(this.TextColor=t.TextColor),this.BGColor=t.BGColor,this.BorderColor=t.BorderColor},this.Draw=function(){if(this.TextRect=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&1==t.length){var e=t[0];this.ClipFrame(),this.DrawPriceLabel(e),this.Canvas.restore(),this.DrawPoint([e])}}},this.DrawPriceLabel=function(t){var e=this.GetFontString(this.FontOption);if(e){var a,i,r=this.Frame.IsHScreen,n=(F(),0);r?(this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),a={X:0,Y:0},i=this.Frame.GetYData(t.X,!1),n=1):(a={X:t.X,Y:t.Y},i=this.Frame.GetYData(t.Y,!1));var o=2;this.Symbol&&0==this.Frame.Identify&&(o=Jr(this.Symbol));var s=i.toFixed(o);this.Canvas.font=e;var h=a.X+this.LabelOffset.X,l=a.Y-this.LabelOffset.Y,u=this.Canvas.measureText("擎").width,C=this.Canvas.measureText(s).width,D={Left:h,Bottom:l,Width:C+this.TextMargin.Left+this.TextMargin.Right,Height:u+this.TextMargin.Top+this.TextMargin.Bottom};D.Top=D.Bottom-D.Height,D.Right=D.Left+D.Width,this.DrawBG(D,a);var f=D.Left+D.Width/2,c=D.Top+D.Height/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(s,f,c+n),r?(this.TextRect={Left:t.X+this.LabelOffset.Y,Top:t.Y+this.LabelOffset.X,Width:u+this.TextMargin.Top+this.TextMargin.Bottom,Height:C+this.TextMargin.Left+this.TextMargin.Right},this.TextRect.Right=this.TextRect.Left+this.TextRect.Width,this.TextRect.Bottom=this.TextRect.Top+this.TextRect.Height):this.TextRect=D}},this.DrawBG=function(t,e){var a=F(),i=new Path2D;i.moveTo(t.Left,t.Bottom),i.lineTo(t.Left,t.Top),i.lineTo(t.Right,t.Top),i.lineTo(t.Right,t.Bottom);var r=t.Left+15*a;i.lineTo(r,t.Bottom),i.lineTo(e.X,e.Y),r=t.Left+5*a,i.lineTo(r,t.Bottom),i.closePath(),this.BGColor&&(this.Canvas.fillStyle=this.BGColor,this.Canvas.fill(i)),this.BorderColor&&(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.stroke(i)),this.BGColor&&(this.Canvas.beginPath(),this.Canvas.arc(e.X,e.Y,2*a,0,360,!1),this.Canvas.fillStyle=this.BGColor,this.Canvas.fill())},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;if(!this.TextRect)return-1;var a=this.TextRect;return t>a.Left&&t<a.Right&&e>a.Top&&e<a.Bottom?100:-1},this.GetCursorType=function(t){return 100==t?"pointer":null}}function _i(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPriceNote",this.PointCount=2,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsPointIn=this.IsPointIn_XYValue_Line,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.FontOption={Family:qi.ChartDrawPriceNote.FontOption.Family,Size:qi.ChartDrawPriceNote.FontOption.Size,Weight:qi.ChartDrawPriceNote.FontOption.Weight,Style:qi.ChartDrawPriceNote.FontOption.Style},this.TextMargin={Left:qi.ChartDrawPriceNote.TextMargin.Left,Top:qi.ChartDrawPriceNote.TextMargin.Top,Bottom:qi.ChartDrawPriceNote.TextMargin.Bottom,Right:qi.ChartDrawPriceNote.TextMargin.Right},this.BGColor=qi.ChartDrawPriceNote.BGColor,this.BorderColor=qi.ChartDrawPriceNote.BorderColor,this.TextColor=qi.ChartDrawPriceNote.TextColor,this.BorderRoundRadius=3,this.TextRect,this.SetOption=function(t){t&&(t.TextColor&&(this.TextColor=t.TextColor),t.BGColor&&(this.BGColor=t.BGColor),t.BorderColor&&(this.BorderColor=t.BorderColor),t.FontOption&&this.SetFont(this.FontOption,t.FontOption))},this.ExportStorageData=function(){var t=this.ExportBaseData();t.Value=[];for(var e=0;e<this.Value.length;++e){var a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue})}return t.BGColor=this.BGColor,t.TextColor=this.TextColor,t.BorderColor=this.BorderColor,t.TextMargin={Left:this.TextMargin.Left,Top:this.TextMargin.Right,Bottom:this.TextMargin.Bottom,Right:this.TextMargin.Right},t},this.ImportStorageData=function(t){if(t.TextMargin){var e=t.TextMargin;sa.IsNumber(e.Left)&&(this.TextMargin.Left=e.Left),sa.IsNumber(e.Top)&&(this.TextMargin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.TextMargin.Bottom=e.Bottom),sa.IsNumber(e.Right)&&(this.TextMargin.Right=e.Right)}t.TextColor&&(this.TextColor=t.TextColor),this.BGColor=t.BGColor,this.BorderColor=t.BorderColor},this.Draw=function(){if(this.LinePoint=[],this.TextRect=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.LineWidth=1,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth(),this.DrawPriceLabel(e,a);var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawPriceLabel=function(t,e){var a=this.GetFontString(this.FontOption);if(a){var i=2;this.Symbol&&0==this.Frame.Identify&&(i=Jr(this.Symbol));var r=F(),n={X:e.X,Y:e.Y},o=this.Frame.GetYData(t.Y,!1),s=o.toFixed(i);this.Canvas.font=a;var h=this.Canvas.measureText("擎").width,l=this.Canvas.measureText(s).width,u=this.CalculateAngle(t.X,t.Y,e.X,e.Y);if(u>=0&&u<=45||u>=315&&u<=360){var C=n.X,D=n.Y,f={Left:C,Bottom:D,Width:l+this.TextMargin.Left+this.TextMargin.Right,Height:h+this.TextMargin.Top+this.TextMargin.Bottom};f.Bottom=D+f.Height/2,f.Top=f.Bottom-f.Height,f.Right=f.Left+f.Width}else if(u>45&&u<=135){C=n.X,D=n.Y,f={Left:C,Bottom:D,Width:l+this.TextMargin.Left+this.TextMargin.Right,Height:h+this.TextMargin.Top+this.TextMargin.Bottom};f.Left=C-f.Width/2,f.Top=f.Bottom-f.Height,f.Right=f.Left+f.Width}else if(u>=135&&u<=225){C=n.X,D=n.Y,f={Width:l+this.TextMargin.Left+this.TextMargin.Right,Height:h+this.TextMargin.Top+this.TextMargin.Bottom};f.Bottom=D+f.Height/2,f.Top=f.Bottom-f.Height,f.Right=C,f.Left=f.Right-f.Width}else{if(!(u>=225&&u<=315))return;C=n.X;var c=n.Y;f={Width:l+this.TextMargin.Left+this.TextMargin.Right,Height:h+this.TextMargin.Top+this.TextMargin.Bottom};f.Top=c,f.Bottom=f.Top+f.Height,f.Left=C-f.Width/2,f.Right=f.Left-f.Width}this.DrawBG(f),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor;var m=f.Left+this.TextMargin.Left,d=f.Top+f.Height/2;this.Canvas.fillText(s,m,d+0),this.BGColor&&(this.Canvas.beginPath(),this.Canvas.arc(t.X,t.Y,2*r,0,360,!1),this.Canvas.fillStyle=this.BGColor,this.Canvas.fill()),this.TextRect=f}},this.DrawBG=function(t){if(t){var e=F(),a=this.BorderRoundRadius*e,i=new Path2D;i.roundRect(A(t.Left),A(t.Top),b(t.Width),b(t.Height),[a]),this.BGColor&&(this.Canvas.fillStyle=this.BGColor,this.Canvas.fill(i)),this.BorderColor&&(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.stroke(i))}},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;if(!this.TextRect)return-1;var a=this.TextRect;return t>a.Left&&t<a.Right&&e>a.Top&&e<a.Bottom?1:this.IsPointIn_XYValue_Line(t,e)}}function Vi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawFibWedge",this.PointCount=3,this.Font=12*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointToValue_Default=this.PointToValue,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LastPoint,this.AreaConfig={AryData:[{Value:.236,Color:"rgb(242,52,69)",Enable:!0},{Value:.382,Color:"rgb(255,152,0)",Enable:!0},{Value:.5,Color:"rgb(76,175,80)",Enable:!0},{Value:.618,Color:"rgb(8,153,129)",Enable:!0},{Value:.786,Color:"rgb(0,188,212)",Enable:!0},{Value:1,Color:"rgb(120,123,134)",Enable:!0},{Value:1.618,Color:"rgb(41,98,255)",Enable:!1},{Value:2.618,Color:"rgb(242,54,69)",Enable:!1}],Opacity:.3},this.TextAngle,this.Radius,this.CalculateHypotenuse=function(t,e){var a=t.X-e.X,i=t.Y-e.Y,r=Math.sqrt(a*a+i*i);return r},this.MagnetXY=function(t){var e={IsFixedX:this.OnlyMoveXIndex};if(this.Option&&this.Option.Magnet&&this.Option.Magnet.Enable&&this.IsSupportMagnet&&0==this.Frame.Identify){var a=-1;2==this.Status&&(a=1),sa.IsNumber(this.MovePointIndex)&&(a=this.MovePointIndex),a>=0&&(e.Magnet={Enable:!0,PointIndex:a,Distance:this.Option.Magnet.Distance,Type:this.Option.Magnet.Type})}this.AdjustPoint(t,e)},this.CalculateAllPoint=function(t,e,a){var i=[];i.push({X:t.X,Y:t.Y}),i.push({X:e.X,Y:e.Y}),this.MagnetXY(i),i.push({X:a.X,Y:a.Y});var r=this.CalculateHypotenuse(i[0],i[1]),n=i[0].X-i[2].X,o=i[0].Y-i[2].Y,s=Math.sqrt(n*n+o*o),h=n*r/s,l=o*r/s;return i[2].X=i[0].X-h,i[2].Y=i[0].Y-l,i},this.ValueToPoint_V2=function(t){if(!sa.IsNonEmptyArray(t))return null;if(!this.Frame)return null;var e=this.Frame.Data;if(!e)return null;for(var a=this.Frame.IsHScreen,i=[],r=0;r<t.length;++r){var n=t[r],o=new V;a?(o.Y=this.Frame.GetXFromIndex(n.XValue-e.DataOffset,!1),o.X=this.Frame.GetYFromData(n.YValue,!1)):(o.X=this.Frame.GetXFromIndex(n.XValue-e.DataOffset,!1),o.Y=this.Frame.GetYFromData(n.YValue,!1)),i[r]=o}return i},this.CalculateDrawPoint=function(t){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var e=[];if(2==this.Status)if(2==this.PointStatus&&this.LastPoint)e=this.CalculateAllPoint(this.Point[0],this.Point[1],this.LastPoint);else{for(var a=0;a<this.Point.length&&a<2;++a){var i=this.Point[a];e.push({X:i.X,Y:i.Y})}this.MagnetXY(e)}else if(10==this.Status){var r=this.Frame.Data;if(!r)return null;var n=this.Frame.XPointCount,o=this.Frame.IsHScreen;for(a=0;a<this.Value.length;++a){i=this.Value[a];var s=i.XValue-r.DataOffset;(s<0||s>=n)&&0;var h=new V;o?(h.Y=this.Frame.GetXFromIndex(i.XValue-r.DataOffset,!1),h.X=this.Frame.GetYFromData(i.YValue,!1)):(h.X=this.Frame.GetXFromIndex(i.XValue-r.DataOffset,!1),h.Y=this.Frame.GetYFromData(i.YValue,!1)),e.push(h)}}else 20==this.Status&&(e=this.CalculateAllPoint(this.Point[0],this.Point[1],this.Point[2]));return e},this.Draw=function(){if(this.LinePoint=[],this.TextAngle=null,this.Radius=null,!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!1});if(sa.IsNonEmptyArray(t)){var e=t.slice(0);this.CalculateLines(e),this.ClipFrame(),this.DrawArea(e),this.DrawLines(this.LinePoint),this.DrawPoint(e),this.DrawTitle(e),this.Canvas.restore()}}},this.DrawArea=function(t){if(3==t.length&&this.AreaConfig&&sa.IsNonEmptyArray(this.AreaConfig.AryData)){var e=t[0],a=this.CalculateHypotenuse(e,t[1]),i=this.CalculateAngle(e.X,e.Y,t[1].X,t[1].Y),r=this.CalculateAngle(e.X,e.Y,t[2].X,t[2].Y),n=i-r;if(n<0&&(n+=360),n>180){var o=i;i=r,r=o}var s=i-(i-r)/2;i-r<0&&(s-=180);for(var h=null,l=0;l<this.AreaConfig.AryData.length;++l){var u=this.AreaConfig.AryData[l];if(u.Enable){var C=a*u.Value,D=u.Color,f=Ha.ColorToRGBA(D,this.AreaConfig.Opacity),c=new Path2D;sa.IsNumber(h)?(c.arc(e.X,e.Y,h,Math.PI/180*(360-i),Math.PI/180*(360-r)),c.arc(e.X,e.Y,C,Math.PI/180*(360-r),Math.PI/180*(360-i),!0)):(c.moveTo(e.X,e.Y),c.arc(e.X,e.Y,C,Math.PI/180*(360-i),Math.PI/180*(360-r))),this.Canvas.fillStyle=f,this.Canvas.fill(c),h=C}}for(l=0;l<this.AreaConfig.AryData.length;++l){u=this.AreaConfig.AryData[l];if(u.Enable){C=a*u.Value,D=u.Color,c=new Path2D;c.arc(e.X,e.Y,C,Math.PI/180*(360-i),Math.PI/180*(360-r)),this.Canvas.strokeStyle=D,this.Canvas.stroke(c)}}this.Radius=a,this.TextAngle=s}},this.DrawTitle=function(t){if(3==t.length&&this.AreaConfig&&sa.IsNonEmptyArray(this.AreaConfig.AryData)){var e=t[0],a=Math.PI/180*(360-this.TextAngle);this.Canvas.font=this.Font;for(var i=0;i<this.AreaConfig.AryData.length;++i){var r=this.AreaConfig.AryData[i];if(r.Enable){var n=this.Radius*r.Value,o=r.Color,s="".concat(r.Value),h=Math.sin(a)*n+e.Y,l=Math.cos(a)*n+e.X;this.Canvas.fillStyle=o,this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillText(s,l+2,h+2)}}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawLines=function(t){if(sa.IsNonEmptyArray(t))for(var e=0;e<t.length;++e){var a=t[e];this.DrawLine(a.Start,a.End)}},this.CalculateLines=function(t){if(2===t.length){var e={Start:new V,End:new V};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e)}else if(3===t.length){e={Start:new V,End:new V};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e),e={Start:new V,End:new V},e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[2].Y,e.End.X=t[2].X,this.LinePoint.push(e)}},this.IsPointIn=function(t,e,a){if(10!=this.Status)return-1;var i=this.IsPointInXYValue(t,e,this.AryPoint,a);return i>=0?i:(i=this.IsPointInLine(t,e,a),i>=0?100:-1)},this.IsPointInDots=function(t,e,a,i){if(!sa.IsNonEmptyArray(a))return-1;if(!this.Frame)return-1;var r=this.Frame.Data;if(!r)return-1;if(!this.Value)return-1;var n=5;i&&sa.IsNumber(i.Zoom)?n+=i.Zoom:this.Option&&sa.IsNumber(this.Option.Zoom)&&(n+=this.Option.Zoom);this.Frame.IsHScreen;n*=F();for(var o=0;o<a.length;++o){var s=a[o],h=new Path2D;if(h.arc(s.X,s.Y,n,0,360),this.Canvas.isPointInPath(h,t,e))return o}return-1},this.GetCursorType=function(t){return 2==t?"ns-resize":null},this.PointToValue=function(){if(!this.Frame)return!1;var t=this.Point[2],e={X:t.X,Y:t.Y};if(!this.PointToValue_Default())return!1;var a=[this.Value[0],this.Value[1]],i=this.ValueToPoint_V2(a),r=this.CalculateHypotenuse(i[0],i[1]),n=i[0].X-e.X,o=i[0].Y-e.Y,s=Math.sqrt(n*n+o*o),h=n*r/s,l=o*r/s;this.Point[2].X=i[0].X-h,this.Point[2].Y=i[0].Y-l;a=this.PointToValue_V2([this.Point[2]],{Type:1});return!!a&&(this.Value[2]=a[0],!0)},this.PointToValue_V2=function(t,e){return this.Frame?"MinuteFrame"==this.Frame.ClassName||"MinuteHScreenFrame"==this.Frame.Class?this.PointToValue_Minute_V2(t,e):this.PointToValue_KLine_V2(t,e):null},this.PointToValue_KLine_V2=function(t,e){if(!sa.IsNonEmptyArray(t))return null;if(!this.Frame)return null;var a=this.Frame.Data;if(!a)return null;var i=[],r=this.Frame.IsHScreen;if(r)for(var n=0;n<t.length;++n){var o=t[n],s=this.Frame.GetXData(o.Y,!1)+a.DataOffset,h=this.Frame.GetYData(o.X,!1),l={XValue:s,YValue:h,Type:1};i[n]=l}else for(n=0;n<t.length;++n){o=t[n],s=this.Frame.GetXData(o.X,!1)+a.DataOffset,h=this.Frame.GetYData(o.Y,!1),l={XValue:s,YValue:h,Type:1};i[n]=l}return i}}function Hi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartFibRetracement",this.PointCount=2,this.Font=12*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointToValue_Default=this.PointToValue,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LineDash=[6,3],this.LineWidth=1,this.EnableBGColor=!0,this.ExtendLine={Left:!1,Right:!1},this.AreaConfig={AryData:[{Value:0,Color:"rgb(128,128,128)",Enable:!0},{Value:.236,Color:"rgb(242,52,69)",Enable:!0},{Value:.382,Color:"rgb(255,152,0)",Enable:!0},{Value:.5,Color:"rgb(76,175,80)",Enable:!0},{Value:.618,Color:"rgb(8,153,129)",Enable:!0},{Value:.786,Color:"rgb(0,188,212)",Enable:!0},{Value:1,Color:"rgb(120,123,134)",Enable:!0},{Value:1.618,Color:"rgb(41,98,255)",Enable:!0},{Value:2.618,Color:"rgb(242,54,69)",Enable:!1}],Opacity:.3},this.SetOption=function(t){if(t){if(t.Font&&(this.Font=t.Font),t.LineWidth&&(this.LineWidth=t.LineWidth),t.LineDash&&(this.LineDash=t.LineDash),sa.IsBool(t.EnableBGColor)&&(this.EnableBGColor=t.EnableBGColor),t.ExtendLine){var e=t.ExtendLine;sa.IsBool(e.Left)&&(this.ExtendLine.Left=e.Left),sa.IsBool(e.Right)&&(this.ExtendLine.Left=e.Right)}t.AreaConfig&&(this.AreaConfig=t.AreaConfig)}},this.ExportStorageData=function(){var t=this.ExportBaseData();t.Value=[];for(var e=0;e<this.Value.length&&e<this.PointCount;++e){var a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue})}return t.Font=this.Font,t.EnableBGColor=this.EnableBGColor,t.LineDash=this.LineDash,t.ExtendLine={Left:this.ExtendLine.Left,Right:this.ExtendLine.Right},t.AreaConfig=P(this.AreaConfig),t},this.ImportStorageData=function(t){t.Font&&(this.Font=t.Font),t.LineDash&&(this.LineDash=t.LineDash),sa.IsBool(t.EnableBGColor)&&(this.EnableBGColor=t.EnableBGColor),t.ExtendLine&&(this.ExtendLine=t.ExtendLine),t.AreaConfig&&(this.AreaConfig=t.AreaConfig)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=!0;(this.ExtendLine.Left||this.ExtendLine.Right)&&(t=!1);var e=this.CalculateDrawPoint({IsCheckX:t,IsCheckY:t});if(e&&2==e.length){this.ClipFrame();var a=e[0],i=e[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.setLineDash(this.LineDash),this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),this.Canvas.lineTo(i.X,i.Y),this.Canvas.stroke(),this.Canvas.setLineDash([]),this.DrawBlock(a,i),this.RestoreLineWidth();var r={Start:a,End:i};this.LinePoint.push(r),this.DrawPoint(e),this.Canvas.restore()}}},this.GetArrayAreaConfig=function(){for(var t=[],e=0;e<this.AreaConfig.AryData.length;++e){var a=this.AreaConfig.AryData[e];a.Enable&&t.push(a)}return t.sort((function(t,e){return e.Value-t.Value})),t},this.DrawBlock=function(t,e){var a=Math.min(t.Y,e.Y),i=Math.max(t.Y,e.Y),r=Math.min(t.X,e.X),n=Math.max(t.X,e.X),o=i-a;this.ExtendLine.Right&&(n=this.Frame.ChartBorder.GetRight()),this.ExtendLine.Left&&(r=this.Frame.ChartBorder.GetLeft());var s=this.GetArrayAreaConfig(),h=null,l=null;this.Canvas.font=this.Font,this.ExtendLine.Left?this.Canvas.textAlign="left":this.Canvas.textAlign="right",this.Canvas.textBaseline="bottom";for(var u=0;u<s.length;++u){var C=s[u],D=i-o*C.Value;if(yValue=this.Frame.GetYData(D,!1),D=A(D),this.EnableBGColor&&sa.IsNumber(h)){var f={Left:r,Right:n,Top:h,Bottom:D};f.Width=f.Right-f.Left,f.Height=f.Bottom-f.Top,this.Canvas.fillStyle=l,this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height)}this.Canvas.strokeStyle=C.Color,this.Canvas.beginPath(),this.Canvas.moveTo(r,D),this.Canvas.lineTo(n,D),this.Canvas.stroke();var c={Start:{X:r,Y:D},End:{X:n,Y:D}};this.LinePoint.push(c);var m="".concat(C.Value," (").concat(yValue.toFixed(2),")");this.Canvas.fillStyle=C.Color,this.ExtendLine.Left?this.Canvas.fillText(m,r+2,D-2):this.Canvas.fillText(m,r-2,D-2),h=D,l=Ha.ColorToRGBA(C.Color,this.AreaConfig.Opacity)}}}function Yi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartFibSpeedResistanceFan",this.PointCount=2,this.Font=12*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointToValue_Default=this.PointToValue,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LineWidth=1,this.EnableBGColor=!0,this.AreaConfig={AryYData:[{Value:0,Color:"rgb(128,128,128)",Enable:!0},{Value:.25,Color:"rgb(242,52,69)",Enable:!0},{Value:.382,Color:"rgb(255,152,0)",Enable:!0},{Value:.5,Color:"rgb(76,175,80)",Enable:!0},{Value:.618,Color:"rgb(8,153,129)",Enable:!0},{Value:.75,Color:"rgb(0,188,212)",Enable:!0},{Value:1,Color:"rgb(120,123,134)",Enable:!0}],AryXData:[{Value:0,Color:"rgb(128,128,128)",Enable:!0},{Value:.25,Color:"rgb(242,52,69)",Enable:!0},{Value:.382,Color:"rgb(255,152,0)",Enable:!0},{Value:.5,Color:"rgb(76,175,80)",Enable:!0},{Value:.618,Color:"rgb(8,153,129)",Enable:!0},{Value:.75,Color:"rgb(0,188,212)",Enable:!0},{Value:1,Color:"rgb(120,123,134)",Enable:!0}],Opacity:.3},this.SetOption=function(t){t&&(t.Font&&(this.Font=t.Font),t.LineWidth&&(this.LineWidth=t.LineWidth),sa.IsBool(t.EnableBGColor)&&(this.EnableBGColor=t.EnableBGColor),t.AreaConfig&&(this.AreaConfig=t.AreaConfig))},this.ExportStorageData=function(){var t=this.ExportBaseData();t.Value=[];for(var e=0;e<this.Value.length&&e<this.PointCount;++e){var a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue})}return t.Font=this.Font,t.EnableBGColor=this.EnableBGColor,t.AreaConfig=P(this.AreaConfig),t},this.ImportStorageData=function(t){t.Font&&(this.Font=t.Font),sa.IsBool(t.EnableBGColor)&&(this.EnableBGColor=t.EnableBGColor),t.AreaConfig&&(this.AreaConfig=t.AreaConfig)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!1});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.DrawBlock(a,e),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.GetQuadrant=function(t,e){return t.X<e.X&&t.Y>e.Y?1:t.X>e.X&&t.Y>e.Y?2:t.X<e.X&&t.Y<e.Y?4:3},this.DrawBlock=function(t,e){var a=e,i=e.X-t.X,r=e.Y-t.Y,n=this.GetQuadrant(a,t),o=this.GetArrayAreaConfig(this.AreaConfig.AryYData),s=null,h=null;this.Canvas.font=this.Font;var l=this.Frame.GetBorder(),u={X:l.Left,Y:l.TopEx},C={X:l.Right,Y:l.TopEx},D={X:l.Left,Y:l.BottomEx},f={X:l.Right,Y:l.BottomEx},c=4;1==n||4==n?(this.Canvas.textAlign="right",c=-4):(this.Canvas.textAlign="left",c=4),this.Canvas.textBaseline="middle";for(var m=0;m<o.length;++m){var d=o[m],I=d.Value*r+t.Y,S=this.CalculateExtendLineEndPoint([a,{X:t.X,Y:I}]);s&&(this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),this.Canvas.lineTo(s.X,s.Y),1==n?s.X>=C.X&&S.X<C.X&&this.Canvas.lineTo(C.X,C.Y):2==n?s.X<=u.X&&S.X>u.X&&this.Canvas.lineTo(u.X,u.Y):3==n?s.X<=D.X&&S.X>D.X&&this.Canvas.lineTo(D.X,D.Y):4==n&&s.X>=f.X&&S.X<f.X&&this.Canvas.lineTo(f.X,f.Y),this.Canvas.lineTo(S.X,S.Y),this.Canvas.closePath(),this.Canvas.fillStyle=h,this.Canvas.fill()),this.Canvas.strokeStyle=d.Color,this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),this.Canvas.lineTo(S.X,S.Y),this.Canvas.stroke(),this.LinePoint.push({Start:a,End:S}),1!=d.Value&&(this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(a.X,I),this.Canvas.lineTo(t.X,I),this.Canvas.stroke()),s=S,h=Ha.ColorToRGBA(d.Color,this.AreaConfig.Opacity);var T="".concat(d.Value);this.Canvas.fillStyle=d.Color,this.Canvas.fillText(T,a.X+c,I)}var v=this.GetArrayAreaConfig(this.AreaConfig.AryXData);s=null;this.Canvas.textAlign="center",3==n||4==n?(this.Canvas.textBaseline="bottom",c=-5):(this.Canvas.textBaseline="top",c=5);for(m=0;m<v.length;++m){d=v[m];var p=d.Value*i+t.X;S=this.CalculateExtendLineEndPoint([a,{X:p,Y:t.Y}]);s&&(this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),this.Canvas.lineTo(s.X,s.Y),1==n?s.X<C.X&&S.X>=C.X&&this.Canvas.lineTo(C.X,C.Y):2==n?s.X>u.X&&S.X<=u.X&&this.Canvas.lineTo(u.X,u.Y):3==n?s.X>D.X&&S.X<=D.X&&this.Canvas.lineTo(D.X,D.Y):4==n&&s.X<f.X&&S.X>=f.X&&this.Canvas.lineTo(f.X,f.Y),this.Canvas.lineTo(S.X,S.Y),this.Canvas.closePath(),this.Canvas.fillStyle=h,this.Canvas.fill()),this.Canvas.strokeStyle=d.Color,this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),this.Canvas.lineTo(S.X,S.Y),this.Canvas.stroke(),this.LinePoint.push({Start:a,End:S}),1!=d.Value&&(this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(p,a.Y),this.Canvas.lineTo(p,t.Y),this.Canvas.stroke()),s=S,h=Ha.ColorToRGBA(d.Color,this.AreaConfig.Opacity);T="".concat(d.Value);this.Canvas.fillStyle=d.Color,this.Canvas.fillText(T,p,a.Y+c)}},this.GetArrayAreaConfig=function(t){for(var e=[],a=0;a<t.length;++a){var i=t[a];i.Enable&&e.push(i)}return e.sort((function(t,e){return e.Value-t.Value})),e}}function ki(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartPriceRange",this.PointCount=2,this.Font=12*F()+"px 微软雅黑",this.TextColor=this.LineColor,this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointToValue_Default=this.PointToValue,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LineWidth=1,this.EnableBGColor=!0,this.BGColor=Ha.ColorToRGBA(this.LineColor,.15),this.ExtendLine={Left:!1,Right:!1},this.Label={TextColor:"rgb(0,0,0)",BGColor:"rgb(211,211,211)",EnableBGColor:!0,LeftMargin:5,RightMargin:5},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=!0;(this.ExtendLine.Left||this.ExtendLine.Right)&&(t=!1);var e=this.CalculateDrawPoint({IsCheckX:t,IsCheckY:t});if(e&&2==e.length){this.ClipFrame();var a=e[0],i=e[1];this.SetLineWidth(),this.DrawRange(a,i),this.RestoreLineWidth(),this.DrawPoint(e),this.Canvas.restore()}}},this.DrawRange=function(t,e){var a=Math.min(t.Y,e.Y),i=Math.max(t.Y,e.Y),r=Math.min(t.X,e.X),n=Math.max(t.X,e.X),o=t.X+(e.X-t.X)/2;if(this.ExtendLine.Right&&(n=this.Frame.ChartBorder.GetRight()),this.ExtendLine.Left&&(r=this.Frame.ChartBorder.GetLeft()),this.EnableBGColor){var s={Left:r,Top:a,Right:n,Bottom:i};s.Width=s.Right-s.Left,s.Height=s.Bottom-s.Top,this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(s.Left,s.Top,s.Width,s.Height)}this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(r,A(a)),this.Canvas.lineTo(n,A(a)),this.Canvas.moveTo(r,A(i)),this.Canvas.lineTo(n,A(i)),this.Canvas.moveTo(A(o),A(a)),this.Canvas.lineTo(A(o),A(i)),this.Canvas.stroke(),this.LinePoint.push({Start:{X:r,Y:a},End:{X:n,Y:a}}),this.LinePoint.push({Start:{X:r,Y:i},End:{X:n,Y:i}}),this.LinePoint.push({Start:{X:o,Y:a},End:{X:o,Y:i}}),this.DrawArrow({X:A(o),Y:t.Y},{X:A(o),Y:e.Y});var h=this.Frame.ChartBorder.GetBottomEx(),l=this.Frame.ChartBorder.GetTopEx(),u=this.Frame.GetYData(t.Y,!1),C=this.Frame.GetYData(e.Y,!1),D=C-u,f=D/u*100,c="".concat(D.toFixed(2)," (").concat(f.toFixed(2),"%)");this.Canvas.font=this.Font;var m=this.GetFontHeight(),d=this.Canvas.measureText(c).width+4+(this.Label.LeftMargin+this.Label.RightMargin),I={Left:o-d/2,Width:d,Height:m+2};if(I.Top=D>0?e.Y-I.Height-4:e.Y+4,I.Bottom=I.Top+I.Height,D>0?I.Top<=l&&(I.Top=l,I.Bottom=I.Top+I.Height):I.Bottom>=h&&(I.Bottom=h,I.Top=I.Bottom-I.Height),this.Label.EnableBGColor){var S=new Path2D;S.roundRect(A(I.Left),A(I.Top),b(I.Width),b(I.Height),[3]),this.Canvas.fillStyle=this.Label.BGColor,this.Canvas.fill(S)}this.Canvas.fillStyle=this.Label.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillText(c,I.Left+2+this.Label.LeftMargin,I.Bottom-2)}}function Xi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDateRange",this.PointCount=2,this.Font=12*F()+"px 微软雅黑",this.TextColor=this.LineColor,this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointToValue_Default=this.PointToValue,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LineWidth=1,this.EnableBGColor=!0,this.BGColor=Ha.ColorToRGBA(this.LineColor,.15),this.ExtendLine={Top:!1,Bottom:!1},this.Label={TextColor:"rgb(0,0,0)",BGColor:"rgb(211,211,211)",EnableBGColor:!0,LeftMargin:5,RightMargin:5},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.DrawRange(e,a),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawRange=function(t,e){var a=Math.min(t.Y,e.Y),i=Math.max(t.Y,e.Y),r=Math.min(t.X,e.X),n=Math.max(t.X,e.X),o=t.Y+(e.Y-t.Y)/2,s=t.X+(e.X-t.X)/2;if(this.ExtendLine.Top&&(a=this.Frame.ChartBorder.GetTopEx()),this.ExtendLine.Bottom&&(i=this.Frame.ChartBorder.GetBottomEx()),this.EnableBGColor){var h={Left:r,Top:a,Right:n,Bottom:i};h.Width=h.Right-h.Left,h.Height=h.Bottom-h.Top,this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(h.Left,h.Top,h.Width,h.Height)}this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(r),a),this.Canvas.lineTo(A(r),i),this.Canvas.moveTo(A(n),a),this.Canvas.lineTo(A(n),i),this.Canvas.moveTo(A(r),A(o)),this.Canvas.lineTo(A(n),A(o)),this.Canvas.stroke(),this.LinePoint.push({Start:{X:r,Y:a},End:{X:r,Y:i}}),this.LinePoint.push({Start:{X:n,Y:a},End:{X:n,Y:i}}),this.LinePoint.push({Start:{X:r,Y:o},End:{X:n,Y:o}}),this.DrawArrow({X:t.X,Y:A(o)},{X:e.X,Y:A(o)});var l=this.Frame.ChartBorder.GetBottomEx(),u=this.Frame.ChartBorder.GetTopEx(),C=this.Frame.GetXData(t.X,!1),D=this.Frame.GetXData(e.X,!1),f=this.Frame.GetYData(t.Y,!1),c=this.Frame.GetYData(e.Y,!1),m=c-f,d=D-C+1,I="".concat(d," bars");this.Canvas.font=this.Font;var S=this.GetFontHeight(),T=this.Canvas.measureText(I).width+4+(this.Label.LeftMargin+this.Label.RightMargin),v={Left:s-T/2,Top:e.Y+4,Width:T,Height:S+2};if(v.Top=m>0?e.Y-v.Height-4:e.Y+4,v.Bottom=v.Top+v.Height,m>0?v.Top<=u&&(v.Top=u,v.Bottom=v.Top+v.Height):v.Bottom>=l&&(v.Bottom=l,v.Top=v.Bottom-v.Height),this.Label.EnableBGColor){var p=new Path2D;p.roundRect(A(v.Left),A(v.Top),b(v.Width),b(v.Height),[3]),this.Canvas.fillStyle=this.Label.BGColor,this.Canvas.fill(p)}this.Canvas.fillStyle=this.Label.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillText(I,v.Left+2+this.Label.LeftMargin,v.Bottom-2)}}function Wi(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartDatePriceRange",this.PointCount=2,this.Font=12*F()+"px 微软雅黑",this.TextColor=this.LineColor,this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointToValue_Default=this.PointToValue,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LineWidth=1,this.EnableBGColor=!0,this.BGColor=Ha.ColorToRGBA(this.LineColor,.15),this.ExtendLine={Top:!1,Bottom:!1},this.Label={TextColor:"rgb(0,0,0)",BGColor:"rgb(211,211,211)",EnableBGColor:!0,LeftMargin:5,RightMargin:5},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.DrawRange(e,a),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawRange=function(t,e){var a=Math.min(t.Y,e.Y),i=Math.max(t.Y,e.Y),r=Math.min(t.X,e.X),n=Math.max(t.X,e.X),o=t.Y+(e.Y-t.Y)/2,s=t.X+(e.X-t.X)/2;if(this.ExtendLine.Top&&(a=this.Frame.ChartBorder.GetTopEx()),this.ExtendLine.Bottom&&(i=this.Frame.ChartBorder.GetBottomEx()),this.EnableBGColor){var h={Left:r,Top:a,Right:n,Bottom:i};h.Width=h.Right-h.Left,h.Height=h.Bottom-h.Top,this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(h.Left,h.Top,h.Width,h.Height)}this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(A(r),a),this.Canvas.lineTo(A(r),i),this.Canvas.moveTo(A(n),a),this.Canvas.lineTo(A(n),i),this.Canvas.moveTo(A(r),A(o)),this.Canvas.lineTo(A(n),A(o)),this.Canvas.moveTo(A(s),A(a)),this.Canvas.lineTo(A(s),A(i)),this.Canvas.stroke(),this.LinePoint.push({Start:{X:r,Y:a},End:{X:r,Y:i}}),this.LinePoint.push({Start:{X:n,Y:a},End:{X:n,Y:i}}),this.LinePoint.push({Start:{X:r,Y:o},End:{X:n,Y:o}}),this.DrawArrow({X:t.X,Y:A(o)},{X:e.X,Y:A(o)}),this.DrawArrow({X:A(s),Y:t.Y},{X:A(s),Y:e.Y});var l=this.Frame.ChartBorder.GetBottomEx(),u=this.Frame.ChartBorder.GetTopEx(),C=this.Frame.GetXData(t.X,!1),D=this.Frame.GetXData(e.X,!1),f=D-C+1,c=this.Frame.GetYData(t.Y,!1),m=this.Frame.GetYData(e.Y,!1),d=m-c,I=d/c*100,S=["".concat(d.toFixed(2)," (").concat(I.toFixed(2),"%)"),"".concat(f," bars")];this.Canvas.font=this.Font;for(var T=this.GetFontHeight(),v=0,p=0;p<S.length;++p){var g=S[p],x=this.Canvas.measureText(g).width;v<x&&(v=x)}v+=this.Label.LeftMargin+this.Label.RightMargin;var F={Left:s-v/2,Top:e.Y+4,Width:v,Height:S.length*T+2};if(F.Top=d>0?e.Y-F.Height-4:e.Y+4,F.Bottom=F.Top+F.Height,d>0?F.Top<=u&&(F.Top=u,F.Bottom=F.Top+F.Height):F.Bottom>=l&&(F.Bottom=l,F.Top=F.Bottom-F.Height),this.Label.EnableBGColor){var E=new Path2D;E.roundRect(A(F.Left),A(F.Top),b(F.Width),b(F.Height),[3]),this.Canvas.fillStyle=this.Label.BGColor,this.Canvas.fill(E)}this.Canvas.fillStyle=this.Label.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var L=F.Bottom-2;for(p=0;p<S.length;++p){g=S[p];this.Canvas.fillText(g,F.Left+2+this.Label.LeftMargin,L),L-=T}}}function Ui(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartInfoLine",this.PointCount=2,this.Font=12*F()+"px 微软雅黑",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsShowYCoordinate=!1,this.CopyData=this.CopyData_default,this.OnlyMoveXIndex=!0,this.IsSupportMagnet=!0,this.LabelConfig={Font:"".concat(12*F(),"px 微软雅黑"),BGColor:"rgba(135, 206 ,250,0.95)",Mergin:{Left:10,Right:10,Top:10,Bottom:8},LineSpace:5,TextAlign:1},this.FormatLabelTextCallback=null,this.SetOption=function(t){if(t.LineColor&&(this.LineColor=t.LineColor),t.PointColor&&(this.PointColor=t.PointColor),t.Label){var e=t.Label,a=this.LabelConfig;e.Font&&(a.Font=e.Font),e.BGColor&&(a.BGColor=e.BGColor),sa.IsNumber(e.LineSpace)&&(a.LineSpace=e.LineSpace),sa.IsNumber(e.TextAlign)&&(a.TextAlign=e.TextAlign),e.Mergin&&G(a.Mergin,e.Mergin)}t.FormatLabelTextCallback&&(this.FormatLabelTextCallback=t.FormatLabelTextCallback)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.IsShow){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!1});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t);var r={};r.Config=this.LabelConfig,r.PtStart=e,r.PtEnd=a,this.Canvas.restore(),this.DrawLabel(r)}}},this.DrawLabel=function(t){if(this.FormatLabelTextCallback&&(t.AryPoint=this.Point,10!=this.Status?t.AryValue=this.PointToKLine(this.Point):t.AryValue=this.Value,t.Data=this.Frame.Data,this.FormatLabelTextCallback(t),sa.IsNonEmptyArray(t.AryText))){this.CalculateLabelSize(t);var e=t.PtStart,a=t.PtEnd;e.X>a.X&&(e=t.PtEnd,a=t.PtStart);t.Config;var i=t.PtStart.X+(t.PtEnd.X-t.PtStart.X)/2,r=t.PtStart.Y+(t.PtEnd.Y-t.PtStart.Y)/2;if(e.Y<a.Y){var n={Left:i,Bottom:r,Width:t.Width,Height:t.Height};n.Right=n.Left+n.Width,n.Top=n.Bottom-n.Height}else{n={Left:i,Top:r,Width:t.Width,Height:t.Height};n.Right=n.Left+n.Width,n.Bottom=n.Top+n.Height}this.DrawDefaultLabel(t,n)}}}function Ki(){this.newMethod=Ha,this.newMethod(),delete this.newMethod,this.ClassName="ChartBarsPattern",this.PointCount=2,this.KData=null,this.Draw=function(){}}function zi(){this.DrawData=new Map,this.StorageKey,this.GetEventCallback,this.Load=function(t){if(t){this.StorageKey=t;var e=localStorage[this.StorageKey];if(u.Chart.Log("[ChartDrawStorage::Load] Load to localStorage, key=".concat(this.StorageKey,", cache=").concat(e)),e&&"string"==typeof e){var a=JSON.parse(e);for(var i in a){var r=a[i],n=new Map;for(var o in r.Value){var s=r.Value[o];n.set(s.Key,s.Value)}this.DrawData.set(r.Key,n)}}}},this.Save=function(){if(this.StorageKey){var t,e=[],a=(0,l.default)(this.DrawData);try{for(a.s();!(t=a.n()).done;){var i,r=t.value,n=r[0],o=r[1],s={Key:n,Value:[]},h=(0,l.default)(o);try{for(h.s();!(i=h.n()).done;){var C=i.value;C[1]&&!1===C[1].EnableSave||s.Value.push({Key:C[0],Value:C[1]})}}catch(f){h.e(f)}finally{h.f()}sa.IsNonEmptyArray(s.Value)&&e.push(s)}}catch(f){a.e(f)}finally{a.f()}u.Chart.Log("[ChartDrawStorage::Save] save to localStorage, key=".concat(this.StorageKey));var D=JSON.stringify(e);localStorage[this.StorageKey]=D}},this.GetItemKey=function(t){var e="".concat(t.Symbol,"-").concat(t.Period);return e},this.SaveDrawData=function(t){var e=this.GetItemKey(t),a=t.ExportStorageData();if(a){if(this.DrawData.has(e))u.Chart.Log("[ChartDrawStorage::SaveDrawData] Upate: key, drawPicture, data",e,t,a),this.DrawData.get(e).set(a.Guid,a);else{u.Chart.Log("[ChartDrawStorage::SaveDrawData] Insert: key, drawPicture, data",e,t,a);var i=new Map;i.set(a.Guid,a),this.DrawData.set(e,i)}u.Chart.Log("[ChartDrawStorage::SaveDrawData] All draw data： ",this.DrawData),this.Save()}},this.DeleteDrawData=function(t){var e=this.GetItemKey(t);if(this.DrawData.has(e)){var a=this.DrawData.get(e);a.has(t.Guid)&&(a.delete(t.Guid),this.Save())}},this.Clear=function(){this.DrawData=new Map,this.Save()},this.GetDrawData=function(t){var e=[],a=this.GetItemKey(t);if(!this.DrawData.has(a))return e;var i,r=this.DrawData.get(a),n=(0,l.default)(r);try{for(n.s();!(i=n.n()).done;){var o=i.value;e.push(o[1])}}catch(s){n.e(s)}finally{n.f()}return e}}function Ji(){this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.4,.01],[.5,1,.5,.05],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,20,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,1e4,1e3],[4e4,5e4,1e4,1e3],[5e4,1e5,1e4,1e3],[1e5,2e5,1e5,1e4],[2e5,4e5,1e5,1e4],[4e5,5e5,1e5,1e4],[5e5,1e6,1e5,1e4],[1e6,2e6,1e6,1e5],[2e6,4e6,1e6,1e5],[4e6,5e6,1e6,1e5],[5e6,1e7,1e6,1e5],[1e7,2e7,1e7,1e6],[2e7,4e7,1e7,1e6],[4e7,5e7,1e7,1e6],[5e7,1e8,1e7,1e6],[1e8,2e8,1e8,1e7],[2e8,4e8,1e8,1e7],[4e8,5e8,1e8,1e7],[5e8,1e9,1e8,1e7],[1e9,2e9,1e9,1e8],[2e9,4e9,1e9,1e8],[4e9,5e9,1e9,1e8],[5e9,1e10,1e9,1e8]],this.Find=function(t){for(var e in this.Data){var a=this.Data[e];if(t>a[0]&&t<=a[1]){var i={};return i.FixInterval=a[2],i.Increase=a[3],i}}return null}}function Zi(){this.newMethod=Ji,this.newMethod(),delete this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,1e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.001],[.04,.05,.04,.001],[.05,.1,.05,.001],[.1,.2,.1,.01],[.2,.4,.2,.01],[.4,.5,.2,.01],[.5,.8,.2,.01],[.8,1,.5,.01],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]}function Qi(){this.IsDOMFrameTitle=!1,this.IsDOMFrameToolbar=!1,this.KLineToolbar={ModifyIndex:!0,ChangeIndex:!0,CloseIndex:!0,OverlayIndex:!1,MaxMinWindow:!0,TitleWindow:!0,ExportData:!1,AddIndexWindow:!1,IsShowOverlayToolbar:!0,IsShowOverlayFrame:!0},this.MinuteToolbar={ModifyIndex:!0,ChangeIndex:!0,CloseIndex:!0,OverlayIndex:!0,MaxMinWindow:!0,TitleWindow:!0,ExportData:!1,AddIndexWindow:!1},this.TooltipBGColor="rgb(255, 255, 255)",this.TooltipAlpha=.92,this.PopMinuteChart={BGColor:"rgba(250,250,250,0.95)",BorderColor:"rgb(0,0,0)",TitleColor:"rgb(250,250,250)",TitleBGColor:"rgb(200, 66, 69)",Mark:{LineColor:"rgba(255,165,0,0.6)",LineWidth:2}},this.PopKLineChart={BGColor:"rgba(250,250,250,0.95)",BorderColor:"rgb(0,0,0)",TitleColor:"rgb(250,250,250)",TitleBGColor:"rgb(200, 66, 69)"},this.SelectRectBGColor="rgba(1,130,212,0.06)",this.UpBarColor="rgb(238,21,21)",this.DownBarColor="rgb(25,158,0)",this.UnchagneBarColor="rgb(0,0,0)",this.EmptyBarBGColor="rgb(255,255,255)",this.HighLowBarColor="rgb(41,98,255)",this.HighLowText={FontName:"arial",MaxSize:30,MinSize:4,Color:"rgb(41,98,255)",MaxText:"9999.9"},this.SplashScreen={BGColor:"rgba(112,128,144,0.5)",Title:"下载数据中......",TextColor:"rgb(43,54,69)",Font:14*F()+"px 微软雅黑"},this.HLCArea={HighLineColor:"rgb(242,54,69)",LowLineColor:"rgb(8,153,129)",CloseLineColor:"rgb(224,227,227)",LineWidth:2*F(),UpAreaColor:"rgba(253,214,218, 0.5)",DownAreaColor:"rgba(205,235,230, 0.5)"},this.Minute={},this.Minute.VolBarColor=null,this.Minute.VolTitleColor="rgb(105,105,105)",this.Minute.PriceColor="rgb(50,171,205)",this.Minute.PriceLineWidth=1*F(),this.Minute.AreaPriceColor="rgba(50,171,205,0.1)",this.Minute.AvPriceColor="rgb(238,127,9)",this.Minute.PositionColor="rgb(218,165,32)",this.Minute.FrameSplitTextColor=null,this.Minute.Before={BGColor:"rgba(240,240,240,0.7)",LineColor:"rgb(50,171,205)",VolColor:["rgb(192,192,0)"],AvPriceColor:"rgb(190,190,190)",Point:{Color:"rgb(65,105,225)",Radius:2*F()},CloseIcon:{Family:"iconfont",Text:"",Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Size:12*F()}},this.Minute.After={BGColor:"rgba(240,240,240,0.7)",LineColor:"rgb(50,171,205)",VolColor:["rgb(192,192,0)"],AvPriceColor:"rgb(190,190,190)",Point:{Color:"rgb(65,105,225)",Radius:2*F()}},this.Minute.NightDay={NightBGColor:"rgba(0,0,0,0.2)",Font:"".concat(12*F(),"px 微软雅黑"),Day:{Color:"rgb(0,0,0)",BGColor:"rgb(179,179,179)",BorderColor:"rgb(179,179,179)",Margin:{Left:5,Top:2,Bottom:2,Right:5}},Night:{Color:"rgb(0,0,0)",BGColor:"rgb(179,179,179)",BorderColor:"rgb(179,179,179)",Margin:{Left:5,Top:2,Bottom:2,Right:5}}},this.Minute.BuySellBar={BuyColor:"rgb(242,54,69)",SellColor:"rgb(8,153,129)",BarWidth:4*F(),MaxBarWidth:120,YOffset:1,Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(128,128,128)",AryBarRange:[{Start:240,End:120},{Start:120,End:0}]},this.DefaultTextColor="rgb(43,54,69)",this.DefaultTextFont=14*F()+"px 微软雅黑",this.TitleFont=13*F()+"px 微软雅黑",this.IndexTitleBGColor="rgb(250,250,250)",this.IndexTitleBorderColor="rgb(180,180,180)",this.IndexTitleBorderMoveOnColor="rgb(0,0,0)",this.IndexTitleBorderStyle=1,this.IndexTitleColor="rgb(43,54,69)",this.IndexTitleSelectedColor="rgb(65,105,225)",this.OverlayIndexTitleBGColor="rgba(255,255,255,0.7)",this.IndexTitleMerginLeft=1,this.IndexTitle={UpDownArrow:{UpColor:"rgb(238,21,21)",DownColor:"rgb(25,158,0)",UnchangeColor:"rgb(0,0,0)"},ArrowType:0,EnableIndexArrow:!0,NameArrow:{Color:"rgb(43,54,69)",Space:2,Symbol:"▼"}},this.Title={TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(43,54,69)",AmountColor:"rgb(43,54,69)",DateTimeColor:"rgb(43,54,69)",SettingColor:"rgb(43,54,69)",NameColor:"rgb(43,54,69)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(43,54,69)"},this.UpTextColor="rgb(238,21,21)",this.DownTextColor="rgb(25,158,0)",this.UnchagneTextColor="rgb(0,0,0)",this.CloseLineColor="rgb(0,191,255)",this.CloseLineAreaColor=["rgba(0,191,255,0.8)","rgba(0,191,255,0.2)"],this.CloseLineWidth=2,this.FrameBorderPen="rgb(225,236,242)",this.MultiDayBorderPen="rgb(225,236,242)",this.FrameSplitPen="rgb(225,236,242)",this.FrameDotSplitPen="rgb(105,105,105)",this.FrameYLineDash=null,this.FrameXLineDash=null,this.FrameSplitTextColor="rgb(117,125,129)",this.FrameSplitTextFont=14*F()+"px 微软雅黑",this.FrameTitleBGColor="rgb(246,251,253)",this.SelFrameBorderColor="rgb(130, 130, 130)",this.Frame={XBottomOffset:2*F(),YTopOffset:2*F(),YTextPadding:[2,2],EnableRemoveZero:!0,StringFormat:0},this.ToolbarButtonStyle=0,this.FrameLogo={TextColor:"rgb(178,34,34)",Font:"bold "+16*F()+"px 微软雅黑",Text:"*仅学习使用*",BGColor:"rgba(230,230,230, 0.5)"},this.Frame.PercentageText={PriceColor:"rgb(117,125,129)",PercentageColor:"rgb(117,125,129)",SplitColor:"rgb(117,125,129)",Font:14*F()+"px 微软雅黑"},this.FrameLogarithmic={OpenPriceFont:"bold "+14*F()+"px 微软雅黑",MinInterval:45*F()},this.FrameSplitIncrease={Increase:.1},this.FrameSplitAverage={Count:4},this.FrameGoldenSection={Golden:[0,.191,.382,.5,.618,.809,1]},this.FrameLatestPrice={TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(0,0,0)",BGAlpha:.6,EmptyBGColor:"rgb(255,255,255)",OverlayTextColor:"rgb(255,255,255)"},this.FrameMargin=4,this.FrameLeftMargin=2,this.FrameRightMargin=2,this.DragSubFrameBorder={TopBorderHeight:6*F(),MinFrameHeight:50*F()},this.OverlayFrame={BolderPen:"rgb(190,190,190)",TitleColor:"rgb(105,105,105)",TitleFont:11*F()+"px arial"},this.CorssCursorBGColor="rgb(43,54,69)",this.CorssCursorTextColor="rgb(255,255,255)",this.CorssCursorTextFont=14*F()+"px 微软雅黑",this.CorssCursorHPenColor="rgb(130,130,130)",this.CorssCursorVPenColor="rgb(130,130,130)",this.CorssCursorXRangeBGColor="rgba(100,149,237,0.3)",this.CorssCursorLineDash=[3*F(),2*F()],this.CorssCursor={RightButton:{BGColor:"rgb(43,54,69)",PenColor:"rgb(255,255,255)",Icon:{Text:"",Color:"rgb(255,255,255)",Family:"iconfont",Size:14}},BottomText:{Margin:{Left:4,Right:4,Top:0,Bottom:0},TextOffset:{X:4,Y:-1},Align:1},LeftText:{Margin:{Left:4,Right:4,Top:0,Bottom:0},TextOffset:{X:4,Y:-1}},RightText:{Margin:{Left:4,Right:4,Top:0,Bottom:0},TextOffset:{X:4,Y:-1}},RightOverlayText:{Margin:{Left:2,Right:2,Top:0,Bottom:0},TextOffset:{X:2,Y:-1}},CorssPoint:{Center:{Radius:5*F(),Color:"rgb(50,171,205)"},Border:{Color:"rgb(255,255,255)",Width:1*F()}}},this.IndexLock={BGColor:"rgb(220, 220, 220)",TextColor:"rgb(210, 34, 34)",Font:"".concat(14*F(),"px 微软雅黑"),Title:"🔒开通权限"},this.Domain="http://127.0.0.1:8080",this.CacheDomain="http://127.0.0.1:8087",this.PyIndexDomain="http://127.0.0.1:8088",this.KLine={MaxMin:{Font:12*F()+"px 微软雅黑",Color:"rgb(43,54,69)",RightArrow:"→",LeftArrow:"←",HighYOffset:0,LowYOffset:0},Info:{Investor:{ApiUrl:"/API/NewsInteract",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#1c65db"}},Announcement:{ApiUrl:"/API/ReportList",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#f5a521"},IconFont2:{Family:"iconfont",Text:"",HScreenText:"",Color:"#ed7520"}},Pforecast:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#986cad"}},Research:{ApiUrl:"/API/InvestorRelationsList",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#19b1b7"}},BlockTrading:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#f39f7c"}},TradeDetail:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#b22626"}},IconLibrary:{Family:"iconfont",Icon:[{Text:"",HScreenText:"",Color:"#f39f7c"},{Text:"",HScreenText:"",Color:"#19b1b7"},{Text:"",HScreenText:"",Color:"#b22626"},{Text:"",HScreenText:"",Color:"#ed7520"}]}},NumIcon:{Color:"rgb(251,80,80)",Family:"iconfont",Text:["","","","","","","","","","","","","","","","","","","","",""]},TradeIcon:{Family:"iconfont",Buy:{Color:"rgb(255,15,4)",Text:"",HScreenText:""},Sell:{Color:"rgb(64,122,22)",Text:"",HScreenText:""}}},this.VirtualKLine={Color:"rgb(100,100,100)",LineDash:[2,2]},this.PredictionKLine={Line:{Color:"rgb(100,100,100)",LineDash:[3,5],LineWidth:2},Bar:{UpColor:"rgb(65,105,225)",DownColor:"rgb(65,105,225)",UnchangeColor:"rgb(65,105,225s)",DrawType:3}},this.PriceGapStyple={Line:{Color:"rgb(186,186,186)"},Text:{Color:"rgb(105,105,105)",Font:"".concat(12*F(),"px 微软雅黑")}},this.DaySummaryKLine={Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(105,105,105)",LeftMargin:2*F()},this.OrderFlow={UpColor:{BG:"rgb(223,191,180)",Border:"rgb(196,84,86)"},DownColor:{BG:"rgb(176,212,184)",Border:"rgb(66,94,74)"},UnchagneColor:{BG:"rgb(216,221,177)",Border:"rgb(209,172,129)"},Text:{Color:"rgb(92,96,89)",Family:"Arial",FontMaxSize:18,MaxValue:"8888"},Line:{UpDownColor:"rgb(0,0,0)",MiddleColor:"rgb(211,211,211)"},AlwaysShowOrderText:!0,POCGBColor:"rgba(178,34,34,0.8)",AskBarColor:"rgb(14,209,69)",BidBarColor:"rgb(236,28,36)"},this.OrderFlow_Style2={BarWidth:10,UpColor:"rgb(241,55,63)",DownColor:"rgb(75,105,150)",UnchagneColor:"rgb(79,79,79)"},this.OrderFlow_Style3={BarWidth:20,UpColor:"rgb(241,55,63)",DownColor:"rgb(75,105,150)",UnchagneColor:"rgb(79,79,79)"},this.OrderFlow_Style4={KBarWidth:5,UpColor:"rgb(241,55,63)",DownColor:"rgb(75,105,150)",UnchagneColor:"rgb(79,79,79)",VolBarSpace:1,LeftMargin:1,RightMargin:1},this.OrderFlow_Style5={AskBarColor:"rgb(176,22,22)",BidBarColor:"rgb(98,126,176)",LeftMargin:3,RightMargin:2},this.Index={},this.Index.LineColor=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],this.OverlaySymbol={Random:0},this.OverlaySymbol.Color=["rgb(38,198,218)","rgb(103,58,183)","rgb(0,191,165)","rgb(130,177,255)"],this.Index.StockHistoryDayApiUrl="http://127.0.0.1:8080/API/StockHistoryDay",this.Index.MarketLongShortApiUrl="http://127.0.0.1:8080/API/FactorTiming",this.Index.MarketAttentionApiUrl="http://127.0.0.1:8080/API/MarketAttention",this.Index.MarketHeatApiUrl="http://127.0.0.1:8080/API/MarketHeat",this.Index.CustomIndexHeatApiUrl="http://127.0.0.1:8080/API/QuadrantCalculate",this.Index.NotSupport={Font:"".concat(14*F(),"px 微软雅黑"),TextColor:"rgb(52,52,52)"},this.Buttons={CloseOverlayIndex:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:12*F(),MerginLeft:3},CloseWindow:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},ChangeIndex:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},OverlayIndex:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},ModifyIndexParam:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},MaxMinWindow:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},TitleWindow:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},ExportData:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},AddIndexWindow:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},Tooltip:{Font:13*F()+"px 微软雅黑",Color:"rgb(71,71,71)",ColorBG:"rgb(255,255,255)",ColorBorder:"rgb(0,0,0)",BorderRadius:2,Mergin:{Left:4,Right:4,Top:2,Bottom:3}}},this.DrawPicture={LineColor:["rgb(41,98,255)"],PointColor:["rgb(41,98,255)","rgb(89,135,255)","rgb(255,255,255)"],XYCoordinate:{BGColor:"rgba(203,216,255,0.5)",TextBGColor:"rgb(52,101,255)",TextColor:"rgb(255,255,255)",Font:14*F()+"px 微软雅黑"},PointType:2,IsShowPoint:!1},this.ChartOX={Family:"iconfont",Up:{Color:"rgb(178,34,34)",Text:""},Down:{Color:"rgb(0,206,209)",Text:""},SquareLineColor:"rgb(119,136,153)"},this.KLineTrain={Font:"bold 14px arial",LastDataIcon:{Color:"rgb(0,0,205)",Text:"⬇"},BuyIcon:{Color:"rgb(0,205,102 )",Text:"B"},SellIcon:{Color:"rgb(255,127,36 )",Text:"S"},IconFont:{Family:"iconfont",Buy:{Text:"",HScreenText:"",Color:"rgb(255,140,0)"},Sell:{Text:"",HScreenText:"",Color:"rgb(6,79,18)"},Last:{Text:"",HScreenText:"",Color:"rgb(55,0,255)"}}},this.ChartKLineTable={TextFont:{Family:"Arial",FontMaxSize:25},ItemMergin:{Left:5,Right:5,Top:4,Bottom:2}},this.ChartSimpleTable={TextFont:{Family:"微软雅黑",Size:14},ItemMargin:{Left:5,Right:5,Top:4,Bottom:2},TextColor:"rgb(0,0,0)",BGColor:"rgba(255,255,255,0.95)",BorderColor:"rgb(217,217,217)"},this.ChartSimplePie={TextFont:{Family:"微软雅黑",Size:12},BorderColor:"rgb(169,169,169)",Offset:{X:-5,Y:5}},this.ChartSimpleDoughnut={TextFont:{Family:"微软雅黑",Size:12},BorderColor:"rgb(169,169,169)",Offset:{X:-5,Y:5}},this.ChartSimpleRadar={TextFont:{Family:"微软雅黑",Size:12},BorderColor:"rgb(169,169,169)",Offset:{X:-5,Y:5},TextColor:"rgb(105,105,105)",AryBGColor:["rgba(255,255,255,0.9)","rgba(230, 234, 242,0.9)"],AryArea:[{Color:"rgba(242,154,118,0.4)",LineColor:"rgb(242,154,118)"},{Color:"rgba(121,197,228,0.4)",LineColor:"rgb(92,165,196)"}]},this.TooltipPaint={BGColor:"rgba(250,250,250,0.8)",BorderColor:"rgb(120,120,120)",TitleColor:"rgb(79, 79, 79)",TitleFont:13*F()+"px 微软雅黑",DateTimeColor:"rgb(105 105 105)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(79, 79, 79)"},this.PCTooltipPaint={BGColor:"rgba(250,250,250)",BorderColor:"rgb(120,120,120)",TitleColor:"rgb(60,60,60)",TitleFont:12*F()+"px 微软雅黑",DateTimeColor:"rgb(60,60,60)",VolColor:"rgb(60,60,60)",AmountColor:"rgb(60,60,60)",PositionColor:"rgb(60,60,60)"},this.PCTooltip={LineHeight:25},this.DialogTooltip={BGColor:"rgb(250,250,250)",BorderColor:"rgb(20,20,20)",TitleColor:"rgb(250,250,250)",TitleBGColor:"rgb(200, 66, 69)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(79, 79, 79)",DateTimeColor:"rgb(60,60,60)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(255,0,255)",TextColor:"rgb(0,0,0)",ValueColor:"rgb(0,0,0)"},this.FloatTooltip={BGColor:"rgb(250,250,250)",BorderColor:"rgb(20,20,20)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(79, 79, 79)",DateTimeColor:"rgb(60,60,60)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(255,0,255)",TextColor:"rgb(0,0,0)",ValueColor:"rgb(0,0,0)"},this.DialogSelectRect={BGColor:"rgb(250,250,250)",BorderColor:"rgb(20,20,20)",TitleColor:"rgb(0,0,0)",TextColor:"rgb(0,0,0)",ValueColor:"rgb(0,0,0)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(79, 79, 79)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(255,0,255)"},this.DialogPopKeyboard={BGColor:"rgb(250,250,250)",BorderColor:"rgb(20,20,20)",TitleColor:"rgb(0,0,0)",TitleBGColor:"rgb(200, 66, 69)",Input:{BGColor:"rgb(250,250,250)",TextColor:"rgb(0,0,0)"}},this.DialogSearchIndex={BGColor:"rgb(250,250,250)",BorderColor:"rgb(20,20,20)",TitleColor:"rgb(250,250,250)",TitleBGColor:"rgb(200, 66, 69)",IndexNameColor:"rgb(0,0,0)",GroupNameColor:"rgb(0,0,0)",InputTextColor:"rgb(0,0,0)"},this.DialogModifyIndexParam={BGColor:"rgb(250,250,250)",BorderColor:"rgb(20,20,20)",TitleColor:"rgb(250,250,250)",TitleBGColor:"rgb(200, 66, 69)",ParamNameColor:"rgb(0,0,0)",InputTextColor:"rgb(0,0,0)"},this.Barrage={Font:16*F()+"px 微软雅黑",Height:20,Color:"RGB(109,109,109)"},this.MinuteInfo={TextColor:"rgb(84,143,255)",Font:14*F()+"px 微软雅黑",PointColor:"rgb(38,113,254)",LineColor:"rgb(120,167,255)",TextBGColor:"rgba(255,255,255,0.8)",PointRadius:4*F()},this.ChartDrawRuler={TitleColor:null},this.ChartDrawWaveRuler={RulerWidth:10,RulerLineWidth:1,MaxScaleRuler:2,Font:14*F()+"px 微软雅黑",ScaleRuler:[{Value:0,Text:"0.0%"},{Value:.382,Text:"38.2%"},{Value:.618,Text:"61.8%"},{Value:1,Text:"100%"},{Value:1.618,Text:"161.8%"},{Value:2,Text:"200%"}]},this.ChartDrawWaveRuler2Point={RulerWidth:20,RulerLineWidth:1,MaxScaleRuler:2,Font:14*F()+"px 微软雅黑",ScaleRuler:[{Value:0,Text:"base"},{Value:.618,Text:"61.8%"},{Value:1,Text:"100%"},{Value:1.618,Text:"161.8%"}]},this.ChartDrawVolProfile={BGColor:"rgba(244,250,254,0.8)",BorderColor:"rgba(255,255,255)",VolLineColor:"rgb(232,5,9)",UpVolColor:"rgba(103,179,238, 0.24)",DownVolColor:"rgba(237,208,105,0.24)",AreaUpColor:"rgb(103,179,238,0.7)",AreaDonwColor:"rgba(237,208,105,0.7)",Text:{Color:"rgb(0,0,0)",Family:"Arial",FontMaxSize:18,FontMinSize:6}},this.ChartVolProfileVisibleRange={VolLineColor:"rgb(232,5,9)",VolLineFont:14*F()+"px 微软雅黑",VolLineTextColor:"rgb(255,255,255)",UpVolColor:"rgba(103,179,238, 0.24)",DownVolColor:"rgba(237,208,105,0.24)",AreaUpColor:"rgb(103,179,238,0.7)",AreaDonwColor:"rgba(237,208,105,0.7)",Text:{Color:"rgb(0,0,0)",Family:"Arial",FontMaxSize:18,FontMinSize:6},VAHLineColor:"rgb(0,0,255)",VAHTextColor:"rgb(255,255,255)",VALLineColor:"rgb(0,0,255)",VALTextColor:"rgb(255,255,255)",VAFont:14*F()+"px 微软雅黑"},this.ChartDrawNote={Text:"",FontOption:{Family:"iconfont",Size:32},NoteFontOption:{Family:"微软雅黑",Size:12,Weight:null,Style:null},NoteWidth:200,NoteMargin:{Left:5,Top:5,Bottom:5,Right:5},NoteBGColor:"rgba(104,114,255,0.7)",NoteTextColor:"rgb(240,240,240)",NoteBorderColor:"rgb(220,220,220)",LineSpace:3,ArrowSize:10},this.ChartDrawAnchoredText={TextMargin:{Left:5,Top:5,Bottom:5,Right:5},BGColor:"rgba(104,114,255,0.7)",BorderColor:"rgb(220,220,220)",TextColor:"rgb(0,0,0)",FontOption:{Family:"微软雅黑",Size:12,Weight:null,Style:null},LineSpace:2,TextMaxWidth:-1},this.ChartDrawPriceLabel={TextMargin:{Left:10,Top:5,Bottom:5,Right:10},BGColor:"rgba(104,114,255,0.7)",BorderColor:"rgb(220,220,220)",TextColor:"rgb(0,0,0)",FontOption:{Family:"微软雅黑",Size:14,Weight:null,Style:null}},this.ChartDrawPriceNote={TextMargin:{Left:10,Top:5,Bottom:5,Right:10},BGColor:"rgba(104,114,255,0.7)",BorderColor:"rgb(220,220,220)",TextColor:"rgb(0,0,0)",FontOption:{Family:"微软雅黑",Size:14,Weight:null,Style:null}},this.DRAWICON={Icon:{MaxSize:24,MinSize:12,YOffset:0,Zoom:{Type:1,Value:1}},Text:{MaxSize:50,MinSize:12,YOffset:0,Zoom:{Type:1,Value:1},FontName:"Arial"}},this.DRAWTEXT={MaxSize:30,MinSize:20,YOffset:0,Zoom:{Type:1,Value:1},FontName:"微软雅黑"},this.DRAWNUMBER={MaxSize:30,MinSize:20,YOffset:0,Zoom:{Type:1,Value:1},FontName:"微软雅黑"},this.DRAWABOVE={YOffset:0},this.DRAWTEXT_FIX={Font:14*F()+"px 微软雅黑"},this.DRAWNUMBER_FIX={Font:14*F()+"px 微软雅黑"},this.DOTLINE={LineDash:[3,5]},this.DRAWSL={PixelWidth:15},this.CIRCLEDOT={Radius:1.3*F()},this.TIPICON={Family:"iconfont",TextFont:"".concat(F(),"px 微软雅黑"),Size:10*F(),Color:"rgb(255,165,0)"},this.POINTDOT={Radius:2*F()},this.DepthMapPaint={LineColor:"rgba(255,185,15)",AreaColor:["rgba(255,185,15,0.8)","rgba(255,185,15,0.4)"],TextColor:"rgba(255,255,255)",TextBGColor:"rgb(43,54,69)"},this.KLineYAxisBGPaint={Font:12*F()+"px 微软雅黑",LineColor:"rgb(117,125,129)",DiffValutTextColor:"rgb(117,125,129)",DiffValueBGColor:"rgb(251,140,1)"},this.ChartScatterPlotV2={Color:"rgb(0,0,255)",TextColor:"rgb(0,0,0)",Radius:3,Font:"".concat(10*F(),"px 微软雅黑")},this.StockChip={InfoColor:"rgb(0,0,0)",DayInfoColor:"rgb(255,255,255)",Font:"".concat(12*F(),"px 微软雅黑"),DefaultButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(255,0,0)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},LongButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(255,128,0)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},RecentButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(0,0,204)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},CloseButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(0,0,204)",Family:"iconfont",Text:"",Size:13*F(),MerginLeft:4},PhoneCloseButton:{Family:"iconfont",Size:16*F(),Text:"",Color:"rgb(255,255,255)",Border:{BGColor:"rgb(169,169,169)"}}},this.DepthChart={BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.8)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.8)"},LineWidth:4},this.DepthCorss={BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(236,240,245, 0.8)",TextColor:"rgb(130,140,151)",Border:{Top:5,Left:20,Right:20,Bottom:5,ItemSpace:5},Font:14*F()+"px 微软雅黑"}},this.RectSelect={LineColor:"rgb(64,64,64)",LineWidth:1*F(),LineDotted:[3,3],AreaColor:"rgba(234,234,234,0.5)",SubAreaColor:"rgba(105,105,105,0.5)",RangeTextColor:"rgb(248,248,255)",RangeTextFont:14*F()+"px 微软雅黑",RangeTextBGColor:"rgb(43,54,69)",RangeTextSubColor:"rgb(255,255,255)",RangeTextSubFont:12*F()+"px 微软雅黑",RangeTextSubBGColor:"rgb(54,54,54)",Mark:{Family:"iconfont",Text:"",Color:"rgb(250,0,0)",Size:15*F(),Position:{Index:0,Top:"TopEx"}}},this.SelectedChart={LineWidth:1,LineColor:"rgb(55,100,100)",Radius:4,MinSpace:200,BGColor:"rgb(255,255,255)"},this.RectDrag={LineColor:"rgb(0,0,0)",LineWidth:1*F(),BGColor:"rgba(128,128,128,0.2)"},this.DragMovePaint={TextColor:"rgb(0,0,0)",Font:14*F()+"px 微软雅黑"},this.SessionBreaksPaint={BGColor:[null,"rgb(245,246,246)"],SplitLine:{Color:"rgb(73,133,231)",Width:1*F(),Dash:[5*F(),5*F()]}},this.DealList={BorderColor:"rgb(192,192,192)",Header:{Color:"RGB(60,60,60)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:12,Name:"微软雅黑"}},Row:{Mergin:{Top:2,Bottom:2},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2}},FieldColor:{Vol:"rgb(90,90,90)",Time:"rgb(60,60,60)",Deal:"rgb(90,90,90)",Index:"rgb(60,60,60)",BarTitle:"rgb(60,60,60)",Text:"rgb(60,60,60)",Bar:["rgb(255,0,0)","rgb(34,139,34)","rgb(119,136,153)","rgb(75,0,130)","rgb(65,105,225)","rgb(255,215,0)","rgb(255,0,255)","rgb(128,128,0)"]},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(0,0,0)",Selected:{BGColor:"rgb(180,240,240)"}},this.Report={BorderColor:"rgb(192,192,192)",SelectedColor:"rgb(180,240,240)",SelectedLine:{Color:"rgb(180,240,240)",Width:2},Header:{Color:"rgb(60,60,60)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:4},Font:{Size:12,Name:"微软雅黑"}},SortIcon:{Size:12,Family:"iconfont",Arrow:["","",""],Color:["rgb(169,169,169)","rgb(51,51,51)","rgb(51,51,51)"],Margin:{Left:1*F(),Bottom:2,Right:0}},Item:{Mergin:{Top:2,Bottom:4,Left:5,Right:5},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},FixedItem:{Font:{Size:15,Name:"微软雅黑"}},LimitBorder:{Color:"rgb(180,180,180)",Mergin:{Top:1,Bottom:1,Left:0,Right:0}},NameSymbolV2:{Name:{Size:14,Name:"微软雅黑",Color:"rgb(60,60,60)"},Symbol:{Size:10,Name:"微软雅黑",Color:"rgb(105 105 105)"}},LimitColor:{UpColor:"rgb(255,0,0)",DownColor:"rgb(0,128,0)",TextColor:"rgb(250,250,250)"},FieldColor:{Index:"rgb(60,60,60)",Symbol:"rgb(60,60,60)",Name:"rgb(60,60,60)",Vol:"rgb(90,90,90)",Amount:"rgb(90,90,90)",Text:"rgb(60,60,60)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(90,90,90)",CloseLine:{CloseColor:"rgb(30,144,255)",YCloseColor:"rgba(105,105,105,0.5)",AreaColor:"rgba(0,191,255,0.2)"},KLine:{UpColor:"rgb(255,0,0)",DownColor:"rgb(0,128,0)",UnchagneColor:"rgb(90,90,90)",DataWidth:16,DistanceWidth:3},Tab:{Font:{Size:12,Name:"微软雅黑"},ScrollBarWidth:100,ButtonColor:"rgb(252,252,252)",BarColor:"rgb(180,180,180)",BorderColor:"rgb(180,180,180)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},TabTitleColor:"rgb(60,60,60)",TabSelectedTitleColor:"rgb(255,255,255)",TabSelectedBGColor:"rgb(234,85,4)",TabMoveOnTitleColor:"rgb(234,85,4)",TabBGColor:"rgb(220,220,220)"},PageInfo:{Font:{Size:15,Name:"微软雅黑"},TextColor:"rgb(0,0,0)",BGColor:"rgba(180,180,180,0.5)",Mergin:{Left:5,Right:5,Top:4,Bottom:2}},DragRow:{Color:"rgba(190,190,190,0.8)",TextColor:"rgba(0,0, 0, 0.8)",MoveRowColor:"rgb(240,128,128)",SrcRowColor:"rgb(180,240,240)"},VScrollbar:{ScrollBarHeight:60,ButtonColor:"rgba(252,252,252,0.8)",BarColor:"rgba(168,168,168,0.9)",BorderColor:"rgba(180,180,180,0.9)",BGColor:"rgba(234,239,248,0.9)",BarWidth:{Size:12}},CheckBox:{Family:"iconfont",Size:15,Checked:{Color:"rgb(69,147,238)",Symbol:"",DisableColor:"rgb(230,230,230)",MouseOnColor:"rgb(69,147,238)"},Unchecked:{Color:"rgb(120,120,120)",Symbol:"",DisableColor:"rgb(230,230,230)",MouseOnColor:"rgb(69,147,238)"},Margin:{Left:5,Right:5,Bottom:2,Top:4}},Link:{Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(30,144,255)",Disable:{TextColor:"rgb(211,211,211)"},MouseOn:{TextColor:"rgb(30,144,255)"}},ProgressBar:{BGColor:"rgb(229,231,238)",BarColor:"rgb(26,125,255)",Margin:{Left:2,Right:2,Bottom:2,Top:2},BarMargin:{Left:2,Right:2,Bottom:2,Top:2},TextColor:"rgb(0,0,0)",Font:"".concat(12*F(),"px 微软雅黑"),TextMargin:{Left:40,Right:2,Bottom:2,Top:2},Disable:{BGColor:"rgb(229,231,238)",BarColor:"rgb(131,131,131)",TextColor:"rgb(159,161,159)"}},Button:{BGColor:"rgb(61,134,180)",TextColor:"rgb(255,255,255)",BorderColor:"rgb(200,200,200)",Disable:{BGColor:"rgb(105,105,105)",TextColor:"rgb(169,169,169)"},MouseOn:{BGColor:"rgb(57,125,169)",TextColor:"rgb(230,230,230)"},Margin:{Left:5,Right:5,Bottom:2,Top:2},TextMargin:{Bottom:2},Font:"".concat(12*F(),"px 微软雅黑")}},this.TReport={BorderColor:"rgb(192,192,192)",SelectedColor:"rgb(3,89,245)",Header:{Color:"rgb(60,60,60)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:14,Name:"微软雅黑"}},Item:{Mergin:{Top:2,Bottom:0,Left:5,Right:5},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},FixedItem:{Font:{Size:15,Name:"微软雅黑"}},CenterItem:{TextColor:"rgb(60,60,83)",BaseTextColor:"rgb(60,60,83)",BGColor:"rgb(180,180,180)"},FieldColor:{Index:"rgb(60,60,60)",Symbol:"rgb(60,60,60)",Name:"rgb(60,60,60)",Vol:"rgb(90,90,90)",Position:"rgb(90,90,90)",Amount:"rgb(90,90,90)",Text:"rgb(60,60,60)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchangeTextColor:"rgb(90,90,90)",UpBGColor:"rgb(255,220,220)",DownBGColor:"rgb(190,220,190)",MarkBorder:{MaxPositionColor:"rgb(192,192,192)"}},this.Keyboard={BorderColor:"rgb(192,192,192)",SelectedColor:"rgb(180,240,240)",TextColor:"rgb(0,0,0)",Item:{Mergin:{Top:2,Bottom:0,Left:1,Right:1},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:0,Right:0,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},VScrollbar:{ScrollBarHeight:50,ButtonColor:"rgba(252,252,252,0.8)",BarColor:"rgba(168,168,168,0.9)",BorderColor:"rgba(180,180,180,0.9)",BGColor:"rgba(234,239,248,0.9)",BarWidth:{Size:8}}},this.ScrollBar={BorderColor:"rgb(192,192,192)",XSplitTextFont:"".concat(12*F(),"px 微软雅黑"),XSplitTextColor:"rgb(0,0,0)",XSplitLineColor:"rgba(0,0,0,0.8)",BGChart:{Color:"rgb(135,206,250)",LineWidth:1,AreaColor:"rgba(135,206,250,0.5)"},Slider:{DateFont:"".concat(14*F(),"px 微软雅黑"),DateColor:"rgb(0,0,0)",BarColor:"rgb(207,207,207)",BarAreaColor:"rgba(232,232,232,0.65)",BarWidth:10,BarPadding:15,MinCenterWidth:15}},this.FrameButtomToolbar={BGColor:"rgb(235,235,235)",BorderColor:"rgb(204,204,204)",Button:{Font:{Family:"微软雅黑",Size:12*F()},TitleColor:{Selected:"rgb(255,255,255)",Default:"rgb(125,125,125)",MoveOn:"rgb(234,85,4)"},BGColor:{Selected:"rgb(234,85,4)",Default:"rgb(235,235,235)",MoveOn:"rgb(242,242,242)"},BorderColor:"rgb(204,204,204)",Mergin:{Left:5*F(),Right:5*F(),Top:4*F(),Bottom:2*F()},SVG:{Family:"iconfont",Size:12*F(),MerginLeft:4*F()}}},this.SetStyle=function(t){var e=function(t,e){t&&(t.Color&&(e.Color=t.Color),t.MoveOnColor&&(e.MoveOnColor=t.MoveOnColor),t.SelectedColor&&(e.SelectedColor=t.SelectedColor),t.Family&&(e.Family=t.Family),t.Text&&(e.Text=t.Text),sa.IsNumber(t.Size)&&(e.Size=t.Size),sa.IsNumber(t.MerginLeft)&&(e.MerginLeft=t.MerginLeft))};if(t.TooltipBGColor&&(this.TooltipBGColor=t.TooltipBGColor),t.TooltipAlpha&&(this.TooltipAlpha=t.TooltipAlpha),t.SelectRectBGColor&&(this.SelectRectBGColor=t.SelectRectBGColor),t.UpBarColor&&(this.UpBarColor=t.UpBarColor),t.DownBarColor&&(this.DownBarColor=t.DownBarColor),t.UnchagneBarColor&&(this.UnchagneBarColor=t.UnchagneBarColor),t.EmptyBarBGColor&&(this.EmptyBarBGColor=t.EmptyBarBGColor),t.HighLowBarColor&&(this.HighLowBarColor=t.HighLowBarColor),t.HighLowText){var a=this.HighLowText,i=t.HighLowText;i.FontName&&(a.FontName=i.FontName),i.Color&&(a.Color=i.Color),i.MaxText&&(a.MaxText=i.MaxText),sa.IsPlusNumber(i.MaxSize)&&(a.MaxSize=i.MaxSize),sa.IsPlusNumber(i.MinSize)&&(a.MinSize=i.MinSize)}if(t.SplashScreen){i=t.SplashScreen;i.BGColor&&(this.SplashScreen.BGColor=i.BGColor),i.Title&&(this.SplashScreen.Title=i.Title),i.TextColor&&(this.SplashScreen.TextColor=i.TextColor),i.Font&&(this.SplashScreen.Font=i.Font)}if(t.HLCArea){i=t.HLCArea;i.HighLineColor&&(this.HLCArea.HighLineColor=i.HighLineColor),i.LowLineColor&&(this.HLCArea.LowLineColor=i.LowLineColor),i.CloseLineColor&&(this.HLCArea.CloseLineColor=i.CloseLineColor),i.UpAreaColor&&(this.HLCArea.UpAreaColor=i.UpAreaColor),i.DownAreaColor&&(this.HLCArea.DownAreaColor=i.DownAreaColor),sa.IsNumber(i.LineWidth)&&(this.HLCArea.LineWidth=i.LineWidth)}if(t.Minute){if(t.Minute.VolBarColor&&(this.Minute.VolBarColor=t.Minute.VolBarColor),t.Minute.VolTitleColor&&(this.Minute.VolTitleColor=t.Minute.VolTitleColor),t.Minute.PriceColor&&(this.Minute.PriceColor=t.Minute.PriceColor),sa.IsNumber(t.Minute.PriceLineWidth)&&(this.Minute.PriceLineWidth=t.Minute.PriceLineWidth),t.Minute.AvPriceColor&&(this.Minute.AvPriceColor=t.Minute.AvPriceColor),t.Minute.AreaPriceColor&&(this.Minute.AreaPriceColor=t.Minute.AreaPriceColor),t.Minute.PositionColor&&(this.Minute.PositionColor=t.Minute.PositionColor),t.Minute.FrameSplitTextColor&&(this.Minute.FrameSplitTextColor=t.Minute.FrameSplitTextColor),t.Minute.Before){i=t.Minute.Before;i.BGColor&&(this.Minute.Before.BGColor=i.BGColor),i.LineColor&&(this.Minute.Before.LineColor=i.LineColor),i.VolColor&&(this.Minute.Before.VolColor=i.VolColor),i.AvPriceColor&&(this.Minute.Before.AvPriceColor=i.AvPriceColor),i.CloseIcon&&e(i.CloseIcon,this.Minute.Before.CloseIcon),i.Point&&(i.Point.Color&&(this.Minute.Before.Point.Color=i.Point.Color),i.Point.Radius&&(this.Minute.Before.Point.Radius=i.Point.Radius))}if(t.Minute.After){i=t.Minute.After;i.BGColor&&(this.Minute.After.BGColor=i.BGColor),i.LineColor&&(this.Minute.After.LineColor=i.LineColor),i.VolColor&&(this.Minute.After.VolColor=i.VolColor),i.AvPriceColor&&(this.Minute.After.AvPriceColor=i.AvPriceColor),i.Point&&(i.Point.Color&&(this.Minute.After.Point.Color=i.Point.Color),i.Point.Radius&&(this.Minute.After.Point.Radius=i.Point.Radius))}if(t.Minute.NightDay){i=t.Minute.NightDay;if(i.NightBGColor&&(this.Minute.NightDay.NightBGColor=i.NightBGColor),i.Font&&(this.Minute.NightDay.Font=i.Font),i.Day){var r=i.Day;r.Color&&(this.Minute.NightDay.Day.Color=r.Color),r.BGColor&&(this.Minute.NightDay.Day.BGColor=r.BGColor),r.BorderColor&&(this.Minute.NightDay.Day.BorderColor=r.BorderColor),G(this.Minute.NightDay.Day.Margin,r.Margin)}if(i.Night){r=i.Night;r.Color&&(this.Minute.NightDay.Night.Color=r.Color),r.BGColor&&(this.Minute.NightDay.Night.BGColor=r.BGColor),r.BorderColor&&(this.Minute.NightDay.Night.BorderColor=r.BorderColor),G(this.Minute.NightDay.Night.Margin,r.Margin)}}if(t.Minute.BuySellBar){i=t.Minute.BuySellBar,a=this.Minute.BuySellBar;i.BuyColor&&(a.BuyColor=i.BuyColor),i.SellColor&&(a.SellColor=i.SellColor),i.Font&&(a.Font=i.Font),i.TextColor&&(a.TextColor=i.TextColor),sa.IsNumber(i.BarWidth)&&(a.BarWidth=i.BarWidth),sa.IsNonEmptyArray(i.AryBarRange)&&(a.AryBarRange=i.AryBarRange),sa.IsNumber(i.YOffset)&&(a.YOffset=i.YOffset)}}if(t.PopMinuteChart){i=t.PopMinuteChart,a=this.PopMinuteChart;i.BGColor&&(a.BGColor=i.BGColor),i.BorderColor&&(a.BorderColor=i.BorderColor),i.TitleColor&&(a.TitleColor=i.TitleColor),i.TitleBGColor&&(a.TitleBGColor=i.TitleBGColor),i.Mark&&(i.Mark.LineColor&&(a.Mark.LineColor=i.Mark.LineColor),sa.IsNumber(i.Mark.LineWidth)&&(a.Mark.LineWidth=i.Mark.LineWidth))}if(t.PopKLineChart){i=t.PopKLineChart,a=this.PopKLineChart;i.BGColor&&(a.BGColor=i.BGColor),i.BorderColor&&(a.BorderColor=i.BorderColor),i.TitleColor&&(a.TitleColor=i.TitleColor),i.TitleBGColor&&(a.TitleBGColor=i.TitleBGColor)}if(t.DefaultTextColor&&(this.DefaultTextColor=t.DefaultTextColor),t.DefaultTextFont&&(this.DefaultTextFont=t.DefaultTextFont),t.TitleFont&&(this.TitleFont=t.TitleFont),t.IndexTitleBGColor&&(this.IndexTitleBGColor=t.IndexTitleBGColor),t.IndexTitleBorderColor&&(this.IndexTitleBorderColor=t.IndexTitleBorderColor),t.IndexTitleBorderMoveOnColor&&(this.IndexTitleBorderMoveOnColor=t.IndexTitleBorderMoveOnColor),sa.IsNumber(t.IndexTitleBorderStyle)&&(this.IndexTitleBorderStyle=t.IndexTitleBorderStyle),t.IndexTitleColor&&(this.IndexTitleColor=t.IndexTitleColor),t.IndexTitleSelectedColor&&(this.IndexTitleSelectedColor=t.IndexTitleSelectedColor),t.OverlayIndexTitleBGColor&&(this.OverlayIndexTitleBGColor=t.OverlayIndexTitleBGColor),t.UpTextColor&&(this.UpTextColor=t.UpTextColor),t.DownTextColor&&(this.DownTextColor=t.DownTextColor),t.UnchagneTextColor&&(this.UnchagneTextColor=t.UnchagneTextColor),t.CloseLineColor&&(this.CloseLineColor=t.CloseLineColor),t.CloseLineAreaColor&&(this.CloseLineAreaColor=t.CloseLineAreaColor),t.CloseLineWidth&&(this.CloseLineWidth=t.CloseLineWidth),t.FrameBorderPen&&(this.FrameBorderPen=t.FrameBorderPen),t.MultiDayBorderPen&&(this.MultiDayBorderPen=t.MultiDayBorderPen),t.FrameSplitPen&&(this.FrameSplitPen=t.FrameSplitPen),t.FrameDotSplitPen&&(this.FrameDotSplitPen=t.FrameDotSplitPen),t.FrameSplitTextColor&&(this.FrameSplitTextColor=t.FrameSplitTextColor),t.FrameSplitTextFont&&(this.FrameSplitTextFont=t.FrameSplitTextFont),t.FrameTitleBGColor&&(this.FrameTitleBGColor=t.FrameTitleBGColor),t.SelFrameBorderColor&&(this.SelFrameBorderColor=t.SelFrameBorderColor),sa.IsNumber(t.IndexTitleMerginLeft)&&(this.IndexTitleMerginLeft=t.IndexTitleMerginLeft),t.IndexTitle){i=t.IndexTitle;if(i.UpDownArrow){r=i.UpDownArrow;r.UpColor&&(this.IndexTitle.UpDownArrow.UpColor=r.UpColor),r.DownColor&&(this.IndexTitle.UpDownArrow.DownColor=r.DownColor),r.UnchangeColor&&(this.IndexTitle.UpDownArrow.UnchangeColor=r.UnchangeColor)}if(sa.IsNumber(i.ArrowType)&&(this.IndexTitle.ArrowType=i.ArrowType),sa.IsBool(i.EnableIndexArrow)&&(this.IndexTitle.EnableIndexArrow=i.EnableIndexArrow),i.NameArrow){r=i.NameArrow;r.Color&&(this.IndexTitle.NameArrow.Color=r.Color),r.Symbol&&(this.IndexTitle.NameArrow.Symbol=r.Symbol),sa.IsNumber(r.Space)&&(this.IndexTitle.NameArrow.Space=r.Space)}}if(t.Frame&&(t.Frame.XBottomOffset&&(this.Frame.XBottomOffset=t.Frame.XBottomOffset),t.Frame.YTopOffset&&(this.Frame.YTopOffset=t.Frame.YTopOffset),t.Frame.PercentageText)){i=t.Frame.PercentageText;i.PriceColor&&(this.Frame.PercentageText.PriceColor=i.PriceColor),i.PercentageColor&&(this.Frame.PercentageText.PercentageColor=i.PercentageColor),i.SplitColor&&(this.Frame.PercentageText.SplitColor=i.SplitColor),i.Font&&(this.Frame.PercentageText.Font=i.Font)}if(sa.IsNumber(t.ToolbarButtonStyle)&&(this.ToolbarButtonStyle=t.ToolbarButtonStyle),sa.IsBool(t.IsDOMFrameTitle)&&(this.IsDOMFrameTitle=t.IsDOMFrameTitle),t.FrameLatestPrice){i=t.FrameLatestPrice;t.FrameLatestPrice.TextColor&&(this.FrameLatestPrice.TextColor=t.FrameLatestPrice.TextColor),t.FrameLatestPrice.UpBarColor&&(this.FrameLatestPrice.UpBarColor=t.FrameLatestPrice.UpBarColor),t.FrameLatestPrice.DownBarColor&&(this.FrameLatestPrice.DownBarColor=t.FrameLatestPrice.DownBarColor),t.FrameLatestPrice.UnchagneBarColor&&(this.FrameLatestPrice.UnchagneBarColor=t.FrameLatestPrice.UnchagneBarColor),t.FrameLatestPrice.BGAlpha&&(this.FrameLatestPrice.BGAlpha=t.FrameLatestPrice.BGAlpha),t.FrameLatestPrice.OverlayTextColor&&(this.FrameLatestPrice.OverlayTextColor=t.FrameLatestPrice.OverlayTextColor),i.EmptyBGColor&&(this.FrameLatestPrice.EmptyBGColor=i.EmptyBGColor)}if(t.OverlayFrame){i=t.OverlayFrame;t.OverlayFrame.BolderPen&&(this.OverlayFrame.BolderPen=t.OverlayFrame.BolderPen),t.OverlayFrame.TitleColor&&(this.OverlayFrame.TitleColor=t.OverlayFrame.TitleColor),t.OverlayFrame.TitleFont&&(this.OverlayFrame.TitleFont=t.OverlayFrame.TitleFont)}if(t.CorssCursorBGColor&&(this.CorssCursorBGColor=t.CorssCursorBGColor),t.CorssCursorTextColor&&(this.CorssCursorTextColor=t.CorssCursorTextColor),t.CorssCursorTextFont&&(this.CorssCursorTextFont=t.CorssCursorTextFont),t.CorssCursorVPenColor&&(this.CorssCursorVPenColor=t.CorssCursorVPenColor),t.CorssCursorHPenColor&&(this.CorssCursorHPenColor=t.CorssCursorHPenColor),t.CorssCursorBorderColor&&(this.CorssCursorBorderColor=t.CorssCursorBorderColor),t.CorssCursorXRangeBGColor&&(this.CorssCursorXRangeBGColor=t.CorssCursorXRangeBGColor),t.CorssCursorLineDash&&(this.CorssCursorLineDash=t.CorssCursorLineDash.slice()),t.CorssCursor&&t.CorssCursor.RightButton){i=t.CorssCursor.RightButton;i.BGColor&&(this.CorssCursor.RightButton.BGColor=i.BGColor),i.PenColor&&(this.CorssCursor.RightButton.PenColor=i.PenColor),i.Icon&&(this.CorssCursor.RightButton.Icon=i.Icon)}if(t.CorssCursor&&t.CorssCursor.CorssPoint){i=t.CorssCursor.CorssPoint;if(i.Center){r=i.Center;var n=this.CorssCursor.CorssPoint.Center;sa.IsNumber(r.Radius)&&(n.Radius=r.Radius),r.Color&&(n.Color=r.Color)}if(i.Border){r=i.Border,n=this.CorssCursor.CorssPoint.Border;sa.IsNumber(r.Width)&&(n.Width=r.Width),r.Color&&(n.Color=r.Color)}}if(t.KLine&&(this.KLine=t.KLine),t.VirtualKLine){i=t.VirtualKLine;i.Color&&(this.VirtualKLine.Color=i.Color),i.LineDash&&(this.VirtualKLine.LineDash=i.LineDash)}if(t.PredictionKLine){if(t.PredictionKLine.Line){i=t.PredictionKLine.Line,a=this.PredictionKLine.Line;i.Color&&(a.Color=i.Color),i.LineDash&&(a.LineDash=i.LineDash),sa.IsNumber(i.LineWidth)&&(a.LineWidth=i.LineWidth)}if(t.PredictionKLine.Bar){i=t.PredictionKLine.Bar,a=this.PredictionKLine.Bar;i.UpColor&&(a.UpColor=i.UpColor),i.DownColor&&(a.DownColor=i.DownColor),i.UnchangeColor&&(a.UnchangeColor=i.UnchangeColor),(sa.IsNumber(i.DrawType)||null===i.DrawType)&&(a.DrawType=i.DrawType)}}if(t.PriceGapStyple){i=t.PriceGapStyple;i.Line&&i.Line.Color&&(this.PriceGapStyple.Line.Color=i.Line.Color),i.Text&&(i.Text.Color&&(this.PriceGapStyple.Text.Color=i.Text.Color),i.Text.Font&&(this.PriceGapStyple.Text.Font=i.Text.Font))}if(t.DaySummaryKLine){i=t.DaySummaryKLine,a=this.DaySummaryKLine;i.Font&&(a.Font=i.Font),i.TextColor&&(a.TextColor=i.TextColor),sa.IsNumber(i.LeftMargin)&&(a.LeftMargin=i.LeftMargin)}if(t.Index&&(t.Index.LineColor&&(this.Index.LineColor=t.Index.LineColor),t.Index.NotSupport&&(this.Index.NotSupport=t.Index.NotSupport)),t.ColorArray&&(this.ColorArray=t.ColorArray),t.DrawPicture){i=t.DrawPicture;i.LineColor&&(this.DrawPicture.LineColor=i.LineColor),i.PointColor&&(this.DrawPicture.PointColor=i.PointColor),i.XYCoordinate&&(this.DrawPicture.XYCoordinate=i.XYCoordinate),sa.IsNumber(i.PointType)&&(this.DrawPicture.PointType=i.PointType),sa.IsBool(i.IsShowPoint)&&(this.DrawPicture.IsShowPoint=i.IsShowPoint)}if(t.TooltipPaint&&(t.TooltipPaint.BGColor&&(this.TooltipPaint.BGColor=t.TooltipPaint.BGColor),t.TooltipPaint.BorderColor&&(this.TooltipPaint.BorderColor=t.TooltipPaint.BorderColor),t.TooltipPaint.TitleColor&&(this.TooltipPaint.TitleColor=t.TooltipPaint.TitleColor),t.TooltipPaint.TitleFont&&(this.TooltipPaint.TitleFont=t.TooltipPaint.TitleFont),t.TooltipPaint.DateTimeColor&&(this.TooltipPaint.DateTimeColor=t.TooltipPaint.DateTimeColor),t.TooltipPaint.VolColor&&(this.TooltipPaint.VolColor=t.TooltipPaint.VolColor),t.TooltipPaint.AmountColor&&(this.TooltipPaint.AmountColor=t.TooltipPaint.AmountColor)),t.PCTooltipPaint){i=t.PCTooltipPaint;i.BGColor&&(this.PCTooltipPaint.BGColor=i.BGColor),i.BorderColor&&(this.PCTooltipPaint.BorderColor=i.BorderColor),i.TitleColor&&(this.PCTooltipPaint.TitleColor=i.TitleColor),i.TitleFont&&(this.PCTooltipPaint.TitleFont=i.TitleFont),i.DateTimeColor&&(this.PCTooltipPaint.DateTimeColor=i.DateTimeColor),i.VolColor&&(this.PCTooltipPaint.VolColor=i.VolColor),i.AmountColor&&(this.PCTooltipPaint.AmountColor=i.AmountColor),i.PositionColor&&(this.PCTooltipPaint.PositionColor=i.PositionColor)}if(t.DialogTooltip){i=t.DialogTooltip;i.BGColor&&(this.DialogTooltip.BGColor=i.BGColor),i.BorderColor&&(this.DialogTooltip.BorderColor=i.BorderColor),i.TitleColor&&(this.DialogTooltip.TitleColor=i.TitleColor),i.TitleBGColor&&(this.DialogTooltip.TitleBGColor=i.TitleBGColor),i.DateTimeColor&&(this.DialogTooltip.DateTimeColor=i.DateTimeColor),i.VolColor&&(this.DialogTooltip.VolColor=i.VolColor),i.AmountColor&&(this.DialogTooltip.AmountColor=i.AmountColor),i.TurnoverRateColor&&(this.DialogTooltip.TurnoverRateColor=i.TurnoverRateColor),i.PositionColor&&(this.DialogTooltip.PositionColor=i.PositionColor),i.TextColor&&(this.DialogTooltip.TextColor=i.TextColor),i.ValueColor&&(this.DialogTooltip.ValueColor=i.ValueColor)}if(t.FloatTooltip){i=t.FloatTooltip;i.BGColor&&(this.FloatTooltip.BGColor=i.BGColor),i.BorderColor&&(this.FloatTooltip.BorderColor=i.BorderColor),i.DateTimeColor&&(this.FloatTooltip.DateTimeColor=i.DateTimeColor),i.VolColor&&(this.FloatTooltip.VolColor=i.VolColor),i.AmountColor&&(this.FloatTooltip.AmountColor=i.AmountColor),i.TurnoverRateColor&&(this.FloatTooltip.TurnoverRateColor=i.TurnoverRateColor),i.PositionColor&&(this.FloatTooltip.PositionColor=i.PositionColor),i.TextColor&&(this.FloatTooltip.TextColor=i.TextColor),i.ValueColor&&(this.FloatTooltip.ValueColor=i.ValueColor)}if(t.DialogSelectRect){i=t.DialogSelectRect;i.BGColor&&(this.DialogSelectRect.BGColor=i.BGColor),i.BorderColor&&(this.DialogSelectRect.BorderColor=i.BorderColor),i.TitleColor&&(this.DialogSelectRect.TitleColor=i.TitleColor),i.TextColor&&(this.DialogSelectRect.TextColor=i.TextColor),i.ValueColor&&(this.DialogSelectRect.ValueColor=i.ValueColor),i.VolColor&&(this.DialogSelectRect.VolColor=i.VolColor),i.AmountColor&&(this.DialogSelectRect.AmountColor=i.AmountColor),i.TurnoverRateColor&&(this.DialogSelectRect.TurnoverRateColor=i.TurnoverRateColor),i.PositionColor&&(this.DialogSelectRect.PositionColor=i.PositionColor)}if(t.DialogPopKeyboard){i=t.DialogPopKeyboard;if(i.BGColor&&(this.DialogPopKeyboard.BGColor=i.BGColor),i.BorderColor&&(this.DialogPopKeyboard.BorderColor=i.BorderColor),i.TitleColor&&(this.DialogPopKeyboard.TitleColor=i.TitleColor),i.TitleBGColor&&(this.DialogTooltip.TitleBGColor=i.TitleBGColor),i.Input){r=i.Input;r.BGColor&&(this.DialogPopKeyboard.Input.BGColor=r.BGColor),r.TextColor&&(this.DialogPopKeyboard.Input.TextColor=r.TextColor)}}if(t.DialogSearchIndex){i=t.DialogSearchIndex;i.BGColor&&(this.DialogSearchIndex.BGColor=i.BGColor),i.BorderColor&&(this.DialogSearchIndex.BorderColor=i.BorderColor),i.TitleColor&&(this.DialogSearchIndex.TitleColor=i.TitleColor),i.TitleBGColor&&(this.DialogSearchIndex.TitleBGColor=i.TitleBGColor),i.IndexNameColor&&(this.DialogSearchIndex.IndexNameColor=i.IndexNameColor),i.GroupNameColor&&(this.DialogSearchIndex.GroupNameColor=i.GroupNameColor),i.InputTextColor&&(this.DialogSearchIndex.InputTextColor=i.InputTextColor)}if(t.MinuteInfo){i=t.MinuteInfo;t.MinuteInfo.TextColor&&(this.MinuteInfo.TextColor=t.MinuteInfo.TextColor),t.MinuteInfo.Font&&(this.MinuteInfo.Font=t.MinuteInfo.Font),t.MinuteInfo.PointColor&&(this.MinuteInfo.PointColor=t.MinuteInfo.PointColor),t.MinuteInfo.LineColor&&(this.MinuteInfo.LineColor=t.MinuteInfo.LineColor),t.MinuteInfo.TextBGColor&&(this.MinuteInfo.TextBGColor=t.MinuteInfo.TextBGColor),sa.IsNumber(i.PointRadius)&&(this.MinuteInfo.PointRadius=i.PointRadius)}if(t.Title&&(t.Title.TradeIndexColor&&(this.Title.TradeIndexColor=t.Title.TradeIndexColor),t.Title.ColorIndexColor&&(this.Title.ColorIndexColor=t.Title.ColorIndexColor),t.Title.VolColor&&(this.Title.VolColor=t.Title.VolColor),t.Title.AmountColor&&(this.Title.AmountColor=t.Title.AmountColor),t.Title.DateTimeColor&&(this.Title.DateTimeColor=t.Title.DateTimeColor),t.Title.NameColor&&(this.Title.NameColor=t.Title.NameColor),t.Title.SettingColor&&(this.Title.SettingColor=t.Title.SettingColor),t.Title.TurnoverRateColor&&(this.Title.TurnoverRateColor=t.Title.TurnoverRateColor),t.Title.PositionColor&&(this.Title.PositionColor=t.Title.PositionColor)),t.ChartSimpleTable&&this.SetChartSimpleTable(t.ChartSimpleTable),t.ChartSimplePie&&this.SetChartSimplePie(t.ChartSimplePie),t.ChartSimpleDoughnut&&this.SetChartSimpleDoughnut(t.ChartSimpleDoughnut),t.ChartSimpleRadar&&this.SetChartSimpleRadar(t.ChartSimpleRadar),t.DRAWICON){if(t.DRAWICON.Icon){i=t.DRAWICON.Icon;sa.IsPlusNumber(i.MaxSize)&&(this.DRAWICON.Icon.MaxSize=i.MaxSize),sa.IsPlusNumber(i.MinSize)&&(this.DRAWICON.Icon.MinSize=i.MinSize),i.Zoom&&(this.DRAWICON.Icon.Zoom=i.Zoom),sa.IsNumber(i.YOffset)&&(this.DRAWICON.Icon.YOffset=i.YOffset)}if(t.DRAWICON.Text){i=t.DRAWICON.Text;sa.IsPlusNumber(i.MaxSize)&&(this.DRAWICON.Text.MaxSize=i.MaxSize),sa.IsPlusNumber(i.MinSize)&&(this.DRAWICON.Text.MinSize=i.MinSize),i.Zoom&&(this.DRAWICON.Text.Zoom=i.Zoom),i.FontName&&(this.DRAWICON.Text.FontName=i.FontName),sa.IsNumber(i.YOffset)&&(this.DRAWICON.Text.YOffset=i.YOffset)}}if(t.DRAWTEXT){i=t.DRAWTEXT;sa.IsPlusNumber(i.MaxSize)&&(this.DRAWICON.MaxSize=i.MaxSize),sa.IsPlusNumber(i.MinSize)&&(this.DRAWICON.MinSize=i.MinSize),i.Zoom&&(this.DRAWTEXT.Zoom=i.Zoom),i.FontName&&(this.DRAWTEXT.FontName=i.FontName),sa.IsNumber(i.YOffset)&&(this.DRAWTEXT.YOffset=i.YOffset)}if(t.DRAWTEXT_FIX){i=t.DRAWTEXT_FIX;i.Font&&(this.DRAWTEXT_FIX.Font=i.Font)}if(t.DRAWNUMBER_FIX){i=t.DRAWNUMBER_FIX;i.Font&&(this.DRAWNUMBER_FIX.Font=i.Font)}if(t.DRAWNUMBER){i=t.DRAWNUMBER;sa.IsPlusNumber(i.MaxSize)&&(this.DRAWNUMBER.MaxSize=i.MaxSize),sa.IsPlusNumber(i.MinSize)&&(this.DRAWNUMBER.MinSize=i.MinSize),i.Zoom&&(this.DRAWNUMBER.Zoom=i.Zoom),i.FontName&&(this.DRAWNUMBER.FontName=i.FontName),sa.IsNumber(i.YOffset)&&(this.DRAWNUMBER.YOffset=i.YOffset)}if(t.DRAWABOVE){i=t.DRAWABOVE;sa.IsNumber(i.YOffset)&&(this.DRAWABOVE.YOffset=i.YOffset)}if(t.DOTLINE&&(this.DOTLINE=t.DOTLINE),t.DRAWSL&&(this.DOTLINE=t.DRAWSL),t.DragSubFrameBorder&&(this.DragSubFrameBorder=t.DragSubFrameBorder),t.DepthMapPaint){i=t.DepthMapPaint;i.LineColor&&(this.DepthMapPaint.LineColor=i.LineColor),i.AreaColor&&(this.DepthMapPaint.AreaColor=i.AreaColor),i.TextColor&&(this.DepthMapPaint.TextColor=i.TextColor),i.TextBGColor&&(this.DepthMapPaint.TextBGColor=i.TextBGColor)}if(t.KLineYAxisBGPaint){i=t.KLineYAxisBGPaint;i.Font&&(this.KLineYAxisBGPaint.Font=i.Font),i.LineColor&&(this.KLineYAxisBGPaint.LineColor=i.LineColor),i.DiffValutTextColor&&(this.KLineYAxisBGPaint.DiffValutTextColor=i.DiffValutTextColor),i.DiffValueBGColor&&(this.KLineYAxisBGPaint.DiffValueBGColor=i.DiffValueBGColor)}if(t.StockChip){i=t.StockChip;if(i.InfoColor&&(this.StockChip.InfoColor=i.InfoColor),i.DayInfoColor&&(this.StockChip.DayInfoColor=i.DayInfoColor),i.Font&&(this.StockChip.Font=i.Font),i.DefaultButton&&e(i.DefaultButton,this.StockChip.DefaultButton),i.LongButton&&e(i.LongButton,this.StockChip.LongButton),i.RecentButton&&e(i.RecentButton,this.StockChip.RecentButton),i.CloseButton&&e(i.CloseButton,this.StockChip.CloseButton),i.PhoneCloseButton){r=i.PhoneCloseButton;r.Family&&(this.StockChip.PhoneCloseButton.Family=r.Family),r.Text&&(this.StockChip.PhoneCloseButton.Text=r.Text),r.Color&&(this.StockChip.PhoneCloseButton.Color=r.Color),sa.IsNumber(r.Size)&&(this.StockChip.PhoneCloseButton.Size=r.Size),r.Border&&r.Border.BGColor&&(this.StockChip.PhoneCloseButton.Border.BGColor=r.Border.BGColor)}}if(t.DepthChart){i=t.DepthChart;i.BidColor&&(i.BidColor.Line&&(this.DepthChart.BidColor.Line=i.BidColor.Line),i.BidColor.Area&&(this.DepthChart.BidColor.Area=i.BidColor.Area)),i.AskColor&&(i.AskColor.Line&&(this.DepthChart.AskColor.Line=i.AskColor.Line),i.AskColor.Area&&(this.DepthChart.AskColor.Area=i.AskColor.Area)),i.LineWidth&&(this.DepthChart.LineWidth=i.LineWidth)}if(t.DepthCorss){i=t.DepthCorss;if(i.BidColor&&i.BidColor.Line&&(this.DepthCorss.BidColor.Line=i.BidColor.Line),i.AskColor&&i.AskColor.Line&&(this.DepthCorss.AskColor.Line=i.AskColor.Line),i.LineWidth&&(this.DepthCorss.LineWidth=i.LineWidth),i.LineDash&&(this.DepthCorss.LineDash=i.LineDash),i.Tooltip){var o=i.Tooltip;o.BGColor&&(this.DepthCorss.Tooltip.BGColor=o.BGColor),o.TextColor&&(this.DepthCorss.Tooltip.TextColor=o.TextColor),o.Font&&(this.DepthCorss.Tooltip.Font=o.Font),o.LineHeight&&(this.DepthCorss.Tooltip.LineHeight=o.LineHeight);var s=o.Border;sa.IsNumber(s.Top)&&(this.DepthCorss.Tooltip.Border.Top=s.Top),sa.IsNumber(s.Bottom)&&(this.DepthCorss.Tooltip.Border.Bottom=s.Bottom),sa.IsNumber(s.Left)&&(this.DepthCorss.Tooltip.Border.Left=s.Left),sa.IsNumber(s.Right)&&(this.DepthCorss.Tooltip.Border.Right=s.Right),sa.IsNumber(s.ItemSpace)&&(this.DepthCorss.Tooltip.Border.ItemSpace=s.ItemSpace)}}if(t.CIRCLEDOT){i=t.CIRCLEDOT;sa.IsNumber(i.Radius)&&(this.CIRCLEDOT.Radius=i.Radius)}if(t.POINTDOT){i=t.POINTDOT;sa.IsNumber(i.Radius)&&(this.POINTDOT.Radius=i.Radius)}if(t.RectSelect){i=t.RectSelect;if(i.LineColor&&(this.RectSelect.LineColor=i.LineColor),i.LineWidth>0&&(this.RectSelect.LineWidth=i.LineWidth),i.LineDotted&&(this.RectSelect.LineDotted=i.LineDotted),i.AreaColor&&(this.RectSelect.AreaColor=i.AreaColor),i.SubAreaColor&&(this.RectSelect.SubAreaColor=i.SubAreaColor),i.RangeTextColor&&(this.RectSelect.RangeTextColor=i.RangeTextColor),i.RangeTextFont&&(this.RectSelect.RangeTextFont=i.RangeTextFont),i.RangeTextBGColor&&(this.RectSelect.RangeTextBGColor=i.RangeTextBGColor),i.RangeTextSubColor&&(this.RectSelect.RangeTextSubColor=i.RangeTextSubColor),i.RangeTextSubFont&&(this.RectSelect.RangeTextSubFont=i.RangeTextSubFont),i.RangeTextSubBGColor&&(this.RectSelect.RangeTextSubBGColor=i.RangeTextSubBGColor),i.Mark){r=i.Mark;r.Family&&(this.RectSelect.Mark.Family=r.Family),r.Text&&(this.RectSelect.Mark.Text=r.Text),r.Color&&(this.RectSelect.Mark.Color=r.Color),sa.IsNumber(r.Size)&&(this.RectSelect.Mark.Size=r.Size),r.Position&&(r.Position.Top&&(this.RectSelect.Mark.Position.Top=r.Position.Top),sa.IsNumber(r.Position.Index)&&(this.RectSelect.Mark.Position.Index=r.Position.Index))}}if(t.RectDrag){i=t.RectDrag,a=this.RectDrag;i.LineColor&&(a.LineColor=i.LineColor),sa.IsPlusNumber(i.LineWidth)&&(a.LineWidth=i.LineWidth),i.BGColor&&(a.BGColor=i.BGColor)}if(t.OrderFlow&&(i=t.OrderFlow,i.UpColor&&(this.OrderFlow.UpColor=i.UpColor),i.DownColor&&(this.OrderFlow.DownColor=i.DownColor),i.UnchagneColor&&(this.OrderFlow.UnchagneColor=i.UnchagneColor),i.Text&&(this.OrderFlow.Text=i.Text),i.Line&&(this.OrderFlow.Line=i.Line)),t.OrderFlow_Style2&&(i=t.OrderFlow_Style2,i.UpColor&&(this.OrderFlow_Style2.UpColor=i.UpColor),i.DownColor&&(this.OrderFlow_Style2.DownColor=i.DownColor),i.UnchagneColor&&(this.OrderFlow_Style2.UnchagneColor=i.UnchagneColor),sa.IsNumber(i.BarWidth)&&(this.OrderFlow_Style2.BarWidth=i.BarWidth)),t.ChartOX){i=t.ChartOX;i.Family&&(this.ChartOX.Family=i.Family),i.Up&&(this.ChartOX.Up=i.Up),i.Down&&(this.ChartOX.Down=i.Down),i.SquareLineColor&&(this.ChartOX.SquareLineColor=i.SquareLineColor)}if(t.DealList){i=t.DealList;if(i.BorderColor&&(this.DealList.BorderColor=i.BorderColor),i.UpTextColor&&(this.DealList.UpTextColor=i.UpTextColor),i.DownTextColor&&(this.DealList.DownTextColor=i.DownTextColor),i.UnchagneTextColor&&(this.DealList.UnchagneTextColor=i.UnchagneTextColor),i.CloseLineColor&&(this.DealList.CloseLineColor=i.CloseLineColor),i.Header){var h=i.Header;if(h.Color&&(this.DealList.Header.Color=h.Color),h.Mergin){var l=h.Mergin;sa.IsNumber(l.Left)&&(this.DealList.Header.Mergin.Left=l.Left),sa.IsNumber(l.Right)&&(this.DealList.Header.Mergin.Right=l.Right),sa.IsNumber(l.Top)&&(this.DealList.Header.Mergin.Top=l.Top),sa.IsNumber(l.Bottom)&&(this.DealList.Header.Mergin.Bottom=l.Bottom)}if(h.Font){var u=h.Font;u.Name&&(this.DealList.Header.Font.Name=u.Name),sa.IsNumber(u.Size)&&(this.DealList.Header.Font.Size=u.Size)}}if(i.Row){var C=i.Row;if(C.Mergin){l=C.Mergin;sa.IsNumber(l.Top)&&(this.DealList.Row.Mergin.Top=l.Top),sa.IsNumber(l.Bottom)&&(this.DealList.Row.Mergin.Bottom=l.Bottom)}if(C.Font){u=C.Font;u.Name&&(this.DealList.Row.Font.Name=u.Name),sa.IsNumber(u.Size)&&(this.DealList.Row.Font.Size=u.Size)}if(C.BarMergin){l=C.BarMergin;sa.IsNumber(l.Left)&&(this.DealList.Row.BarMergin.Left=l.Left),sa.IsNumber(l.Top)&&(this.DealList.Row.BarMergin.Top=l.Top),sa.IsNumber(l.Right)&&(this.DealList.Row.BarMergin.Right=l.Right),sa.IsNumber(l.Bottom)&&(this.DealList.Row.BarMergin.Bottom=l.Bottom)}}if(i.FieldColor){var D=i.FieldColor;if(D.Vol&&(this.DealList.FieldColor.Vol=D.Vol),D.Time&&(this.DealList.FieldColor.Time=D.Time),D.Deal&&(this.DealList.FieldColor.Deal=D.Deal),D.Index&&(this.DealList.FieldColor.Index=D.Index),D.BarTitle&&(this.DealList.FieldColor.BarTitle=D.BarTitle),D.Text&&(this.DealList.FieldColor.Text=D.Text),sa.IsNonEmptyArray(D.Bar))for(var f=0;f<D.Bar.length;++f)this.DealList.FieldColor.Bar[f]=D.Bar[f]}if(i.Selected){r=i.Selected;r.BGColor&&(this.DealList.Selected.BGColor=r.BGColor)}}if(t.Report&&this.SetReportStyle(t.Report),t.TReport&&this.SetTReportStyle(t.TReport),t.SelectedChart){i=t.SelectedChart;sa.IsNumber(i.LineWidth)&&(this.SelectedChart.LineWidth=i.LineWidth),sa.IsNumber(i.Radius)&&(this.SelectedChart.Radius=i.Radius),sa.IsNumber(i.MinSpace)&&(this.SelectedChart.MinSpace=i.MinSpace),i.LineColor&&(this.SelectedChart.LineColor=i.LineColor),i.LineColor&&(this.SelectedChart.BGColor=i.BGColor)}if(t.DragMovePaint){i=t.DragMovePaint;i.TextColor&&(this.DragMovePaint.TextColor=i.TextColor),i.Font&&(this.DragMovePaint.Font=i.Font)}if(t.SessionBreaksPaint){i=t.SessionBreaksPaint;if(sa.IsNonEmptyArray(i.BGColor)&&(this.SessionBreaksPaint.BGColor=i.BGColor.slice()),i.SplitLine){r=i.SplitLine;r.Color&&(this.SessionBreaksPaint.SplitLine.Color=r.Color),sa.IsNumber(r.Width)&&(this.SessionBreaksPaint.SplitLine.Width=r.Width),this.SessionBreaksPaint.SplitLine.Dash=r.Dash}}if(sa.IsNumber(t.ToolbarButtonStyle)&&(this.ToolbarButtonStyle=t.ToolbarButtonStyle),t.Buttons){var c=t.Buttons;if(e(c.CloseOverlayIndex,this.Buttons.CloseOverlayIndex),e(c.CloseWindow,this.Buttons.CloseWindow),e(c.ChangeIndex,this.Buttons.ChangeIndex),e(c.OverlayIndex,this.Buttons.OverlayIndex),e(c.ModifyIndexParam,this.Buttons.ModifyIndexParam),e(c.MaxMinWindow,this.Buttons.MaxMinWindow),e(c.TitleWindow,this.Buttons.TitleWindow),e(c.ExportData,this.Buttons.ExportData),e(c.AddIndexWindow,this.Buttons.AddIndexWindow),c.Tooltip){i=c.Tooltip;var m=this.Buttons.Tooltip;i.Font&&(m.Font=i.Font),i.Color&&(m.Color=i.Color),i.ColorBG&&(m.ColorBG=i.ColorBG),i.ColorBorder&&(m.ColorBorder=i.ColorBorder),i.BorderRadius&&(m.BorderRadius=i.BorderRadius),i.Margin&&(sa.IsNumber(i.Margin.Left)&&(m.Margin.Left=i.Margin.Left),sa.IsNumber(i.Margin.Top)&&(m.Margin.Top=i.Margin.Top),sa.IsNumber(i.Margin.Bottom)&&(m.Margin.Bottom=i.Margin.Bottom),sa.IsNumber(i.Margin.Right)&&(m.Margin.Right=i.Margin.Right))}}if(t.ChartDrawVolProfile){i=t.ChartDrawVolProfile;i.UpVolColor&&(this.ChartDrawVolProfile.UpVolColor=i.UpVolColor),i.DownVolColor&&(this.ChartDrawVolProfile.DownVolColor=i.DownVolColor),i.AreaUpColor&&(this.ChartDrawVolProfile.AreaUpColor=i.AreaUpColor),i.AreaDonwColor&&(this.ChartDrawVolProfile.AreaDonwColor=i.AreaDonwColor),i.BGColor&&(this.ChartDrawVolProfile.BGColor=i.BGColor),i.BorderColor&&(this.ChartDrawVolProfile.BorderColor=i.BorderColor),i.VolLineColor&&(this.ChartDrawVolProfile.VolLineColor=i.VolLineColor),i.Text&&(i.Text.Color&&(this.ChartDrawVolProfile.Text.Color=i.Text.Color),i.Text.Family&&(this.ChartDrawVolProfile.Text.Family=i.Text.Family),sa.IsNumber(i.Text.FontMaxSize)&&(this.ChartDrawVolProfile.Text.FontMaxSize=i.Text.FontMaxSize),sa.IsNumber(i.Text.FontMinSize)&&(this.ChartDrawVolProfile.Text.FontMinSize=i.Text.FontMinSize))}if(!0===t.DisableLogo&&this.FrameLogo&&(this.FrameLogo.Text=null),t.ScrollBar){i=t.ScrollBar;if(i.BorderColor&&(this.ScrollBar.BorderColor=i.BorderColor),i.XSplitTextFont&&(this.ScrollBar.XSplitTextFont=i.XSplitTextFont),i.XSplitTextColor&&(this.ScrollBar.XSplitTextColor=i.XSplitTextColor),i.XSplitLineColor&&(this.ScrollBar.XSplitLineColor=i.XSplitLineColor),i.Slider){r=i.Slider;r.DateFont&&(this.ScrollBar.Slider.DateFont=r.DateFont),r.DateColor&&(this.ScrollBar.Slider.DateColor=r.DateColor),r.BarColor&&(this.ScrollBar.Slider.BarColor=r.BarColor),r.BarAreaColor&&(this.ScrollBar.Slider.BarAreaColor=r.BarAreaColor),sa.IsNumber(r.BarWidth)&&(this.ScrollBar.Slider.BarWidth=r.BarWidth),sa.IsNumber(r.BarPadding)&&(this.ScrollBar.Slider.BarPadding=r.BarPadding),sa.IsNumber(r.MinCenterWidth)&&(this.ScrollBar.Slider.MinCenterWidth=r.MinCenterWidth)}if(i.BGChart){r=i.BGChart;r.Color&&(this.ScrollBar.BGChart.Color=r.Color),r.AreaColor&&(this.ScrollBar.BGChart.AreaColor=r.AreaColor),sa.IsPlusNumber(r.LineWidth)&&(this.ScrollBar.BGChart.LineWidth=r.LineWidth)}}t.FrameButtomToolbar&&this.SetFrameButtomToolbar(t.FrameButtomToolbar),t.Keyboard&&this.SetKeyboardStyle(t.Keyboard),t.MinuteToolbar&&this.SetMinuteToolbar(t.MinuteToolbar),t.KLineToolbar&&this.SetKLineToolbar(t.KLineToolbar),t.IndexLock&&this.SetIndexLock(t.IndexLock),t.ChartScatterPlotV2&&this.SetChartScatterPlotV2(t.ChartScatterPlotV2)},this.SetKeyboardStyle=function(t){var e=t,a=this.Keyboard;if(e.BorderColor&&(a.BorderColor=e.BorderColor),e.SelectedColor&&(a.SelectedColor=e.SelectedColor),e.TextColor&&(a.TextColor=e.TextColor),e.Item){var i=e.Item;if(i.Mergin){var r=i.Mergin;sa.IsNumber(r.Left)&&(a.Item.Mergin.Left=r.Left),sa.IsNumber(r.Right)&&(a.Item.Mergin.Right=r.Right),sa.IsNumber(r.Top)&&(a.Item.Mergin.Top=r.Top),sa.IsNumber(r.Bottom)&&(a.Item.Mergin.Bottom=r.Bottom)}if(i.Font){var n=i.Font;n.Name&&(a.Item.Font.Name=n.Name),sa.IsNumber(n.Size)&&(a.Item.Font.Size=n.Size)}if(i.BarMergin){r=i.BarMergin;sa.IsNumber(r.Left)&&(a.Item.BarMergin.Left=r.Left),sa.IsNumber(r.Top)&&(a.Item.BarMergin.Top=r.Top),sa.IsNumber(r.Right)&&(a.Item.BarMergin.Right=r.Right),sa.IsNumber(r.Bottom)&&(a.Item.BarMergin.Bottom=r.Bottom)}if(i.NameFont){n=i.NameFont;n.Name&&(a.Item.NameFont.Name=n.Name),sa.IsNumber(n.Size)&&(a.Item.NameFont.Size=n.Size)}if(i.SymbolFont){n=i.SymbolFont;n.Name&&(a.Item.SymbolFont.Name=n.Name),sa.IsNumber(n.Size)&&(a.Item.SymbolFont.Size=n.Size)}}if(e.VScrollbar){var o=e.VScrollbar;if(sa.IsNumber(o.ScrollBarHeight)&&(a.VScrollbar.ScrollBarHeight=o.ScrollBarHeight),o.ButtonColor&&(a.VScrollbar.ButtonColor=o.ButtonColor),o.BarColor&&(a.VScrollbar.BarColor=o.BarColor),o.BorderColor&&(a.VScrollbar.BorderColor=o.BorderColor),o.BGColor&&(a.VScrollbar.BGColor=o.BGColor),o.BarWidth){var s=o.BarWidth;sa.IsNumber(s.Size)&&(a.VScrollbar.BarWidth.Size=s.Size)}}},this.SetReportStyle=function(t){var e=t,a=this.Report;if(e.BorderColor&&(this.Report.BorderColor=e.BorderColor),e.UpTextColor&&(this.Report.UpTextColor=e.UpTextColor),e.DownTextColor&&(this.Report.DownTextColor=e.DownTextColor),e.UnchagneTextColor&&(this.Report.UnchagneTextColor=e.UnchagneTextColor),e.BorderColor&&(this.Report.SelectedColor=e.SelectedColor),e.SelectedLine){var i=e.SelectedLine,r=this.Report.SelectedLine;i.Color&&(r.Color=i.Color),sa.IsNumber(i.Width)&&(r.Width=i.Width)}if(e.CloseLine){var n=e.CloseLine;n.CloseColor&&(this.Report.CloseLine.CloseColor=n.CloseColor),n.YCloseColor&&(this.Report.CloseLine.YCloseColor=n.YCloseColor),n.AreaColor&&(this.Report.CloseLine.AreaColor=n.AreaColor)}if(e.KLine){var o=e.KLine;o.UpColor&&(this.Report.KLine.UpColor=o.UpColor),o.DownColor&&(this.Report.KLine.DownColor=o.DownColor),o.UnchagneColor&&(this.Report.KLine.UnchagneColor=o.UnchagneColor),sa.IsNumber(o.DataWidth)&&(this.Report.KLine.DataWidth=o.DataWidth),sa.IsNumber(o.DistanceWidth)&&(this.Report.KLine.DistanceWidth=o.DistanceWidth)}if(e.Header){var s=e.Header;if(s.Color&&(this.Report.Header.Color=s.Color),s.Mergin){var h=s.Mergin;sa.IsNumber(h.Left)&&(this.Report.Header.Mergin.Left=h.Left),sa.IsNumber(h.Right)&&(this.Report.Header.Mergin.Left=h.Right),sa.IsNumber(h.Top)&&(this.Report.Header.Mergin.Top=h.Top),sa.IsNumber(h.Bottom)&&(this.Report.Header.Mergin.Bottom=h.Bottom)}if(s.Font){var l=s.Font;l.Name&&(this.Report.Header.Font.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.Header.Font.Size=l.Size)}}if(e.SortIcon){var u=e.SortIcon;if(sa.IsNonEmptyArray(u.Color)&&(this.Report.SortIcon.Color=u.Color.slice()),sa.IsNumber(u.Size)&&(this.Report.SortIcon.Size=u.Size),u.Family&&(this.Report.SortIcon.Family=u.Family),sa.IsNonEmptyArray(u.Arrow)&&(this.Report.SortIcon.Arrow=u.Arrow.slice()),u.Margin){var C=u.Margin;sa.IsNumber(C.Left)&&(this.Report.SortIcon.Margin.Left=C.Left),sa.IsNumber(C.Right)&&(this.Report.SortIcon.Margin.Right=C.Right),sa.IsNumber(C.Top)&&(this.Report.SortIcon.Margin.Top=C.Top),sa.IsNumber(C.Bottom)&&(this.Report.SortIcon.Margin.Bottom=C.Bottom)}}if(e.Item){var D=e.Item;if(D.Mergin){h=D.Mergin;sa.IsNumber(h.Left)&&(this.Report.Item.Mergin.Left=h.Left),sa.IsNumber(h.Right)&&(this.Report.Item.Mergin.Right=h.Right),sa.IsNumber(h.Top)&&(this.Report.Item.Mergin.Top=h.Top),sa.IsNumber(h.Bottom)&&(this.Report.Item.Mergin.Bottom=h.Bottom)}if(D.Font){l=D.Font;l.Name&&(this.Report.Item.Font.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.Item.Font.Size=l.Size)}if(D.BarMergin){h=D.BarMergin;sa.IsNumber(h.Left)&&(this.Report.Item.BarMergin.Left=h.Left),sa.IsNumber(h.Top)&&(this.Report.Item.BarMergin.Top=h.Top),sa.IsNumber(h.Right)&&(this.Report.Item.BarMergin.Right=h.Right),sa.IsNumber(h.Bottom)&&(this.Report.Item.BarMergin.Bottom=h.Bottom)}if(D.NameFont){l=D.NameFont;l.Name&&(this.Report.Item.NameFont.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.Item.NameFont.Size=l.Size)}if(D.SymbolFont){l=D.SymbolFont;l.Name&&(this.Report.Item.SymbolFont.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.Item.SymbolFont.Size=l.Size)}}if(e.FixedItem){D=e.FixedItem;if(D.Font){l=D.Font;l.Name&&(this.Report.FixedItem.Font.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.FixedItem.Font.Size=l.Size)}}if(e.LimitBorder){var f=e.LimitBorder;if(f.Color&&(this.Report.LimitBorder.Color=f.Color),f.Mergin){h=f.Mergin;sa.IsNumber(h.Left)&&(this.Report.LimitBorder.Mergin.Left=h.Left),sa.IsNumber(h.Top)&&(this.Report.LimitBorder.Mergin.Top=h.Top),sa.IsNumber(h.Right)&&(this.Report.LimitBorder.Mergin.Right=h.Right),sa.IsNumber(h.Bottom)&&(this.Report.LimitBorder.Mergin.Bottom=h.Bottom)}}if(e.LimitColor){f=e.LimitColor;f.UpColor&&(this.Report.LimitColor.UpColor=f.UpColor),f.DownColor&&(this.Report.LimitColor.DownColor=f.DownColor),f.TextColor&&(this.Report.LimitColor.UpColor=f.TextColor)}if(e.FieldColor){var c=e.FieldColor;if(c.Name&&(this.Report.FieldColor.Name=c.Name),c.Symbol&&(this.Report.FieldColor.Symbol=c.Symbol),c.Vol&&(this.Report.FieldColor.Vol=c.Vol),c.Amount&&(this.Report.FieldColor.Amount=c.Amount),c.Index&&(this.Report.FieldColor.Index=c.Index),c.BarTitle&&(this.Report.FieldColor.BarTitle=c.BarTitle),c.Text&&(this.Report.FieldColor.Text=c.Text),sa.IsNonEmptyArray(c.Bar))for(var m=0;m<c.Bar.length;++m)this.Report.FieldColor.Bar[m]=c.Bar[m]}if(e.NameSymbolV2){var d=e.NameSymbolV2;if(d.Name){i=d.Name;sa.IsNumber(i.Size)&&(this.Report.NameSymbolV2.Name.Size=i.Size),i.Name&&(this.Report.NameSymbolV2.Name.Name=i.Name),i.Color&&(this.Report.NameSymbolV2.Name.Color=i.Color)}if(d.Symbol){i=d.Symbol;sa.IsNumber(i.Size)&&(this.Report.NameSymbolV2.Symbol.Size=i.Size),i.Name&&(this.Report.NameSymbolV2.Symbol.Name=i.Name),i.Color&&(this.Report.NameSymbolV2.Symbol.Color=i.Color)}}if(e.Tab){var I=e.Tab;if(I.Font){l=I.Font;l.Name&&(this.Report.Tab.Font.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.Tab.Font.Size=l.Size)}sa.IsNumber(I.ScrollBarWidth)&&(this.Report.Tab.ScrollBarWidth=I.ScrollBarWidth),I.ButtonColor&&(this.Report.Tab.ButtonColor=I.ButtonColor),I.BarColor&&(this.Report.Tab.BarColor=I.BarColor),I.BorderColor&&(this.Report.Tab.BorderColor=I.BorderColor),I.TabTitleColor&&(this.Report.Tab.TabTitleColor=I.TabTitleColor),I.TabSelectedTitleColor&&(this.Report.Tab.TabSelectedTitleColor=I.TabSelectedTitleColor),I.TabSelectedBGColor&&(this.Report.Tab.TabSelectedBGColor=I.TabSelectedBGColor),I.TabMoveOnTitleColor&&(this.Report.Tab.TabMoveOnTitleColor=I.TabMoveOnTitleColor),I.TabBGColor&&(this.Report.Tab.TabBGColor=I.TabBGColor)}if(e.PageInfo){var S=e.PageInfo;if(S.Font){l=S.Font;l.Name&&(this.Report.PageInfo.Font.Name=l.Name),sa.IsNumber(l.Size)&&(this.Report.PageInfo.Font.Size=l.Size)}if(S.TextColor&&(this.Report.PageInfo.TextColor=S.TextColor),S.BGColor&&(this.Report.PageInfo.BGColor=S.BGColor),S.Mergin){h=S.Mergin;sa.IsNumber(h.Left)&&(this.Report.PageInfo.Mergin.Left=h.Left),sa.IsNumber(h.Top)&&(this.Report.PageInfo.Mergin.Top=h.Top),sa.IsNumber(h.Right)&&(this.Report.PageInfo.Mergin.Right=h.Right),sa.IsNumber(h.Bottom)&&(this.Report.PageInfo.Mergin.Bottom=h.Bottom)}}if(e.DragRow){var T=e.DragRow;T.Color&&(this.Report.DragRow.Color=T.Color),T.TextColor&&(this.Report.DragRow.TextColor=T.TextColor),T.MoveRowColor&&(this.Report.DragRow.MoveRowColor=T.MoveRowColor),T.SrcRowColor&&(this.Report.DragRow.SrcRowColor=T.SrcRowColor)}if(e.VScrollbar){i=e.VScrollbar;sa.IsNumber(i.ScrollBarHeight)&&(a.VScrollbar.ScrollBarHeight=i.ScrollBarHeight),i.ButtonColor&&(a.VScrollbar.ButtonColor=i.ButtonColor),i.BarColor&&(a.VScrollbar.BarColor=i.BarColor),i.BorderColor&&(a.VScrollbar.BorderColor=i.BorderColor),i.BGColor&&(a.VScrollbar.BGColor=i.BGColor)}if(e.CheckBox){i=e.CheckBox;if(i.Family&&(a.CheckBox.Family=i.Family),sa.IsNumber(i.Size)&&(a.CheckBox.Size=i.Size),i.Checked){var v=i.Checked;v.Color&&(a.CheckBox.Checked.Color=v.Color),v.Symbol&&(a.CheckBox.Checked.Symbol=v.Symbol),v.DisableColor&&(a.CheckBox.Checked.DisableColor=v.DisableColor)}if(i.Unchecked){v=i.Unchecked;v.Color&&(a.CheckBox.Unchecked.Color=v.Color),v.Symbol&&(a.CheckBox.Unchecked.Symbol=v.Symbol),v.DisableColor&&(a.CheckBox.Unchecked.DisableColor=v.DisableColor)}G(a.CheckBox.Margin,i.Margin)}if(e.Link){i=e.Link;i.Font&&(a.Link.Font=i.Font),i.TextColor&&(a.Link.TextColor=i.TextColor),i.Disable&&i.Disable.TextColor&&(a.Link.Disable.TextColor=i.Disable.TextColor),i.MouseOn&&i.MouseOn.TextColor&&(a.Link.MouseOn.TextColor=i.MouseOn.TextColor)}if(e.ProgressBar){i=e.ProgressBar;i.BGColor&&(a.ProgressBar.BGColor=i.BGColor),i.BarColor&&(a.ProgressBar.BarColor=i.BarColor),i.TextColor&&(a.ProgressBar.TextColor=i.TextColor),i.Font&&(a.ProgressBar.Font=i.Font),i.Disable&&(i.Disable.BGColor&&(a.ProgressBar.Disable.BGColor=i.Disable.BGColor),i.Disable.BarColor&&(a.ProgressBar.Disable.BarColor=i.Disable.BarColor),i.Disable.TextColor&&(a.ProgressBar.Disable.TextColor=i.Disable.TextColor)),G(a.ProgressBar.Margin,i.Margin),G(a.ProgressBar.BarMargin,i.BarMargin),G(a.ProgressBar.TextMargin,i.TextMargin)}if(e.Buttom){i=e.Buttom;i.BGColor&&(a.Buttom.BGColor=i.BGColor),i.TextColor&&(a.Buttom.TextColor=i.TextColor),i.BorderColor&&(a.Buttom.BorderColor=i.BorderColor),i.Font&&(a.Buttom.Font=i.Font),i.Disable&&(i.Disable.BGColor&&(a.Buttom.Disable.BGColor=i.Disable.BGColor),i.Disable.TextColor&&(a.Buttom.Disable.TextColor=i.Disable.TextColor)),i.MouseOn&&(i.MouseOn.BGColor&&(a.Buttom.MouseOn.BGColor=i.MouseOn.BGColor),i.MouseOn.TextColor&&(a.Buttom.MouseOn.TextColor=i.MouseOn.TextColor)),G(a.Buttom.Margin,i.Margin),G(a.Buttom.TextMargin,i.TextMargin)}},this.SetTReportStyle=function(t){var e=t,a=this.TReport;if(e.BorderColor&&(a.BorderColor=e.BorderColor),e.UpTextColor&&(a.UpTextColor=e.UpTextColor),e.DownTextColor&&(a.DownTextColor=e.DownTextColor),e.UnchangeTextColor&&(a.UnchangeTextColor=e.UnchangeTextColor),e.BorderColor&&(a.SelectedColor=e.SelectedColor),e.UpBGColor&&(a.UpBGColor=e.UpBGColor),e.DownBGColor&&(a.DownBGColor=e.DownBGColor),e.Header){var i=e.Header;if(i.Color&&(a.Header.Color=i.Color),i.SortColor&&(a.Header.SortColor=i.SortColor),i.Mergin){var r=i.Mergin;sa.IsNumber(r.Left)&&(a.Header.Mergin.Left=r.Left),sa.IsNumber(r.Right)&&(a.Header.Mergin.Left=r.Right),sa.IsNumber(r.Top)&&(a.Header.Mergin.Top=r.Top),sa.IsNumber(r.Bottom)&&(a.Header.Mergin.Bottom=r.Bottom)}if(i.Font){var n=i.Font;n.Name&&(a.Header.Font.Name=n.Name),sa.IsNumber(n.Size)&&(a.Header.Font.Size=n.Size)}}if(e.CenterItem){var o=e.CenterItem;o.TextColor&&(a.CenterItem.TextColor=o.TextColor),o.BaseTextColor&&(a.CenterItem.BaseTextColor=o.BaseTextColor),o.BGColor&&(a.CenterItem.BGColor=o.BGColor)}if(e.Item){var s=e.Item;if(s.Mergin){r=s.Mergin;sa.IsNumber(r.Left)&&(a.Item.Mergin.Left=r.Left),sa.IsNumber(r.Right)&&(a.Item.Mergin.Right=r.Right),sa.IsNumber(r.Top)&&(a.Item.Mergin.Top=r.Top),sa.IsNumber(r.Bottom)&&(a.Item.Mergin.Bottom=r.Bottom)}if(s.Font){n=s.Font;n.Name&&(a.Item.Font.Name=n.Name),sa.IsNumber(n.Size)&&(a.Item.Font.Size=n.Size)}if(s.NameFont){n=s.NameFont;n.Name&&(a.Item.NameFont.Name=n.Name),sa.IsNumber(n.Size)&&(a.Item.NameFont.Size=n.Size)}if(s.SymbolFont){n=s.SymbolFont;n.Name&&(a.Item.SymbolFont.Name=n.Name),sa.IsNumber(n.Size)&&(a.Item.SymbolFont.Size=n.Size)}}if(e.FieldColor){var h=e.FieldColor;h.Name&&(a.FieldColor.Name=h.Name),h.Symbol&&(a.FieldColor.Symbol=h.Symbol),h.Vol&&(a.FieldColor.Vol=h.Vol),h.Amount&&(a.FieldColor.Amount=h.Amount),h.Index&&(a.FieldColor.Index=h.Index),h.Text&&(a.FieldColor.Text=h.Text),h.Position&&(a.FieldColor.Position=h.Position)}if(e.MarkBorder){var l=e.MarkBorder;l.MaxPositionColor&&(a.MarkBorder.MaxPositionColor=l.MaxPositionColor)}if(e.FixedItem){l=e.FixedItem;if(l.Font){n=l.Font;n.Name&&(a.FixedItem.Font.Name=n.Name),sa.IsNumber(n.Size)&&(a.FixedItem.Font.Size=n.Size)}}},this.SetFrameButtomToolbar=function(t){var e=this.FrameButtomToolbar;if(t.BGColor&&(e.BGColor=t.BGColor),t.BorderColor&&(e.BorderColor=t.BorderColor),t.Button){var a=t.Button;if(a.BorderColor&&(e.Button.BorderColor=a.BorderColor),a.Font){var i=a.Font,r=this.FrameButtomToolbar.Button.Font;i.Family&&(r.Family=i.Family),sa.IsNumber(i.Size)&&(r.Size=i.Size)}if(a.TitleColor){i=a.TitleColor,r=this.FrameButtomToolbar.Button.TitleColor;i.Selected&&(r.Selected=i.Selected),i.Default&&(r.Default=i.Default),i.MoveOn&&(r.MoveOn=i.MoveOn)}if(a.BGColor){i=a.BGColor,r=this.FrameButtomToolbar.Button.BGColor;i.Selected&&(r.Selected=i.Selected),i.Default&&(r.Default=i.Default),i.MoveOn&&(r.MoveOn=i.MoveOn)}if(a.Mergin){i=a.Mergin,r=this.FrameButtomToolbar.Button.Mergin;sa.IsNumber(i.Left)&&(r.Left=i.Left),sa.IsNumber(i.Right)&&(r.Left=i.Right),sa.IsNumber(i.Top)&&(r.Top=i.Top),sa.IsNumber(i.Bottom)&&(r.Bottom=i.Bottom)}if(a.SVG){i=a.SVG,r=this.FrameButtomToolbar.Button.SVG;sa.IsNumber(i.Size)&&(r.Size=i.Size),sa.IsNumber(i.MerginLeft)&&(r.MerginLeft=i.MerginLeft),i.Family&&(r.Family=i.Family)}}},this.SetMinuteToolbar=function(t){var e=this.MinuteToolbar;sa.IsBool(t.ModifyIndex)&&(e.ModifyIndex=t.ModifyIndex),sa.IsBool(t.ChangeIndex)&&(e.ChangeIndex=t.ChangeIndex),sa.IsBool(t.CloseIndex)&&(e.CloseIndex=t.CloseIndex),sa.IsBool(t.OverlayIndex)&&(e.OverlayIndex=t.OverlayIndex),sa.IsBool(t.MaxMinWindow)&&(e.ModifyIndex=t.MaxMinWindow),sa.IsBool(t.TitleWindow)&&(e.ModifyIndex=t.TitleWindow),sa.IsBool(t.ExportData)&&(e.ModifyIndex=t.ExportData),sa.IsBool(t.AddIndexWindow)&&(e.AddIndexWindow=t.AddIndexWindow),sa.IsBool(t.IsShowOverlayToolbar)&&(e.IsShowOverlayToolbar=t.IsShowOverlayToolbar),sa.IsBool(t.IsShowOverlayFrame)&&(e.IsShowOverlayFrame=t.IsShowOverlayFrame)},this.SetKLineToolbar=function(t){var e=this.KLineToolbar;sa.IsBool(t.ModifyIndex)&&(e.ModifyIndex=t.ModifyIndex),sa.IsBool(t.ChangeIndex)&&(e.ChangeIndex=t.ChangeIndex),sa.IsBool(t.CloseIndex)&&(e.CloseIndex=t.CloseIndex),sa.IsBool(t.OverlayIndex)&&(e.OverlayIndex=t.OverlayIndex),sa.IsBool(t.MaxMinWindow)&&(e.ModifyIndex=t.MaxMinWindow),sa.IsBool(t.TitleWindow)&&(e.ModifyIndex=t.TitleWindow),sa.IsBool(t.ExportData)&&(e.ModifyIndex=t.ExportData),sa.IsBool(t.AddIndexWindow)&&(e.AddIndexWindow=t.AddIndexWindow)},this.SetChartSimpleTable=function(t){var e=this.ChartSimpleTable;if(t.TextColor&&(e.TextColor=t.TextColor),t.BGColor&&(e.BGColor=t.BGColor),t.BorderColor&&(e.BorderColor=t.BorderColor),t.TextFont){var a=t.TextFont;a.Name&&(e.TextFont.Name=a.Name),sa.IsNumber(a.Size)&&(e.TextFont.Size=a.Size)}if(t.ItemMargin){var i=t.ItemMargin;sa.IsNumber(i.Left)&&(e.ItemMargin.Left=i.Left),sa.IsNumber(i.Right)&&(e.ItemMargin.Right=i.Right),sa.IsNumber(i.Top)&&(e.ItemMargin.Top=i.Top),sa.IsNumber(i.Bottom)&&(e.ItemMargin.Bottom=i.Bottom)}},this.SetChartSimplePie=function(t){var e=this.ChartSimplePie;if(t.TextFont){var a=t.TextFont;a.Name&&(e.TextFont.Name=a.Name),sa.IsNumber(a.Size)&&(e.TextFont.Size=a.Size)}if(t.BorderColor&&(e.BorderColor=t.BorderColor),t.Offset){a=t.Offset;sa.IsNumber(a.X)&&(e.Offset.X=a.X),sa.IsNumber(a.Y)&&(e.Offset.Y=a.Y)}},this.SetChartSimpleDoughnut=function(t){var e=this.ChartSimpleDoughnut;if(t.TextFont){var a=t.TextFont;a.Name&&(e.TextFont.Name=a.Name),sa.IsNumber(a.Size)&&(e.TextFont.Size=a.Size)}if(t.BorderColor&&(e.BorderColor=t.BorderColor),t.Offset){a=t.Offset;sa.IsNumber(a.X)&&(e.Offset.X=a.X),sa.IsNumber(a.Y)&&(e.Offset.Y=a.Y)}},this.SetChartSimpleRadar=function(t){var e=this.ChartSimpleRadar;if(t.TextFont){var a=t.TextFont;a.Name&&(e.TextFont.Name=a.Name),sa.IsNumber(a.Size)&&(e.TextFont.Size=a.Size)}if(t.BorderColor&&(e.BorderColor=t.BorderColor),t.TextColor&&(e.TextColor=t.TextColor),t.Offset){a=t.Offset;sa.IsNumber(a.X)&&(e.Offset.X=a.X),sa.IsNumber(a.Y)&&(e.Offset.Y=a.Y)}sa.IsNonEmptyArray(t.AryBGColor)&&(e.AryBGColor=t.AryBGColor.slice()),sa.IsNonEmptyArray(t.AryArea)&&(e.AryArea=t.AryArea.slice())},this.SetIndexLock=function(t){var e=t,a=this.IndexLock;e.BGColor&&(a.BGColor=e.BGColor),e.TextColor&&(a.TextColor=e.TextColor),e.Font&&(a.Font=e.Font),e.Title&&(a.Title=e.Title)},this.SetChartScatterPlotV2=function(t){var e=t,a=this.ChartScatterPlotV2;e.Color&&(a.Color=e.Color),e.TextColor&&(a.TextColor=e.TextColor),e.Font&&(a.Font=e.Font),sa.IsNumber(e.Radius)&&(a.Radius=e.Radius)}}Ha.ColorToRGBA=function(t,e){if(/^(rgb|RGB)/.test(t)){for(var a="#",i=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),r=0;r<i.length;r++){var n=Number(i[r]).toString(16);"0"===n&&(n+=n),a+=n}t=a}return"rgba("+parseInt("0x"+t.slice(1,3))+","+parseInt("0x"+t.slice(3,5))+","+parseInt("0x"+t.slice(5,7))+","+e+")"},Ha.RGBToHex=function(t){var e=t.indexOf(",")>-1?",":" ";t=t.substr(4).split(")")[0].split(e);var a=(+t[0]).toString(16),i=(+t[1]).toString(16),r=(+t[2]).toString(16);return 1==a.length&&(a="0"+a),1==i.length&&(i="0"+i),1==r.length&&(r="0"+r),"#"+a+i+r},Ha.HexToRGB=function(t){t=t.toLowerCase();if(t&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t)){if(4===t.length){for(var e="#",a=1;a<4;a+=1)e+=t.slice(a,a+1).concat(t.slice(a,a+1));t=e}var i=[];for(a=1;a<7;a+=2)i.push(parseInt("0x"+t.slice(a,a+2)));return"rgb("+i.join(",")+")"}return null},Ha.ArrayDrawPricture=[{Name:"线段",ClassName:"ChartDrawPictureLine",Create:function(){return new Ya}},{Name:"射线",ClassName:"ChartDrawPictureHaflLine",Create:function(){return new Ka}},{Name:"箭头",ClassName:"ChartDrawArrowLine",Create:function(){return new Wa}},{Name:"水平线",ClassName:"ChartDrawPictureHorizontalLine",Create:function(){return new za}},{Name:"水平射线",ClassName:"ChartDrawPictureHorizontalRay",Create:function(){return new Ja}},{Name:"趋势线",ClassName:"ChartDrawPictureTrendLine",Create:function(){return new Qa}},{Name:"矩形",ClassName:"ChartDrawPictureRect",Create:function(){return new qa}},{Name:"圆弧线",ClassName:"ChartDrawPictureArc",Create:function(){return new ja}},{Name:"M头W底",ClassName:"ChartDrawPictureWaveMW",Create:function(){return new $a}},{Name:"头肩型",ClassName:"ChartDrawHeadShouldersBT",Create:function(){return new ti}},{Name:"平行线",ClassName:"ChartDrawPictureParallelLines",Create:function(){return new ei}},{Name:"平行通道",ClassName:"ChartDrawPictureParallelChannel",Create:function(){return new oi}},{Name:"价格通道线",ClassName:"ChartDrawPicturePriceChannel",Create:function(){return new ni}},{Name:"文本",ClassName:"ChartDrawPictureText",Create:function(){return new si}},{Name:"江恩角度线",ClassName:"ChartDrawPictureGannFan",Create:function(){return new li}},{Name:"江恩角度线2",ClassName:"ChartDrawPictureGannFan",Create:function(){return new ui}},{Name:"阻速线",ClassName:"ChartDrawPictureResistanceLine",Create:function(){return new Ci}},{Name:"阻速线2",ClassName:"ChartDrawPictureResistanceLineV2",Create:function(){return new Di}},{Name:"黄金分割",ClassName:"ChartDrawPictureGoldenSection",Create:function(){return new fi}},{Name:"百分比线",ClassName:"ChartDrawPicturePercentage",Create:function(){return new ci}},{Name:"波段线",ClassName:"ChartDrawPictureWaveBand",Create:function(){return new mi}},{Name:"三角形",ClassName:"ChartDrawPictureTriangle",Create:function(){return new di}},{Name:"对称角度",ClassName:"ChartDrawPictureSymmetryAngle",Create:function(){return new Ii}},{Name:"圆",ClassName:"ChartDrawPictureCircle",Create:function(){return new Si}},{Name:"平行四边形",ClassName:"ChartDrawPictureQuadrangle",Create:function(){return new Ti}},{Name:"斐波那契周期线",ClassName:"ChartDrawPictureFibonacci",Create:function(){return new vi}},{Name:"线形回归线",ClassName:"ChartDrawLinearRegression",Create:function(){return new pi}},{Name:"线形回归带",ClassName:"ChartDrawLinearRegression",Create:function(){return new pi({IsShowMaxMinLine:!0})}},{Name:"延长线形回归带",ClassName:"ChartDrawLinearRegression",Create:function(){return new pi({IsShowMaxMinLine:!0,IsShowExtendLine:!0})}},{Name:"尺子",ClassName:"ChartDrawRuler",Create:function(){return new gi}},{Name:"标价线",ClassName:"ChartDrawPriceLine",Create:function(){return new xi}},{Name:"标价线2",ClassName:"ChartDrawPriceLineV2",Create:function(){return new Fi}},{Name:"垂直线",ClassName:"ChartDrawVerticalLine",Create:function(){return new Ei}},{Name:"十字线",ClassName:"ChartDrawCrosshair",Create:function(){return new Li}},{Name:"波浪尺",ClassName:"ChartDrawWaveRuler",Create:function(){return new yi}},{Name:"AB波浪尺",ClassName:"ChartDrawWaveRuler2Point",Create:function(){return new Ri}},{Name:"箱型线",ClassName:"ChartDrawBox",Create:function(){return new Ni}},{Name:"2点画图例子",ClassName:"ChartDrawTwoPointDemo",Create:function(){return new wi}},{Name:"3点画图例子",ClassName:"ChartDrawThreePointDemo",Create:function(){return new Ai}},{Name:"水平线段",ClassName:"ChartDrawHLineSegment",Create:function(){return new Oi}},{Name:"平行射线",ClassName:"ChartDrawParallelRaysLines",Create:function(){return new ri}},{ClassName:"ChartDrawPictureIconFont",Create:function(){return new hi}},{Name:"涂鸦线段",ClassName:"ChartDrawGraffitiLine",Create:function(){return new Xa}},{Name:"固定范围成交量分布图",ClassName:"ChartDrawVolProfile",Create:function(){return new bi}},{Name:"DisjointChannel",ClassName:"ChartDrawDisjontChannel",Create:function(){return new ii}},{Name:"FlatTop",ClassName:"ChartDrawFlatTop",Create:function(){return new ai}},{Name:"水平线2",ClassName:"ChartDrawHLine",Create:function(){return new Za}},{Name:"MonitorLine",ClassName:"ChartDrawMonitorLine",Create:function(){return new Mi}},{Name:"Note",ClassName:"ChartDrawNote",Create:function(){return new Bi}},{Name:"AnchoredText",ClassName:"ChartDrawAnchoredText",Create:function(){return new Pi}},{Name:"PriceLabel",ClassName:"ChartDrawPriceLabel",Create:function(){return new Gi}},{Name:"PriceNote",ClassName:"ChartDrawPriceNote",Create:function(){return new _i}},{Name:"FibWedge",ClassName:"ChartDrawFibWedge",Create:function(){return new Vi}},{Name:"FibRetracement",ClassName:"ChartFibRetracement",Create:function(){return new Hi}},{Name:"FibSpeedResistanceFan",ClassName:"ChartFibSpeedResistanceFan",Create:function(){return new Yi}},{Name:"PriceRange",ClassName:"ChartPriceRange",Create:function(){return new ki}},{Name:"DateRange",ClassName:"ChartDateRange",Create:function(){return new Xi}},{Name:"DatePriceRange",ClassName:"ChartDatePriceRange",Create:function(){return new Wi}},{Name:"InfoLine",ClassName:"ChartInfoLine",Create:function(){return new Ui}},{Name:"TrendAngle",ClassName:"ChartTrendAngle",Create:function(){return new ka}},{Name:"ArrowMarker",ClassName:"ChartArrowMarker",Create:function(){return new Ua}},{Name:"BarsPattern",ClassName:"ChartBarsPattern",Create:function(){return new Ki}}],Ha.MapIonFont=new Map([["icon-arrow_up",{Text:"",Color:"#318757",Family:"iconfont"}],["icon-arrow_down",{Text:"",Color:"#db563e",Family:"iconfont"}],["icon-arrow_right",{Text:"",Color:"#318757",Family:"iconfont"}],["icon-arrow_left",{Text:"",Color:"#318757",Family:"iconfont"}]]),Ha.GetDrawPictureByName=function(t){for(var e in Ha.ArrayDrawPricture){var a=Ha.ArrayDrawPricture[e];if(a.Name==t)return a}return null},Ha.GetDrawPictureByClassName=function(t){for(var e in Ha.ArrayDrawPricture){var a=Ha.ArrayDrawPricture[e];if(a.ClassName==t)return a}return null},Ha.RegisterDrawPicture=function(t){if(!t.Name||!t.ClassName||!t.Create)return!1;var e={Name:t.Name,ClassName:t.ClassName,Create:t.Create};return Ha.ArrayDrawPricture.push(e),u.Chart.Log("[IChartDrawPicture.RegisterDrawPicture] registered new draw picture class. item=",e),!0},Ha.RegisterIonFont=function(t){if(!t.Name||!t.Text||!t.Family)return!1;var e=Ha.MapIonFont.has(t.Name);return Ha.MapIonFont.set(t.Name,t),u.Chart.Log("[IChartDrawPicture.RegisterIonFont] registered new icon font, obj=, isOverwirte=",t,e),!0},Ha.CreateChartDrawPicture=function(t){var e=Ha.GetDrawPictureByClassName(t.ClassName);if(!e)return null;var a=e.Create();return t.Period>=0&&(a.Period=t.Period),t.Right>=0&&(a.Right=t.Right),t.Guid&&(a.Guid=t.Guid),t.Symbol&&(a.Symbol=t.Symbol),t.Value&&(a.Value=t.Value),t.Text&&(a.Text=t.Text),t.LineColor&&(a.LineColor=t.LineColor),t.AreaColor&&(a.AreaColor=t.AreaColor),t.FontOption&&(a.FontOption=t.FontOption),t.Label&&(a.Label=t.Label),t.LineWidth>0&&(a.LineWidth=t.LineWidth),!1===t.EnableMove&&(a.EnableMove=t.EnableMove),sa.IsBool(t.EnableSave)&&(a.EnableSave=t.EnableSave),sa.IsNumber(t.ChannelWidth)&&(a.ChannelWidth=t.ChannelWidth),sa.IsBool(t.IsShowYCoordinate)&&(a.IsShowYCoordinate=t.IsShowYCoordinate),a.SetOption&&a.SetOption(t),a};var qi=new Qi,ji={LANGUAGE_CHINESE_ID:0,LANGUAGE_ENGLISH_ID:1,LANGUAGE_TRADITIONAL_CHINESE_ID:2};var $i=new function(){this.TextResource=new Map([["Tooltip-Open",{CN:"开:",EN:"O:",TC:"開"}],["Tooltip-High",{CN:"高:",EN:"H:",TC:"高"}],["Tooltip-Low",{CN:"低:",EN:"L:",TC:"低"}],["Tooltip-Close",{CN:"收:",EN:"C:",TC:"收"}],["Tooltip-Increase",{CN:"幅:",EN:"I:",TC:"幅"}],["Tooltip-Vol",{CN:"量:",EN:"V:",TC:"量"}],["Tooltip-Amount",{CN:"额:",EN:"A:",TC:"額"}],["Tooltip-AvPrice",{CN:"均:",EN:"AP:",TC:"均"}],["Tooltip-Price",{CN:"价:",EN:"P:",TC:"價"}],["Tooltip-Exchange",{CN:"换:",EN:"E:",TC:"換"}],["Tooltip-Position",{CN:"持:",EN:"P:",TC:"持"}],["DivTooltip-Open",{CN:"开盘:",EN:"Open:",TC:"開盤"}],["DivTooltip-High",{CN:"最高:",EN:"High:",TC:"最高"}],["DivTooltip-Low",{CN:"最低:",EN:"Low:",TC:"最低"}],["DivTooltip-Close",{CN:"收盘:",EN:"Close:",TC:"收盤"}],["DivTooltip-Increase",{CN:"涨幅:",EN:"Increase:",TC:"漲幅"}],["DivTooltip-Vol",{CN:"数量:",EN:"Volume:",TC:"數量"}],["DivTooltip-Amount",{CN:"金额:",EN:"Amount:",TC:"金額"}],["DivTooltip-Exchange",{CN:"换手:",EN:"Exchange:",TC:"換手"}],["DivTooltip-Position",{CN:"持仓:",EN:"Position:",TC:"持倉"}],["DivTooltip-Price",{CN:"价格:",EN:"Price:",TC:"價格"}],["DialogTooltip-Date",{CN:"日期",EN:"Date",TC:"日期"}],["DialogTooltip-Time",{CN:"时间",EN:"Time",TC:"時間"}],["DialogTooltip-Open",{CN:"开盘价",EN:"Open",TC:"開盤價"}],["DialogTooltip-High",{CN:"最高价",EN:"High",TC:"最高價"}],["DialogTooltip-Low",{CN:"最低价",EN:"Low",TC:"最低價"}],["DialogTooltip-Close",{CN:"收盘价",EN:"Close",TC:"收盤價"}],["DialogTooltip-Increase",{CN:"涨幅",EN:"Increase",TC:"漲幅"}],["DialogTooltip-Risefall",{CN:"涨跌",EN:"Risefall",TC:"漲跌"}],["DialogTooltip-Vol",{CN:"成交量",EN:"Volume",TC:"數量"}],["DialogTooltip-Amount",{CN:"成交额",EN:"Amount",TC:"金額"}],["DialogTooltip-Exchange",{CN:"换手率",EN:"Exchange",TC:"換手"}],["DialogTooltip-Position",{CN:"持仓量",EN:"Position",TC:"持倉"}],["DialogTooltip-Price",{CN:"价格",EN:"Price",TC:"價格"}],["DialogTooltip-AvPrice",{CN:"均价",EN:"AVPrice:",TC:"均價"}],["DialogTooltip-FClose",{CN:"结算价",EN:"Settlement",TC:"結算價"}],["DialogTooltip-Amplitude",{CN:"振幅",EN:"amplitude",TC:"振幅"}],["DialogTooltip-AC-Price",{CN:"匹配价",EN:"Price",TC:"匹配價"}],["DialogTooltip-AC-AvPrice",{CN:"匹配均价",EN:"AVPrice",TC:"匹配均價"}],["DialogTooltip-AC-Increase",{CN:"竞价涨幅",EN:"Increase",TC:"競價漲幅"}],["DialogTooltip-AC-Vol",{CN:"匹配量",EN:"Vol",TC:"匹配量"}],["DialogTooltip-Value",{CN:"数值",EN:"Value",TC:"数值"}],["FloatTooltip-Date",{CN:"日期",EN:"Date",TC:"日期"}],["FloatTooltip-Time",{CN:"时间",EN:"Time",TC:"時間"}],["FloatTooltip-Open",{CN:"开盘价",EN:"Open",TC:"開盤價"}],["FloatTooltip-High",{CN:"最高价",EN:"High",TC:"最高價"}],["FloatTooltip-Low",{CN:"最低价",EN:"Low",TC:"最低價"}],["FloatTooltip-Close",{CN:"收盘价",EN:"Close",TC:"收盤價"}],["FloatTooltip-YClose",{CN:"昨收价",EN:"YClose",TC:"昨收價"}],["FloatTooltip-Increase",{CN:"涨幅",EN:"Increase",TC:"漲幅"}],["FloatTooltip-Risefall",{CN:"涨跌",EN:"Risefall",TC:"漲跌"}],["FloatTooltip-Vol",{CN:"成交量",EN:"Volume",TC:"數量"}],["FloatTooltip-Amount",{CN:"成交额",EN:"Amount",TC:"金額"}],["FloatTooltip-Exchange",{CN:"换手率",EN:"Exchange",TC:"換手"}],["FloatTooltip-Position",{CN:"持仓量",EN:"Position",TC:"持倉"}],["FloatTooltip-Price",{CN:"价格",EN:"Price",TC:"價格"}],["FloatTooltip-AvPrice",{CN:"均价",EN:"AVPrice:",TC:"均價"}],["FloatTooltip-FClose",{CN:"结算价",EN:"Settlement",TC:"結算價"}],["FloatTooltip-YSettlePrice",{CN:"昨结算",EN:"YSettlement",TC:"昨結算"}],["FloatTooltip-Amplitude",{CN:"振幅",EN:"amplitude",TC:"振幅"}],["DialogSelectRect-StartPrice",{CN:"起始价:",EN:"Start Price:",TC:"起始價"}],["DialogSelectRect-EndPrice",{CN:"最终价:",EN:"End Price:",TC:"最终價"}],["DialogSelectRect-High",{CN:"最高价:",EN:"High:",TC:"最高價"}],["DialogSelectRect-Low",{CN:"最低价:",EN:"Low:",TC:"最低價"}],["DialogSelectRect-Increase",{CN:"区间涨幅:",EN:"Increase",TC:"漲幅"}],["DialogSelectRect-Amplitude",{CN:"区间振幅:",EN:"amplitude",TC:"振幅"}],["DialogSelectRect-Vol",{CN:"成交量:",EN:"Volume",TC:"數量"}],["DialogSelectRect-Amount",{CN:"成交额:",EN:"Amount",TC:"金額"}],["DialogSelectRect-Up",{CN:"阳线:",EN:"Up",TC:"阳线"}],["DialogSelectRect-Down",{CN:"阴线:",EN:"Down",TC:"阴线"}],["DialogSelectRect-Unchanged",{CN:"平线:",EN:"Unchanged",TC:"平线"}],["DialogSelectRect-DataCount",{CN:"数据个数:",EN:"Data Count:",TC:"数据个数"}],["PCTooltip-Date",{CN:"日期",EN:"Date",TC:"日期"}],["PCTooltip-Time",{CN:"时间",EN:"Time",TC:"時間"}],["PCTooltip-Price",{CN:"价格",EN:"Price:",TC:"價格"}],["PCTooltip-AvPrice",{CN:"均价",EN:"AVPrice:",TC:"均價"}],["PCTooltip-Increase",{CN:"涨幅",EN:"Increase:",TC:"漲幅"}],["PCTooltip-Vol",{CN:"成交量",EN:"Volume:",TC:"成交量"}],["PCTooltip-Amount",{CN:"成交额",EN:"Amount:",TC:"成交額"}],["PCTooltip-Position",{CN:"持仓量",EN:"Position:",TC:"持倉"}],["PCTooltip-AC-Price",{CN:"匹配价:",EN:"Price:",TC:"匹配價"}],["PCTooltip-AC-Increase",{CN:"竞价涨幅:",EN:"Increase:",TC:"競價漲幅"}],["PCTooltip-AC-Vol",{CN:"匹配量:",EN:"V:",TC:"匹配量"}],["PCTooltip-AC-NotMatchVol",{CN:"未匹配量:",EN:"NV:",TC:"未匹配量"}],["KTitle-Open",{CN:"开:",EN:"O:",TC:"開"}],["KTitle-High",{CN:"高:",EN:"H:",TC:"高"}],["KTitle-Low",{CN:"低:",EN:"L:",TC:"低"}],["KTitle-Close",{CN:"收:",EN:"C:",TC:"收"}],["KTitle-Increase",{CN:"幅:",EN:"I:",TC:"幅"}],["KTitle-Vol",{CN:"量:",EN:"V:",TC:"量"}],["KTitle-Amount",{CN:"额:",EN:"A:",TC:"額"}],["KTitle-Exchange",{CN:"换:",EN:"E:",TC:"換"}],["KTitle-Position",{CN:"持:",EN:"P:",TC:"持"}],["KTitle-Price",{CN:"价:",EN:"Price:",TC:"價"}],["MTitle-AC-Price",{CN:"匹配价:",EN:"C:",TC:"匹配價"}],["MTitle-AC-AvPrice",{CN:"匹配均价:",EN:"C:",TC:"匹配均價"}],["MTitle-AC-Increase",{CN:"竞价涨幅:",EN:"I:",TC:"競價漲幅"}],["MTitle-AC-Vol",{CN:"匹配量:",EN:"V:",TC:"匹配量"}],["MTitle-AC-NotMatchVol",{CN:"未匹配量:",EN:"NV:",TC:"未匹配量"}],["MTitle-AC-Amount",{CN:"匹配量金额:",EN:"A:",TC:"匹配量金额"}],["MTitle-AC-NotMatchAmount",{CN:"未匹配量金额:",EN:"NA:",TC:"未匹配量金额"}],["MTitle-Close",{CN:"价:",EN:"C:",TC:"價"}],["MTitle-AvPrice",{CN:"均:",EN:"AC:",TC:"均"}],["MTitle-Increase",{CN:"幅:",EN:"I:",TC:"幅"}],["MTitle-Vol",{CN:"量:",EN:"V:",TC:"量"}],["MTitle-Amount",{CN:"额:",EN:"A:",TC:"額"}],["MTitle-Position",{CN:"持:",EN:"P:",TC:"持"}],["MTitle-UpdateTime",{CN:"更新:",EN:"Update:",TC:"更新:"}],["日线",{CN:"日线",EN:"1D",TC:"日綫"}],["周线",{CN:"周线",EN:"1W",TC:"周綫"}],["双周",{CN:"双周",EN:"2W",TC:"雙周"}],["月线",{CN:"月线",EN:"1M",TC:"月綫"}],["半年",{CN:"半年",EN:"HY",TC:"半年"}],["年线",{CN:"年线",EN:"1Y",TC:"年綫"}],["1分",{CN:"1分",EN:"1Min",TC:"1分"}],["5分",{CN:"5分",EN:"5Min",TC:"5分"}],["15分",{CN:"15分",EN:"15Min",TC:"15分"}],["30分",{CN:"30分",EN:"30Min",TC:"30分"}],["60分",{CN:"60分",EN:"60Min",TC:"60分"}],["季线",{CN:"季线",EN:"1Q",TC:"季綫"}],["分笔",{CN:"分笔",EN:"Tick",TC:"分筆"}],["2小时",{CN:"2小时",EN:"2H",TC:"2小時"}],["4小时",{CN:"4小时",EN:"4H",TC:"4小時"}],["不复权",{CN:"不复权",EN:"No Right",TC:"不復權"}],["前复权",{CN:"前复权",EN:"Pro Right",TC:"前復權"}],["后复权",{CN:"后复权",EN:"Post Right",TC:"后復權"}],["日",{CN:"日",EN:"Sun.",TC:"日"}],["一",{CN:"一",EN:"Mon.",TC:"壹"}],["二",{CN:"二",EN:"Tues.",TC:"貳"}],["三",{CN:"三",EN:"Wed.",TC:"叁"}],["四",{CN:"四",EN:"Thur.",TC:"肆"}],["五",{CN:"五",EN:"Fri.",TC:"伍"}],["六",{CN:"六",EN:"Sat.",TC:"陸"}],["1月",{CN:"1月",EN:"Jan",TC:"1月"}],["2月",{CN:"2月",EN:"Feb",TC:"2月"}],["3月",{CN:"3月",EN:"Mar",TC:"3月"}],["4月",{CN:"4月",EN:"Apr",TC:"4月"}],["5月",{CN:"5月",EN:"May",TC:"5月"}],["6月",{CN:"6月",EN:"Jun",TC:"6月"}],["7月",{CN:"7月",EN:"Jul",TC:"7月"}],["8月",{CN:"8月",EN:"Aug",TC:"8月"}],["9月",{CN:"9月",EN:"Sept",TC:"9月"}],["10月",{CN:"10月",EN:"Oct",TC:"10月"}],["11月",{CN:"11月",EN:"Nov",TC:"11月"}],["12月",{CN:"12月",EN:"Dec",TC:"12月"}],["自定义分钟",{CN:"分",EN:"Min",TC:"分"}],["自定义日线",{CN:"日",EN:"D",TC:"日"}],["自定义秒",{CN:"秒",EN:"S",TC:"秒"}],["自定义毫秒",{CN:"毫秒",EN:"MS",TC:"毫秒"}],["MVol-Vol",{CN:"成交量",EN:"Volume",TC:"成交量"}],["MVol-Position",{CN:"持仓量",EN:"Position",TC:"持倉量"}],["Depth-Price",{CN:"委托价",EN:"Price",TC:"委托價"}],["Depth-Sum",{CN:"累计",EN:"Sum",TC:"累計"}],["Toolbar-"+S.MODIFY_INDEX_PARAM,{CN:"调整指标参数",EN:"Change indicator parameters",TC:"调整指标参数"}],["Toolbar-"+S.CHANGE_INDEX,{CN:"选择指标",EN:"Change indicator",TC:"切换指标"}],["Toolbar-"+S.CLOSE_INDEX_WINDOW,{CN:"关闭窗口",EN:"Delete window",TC:"关闭指标窗口"}],["Toolbar-"+S.OVERLAY_INDEX,{CN:"叠加指标",EN:"Overlay indicator",TC:"叠加指标"}],["Toolbar-"+S.MODIFY_OVERLAY_INDEX_PARAM,{CN:"调整叠加指标参数",EN:"Change overlay indicator parameters",TC:"调整叠加指标参数"}],["Toolbar-"+S.MAX_MIN_WINDOW,{CN:"最大化",EN:"Maximize",TC:"最大化"}],["Toolbar-"+S.TITLE_WINDOW,{CN:"折叠窗口",EN:"Collapse window",TC:"折叠窗口"}],["Toolbar-"+S.EXPORT_DATA,{CN:"数据导出",EN:"Export data",TC:"数据导出"}],["Toolbar-"+S.ADD_INDEX_WINDOW,{CN:"增加指标窗口",EN:"Add index window",TC:"增加指标窗口"}],["Toolbar-"+S.CLOSE_BEFOREOPEN_ID,{CN:"关闭集合竞价",EN:"Close call auction",TC:"关闭集合竞价"}],["Toolbar-"+S.CLOSE_OVERLAY_INDEX,{CN:"关闭叠加指标",EN:"Delte overlay indicator",TC:"关闭叠加指标"}],["Toolbar-"+S.CHIP_RECENT,{CN:"近期成本分布",EN:"Recent chip",TC:"近期成本分布"}],["Toolbar-"+S.CHIP_LONG,{CN:"远期成本分布",EN:"Long chip",TC:"远期成本分布"}],["Toolbar-"+S.CHIP_DEFULT,{CN:"默认筹码分布",EN:"Default chip",TC:"默认筹码分布"}],["Toolbar-"+S.CHIP_CLOSE,{CN:"关闭筹码图",EN:"Close chip",TC:"关闭筹码图"}],["Toolbar-"+S.DRAW_PICTURE_DELETE,{CN:"删除",EN:"Delete",TC:"删除"}],["Toolbar-"+S.DRAW_PICTURE_SETTING,{CN:"设置",EN:"Setting",TC:"设置"}],["日盘",{CN:"日盘",EN:"Day",TC:"日盤"}],["夜盘",{CN:"夜盘",EN:"Night",TC:"夜盤"}],["天",{CN:"天",EN:"Day",TC:"天"}],["周",{CN:"周",EN:"Week",TC:"周"}],["月",{CN:"月",EN:"Month",TC:"月"}],["年",{CN:"年",EN:"Year",TC:"年"}],["至今涨幅",{CN:"至今涨幅",EN:"increase to date ",TC:"至今涨幅"}]]),this.GetText=function(t,e){var a=this.TextResource.get(t);if(!a)return"";switch(e){case ji.LANGUAGE_CHINESE_ID:return a.CN;case ji.LANGUAGE_ENGLISH_ID:return a.EN;case ji.LANGUAGE_TRADITIONAL_CHINESE_ID:return a.TC;default:return a.CN}},this.SetTextResource=function(t,e){this.TextResource.set(t,e)},this.GetLanguageID=function(t){var e=null;switch(t){case"EN":e=ji.LANGUAGE_ENGLISH_ID;break;case"CN":e=ji.LANGUAGE_CHINESE_ID;break;case"TC":e=ji.LANGUAGE_TRADITIONAL_CHINESE_ID;break;default:break}return e},this.GetLanguageName=function(t){switch(t){case ji.LANGUAGE_ENGLISH_ID:return"EN";case ji.LANGUAGE_CHINESE_ID:return"CN";case ji.LANGUAGE_TRADITIONAL_CHINESE_ID:return"TC";default:return null}}};function tr(){}tr.Get=function(t){var e=new Map([["CJL",{IsMainIndex:!1,Create:function(){return new Sr}}],["OX",{IsMainIndex:!1,Create:function(){return new dr}}],["可视范围成交量分布图",{IsMainIndex:!0,Create:function(t){return new Ir(t)}}]]);return e.get(t)};var er=new function(){this.DataMap=new Map([["RenkoCalculate",{Create:function(){return new ar}}],["HeikinAshiCalculate",{Create:function(){return new rr}}],["LineBreakCalcuate",{Create:function(){return new nr}}],["KagiCalculate",{Create:function(){return new ir}}]]),this.Create=function(t){if(!this.DataMap.has(t))return null;var e=this.DataMap.get(t);return e.Create()}};function ar(){this.BrickSize=.05,this.SourceData,this.LastData,this.ATR={Count:14,BrickSize:.05},this.BrickSizeType=1,this.Symbol,this.FloatPrecision=2,this.ClassName="RenkoCalculate",this.SetOption=function(t){if(t&&(sa.IsNumber(t.BrickSize)&&(this.BrickSize=t.BrickSize),sa.IsNumber(t.BrickSizeType)&&(this.BrickSizeType=t.BrickSizeType),t.ATR)){var e=t.ATR;sa.IsNumber(e.Count)&&(this.ATR.Count=e.Count)}},this.CalculateByClose=function(t){var e=new dt;if(e.Data=[],e.Right=t.Right,e.Period=t.Period,e.DataType=t.DataType,e.Symbol=t.symbol,!sa.IsNonEmptyArray(t.Data))return e;var a=this.BrickSize;1==this.BrickSizeType&&(a=this.ATR.BrickSize);var i=t.Data[0];this.LastData=ht.Copy(i);for(var r=1;r<t.Data.length;){i=t.Data[r];var n=i.Close-this.LastData.Close,o=i.Close-this.LastData.Open;if(Math.abs(n)>=a&&Math.abs(o)>=a){var s=0;if(n>0||o>0){var h=this.LastData.Close,l=Math.max(this.LastData.Close,this.LastData.Open),u=l+a,C=u,D=l;s=i.Vol}else{h=this.LastData.Close,l=Math.min(this.LastData.Close,this.LastData.Open),u=l-a,C=l,D=u;s=i.Vol}var f=new ht;f.Date=i.Date,f.Time=i.Time,f.YClose=h,f.Open=l,f.High=C,f.Low=D,f.Close=u,f.Vol=this.LastData.Vol+s,e.Data.push(f),this.LastData.YClose=f.YClose,this.LastData.Open=f.Open,this.LastData.High=f.High,this.LastData.Low=f.Low,this.LastData.Close=f.Close,this.LastData.Date=f.Date,this.LastData.Time=f.Time,this.LastData.Vol=0}else this.LastData.Vol+=i.Vol,++r}return e},this.RecvHistoryData=function(t,e){return this.Symbol=e.Symbol,this.SourceData=t,this.FloatPrecision=Jr(this.Symbol),1==this.BrickSizeType&&this.CalculateATR(),this.CalculateByClose(t)},this.Clear=function(){this.SourceData=null,this.LastData=null,this.Symbol=null},this.GetTitle=function(){if(1==this.BrickSizeType)var t="Renko [ATR(".concat(this.ATR.Count,"), ").concat(this.ATR.BrickSize,"]");else t="Renko [Traditional, ".concat(this.BrickSize,"]");return t},this.CalculateATR=function(){if(sa.IsNonEmptyArray(this.SourceData.Data)){for(var t=this.SourceData.Data,e=t.length,a=[],i=e-1,r=0;i>=0&&r<this.ATR.Count;--i,++r){var n=t[i],o=Math.max(n.High-n.Low,n.High-n.Close,n.Close-n.Low);a.push(o)}var s=0;for(i=0;i<a.length;++i)s+=a[i];var h=s/a.length;o=h.toFixed(this.FloatPrecision);this.ATR.BrickSize=parseFloat(o)}}}function ir(){this.newMethod=ar,this.newMethod(),delete this.newMethod,this.ClassName="KagiCalculate",this.BrickSizeType=0,this.BrickSize=.5,this.RecvHistoryData=function(t,e){return this.Symbol=e.Symbol,this.SourceData=t,this.FloatPrecision=Jr(this.Symbol),1==this.BrickSizeType&&this.CalculateATR(),this.CalculateByClose(t)},this.CalculateByClose=function(t){var e=new dt;if(e.Data=[],e.Right=t.Right,e.Period=t.Period,e.DataType=t.DataType,e.Symbol=t.symbol,!sa.IsNonEmptyArray(t.Data))return e;var a=this.BrickSize;1==this.BrickSizeType&&(a=this.ATR.BrickSize);var i=t.Data[0],r=ht.Copy(i);r.High=r.Low=i.Close,r.StartItem=i,r.Direction=0;for(var n=1;n<t.Data.length;++n){i=t.Data[n];if(i.Close>r.Close){r.Direction=1,r.Close=i.Close,r.EndItem=i,r.High=i.Close;break}if(i.Close<r.Close){r.Direction=2,r.Close=i.Close,r.EndItem=i,r.Low=i.Close;break}}var o=null;for(++n;n<t.Data.length;++n){i=t.Data[n];if(1==r.Direction){if(i.Close>=r.High)r.Close=i.Close,r.High=i.Close,r.EndItem=i,o=null;else if(o?(o.Close=i.Close,o.Low>i.Close&&(o.Low=i.Close)):(o=ht.Copy(i),o.High=o.Low=i.Close),Math.abs(o.Low-r.High)>a){e.Data.push(r);var s=ht.Copy(i);s.High=r.High,s.Low=i.Close,s.Direction=2,s.StartItem=i,r=s,o=null}}else if(2==r.Direction)if(i.Close<=r.Low)r.Close=i.Close,r.Low=i.Close,r.EndItem=i;else if(o?(o.Close=i.Close,o.High<i.Close&&(o.High=i.Close)):(o=ht.Copy(i),o.High=o.Low=i.Close),Math.abs(o.High-r.Low)>a){e.Data.push(r);s=ht.Copy(i);s.High=i.Close,s.Low=r.Low,s.Direction=1,s.StartItem=i,r=s,o=null}}return e},this.GetTitle=function(){if(1==this.BrickSizeType)var t="Kagi [ATR(".concat(this.ATR.Count,"), ").concat(this.ATR.BrickSize,"]");else t="Kagi [Traditional]";return t}}function rr(){this.SourceData,this.Symbol,this.FloatPrecision=2,this.ClassName="HeikinAshiCalculate",this.Clear=function(){this.SourceData=null,this.LastData=null,this.Symbol=null},this.RecvHistoryData=function(t,e){return this.Symbol=e.Symbol,this.SourceData=t,this.FloatPrecision=Jr(this.Symbol),this.Calculate(t)},this.GetTitle=function(){return"Heikin Ashi"},this.Calculate=function(t){var e=new dt;if(e.Data=[],e.Right=t.Right,e.Period=t.Period,e.DataType=t.DataType,e.Symbol=t.symbol,!sa.IsNonEmptyArray(t.Data))return e;for(var a=null,i=null,r=0;r<t.Data.length;++r){var n=t.Data[r],o=ht.Copy(n);a?(o.Close=(n.Close+n.Open+n.High+n.Low)/4,o.Open=(a.Close+a.Open)/2,o.YClose=i,o.High=Math.max(o.Close,o.Open,n.High),o.Low=Math.min(o.Close,o.Open,n.Low),i=o.Close):(o.Open=(n.Close+n.Open)/2,o.Close=(n.Close+n.Open+n.High+n.Low)/4,i=o.Close),a=n,e.Data.push(o)}return e}}function nr(){this.SourceData,this.Symbol,this.FloatPrecision=2,this.LineCount=3,this.ClassName="LineBreakCalcuate",this.Clear=function(){this.SourceData=null,this.LastData=null,this.Symbol=null},this.GetTitle=function(){return"Line Break [".concat(this.LineCount,"]")},this.RecvHistoryData=function(t,e){return this.Symbol=e.Symbol,this.SourceData=t,this.FloatPrecision=Jr(this.Symbol),this.CalculateByClose(t)},this.CalculatePreviousKLine=function(t){for(var e=0;e<t.Data.length;++e){var a=t.Data[e];0==e?(t.High=a.High,t.Low=a.Low):(t.High<a.High&&(t.High=a.High),t.Low<a.Low&&(t.Low=a.Low)),t.Date=a.Date,t.Time=a.Time,t.Vol+=a.Vol,t.Amount+=a.Amount}},this.CalculateByClose=function(t){var e=new dt;if(e.Data=[],e.Right=t.Right,e.Period=t.Period,e.DataType=t.DataType,e.Symbol=t.symbol,!sa.IsNonEmptyArray(t.Data))return e;for(var a=0,i={High:null,Low:null,Date:null,Time:null,Direction:0};a<t.Data.length&&a<this.LineCount;++a){var r=t.Data[a];0==n?(i.High=r.High,i.Low=r.Low):(i.High<r.High&&(i.High=r.High),i.Low>r.Low&&(i.Low=r.Low)),i.Date=r.Date,i.Time=r.Time,i.Vol+=r.Vol,i.Amount+=r.Amount}for(var n=a;n<t.Data.length;++n){r=t.Data[n];if(r.Close>i.High){var o=new ht;o.YClose=i.Low,o.Open=i.High,o.Close=r.Close,o.Low=Math.min(o.Open,o.Close),o.High=Math.max(o.Open,o.Close),o.Date=r.Date,o.Time=r.Time,o.Vol=r.Vol,o.Amount=r.Amount,o.Direction=1,e.Data.push(o),i=o}else if(r.Close<i.Low){o=new ht;o.YClose=i.High,o.Open=i.Low,o.Close=r.Close,o.Low=Math.min(o.Open,o.Close),o.High=Math.max(o.Open,o.Close),o.Date=r.Date,o.Time=r.Time,o.Vol=r.Vol,o.Amount=r.Amount,o.Direction=2,e.Data.push(o),i=o}else i&&(1==i.Direction||i.Direction,i.Vol+=r.Vol,i.Amount+=r.Amount)}return e}}function or(t,e,a){this.newMethod=g,this.newMethod(t,e,a),delete this.newMethod,this.ClassName="KLineChartContainer",this.WindowIndex=new Array,this.ColorIndex,this.TradeIndex,this.Symbol,this.Name,this.Period=0,this.IsApiPeriod=!1,this.Right=0,this.RightFormula=0,this.SourceData,this.MaxRequestDataCount=3e3,this.MaxRequestMinuteDayCount=5,this.PageSize=200,this.KLineDrawType=0,this.ScriptErrorCallback,this.FlowCapitalReady=!1,this.EnableFlowCapital={},this.EnableZoomUpDown=null,this.ChartDrawStorage=new zi,this.ChartDrawStorageCache=null,this.RightSpaceCount=0,this.SourceDataLimit=new Map,this.CtrlMoveStep=5,this.ShiftMoveStep=1,this.CustomShow=null,this.ZoomType=0,this.IsZoomLockRight=!1,this.KLineSize=null,this.Page={Day:{Enable:!1,Index:0,Finish:!1},Minute:{Enable:!1,Index:0,Finish:!1}},this.DragDownload={Day:{Enable:!1,IsEnd:!1,Status:0},Minute:{Enable:!1,IsEnd:!1,Status:0},Tick:{Enable:!1,IsEnd:!1,Status:0}},this.ZoomDownload={Day:{Enable:!1,IsEnd:!1,Status:0},Minute:{Enable:!1,IsEnd:!1,Status:0},Tick:{Enable:!1,IsEnd:!1,Status:0}},this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.KLineApiUrl=qi.Domain+"/API/KLine2",this.MinuteKLineApiUrl=qi.Domain+"/API/KLine3",this.DragMinuteKLineApiUrl=qi.Domain+"/API/KLine4",this.DragKLineApiUrl=qi.Domain+"/API/KLine5",this.ZoomMinuteKLineApiUrl=qi.Domain+"/API/KLine4",this.ZoomKLineApiUrl=qi.Domain+"/API/KLine5",this.RealtimeApiUrl=qi.Domain+"/API/Stock",this.KLineMatchUrl=qi.Domain+"/API/KLineMatch",this.StockHistoryDayApiUrl=qi.Domain+"/API/StockHistoryDay",this.TickApiUrl=qi.Domain+"/API/StockDetail",this.PopMinuteChart=null,this.BeforeBindMainData=null,this.AfterBindMainData=null,this.KLineCalculate=null,this.KLineCalcOption=new Map,this.ScrollBar=null,this.IsAutoSyncDataOffset=!0,this.AryHotKey=[{KeyID:87,SecondKeyID:3,CMD:v.CMD_FULLSCREEN_SUMMARY_ID,Args:null,Description:"Alt+W\t全屏区间统计"}],this.KLineDragConfig={EnableShfit:!1},this.GetKLineCalulate=function(){var t,e=this.GetKLineDrawType();if(10==e)t="RenkoCalculate";else if(11==e)t="HeikinAshiCalculate";else if(12==e)t="LineBreakCalcuate";else{if(16!=e)return null;t="KagiCalculate"}if((!this.KLineCalculate||this.KLineCalculate.ClassName!=t)&&(this.KLineCalculate=er.Create(t),this.KLineCalculate.SetOption&&this.KLineCalcOption.has(t))){var a=this.KLineCalcOption.get(t);this.KLineCalculate.SetOption(a)}return this.KLineCalculate},this.SetKLineCalcOption=function(t,e){this.KLineCalcOption.set(t,e),this.KLineCalculate&&this.KLineCalculate.ClassName==t&&this.KLineCalculate.SetOption&&this.KLineCalculate.SetOption(e)},this.ClearKLineCaluate=function(){this.KLineCalculate&&this.KLineCalculate.Clear&&this.KLineCalculate.Clear()},this.ResetDragDownload=function(){this.DragDownload.Day.Status=0,this.DragDownload.Day.IsEnd=!1,this.DragDownload.Minute.Status=0,this.DragDownload.Minute.IsEnd=!1,this.DragDownload.Tick.Status=0,this.DragDownload.Tick.IsEnd=!1},this.ResetZoomDownload=function(){this.ZoomDownload.Day.Status=0,this.ZoomDownload.Day.IsEnd=!1,this.ZoomDownload.Minute.Status=0,this.ZoomDownload.Minute.IsEnd=!1,this.ZoomDownload.Tick.Status=0,this.ZoomDownload.Tick.IsEnd=!1},this.ResetPage=function(){this.Page.Day.Finish=!1,this.Page.Day.Index=0,this.Page.Minute.Finish=!1,this.Page.Minute.Index=0},this.AddCustomKLine=function(t,e){var a=this.ChartPaint[0];if(a&&t){if(a.CustomKLine||(a.CustomKLine=new Map),Array.isArray(t))for(var i=0;i<t.length;++i){var r=t[i];a.CustomKLine.set(r.Key,r.Data)}else t&&a.CustomKLine.set(t.Key,t.Data);e&&1==e.Draw&&this.Draw()}},this.ClearCustomKLine=function(t){var e=this.ChartPaint[0];e&&(e.ClearCustomKLine(),t&&1==t.Draw&&this.Draw())},this.ClearKLineBreakPoint=function(t){var e=this.ChartPaint[0];e&&(e.ClearBreakPoint(),t&&1==t.Draw&&this.Draw())},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::StopAutoUpdate"),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.SandTableOperator=function(t){switch(t.ID){case 1:this.StopAutoUpdate(),t.Data&&this.ManualUpdateKData(t);break;case 2:this.ManualUpdateKData(t);break;case 3:t.IsAutoUpdate&&(this.IsAutoUpdate=t.IsAutoUpdate),this.ChangeSymbol(this.Symbol);break}},this.ManualUpdateKData=function(t){var e=t.Data,a=e.length,i=new dt;i.Data=e,i.Period=this.Period,i.Right=this.Right,i.Symbol=this.Symbol,this.UpdateMainData(i,a),this.BindInstructionIndexData(i);for(var r=0;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,i);if(sa.IsNumber(t.DataOffset)&&t.DataOffset>=0){var n=null;n=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,n&&(n.DataOffset=t.DataOffset)}this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendManualKLineUpdateEvent(i)},this.GetKDataInfo=function(){if(!this.ChartPaint[0])return null;var t=this.ChartPaint[0],e={};return t.Data&&t.Data.Data&&(e.Data=t.Data.CloneData("HistoryData")),e.ShowRange=t.ShowRange,e.Period=this.Period,e.RightSpaceCount=this.RightSpaceCount,e},this.ChartOperator=function(t){var e=t.ID;if(e===d.OP_SCROLL_LEFT||e===d.OP_SCROLL_RIGHT){var a=e===d.OP_SCROLL_LEFT,i=1;t.Step>0&&(i=t.Step);var r=this.GetMoveOneStepWidth();this.DataMove(i*r,a)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):e===d.OP_SCROLL_RIGHT&&this.DragDownloadData&&this.DragDownloadData()}else if(e===d.OP_ZOOM_IN||e===d.OP_ZOOM_OUT){var n={};if(n.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),e===d.OP_ZOOM_IN){if(!this.Frame.ZoomUp(n))return}else if(!this.Frame.ZoomDown(n))return;this.CursorIndex=n.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Draw()}else if(e===d.OP_GOTO_HOME){var o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;var s=this.Frame.SubFrame[0].Frame.XPointCount;s-=this.RightSpaceCount;var h=o.Data.length-s;o.DataOffset=h,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,u.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_HOME, dataOffset=".concat(o.DataOffset," CursorIndex=").concat(this.CursorIndex," PageSize=").concat(s)),this.ChartOperator_Temp_Update()}else if(e===d.OP_GOTO_END){o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;o.DataOffset=0,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,u.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_END "),this.ChartOperator_Temp_Update()}else if(e==d.OP_LEFT_ZOOM_IN||e==d.OP_LEFT_ZOOM_OUT){o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;var l=o.Data.length,C=(s=this.Frame.SubFrame[0].Frame.XPointCount,o.DataOffset);if(e==d.OP_LEFT_ZOOM_IN){if(sa.IsNumber(t.Step)){if(s>=l)return;i=t.Step;if(i>C&&(i=C),s+i>l&&(i=l-s),i<=0)return;s+=i,o.DataOffset-=i}}else if(e==d.OP_LEFT_ZOOM_OUT){var D=this.GetMaxMinPageSize(),f=D.Min;if(sa.IsNumber(t.Step)){if(s<f)return;i=t.Step;if(s-i<f&&(i=s-f),i<=0)return;s-=i,o.DataOffset+=i}}for(var c in this.Frame.SubFrame){var I=this.Frame.SubFrame[c].Frame;I.XPointCount=s}o.DataOffset<0&&(o.DataOffset=0),this.ChartOperator_Temp_Update()}else if(e==d.OP_RIGHT_ZOOM_IN||e==d.OP_RIGHT_ZOOM_OUT){o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;l=o.Data.length,s=this.Frame.SubFrame[0].Frame.XPointCount,C=o.DataOffset;if(e==d.OP_RIGHT_ZOOM_IN){if(sa.IsNumber(t.Step)){if(s>=l)return;var S=C+s,T=l-S;if(T<=0)return;i=t.Step;if(i>T&&(i=T),i<=0)return;s+=i}}else if(e==d.OP_RIGHT_ZOOM_OUT){D=this.GetMaxMinPageSize(),f=D.Min;if(sa.IsNumber(t.Step)){if(s<f)return;i=t.Step;if(i>s&&(i=s),s-i<f&&(i=s-f),i<=0)return;s-=i}}for(var c in this.Frame.SubFrame){I=this.Frame.SubFrame[c].Frame;I.XPointCount=s}o.DataOffset<0&&(o.DataOffset=0),this.ChartOperator_Temp_Update()}else{if(e==d.OP_SET_SELECTRECT){if(!this.ChartPaint[0])return!1;if(!this.ChartPaint[0].Data)return!1;o=this.ChartOperator_Temp_GetHistoryData();if(!sa.IsNonEmptyArray(o.Data))return!1;var v=this.GetRectSelectPaint();if(!v)return!1;if(!dt.IsDayPeriod(this.Period,!0))return!1;for(c=0;c<o.Data.length;++c){I=o.Data[c];if(I.Date==t.Start.Date&&(F={KItem:I,DataIndex:c}),I.Date==t.End.Date&&(E={KItem:I,DataIndex:c}),t.SubClient&&t.SubClient.Start&&I.Date==t.SubClient.Start.Date&&(L={KItem:I,DataIndex:c}),t.SubClient&&t.SubClient.End&&I.Date==t.SubClient.End.Date&&(M={KItem:I,DataIndex:c}),F&&E)break}if(!F||!E)return u.Chart.Warn("[KLineChartContainer::ChartOperator][OP_SET_SELECTRECT] can't find date. firstPoint, secondPoint, obj",F,E,t),!1;v.SetPoint(F.KItem,{Index:0,DataIndex:F.DataIndex}),v.SetPoint(E.KItem,{Index:1,DataIndex:E.DataIndex}),L&&M&&(v.SetPoint(L.KItem,{Index:3,DataIndex:L.DataIndex}),v.SetPoint(M.KItem,{Index:4,DataIndex:M.DataIndex})),sa.IsBool(t.PreventClose)&&(v.PreventClose=t.PreventClose);var p=!1,g=this.ChartPaint[0].DrawKRange;if(g&&(g.Start>=F.DataIndex&&g.Start>=E.DataIndex||g.End<=F.DataIndex&&g.End<=E.DataIndex)){var x=F.DataIndex;l=o.Data.length,s=this.ChartPaint[0].ShowRange.ShowCount;x+s>l&&(x=l-s),x<0&&(x=0),o.DataOffset=x,p=!0}return p?this.ChartOperator_Temp_Update():this.Draw(),!0}if(e==d.OP_SET_SUB_SELECTRECT){if(!this.ChartPaint[0])return!1;if(!this.ChartPaint[0].Data)return!1;o=this.ChartOperator_Temp_GetHistoryData();if(!sa.IsNonEmptyArray(o.Data))return!1;var F,E,L,M;v=this.GetRectSelectPaint();if(!v)return!1;if(!dt.IsDayPeriod(this.Period,!0))return!1;for(c=0;c<o.Data.length;++c){I=o.Data[c];if(I.Date==t.Start.Date&&(F={KItem:I,DataIndex:c}),I.Date==t.End.Date&&(E={KItem:I,DataIndex:c}),F&&E)break}return F&&E?(v.SetPoint(F.KItem,{Index:3,DataIndex:F.DataIndex}),v.SetPoint(E.KItem,{Index:4,DataIndex:E.DataIndex}),this.Draw(),!0):(u.Chart.Warn("[KLineChartContainer::ChartOperator][OP_SET_SUB_SELECTRECT] can't find date. firstPoint, secondPoint, obj",F,E,t),!1)}if(e==d.OP_SCROOLBAR_SLIDER_CHANGED){o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;if(0==t.Type)o.DataOffset=t.Start.Index,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,this.ChartOperator_Temp_Update();else if(1==t.Type||2==t.Type){t.Start.Index,s=t.End.Index-t.Start.Index+1;var y=o.Data[t.Start.Index];o.Data[t.End.Index];this.Frame.SetXShowCount(s),o.DataOffset=t.Start.Index,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,this.ChartOperator_Temp_Update()}}else if(e==d.OP_GOTO){if(!sa.IsNumber(t.Date))return;o=this.ChartOperator_Temp_GetHistoryData();if(!o||!sa.IsNonEmptyArray(o.Data))return;h=this.ChartOperator_GetIndex_ByDateTime(o,t,this.Period,0);if(null===h)return void u.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO can't find date=".concat(t.Date," time=").concat(t.Time));var R=0;sa.IsNumber(t.Position)&&(R=t.Position);var N=this.Frame.SubFrame[0].Frame.XPointCount,w=N;if(t.PageSize>0&&(w=t.PageSize),w!=N&&this.Frame.SetXShowCount(w),1==R){var A=parseInt(w/2);h-=A,h<0&&(h=0)}o.DataOffset=h,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,this.ChartOperator_Temp_Update()}else if(e==d.OP_GOTO_BY_DATAINDEX){if(!sa.IsNumber(t.DataIndex))return;o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;if(t.DataIndex<0||t.DataIndex>=o.Data.length)return void u.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_BY_DATAINDEX obj.DataIndex=".concat(t.DataIndex," error.}"));N=this.Frame.SubFrame[0].Frame.XPointCount,w=N;t.PageSize>0&&(w=t.PageSize),w!=N&&this.Frame.SetXShowCount(w),o.DataOffset=t.DataIndex,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,this.ChartOperator_Temp_Update()}else{if(e==d.OP_CORSSCURSOR_GOTO){if(!sa.IsNumber(t.Date))return;var O=sa.IsNumber(t.Time),b=this.GetChartStatus();if(!b)return;o=this.ChartOperator_Temp_GetHistoryData();if(!o)return;y=o.DataOffset;for(var B=-1,P=null,G=-1,_=(c=y,0);c<o.Data.length&&_<b.KLine.PageSize;++c,++_){I=o.Data[c];if(O){if(I.Date==t.Date&&I.Time==t.Time){P=I,B=_,G=c;break}}else if(I.Date==t.Date){P=I,B=_,G=c;break}}if(B<0){if(1==t.Type){var V=-1,H=-1,Y={X:V,Y:H,IsInClient:this.IsMouseOnClient(V,H)};this.LastMouseStatus.OnMouseMove=Y,this.LastMouseStatus.MoveOnPoint={X:V,Y:H};var k=this.GetEventCallback(m.ON_MOUSE_MOVE),X=this.TitlePaint[0];k&&X&&(X.OnMouseMoveEvent=k);var W={clientX:V,clientY:H};this.MoveOnPoint={X:V,Y:H},this.OnMouseMove(V,H,W),this.LastMouseStatus.MoveOnPoint=null,X&&(X.OnMouseMoveEvent=null)}return}return this.ChartOperator_Temp_SetChartCorssCursor(B,I)}if(e==d.OP_MOVE_CORSSCURSOR){if(!sa.IsNumber(t.Step))return!1;if(0==t.Step)return!1;i=t.Step;if(!this.Frame||!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return!1;s=this.Frame.SubFrame[0].Frame.XPointCount;var U=this.GetKData();if(!U||!sa.IsNonEmptyArray(U.Data))return!1;y=U.DataOffset;var K=dt.IsDayPeriod(this.Period,!0);for(P=null,G=-1,c=0;c<U.Data.length;++c){I=U.Data[c];if(I)if(K){if(I.Date==t.Start.Date){P=I,G=c;break}}else if(I.Date==t.Start.Date&&I.Time==t.Start.Time){P=I,G=c;break}}if(!P)return!1;h=-1,C=U.DataOffset;G>=y&&G<=y+(s-1)?h=G-y:i>0?G+s>=U.Data.length?(C=U.Data.length-s,h=G-C):(h=0,C=G):G-s<0?(C=0,h=G):G+s>=U.Data.length?(C=U.Data.length-s,h=G-C):(h=s,C=G-s);var z=P;if(i>0)for(c=G+1,_=0;c<U.Data.length&&_<i;++c,++_){++h,G=c,h>=s-1&&(h=s-1,C+=1);I=U.Data[c];if(I)z=I}else if(i<0)for(c=G-1,_=0;c>=0&&_<Math.abs(i);--c,++_){--h,G=c,h<=0&&(h=0,C-=1);I=U.Data[c];if(I)z=I}return!!z&&(t.KItem=z,U.DataOffset==C?this.ChartOperator_Temp_SetChartCorssCursor(h,z):(U.DataOffset=C,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Frame.SetSizeChage(!0),this.Draw(),this.ChartOperator_Temp_SetChartCorssCursor(h,z),!0))}}}},this.ChartOperator_Temp_SetChartCorssCursor=function(t,e){if(!this.Frame||!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return!1;var a=this.Frame.SubFrame[0].Frame,i=a.GetXFromIndex(t),r=a.GetYFromData(e.Close),n={X:i,Y:r,IsInClient:this.IsMouseOnClient(i,r)};this.LastMouseStatus.OnMouseMove=n,this.LastMouseStatus.MoveOnPoint={X:i,Y:r};var o=this.GetEventCallback(m.ON_MOUSE_MOVE),s=this.TitlePaint[0];o&&s&&(s.OnMouseMoveEvent=o);var h=F(),l={};return l.clientX=i/h+this.UIElement.getBoundingClientRect().left,l.clientY=r/h+this.UIElement.getBoundingClientRect().top,this.MoveOnPoint={X:i,Y:r},this.OnMouseMove(i,r,l),this.LastMouseStatus.MoveOnPoint=null,s&&(s.OnMouseMoveEvent=null),!0},this.ChartOperator_Temp_GetHistoryData=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,t||null},this.ChartOperator_Temp_GetHistroyData=this.ChartOperator_Temp_GetHistoryData,this.ChartOperator_Temp_Update=function(){this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.ChartOperator_GetIndex_ByDateTime=function(t,e,a,i){if(!t)return null;if(!sa.IsNonEmptyArray(t.Data))return null;if(!sa.IsPlusNumber(e.Date)||e.Date<19810101)return null;if(dt.IsDayPeriod(a,!0)){for(var r=0;r<t.Data.length;++r){var n=t.Data[r];if(1==i){if(n.Date==e.Date)return r}else if(n.Date>=e.Date)return r}return null}if(dt.IsMinutePeriod(a,!0)||dt.IsMilliSecondPeriod(a)){var o=null;sa.IsNumber(e.Time)&&(o=e.Time);for(r=0;r<t.Data.length;++r){n=t.Data[r];if(1==i){if(null==o)return null;if(n.Date==e.Date&&n.Time==o)return r}else if(null==o){if(n.Date>=e.Date)return r}else if(n.Date>e.Date||n.Date==e.Date&&n.Time>=o)return r}return null}return null},this.OnWheel=function(t){var e=this;if(u.Chart.Log("[KLineChartContainer::OnWheel]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a,i=F(),r=(t.clientX-this.UIElement.getBoundingClientRect().left)*i,n=(t.clientY-this.UIElement.getBoundingClientRect().top)*i;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),a=this.Canvas.isPointInPath(r,n),sa.IsNumber(t.deltaY)){var o=t.deltaY*i;if(Math.abs(o)<90)return}var s=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(s=-.01*t.deltaY);var h=!0;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Wheel&&(h=!1),this.SourceData&&this.SourceData.Data)if(a&&s<0&&h){var l={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};l.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),t.ctrlKey&&(l.ZoomType=1),this.Frame.ZoomDown(l,{ZoomDownloadDataCallback:function(t){e.ZoomDownloadData(t)}})&&(this.CursorIndex=l.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.ChartSplashPaint&&1==this.ChartSplashPaint.IsEnableSplash||this.Draw(),this.OnKLinePageChange("wheel"))}else if(a&&s>0&&h){l={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};l.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),t.ctrlKey&&(l.ZoomType=1),this.Frame.ZoomUp(l)&&(u.Chart.Log("[KLineChartContainer::OnWheel] cursorIndex ",l),this.CursorIndex=l.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXSplit(),this.Draw(),this.OnKLinePageChange("wheel"))}(a||this.OnWheel_ZoomUpDownFrameY(t,r,n))&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}},this.OnWheel_ZoomUpDownFrameY=function(t,e,a){if(!this.EnableYDrag.Wheel)return!1;var i=this.TryYDrag(e,a);if(!i)return!1;if(!(i.Left&&!i.IsOverlay||i.Right))return!1;var r=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(r=-.01*t.deltaY);var n=this.EnableYDrag.WheelYMove;return r>0&&(n*=-1),i.Position=0,!!this.Frame.OnZoomUpDownFrameY(i,n)&&(this.Frame.SetSizeChage(!0),this.Draw(),!0)},this.Create=function(t,e){var a=this;for(var i in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new ma,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=Aa.Create("CorssCursor_XStringFormat"),this.ChartCorssCursor.StringFormatX.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatX.IsShowIncrease=!0,this.ChartCorssCursor.StringFormatY=Aa.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ExtendChartPaint=this.ExtendChartPaint,this.ChartCorssCursor.StringFormatY.HQChart=this,this.ChartCorssCursor.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.OnChangeStatusCallback=function(t,e){a.OnChangeCorssCursorStatus(t,e)},this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new nt,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.Frame.GetExtendChartRightWidth=function(){return a.GetExtendChartRightWidth()},this.Frame.GetExtendChartByClassName=function(t){return a.GetExtendChartByClassName(t)},this.Frame.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.CreateExtendChart("RectSelectPaint",e?e.SelectRect:null),this.EnableIndexChartDrag&&this.CreateExtendChart("DragMovePaint"),this.CreateDragSelectRect(e?e.DragSelectRect:null),this.Frame.SubFrame){var r=new Va;r.Frame=this.Frame.SubFrame[i].Frame,r.Canvas=this.Canvas,r.LanguageID=this.LanguageID,r.GetEventCallback=function(t){return a.GetEventCallback(t)},r.SelectedChart=this.SelectedChart,r.HQChart=this,this.TitlePaint.push(r)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame;var n=!0,o=!0;if(e&&e.Listener){var s=e.Listener;!1===s.KeyDown&&(n=!1,u.Chart.Log("[KLineChartContainer::Create] not register keydown event.")),!1===s.Wheel&&(o=!1,u.Chart.Log("[KLineChartContainer::Create] not register wheel event."))}n&&this.UIElement.addEventListener("keydown",(function(t){a.OnKeyDown(t)}),!0),o&&this.UIElement.addEventListener("wheel",(function(t){a.OnWheel(t)}),!0),this.InitalPopMinuteChart(e)},this.InitalPopMinuteChart=function(t){if(!t)return!1;if(t.PopMinuteChart&&t.PopMinuteChart.Enable){var e=t.PopMinuteChart;return this.PopMinuteChart=new JSPopMinuteChart,this.PopMinuteChart.Inital(this,e),this.PopMinuteChart.Create(),!0}return!(!t.KLine||!0!==t.KLine.KLineDoubleClick)&&(this.PopMinuteChart=new JSPopMinuteChart,this.PopMinuteChart.Inital(this),this.PopMinuteChart.Create(),!0)},this.DestroyPopMinuteChart=function(){this.PopMinuteChart&&(this.PopMinuteChart.Destroy(),this.PopMinuteChart=null)},this.ShowMinuteChartDialog=function(t,e,a){if(this.PopMinuteChart&&dt.IsDayPeriod(this.Period,!0)&&t.Tooltip&&t.Chart){var i=F(),r=this.UIElement.getBoundingClientRect(),n=w();e+=r.left+n.Left,a+=r.top+n.Top;var o=t.Tooltip.Data,s=o.Date,h=null;t.Tooltip.ChartPaint&&"DRAWKLINE"==t.Tooltip.ChartPaint.Name?o.Symbol?h=o.Symbol:t.Tooltip.Symbol&&(h=t.Tooltip.Symbol):h=t.Chart.Symbol,h&&this.PopMinuteChart.Show({Date:s,Symbol:h,Data:t.Tooltip.Data,Chart:t.Tooltip.ChartPaint},e/i,a/i)}},this.OnCustomKeyDown=function(t,e){return 37==t&&e.ctrlKey?(this.MoveCorssCursorLeft(this.CtrlMoveStep),!0):39==t&&e.ctrlKey?(this.MoveCorssCursorRight(this.CtrlMoveStep),!0):37==t&&e.shiftKey?(this.MoveKLineLeft(this.ShiftMoveStep),!0):39==t&&e.shiftKey?(this.MoveKLineRight(this.ShiftMoveStep),!0):38==t&&e.shiftKey?(this.MoveCorssCursorUp(this.ShiftUpDownStepPixel),!0):40==t&&e.shiftKey?(this.MoveCorssCursorDown(this.ShiftUpDownStepPixel),!0):13==t&&void this.OnEnterKeyDown()},this.MoveKLineLeft=function(t){return this.MoveKLine(-t)},this.MoveKLineRight=function(t){return this.MoveKLine(t)},this.MoveKLine=function(t){if(0!=t){var e=this.GetMoveOneStepWidth(),a=t*e,i=!0;t<0&&(a=Math.abs(t)*e,i=!1),this.DataMove(a,i)&&(this.UpdataDataoffset(),this.RepairCursorIndex(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("datamove"))}},this.RepairCursorIndex=function(){var t=this.GetKData();if(t){var e=0;if(e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,sa.IsPlusNumber(e)){this.CursorIndex<0&&(this.CursorIndex=0);var a=this.CursorIndex;a=parseInt(a.toFixed(0)),a+t.DataOffset>=t.Data.length&&(this.CursorIndex=t.Data.length-1-t.DataOffset)}}},this.MoveCorssCursorLeft=function(t){var e=null;if(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,e)if(e.DataOffset<=0&&this.CursorIndex<=0)this.DragDownloadData&&this.DragDownloadData();else{if(this.CursorIndex-t<0)return e.DataOffset-=t,e.DataOffset<0&&(e.DataOffset=0,this.CursorIndex=0),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),void this.OnKLinePageChange("keydown");this.CursorIndex-=t,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}},this.MoveCorssCursorRight=function(t){var e=null;if(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,e){var a=0;if(a=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!(this.CursorIndex+e.DataOffset+1>=e.Data.length)){var i=!1;if(this.CursorIndex+t+e.DataOffset+1>e.Data.length&&(t=e.Data.length-1-e.DataOffset-this.CursorIndex,i=!0),this.CursorIndex+t>=a){var r=this.CursorIndex+t-(a-1);return e.DataOffset+=r,i&&(this.CursorIndex=a-1),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),void this.OnKLinePageChange("keydown")}this.CursorIndex+=t,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}}},this.OnEnterKeyDown=function(){if(!this.PopMinuteChart)return!1;if(!dt.IsDayPeriod(this.Period,!0))return!1;if(!this.ChartCorssCursor||!this.ChartCorssCursor.IsShowCorss||this.ChartCorssCursor.ClientPos<0)return!1;var t=this.ChartCorssCursor.CursorIndex;t=parseInt(t.toFixed(0));var e=this.GetKData();if(!e||!sa.IsNonEmptyArray(e.Data))return!1;var a=e.DataOffset+t;if(a<0||a>=e.Data.length)return!1;var i=e.Data[a];if(!i)return!1;var r=this.Frame.SubFrame[0].Frame,n=r.GetXFromIndex(t),o=r.GetYFromData(i.Close),s={Chart:this,Tooltip:{ChartPaint:this.ChartPaint[0],Data:i}};this.ShowMinuteChartDialog(s,n,o)},this.GetKLineChart=function(){return this.ChartPaint[0]?this.ChartPaint[0]:null},this.CreateChildWindow=function(t){for(var e=this,a=this.GetEventCallback(m.ON_CREATE_FRAME),i=0;i<t;++i){var r=new X;r.UIElement=this.UIElement;var n=W.Create("KLineFrame",{ID:i});if(n.Canvas=this.Canvas,n.GetExtraCanvas=function(t){return e.GetExtraCanvas(t)},n.ChartBorder=r,n.Identify=i,n.RightSpaceCount=this.RightSpaceCount,n.GetEventCallback=function(t){return e.GetEventCallback(t)},n.GlobalOption=this.GlobalOption,n.HorizontalMax=20,n.HorizontalMin=10,0==i){n.YSplitOperator=new ha,n.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),n.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),n.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},n.YSplitOperator.GetKLineChartCallback=function(){return e.GetKLineChart()},n.YSplitOperator.HQChart=this;var o=F();r.BottomSpace=15*o,r.TopSpace=15*o,n.GetEventCallback=function(t){return e.GetEventCallback(t)}}else n.YSplitOperator=new la,n.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),n.YSplitOperator.LanguageID=this.LanguageID,n.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},n.YSplitOperator.GetKLineChartCallback=function(){return e.GetKLineChart()},n.YSplitOperator.HQChart=this;n.YSplitOperator.Frame=n,n.YSplitOperator.ChartBorder=r,n.XSplitOperator=new ua,n.XSplitOperator.Frame=n,n.XSplitOperator.ChartBorder=r,n.XSplitOperator.LanguageID=this.LanguageID,n.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i!=t-1&&(n.XSplitOperator.ShowText=!1);for(var s=n.HorizontalMin;s<=n.HorizontalMax;s+=1)n.HorizontalInfo[s]=new Y,n.HorizontalInfo[s].Value=s,0==i&&s==n.HorizontalMin||(n.HorizontalInfo[s].Message[1]=s.toString(),n.HorizontalInfo[s].Font="14px 微软雅黑");var h=new it;if(n.FrameData.SubFrameItem=h,h.Frame=n,h.Height=0==i?20:10,this.Frame.SubFrame[i]=h,a&&a.Callback){var l={SubFrame:this.Frame.SubFrame[i],WindowIndex:i};a.Callback(a,l,this)}}},this.CreateSubFrameItem=function(t){var e=this,a=new X;a.UIElement=this.UIElement;var i="KLineFrame";"KLineChartHScreenContainer"==this.ClassName&&(i="KLineHScreenFrame");var r=W.Create(i,{ID:t});r.Canvas=this.Canvas,r.GetExtraCanvas=function(t){return e.GetExtraCanvas(t)},r.ChartBorder=a,r.Identify=t,r.GetEventCallback=function(t){return e.GetEventCallback(t)},r.GlobalOption=this.GlobalOption,r.HorizontalMax=20,r.HorizontalMin=10,r.YSplitOperator=new la,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=a,r.XSplitOperator=new ua,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=a,r.XSplitOperator.ShowText=!1,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.GetKLineChartCallback=function(){return e.GetKLineChart()},r.YSplitOperator.HQChart=this,r.XSplitOperator.Symbol=this.Symbol,r.XSplitOperator.Period=this.Period;var n=this.Frame.SubFrame[0].Frame.XPointCount;r.XPointCount=n,r.Data=this.ChartPaint[0].Data;for(var o=r.HorizontalMin;o<=r.HorizontalMax;o+=1)r.HorizontalInfo[o]=new Y,r.HorizontalInfo[o].Value=o,r.HorizontalInfo[o].Message[1]=o.toString(),r.HorizontalInfo[o].Font="14px 微软雅黑";var s=new it;r.FrameData.SubFrameItem=s,s.Frame=r,s.Height=10;var h=this.GetEventCallback(m.ON_CREATE_FRAME);if(h&&h.Callback){var l={SubFrame:s,WindowIndex:t};h.Callback(h,l,this)}return s},this.CreateMainKLine=function(){var t=this,e=xt.Create("ChartKLine");e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Main-KLine",e.DrawType=this.KLineDrawType,e.Identify="Main-KLine",e.HQChart=this,e.GetEventCallback=function(e){return t.GetEventCallback(e)},this.ChartPaint[0]=e,this.TitlePaint[0]=new Ba,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].LanguageID=this.LanguageID,this.TitlePaint[0].HQChart=this,this.TitlePaint[0].GetEventCallback=function(e){return t.GetEventCallback(e)}},this.BindKLineBreakPoint=function(t){var e=this.ChartPaint[0];e&&sa.IsNonEmptyArray(t.AryBreakPoint)&&(e.AryBreakPoint=t.AryBreakPoint.slice())},this.BindMainData=function(t,e,a){var i=!1;if(a&&!0===a.IsShowAll&&(i=!0),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,this.KLineSize)if(sa.IsNumber(this.KLineSize.DataWidth)){var r=this.Frame.SetDataWidth(this.KLineSize.DataWidth);e=r.XPointCount-this.RightSpaceCount,this.KLineSize.DataWidth=null}else e=this.Frame.SubFrame[0].Frame.XPointCount-this.RightSpaceCount;for(var n=0;n<this.Frame.SubFrame.length;++n){var o=this.Frame.SubFrame[n].Frame;o.XPointCount=i?t.Data.length+this.RightSpaceCount:e+this.RightSpaceCount,o.Data=this.ChartPaint[0].Data,o.XSplitOperator.Symbol=this.Symbol,o.XSplitOperator.Period=this.Period}this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data;for(n=0;n<this.OverlayChartPaint.length;++n){o=this.OverlayChartPaint[n];o.MainData=this.ChartPaint[0].Data}if(i){var s=0;this.CursorIndex=0}else{s=t.Data.length-e;s<0&&(s=0),this.ChartPaint[0].Data.DataOffset=s,this.CursorIndex=e,this.CursorIndex+s>=t.Data.length&&(this.CursorIndex=t.Data.length-1-s),this.CursorIndex<0&&(this.CursorIndex=0)}this.ChartPaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.CustomShow&&(this.SetCustomShow(this.CustomShow,t),this.CustomShow=null)},this.ShowAllKLine=function(){var t=this.ChartPaint[0];if(!t)return!1;var e=t.Data;if(!e||!sa.IsNonEmptyArray(e.Data))return!1;for(var a=e.Data.length+this.RightSpaceCount,i=0;i<this.Frame.SubFrame.length;++i){var r=this.Frame.SubFrame[i].Frame;r.XPointCount=a}e.DataOffset=0,this.CursorIndex=0,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdatePointByCursorIndex(2),this.Draw()},this.UpdateMainData=function(t,e){var a=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(a=this.Frame.SubFrame[0].Frame.Data):a=this.Frame.Data,a){var i=this.Frame.SubFrame[0].Frame.XPointCount,r=0;for(var n in sa.IsNumber(e)&&(e>0&&t.Data.length>e?(r=t.Data.length-e,u.Chart.Log("[KLineChartContainer::UpdateMainData]  [count=".concat(e,"->").concat(t.Data.length,"], [newDataCount=").concat(r,"], [Pagesize=").concat(i,"]"))):0==e&&t.Data.length>i&&(r=t.Data.length-i,u.Chart.Log("[KLineChartContainer::UpdateMainData] history data is empty. [count=".concat(e,"->").concat(t.Data.length,"], [newDataCount=").concat(r,"], [Pagesize=").concat(i,"]")))),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,t.Data.length>i&&(this.ChartPaint[0].Data.DataOffset=a.DataOffset+r),this.Frame.SubFrame){var o=this.Frame.SubFrame[n].Frame;o.Data=this.ChartPaint[0].Data,0==n&&(o.YSplitOperator.Symbol=this.Symbol,o.YSplitOperator.Data=this.ChartPaint[0].Data,o.YSplitOperator.Period=this.Period)}for(var n in this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){o=this.OverlayChartPaint[n];o.MainData=this.ChartPaint[0].Data}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol}},this.SetCustomShow=function(t,e){if(t.Callback)t.Callback(chart,e);else{var a=this.ChartOperator_GetIndex_ByDateTime(e,t,this.Period,0);if(null!==a){if(sa.IsPlusNumber(t.PageSize))for(var i=t.PageSize,r=0;r<this.Frame.SubFrame.length;++r){var n=this.Frame.SubFrame[r].Frame;n.XPointCount=i}if(sa.IsNumber(t.Position)){var o=this.Frame.SubFrame[0].Frame.XPointCount,s=parseInt(o/2);a-=s,a<0&&(a=0)}this.ChartPaint[0].Data.DataOffset=a,this.CursorIndex=0}else u.Chart.Log("[KLineChartContainer::SetCustomShow] Can't find index by customShow=",t)}},this.OnDragSelectRectMouseUp=function(t){var e=this.GetRectSelectPaint();if(e){var a=e.GetSelectRectData();if(a){var i=F(),r=this.ChartCorssCursor,n=r.LastPoint.X/i,o=r.LastPoint.Y/i;if(t){var s={Chart:this,X:n,Y:o,SelectData:a,RectSelectPaint:e};t.data=s}var h=[{Name:"区间统计",Data:{ID:v.CMD_SELECTED_SUMMARY_ID,Args:[t,a]}},{Name:"区间放大",Data:{ID:v.CMD_SELECTED_ZOOM_ID,Args:[a]}}],l=this.GetEventCallback(m.ON_DRAG_SELECT_RECT_MOUSEUP);if(l){var u={X:n,Y:o,SelectData:a,RectSelectPaint:e,AryMenu:null,PreventDefault:!1};if(l.Callback(l,u,this),1==u.PreventDefault)return;h=u.AryMenu}this.IsShowSelectRectDialog()?this.DrawSelectRectDialog(t):h&&this.PopupSelectRectMenuV3(h,s,t)}}},this.OnDragSubSelectRectMouseUp=function(t){var e=this.GetRectSelectPaint();if(e){var a=e.GetSelectRectData();if(a){var i=F(),r=this.ChartCorssCursor,n=r.LastPoint.X/i,o=r.LastPoint.Y/i,s=this.GetEventCallback(m.ON_DRAG_SUB_SELECT_RECT_MOUSEUP);if(s){var h={Start:e.SubClient.FirstPoint,End:e.SubClient.SecondPoint},l={X:n,Y:o,SubSelectData:h,RectSelectPaint:e};s.Callback(s,l,this)}}}},this.ShowSelectData=function(t){this.HideSelectRect(),u.Chart.Log("[KLineChartContainer::ShowSelectData] selectData",t);var e=t.Start,a=t.End-t.Start+1;for(var i in u.Chart.Log("[KLineChartContainer::ShowSelectData] DataOffset=".concat(e,", ShowCount=").concat(a)),this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame;r.XPointCount=a}this.ChartPaint[0].Data.DataOffset=e,this.CursorIndex=0,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.BindIndexData=function(t,e,a){if(this.WindowIndex[t]){var i=this.WindowIndex[t];if("function"!=typeof i.RequestData)if("function"!=typeof i.ExecuteScript)i.BindData(this,t,e);else{if(a&&a.CheckRunCount&&i.IsExcessRunCount())return;i.ExecuteScript(this,t,e)}else i.RequestData(this,t,e,a)}},this.BindOverlayIndexData=function(t,e,a,i){if(t.Script)if("function"!=typeof t.Script.RequestData)if("function"!=typeof t.Script.ExecuteScript)t.Script.BindData(this,e,a);else{if(i){if(i.CheckRunCount&&t.Script.IsExcessRunCount())return;if(sa.IsBool(i.SyncExecute)&&t.Script.IsSync!=i.SyncExecute)return}t.Script.ExecuteScript(this,e,a)}else t.Script.RequestData(this,e,a)},this.BindInstructionIndexData=function(t){this.ColorIndex&&"function"==typeof this.ColorIndex.ExecuteScript&&this.ColorIndex.ExecuteScript(this,0,t),this.TradeIndex&&"function"==typeof this.TradeIndex.ExecuteScript&&this.TradeIndex.ExecuteScript(this,0,t)},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(0!=a){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.AutoUpdateEvent=function(t,e){var a=t?m.RECV_START_AUTOUPDATE:m.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,Right:this.Right,Period:this.Period},Explain:e};t&&(n.Callback=function(t){dt.IsDayPeriod(i.Period,!0)?i.RecvRealtimeData(t):(dt.IsMinutePeriod(i.Period,!0)||dt.IsSecondPeriod(i.Period)||dt.IsMilliSecondPeriod(i.Period))&&i.RecvMinuteRealtimeData(t)}),r.Callback(r,n,this)}},this.SendKLineUpdateEvent=function(t){var e=this.GetEventCallback(m.RECV_KLINE_UPDATE_DATA);if(e&&e.Callback){var a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return e.Callback(e,a,this),!0}return!1},this.SendManualKLineUpdateEvent=function(t){var e=this.GetEventCallback(m.RECV_KLINE_MANUAL_UPDATE_DATA);if(e&&e.Callback){var a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return e.Callback(e,a,this),!0}return!1},this.GetKLineDrawType=function(){return this.KLineDrawType},this.RequestHistoryData=function(){var t=this;if(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.FlowCapitalReady=!1,this.ResetPage(),this.ResetDragDownload(),this.ResetZoomDownload(),this.Draw(),this.NetworkFilter){var e=this.GetKLineDrawType(),a={Name:"KLineChartContainer::RequestHistoryData",Explain:"日K数据",Request:{Url:t.KLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestDataCount,field:["name","symbol","yclose","open","price","high","low","vol"],period:this.Period,right:this.Right,klineDrawType:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e);var a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::RequestHistoryData"),t.AutoUpdate())})),1==a.PreventDefault)return}io.HttpRequest({url:this.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e);var a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::RequestHistoryData"),t.AutoUpdate())}})},this.BindAllOverlayIndexData=function(t,e){if(this.Frame&&this.Frame.SubFrame)for(var a=0;a<this.Frame.SubFrame.length;++a)for(var i=this.Frame.SubFrame[a],r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];this.BindOverlayIndexData(n,a,t,e)}},this.RecvHistoryData=function(t){if(this.EnableVerifyRecvData&&t.symbol!=this.Symbol)u.Chart.Warn("[KLineChartContainer::RecvHistoryData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var e=or.JsonDataToHistoryData(t),a=new dt;a.Data=e,a.DataType=0,a.Symbol=t.symbol,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData("RecvHistoryData");var i=new dt;if(i.Data=e,i.Right=this.Right,i.Period=this.Period,i.DataType=0,i.Symbol=t.symbol,i.Right>0&&!this.IsApiPeriod){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if(dt.IsDayPeriod(i.Period,!1)&&!this.IsApiPeriod){var n=i.GetPeriodData(i.Period);i.Data=n}var o=this.GetKLineCalulate();if(o){var s=o.RecvHistoryData(i,{Symbol:this.Symbol,Function:"RecvHistoryData"});i=s,this.FlowCapitalReady=!0}this.Symbol=t.symbol,this.Name=t.name;var h,l=null;if(t&&t.ChartOperator){var C=t.ChartOperator;l={},!0===C.IsShowAll&&(l.IsShowAll=!0)}this.BindMainData(i,this.PageSize,l),this.AfterBindMainData&&this.AfterBindMainData("RecvHistoryData"),this.Frame.SetSizeChage(!0),this.Frame.SubFrame[0]&&(h=this.Frame.SubFrame[0].Frame),h&&h.YSplitOperator&&(h.YSplitOperator.Symbol=this.Symbol,h.YSplitOperator.Data=this.ChartPaint[0].Data,h.YSplitOperator.Period=this.Period);var D=this.Page.Day;(0==D.Enable||1==D.Enable&&1==D.Finish)&&(this.ReqeustKLineInfoData({FunctionName:"RecvHistoryData"}),this.RequestFlowCapitalData(),this.RequestOverlayHistoryData(),this.CreateChartDrawPictureByStorage()),D.Enable&&(D.Index=1),this.BindInstructionIndexData(i);for(var f=0;f<this.Frame.SubFrame.length;++f)this.BindIndexData(f,i);if(this.BindAllOverlayIndexData(i,{SyncExecute:!0}),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdatePointByCursorIndex(2),this.Draw(),this.BindAllOverlayIndexData(i,{SyncExecute:!1}),this.mapEvent.has(m.RECV_HISTROY_DATA)){var c=this.mapEvent.get(m.RECV_HISTROY_DATA);t={HistoryData:i,Stock:{Symbol:this.Symbol,Name:this.Name}};c.Callback(c,t,this)}}},this.RequestHistoryPageData=function(){var t=this;if(this.NetworkFilter){var e=this.SourceData.Data[0],a={Name:"KLineChartContainer::RequestHistoryPageData",Explain:"日K数据分页",Request:{Url:"none",Type:"POST",Data:{symbol:t.Symbol,index:t.Page.Day.Index,field:["name","symbol","yclose","open","price","high","low","vol"],firstDate:e.Date,first:{date:e.Date}}},Page:t.Page.Day,Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvHistoryPageData(e);var a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():t.AutoUpdate()})),1==a.PreventDefault)return}setTimeout((function(){var e=t.Page.Day;e.Finish=!0;var a={data:[[20150218,12.54,12.5,12.74,11.95,12.27,117632441,1459671045],[20150219,12.27,12.1,12.23,11.9,12.23,95889423,1157078548],[20150220,12.23,12.17,12.17,11.9,12.05,67763439,815652761]],symbol:t.Symbol,name:t.Name};t.RecvHistoryPageData(a),1==e.Enable&&0==e.Finish?t.RequestHistoryPageData():t.AutoUpdate()}),500)},this.RecvHistoryPageData=function(t){if(this.EnableVerifyRecvData&&t.symbol!=this.Symbol)u.Chart.Warn("[KLineChartContainer::RecvHistoryPageData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var e=or.JsonDataToHistoryData(t),a=this.GetHistoryDataCount();for(var i in e){var r=e[i];this.SourceData.Data.splice(i,0,r)}var n=new dt;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Right>0&&n.Period<=3){var o=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=o}if(dt.IsDayPeriod(n.Period,!1)||dt.IsMinutePeriod(n.Period,!1)){var s=n.GetPeriodData(n.Period);n.Data=s}this.UpdateMainData(n,a),this.BindInstructionIndexData(n);for(i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);var h=this.Page.Day;++h.Index,1==h.Enable&&1==h.Finish&&(this.RequestFlowCapitalData(),this.RequestOverlayHistoryData(),this.CreateChartDrawPictureByStorage()),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestHistoryMinuteData=function(){var t=this;if(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.FlowCapitalReady=!1,this.ResetPage(),this.ResetDragDownload(),this.ResetZoomDownload(),this.Draw(),this.NetworkFilter){var e=this.GetKLineDrawType(),a={Name:"KLineChartContainer::ReqeustHistoryMinuteData",Explain:"1分钟K线数据",Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestMinuteDayCount,field:["name","symbol","yclose","open","price","high","low","vol"],period:this.Period,right:this.Right,klineDrawType:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e);var a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::ReqeustHistoryMinuteData"),t.AutoUpdate())})),1==a.PreventDefault)return}io.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e);var a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::ReqeustHistoryMinuteData"),t.AutoUpdate())}})},this.ReqeustHistoryMinuteData=this.RequestHistoryMinuteData,this.RecvMinuteHistoryData=function(t){if(this.EnableVerifyRecvData&&t.symbol!=this.Symbol)u.Chart.Warn("[KLineChartContainer::RecvMinuteHistoryData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var e=or.JsonDataToMinuteHistoryData(t),a=new dt;a.Data=e,a.DataType=1,a.Symbol=t.symbol,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData("RecvMinuteHistoryData");var i=new dt;if(i.Data=e,i.Right=this.Right,i.Period=this.Period,i.DataType=1,i.Symbol=t.symbol,i.Right>0&&!this.IsApiPeriod&&this.RightFormula>=1){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if(dt.IsMinutePeriod(i.Period,!1)&&!this.IsApiPeriod){var n=i.GetPeriodData(i.Period);i.Data=n}var o=this.GetKLineCalulate();if(o){var s=o.RecvHistoryData(i,{Symbol:this.Symbol,Function:"RecvMinuteHistoryData"});i=s,this.FlowCapitalReady=!0}this.Symbol=t.symbol,this.Name=t.name;var h,l=null;if(t&&t.ChartOperator){var C=t.ChartOperator;l={},!0===C.IsShowAll&&(l.IsShowAll=!0)}for(var D in this.BindMainData(i,this.PageSize,l),this.BindKLineBreakPoint(t),this.AfterBindMainData&&this.AfterBindMainData("RecvMinuteHistoryData"),this.Frame.SetSizeChage(!0),this.Frame.SubFrame[0]&&(h=this.Frame.SubFrame[0].Frame),h&&h.YSplitOperator&&(h.YSplitOperator.Symbol=this.Symbol,h.YSplitOperator.Data=this.ChartPaint[0].Data,h.YSplitOperator.Period=this.Period),this.OverlayChartPaint){C=this.OverlayChartPaint[D];C.Data=null}var f=this.Page.Minute;(0==f.Enable||1==f.Enable&&1==f.Finish)&&(this.ReqeustKLineInfoData({FunctionName:"RecvMinuteHistoryData"}),this.RequestFlowCapitalData(),this.RequestOverlayHistoryMinuteData(),this.CreateChartDrawPictureByStorage()),f.Enable&&++f.Index,this.BindInstructionIndexData(i);for(D=0;D<this.Frame.SubFrame.length;++D)this.BindIndexData(D,i);if(this.BindAllOverlayIndexData(i,{SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(2),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindAllOverlayIndexData(i,{SyncExecute:!1}),this.mapEvent.has(m.RECV_HISTROY_DATA)){var c=this.mapEvent.get(m.RECV_HISTROY_DATA);t={HistoryData:i,Stock:{Symbol:this.Symbol,Name:this.Name}};c.Callback(c,t,this)}}},this.ReqeustHistoryMinutePageData=function(){var t=this;if(this.NetworkFilter){var e=this.SourceData.Data[0],a={Name:"KLineChartContainer::RecvHistoryMinutePageData",Explain:"1分钟K线数据分页",Request:{Url:"none",Type:"POST",Data:{symbol:t.Symbol,index:t.Page.Minute.Index,field:["name","symbol","yclose","open","price","high","low","vol"],firstDate:e.Date,first:{date:e.Date,time:e.Time}}},Page:t.Page.Minute,Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvHistoryMinutePageData(e);var a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():t.AutoUpdate()})),1==a.PreventDefault)return}setTimeout((function(){var e=t.Page.Minute;e.Finish=!0;t.RecvHistoryMinutePageData({data:[[20190906,14.58,14.71,14.71,14.71,14.71,1096425,16128411,925],[20190906,14.71,14.73,14.74,14.71,14.71,2154859,31731820,930],[20190906,14.71,14.71,14.71,14.68,14.69,1427516,20989208,931],[20190906,14.69,14.69,14.71,14.68,14.7,1680503,24694143,932],[20190906,14.7,14.69,14.7,14.65,14.65,1315900,19310964,933],[20190906,14.65,14.66,14.69,14.65,14.68,702955,10313842,934],[20190906,14.68,14.7,14.71,14.67,14.67,1735266,25495875,935],[20190906,14.67,14.68,14.7,14.67,14.67,739e3,10845398,936],[20190906,14.67,14.67,14.68,14.67,14.68,389800,5721266,937],[20190906,14.68,14.68,14.7,14.68,14.69,648477,9527859,938],[20190906,14.69,14.7,14.71,14.69,14.7,1128400,16589794,939],[20190906,14.7,14.7,14.71,14.69,14.71,714858,10509708,940],[20190906,14.71,14.71,14.71,14.69,14.69,401500,5900477,941],[20190906,14.69,14.69,14.71,14.69,14.69,1165684,17131034,942],[20190906,14.69,14.69,14.7,14.67,14.67,498516,7321024,943],[20190906,14.67,14.68,14.68,14.67,14.67,350126,5139012,944],[20190906,14.67,14.67,14.69,14.67,14.69,561600,8246789,945]]}),1==e.Enable&&0==e.Finish?t.ReqeustHistoryMinutePageData():t.AutoUpdate()}),500)},this.RecvHistoryMinutePageData=function(t){if(this.EnableVerifyRecvData&&t.symbol!=this.Symbol)u.Chart.Warn("[KLineChartContainer::RecvHistoryMinutePageData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var e=or.JsonDataToMinuteHistoryData(t),a=this.GetHistoryDataCount();for(var i in e){var r=e[i];this.SourceData.Data.splice(i,0,r)}var n=new dt;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Right>0&&dt.IsDayPeriod(n.Period,!1)){var o=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=o}if(dt.IsDayPeriod(n.Period,!1)||dt.IsMinutePeriod(n.Period,!1)){var s=n.GetPeriodData(n.Period);n.Data=s}this.UpdateMainData(n,a),this.BindInstructionIndexData(n);for(i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);var h=this.Page.Minute;(0==h.Enable||1==h.Enable&&1==h.Finish)&&(this.RequestFlowCapitalData(),this.CreateChartDrawPictureByStorage()),h.Enable&&++h.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestRealtimeData=function(){var t=this,e=[t.Symbol];for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];i.Symbol&&(i.MainData&&i.Status==Rt.STATUS_FINISHED_ID&&e.push(i.Symbol))}if(this.NetworkFilter){var r=this.GetKLineDrawType(),n=null,o=this.ChartOperator_Temp_GetHistoryData();o&&(n=o.GetDateRange());var s={Name:"KLineChartContainer::RequestRealtimeData",Explain:"当天最新日线数据",Request:{Url:t.RealtimeApiUrl,Data:{symbol:e,field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],period:this.Period,right:this.Right,klineDrawType:r,dateRange:n},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){t.RecvRealtimeData(e),t.AutoUpdate()})),1==s.PreventDefault)return}io.HttpRequest({url:this.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],symbol:e,start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.RecvRealtimeData(e),t.AutoUpdate()}})},this.RecvRealtimeDataV2=function(t){var e=or.JsonDataToRealtimeDataV2(t,this.Symbol);if(sa.IsNonEmptyArray(e)){var a=this.GetHistoryDataCount();this.SourceData.Data.length;if(this.SourceData.MergeMinuteData(e,this.Period)){var i=new dt;if(i.Data=this.SourceData.Data,i.Period=this.Period,i.Right=this.Right,i.DataType=this.SourceData.DataType,i.Symbol=this.Symbol,i.Right>0&&Pr.IsEnableRight(i.Period,this.Symbol,this.RightFormula)&&!this.IsApiPeriod&&dt.IsDayPeriod(i.Period,!0)){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if(!this.IsApiPeriod&&(dt.IsDayPeriod(i.Period,!1)||dt.IsMinutePeriod(i.Period,!1))){var n=i.GetPeriodData(i.Period);i.Data=n}var o=this.GetKLineCalulate();if(o){var s=o.RecvHistoryData(i,{Symbol:this.Symbol,Function:"RecvRealtimeData"});i=s,this.FlowCapitalReady=!0}this.UpdateMainData(i,a),this.UpdateOverlayRealtimeDataV2(t),this.BindInstructionIndexData(i);for(var h=0;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,i,{CheckRunCount:!0});if(this.BindAllOverlayIndexData(i,{CheckRunCount:!0,SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(i),this.UpdateDOMTooltip(0,i),this.UpdateHQFloatTooltip(i),this.BindAllOverlayIndexData(i,{CheckRunCount:!0,SyncExecute:!1}),this.mapEvent.has(m.ON_RECV_REALTIME_DATA)){var l=this.mapEvent.get(m.ON_RECV_REALTIME_DATA);t={HistoryData:i,Stock:{Symbol:this.Symbol,Name:this.Name}};l.Callback(l,t,this)}}}},this.RecvRealtimeData=function(t){if(1!=this.IsOnTouch)if(3!=t.Ver){var e=or.JsonDataToRealtimeData(t,this.Symbol);if(e){var a=this.SourceData.Data[this.SourceData.Data.length-1],i=this.GetHistoryDataCount();if(0==this.SourceData.Data.length){var r=new ht;ht.CopyTo(r,e),this.SourceData.Data.push(r)}else if(a.Date==e.Date)u.Chart.Log("[KLineChartContainer::RecvRealtimeData] update kline by realtime data",e),ht.CopyTo(a,e);else if(a.Date<e.Date){u.Chart.Log("[KLineChartContainer::RecvRealtimeData] insert kline by realtime data",e);r=new ht;ht.CopyTo(r,e),!sa.IsNumber(r.YClose)&&this.SourceData.Data.length>0&&(r.YClose=this.SourceData.Data[this.SourceData.Data.length-1].YClose),this.SourceData.Data.push(r)}else{for(var n=!1,o=this.SourceData.Data,s=o.length-1;s>=0;--s){var h=o[s];if(h.Date==e.Date){ht.CopyTo(h,e),n=!0;break}}if(!n)return}var l=new dt;if(l.Data=this.SourceData.Data,l.Period=this.Period,l.Right=this.Right,l.DataType=this.SourceData.DataType,l.Symbol=this.Symbol,l.Right>0&&dt.IsDayPeriod(l.Period,!0)&&Pr.IsSHSZStockA(this.Symbol)&&!this.IsApiPeriod){var C=l.GetRightData(l.Right,{AlgorithmType:this.RightFormula});l.Data=C}if(!this.IsApiPeriod&&(dt.IsDayPeriod(l.Period,!1)||dt.IsMinutePeriod(l.Period,!1))){var D=l.GetPeriodData(l.Period);l.Data=D}var f=this.GetKLineCalulate();if(f){var c=f.RecvHistoryData(l,{Symbol:this.Symbol,Function:"RecvRealtimeData"});l=c,this.FlowCapitalReady=!0}this.UpdateMainData(l,i),this.UpdateOverlayRealtimeData(t),this.BindInstructionIndexData(l);for(s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,l,{CheckRunCount:!0});if(this.BindAllOverlayIndexData(l,{CheckRunCount:!0,SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(l),this.UpdateDOMTooltip(0,l),this.UpdateHQFloatTooltip(l),this.BindAllOverlayIndexData(l,{CheckRunCount:!0,SyncExecute:!1}),this.mapEvent.has(m.ON_RECV_REALTIME_DATA)){var d=this.mapEvent.get(m.ON_RECV_REALTIME_DATA);t={HistoryData:l,Stock:{Symbol:this.Symbol,Name:this.Name}};d.Callback(d,t,this)}}}else this.RecvRealtimeDataV2(t)},this.UpdateOverlayRealtimeData=function(t){if(sa.IsNonEmptyArray(this.OverlayChartPaint))for(var e=0;e<this.OverlayChartPaint.length;++e){var a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==Rt.STATUS_FINISHED_ID)){var i=or.JsonDataToRealtimeData(t,a.Symbol);if(i){var r=a.SourceData,n=r.Data[r.Data.length-1];if(n.Date==i.Date)u.Chart.Log("[KLineChartContainer::UpdateOverlayRealtimeData] update kline by minute data",i),n.Close=i.Close,n.High=i.High,n.Low=i.Low,n.Vol=i.Vol,n.Amount=i.Amount;else{if(!(n.Date<i.Date))continue;u.Chart.Log("[KLineChartContainer::UpdateOverlayRealtimeData] insert kline by minute data",i);var o=new ht;o.YClose=i.YClose,o.Open=i.Open,o.Close=i.Close,o.High=i.High,o.Low=i.Low,o.Vol=i.Vol,o.Amount=i.Amount,o.Date=i.Date,r.Data.push(o)}var s=new dt;if(s.Data=r.Data,s.Period=this.Period,s.Right=this.Right,s.DataType=0,s.Right>0&&Pr.IsSHSZStockA(t.symbol)&&!this.IsApiPeriod){var h=s.GetRightData(s.Right,{AlgorithmType:this.RightFormula});s.Data=h}var l=this.SourceData.GetOverlayData(s.Data,this.IsApiPeriod);if(s.Data=l,dt.IsDayPeriod(s.Period,!1)&&!this.IsApiPeriod){var C=s.GetPeriodData(s.Period);s.Data=C}a.Data=s}}}},this.UpdateOverlayRealtimeDataV2=function(t){if(sa.IsNonEmptyArray(this.OverlayChartPaint))for(var e=0;e<this.OverlayChartPaint.length;++e){var a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==Rt.STATUS_FINISHED_ID)){var i=or.JsonDataToRealtimeDataV2(t,a.Symbol);if(i){var r=a.SourceData;r.MergeMinuteData(i,this.Period);var n=new dt;if(n.Data=r.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=0,n.Right>0&&Pr.IsEnableRight(n.Right,t.Symbol)&&!this.IsApiPeriod){var o=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=o}var s=this.SourceData.GetOverlayData(n.Data,this.IsApiPeriod);if(n.Data=s,dt.IsDayPeriod(n.Period,!1)&&!this.IsApiPeriod){var h=n.GetPeriodData(n.Period);n.Data=h}a.Data=n}}}},this.RequestMinuteRealtimeData=function(){var t=this,e=[t.Symbol];for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];i.Symbol&&(i.MainData&&i.Status==Rt.STATUS_FINISHED_ID&&e.push(i.Symbol))}if(this.NetworkFilter){var r=this.GetKLineDrawType(),n=null,o=this.ChartOperator_Temp_GetHistoryData();o&&(n=o.GetDateRange());var s={Name:"KLineChartContainer::RequestMinuteRealtimeData",Explain:"当天1分钟K线数据",Request:{Url:t.RealtimeApiUrl,Data:{symbol:e,field:["name","symbol","price","yclose","minutecount","minute","date","time"],period:this.Period,right:this.Right,klineDrawType:r,dateRange:n},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()})),1==s.PreventDefault)return}io.HttpRequest({url:this.RealtimeApiUrl,data:{field:["name","symbol","price","yclose","minutecount","minute","date","time"],symbol:e,start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()}})},this.SetSourceDatatLimit=function(t){for(var e in this.SourceDataLimit=new Map,t){var a=t[e];this.SourceDataLimit.set(a.Period,a.MaxCount),u.Chart.Log("[KLineChartContainer::SetSourceDatatLimit] Period=".concat(a.Period,", MaxCount=").concat(a.MaxCount))}},this.ReduceSourceData=function(){if(this.SourceDataLimit&&this.SourceDataLimit.has(this.Period)){var t=this.SourceDataLimit.get(this.Period),e=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(e=this.Frame.SubFrame[0].Frame.Data):e=this.Frame.Data,e&&!(t<50)){var a=e.DataOffset,i=0;while(this.SourceData.Data.length>t)this.SourceData.Data.shift(),--a,++i;i>0&&(a<0&&(a=0),e.DataOffset=a,u.Chart.Log("[KLineChartContainer::ReduceSourceData] remove data ".concat(i,", dataOffset=").concat(a)))}}},this.RecvMinuteRealtimeDataV2=function(t){if(1!=this.IsOnTouch)if(this.EnableVerifyRecvData&&t.symbol!=this.Symbol)u.Chart.Warn("[KLineChartContainer::RecvMinuteRealtimeDataV2] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var e=or.JsonDataToMinuteHistoryData(t);if(e&&!(e.length<=0)){this.IsApiPeriod&&this.ReduceSourceData();var a=this.GetHistoryDataCount();if(this.SourceData&&this.SourceData.MergeMinuteData(e,this.Period)){u.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeDataV2] update kline by 1 minute data [".concat(a,"->").concat(this.SourceData.Data.length,"], IsAutoSyncDataOffset=").concat(this.IsAutoSyncDataOffset)),!1===this.IsAutoSyncDataOffset&&(a=null);var i=new dt;if(i.Data=this.SourceData.Data,i.Period=this.Period,i.Right=this.Right,i.DataType=this.SourceData.DataType,i.Symbol=this.Symbol,i.Right>0&&!this.IsApiPeriod&&this.RightFormula>=1){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if((dt.IsDayPeriod(i.Period,!1)||dt.IsMinutePeriod(i.Period,!1))&&!this.IsApiPeriod){var n=i.GetPeriodData(i.Period);i.Data=n}var o=this.GetKLineCalulate();if(o){var s=o.RecvHistoryData(i,{Symbol:this.Symbol,Function:"RecvMinuteRealtimeDataV2"});i=s,this.FlowCapitalReady=!0}this.UpdateMainData(i,a),this.UpdateOverlayMinuteRealtimeData(t),this.BindInstructionIndexData(i);for(var h=0;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,i);if(this.BindAllOverlayIndexData(i,{CheckRunCount:!0,SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(i),this.UpdateDOMTooltip(0,i),this.UpdateHQFloatTooltip(i),this.BindAllOverlayIndexData(i,{CheckRunCount:!0,SyncExecute:!1}),this.mapEvent.has(m.ON_RECV_REALTIME_DATA)){var l=this.mapEvent.get(m.ON_RECV_REALTIME_DATA);t={HistoryData:i,Stock:{Symbol:this.Symbol,Name:this.Name}};l.Callback(l,t,this)}}}}},this.RecvMinuteRealtimeData=function(t){if(1!=this.IsOnTouch)if(2!=t.ver){var e=or.JsonDataToMinuteRealtimeData(t,this.Symbol);if(e){this.IsApiPeriod&&this.ReduceSourceData();var a=this.GetHistoryDataCount(),i=this.SourceData.Data.length;if(this.SourceData.MergeMinuteData(e,this.Period)){u.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeData] update kline by 1 minute data [".concat(i,"->").concat(this.SourceData.Data.length,"]"));var r=new dt;if(r.Data=this.SourceData.Data,r.Period=this.Period,r.Right=this.Right,r.DataType=this.SourceData.DataType,r.Symbol=this.Symbol,r.Right>0&&!this.IsApiPeriod&&this.RightFormula>=1){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}if((dt.IsDayPeriod(r.Period,!1)||dt.IsMinutePeriod(r.Period,!1))&&!this.IsApiPeriod){var o=r.GetPeriodData(r.Period);r.Data=o}var s=this.GetKLineCalulate();if(s){var h=s.RecvHistoryData(r,{Symbol:this.Symbol,Function:"RecvMinuteRealtimeData"});r=h,this.FlowCapitalReady=!0}this.UpdateMainData(r,a),this.UpdateOverlayMinuteRealtimeData(t),this.BindInstructionIndexData(r);for(var l=0;l<this.Frame.SubFrame.length;++l)this.BindIndexData(l,r);this.BindAllOverlayIndexData(r,{CheckRunCount:!0,SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(r),this.BindAllOverlayIndexData(r,{CheckRunCount:!0,SyncExecute:!1})}}}else this.RecvMinuteRealtimeDataV2(t)},this.UpdateOverlayMinuteRealtimeData=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==Rt.STATUS_FINISHED_ID)){if(2==t.ver)var i=or.JsonDataToMinuteRealtimeDataV2(t,a.Symbol);else i=or.JsonDataToMinuteRealtimeData(t,a.Symbol);if(i){var r=a.SourceData;if(!r.MergeMinuteData(i,this.Period))return;var n=new dt;n.Data=r.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=0;var o=this.SourceData.GetOverlayMinuteData(n.Data,this.IsApiPeriod);if(n.Data=o,dt.IsMinutePeriod(n.Period,!1)&&!this.IsApiPeriod){var s=n.GetPeriodData(n.Period);n.Data=s}a.Data=n}}}},this.GetHistoryDataCount=function(){var t=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(t=this.Frame.SubFrame[0].Frame.Data):t=this.Frame.Data,!t)return-1;var e=t.Data.length;return e},this.GetRequestDataCount=function(){var t={MaxRequestDataCount:this.MaxRequestDataCount,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount};if(!this.SourceData||!this.SourceData.Data||this.SourceData.Data.length<=0)return t;if(dt.IsDayPeriod(this.Period,!0)){var e=this.SourceData.Data.length;e>t.MaxRequestDataCount&&(t.MaxRequestDataCount=e)}else if(dt.IsMinutePeriod(this.Period,!0)){var a;e=0;for(var i in this.SourceData.Data){var r=this.SourceData.Data[i];r.Date!=a&&++e,a=r.Date}e>t.MaxRequestMinuteDayCount&&(t.MaxRequestMinuteDayCount=e)}return t},this.RequestTickData=function(){var t=this;this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),t.ChartSplashPaint.EnableSplash(!0),t.Draw();var e=qi.CacheDomain+"/cache/dealday/today/"+t.Symbol+".json";if(this.NetworkFilter){var a={Name:"KLineChartContainer::RequestTickData",Explain:"当天分笔数据",Request:{Url:e,Data:{symbol:t.Symbol},Type:"GET"},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate()})),1==a.PreventDefault)return}io.HttpRequest({url:e,data:{symbol:t.Symbol},type:"get",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate(1)},error:function(e,a){t.ChartSplashPaint.EnableSplash(!1),t.AutoUpdate()}})},this.RecvTickData=function(t){if(2==t.ver)var e=or.JsonDataToTickDataV2(t);else e=or.JsonDataToTickData(t);var a=new dt;a.Data=e,a.DataType=2,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData("RecvTickData");var i,r=new dt;r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=2,this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvTickData"),this.BindInstructionIndexData(r);for(var n=0;n<this.Frame.SubFrame.length;++n)0==n&&(i=this.Frame.SubFrame[n].Frame),this.BindIndexData(n,r);if(i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period,i.YSplitOperator.KLineChart=this.ChartPaint[0]),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex(),this.BindAllOverlayIndexData(r),this.mapEvent.has(m.RECV_HISTROY_DATA)){var o=this.mapEvent.get(m.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};o.Callback(o,t,this)}},this.RequestTickRealtimeData=function(){var t=this,e=0;if(this.SourceData&&this.SourceData.Data&&(e=this.SourceData.Data.length),this.NetworkFilter){var a={Name:"KLineChartContainer::RequestTickRealtimeData",Explain:"当天最新分笔数据",Request:{Url:t.TickApiUrl,Data:{symbol:t.Symbol,start:e,end:e+1e3},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickRealtimeData(e),t.AutoUpdate()})),1==a.PreventDefault)return}io.HttpRequest({url:t.TickApiUrl,data:{symbol:t.Symbol,start:e-10,end:e+1e3},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickRealtimeData(e),t.AutoUpdate()}})},this.RecvTickRealtimeData=function(t){if(2==t.ver)var e=or.JsonDataToTickDataV2(t);else e=or.JsonDataToTickData(t);if(e&&!(e.length<=0)){var a=!1;1==t.redraw&&(a=!0);var i=this.SourceData.Data,r=this.SourceData.Data.length,n=0;i.length>0&&(n=i[i.length-1].Time);var o=0;for(var s in e){var h=e[s];h.Time<=n||(i.push(h),++o)}if(!(o<=0&&0==a)){var l=new dt;l.Data=i,l.Right=this.Right,l.Period=this.Period,l.DataType=2,this.Symbol=t.symbol,this.Name=t.name,this.UpdateMainData(l,r),this.BindInstructionIndexData(l);for(s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,l);this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex(),this.BindAllOverlayIndexData(l)}}},this.ClearIndexPaint=function(){if(this.Frame&&this.Frame.SubFrame)for(var t=0;t<this.Frame.SubFrame.length;++t){this.DeleteIndexPaint(t,!0);var e=this.Frame.SubFrame[t];if(sa.IsNonEmptyArray(e.OverlayIndex))for(var a=0;a<e.OverlayIndex.length;++a){for(var i=e.OverlayIndex[a],r=0;r<i.ChartPaint.length;++r){var n=i.ChartPaint[r];n&&n.OnDestroy&&n.OnDestroy()}i.ChartPaint=[]}}for(t=1;t<this.TitlePaint.length;++t){e=this.TitlePaint[t];e.OverlayIndex=new Map}},this.ChangePeriod=function(t,e){var a={Period:this.Period,Right:this.Right,KLineDrawType:this.KLineDrawType,Symbol:this.Symbol},i=!1,r=!1,n=null;if(e){if(e.KLine){var o=e.KLine;sa.IsNumber(o.DrawType)&&(i=!0),sa.IsNumber(o.Right)&&(n=o.Right),sa.IsNumber(o.DataWidth)&&(this.KLineSize={DataWidth:o.DataWidth})}1==e.Reload&&(r=!0)}if(this.Period!=t||0!=r){i&&this.ChangeKLineDrawType(e.KLine.DrawType,!1);var s=!0;if(this.SourceData){s=!1;if(t>It&&t<=St)0!=this.SourceData.DataType&&(s=!0);else if(t>Tt&&t<=vt||t>3e4&&t<=32e3||t>5e4&&t<=6e4)(1!=this.SourceData.DataType||dt.IsSecondPeriod(t)||dt.IsMilliSecondPeriod(t))&&(s=!0);else switch(t){case 0:case 1:case 2:case 3:case 9:case 21:0!=this.SourceData.DataType&&(s=!0);break;case 4:case 5:case 6:case 7:case 8:case 11:case 12:1!=this.SourceData.DataType&&(s=!0);break;case 10:2!=this.SourceData.DataType&&(s=!0);break}}this.Period=t,null!=n&&(this.Right=n),this.ReloadChartDrawPicture(),this.ClearRectSelect(!0),this.Frame.ClearUpDonwFrameYData(),this.ClearCustomKLine(),this.ClearKLineCaluate(),this.UnlockCorssCursor();var h=this.GetKLineDrawType();10!=h&&11!=h&&12!=h&&16!=h||(s=!0);var l=this.GetEventCallback(m.ON_CHANGE_KLINE_PERIOD);if(l&&l.Callback){var u={IsApiPeriod:this.IsApiPeriod,Old:a,Now:{Period:this.Period,Right:this.Right,KLineDrawType:this.KLineDrawType,Symbol:this.Symbol},IsDataTypeChange:s};l.Callback(l,u,this),s=u.IsDataTypeChange}if(0==s&&!this.IsApiPeriod)return this.ClearIndexRunCount(),void this.Update({UpdateCursorIndexType:2});this.ClearIndexPaint(),this.ClearKLineBreakPoint(),dt.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.ResetScrollBar(),this.ResetOverlaySymbolStatus(),this.ClearIndexRunCount(),this.Frame.ClearYCoordinateMaxMin(),this.UnlockCorssCursor(),this.RequestHistoryData()):dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)||dt.IsMilliSecondPeriod(this.Period)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.ResetScrollBar(),this.ResetOverlaySymbolStatus(),this.ClearIndexRunCount(),this.Frame.ClearYCoordinateMaxMin(),this.UnlockCorssCursor(),this.RequestHistoryMinuteData()):dt.IsTickPeriod(this.Period)&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.ResetScrollBar(),this.ClearIndexRunCount(),this.Frame.ClearYCoordinateMaxMin(),this.UnlockCorssCursor(),this.RequestTickData())}else i&&this.ChangeKLineDrawType(e.KLine.DrawType)},this.ChangeRight=function(t){if(Pr.IsEnableRight(this.Period,this.Symbol,this.RightFormula)){var e=this.Symbol.toUpperCase();if(!Pr.IsBIT(e)&&!(t<0||t>2)&&this.Right!=t){var a={Period:this.Period,Right:this.Right,KLineDrawType:this.KLineDrawType,Symbol:this.Symbol};this.Right=t;var i=this.GetEventCallback(m.ON_CHANGE_KLINE_RIGHT);if(i&&i.Callback){var r={IsApiPeriod:this.IsApiPeriod,Old:a,Now:{Period:this.Period,Right:this.Right,KLineDrawType:this.KLineDrawType,Symbol:this.Symbol}};i.Callback(i,r,this)}this.IsApiPeriod?dt.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeRight"),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.ResetScrollBar(),this.Frame.ClearYCoordinateMaxMin(),this.UnlockCorssCursor(),this.RequestHistoryData()):(dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)||dt.IsMilliSecondPeriod(this.Period))&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeRight"),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.ResetScrollBar(),this.Frame.ClearYCoordinateMaxMin(),this.UnlockCorssCursor(),this.RequestHistoryMinuteData()):this.Update()}}},this.SetFirstShowDate=function(t){if(t&&t.Date){var e={ID:d.OP_GOTO,Date:t.Date,Position:0};sa.IsNumber(t.Time)&&(e.Time=t.Time),sa.IsNumber(t.PageSize)&&(e.PageSize=t.PageSize),sa.IsNumber(t.Position)&&(e.Position=t.Position),this.ChartOperator(e)}},this.DeleteIndexPaint=function(t,e){if(this.Frame.SubFrame[t]){var a=this.Frame.SubFrame[t].Frame;if(a){for(var i=[],r=0;r<this.ChartPaint.length;++r){var n=this.ChartPaint[r],o=n.ChartFrame.Guid==a.Guid||n.ChartFrame==a;0!=r&&o?!0===e&&n&&n.OnDestroy&&n.OnDestroy():i.push(n)}a.YSpecificMaxMin=null,a.IsLocked=!1,a.YSplitScale=null,a.YSplitOperator.SplitType=a.YSplitOperator.DefaultSplitType,this.ChartPaint=i;var s=t+1;this.TitlePaint[s].Data=[],this.TitlePaint[s].Title=null}}},this.ShowKLine=function(t){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ChartPaint[0].IsShow=t)},this.SetInstructionData=function(t,e){if(!(this.ChartPaint.length<=0)&&this.ChartPaint[0]){var a=this.TitlePaint[1];2==t?(this.ChartPaint[0].ColorData=e.Data,a&&(a.ColorIndex={Name:e.Name,Param:e.Param})):1==t&&(this.ChartPaint[0].TradeData={Sell:e.Sell,Buy:e.Buy,Name:e.Name,Param:e.Param},a&&(a.TradeIndex={Name:e.Name,Param:e.Param}))}},this.ChangeInstructionIndex=function(t,e){var a=new f,i=a.Get(t);i&&(1!=i.InstructionType&&2!=i.InstructionType||(e&&e.Args&&(i.Args=e.Args),i.ID=t,this.ChangeInstructionScriptIndex(i)))},this.ChangeInstructionScriptIndex=function(t){if(1==t.InstructionType)this.TradeIndex=new pn(t.Name,t.Script,t.Args,t);else{if(2!=t.InstructionType)return;this.ColorIndex=new pn(t.Name,t.Script,t.Args,t)}var e=this.ChartPaint[0].Data;this.BindInstructionIndexData(e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.CancelInstructionIndex=function(){if(!(this.ChartPaint.length<=0)&&this.ChartPaint[0]){this.ColorIndex=null,this.TradeIndex=null,this.ChartPaint[0].ColorData=null,this.ChartPaint[0].TradeData=null;var t=this.TitlePaint[1];t&&(t.TradeIndex=null,t.ColorIndex=null),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.SetFrameToolbar=function(t,e){if(e&&this.Frame.SubFrame[t]&&this.Frame.SubFrame[t].Frame){var a=this.Frame.SubFrame[t].Frame,i=!1;sa.IsBool(e.Modify)&&(a.ModifyIndex=e.Modify,i=!0),sa.IsBool(e.Change)&&(a.ChangeIndex=e.Change,i=!0),sa.IsBool(e.Close)&&(a.CloseIndex=e.Close,i=!0),sa.IsBool(e.Overlay)&&(a.OverlayIndex=e.Overlay,i=!0),i&&(a.SizeChange=!0,a.ToolbarRect=null,a.DrawToolbar())}},this.SetFrameAttribute=function(t,e){if(window&&this.Frame.SubFrame[t]&&this.Frame.SubFrame[t].Frame&&e){var a=this.Frame.SubFrame[t].Frame;sa.IsUndefined(e.HorizontalReserved)||(a.HorizontalReserved=e.HorizontalReserved),sa.IsNumber(e.TitleHeight)&&(a.ChartBorder.TitleHeight=e.TitleHeight)}},this.ResetFrameAttribute=function(t){if(window&&this.Frame.SubFrame[t]&&this.Frame.SubFrame[t].Frame){var e=this.Frame.SubFrame[t].Frame;e.HorizontalReserved=null}},this.ChangeScriptIndex=function(t,e,a){this.DeleteIndexPaint(t,!0),this.WindowIndex[t]=new pn(e.Name,e.Script,e.Args,e),this.ResetFrameAttribute(t),this.Frame.ClearYCoordinateMaxMin(t),a&&a.Window&&(this.SetFrameToolbar(t,a.Window),this.SetFrameAttribute(t,a.Window)),this.OnChangeIndexEvent(t,{ID:e.ID,Name:e.Name,FunctionName:"ChangeScriptIndex"}),this.Frame.ClearUpDonwFrameYData({Index:t});var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.OnKLinePageChange=function(t){if(this.ChartPaint[0]){for(var e=this.ChartPaint[0].Data,a=0;a<this.WindowIndex.length;++a){var i=this.WindowIndex[a];i&&(!0===i.IsUsePageData&&this.BindIndexData(a,e,{Type:1}))}for(a=0;a<this.Frame.SubFrame.length;++a){i=this.Frame.SubFrame[a];for(var r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];n&&n.Script&&1==n.Script.IsUsePageData&&this.BindOverlayIndexData(n,a,e)}}}},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t,!0);var a=e.API;this.WindowIndex[t]=new xn(a.Name,a.Script,a.Args,e),this.ResetFrameAttribute(t),this.Frame.ClearYCoordinateMaxMin(t),this.OnChangeIndexEvent(t,{ID:e.ID,Name:e.Name,FunctionName:"ChangeAPIIndex"}),e&&e.Window&&(this.SetFrameToolbar(t,e.Window),this.SetFrameAttribute(t,e.Window)),this.Frame.ClearUpDonwFrameYData({Index:t});var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.OnChangeIndexEvent=function(t,e){var a=this.GetEventCallback(m.ON_CHANGE_INDEX);if(a&&a.Callback){var i={IndexInfo:e,WindowIndex:t};a.Callback(a,i,this)}},this.ChangeIndex=function(t,e,a){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=tr.Get(e);if(!i){var r=new f,n=r.Get(e);if(!n)return;return n.IsMainIndex?t=0:0==t&&(t=1),f.ModifyAttribute(n,a),this.ChangeScriptIndex(t,n,a)}i.IsMainIndex?t>0&&(t=0):0==t&&(t=1);var o=new Array;for(var s in this.ChartPaint){var h=this.ChartPaint[s];0!=s&&h.ChartFrame==this.Frame.SubFrame[t].Frame||o.push(h)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=o;var l=t+1;this.TitlePaint[l].Data=[],this.TitlePaint[l].Title=null,this.WindowIndex[t]=i.Create(a),this.CreateWindowIndex(t);var u=this.ChartPaint[0].Data;this.BindIndexData(t,u),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangePyScriptIndex=function(t,e){this.DeleteIndexPaint(t),this.WindowIndex[t]=new Tr(e.Name,e.Script,e.Args,e);var a=this.ChartPaint[0].Data;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.AddOverlayIndex=function(t){var e=this.CreateOverlayWindowsIndex(t);if(e){var a=this.ChartPaint[0].Data;this.BindOverlayIndexData(e,t.WindowIndex,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateOverlayWindowsIndex=function(t){var e=this,a=t.IndexName,i=t.WindowIndex,r=null,n=null,o=null;if(t.API)r=t.API;else if(t.Script)n={Script:t.Script,ID:t.indexName,Name:t.indexName},t.Name&&(n.Name=t.Name);else{var s=new f;if(n=s.Get(a),!n&&(o=tr.Get(a),!o))return console.warn("[KLineChartContainer::CreateOverlayIndex] can not find index[".concat(a,"]")),null}var h=this.Frame.SubFrame[i],l=new rt;t.Identify&&(l.Identify=t.Identify);var u=this.CreateOverlayFrame();if(u.Canvas=this.Canvas,u.MainFrame=h.Frame,u.ChartBorder=h.Frame.ChartBorder,u.GlobalOption=this.GlobalOption,u.GetEventCallback=function(t){return e.GetEventCallback(t)},!0===t.ShowRightText?u.IsShow=!0:!1===t.ShowRightText&&(u.IsShow=!1),sa.IsBool(t.ShowToolbar)&&(u.IsShowToolbar=t.ShowToolbar),sa.IsBool(t.IsShareY)&&(u.IsShareY=t.IsShareY),sa.IsNumber(t.IsShowMainFrame)&&(u.IsShowMainFrame=t.IsShowMainFrame),sa.IsBool(t.IsCalculateYMaxMin)&&(u.IsCalculateYMaxMin=t.IsCalculateYMaxMin),u.YSplitOperator=new la,u.YSplitOperator.LanguageID=this.LanguageID,u.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),u.YSplitOperator.Frame=u,u.YSplitOperator.ChartBorder=u.ChartBorder,u.YSplitOperator.SplitCount=h.Frame.YSplitOperator.SplitCount,u.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},u.YSplitOperator.GetKLineChartCallback=function(){return e.GetKLineChart()},u.YSplitOperator.OverlayIndex=l,u.YSplitOperator.HQChart=this,u.YSplitOperator.OverlayIdentify=l.Identify,t.Frame){var C=t.Frame;C.Custom&&(u.YSplitOperator.Custom=C.Custom),sa.IsBool(C.IsYDrawMainFrame)&&(u.IsYDrawMainFrame=C.IsYDrawMainFrame),sa.IsBool(C.IsShowToolbar)&&(u.IsShowToolbar=C.IsShowToolbar)}if(l.Frame=u,r){var D=new xn(r.Name,r.Script,r.Args,t,!0);D.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},l.Script=D}else if(n){f.ModifyAttribute(n,t);var c=new gn(n.Name,n.Script,n.Args,n);c.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},l.Script=c}else{c=o.Create();c.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},c.Create(this,i),l.Script=c}var d=this.GetEventCallback(m.ON_CREATE_OVERLAY_FRAME);if(d&&d.Callback){var I={OverlayFrame:l,WindowIndex:i,SubFrame:h};d.Callback(d,I,this)}return h.OverlayIndex.push(l),l},this.DeleteOverlayWindowsIndex=function(t){this.DeleteOverlayIndex(t,null)&&(this.UpdateFrameMaxMin(),this.Frame.ResetXYSplit(!0),this.Draw())},this.ChangeKLineDrawType=function(t,e,a){if(this.KLineDrawType!=t||a){var i=this.KLineDrawType;this.KLineDrawType=t;var r=new Set([5,7,8,10,11,12,17]);if(r.has(i)||r.has(t)){var n=this.ChartPaint[0];return n&&(n.DrawType=this.KLineDrawType),this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeKLineDrawType"),void(dt.IsDayPeriod(this.Period,!0)?(this.ResetOverlaySymbolStatus(),this.RequestHistoryData()):(dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)||dt.IsMilliSecondPeriod(this.Period))&&(this.ResetOverlaySymbolStatus(),this.RequestHistoryMinuteData()))}for(var o=0;o<this.ChartPaint.length;++o){var s=this.ChartPaint[o];0==o?(s.DrawType=this.KLineDrawType,a&&sa.IsBool(a.IsThinAKBar)&&(s.IsThinAKBar=a.IsThinAKBar)):"ChartVolStick"==s.ClassName&&(s.KLineDrawType=this.KLineDrawType)}for(var o in this.OverlayChartPaint){s=this.OverlayChartPaint[o];s.DrawType=this.KLineDrawType}0!=e&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.ChangeCoordinateType=function(t){if(this.Frame&&sa.IsNonEmptyArray(this.Frame.SubFrame)&&this.Frame.SubFrame[0]){var e=this.Frame.SubFrame[0].Frame;if(sa.IsNumber(t)){var a=t;if(2==a)e.CoordinateType=1;else if(1==a)e.YSplitOperator.CoordinateType=a;else if(0==a)e.CoordinateType=0,e.YSplitOperator.CoordinateType=0;else{if(3!=a)return;e.Frame.YSplitOperator.CoordinateType=2}}else t.Type>=0&&t.Type<=5&&(e.YSplitOperator.CoordinateType=t.Type),!0===t.IsReverse?e.CoordinateType=1:0==t.IsReverse&&(e.CoordinateType=0);e.YMaxMin.Max=null,e.YMaxMin.Min=null,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ChangeIndexWindowCount=function(t,e){var a=this;if(!(t<=0)&&this.Frame.SubFrame.length!=t){this.Frame.RestoreIndexWindows();var i=this.Frame.SubFrame.length;if(i>t){for(var r=this.GetEventCallback(m.ON_DELETE_FRAME),n=i-1;n>=t;--n)if(this.DeleteIndexPaint(n),this.DeleteChartPaintExtend({WindowIndex:n}),this.Frame.SubFrame[n].Frame.ClearToolbar(),r&&r.Callback){var o={SubFrame:this.Frame.SubFrame[n],WindowIndex:n};r.Callback(r,o,this)}this.Frame.SubFrame.splice(t,i-t),this.WindowIndex.splice(t,i-t),this.TitlePaint.splice(t+1,i-t);for(n=0;n<this.Frame.SubFrame.length;++n){var s=this.Frame.SubFrame[n].Frame;n==this.Frame.SubFrame.length-1?s.XSplitOperator.ShowText=!0:s.XSplitOperator.ShowText=!1}this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}else{var h=F();for(n=i;n<t;++n){var l=this.CreateSubFrameItem(n);l.Frame.ChartBorder.TitleHeight*=h,this.Frame.SubFrame[n]=l;var u=new Va;u.Frame=this.Frame.SubFrame[n].Frame,u.Canvas=this.Canvas,u.LanguageID=this.LanguageID,u.GetEventCallback=function(t){return a.GetEventCallback(t)},u.SelectedChart=this.SelectedChart,u.HQChart=this,this.TitlePaint[n+1]=u}for(n=0;n<this.Frame.SubFrame.length;++n){s=this.Frame.SubFrame[n].Frame;n==this.Frame.SubFrame.length-1?s.XSplitOperator.ShowText=!0:s.XSplitOperator.ShowText=!1}this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw();var C=[{Index:"RSI"},{Index:"MACD"},{Index:"VOL"},{Index:"UOS"},{Index:"CHO"},{Index:"BRAR"}];e&&e.Windows.length>0&&(C=e.Windows);var D=new f;for(n=i;n<t;++n){s=C[n%C.length];var c=s.Index,d=D.Get(c),I=d.Args;s.Args&&(I=s.Args);var S={Name:d.Name,Script:d.Script,Args:I,ID:s.Index,KLineType:d.KLineType,YSpecificMaxMin:d.YSpecificMaxMin,YSplitScale:d.YSplitScale,FloatPrecision:d.FloatPrecision,Condition:d.Condition,OutName:d.OutName};this.WindowIndex[n]=new pn(S.Name,S.Script,S.Args,S);l=this.Frame.SubFrame[n];null!=s.Modify&&(this.Frame.SubFrame[n].Frame.ModifyIndex=s.Modify),null!=s.Change&&(this.Frame.SubFrame[n].Frame.ChangeIndex=s.Change),null!=s.Close&&(this.Frame.SubFrame[n].Frame.CloseIndex=s.Close),null!=s.Overlay&&(chart.Frame.SubFrame[n].Frame.OverlayIndex=s.Overlay),1==s.IsDrawTitleBG&&(this.Frame.SubFrame[n].Frame.IsDrawTitleBG=s.IsDrawTitleBG),sa.IsBool(s.IsShowNameArrow)&&(this.Frame.SubFrame[n].Frame.IsShowNameArrow=s.IsShowNameArrow),sa.IsNumber(s.TitleHeight)?this.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight=s.TitleHeight:s.TitleHeight=this.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight,sa.IsBool(s.IsShowTitleArrow)&&(l.Frame.IsShowTitleArrow=s.IsShowTitleArrow),sa.IsNumber(s.TitleArrowType)&&(l.Frame.TitleArrowType=s.TitleArrowType),0==s.IsShowIndexName&&(this.Frame.SubFrame[n].Frame.IsShowIndexName=!1),0==s.IsShowOverlayIndexName&&(this.Frame.SubFrame[n].Frame.IsShowOverlayIndexName=!1),sa.IsNumber(s.IndexParamSpace)&&(this.Frame.SubFrame[n].Frame.IndexParamSpace=s.IndexParamSpace),sa.IsNumber(s.IndexTitleSpace)&&(this.Frame.SubFrame[n].Frame.IndexTitleSpace=s.IndexTitleSpace),0==s.IsShowXLine&&(this.Frame.SubFrame[n].Frame.IsShowXLine=!1),0==s.IsShowYLine&&(this.Frame.SubFrame[n].Frame.IsShowYLine=!1),sa.IsBool(s.IsShowIndexTitle)&&(this.Frame.SubFrame[n].Frame.IsShowIndexTitle=s.IsShowIndexTitle),sa.IsBool(s.IsShowLeftText)&&(l.Frame.IsShowYText[0]=s.IsShowLeftText,l.Frame.YSplitOperator.IsShowLeftText=s.IsShowLeftText),sa.IsBool(s.IsShowRightText)&&(l.Frame.IsShowYText[1]=s.IsShowRightText,l.Frame.YSplitOperator.IsShowRightText=s.IsShowRightText),s.OverlayIndexType&&(sa.IsNumber(s.OverlayIndexType.Position)&&(l.Frame.OverlayIndexType.Position=s.OverlayIndexType.Position),sa.IsNumber(s.OverlayIndexType.LineSpace)&&(l.Frame.OverlayIndexType.LineSpace=s.OverlayIndexType.LineSpace));var T=this.ChartPaint[0].Data;this.BindIndexData(n,T)}}}},this.ChangeIndexTemplate=function(t){var e=this;if(t.Windows){var a=t.Windows.length;if(!(a<=0)){var i=this.Frame.SubFrame.length,r=null,n=null,o=null;t.Symbol&&(o=t.Symbol),t.KLine&&(sa.IsNumber(t.KLine.Period)&&t.KLine.Period!=this.Period&&(r=t.KLine.Period),sa.IsNumber(t.KLine.Right)&&t.KLine.Right!=this.Right&&(n=t.KLine.Right));for(var s=null!=r||null!=n||null!=o,h=0;h<i;++h){this.DeleteIndexPaint(h);var l=this.Frame.SubFrame[h];l.YSpecificMaxMin=null,l.IsLocked=!1,l.YSplitScale=null}if(i>a){var u=this.GetEventCallback(m.ON_DELETE_FRAME);for(h=i-1;h>=a;--h)if(this.Frame.SubFrame[h].Frame.ClearToolbar(),u&&u.Callback){var C={SubFrame:this.Frame.SubFrame[h],WindowIndex:h};u.Callback(u,C,this)}this.Frame.SubFrame.splice(a,i-a),this.WindowIndex.splice(a,i-a),this.TitlePaint.splice(a+1,i-a)}else for(h=i;h<a;++h){var D=this.CreateSubFrameItem(h);this.Frame.SubFrame[h]=D;var c=new Va;c.Frame=this.Frame.SubFrame[h].Frame,c.Canvas=this.Canvas,c.LanguageID=this.LanguageID,c.GetEventCallback=function(t){return e.GetEventCallback(t)},c.SelectedChart=this.SelectedChart,c.HQChart=this,this.TitlePaint[h+1]=c}for(h=0;h<a;++h){var d=h,I=t.Windows[h],S=null;t.Frame&&t.Frame.length>h&&(S=t.Frame[h]);var T=d+1;this.TitlePaint[T].Data=[],this.TitlePaint[T].Title=null;l=this.Frame.SubFrame[h];if(this.DeleteWindowsOverlayIndex(h),I.Script)this.WindowIndex[h]=new pn(I.Name,I.Script,I.Args,I);else if(I.API){var v=I.API;this.WindowIndex[d]=new xn(v.Name,v.Script,v.Args,I)}else{var p=I.Index,g=tr.Get(p);if(g)this.WindowIndex[h]=g.Create(),this.CreateWindowIndex(d);else{var x=new f,F=x.Get(p);F&&(f.ModifyAttribute(F,I),this.WindowIndex[h]=new pn(F.Name,F.Script,F.Args,F))}}this.SetSubFrameAttribute(l,I,S)}for(h=0;h<this.Frame.SubFrame.length;++h){I=this.Frame.SubFrame[h].Frame;h==this.Frame.SubFrame.length-1?I.XSplitOperator.ShowText=!0:I.XSplitOperator.ShowText=!1}var E=[];if(sa.IsNonEmptyArray(t.OverlayIndex))for(h=0;h<t.OverlayIndex.length;++h){I=t.OverlayIndex[h];I.Index&&(I.IndexName=I.Index),I.Windows>=0&&(I.WindowIndex=I.Windows);var L=this.CreateOverlayWindowsIndex(I);L&&E.push({WindowsIndex:I.WindowIndex,Overlay:L})}if(this.Frame.SetSizeChage(!0),s){o||(o=this.Symbol);var M={KLine:{}};sa.IsNumber(r)&&(M.KLine.Period=r),sa.IsNumber(n)&&(M.KLine.Right=n),this.ChangeSymbol(o,M)}else{var y=this.ChartPaint[0].Data;for(h=0;h<a;++h)this.BindIndexData(h,y);for(h=0;h<E.length;++h){I=E[h];this.BindOverlayIndexData(I.Overlay,I.WindowsIndex,y)}this.UpdataDataoffset(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}}}},this.RemoveIndexWindow=function(t,e){if(u.Chart.Log("[KLineChartContainer::RemoveIndexWindow] remove id",t),0!=t){if(this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.RestoreIndexWindows();var a=this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.DeleteChartPaintExtend({WindowIndex:t}),this.Frame.SubFrame[t].Frame.ClearToolbar();var i=this.GetEventCallback(m.ON_DELETE_FRAME);if(i&&i.Callback){var r={SubFrame:this.Frame.SubFrame[t],WindowIndex:t};i.Callback(i,r,this)}this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var n=0;n<this.Frame.SubFrame.length;++n){var o=this.Frame.SubFrame[n].Frame;n==this.Frame.SubFrame.length-1?o.XSplitOperator.ShowText=!0:o.XSplitOperator.ShowText=!1,o.Identify=n}if(this.ChartDrawPicture.length>0){var s=[];for(var n in this.ChartDrawPicture){o=this.ChartDrawPicture[n];o.Frame!=a&&s.push(o)}this.ChartDrawPicture=s}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}}else e&&e.DeleteMainIndex&&(this.DeleteIndexPaint(t),this.WindowIndex[t]=null,this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw())},this.GetStockChipChart=function(t){if(t)return this.GetExtendChartByClassName(t);var e=this.GetExtendChartByClassName("StockChip");return e||(e=this.GetExtendChartByClassName("StockChipPhone"),e)},this.DeleteStockChipChart=function(){var t=this.GetStockChipChart();if(t){var e=t.Chart.Width;this.DeleteExtendChart(t),this.Frame.ChartBorder.Right-=e,"StockChipPhone"==t.Chart.ClassName&&(this.GlobalOption.RightHorizontal.Show=!0,this.Frame.ResetXYSplit()),this.SetSizeChange(!0),this.Draw()}},this.CreateStockChipPhone=function(t){var e=new Ke;return e.Canvas=this.Canvas,e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.HQChart=this,e.Left=this.Frame.ChartBorder.Right,e.SetOption(t),this.ExtendChartPaint.push(e),this.Frame.ChartBorder.Right+=e.Width,this.GlobalOption.RightHorizontal.Show=!1,e},this.CreateExtendChart=function(t,e){var a;switch(t){case"筹码分布":case"StockChip":return a=new Ue,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.Left=this.Frame.ChartBorder.Right,a.SetOption(e),this.ExtendChartPaint.push(a),this.Frame.ChartBorder.Right+=a.Width,a;case"StockChipPhone":return this.CreateStockChipPhone(e);case"KLineTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new Ye,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"深度图":return a=new Qe,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"K线Y轴背景图":return a=new qe,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"BackgroundPaint":case"背景图":return a=new je,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"FrameSplitPaint":return a=new ze,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return a=Ve.Create(t),a?(a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a):null}},this.OnTouchFinished=function(){if(this.DragMode==I.CLICK_TOUCH_MODE_ID){if(1==this.ClickModel.IsShowCorssCursor&&this.ClickModel.PreventHide)return;if(1==this.ClickModel.IsShowCorssCursor&&this.TouchDrawCount>0)return;return this.TouchStatus.CorssCursorShow=!1,void this.DrawDynamicInfo()}if(!0===this.EnableClickModel){if(1==this.ClickModel.IsShowCorssCursor&&this.ClickModel.PreventHide)return;if(1==this.ClickModel.IsShowCorssCursor&&this.TouchDrawCount>0)return;return this.ClickModel.IsShowCorssCursor=!1,void this.DrawDynamicInfo()}if(!0!==this.CorssCursorTouchEnd)for(var t in this.ExtendChartPaint){var e=this.ExtendChartPaint[t];"KLineTooltipPaint"===e.ClassName&&this.DrawDynamicInfo()}else this.TouchDrawCount>0&&this.DrawDynamicInfo()},this.LockIndex=function(t){if(t&&t.IndexName)for(var e in this.WindowIndex){var a=this.WindowIndex[e];if(a||conintue,a.Name==t.IndexName){a.SetLock(t),this.Update();break}}},this.TryClickLock=function(t,e){for(var a=0;a<this.Frame.SubFrame.length;++a){var i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var r=new pt;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.TryClickIndexTitle=function(t,e){for(var a in this.TitlePaint){var i=this.TitlePaint[a];if(i.IsClickTitle&&i.IsClickTitle(t,e)){var r={Point:{X:t,Y:e},Title:i.Title,FrameID:i.Frame.Identify};u.Chart.Log("[KLineChartContainer::TryClickIndexTitle] click title ",r);var n=this.GetEventCallback(m.ON_CLICK_INDEXTITLE);return n&&n.Callback&&n.Callback(n,r,this),!0}}return!1},this.SetSizeChange=function(t){for(var e in this.Frame.SetSizeChage(t),this.ExtendChartPaint){var a=this.ExtendChartPaint[e];a.SizeChange=t}},this.SetSizeChage=this.SetSizeChange,this.Update=function(t){if(this.SourceData){this.BeforeBindMainData&&this.BeforeBindMainData("Update");var e,a=new dt;if(a.Data=this.SourceData.Data,a.Period=this.Period,a.Right=this.Right,a.DataType=this.SourceData.DataType,a.Symbol=this.Symbol,a.Right>0&&dt.IsDayPeriod(a.Period,!0)){var i=a.GetRightData(a.Right,{AlgorithmType:this.RightFormula});a.Data=i}else if(a.Right>0&&dt.IsMinutePeriod(a.Period,!0)&&this.RightFormula>=1){i=a.GetRightData(a.Right,{AlgorithmType:this.RightFormula});a.Data=i}if(dt.IsDayPeriod(a.Period,!1)||dt.IsMinutePeriod(a.Period,!1)){var r=a.GetPeriodData(a.Period);a.Data=r}this.BindMainData(a,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("Update");for(var n=0;n<this.Frame.SubFrame.length;++n)0==n&&(e=this.Frame.SubFrame[n].Frame),this.BindIndexData(n,a);for(var n in e&&e.YSplitOperator&&(e.YSplitOperator.Symbol=this.Symbol,e.YSplitOperator.Data=this.ChartPaint[0].Data,e.YSplitOperator.Period=this.Period),this.OverlayChartPaint){var o=this.OverlayChartPaint[n];if(o.SourceData)if(dt.IsMinutePeriod(this.Period,!0)){a=new dt;a.Data=o.SourceData.Data,a.Period=this.Period,a.Right=this.Right;var s=this.SourceData.GetOverlayMinuteData(a.Data,this.IsApiPeriod);if(a.Data=s,dt.IsMinutePeriod(a.Period,!1)&&!this.IsApiPeriod){r=a.GetPeriodData(a.Period);a.Data=r}o.Data=a}else{a=new dt;if(a.Data=o.SourceData.Data,a.Period=this.Period,a.Right=this.Right,a.Right>0&&Pr.IsEnableRight(o.Symbol)){i=a.GetRightData(a.Right,{AlgorithmType:this.RightFormula});a.Data=i}s=this.SourceData.GetOverlayData(a.Data,this.IsApiPeriod);if(a.Data=s,dt.IsDayPeriod(a.Period,!1)&&!this.IsApiPeriod){r=a.GetPeriodData(a.Period);a.Data=r}o.Data=a}}this.ReqeustKLineInfoData({FunctionName:"Update"}),this.CreateChartDrawPictureByStorage(),this.UpdataDataoffset(),t&&t.UpdateCursorIndexType>0?this.UpdatePointByCursorIndex(t.UpdateCursorIndexType):this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw();for(n=0;n<this.Frame.SubFrame.length;++n){o=this.Frame.SubFrame[n];for(var h in o.OverlayIndex){var l=o.OverlayIndex[h];this.BindOverlayIndexData(l,n,a)}}}},this.ChangeSymbol=function(t,e){if(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeSymbol"),this.ClearRectSelect(!0),this.ClearCustomKLine(),this.ClearKLineBreakPoint(),this.ClearKLineCaluate(),this.HideTooltip(),this.ResetScrollBar(),this.ClearIndexRunCount(),this.UnlockCorssCursor(),this.Frame.ClearYCoordinateMaxMin(),this.Symbol=t,t){if(e&&e.KLine){var a=e.KLine;sa.IsNumber(a.Right)&&(this.Right=a.Right),sa.IsNumber(a.Period)&&(this.Period=a.Period),sa.IsNumber(a.DataWidth)&&(this.KLineSize={DataWidth:a.DataWidth})}if(Pr.IsSHSZIndex(t)&&(this.Right=0),this.ClearIndexPaint(),e){if(sa.IsNonEmptyArray(e.Windows))for(var i=e.Windows,r=0;r<i.length;++r){if(r>=this.WindowIndex.length)break;a=i[r];if(a)if(a.Script)this.WindowIndex[r]=new pn(a.Name,a.Script,a.Args,a);else if(a.API){var n=a.API;this.WindowIndex[r]=new xn(n.Name,n.Script,n.Args,a)}else{var o=a.Index,s=new f,h=s.Get(o);h&&(f.ModifyAttribute(h,a),h.ID=o,this.WindowIndex[r]=new pn(h.Name,h.Script,h.Args,h))}}if(e.CustomShow&&sa.IsPlusNumber(e.CustomShow.Date)){a=e.CustomShow;this.CustomShow={Date:a.Date,Position:0},sa.IsNumber(a.Time)&&(this.CustomShow.Time=a.Time),sa.IsPlusNumber(a.PageSize)&&(this.CustomShow.PageSize=a.PageSize),sa.IsNumber(a.Position)&&(this.CustomShow.Position=a.Position)}}this.ReloadChartDrawPicture(),this.Frame.ClearUpDonwFrameYData(),dt.IsDayPeriod(this.Period,!0)?(this.ClearStockCache(),this.RequestHistoryData()):dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)||dt.IsMilliSecondPeriod(this.Period)?(this.ClearStockCache(),this.RequestHistoryMinuteData()):dt.IsTickPeriod(this.Period)&&(this.ClearStockCache(),this.RequestTickData())}else this.DrawEmpty()},this.ReqeustKLineInfoData=function(t){if(t&&"RecvDragDayData"==t.FunctionName)t.Update=!0;else{if(this.ChartPaint.length>0){var e=this.ChartPaint[0];e.InfoData=new Map}t.Update=!1}if(sa.IsNonEmptyArray(this.ChartInfo))for(var a=0;a<this.ChartInfo.length;++a)this.ChartInfo[a].RequestData(this,t)},this.SetKLineInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=pr.Get(t[a]);if(i){var r=i.Create();r.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(r)}}1==e&&this.ReqeustKLineInfoData({FunctionName:"SetKLineInfo"})},this.AddKLineInfo=function(t,e){var a=pr.GetClassInfo(t);if(a){for(var i in this.ChartInfo){var r=this.ChartInfo[i];if(r.ClassName==a.ClassName)return}var n=pr.Get(t);if(n){r=n.Create();r.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(r),1==e&&r.RequestData(this)}}else console.warn("[KLineChartContainer::AddKLineInfo] can't find infoname=",t)},this.DeleteKLineInfo=function(t){var e=pr.GetClassInfo(t);if(e)for(var a in this.ChartInfo){var i=this.ChartInfo[a];if(i.ClassName==e.ClassName){this.ChartInfo.splice(a,1),this.UpdataChartInfo(),this.Draw();break}}else console.warn("[KLineChartContainer::DeleteKLineInfo] can't find infoname=",t)},this.ClearKLineInfo=function(){if(this.ChartInfo&&!(this.ChartInfo.length<=0)){this.ChartInfo=[];var t=this.ChartPaint[0];t.InfoData=null,this.Draw()}},this.OverlaySymbol=function(t,e){for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];if(i.Symbol===t)return console.warn("[KLineChartContainer::OverlaySymbol] overlay symbol=".concat(t," exist.")),!1}var r=new Nt;return r.Canvas=this.Canvas,r.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,r.ChartFrame=this.Frame.SubFrame[0].Frame,r.Name="Overlay-KLine",r.DrawType=this.KLineDrawType,r.Symbol=t,r.Identify="Overlay-KLine-".concat(t),e&&e.Color?r.Color=e.Color:r.Color=qi.OverlaySymbol.Color[qi.OverlaySymbol.Random%qi.OverlaySymbol.Color.length],r.SetOption(e),++qi.OverlaySymbol.Random,this.ChartPaint[0]&&this.ChartPaint[0].Data&&this.SourceData&&(r.MainData=this.ChartPaint[0].Data),this.OverlayChartPaint.push(r),dt.IsDayPeriod(this.Period,!0)?this.RequestOverlayHistoryData():dt.IsMinutePeriod(this.Period,!0)&&this.RequestOverlayHistoryMinuteData(),!0},this.RequestSingleOverlayHistoryData=function(t,e,a,i){var r=this;if(i.Status=Rt.STATUS_REQUESTDATA_ID,this.NetworkFilter){var n={Name:"KLineChartContainer::RequestOverlayHistoryData",Explain:"叠加股票日K线数据",Request:{Url:r.KLineApiUrl,Data:{symbol:t,count:e.MaxRequestDataCount,first:{date:a},field:["name","symbol","yclose","open","price","high","vol","amount"]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(t){i.Status=Rt.STATUS_RECVDATA_ID,r.RecvOverlayHistoryData(t,i)})),1==n.PreventDefault)return}},this.RequestOverlayHistoryData=function(){if(this.OverlayChartPaint.length&&this.SourceData&&this.SourceData.Data)for(var t=this.GetRequestDataCount(),e=this.SourceData.Data[0].Date,a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];if(i.MainData&&i.Status==Rt.STATUS_NONE_ID){var r=i.Symbol;r&&this.RequestSingleOverlayHistoryData(r,t,e,i)}}},this.RecvOverlayHistoryData=function(t,e){if(!e.IsDelete){var a=or.JsonDataToHistoryData(t),i=new dt;i.Data=a,i.DataType=0;var r=new dt;if(r.Data=a,r.Period=this.Period,r.Right=this.Right,r.DataType=0,r.Right>0&&Pr.IsSHSZStockA(t.symbol)&&!this.IsApiPeriod){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}var o=this.SourceData.GetOverlayData(r.Data,this.IsApiPeriod);if(r.Data=o,dt.IsDayPeriod(r.Period,!1)&&!this.IsApiPeriod){var s=r.GetPeriodData(r.Period);r.Data=s}e.Data=r,e.SourceData=i,e.Title=t.name,e.Symbol=t.symbol,e.Status=Rt.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestSingleHistoryMinuteData=function(t,e,a,i,r){var n=this;if(r.Status=Rt.STATUS_REQUESTDATA_ID,this.NetworkFilter){var o={Name:"KLineChartContainer::RequestOverlayHistoryMinuteData",Explain:"叠加股票分钟K线数据",Request:{Url:n.MinuteKLineApiUrl,Data:{symbol:t,count:e.MaxRequestMinuteDayCount,first:{date:a,time:i},field:["name","symbol","yclose","open","price","high","vol","amount"]},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(o,(function(t){r.Status=Rt.STATUS_RECVDATA_ID,n.RecvOveralyHistoryMinuteData(t,r)})),1==o.PreventDefault)return}},this.RequestOverlayHistoryMinuteData=function(){if(this.OverlayChartPaint.length&&this.SourceData&&this.SourceData.Data)for(var t=this.GetRequestDataCount(),e=this.SourceData.Data[0].Date,a=this.SourceData.Data[0].Time,i=0;i<this.OverlayChartPaint.length;++i){var r=this.OverlayChartPaint[i];if(r.MainData&&r.Status==Rt.STATUS_NONE_ID){var n=r.Symbol;n&&this.RequestSingleHistoryMinuteData(n,t,e,a,r)}}},this.RecvOveralyHistoryMinuteData=function(t,e){if(this.EnableVerifyRecvData&&t.symbol!=e.Symbol)u.Chart.Warn("[MinuteChartContainer::RecvOveralyHistoryMinuteData] recv data symbol not match. paint[".concat(e.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var a=or.JsonDataToMinuteHistoryData(t);if(a){var i=new dt;i.Data=a,i.DataType=1;var r=new dt;r.Data=a,r.Period=this.Period,r.Right=this.Right,r.DataType=1;var n=this.SourceData.GetOverlayMinuteData(r.Data,this.IsApiPeriod);if(r.Data=n,dt.IsMinutePeriod(r.Period,!1)&&!this.IsApiPeriod){var o=r.GetPeriodData(r.Period);r.Data=o}e.Data=r,e.SourceData=i,e.Title=t.name,e.Symbol=t.symbol,e.Status=Rt.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}},this.ClearOverlaySymbol=function(){for(var t in this.OverlayChartPaint){var e=this.OverlayChartPaint[t];e.IsDelete=!0}this.OverlayChartPaint=[],this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0,this.UpdateFrameMaxMin(),this.Draw()},this.DeleteOverlaySymbol=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol===t)return a.IsDelete=!0,this.OverlayChartPaint.splice(e,1),this.OverlayChartPaint.length<=0&&(this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0),this.UpdateFrameMaxMin(),this.Draw(),!0}return console.warn("[KLineChartContainer::DeleteOverlaySymbol] overlay symbol=".concat(t," not exist.")),!1},this.RequestFlowCapitalData=function(){if(this.Symbol&&1!=this.FlowCapitalReady){var t=this.Symbol.toUpperCase(),e=!0;if((Pr.IsBIT(t)||Pr.IsFutures(t))&&(e=!1),this.EnableFlowCapital&&Pr.IsBIT(t)&&1==this.EnableFlowCapital.BIT&&(e=!0),!e)return u.Chart.Log("[KLineChartContainer::RequestFlowCapitalData] symbol=".concat(this.Symbol," not need download data.")),void(this.FlowCapitalReady=!0);var a=this,i=["name","date","symbol","capital.a"];if(this.NetworkFilter){var r={Name:"KLineChartContainer::RequestFlowCapitalData",Explain:"流通股本数据",Request:{Url:a.StockHistoryDayApiUrl,Data:{symbol:[this.Symbol],orderfield:"date",field:i},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){a.RecvFlowCapitalData(t)})),1==r.PreventDefault)return}io.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:i,symbol:[this.Symbol],orderfield:"date"},type:"post",dataType:"json",async:!0,success:function(t){a.RecvFlowCapitalData(t)}})}},this.RecvFlowCapitalData=function(t){if(t.stock&&1==t.stock.length){var e=t.stock[0];if(this.EnableVerifyRecvData&&e.symbol!=this.Symbol)u.Chart.Warn("[MinuteChartContainer::RecvFlowCapitalData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(e.symbol,"]"));else{var a=new Array;for(var i in e.stockday){var r=e.stockday[i],n=new Dt;n.Date=r.date;var o=r.capital;o&&(o.a>0&&(n.Value=o.a,a.push(n)))}if(this.IsApiPeriod){var s=this.ChartPaint[0].Data,h=null;if(dt.IsMinutePeriod(this.Period,!0)?h=s.GetMinuteFittingFinanceData(a):dt.IsDayPeriod(this.Period,!0)&&(h=s.GetFittingFinanceData(a)),h&&s.Data&&h.length==s.Data.length)for(var l in s.Data){r=s.Data[l];h[l]&&sa.IsNumber(h[l].Value)&&(r.FlowCapital=h[l].Value)}}else if(dt.IsMinutePeriod(this.Period,!0)){for(h=this.SourceData.GetMinuteFittingFinanceData(a),l=0;l<this.SourceData.Data.length;++l){r=this.SourceData.Data[l];h[l]&&sa.IsNumber(h[l].Value)&&(r.FlowCapital=h[l].Value)}var C=this.ChartPaint[0].Data,D=new dt;if(D.Data=this.SourceData.Data,C.Right>0&&this.RightFormula>=1){var f=D.GetRightData(C.Right,{AlgorithmType:this.RightFormula});D.Data=f}if(dt.IsMinutePeriod(C.Period,!1)){var c=D.GetPeriodData(C.Period);D.Data=c}C.Data=D.Data}else{h=this.SourceData.GetFittingFinanceData(a);for(var m in this.SourceData.Data){r=this.SourceData.Data[m];h[m]&&sa.IsNumber(h[m].Value)&&(r.FlowCapital=h[m].Value)}C=this.ChartPaint[0].Data,D=new dt;if(D.Data=this.SourceData.Data,C.Right>0){f=D.GetRightData(C.Right,{AlgorithmType:this.RightFormula});D.Data=f}if(dt.IsDayPeriod(C.Period,!1)){c=D.GetPeriodData(C.Period);D.Data=c}C.Data=D.Data}this.FlowCapitalReady=!0;var d=!1;for(var l in this.ExtendChartPaint){r=this.ExtendChartPaint[l];if("StockChip"==r.ClassName){d=!0;break}}d&&this.Draw()}}},this.CreateChartDrawPicture=function(t,e,a){var i=null,r=Ha.GetDrawPictureByName(t);if(r&&(i=r.Create(),"ChartDrawPictureText"!=i.ClassName&&"ChartDrawVolProfile"!=i.ClassName||(i.HQChart=this)),!i&&Ha.MapIonFont.has(t)){var n=Ha.MapIonFont.get(t);i=new hi,i.FontOption.Family=n.Family,i.Text=n.Text,n.Color&&(i.LineColor=n.Color)}if(!i)return!1;i.Canvas=this.Canvas,i.Status=0,i.Symbol=this.Symbol,i.Period=this.Period,i.Right=this.Right,i.Option=this.ChartDrawOption,a&&(i.FinishedCallback=a),e&&i.SetOption(e);var o=this;return i.Update=function(){o.DrawDynamicInfo()},i.GetActiveDrawPicture=function(){return o.GetActiveDrawPicture()},this.CurrentChartDrawPicture=i,!0},this.AddChartDrawPicture=function(t){if(!t)return null;if(t.FrameID<0||t.FrameID>=this.Frame.SubFrame.length)return null;var e=this,a=Ha.GetDrawPictureByClassName(t.ClassName);if(!a)return null;var i=a.Create();return i.Canvas=this.Canvas,i.Status=10,i.Frame=this.Frame.SubFrame[t.FrameID].Frame,i.Symbol=this.Symbol,i.Period=this.Period,i.Right=this.Right,i.Option=this.ChartDrawOption,t.Value&&(i.Value=t.Value),t.Guid&&(i.Guid=t.Guid),i.ImportStorageData&&i.ImportStorageData(t),i.SetOption(t),t.EnableUpdateXValue&&i.UpdateXValue(),i.ValueToPoint(),i.GetActiveDrawPicture=function(){return e.GetActiveDrawPicture()},"ChartDrawPictureText"===i.ClassName&&(i.IsInitialized=!0),this.ChartDrawPicture.push(i),this.DrawDynamicInfo(),i},this.PasteChartDrawPicture=function(t,e,a){if(!t||!t.ClassName)return null;if(e<0||e>=this.Frame.SubFrame.length)return null;var i=Ha.GetDrawPictureByClassName(t.ClassName);if(!i)return null;var r=i.Create();if(!r)return null;var n=this;return r.Canvas=this.Canvas,r.Status=10,r.Frame=this.Frame.SubFrame[e].Frame,r.Symbol=this.Symbol,r.Period=this.Period,r.Right=this.Right,r.Option=this.ChartDrawOption,r.GetActiveDrawPicture=function(){return n.GetActiveDrawPicture()},r.SetOption&&r.SetOption(t),this.RandomDrawPictureValue(r,t),r.PointToValue(),"ChartDrawPictureText"===r.ClassName&&(r.IsInitialized=!0),this.ChartDrawPicture.push(r),this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(r),this.DrawDynamicInfo(),r},this.RandomDrawPictureValue=function(t,e){if(sa.IsNonEmptyArray(e.Value)){var a=this.GetKLineChart();if(!a||!a.Data||!sa.IsNumber(a.Data.DataOffset)||a.Data.DataOffset<0)return null;if(!sa.IsNonEmptyArray(a.Data.Data))return null;var i=a.Data.Data,r=(a.Data.DataOffset,a.Data.DataOffset+a.ChartFrame.XPointCount-1);r>=i.length&&(r=i.length-1);var n=t.Frame.ChartBorder.GetHeight(),o=(t.Frame.HorizontalMax,t.Frame.HorizontalMin,t.Frame.ChartBorder.GetBottomEx()-n*e.YFristScale),s={Max:5,Min:2},h=Math.floor(Math.random()*(s.Max-s.Min+1))+s.Min,l=e.Value[0].XIndex+h;t.Value=[];for(var u=0;u<e.Value.length;++u){var C=e.Value[u];t.Value[u]={XValue:l+C.XOffset},t.Point[u]={Y:o+C.YOffset,X:t.Frame.GetXFromIndex(l+C.XOffset,!1)}}}},this.MoveChartDrawPicture=function(t,e,a,i){var r=this.CurrentChartDrawPicture;if(!r)return!1;var n=F();a&&(n=1);var o=t*n,s=e*n;return r.Move(o,s,i),!0},this.UpdateChartDrawXValue=function(){for(var t in this.ChartDrawPicture){var e=this.ChartDrawPicture[t];e.UpdateXValue()}},this.OnRightMenu=function(t,e,a){var i=F(),r=this.Frame.PtInFrame(t*i,e*i);this.PopupRightMenuV2({X:a.offsetX,Y:a.offsetY,FrameID:r,CursorIndex:this.CursorIndex,Point:{X:t*i,Y:e*i}},a);var n=this.GetEventCallback(m.ON_CONTEXT_MENU);if(n){var o={X:t,Y:e,Event:a,FrameID:r,Point:{X:t*i,Y:e*i},CursorIndex:this.CursorIndex};n.Callback(n,o,this)}},this.GetRightMenuData=function(t,e){var a=this.Frame.SubFrame.length,i=this.ChartPaint[0],r=i.DrawType,n=i.IsThinAKBar,o=i.PriceGap,s=i.DaySummary.Enable,h=i.InfoPosition,l=null,u=null,C=null;this.Frame.SubFrame[0]&&this.Frame.SubFrame[0].Frame&&(C=this.Frame.SubFrame[0].Frame),C&&(l=C.CoordinateType,C.YSplitOperator&&(u=C.YSplitOperator.CoordinateType));for(var D=[],f=0;f<this.ChartInfo.length;++f){var c=this.ChartInfo[f];c&&c.ClassName&&D.push(c.ClassName)}var m=[];for(f=0;f<this.OverlayChartPaint.length;++f){c=this.OverlayChartPaint[f];c&&c.Symbol&&m.push(c.Symbol)}var d=!1,I=!1;this.GetExtendChartByClassName("SessionBreaksPaint")&&(d=!0),this.GetStockChipChart()&&(I=!0);var S={Name:"StockChip",ShowType:1,Width:230},T=!1,p=!1,g=!1,x=!1,F=!1,E=!1,L=-1;this.ChartCorssCursor&&(T=this.ChartCorssCursor.IsShowCorss,p=this.ChartCorssCursor.IsOnlyDrawKLine&&this.ChartCorssCursor.IsShowClose,g=this.ChartCorssCursor.IsFixXLastTime,x=this.ChartCorssCursor.CorssPointConfig.Enable,F=this.ChartCorssCursor.EnableDBClick,E=this.ChartCorssCursor.StringFormatX.IsShowIncrease,L=this.ChartCorssCursor.BottomConfig.Align);var M=!1;this.PopMinuteChart&&(M=!0);var y=!1,R=!1;this.ChartDragSelectRect&&(y=this.ChartDragSelectRect.EnableRButton,R=this.ChartDragSelectRect.EnableLButton);var N=null;if(t>=0&&e&&sa.IsNumber(e.CursorIndex)){var w=this.GetKData();if(w&&sa.IsNonEmptyArray(w.Data)){var A=w.DataOffset+e.CursorIndex;A>=0&&A<w.Data.length&&(N=w.Data[A])}}var O=!1;this.DialogTooltip&&(O=this.DialogTooltip.IndexTitle.Enable);var b=[{Name:"分析周期",SubMenu:[{Name:"日线",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[0]},Checked:0==this.Period},{Name:"周线",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[1]},Checked:1==this.Period},{Name:"双周线",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[21]},Checked:21==this.Period},{Name:"月线",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[2]},Checked:2==this.Period},{Name:"季线",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[9]},Checked:9==this.Period},{Name:"半年",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[22]},Checked:22==this.Period},{Name:"年线",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[3]},Checked:3==this.Period},{Name:"1分",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[4]},Checked:4==this.Period},{Name:"5分",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[5]},Checked:5==this.Period},{Name:"15分",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[6]},Checked:6==this.Period},{Name:"30分",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[7]},Checked:7==this.Period},{Name:"60分",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[8]},Checked:8==this.Period},{Name:"2小时",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[11]},Checked:11==this.Period},{Name:"4小时",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[12]},Checked:12==this.Period},{Name:"分笔",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[10]},Checked:10==this.Period},{Name:"自定义周期:3分钟",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[20003]},Checked:20003==this.Period},{Name:"自定义周期:35分钟",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[20035]},Checked:20035==this.Period},{Name:"自定义周期:8日",Data:{ID:v.CMD_CHANGE_PERIOD_ID,Args:[40008]},Checked:40008==this.Period}]},{Name:"指标切换",SubMenu:[{Name:"均线",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"均线"]}},{Name:"BOLL",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"BOLL"]}},{Name:"MACD",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"MACD"]}},{Name:"MACD(粗)",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"MACD2"]}},{Name:"KDJ",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"KDJ"]}},{Name:"VOL",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"VOL"]}},{Name:"RSI",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"RSI"]}},{Name:"BRAR",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"BRAR"]}},{Name:"WR",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"WR"]}}]},{Name:"五彩K线",SubMenu:[{Name:"十字星",Data:{ID:v.CMD_CHANGE_COLOR_INDEX_ID,Args:["五彩K线-十字星"]}},{Name:"早晨之星",Data:{ID:v.CMD_CHANGE_COLOR_INDEX_ID,Args:["五彩K线-早晨之星"]}},{Name:"垂死十字",Data:{ID:v.CMD_CHANGE_COLOR_INDEX_ID,Args:["五彩K线-垂死十字"]}},{Name:"三只乌鸦",Data:{ID:v.CMD_CHANGE_COLOR_INDEX_ID,Args:["五彩K线-三只乌鸦"]}},{Name:"光脚阴线",Data:{ID:v.CMD_CHANGE_COLOR_INDEX_ID,Args:["五彩K线-光脚阴线"]}},{Name:"黄昏之星",Data:{ID:v.CMD_CHANGE_COLOR_INDEX_ID,Args:["五彩K线-黄昏之星"]}}]},{Name:"专家系统",SubMenu:[{Name:"BIAS",Data:{ID:v.CMD_CHANGE_TRADE_INDEX_ID,Args:["交易系统-BIAS"]}},{Name:"CCI",Data:{ID:v.CMD_CHANGE_TRADE_INDEX_ID,Args:["交易系统-CCI"]}},{Name:"DMI",Data:{ID:v.CMD_CHANGE_TRADE_INDEX_ID,Args:["交易系统-DMI"]}},{Name:"KD",Data:{ID:v.CMD_CHANGE_TRADE_INDEX_ID,Args:["交易系统-KD"]}},{Name:"BOLL",Data:{ID:v.CMD_CHANGE_TRADE_INDEX_ID,Args:["交易系统-BOLL"]}},{Name:"KDJ",Data:{ID:v.CMD_CHANGE_TRADE_INDEX_ID,Args:["交易系统-KDJ"]}}]},{Name:"信息地雷",SubMenu:[{Name:"公告",Data:{ID:v.CMD_CHANGE_KLINE_INFO_ID,Args:["公告",!D.includes("AnnouncementInfo")]},Checked:D.includes("AnnouncementInfo")},{Name:"业绩预告",Data:{ID:v.CMD_CHANGE_KLINE_INFO_ID,Args:["业绩预告",!D.includes("PforecastInfo")]},Checked:D.includes("PforecastInfo")},{Name:"调研",Data:{ID:v.CMD_CHANGE_KLINE_INFO_ID,Args:["调研",!D.includes("ResearchInfo")]},Checked:D.includes("ResearchInfo")},{Name:"大宗交易",Data:{ID:v.CMD_CHANGE_KLINE_INFO_ID,Args:["大宗交易",!D.includes("BlockTrading")]},Checked:D.includes("BlockTrading")},{Name:"龙虎榜",Data:{ID:v.CMD_CHANGE_KLINE_INFO_ID,Args:["龙虎榜",!D.includes("TradeDetail")]},Checked:D.includes("TradeDetail")},{Name:"互动易",Data:{ID:v.CMD_CHANGE_KLINE_INFO_ID,Args:["互动易",!D.includes("InvestorInfo")]},Checked:D.includes("InvestorInfo")},{Name:JSPopMenu.SEPARATOR_LINE_NAME},{Name:"显示位置",SubMenu:[{Name:"底部",Data:{ID:v.CMD_CHANGE_INFO_POSITION_ID,Args:[1]},Checked:1===h},{Name:"K线上",Data:{ID:v.CMD_CHANGE_INFO_POSITION_ID,Args:[0]},Checked:0===h}]}]},{Name:"缺口提示",SubMenu:[{Name:"显示1个缺口",Data:{ID:v.CMD_CHANGE_PRICE_GAP_ID,Args:[!0,1]},Checked:1==o.Enable&&1==o.Count},{Name:"显示2个缺口",Data:{ID:v.CMD_CHANGE_PRICE_GAP_ID,Args:[!0,2]},Checked:1==o.Enable&&2==o.Count},{Name:"显示3个缺口",Data:{ID:v.CMD_CHANGE_PRICE_GAP_ID,Args:[!0,3]},Checked:1==o.Enable&&3==o.Count},{Name:"隐藏缺口",Data:{ID:v.CMD_CHANGE_PRICE_GAP_ID,Args:[!1]},Checked:0==o.Enable}]},{Name:"叠加品种",SubMenu:[{Name:"上证指数",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["000001.sh",!m.includes("000001.sh")]},Checked:m.includes("000001.sh")},{Name:"深证成指",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["399001.sz",!m.includes("399001.sz")]},Checked:m.includes("399001.sz")},{Name:"中小板指",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["399005.sz",!m.includes("399005.sz")]},Checked:m.includes("399005.sz")},{Name:"创业板指",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["399006.sz",!m.includes("399006.sz")]},Checked:m.includes("399006.sz")},{Name:"沪深300",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["000300.sh",!m.includes("000300.sh")]},Checked:m.includes("000300.sh")}]},{Name:"主图线型",SubMenu:[{Name:"K线(空心阳线)",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[3]},Checked:3==r},{Name:"K线(实心阳线)",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[0]},Checked:0==r},{Name:"美国线",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[2,!0,{IsThinAKBar:!1}]},Checked:2==r&&!n},{Name:"美国线(细)",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[2,!0,{IsThinAKBar:!0}]},Checked:2==r&&n},{Name:"收盘线",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[1]},Checked:1==r},{Name:"收盘面积",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[4]},Checked:4==r},{Name:"K线(空心阳线阴线)",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[6]},Checked:6==r},{Name:"Heikin Ashi",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[11]},Checked:11==r},{Name:"Line Break",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[12]},Checked:12==r},{Name:"High-low",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[13]},Checked:13==r},{Name:"HLC Area",Data:{ID:v.CMD_CHANGE_KLINE_TYPE_ID,Args:[15]},Checked:15==r}]},{Name:"坐标类型",SubMenu:[{Name:"反转坐标",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{IsReverse:0==l}]},Checked:1==l},{Name:JSPopMenu.SEPARATOR_LINE_NAME},{Name:"普通坐标",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{Type:0}]},Checked:0==u},{Name:"百分比坐标",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{Type:1}]},Checked:1==u},{Name:"对数坐标",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{Type:2}]},Checked:2==u},{Name:"等比坐标",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{Type:3}]},Checked:3==u},{Name:"等分坐标",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{Type:4}]},Checked:4==u},{Name:"黄金分割",Data:{ID:v.CMD_CHANGE_COORDINATETYPE_ID,Args:[{Type:5}]},Checked:5==u}]},{Name:"指标窗口个数",SubMenu:[{Name:"1个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[2]},Checked:2==a},{Name:"2个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[3]},Checked:3==a},{Name:"3个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[4]},Checked:4==a},{Name:"4个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[5]},Checked:5==a},{Name:"5个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[6]},Checked:6==a}]},{Name:"十字光标",SubMenu:[{Name:"显示",Data:{ID:v.CMD_SHOW_CORSS_LINE_ID,Args:[!T]},Checked:T},{Name:"显示在K线上",Data:{ID:v.CMD_CORSS_ON_KLINE_ID,Args:[!p]},Checked:p},{Name:"画在有效X轴上",Data:{ID:v.CMD_CORSS_ON_VAILD_TIME_ID,Args:[!g]},Checked:g},{Name:"画圆点",Data:{ID:v.CMD_CORSS_POINT_ID,Args:[!x]},Checked:x},{Name:"双击显示/隐藏",Data:{ID:v.CMD_CORSS_DBCLICK_ID,Args:[!F]},Checked:F},{Name:"至今涨幅显示/隐藏",Data:{ID:v.CMD_CORSS_SHOW_INCREASE_ID,Args:[!E]},Checked:E},{Name:"底部文字对齐",SubMenu:[{Name:"居中",Data:{ID:v.CMD_CORSS_X_TEXTALIGN_ID,Args:[1]},Checked:1===L},{Name:"左对齐",Data:{ID:v.CMD_CORSS_X_TEXTALIGN_ID,Args:[0]},Checked:0===L}]}]},{Name:"其他设置",SubMenu:[{Name:"左键区间选择",Data:{ID:v.CMD_LBUTTON_SELECT_RECT_ID,Args:[!R]},Checked:R},{Name:"右键区间选择",Data:{ID:v.CMD_RBUTTON_SELECT_RECT_ID,Args:[!y]},Checked:y},{Name:JSPopMenu.SEPARATOR_LINE_NAME},{Name:"背景分割",Data:{ID:v.CMD_CHANGE_BG_SPLIT_ID,Args:[!d]},Checked:d},{Name:"画图工具",Data:{ID:v.CMD_SHOW_DRAWTOOL_ID,Args:[]},Checked:this.IsShowDrawToolDialog()},{Name:"移动筹码图",Data:{ID:I?v.CMD_HIDE_STOCKCHIP_ID:v.CMD_SHOW_STOCKCHIP_ID,Args:[S.Name,S]},Checked:I},{Name:"双击弹分时图",Data:{ID:v.CMD_ENABLE_POP_MINUTE_CHART_ID,Args:[!M]},Checked:M},{Name:"显示走完剩余时间",Data:{ID:v.CMD_ENABLE_KLINE_DAY_SUMMARY_ID,Args:[!s]},Checked:s},{Name:JSPopMenu.SEPARATOR_LINE_NAME},{Name:"鼠标形状",SubMenu:[{Name:"默认",Data:{ID:v.CMD_CHANGE_DEFAULTCURSOR_ID,Args:["default"]},Checked:"default"==this.DefaultCursor},{Name:"十字线",Data:{ID:v.CMD_CHANGE_DEFAULTCURSOR_ID,Args:["crosshair"]},Checked:"crosshair"==this.DefaultCursor}]},{Name:"语言设置",SubMenu:[{Name:"中文",Data:{ID:v.CMD_CHANGE_LANGUAGE_ID,Args:["CN"]},Checked:this.LanguageID==ji.LANGUAGE_CHINESE_ID},{Name:"英语",Data:{ID:v.CMD_CHANGE_LANGUAGE_ID,Args:["EN"]},Checked:this.LanguageID==ji.LANGUAGE_ENGLISH_ID},{Name:"繁体",Data:{ID:v.CMD_CHANGE_LANGUAGE_ID,Args:["TC"]},Checked:this.LanguageID==ji.LANGUAGE_TRADITIONAL_CHINESE_ID}]},{Name:"区间选择样式",SubMenu:[{Name:"样式1(默认)",Data:{ID:v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID,Args:[0]},Checked:0==this.ChartDragSelectRect.ShowMode},{Name:"样式2",Data:{ID:v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID,Args:[1]},Checked:1==this.ChartDragSelectRect.ShowMode},{Name:"样式3",Data:{ID:v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID,Args:[2]},Checked:2==this.ChartDragSelectRect.ShowMode}]},{Name:"K线浮动框",SubMenu:[{Name:"禁用",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!1}]},Checked:!this.DialogTooltip},{Name:"样式1",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!0,Style:0}]},Checked:this.DialogTooltip&&0===this.DialogTooltip.Style},{Name:"样式1-指标显示",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!0,IndexTitle:{Enable:!O}}]},Checked:O},{Name:"样式2",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!0,Style:1}]},Checked:this.DialogTooltip&&1===this.DialogTooltip.Style}]},{Name:"K线提示框",SubMenu:[{Name:"启用",Data:{ID:v.CMD_KLINE_TOOLTIP_ATTRIBUTE,Args:[{Enable:!this.KLineTooltipConfig.Enable}]},Checked:this.KLineTooltipConfig.Enable},{Name:"键盘左右显示",Data:{ID:v.CMD_KLINE_TOOLTIP_ATTRIBUTE,Args:[{EnableKeyDown:!this.KLineTooltipConfig.EnableKeyDown}]},Checked:this.KLineTooltipConfig.EnableKeyDown}]},{Name:"X轴拖动",SubMenu:[{Name:"启动",Data:{ID:v.CMD_ENABLE_XDRAG_BOTTOM_ID,Args:[!this.EnableXDrag.Bottom]},Checked:this.EnableXDrag.Bottom},{Name:"左键拖动K线",Data:{ID:v.CMD_ENABLE_XDRAG_BOTTOM_ID,Args:[null,1===this.EnableXDrag.LButton.Type?0:1]},Checked:1===this.EnableXDrag.LButton.Type&&this.EnableXDrag.Bottom},{Name:"左键缩放K线",Data:{ID:v.CMD_ENABLE_XDRAG_BOTTOM_ID,Args:[null,2===this.EnableXDrag.LButton.Type?0:2]},Checked:2===this.EnableXDrag.LButton.Type&&this.EnableXDrag.Bottom},{Name:"右键拖动K线",Data:{ID:v.CMD_ENABLE_XDRAG_BOTTOM_ID,Args:[null,null,1===this.EnableXDrag.RButton.Type?0:1]},Checked:1===this.EnableXDrag.RButton.Type&&this.EnableXDrag.Bottom},{Name:"右键缩放K线",Data:{ID:v.CMD_ENABLE_XDRAG_BOTTOM_ID,Args:[null,null,2===this.EnableXDrag.RButton.Type?0:2]},Checked:2===this.EnableXDrag.RButton.Type&&this.EnableXDrag.Bottom}]},{Name:"K线拖动",SubMenu:[{Name:"禁用",Data:{ID:v.CMD_CHANGE_DRAG_MODE_ID,Args:[0]},Checked:0==this.DragMode},{Name:"左键拖拽",Data:{ID:v.CMD_CHANGE_DRAG_MODE_ID,Args:[1,!1]},Checked:1==(this.DragMode&&!this.KLineDragConfig.EnableShfit)},{Name:"Shift+左键拖拽",Data:{ID:v.CMD_CHANGE_DRAG_MODE_ID,Args:[1,!0]},Checked:1==(this.DragMode&&this.KLineDragConfig.EnableShfit)}]}]}];if(!Pr.IsSHSZIndex(this.Symbol)&&!Pr.IsBIT(this.Symbol)){var B={Name:"复权处理",SubMenu:[{Name:"不复权",Data:{ID:v.CMD_CHANGE_RIGHT_ID,Args:[0]},Checked:0==this.Right},{Name:"前复权",Data:{ID:v.CMD_CHANGE_RIGHT_ID,Args:[1]},Checked:1==this.Right},{Name:"后复权",Data:{ID:v.CMD_CHANGE_RIGHT_ID,Args:[2]},Checked:2==this.Right}]};b.splice(1,0,B)}for(f=0;f<b.length;++f){c=b[f];if("五彩K线"==c.Name)this.ColorIndex&&(c.SubMenu.push({Name:JSPopMenu.SEPARATOR_LINE_NAME}),c.SubMenu.push({Name:"删除五彩K线",Data:{ID:v.CMD_DELETE_COLOR_INDEX_ID}}));else if("专家系统"==c.Name)this.TradeIndex&&(c.SubMenu.push({Name:JSPopMenu.SEPARATOR_LINE_NAME}),c.SubMenu.push({Name:"删除专家系统",Data:{ID:v.CMD_DELETE_TRADE_INDEX_ID}}));else if("叠加品种"==c.Name){for(var P=0;P<c.SubMenu.length;++P)if(c.SubMenu[P].Checked){c.SubMenu.push({Name:JSPopMenu.SEPARATOR_LINE_NAME}),c.SubMenu.push({Name:"取消叠加",Data:{ID:v.CMD_DELETE_ALL_OVERLAY_SYMBOL_ID}});break}}else if("信息地雷"==c.Name){for(P=0;P<c.SubMenu.length;++P)if(c.SubMenu[P].Checked){c.SubMenu.push({Name:JSPopMenu.SEPARATOR_LINE_NAME}),c.SubMenu.push({Name:"删除所有",Data:{ID:v.CMD_DELETE_ALL_KLINE_INFO_ID}});break}}else if("十字光标"==c.Name&&N){var G=this.IsLockCorssCursor();G?c.SubMenu.push({Name:"锁十字光标",Data:{ID:v.CMD_UNLOCK_CROSSCURSOR},Checked:G}):c.SubMenu.push({Name:"锁十字光标",Data:{ID:v.CMD_LOCK_CROSSCURSOR,Args:[{KItem:{Date:N.Date,Time:N.Time},Draw:!0}]},Checked:G})}}return b},this.PopupSelectRectMenuV2=function(t,e){var a=this,i=[{Name:"区间统计",Data:{ID:v.CMD_SELECTED_SUMMARY_ID,Args:[e,t.SelectData]}},{Name:"区间放大",Data:{ID:v.CMD_SELECTED_ZOOM_ID,Args:[t.SelectData]}}],r={Menu:i,Position:JSPopMenu.POSITION_ID.RIGHT_MENU_ID,ClickCallback:function(t){a.OnClickRightMenu(t)}},n=t.X,o=t.Y;this.PopupMenuByRClick(r,n,o)},this.ReloadChartDrawPicture=function(){if(this.ChartDrawPicture=[],this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture=null,this.ChartDrawStorage){this.ChartDrawStorageCache=this.ChartDrawStorage.GetDrawData({Symbol:this.Symbol,Period:this.Period});var t=this.GetEventCallback(m.ON_LOAD_DRAWPICTURE);if(t&&t.Callback){var e={Symbol:this.Symbol,Period:this.Period,DrawStorage:this.ChartDrawStorage,ChartDrawStorageCache:this.ChartDrawStorageCache};t.Callback(t,e,this)}}},this.CreateChartDrawPictureByStorage=function(){if(sa.IsNonEmptyArray(this.ChartDrawStorageCache)){for(var t=0;t<this.ChartDrawStorageCache.length;++t){var e=this.ChartDrawStorageCache[t];if(!(e.FrameID<0||!this.Frame.SubFrame||this.Frame.SubFrame.length<e.FrameID)){var a=Ha.CreateChartDrawPicture(e);if(a){a.Canvas=this.Canvas,a.Status=10,a.Frame=this.Frame.SubFrame[e.FrameID].Frame,a.Option=this.ChartDrawOption,a.ImportStorageData&&a.ImportStorageData(e),a.UpdateXValue(),a.ValueToPoint();var i=this;a.GetActiveDrawPicture=function(){return i.GetActiveDrawPicture()},this.ChartDrawPicture.push(a)}}}this.ChartDrawStorageCache=null}},this.UpdataChartInfo=function(){var t=null;if(0==this.Period)for(var e in t=new Map,this.ChartInfo){var a=this.ChartInfo[e].Data;for(var i in a){var r=a[i];t.has(r.Date.toString())?t.get(r.Date.toString()).Data.push(r):t.set(r.Date.toString(),{Data:new Array(r)})}}else if(dt.IsDayPeriod(this.Period,!1)){t=new Map;var n=this.ChartPaint[0].Data;if(n&&n.Data&&n.Data.length>0){var o=n.Data[0],s=[];for(var e in this.ChartInfo){var h=this.ChartInfo[e];for(var i in h.Data){r=h.Data[i];r.Date>=o.Date&&s.push(r)}}s.sort((function(t,e){return t.Date-e.Date}));for(e=0;e<n.Data.length;){var l=n.Data[e];if(s.length<=0)break;h=s[0];l.Date<h.Date?++e:(t.has(l.Date.toString())?t.get(l.Date.toString()).Data.push(h):t.set(l.Date.toString(),{Data:new Array(h)}),s.shift())}}}else if(dt.IsMinutePeriod(this.Period,!0)){t=new Map;n=this.ChartPaint[0].Data;if(n&&n.Data&&n.Data.length>0){var u=n.Data[0];for(s=[],e=0,i=0;e<this.ChartInfo.length;++e){h=this.ChartInfo[e];for(i=0;i<h.Data.length;++i){r=h.Data[i];(r.Date>=u.Date||r.Date==u.Date&&r.Time>=u.Time)&&s.push(r)}}s.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date}));for(e=0;e<n.Data.length;){l=n.Data[e];if(s.length<=0)break;h=s[0];if(l.Date<h.Date||l.Date==h.Date&&l.Time<h.Time)++e;else{var C="".concat(l.Date,"-").concat(l.Time);t.has(C)?t.get(C).Data.push(h):t.set(C,{Data:new Array(h)}),s.shift()}}}}var D=this.ChartPaint[0];D.InfoData=t},this.RecvWindowIndex=function(t,e){var a=this.WindowIndex[t];if(a&&"function"==typeof a.RecvSubscribeData){var i=this.ChartPaint[0].Data;a.RecvSubscribeData(e,this,t,i)}},this.UpdateWindowIndex=function(t){var e=new dt;if(e.Data=this.SourceData.Data,e.Period=this.Period,e.Right=this.Right,this.IsApiPeriod);else{if(e.Right>0){var a=e.GetRightData(e.Right,{AlgorithmType:this.RightFormula});e.Data=a}if(dt.IsDayPeriod(e.Period,!1)||dt.IsMinutePeriod(e.Period,!1)){var i=e.GetPeriodData(e.Period);e.Data=i}}if("function"==typeof this.WindowIndex[t].ExecuteScript){var r=this.ChartPaint[0].Data;this.WindowIndex[t].ExecuteScript(this,t,r)}else if("function"==typeof this.WindowIndex[t].RequestData){r=this.ChartPaint[0].Data;this.WindowIndex[t].RequestData(this,t,r,null)}else this.WindowIndex[t].BindData(this,t,e);this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.GetOverlayIndexByIdentify=function(t){for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e];if(sa.IsNonEmptyArray(a.OverlayIndex))for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];if(r.Identify===t)return{OverlayItem:r,WindowIndex:e}}}return null},this.RecvOverlayIndex=function(t,e){var a=this.GetOverlayIndexByIdentify(t);if(null!=a){if(a.Script&&"function"==typeof a.RecvSubscribeData&&this.ChartPaint[0]){var i=this.ChartPaint[0].Data;i&&a.Script.RecvSubscribeData(e,this,a.WindowIndex,i)}}else console.warn("[KLineChartContainer::RecvOverlayIndex] can't find overlay index. [identify=".concat(t,"]"))},this.UpdateOverlayIndex=function(t){var e=this.GetOverlayIndexByIdentify(t);if(null!=e){if(this.ChartPaint[0]){var a=this.ChartPaint[0].Data;a&&this.BindOverlayIndexData(e.OverlayItem,e.WindowIndex,a)}}else console.warn("[KLineChartContainer::UpdateOverlayIndex] can't find overlay index. [identify=".concat(t,"]"))},this.ChangeWindowIndexParam=function(t){this.WindowIndex[t].Index[0].Param+=1,this.WindowIndex[t].Index[1].Param+=1,this.UpdateWindowIndex(t)},this.OnDoubleClick=function(t,e,a){var i,r=!1;if(this.ChartCorssCursor){var n={e:a,X:t,Y:e,Draw:!1};this.ChartCorssCursor.OnDBClick(n),r=n.Draw}if(this.EnableYDrag&&(this.EnableYDrag.Left||this.EnableYDrag.Right)&&this.Frame&&this.Frame.PtInFrameY){var o=F(),s=(t=(a.clientX-this.UIElement.getBoundingClientRect().left)*o,e=(a.clientY-this.UIElement.getBoundingClientRect().top)*o,this.Frame.PtInFrameY(t,e));s&&s.Index>=0&&this.CancelZoomUpDownFrameY(s)}this.SelectedChart.EnableSelected&&(i=this.PtInChart(t,e));var h={SelectedChart:i};if(this.DBClickEvent(h,a),!i&&this.EnableZoomIndexWindow){var l=this.Frame.PtInFrame(t,e);if(u.Chart.Log("[KLineChartContainer::OnDoubleClick] frameId",l),l>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(l,{X:t,Y:e}))return this.Frame.SetSizeChage(!0),this.Draw(),!0}r&&this.Draw();var C=new pt;if((this.PtInChartPaintTooltip(t,e,C)||this.PtInOverlayIndexTooltip(t,e,C))&&C.Data){var D=null;if(this.mapEvent.has(m.DBCLICK_KLINE)&&(D=this.mapEvent.get(m.DBCLICK_KLINE)),D){null!=this.ClickChartTimer&&(clearTimeout(this.ClickChartTimer),this.ClickChartTimer=null);n={Tooltip:C,Stock:{Symbol:this.Symbol,Name:this.Name},X:a.clientX,Y:a.clientY,PreventDefault:!1};if(D.Callback(D,n,this),n.PreventDefault)return}this.PopMinuteChart&&0===C.Type&&this.ShowMinuteChartDialog({Chart:this,Tooltip:C,e:a},t,e)}},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var e=this,a=Pr.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),i):2==a&&(this.AutoUpdateTimer=setTimeout((function(){dt.IsDayPeriod(e.Period,!0)?e.RequestRealtimeData():dt.IsMinutePeriod(e.Period,!0)||dt.IsSecondPeriod(e.Period)||dt.IsMilliSecondPeriod(e.Period)?e.RequestMinuteRealtimeData():dt.IsTickPeriod(e.Period)&&e.RequestTickRealtimeData()}),i))}else this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),2e4)}},this.GetMaxMinPageSize=function(){var t={},e=this.Frame.ChartBorder.GetWidth(),a=Et[Et.length-1][0]+Et[Et.length-1][1];return t.Max=parseInt(e/a)-2,a=Et[0][0]+Et[0][1],t.Min=parseInt(e/a)-2,u.Chart.Log("[KLineChartContainer::GetMaxMinPageSize] Max=".concat(t.Max," Min=").concat(t.Min)),t},this.GetChartStatus=function(){var t=this.Frame.SubFrame[0].Frame;if(!t)return null;var e=t.Data;if(!e)return null;var a={KLine:{},Zoom:{}};return a.KLine.Count=e.Data.length,a.KLine.Offset=e.DataOffset,a.KLine.PageSize=t.XPointCount,a.Zoom.Index=t.ZoomIndex,a.Zoom.Max=Et.length,a},this.DragDownloadData=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;if(!(t.DataOffset>0))if(dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)){if(u.Chart.Log("[KLineChartContainer.DragDownloadData] Minute:[Enable=".concat(this.DragDownload.Minute.Enable,", IsEnd=").concat(this.DragDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,", Period=").concat(this.Period,"]")),!this.DragDownload.Minute.Enable)return;if(this.DragDownload.Minute.IsEnd)return;if(0!=this.DragDownload.Minute.Status)return;this.RequestDragMinuteData()}else if(dt.IsDayPeriod(this.Period,!0)){if(u.Chart.Log("[KLineChartContainer.DragDownloadData] Day:[Enable=".concat(this.DragDownload.Minute.Enable,", IsEnd=").concat(this.DragDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,"]")),!this.DragDownload.Day.Enable)return;if(this.DragDownload.Day.IsEnd)return;if(0!=this.DragDownload.Day.Status)return;this.RequestDragDayData()}else if(dt.IsTickPeriod(this.Period)){if(u.Chart.Log("[KLineChartContainer.DragDownloadData] Tick:[Enable=".concat(this.DragDownload.Tick.Enable,", IsEnd=").concat(this.DragDownload.Tick.IsEnd,", Status=").concat(this.DragDownload.Tick.Status,"]")),!this.DragDownload.Tick.Enable)return;if(this.DragDownload.Tick.IsEnd)return;if(0!=this.DragDownload.Tick.Status)return;this.RequestDragTickData()}},this.ZoomDownloadData=function(t){var e=null;if(e=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!e)return!1;if(!(e.DataOffset>0))if(dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)){if(u.Chart.Log("[KLineChartContainer.ZoomDownloadData] Minute:[Enable=".concat(this.ZoomDownload.Minute.Enable,", IsEnd=").concat(this.ZoomDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,", Period=").concat(this.Period,"]")),!this.ZoomDownload.Minute.Enable)return;if(this.ZoomDownload.Minute.IsEnd)return;if(0!=this.ZoomDownload.Minute.Status)return;this.RequestZoomMinuteData(t)}else if(dt.IsDayPeriod(this.Period,!0)){if(u.Chart.Log("[KLineChartContainer.ZoomDownloadData] Day:[Enable=".concat(this.ZoomDownload.Minute.Enable,", IsEnd=").concat(this.ZoomDownload.Minute.IsEnd,", Status=").concat(this.DragDownload.Minute.Status,"]")),!this.ZoomDownload.Day.Enable)return;if(this.ZoomDownload.Day.IsEnd)return;if(0!=this.ZoomDownload.Day.Status)return;this.RequestZoomDayData(t)}else if(dt.IsTickPeriod(this.Period)){if(u.Chart.Log("[KLineChartContainer.ZoomDownloadData] Tick:[Enable=".concat(this.ZoomDownload.Tick.Enable,", IsEnd=").concat(this.ZoomDownload.Tick.IsEnd,", Status=").concat(this.DragDownload.Tick.Status,"]")),!this.ZoomDownload.Tick.Enable)return;if(this.ZoomDownload.Tick.IsEnd)return;if(0!=this.ZoomDownload.Tick.Status)return;this.RequestZoomTickData(t)}},this.RequestDragTickData=function(){u.Chart.Log("[KLineChartContainer.RequestDragTickData] not finished.")},this.RequestPreviousMinuteData=function(t){var e=t.FuncName,a=t.FuncExplain,i=t.Download,r=t.Url,n=t.Count,o=this;this.AutoUpdateEvent(!1,e),this.CancelAutoUpdate(),i.Status=1;var s=null;s=sa.IsNonEmptyArray(this.SourceData.Data)?this.SourceData.Data[0]:{Date:null,Time:null};var h={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:o.Symbol,enddate:s.Date,endtime:s.Time,count:n,first:{date:s.Date,time:s.Time}};if(sa.IsNonEmptyArray(this.OverlayChartPaint)){h.overlay=[];for(var l=0;l<this.OverlayChartPaint.length;++l){var u=this.OverlayChartPaint[l];h.overlay.push({symbol:u.Symbol})}}if(this.NetworkFilter){var C={Name:e,Explain:a,Request:{Url:r,Type:"POST",Data:h,Period:this.Period,Right:this.Right},DragDownload:i,Option:t,Self:this,PreventDefault:!1,ZoomData:t.ZoomData};if(this.NetworkFilter(C,(function(a){o.RecvPreviousMinuteData(a,t),i.Status=0,o.AutoUpdateEvent(!0,e),o.AutoUpdate()})),1==C.PreventDefault)return}io.HttpRequest({url:r,data:h,type:"post",dataType:"json",async:!0,success:function(a){o.RecvPreviousMinuteData(a,t),i.Status=0,o.AutoUpdateEvent(!0,e),o.AutoUpdate()}})},this.RecvPreviousMinuteData=function(t,e){var a=e.Download,i=or.JsonDataToMinuteHistoryData(t);if(!i||i.length<=0)return a.IsEnd=!0,u.Chart.Log("[KLineChartContainer.RecvPreviousMinuteData] ".concat(this.Symbol," data end. FuncName=").concat(e.FuncName)),void this.Draw();var r=this.GetHistoryDataCount(),n=null;if(sa.IsNonEmptyArray(this.SourceData.Data))for(var o=this.SourceData.Data[0],s=i.length-1;s>=0;--s){var h=i[s];if(o.Date>h.Date||o.Date==h.Date&&o.Time>h.Time){n=s;break}if(o.Date==h.Date&&o.Time==h.Time){o.YClose=h.YClose,n=s-1;break}}else n=i.length-1;if(!(null==n&&n<0)){for(s=0;s<i.length&&s<=n;++s){h=i[s];this.SourceData.Data.splice(s,0,h)}var l=new dt;if(l.Data=this.SourceData.Data,l.Period=this.Period,l.Right=this.Right,l.DataType=this.SourceData.DataType,l.Symbol=this.Symbol,!this.IsApiPeriod){if(l.Right>0&&this.RightFormula>=1){var C=l.GetRightData(l.Right,{AlgorithmType:this.RightFormula});l.Data=C}if(dt.IsDayPeriod(l.Period,!1)||dt.IsMinutePeriod(l.Period,!1)){var D=l.GetPeriodData(l.Period);l.Data=D}}var f=this.GetKLineCalulate();if(f){var c=f.RecvHistoryData(l,{Symbol:this.Symbol,Function:e.RecvFuncName});l=c,this.FlowCapitalReady=!0}if(this.UpdateMainData(l,r),e)if(e.ZoomData){var m=e.ZoomData,d=m.PageSize-m.RightSpaceCount;l.DataOffset=l.Data.length-d,l.DataOffset<0&&(l.DataOffset=0)}else sa.IsNumber(e.DataOffset)&&(l.DataOffset+=e.DataOffset,l.DataOffset<0&&(l.DataOffset=0));this.UpdateOverlayDragMinuteData(t),this.BindInstructionIndexData(l);for(s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,l);this.BindAllOverlayIndexData(l,{SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdateChartDrawXValue(),this.Draw(),this.BindAllOverlayIndexData(l,{SyncExecute:!1})}},this.RequestZoomMinuteData=function(t){var e={PageSize:t.PageSize,DataCount:t.DataCount,RightSpaceCount:t.RightSpaceCount},a={FuncName:"KLineChartContainer::RequestZoomMinuteData",FuncExplain:"缩放分钟|秒K线数据下载",RecvFuncName:"RecvZoomMinuteData",Download:this.ZoomDownload.Minute,Url:this.ZoomMinuteKLineApiUrl,Count:this.MaxRequestMinuteDayCount,XShowCount:this.Frame.GetXShowCount(),ZoomData:e};this.RequestPreviousMinuteData(a)},this.RequestDragMinuteData=function(){var t={FuncName:"KLineChartContainer::RequestDragMinuteData",FuncExplain:"拖拽分钟|秒K线数据下载",RecvFuncName:"RecvDragMinuteData",Download:this.DragDownload.Minute,Url:this.DragMinuteKLineApiUrl,Count:this.MaxRequestMinuteDayCount,XShowCount:this.Frame.GetXShowCount()};this.RequestPreviousMinuteData(t)},this.MergeOverlaySymbolMinuteData=function(t,e){if(t.Symbol,!sa.IsNonEmptyArray(e))return!1;for(var a=null,i=0;i<e.length;++i){var r=e[i];if(r.symbol==t.Symbol){a=r;break}}if(!a)return!1;var n=or.JsonDataToMinuteHistoryData(a),o=t.SourceData,s=o.Data[0],h=null;for(i=n.length-1;i>=0;--i){var l=n[i];if(s.Date>l.Date){h=i;break}if(s.Date==l.Date&&s.Time>l.Time){h=i;break}if(s.Date==l.Date&&s.Time==l.Time){s.YClose=l.YClose,h=i-1;break}}if(null==h&&h<0)return!1;for(i=0;i<n.length&&i<=h;++i){l=n[i];o.Data.splice(i,0,l)}var u=new dt;u.Data=o.Data,u.Period=this.Period,u.Right=this.Right,u.DataType=0;e=this.SourceData.GetOverlayMinuteData(u.Data,this.IsApiPeriod);if(u.Data=e,dt.IsMinutePeriod(u.Period,!1)&&!this.IsApiPeriod){var C=u.GetPeriodData(u.Period);u.Data=C}return t.Data=u,!0},this.UpdateOverlayDragMinuteData=function(t){if(sa.IsNonEmptyArray(this.OverlayChartPaint))for(var e=t.overlay,a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];if(i.Symbol){var r=!1;if(i.MainData&&i.Status==Rt.STATUS_FINISHED_ID&&(r=this.MergeOverlaySymbolMinuteData(i,e)),!r&&i.Data&&sa.IsNonEmptyArray(i.Data.Data)){var n=i.Data,o=this.SourceData.GetOverlayMinuteData(n.Data,this.IsApiPeriod);n.Data=o}}}},this.RequestPreviousDayData=function(t){var e=t.FuncName,a=t.FuncExplain,i=t.Download,r=t.Url,n=t.Count,o=this;this.AutoUpdateEvent(!1,e),this.CancelAutoUpdate(),i.Status=1;var s=null;s=sa.IsNonEmptyArray(this.SourceData.Data)?this.SourceData.Data[0]:{Date:null};var h={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:o.Symbol,enddate:s.Date,count:n,first:{date:s.Date}};if(sa.IsNonEmptyArray(this.OverlayChartPaint)){h.overlay=[];for(var l=0;l<this.OverlayChartPaint.length;++l){var u=this.OverlayChartPaint[l];h.overlay.push({symbol:u.Symbol})}}if(this.NetworkFilter){var C={Name:e,Explain:a,Request:{Url:r,Type:"POST",Data:h,Period:this.Period,Right:this.Right},DragDownload:i,Option:t,Self:this,PreventDefault:!1,ZoomData:t.ZoomData};if(this.NetworkFilter(C,(function(a){o.RecvPreviousDayData(a,t),i.Status=0,o.AutoUpdateEvent(!0,e),o.AutoUpdate()})),1==C.PreventDefault)return}io.HttpRequest({url:r,data:h,type:"post",dataType:"json",async:!0,success:function(a){o.RecvPreviousDayData(a,t),i.Status=0,o.AutoUpdateEvent(!0,e),o.AutoUpdate()}})},this.RecvPreviousDayData=function(t,e){var a=e.Download,i=or.JsonDataToHistoryData(t);if(!i||i.length<=0)return a.IsEnd=!0,void u.Chart.Log("[KLineChartContainer.RecvPreviousDayData] ".concat(this.Symbol," data end. FuncName=").concat(e.FuncName));var r=this.GetHistoryDataCount(),n=null;if(sa.IsNonEmptyArray(this.SourceData.Data))for(var o=this.SourceData.Data[0],s=i.length-1;s>=0;--s){var h=i[s];if(o.Date>h.Date){n=s;break}if(o.Date==h.Date){o.YClose=h.YClose,n=s-1;break}}else{o={Date:null};n=i.length-1}if(!(null==n&&n<0)){for(s=0;s<i.length&&s<=n;++s){h=i[s];this.SourceData.Data.splice(s,0,h)}var l=new dt;if(l.Data=this.SourceData.Data,l.Period=this.Period,l.Right=this.Right,l.DataType=this.SourceData.DataType,l.Symbol=this.Symbol,!this.IsApiPeriod){if(l.Right>0){var C=l.GetRightData(l.Right,{AlgorithmType:this.RightFormula});l.Data=C}if(dt.IsDayPeriod(l.Period,!1)||dt.IsMinutePeriod(l.Period,!1)){var D=l.GetPeriodData(l.Period);l.Data=D}}var f=this.GetKLineCalulate();if(f){var c=f.RecvHistoryData(l,{Symbol:this.Symbol,Function:e.RecvFuncName});l=c,this.FlowCapitalReady=!0}if(this.UpdateMainData(l,r),e)if(e.ZoomData){var m=e.ZoomData,d=m.PageSize-m.RightSpaceCount;l.DataOffset=l.Data.length-d,l.DataOffset<0&&(l.DataOffset=0)}else sa.IsNumber(e.DataOffset)&&(l.DataOffset+=e.DataOffset,l.DataOffset<0&&(l.DataOffset=0));this.UpdateOverlayDragDayData(t),this.BindInstructionIndexData(l);for(s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,l);this.BindAllOverlayIndexData(l,{SyncExecute:!0}),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdateChartDrawXValue(),this.Draw(),this.ReqeustKLineInfoData({FunctionName:e.RecvFuncName,StartDate:o.Date}),this.BindAllOverlayIndexData(l,{SyncExecute:!1})}},this.RequestZoomDayData=function(t){var e=this.MaxRequestDataCount;t.Count>e&&(e=t.Count);var a={PageSize:t.PageSize,DataCount:t.DataCount,RightSpaceCount:t.RightSpaceCount},i={FuncName:"KLineChartContainer::RequestZoomDayData",FuncExplain:"缩放日K数据下载",RecvFuncName:"RecvZoomDayData",Download:this.ZoomDownload.Day,Url:this.ZoomKLineApiUrl,XShowCount:this.Frame.GetXShowCount(),Count:e,ZoomData:a};this.RequestPreviousDayData(i)},this.RequestDragDayData=function(){var t={FuncName:"KLineChartContainer::RequestDragDayData",FuncExplain:"拖拽日K数据下载",RecvFuncName:"RecvDragDayData",Download:this.DragDownload.Day,Url:this.DragKLineApiUrl,Count:this.MaxRequestDataCount,XShowCount:this.Frame.GetXShowCount()};this.RequestPreviousDayData(t)},this.MergeOverlaySymbolDayData=function(t,e){if(!t.Symbol)return!1;if(!sa.IsNonEmptyArray(e))return!1;for(var a=null,i=0;i<e.length;++i){var r=e[i];if(r.symbol==t.Symbol){a=r;break}}if(!a)return!1;var n=or.JsonDataToHistoryData(a),o=t.SourceData,s=o.Data[0],h=null;for(i=n.length-1;i>=0;--i){var l=n[i];if(s.Date>l.Date){h=i;break}if(s.Date==l.Date){s.YClose=l.YClose,h=i-1;break}}if(null==h&&h<0)return!1;for(i=0;i<n.length&&i<=h;++i){l=n[i];o.Data.splice(i,0,l)}var u=new dt;if(u.Data=o.Data,u.Period=this.Period,u.Right=this.Right,u.DataType=0,u.Right>0&&Pr.IsSHSZStockA(a.symbol)&&!this.IsApiPeriod){var C=u.GetRightData(u.Right,{AlgorithmType:this.RightFormula});u.Data=C}e=this.SourceData.GetOverlayData(u.Data,this.IsApiPeriod);if(u.Data=e,dt.IsDayPeriod(u.Period,!1)&&!this.IsApiPeriod){var D=u.GetPeriodData(u.Period);u.Data=D}return t.Data=u,!0},this.UpdateOverlayDragDayData=function(t){if(sa.IsNonEmptyArray(this.OverlayChartPaint))for(var e=t.overlay,a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];if(i.Symbol){var r=!1;if(i.MainData&&i.Status==Rt.STATUS_FINISHED_ID&&(r=this.MergeOverlaySymbolDayData(i,e)),!r&&i.Data&&sa.IsNonEmptyArray(i.Data.Data)){var n=i.Data,o=this.SourceData.GetOverlayData(n.Data,this.IsApiPeriod);n.Data=o}}}},this.SetCustomVerical=function(t,e){if(this.Frame&&!(t>=this.Frame.SubFrame.length)){var a=this.Frame.SubFrame[t];a.Frame&&(a.Frame.CustomVerticalInfo=e)}},this.OnSize=function(){if(this.Frame&&this.Frame.OnSize){var t=this.Frame.OnSize();this.Frame.SetSizeChage(!0),t.Changed&&(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(2),this.UpdateFrameMaxMin()),this.Draw()}},this.ClickFrameButton=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_FRAME_TOOLBAR);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}if(t.ID==S.CLOSE_OVERLAY_INDEX){var r=t.IndexID;r&&this.DeleteOverlayWindowsIndex(r)}else if(t.ID==S.MODIFY_OVERLAY_INDEX_PARAM){r=t.IndexID;var n=t.Frame,o={e:e,WindowIndex:n.Identify,Type:2,Identify:r};this.ShowModifyIndexParamDialog(o)}else if(t.ID==S.CLOSE_INDEX_WINDOW){n=t.Frame;this.RemoveIndexWindow(n.Identify)}else if(t.ID==S.CHANGE_INDEX){n=t.Frame,o={e:e,WindowIndex:n.Identify,OpType:1};this.ShowChangeIndexDialog(o)}else if(t.ID==S.MODIFY_INDEX_PARAM){n=t.Frame,o={e:e,WindowIndex:n.Identify,Type:1};this.ShowModifyIndexParamDialog(o)}else if(t.ID==S.OVERLAY_INDEX){n=t.Frame,o={e:e,WindowIndex:n.Identify,OpType:2};this.ShowAddOverlayIndexDialog(o)}else if(t.ID==S.MAX_MIN_WINDOW){r=t.IndexID,n=t.Frame;var s=t.FrameID;s>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(s,null)&&(this.Frame.SetSizeChage(!0),this.Draw())}else if(t.ID==S.TITLE_WINDOW){r=t.IndexID,n=t.Frame,s=t.FrameID;this.ShowIndexTitleOnly(s)&&(this.Frame.SetSizeChage(!0),this.Draw())}else if(t.ID==S.EXPORT_DATA){i=this.ExportData({Type:"CSV"});if(!i)return;var h=Date.now(),l="hqchart_".concat(this.Symbol,"_").concat(h,".csv"),u=document.createElement("a"),C=new Blob([i],{type:"text/csv"});u.href=URL.createObjectURL(C),document.body.appendChild(u),u.setAttribute("download",l),u.click(),document.body.removeChild(u)}else if(t.ID==S.ADD_INDEX_WINDOW){var D=["CCI","CHO","ADTM","BIAS36","MACD"],f=this.Frame.SubFrame.length+1,c=D[f%D.length];this.AddIndexWindow(c)}},this.ClickTitleButton=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_TITLE_BUTTON);if(a&&a.Callback){var i={Info:t,PreventDefault:!1,e:e};if(a.Callback(a,i,this),i.PreventDefault)return}},this.ClickExtendChartButton=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_EXTENDCHART_BUTTON);if(a&&a.Callback){var i={Info:t,PreventDefault:!1,e:e};if(a.Callback(a,i,this),i.PreventDefault)return}t.ID==S.CHIP_DEFULT?(t.Chart.ShowType=0,this.Draw()):t.ID==S.CHIP_LONG?(t.Chart.ShowType=1,this.Draw()):t.ID==S.CHIP_RECENT?(t.Chart.ShowType=2,this.Draw()):t.ID==S.CHIP_CLOSE&&this.DeleteStockChipChart&&this.DeleteStockChipChart()},this.RequestVolumeProfileData=function(t){var e=this,a=t.Chart;if(this.NetworkFilter){var i={Name:"KLineChartContainer::RequestVolumeProfileData",Explain:"成交量分布图下载",Request:{Period:this.Period,Right:this.Right,Start:t.Start,End:t.End,Symbol:this.Symbol,ValueAreaVol:t.ValueAreaVol},Self:this,VolProfile:a,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvVolumeProfileData(t,a)})),1==i.PreventDefault)return}},this.RecvVolumeProfileData=function(t,e){e.OnRecvVolumeProfileData(t),this.Draw()},this.ExportMainData=function(t,e){var a=t.ExportKLineData(e);return a},this.UpdateScrollBar=function(){if(this.ScrollBar){var t=this.GetChartStatus();if(t){var e=this.ChartPaint[0].Data,a=t.KLine.Offset,i=a+t.KLine.PageSize-1,r={Start:a,End:i,Data:e,Draw:!0,RightSpaceCount:this.RightSpaceCount};if(this.Frame&&this.Frame.ChartBorder){var n=this.Frame.ChartBorder;r.Border={Left:n.Left,Right:n.Right}}this.ScrollBar.UpdateSlider(r)}}},this.ResetScrollBar=function(){this.ScrollBar&&this.ScrollBar.Reset({Draw:!0})},this.ChangePriceGap=function(t){if(t){var e=this.ChartPaint[0];e&&(sa.IsNumber(t.Count)&&(e.PriceGap.Count=t.Count),sa.IsBool(t.Enable)&&(e.PriceGap.Enable=t.Enable),this.Draw())}},this.DrawTooltipDialog=function(){this.DialogTooltip&&this.UpdateTooltipDialog()},this.UpdateTooltipDialog=function(){if(!this.DialogTooltip)return!1;if(!this.ChartCorssCursor)return!1;var t=0,e=null,a=-1;if(this.ChartCorssCursor.ClientPos>=0){var i=this.ChartOperator_Temp_GetHistoryData();if(!i)return!1;if(!sa.IsNonEmptyArray(i.Data))return!1;a=i.DataOffset+this.ChartCorssCursor.CursorIndex,a>=i.Data.length&&(a=i.Data.length-1);e=i.Data[a]}else{i=this.ChartOperator_Temp_GetHistoryData();if(!i)return!1;if(!sa.IsNonEmptyArray(i.Data))return!1;e=i.Data[i.Data.length-1];var r={Symbol:this.Symbol,Date:e.Date};if(sa.IsNumber(e.Time)&&(r.Time=e.Time),!this.DialogTooltip.IsEqualDataID(r))return!1;a=i.Data.length-1,t=1}var n={DataType:t,ClientPos:this.ChartCorssCursor.ClientPos,IsShowCorss:this.ChartCorssCursor.IsShowCorss,KItem:e,Symbol:this.Symbol,Name:this.Name,LastValue:this.ChartCorssCursor.LastValue,DataIndex:a};return this.DialogTooltip.Update(n),!0},this.DrawSelectRectDialog=function(t){this.DialogSelectRect&&this.UpdateSelectRectDialog(t)},this.UpdateSelectRectDialog=function(t){if(!this.DialogSelectRect)return!1;var e,a,i=t.data;if(i&&sa.IsNumber(i.X)&&sa.IsNumber(i.Y)){F();var r=this.UIElement.getBoundingClientRect(),n=w();e=i.X,a=i.Y,e+=r.left+n.Left,a+=r.top+n.Top}var o={Symbol:this.Symbol,Name:this.Name,SelectData:i.SelectData,X:e,Y:a,e:t};this.DialogSelectRect.Update(o)},this.UpdateHQFloatTooltip=function(t){if(this.FloatTooltip&&this.FloatTooltip.IsShow()&&t&&sa.IsNonEmptyArray(t.Data)){var e=t.Data[t.Data.length-1];if(e){var a={Symbol:t.Symbol,Date:e.Date,Time:e.Time};if(this.FloatTooltip.IsEqualHQID(a)){var i={Data:e,Symbol:this.Symbol,Name:this.Name,DataType:2};this.FloatTooltip.Update(i)}}}},this.GetKData=function(){if(!this.ChartPaint[0])return null;var t=this.ChartPaint[0].Data;return t||null},this.UnlockCorssCursor=function(t){var e=this.GlobalOption.LockCorssCursor.X;e.Enable=!1,e.KLine=null,t&&t.Draw&&this.Draw()},this.LockCorssCursor=function(t){if(t&&t.KItem){var e=this.GetKData();if(!e||!sa.IsNonEmptyArray(e.Data))return!1;var a={Date:t.KItem.Date,Time:t.KItem.Time,Index:-1};if(e.FindDataIndexByDateTime([a]),a.Index<0)return!1;var i=this.GlobalOption.LockCorssCursor.X;i.KLine={DataIndex:a.Index,Date:a.Date,Time:a.Time},i.Enable=!0}else{if(this.CursorIndex<0)return!1;e=this.GetKData();if(!e||!sa.IsNonEmptyArray(e.Data))return!1;var r=e.DataOffset+parseInt(this.CursorIndex.toFixed(0));a=e.Data[r];if(!a)return!1;i=this.GlobalOption.LockCorssCursor.X;i.KLine={DataIndex:r,Date:a.Date,Time:a.Time},i.Enable=!0}return t&&t.Draw&&this.Draw(),!0},this.GetCorssCursorPosition=function(){var t={LastPoint:{X:this.LastPoint.X,Y:this.LastPoint.Y},CursorIndex:this.CursorIndex};if(!this.GlobalOption||!this.GlobalOption.LockCorssCursor)return t;var e=this.GlobalOption.LockCorssCursor.X;if(e.Enable&&e.KLine){var a=this.GetKData();if(!a||!sa.IsNonEmptyArray(a.Data))return t;t.CursorIndex=e.KLine.DataIndex-a.DataOffset,t.LastPoint.X=this.Frame.GetXFromIndex(t.CursorIndex,!1);var i=this.Frame.ChartBorder.GetBorder();if(t.LastPoint.Y<i.Top||t.LastPoint.Y>i.Bottom){var r=a.Data[e.KLine.DataIndex],n=this.Frame.SubFrame[0].Frame.GetYFromData(r.Close);t.LastPoint.Y=n}}return t},this.GetDateTimeByPoint=function(t,e){var a=this.PtInClient(t,e);if(a<0)return null;if(sa.IsNumber(t)){if(!sa.IsNonEmptyArray(this.Frame.SubFrame))return null;var i=this.Frame.SubFrame[0].Frame;if(!i)return null;var r=this.GetKData();if(!r||!sa.IsNonEmptyArray(r.Data))return null;var n=parseInt(i.GetXData(t)),o=n+r.DataOffset;if(o<0||o>=r.Data.length)return null;var s=r.Data[o];if(!s)return null;var h={Date:s.Date,Time:s.Time,DataIndex:o,Index:n,ClientPos:a};return h}},this.FixCursorIndexValid=function(){var t=this.GetKData();if(!t||!sa.IsNonEmptyArray(t.Data))return!1;var e=this.CursorIndex+t.DataOffset;return e>=t.Data.length&&(this.CursorIndex=t.Data.length-t.DataOffset-1,!0)}}function sr(t,e,a){this.newMethod=g,this.newMethod(t,e,a),delete this.newMethod,this.ClassName="MinuteChartContainer",this.WindowIndex=new Array,this.Symbol,this.AryDate,this.Name,this.SourceData,this.IndexBindData,this.IsAutoUpdate=!0,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.TradeDate=0,this.DayCount=1,this.MaxDayCount=-1,this.DayData,this.LimitPrice,this.IsShowBeforeData=!1,this.BeforeOpenData=null,this.IsBeforeData=!1,this.IsShowAfterData=!1,this.AfterCloseData=null,this.IsAfterData=!1,this.ShareAfterVol=0,this.ExtendWidth={Left:120,Right:120},this.IsShowLead=!0,this.IsShowMultiDayBeforeData=!1,this.MultiDayBeforeOpenData=null,this.IsShowMultiDayAfterData=!1,this.MultiDayAfterCloseData=null,this.MultiDayExtendWidth={Left:40,Right:20},this.ChartDrawStorage=new zi,this.ChartDrawStorageCache=null,this.MinuteApiUrl=qi.Domain+"/API/Stock",this.HistoryMinuteApiUrl=qi.Domain+"/API/StockMinuteData",this.ColorLineData,this.CorssCursorIndex={DayIndex:-1,DataIndex:-1,Point:{X:-1,Y:-1},Type:-1},this.EnableNewIndex=!1,this.DayOffset={Offset:0,ShowDayCount:-1,DataOffset:0,DayCount:1},this.PageInfo={Enable:!1,Offset:-8888,ShowDayCount:4},this.DataStatus={MultiDay:!1,LatestDay:!1,LatestDate:null},this.ZoomStepPixel=50,this.BaselineType=0,this.EnableNightDayBG=!1,this.AryHotKey=[{KeyID:87,SecondKeyID:3,CMD:v.CMD_FULLSCREEN_SUMMARY_ID,Args:null,Description:"Alt+W\t全屏区间统计"}],this.SetCallCationDataBorder=function(t){if(t){var e={Left:t.Left?this.ExtendWidth.Left:0,Right:t.Right?this.ExtendWidth.Right:0};if(this.Frame.SetExtendWidth(e),t.MultiDay){var a=t.MultiDay,i={Left:a.Left?this.MultiDayExtendWidth.Left:0,Right:a.Right?this.MultiDayExtendWidth.Right:0};this.Frame.SetMultiDayMinuteWidth(i)}}},this.ReloadChartPaint=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&(a.ReloadResource&&a.ReloadResource(t),0==e?"Minute-Line"==a.Name&&(a.Color=qi.Minute.PriceColor,a.AreaColor=qi.Minute.AreaPriceColor):1==e?"Minute-Average-Line"==a.Name&&(a.Color=qi.Minute.AvPriceColor):2==e&&"Minute-Vol-Bar"==a.Name&&(a.Color=qi.Minute.VolBarColor))}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.ClickFrameButton=function(t,e){var a=this.GetEventCallback(m.ON_CLICK_FRAME_TOOLBAR);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}if(t.ID==S.CLOSE_BEFOREOPEN_ID)this.ShowCallAuctionData({Left:!1,Right:!1,MultiDay:{Left:!1,Right:!1}});else if(t.ID==S.CLOSE_OVERLAY_INDEX){var r=t.IndexID;r&&this.DeleteOverlayWindowsIndex(r)}else if(t.ID==S.MODIFY_OVERLAY_INDEX_PARAM){r=t.IndexID;var n=t.Frame,o={e:e,WindowIndex:n.Identify,Type:2,Identify:r};this.ShowModifyIndexParamDialog(o)}else if(t.ID==S.CLOSE_INDEX_WINDOW){n=t.Frame;this.RemoveIndexWindow(n.Identify)}else if(t.ID==S.CHANGE_INDEX){n=t.Frame,o={e:e,WindowIndex:n.Identify,OpType:1};this.ShowChangeIndexDialog(o)}else if(t.ID==S.MODIFY_INDEX_PARAM){n=t.Frame,o={e:e,WindowIndex:n.Identify,Type:1};this.ShowModifyIndexParamDialog(o)}else if(t.ID==S.OVERLAY_INDEX){n=t.Frame,o={e:e,WindowIndex:n.Identify,OpType:2};this.ShowAddOverlayIndexDialog(o)}else if(t.ID==S.MAX_MIN_WINDOW){r=t.IndexID,n=t.Frame;var s=t.FrameID;s>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(s,null)&&(this.Frame.SetSizeChage(!0),this.Draw())}else if(t.ID==S.TITLE_WINDOW){r=t.IndexID,n=t.Frame,s=t.FrameID;this.ShowIndexTitleOnly(s)&&(this.Frame.SetSizeChage(!0),this.Draw())}else if(t.ID==S.EXPORT_DATA){i=this.ExportData({Type:"CSV"});if(!i)return;var h=Date.now(),l="hqchart_".concat(this.Symbol,"_").concat(h,".csv"),u=document.createElement("a"),C=new Blob([i],{type:"text/csv"});u.href=URL.createObjectURL(C),document.body.appendChild(u),u.setAttribute("download",l),u.click(),document.body.removeChild(u)}else if(t.ID==S.ADD_INDEX_WINDOW){var D=["CCI","CHO","ADTM","BIAS36","MACD"],f=this.Frame.SubFrame.length+1,c=D[f%D.length];this.AddIndexWindow(c)}},this.ChartOperator=function(t){var e=t.ID;if(e===d.OP_SCROLL_LEFT||e===d.OP_SCROLL_RIGHT){if(1==this.DayCount)return!1;if(!this.PageInfo.Enable)return!1;if(!this.DayData)return!1;var a=e===d.OP_SCROLL_LEFT,i=1;if(t.Step>0&&(i=t.Step),!this.DayOffset)return!1;if(a){var r=this.DayOffset.Offset;if(r+=i,r+this.DayOffset.ShowDayCount>this.DayOffset.DayCount&&(r=this.DayOffset.DayCount-this.DayOffset.ShowDayCount),r==this.DayOffset.Offset)return!1;this.DayOffset.Offset=r}else{r=this.DayOffset.Offset;if(r-=i,r<0&&(r=0),r==this.DayOffset.Offset)return!1;this.DayOffset.Offset=r}return this.UpdateHistoryMinuteUI(null),this.SendPageChangedEvent(),!0}if(e==d.OP_SCROLL_GOTO){if(1==this.DayCount)return!1;if(!this.PageInfo.Enable)return!1;if(!this.DayData)return!1;if(sa.IsNumber(t.ShowDayCount)&&(this.PageInfo.ShowDayCount=t.ShowDayCount,this.DayOffset.ShowDayCount=t.ShowDayCount),sa.IsNumber(t.Offset)){r=t.Offset;if(this.DayOffset.ShowDayCount>0&&r+this.DayOffset.ShowDayCount>=this.DayOffset.DayCount&&(r=this.DayOffset.DayCount-this.DayOffset.ShowDayCount),r==this.DayOffset.Offset)return!1;this.DayOffset.Offset=r}return this.UpdateHistoryMinuteUI(null),this.SendPageChangedEvent(),!0}if(e==d.OP_CORSSCURSOR_GOTO){if(!this.SourceData)return!1;if(!this.Frame||!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return!1;var n=this.Frame.SubFrame[0].Frame;if(!sa.IsNonEmptyArray(this.SourceData.Data))return!1;if(sa.IsNumber(t.Time)&&sa.IsNumber(t.Date)){for(var o=-1,s=null,h=null,l=0;l<this.SourceData.Data.length;++l){var u=this.SourceData.Data[l];if(sa.IsNumber(u.Close)&&(h=u.Close),u.Time==t.Time&&u.Date==t.Date){o=l,s=u.Close;break}}if(o<0&&1==this.DayCount&&!(sa.IsNumber(t.Type)&&t.Type>0)){var C=_r.GetTimeData(this.Symbol);for(l=0;l<C.length;++l)if(C[l]==t.Time){o=l,s=h;break}}if(o<0){if(1==t.Type){var D=-1,f=-1,c={X:D,Y:f,IsInClient:this.IsMouseOnClient(D,f)};this.LastMouseStatus.OnMouseMove=c,this.LastMouseStatus.MoveOnPoint={X:D,Y:f};var I=this.GetEventCallback(m.ON_MOUSE_MOVE),S=this.TitlePaint[0];I&&S&&(S.OnMouseMoveEvent=I);var T={clientX:D,clientY:f};this.MoveOnPoint={X:D,Y:f},this.OnMouseMove(D,f,T),this.LastMouseStatus.MoveOnPoint=null,S&&(S.OnMouseMoveEvent=null)}return}}D=n.GetXFromIndex(o),f=n.GetYFromData(s),c={X:D,Y:f,IsInClient:this.IsMouseOnClient(D,f)};this.LastMouseStatus.OnMouseMove=c,this.LastMouseStatus.MoveOnPoint={X:D,Y:f};I=this.GetEventCallback(m.ON_MOUSE_MOVE),S=this.TitlePaint[0];I&&S&&(S.OnMouseMoveEvent=I),this.MoveOnPoint={X:D,Y:f},this.OnMouseMove(D,f,{}),this.LastMouseStatus.MoveOnPoint=null,S&&(S.OnMouseMoveEvent=null)}},this.SendPageChangedEvent=function(){var t=this.GetEventCallback(m.ON_MINUTE_PAGE_CHANGED);if(t&&t.Callback){var e={DayOffset:this.DayOffset,DayData:this.DayData};t.Callback(t,e,this)}},this.IsMouseOnClient=function(t,e){var a=this.Frame.IsHScreen?this.Frame.ChartBorder.GetHScreenBorder():this.Frame.ChartBorder.GetBorder(),i={Left:a.Left,Top:a.Top,Right:a.Right,Bottom:a.Bottom};return t>=i.Left&&t<=i.Right&&e>=i.Top&&e<=i.Bottom},this.GetChartMinuteBuySellBar=function(){var t=this.ChartPaint[3];return t?"Minute-BuySell-Bar"!=t.Name?null:t:null},this.IsShowMinuteBuySellBar=function(){var t=this.GetChartMinuteBuySellBar();return!!t&&t.IsShow},this.OnDragMode_One=function(t,e){var a=this.MouseDrag,i=t.X,r=t.Y,n=!0;if(this.UpDownDrag&&this.UpDownDrag.Index>=0){if(r>=5){var o=e.clientY-a.LastMove.Y;u.Chart.Log("[MinuteChartContainer::OnDragMode_One] UpDownDrag ",this.UpDownDrag,o),this.SetCursor({Cursor:"pointer"}),this.OnUpDonwFrameY(this.UpDownDrag,o)&&(a.LastMove.Y=e.clientY,n=!0)}}else if(this.RectSelectDrag&&this.RectSelectDrag.Index>=0){if(i<5)return;var s={X:e.clientX,Y:e.clientY,PointIndex:this.RectSelectDrag.Index,Name:"MoveRectSelectLine"};this.MoveRectSelectPoint(s)&&(a.LastMove.X=e.clientX,n=!0)}else{if(i<5&&r<5)return;if(this.ChartDragSelectRect&&!this.ChartDragSelectRect.Enable)return;this.SetCursor({Cursor:"default"});var h=this.PointAbsoluteToRelative(a.Click.X,a.Click.Y),l=this.PointAbsoluteToRelative(e.clientX,e.clientY);this.ShowDragSelectRect(h,l),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}n&&this.Draw()},this.OnMinuteSelectRectMouseUp=function(e){var a=this.IsEnableRSelectRect(e,"DocOnMouseUp"),i=this.IsEnableLSelectRect(e,"DocOnMouseUp"),r=this.MouseDrag;r.LastMove.X=e.clientX,r.LastMove.Y=e.clientY;var n=new H,o=F();n.XStart=(r.Click.X-t.getBoundingClientRect().left)*o,n.YStart=(r.Click.Y-t.getBoundingClientRect().top)*o,n.XEnd=(r.LastMove.X-t.getBoundingClientRect().left)*o,n.YEnd=(r.LastMove.Y-t.getBoundingClientRect().top)*o,n.JSChartContainer=this,n.Stock={Symbol:this.Symbol,Name:this.Name},this.UpDownDrag||((a||i)&&!this.BorderDrag&&this.GetSelectRectData(n)?this.FinishSelectRect(n,e):(this.TryClickPaintEvent(m.ON_CLICKUP_CHART_PAINT,this.ClickDownPoint,e),this.ClickEvent(e)))},this.OnDragSelectRectMouseUp=function(t){var e=this.GetRectSelectPaint();if(e){var a=e.GetSelectRectData();if(a){var i=F(),r=this.ChartCorssCursor,n=r.LastPoint.X/i,o=r.LastPoint.Y/i,s=!0,h=this.GetEventCallback(m.ON_DRAG_SELECT_RECT_MOUSEUP);if(h){var l={X:n,Y:o,SelectData:a,RectSelectPaint:e,IsShowDialog:!1};h.Callback(h,l,this),s=l.IsShowDialog}if(s){l={Chart:this,X:n,Y:o,SelectData:a,RectSelectPaint:e};t.data=l,this.UpdateSelectRectDialog(t)}}}},this.UpdateSelectRect=function(t,e){if(this.SourceData&&this.SourceData.Data){var a=this.GetRectSelectPaint();if(a){var i=this.SourceData;if(i&&sa.IsNonEmptyArray(i.Data)){var r=i.Data.length,n=i.Data[t];e>=r&&(e=r-1);var o=i.Data[e];n&&o&&(u.Chart.Log("[MinuteChartContainer::UpdateSelectRect]",n,o),a.SetPoint(n,{Index:0,DataIndex:t}),a.SetPoint(o,{Index:1,DataIndex:e}),this.Draw())}}}},this.MoveRectSelectPoint=function(e){var a=this.GetRectSelectPaint();if(!a)return!1;if(!this.SourceData||!this.SourceData.Data)return!1;var i=this.SourceData;if(!this.Frame.SubFrame[0])return!1;var r=this.Frame.SubFrame[0].Frame,n=F(),o=(e.X-t.getBoundingClientRect().left)*n,s=r.GetXData(o);s=parseInt(s.toFixed(0));var h=s+i.DataOffset;h>=i.Data.length&&(h=i.Data.length-1);var l=i.Data[h];if(u.Chart.Log("[MinuteChartContainer::MoveRectSelectPoint] point, item",e.PointIndex,l),!a.SetPoint(l,{Index:e.PointIndex,DataIndex:h}))return!1;var C=this.GetEventCallback(m.ON_DRAG_SELECT_RECT);if(C){var D=a.GetSelectRectData(),f={X:e.X,Y:e.Y,SelectData:D,RectSelectPaint:a};C.Callback(C,f,this)}if(this.IsShowSelectRectDialog()){D=a.GetSelectRectData(),f={X:e.X,Y:e.Y,SelectData:D,RectSelectPaint:a};var c={data:f};this.DrawSelectRectDialog(c)}return!0},this.GetLastCursorIndex=function(t){if(1==t.DataType)for(var e=t.Data.length-1;e>=0;--e){var a=t.Data[e];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=0,t.IndexData.DataIndex=a.DayItem.Data.length-1,void(t.IndexData.Type=a.Type)}else if(2==t.DataType)for(e=t.Data.length-1;e>=0;--e)for(var i=t.Data[e],r=i.length-1;r>=0;--r){a=i[r];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=e,t.IndexData.DataIndex=a.DayItem.Data.length-1,void(t.IndexData.Type=a.Type)}},this.GetFirstCursorIndex=function(t){if(1==t.DataType)for(var e=0;e<t.Data.length;++e){var a=t.Data[e];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=0,t.IndexData.DataIndex=0,void(t.IndexData.Type=a.Type)}else if(2==t.DataType)for(e=0;e<t.Data.length;++e)for(var i=t.Data[e],r=0;r<i.length;++r){a=i[r];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=e,t.IndexData.DataIndex=0,void(t.IndexData.Type=a.Type)}},this.GetAfterCloseData=function(){var t=null;return this.AfterCloseData&&this.IsShowAfterData&&(t=this.AfterCloseData),t},this.GetBeforeOpenData=function(){var t=null;return this.BeforeOpenData&&this.IsShowBeforeData&&(t=this.BeforeOpenData),t},this.MoveCorssCursorIndex=function(t){if(!this.EnableNewIndex)return!1;if(!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return!1;var e=this.Frame.SubFrame[0].Frame;if(1==this.CorssCursorIndex.Type||2==this.CorssCursorIndex.Type||3==this.CorssCursorIndex.Type||-1==this.CorssCursorIndex.Type){var a=[],i=this.GetBeforeOpenData();a.push({DayItem:i,Type:2});i=null;this.SourceData&&(i=this.SourceData),a.push({DayItem:i,Type:1});i=this.GetAfterCloseData();a.push({DayItem:i,Type:3});var r={DataType:1,Data:a,IndexData:this.CorssCursorIndex,Point:{X:null,Y:null}},n=1;if(t.IsMoveLeft){if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetLastCursorIndex(r),n=0),e.MoveXIndexLeft(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,1==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:this.CorssCursorIndex.Type};this.DrawDynamicInfo(t)}}else if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetFirstCursorIndex(r),n=0),e.MoveXIndexRight(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,1==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:this.CorssCursorIndex.Type};this.DrawDynamicInfo(t)}}else if(10==this.CorssCursorIndex.Type||20==this.CorssCursorIndex.Type||30==this.CorssCursorIndex.Type||-2==this.CorssCursorIndex.Type){a=[];var o=0,s=this.DayData.length;this.DayOffset&&(sa.IsNumber(this.DayOffset.Offset)&&(o=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(s=this.DayOffset.ShowDayCount));for(var h=o,l=0;h<this.DayData.length&&l<s;++h,++l){var u=[];i=null;this.MultiDayBeforeOpenData&&this.IsShowMultiDayBeforeData&&(i=this.MultiDayBeforeOpenData[h]),u.push({DayItem:i,Type:20});i=null;this.DayData&&(i=this.DayData[this.DayData.length-1-h]),u.push({DayItem:i,Type:10});i=null;this.MultiDayAfterCloseData&&this.IsShowMultiDayAfterData&&(i=this.MultiDayAfterCloseData[h]),u.push({DayItem:i,Type:30}),a.push(u)}r={DataType:2,Data:a,IndexData:this.CorssCursorIndex,Point:{X:null,Y:null}},n=1;if(t.IsMoveLeft){if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetLastCursorIndex(r),n=0),e.MoveXIndexLeft(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,10==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:null};10==this.CorssCursorIndex.Type?t.ClientPos=1:20==this.CorssCursorIndex.Type?t.ClientPos=this.CorssCursorIndex.DayIndex+200:30==this.CorssCursorIndex.Type&&(t.ClientPos=this.CorssCursorIndex.DayIndex+300),this.DrawDynamicInfo(t)}}else if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetFirstCursorIndex(r),n=0),e.MoveXIndexRight(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,10==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:null};10==this.CorssCursorIndex.Type?t.ClientPos=1:20==this.CorssCursorIndex.Type?t.ClientPos=this.CorssCursorIndex.DayIndex+200:30==this.CorssCursorIndex.Type&&(t.ClientPos=this.CorssCursorIndex.DayIndex+300),this.DrawDynamicInfo(t)}}},this.GetDataIndexByDatTime=function(t,e){for(var a={DayIndex:-1,DataIndex:-1,Index:-1},i=this.Frame.SubFrame[0].Frame,r=i.MinuteCount,n=this.GetKData(),o=0;o<n.Data.length;++o){var s=n.Data[o];if(s&&(s.Date==t&&s.Time==e)){a.Index=o,a.DayIndex=parseInt(o/r),a.DataIndex=o%r;break}}return a},this.GetCorssCursorIndexByDateTime=function(t,e){var a=this.Frame.ChartBorder.GetBorder();if(a.DayBorder){var i=this.GetDataIndexByDatTime(t,e);i.Type=10}else{i=this.GetDataIndexByDatTime(t,e);i.Type=1,i.DayIndex=0,i.DataIndex=i.Index}return i},this.LockCorssCursor=function(t){var e=this.GlobalOption.LockCorssCursor.X,a={DayIndex:-1,DataIndex:-1,Type:-1,Index:this.CursorIndex};if(this.EnableNewIndex&&(a.Type=this.CorssCursorIndex.Type,a.DayIndex=this.CorssCursorIndex.DayIndex,a.DataIndex=this.CorssCursorIndex.DataIndex),t&&t.KItem&&(a=this.GetCorssCursorIndexByDateTime(t.KItem.Date,t.KItem.Time)),this.EnableNewIndex){if(1!=a.Type&&10!=a.Type)return!1;e.Minute={DayIndex:a.DayIndex,DataIndex:a.DataIndex,Type:a.Type,CursorIndex:a.Index}}else e.Minute={CursorIndex:a.Index};return e.Enable=!0,t&&t.Draw&&this.Draw(),!0},this.UnlockCorssCursor=function(t){var e=this.GlobalOption.LockCorssCursor.X;e.Enable=!1,e.Minute=null,t&&t.Draw&&this.Draw()},this.GetCorssCursorPosition=function(){var t={LastPoint:{X:this.LastPoint.X,Y:this.LastPoint.Y},CursorIndex:this.CursorIndex,CorssCursorIndex:this.CorssCursorIndex};if(!this.GlobalOption||!this.GlobalOption.LockCorssCursor)return t;var e=this.GlobalOption.LockCorssCursor.X;if(e.Enable&&e.Minute){if(this.EnableNewIndex){var a=e.Minute.Type;t.CorssCursorIndex={DayIndex:e.Minute.DayIndex,DataIndex:e.Minute.DataIndex,Type:a},t.CursorIndex=e.Minute.CursorIndex,t.LastPoint.X=this.GetXPointByCorssCursorIndex(t.CorssCursorIndex)}else{var i=e.Minute.CursorIndex,r=this.Frame.GetXFromIndex(i,!1);t.LastPoint.X=r,t.CursorIndex=e.Minute.CursorIndex}var n=this.Frame.ChartBorder.GetBorder();if(t.LastPoint.Y<n.Top||t.LastPoint.Y>n.Bottom){var o=this.GetKData();if(o&&sa.IsNonEmptyArray(o.Data)){i=parseInt(t.CursorIndex.toFixed(0));i>=o.Data.length&&(i=o.Data.length-1);var s=o.Data[i];if(s&&sa.IsNumber(s.Close)){var h=this.Frame.SubFrame[0].Frame.GetYFromData(s.Close);t.LastPoint.Y=h}}}}return t},this.GetXPointByCorssCursorIndex=function(t){if(t){var e=null,a=t.DayIndex,i=t.DataIndex,r=this.Frame.SubFrame[0].Frame;switch(t.Type){case 1:e=this.Frame.GetXFromIndex(i);break;case 10:var n=r.MinuteCount*a+i;e=this.Frame.GetXFromIndex(n);break}return e}},this.SetCorssCursorIndex=function(t){if(this.EnableNewIndex&&(u.Chart.Log("[MinuteChartContainer::SetCorssCursorIndex] option ",t),"OnMouseMove"==t.ParentFunction)){this.CorssCursorIndex.Point.X=t.Point.X,this.CorssCursorIndex.Point.Y=t.Point.Y;var e=this.PtInClient_V2(t.Point.X,t.Point.Y);if(u.Chart.Log("[MinuteChartContainer::SetCorssCursorIndex] clientPos ",e),e<=0)return void(this.CorssCursorIndex={DayIndex:-1,DataIndex:-1,Point:{X:-1,Y:-1},Type:e});if(!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return void(this.CorssCursorIndex={DayIndex:-1,DataIndex:-1,Point:{X:-1,Y:-1},Type:-1});var a=this.Frame.SubFrame[0].Frame;if(1==e||2==e||3==e){if(this.CorssCursorIndex.DayIndex=0,this.CorssCursorIndex.Type=e,2==e)a.GetLeftExtendXValidData(t.Point.X,{Data:this.BeforeOpenData,IndexData:this.CorssCursorIndex});else if(3==e)a.GetRightExtendXValidData(t.Point.X,{Data:this.AfterCloseData,IndexData:this.CorssCursorIndex});else if(1==e){var i=a.GetXData(t.Point.X);this.CorssCursorIndex.DataIndex=parseInt(i.toFixed(0))}}else if(e>=100&&e<=199){this.CorssCursorIndex.DayIndex=e-100,this.CorssCursorIndex.Type=10;i=a.GetXData(t.Point.X);var r=parseInt(i.toFixed(0));this.CorssCursorIndex.DataIndex=r%a.MinuteCount}else if(e>=200&&e<=299){this.CorssCursorIndex.DayIndex=e-200,this.CorssCursorIndex.Type=20;var n=this.MultiDayBeforeOpenData;if(this.DayOffset){var o=0,s=this.MultiDayBeforeOpenData.length;sa.IsNumber(this.DayOffset.Offset)&&(o=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(s=this.DayOffset.ShowDayCount),n=this.MultiDayBeforeOpenData.slice(o,o+s)}a.GetLeftExtendXValidData(t.Point.X,{Data:n,IndexData:this.CorssCursorIndex})}else if(e>=300&&e<=399){this.CorssCursorIndex.DayIndex=e-300,this.CorssCursorIndex.Type=30;n=this.MultiDayAfterCloseData;if(this.DayOffset&&this.MultiDayAfterCloseData){o=0,s=this.MultiDayAfterCloseData.length;sa.IsNumber(this.DayOffset.Offset)&&(o=this.DayOffset.Offset),sa.IsNumber(this.DayOffset.ShowDayCount)&&(s=this.DayOffset.ShowDayCount),n=this.MultiDayAfterCloseData.slice(o,o+s)}a.GetRightExtendXValidData(t.Point.X,{Data:n,IndexData:this.CorssCursorIndex})}this.LastPoint.X=this.CorssCursorIndex.Point.X,t.Point.X=this.CorssCursorIndex.Point.X}},this.PtInClient_V2=function(t,e){if(this.Canvas.beginPath(),!0===this.Frame.IsHScreen){var a=this.Frame.ChartBorder.GetHScreenBorder();this.Canvas.rect(a.Left,a.TopEx,a.Right-a.Left,a.BottomEx-a.TopEx)}else{a=this.Frame.ChartBorder.GetBorder();if(a.DayBorder){for(var i=0;i<a.DayBorder.length;++i){var r=a.DayBorder[i];if(this.Canvas.beginPath(),this.Canvas.rect(r.LeftEx,a.TopEx,r.RightEx-r.LeftEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 100+i;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,a.TopEx,r.LeftEx-r.Left,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 200+i;if(this.Canvas.beginPath(),this.Canvas.rect(r.RightEx,a.TopEx,r.Right-r.RightEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 300+i}return-2}this.Canvas.rect(a.LeftEx,a.Top,a.RightEx-a.LeftEx,a.Bottom-a.Top)}return this.Canvas.isPointInPath(t,e)?1:this.Frame.ChartBorder.LeftExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.Top,a.Right-a.Left,a.TopEx-a.Top):this.Canvas.rect(a.Left,a.Top,a.LeftEx-a.Left,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?2:this.Frame.ChartBorder.RightExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.BottomEx,a.Right-a.Left,a.Bottom-a.BottomEx):this.Canvas.rect(a.RightEx,a.Top,a.Right-a.RightEx,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?3:-1},this.OnTouchStart=function(e){var a=this;if(0!=this.DragMode&&(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash))if(this.IsPress=!1,this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null,this.TouchDrag=null,this.ClickModel&&(this.ClickModel.PreventHide=!1),this.StopDragTimer(),0==this.EnableScrollUpDown&&e.preventDefault(),this.IsPhoneDragging(e)){var i={Click:{},LastMove:{},StartTime:Date.now()},r={Click:{},LastMove:{},StartTime:Date.now()},n=this.GetToucheData(e,this.IsForceLandscape),o=this.PointAbsoluteToRelative(n[0].clientX,n[0].clientY,!0);if(this.TryClickLock||this.TryClickIndexTitle){var s=o.X,h=o.Y;if(this.TryClickLock&&this.TryClickLock(s,h))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(s,h))return}if(this.ClickFrameButton){var l=this.Frame.PtInButtons(o.X,o.Y);if(l)return void this.ClickFrameButton(l,e)}i.Click.X=n[0].clientX,i.Click.Y=n[0].clientY,i.LastMove.X=n[0].clientX,i.LastMove.Y=n[0].clientY,r.Click.X=n[0].clientX,r.Click.Y=n[0].clientY,r.LastMove.X=n[0].clientX,r.LastMove.Y=n[0].clientY;var C=this,D=function(){if(!0===C.ChartCorssCursor.IsShow){var t=C.PointAbsoluteToRelative(i.Click.X,i.Click.Y,!0),a=t.X,r=t.Y;C.OnMouseMove(a,r,e)}};if(this.ChartDrawOption.IsLockScreen){if(this.MouseDrag=i,this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture){var f=this.CurrentChartDrawPicture;return 2==f.Status?this.SetChartDrawPictureThirdPoint(i.Click.X,i.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(i.Click.X,i.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(e.cancelable&&e.preventDefault())}var c={};F();if(c.X=n[0].clientX-t.getBoundingClientRect().left,c.Y=n[0].clientY-t.getBoundingClientRect().top,this.GetChartDrawPictureByPoint(c)){1==c.ChartDrawPicture.EnableMove&&(c.ChartDrawPicture.Status=20),c.ChartDrawPicture.ValueToPoint(),c.ChartDrawPicture.MovePointIndex=c.PointIndex,c.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=c.ChartDrawPicture,this.SelectChartDrawPicture=c.ChartDrawPicture;var d=this.GetEventCallback(m.ON_CLICK_DRAWPICTURE);if(d&&d.Callback){var I={DrawPicture:c.ChartDrawPicture};d.Callback(d,I,this)}return void(e.cancelable&&e.preventDefault())}}else{1==this.EnableScrollUpDown&&(this.DragTimer=setTimeout((function(){if(C.IsPress=!0,i.Click.X==i.LastMove.X&&i.Click.Y==i.LastMove.Y){C.MouseDrag;C.MouseDrag=null,D(),C.PreventTouchEvent(e)}}),800)),this.MouseDrag=i,this.TouchDrag=r,this.PhoneTouchInfo={Start:{X:n[0].clientX,Y:n[0].clientY},End:{X:n[0].clientX,Y:n[0].clientY}},this.SelectChartDrawPicture=null;var S=!0;this.EnableClickModel&&(S=1!=this.ClickModel.IsShowCorssCursor),S?(this.StopDragTimer(),this.DragTimer=setTimeout((function(){if(a.IsPress=!0,i.Click.X==i.LastMove.X&&i.Click.Y==i.LastMove.Y){a.MouseDrag=null;i.Click.X,i.Click.Y;!0===a.EnableClickModel&&(a.ClickModel.IsShowCorssCursor=!0),C.MoveCorssCursor(i.Click,e)}}),this.PressTime)):this.EnableClickModel||(0==this.EnableScrollUpDown||this.IsClickShowCorssCursor)&&D()}this.EnableZoomIndexWindow&&(this.PhoneDBClick.AddTouchStart(n[0].clientX,n[0].clientY,Date.now()),u.Chart.Log("[MinuteChartContainer::OnTouchStart] PhoneDBClick ",this.PhoneDBClick)),this.TouchEvent({EventID:m.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},e)}else if(this.IsPhonePinching(e)){var T={Start:{},Last:{},StartTime:Date.now()};n=this.GetToucheData(e,this.IsForceLandscape);T.Start={X:n[0].pageX,Y:n[0].pageY,X2:n[1].pageX,Y2:n[1].pageY},T.Last={X:n[0].pageX,Y:n[0].pageY,X2:n[1].pageX,Y2:n[1].pageY},this.PhonePinch=T,this.SelectChartDrawPicture=null}},this.OnTouchMove=function(e){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this.GetToucheData(e,this.IsForceLandscape);if(this.IsPhoneDragging(e)){var i=this.MouseDrag;if(null==i){var r=F(),n=a[0].clientX-t.getBoundingClientRect().left*r,o=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,o,e)}else{var s=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),h=Math.abs(i.LastMove.X-a[0].clientX),l=Math.abs(i.LastMove.Y-a[0].clientY);if(h=parseInt(h),this.CurrentChartDrawPicture&&!0===this.CurrentChartDrawPicture.EnableMove){var u=this.CurrentChartDrawPicture;if(1==u.Status||2==u.Status){if(h<5&&l<5)return;this.SetChartDrawPictureSecondPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo()}else if(3==u.Status)this.SetChartDrawPictureThirdPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo();else if(20==u.Status){if(h<5&&l<5)return;this.MoveChartDrawPicture(a[0].clientX-i.LastMove.X,a[0].clientY-i.LastMove.Y,!0)&&this.DrawDynamicInfo()}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}else if(this.EnableClickModel&&!1===this.ClickModel.IsShowCorssCursor);else{if((l>0&&h<=3||s<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return void this.StopDragTimer();this.PreventTouchEvent(e),this.MouseDrag=null;r=F(),n=a[0].clientX-t.getBoundingClientRect().left*r,o=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,o,e)}}if(this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=a[0].clientX,this.PhoneTouchInfo.End.Y=a[0].clientY),this.TouchDrag){var C=this.TouchDrag;C.LastMove.X=a[0].clientX,C.LastMove.Y=a[0].clientY}}else if(this.IsPhonePinching(e)){this.PreventTouchEvent(e);var D=this.PhonePinch;if(!D)return;var f=Math.abs(a[0].pageY-a[1].pageY),c=Math.abs(D.Last.Y-D.Last.Y2),d=f-c,I=Math.abs(a[0].pageX-a[1].pageX),S=Math.abs(D.Last.X-D.Last.X2),T=I-S,v=this.ZoomStepPixel;if(Math.abs(T)>v){var p=this.GetEventCallback(m.ON_MINUTE_TOUCH_ZOOM);if(p&&p.Callback){var g={XStep:T,YStep:d,PreventDefault:!1};if(p.Callback(p,g,this),g.PreventDefault)return this.PhonePinch=null,void this.StopDragTimer()}}D.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}0==this.EnableScrollUpDown?e.preventDefault():null==i?this.PreventTouchEvent(e):this.StopDragTimer()}},this.OnTouchEnd=function(t){if(u.Chart.Log("[MinuteChartContainer::OnTouchEnd]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.FastSlideEvent();if(this.CurrentChartDrawPicture){var e=this.CurrentChartDrawPicture;2==e.Status||1==e.Status||3==e.Status?(e.PointStatus=e.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():!1):20==e.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}if(this.EnableZoomIndexWindow){var a=Date.now();this.PhoneDBClick.AddTouchEnd(a),this.PhoneDBClick.IsVaildDBClick()&&(this.OnTouchDBClick(this.PhoneDBClick.Start),this.PhoneDBClick.Clear())}this.IsOnTouch=!1,this.StopDragTimer(),this.TouchEvent({EventID:m.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0,this.TouchDrag=null}},this.OnKeyDown=function(t){if(this.StopDisplayLatest(),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=t.keyCode?t.keyCode:t.which,a=this.GetEventCallback(m.ON_KEYDOWN);if(a&&a.Callback){var i={e:t,KeyID:e,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}var r=!1;if(this.ChartCorssCursor&&this.ChartCorssCursor.OnKeyDown){i={e:t,KeyID:e,Draw:!1,PreventDefault:!1};this.ChartCorssCursor.OnKeyDown(i),r=i.Draw}if(this.OnHotKeyDown(e,t))t.preventDefault?t.preventDefault():t.returnValue=!1;else{switch(e){case 37:if(this.EnableNewIndex)this.MoveCorssCursorIndex({IsMoveLeft:!0});else{if(!sa.IsNumber(this.CursorIndex)){var n=0;n=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,this.CursorIndex=n-1}if(this.CursorIndex=parseInt(this.CursorIndex),this.CursorIndex<=.99999){if(!this.DataMoveLeft())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else--this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo()}break;case 39:if(this.EnableNewIndex)this.MoveCorssCursorIndex({IsMoveLeft:!1});else{n=0;if(n=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,sa.IsNumber(this.CursorIndex)||(this.CursorIndex=0),this.CursorIndex=parseInt(this.CursorIndex),this.CursorIndex+1>=n){if(!this.DataMoveRight())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else{var o=null;if(o=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,!o)break;if(this.CursorIndex+o.DataOffset+1>=o.Data.length)break;++this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo()}}break;case 46:if(this.SelectChartDrawPicture){var s=this.SelectChartDrawPicture;u.Chart.Log(s,"drawPicturedrawPicturedrawPicture"),this.SelectChartDrawPicture=null,this.ClearChartDrawPicture(s)}else if(this.SelectedChart&&this.SelectedChart.Selected.Identify){var h=this.GetSelectedChartInfo(this.SelectedChart.Selected);h&&(h.Type==ta.OVERLAY_INDEX?this.DeleteOverlayWindowsIndex(h.IndexID):h.Type==ta.OVERLAY_MINUTE&&this.DeleteOverlaySymbol(h.Symbol))}break;case 32:this.OnMarkRectSelect(t);break;case 33:if(this.PageInfo.Enable){var l={ID:d.OP_SCROLL_LEFT,Step:this.PageInfo.ShowDayCount};this.ChartOperator(l)}break;case 34:if(this.PageInfo.Enable){l={ID:d.OP_SCROLL_RIGHT,Step:this.PageInfo.ShowDayCount};this.ChartOperator(l)}break;case 27:if(this.CurrentChartDrawPicture){s=this.CurrentChartDrawPicture;20!=s.Status&&(this.CurrentChartDrawPicture=null)}break;case 38:case 40:(t.ctrlKey||t.shiftKey)&&this.OnCustomKeyDown&&this.OnCustomKeyDown(e,t);break;default:return}r&&this.DrawDynamicInfo(),t.preventDefault?t.preventDefault():t.returnValue=!1}}},this.OnCustomKeyDown=function(t,e){return 38==t&&e.shiftKey?(this.MoveCorssCursorUp(this.ShiftUpDownStepPixel),!0):!(40!=t||!e.shiftKey)&&(this.MoveCorssCursorDown(this.ShiftUpDownStepPixel),!0)},this.OnRightMenu=function(t,e,a){var i=F(),r=this.Frame.PtInFrame(t*i,e*i);this.PopupRightMenuV2({X:a.offsetX,Y:a.offsetY,FrameID:r,CursorIndex:this.CursorIndex,Point:{X:t*i,Y:e*i}},a);var n=this.GetEventCallback(m.ON_CONTEXT_MENU);if(n){var o={X:t,Y:e,Event:a,FrameID:r,CursorIndex:this.CursorIndex,Point:{X:t*i,Y:e*i}};n.Callback(n,o,this)}},this.GetRightMenuData=function(t,e){for(var a=this.Frame.SubFrame.length,i=[],r=0;r<this.OverlayChartPaint.length;++r){var n=this.OverlayChartPaint[r];n&&n.Symbol&&i.push(n.Symbol)}var o=!1,s=!1,h=!1,l=!1,u=!1;this.ChartCorssCursor&&(o=this.ChartCorssCursor.IsShowCorss,s=this.ChartCorssCursor.IsOnlyDrawMinute,h=this.ChartCorssCursor.IsFixXLastTime,l=this.ChartCorssCursor.CorssPointConfig.Enable,u=this.ChartCorssCursor.EnableDBClick);var C=!1,D=!1;this.ChartDragSelectRect&&(C=this.ChartDragSelectRect.EnableRButton,D=this.ChartDragSelectRect.EnableLButton);var f=this.IsShowMinuteBuySellBar(),c=null;if(t>=0&&e&&sa.IsNumber(e.CursorIndex)){var m=this.GetKData();if(m&&sa.IsNonEmptyArray(m.Data)){var d=m.DataOffset+parseInt(e.CursorIndex.toFixed(0));d>=0&&d<m.Data.length&&(c=m.Data[d])}}var I=[{Name:"叠加品种",SubMenu:[{Name:"上证指数",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["000001.sh",!i.includes("000001.sh")]},Checked:i.includes("000001.sh")},{Name:"深证成指",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["399001.sz",!i.includes("399001.sz")]},Checked:i.includes("399001.sz")},{Name:"中小板指",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["399005.sz",!i.includes("399005.sz")]},Checked:i.includes("399005.sz")},{Name:"创业板指",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["399006.sz",!i.includes("399006.sz")]},Checked:i.includes("399006.sz")},{Name:"沪深300",Data:{ID:v.CMD_OVERLAY_SYMBOL_ID,Args:["000300.sh",!i.includes("000300.sh")]},Checked:i.includes("000300.sh")}]},{Name:"多日分时图",SubMenu:[{Name:"当日分时图",Data:{ID:v.CMD_CHANGE_DAY_COUNT_ID,Args:[1]},Checked:1==this.DayCount},{Name:"最近2日",Data:{ID:v.CMD_CHANGE_DAY_COUNT_ID,Args:[2]},Checked:2==this.DayCount},{Name:"最近3日",Data:{ID:v.CMD_CHANGE_DAY_COUNT_ID,Args:[3]},Checked:3==this.DayCount},{Name:"最近4日",Data:{ID:v.CMD_CHANGE_DAY_COUNT_ID,Args:[4]},Checked:4==this.DayCount},{Name:"最近5日",Data:{ID:v.CMD_CHANGE_DAY_COUNT_ID,Args:[5]},Checked:5==this.DayCount},{Name:"基准线选择",SubMenu:[{Name:"最新昨收价",Data:{ID:v.CMD_CHANGE_BASELINE_ID,Args:[0]},Checked:0===this.BaselineType},{Name:"多日前昨收价",Data:{ID:v.CMD_CHANGE_BASELINE_ID,Args:[1]},Checked:1===this.BaselineType}]}]},{Name:"指标窗口个数",SubMenu:[{Name:"1个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[2]},Checked:3==a},{Name:"2个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[3]},Checked:4==a},{Name:"3个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[4]},Checked:5==a},{Name:"4个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[5]},Checked:6==a},{Name:"5个窗口",Data:{ID:v.CMD_CHANGE_WINDOW_COUNT_ID,Args:[6]},Checked:7==a}]},{Name:"指标切换",SubMenu:[{Name:"MACD",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"MACD"]}},{Name:"DMI",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"DMI"]}},{Name:"DMA",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"DMA"]}},{Name:"BRAR",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"BRAR"]}},{Name:"KDJ",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"KDJ"]}},{Name:"RSI",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"RSI"]}},{Name:"WR",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"WR"]}},{Name:"CCI",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"CCI"]}},{Name:"TRIX",Data:{ID:v.CMD_CHANGE_INDEX_ID,Args:[t,"TRIX"]}}]},{Name:"区间选择",SubMenu:[{Name:"左键区间选择",Data:{ID:v.CMD_LBUTTON_SELECT_RECT_ID,Args:[!D]},Checked:D},{Name:"右键区间选择",Data:{ID:v.CMD_RBUTTON_SELECT_RECT_ID,Args:[!C]},Checked:C}]},{Name:"十字光标",SubMenu:[{Name:"显示",Data:{ID:v.CMD_SHOW_CORSS_LINE_ID,Args:[!o]},Checked:o},{Name:"画在价格线上",Data:{ID:v.CMD_CORSS_ON_CLOSE_LINE_ID,Args:[!s]},Checked:s},{Name:"画在有效X轴上",Data:{ID:v.CMD_CORSS_ON_VAILD_TIME_ID,Args:[!h]},Checked:h},{Name:"画圆点",Data:{ID:v.CMD_CORSS_POINT_ID,Args:[!l]},Checked:l},{Name:"双击显示/隐藏",Data:{ID:v.CMD_CORSS_DBCLICK_ID,Args:[!u]},Checked:u}]},{Name:"其他设置",SubMenu:[{Name:"画图工具",Data:{ID:v.CMD_SHOW_DRAWTOOL_ID,Args:[]},Checked:this.IsShowDrawToolDialog()},{Name:"盘口分析",Data:{ID:v.CMD_SHOW_BUYSELL_BAR_ID,Args:[!f]},Checked:f},{Name:JSPopMenu.SEPARATOR_LINE_NAME},{Name:"语言设置",SubMenu:[{Name:"中文",Data:{ID:v.CMD_CHANGE_LANGUAGE_ID,Args:["CN"]},Checked:this.LanguageID==ji.LANGUAGE_CHINESE_ID},{Name:"英语",Data:{ID:v.CMD_CHANGE_LANGUAGE_ID,Args:["EN"]},Checked:this.LanguageID==ji.LANGUAGE_ENGLISH_ID},{Name:"繁体",Data:{ID:v.CMD_CHANGE_LANGUAGE_ID,Args:["TC"]},Checked:this.LanguageID==ji.LANGUAGE_TRADITIONAL_CHINESE_ID}]},{Name:"区间选择样式",SubMenu:[{Name:"样式1(默认)",Data:{ID:v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID,Args:[0]},Checked:0==this.ChartDragSelectRect.ShowMode},{Name:"样式2",Data:{ID:v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID,Args:[1]},Checked:1==this.ChartDragSelectRect.ShowMode},{Name:"样式3",Data:{ID:v.CMD_CHANGE_DRAG_RECT_SHOW_MODE_ID,Args:[2]},Checked:2==this.ChartDragSelectRect.ShowMode}]},{Name:"K线浮动框",SubMenu:[{Name:"禁用",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!1}]},Checked:!this.DialogTooltip},{Name:"样式1",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!0,Style:0}]},Checked:this.DialogTooltip&&0===this.DialogTooltip.Style},{Name:"样式2",Data:{ID:v.CMD_DIALOG_TOOLTIP_ATTRIBUTE,Args:[{Enable:!0,Style:1}]},Checked:this.DialogTooltip&&1===this.DialogTooltip.Style}]}]}];if(Pr.IsSHSZStockA(this.Symbol)){n={Name:"集合竞价",Data:{ID:v.CMD_SHOW_BEFORE_DATA_ID,Args:[!this.IsShowBeforeData]},Checked:this.IsShowBeforeData};I.splice(4,0,n)}for(r=0;r<I.length;++r){n=I[r];if("叠加品种"==n.Name){for(var S=0;S<n.SubMenu.length;++S)if(n.SubMenu[S].Checked){n.SubMenu.push({Name:JSPopMenu.SEPARATOR_LINE_NAME}),n.SubMenu.push({Name:"取消叠加",Data:{ID:v.CMD_DELETE_ALL_OVERLAY_SYMBOL_ID}});break}}else if("十字光标"==n.Name&&c){var T=this.IsLockCorssCursor();T?n.SubMenu.push({Name:"锁十字光标",Data:{ID:v.CMD_UNLOCK_CROSSCURSOR},Checked:T}):n.SubMenu.push({Name:"锁十字光标",Data:{ID:v.CMD_LOCK_CROSSCURSOR,Args:[{KItem:{Date:c.Date,Time:c.Time},Draw:!0}]},Checked:T})}}return I},this.OnWheel=function(t){if(u.Chart.Log("[MinuteChartContainer::OnWheel]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r={Left:this.Frame.ChartBorder.GetLeft(),Right:this.Frame.ChartBorder.GetRight(),Top:this.Frame.ChartBorder.GetTop(),Bottom:this.Frame.ChartBorder.GetBottom(),Width:this.Frame.ChartBorder.GetWidth(),Height:this.Frame.ChartBorder.GetHeight()};a>=r.Left&&a<=r.Right&&i>=r.Top&&i<=r.Bottom&&!0;var n=!1;(this.OnWheel_ChangeDayCount(t,a,i)||this.OnWheel_ZoomUpDownFrameY(t,a,i))&&(n=!0),n&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}},this.OnWheel_ZoomUpDownFrameY=function(t,e,a){if(!this.EnableYDrag.Wheel)return!1;var i=this.Frame.PtInFrame(e,a);if(i<0)return!1;var r=this.Frame.SubFrame[i].Frame,n=r.YSplitOperator;if(!n||!n.FixedYMaxMin)return!1;var o=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(o=-.01*t.deltaY);var s=this.EnableYDrag.WheelYMove;o>0&&(s*=-1);var h={Position:0,Index:i,Right:!1,Left:!1};return!!this.Frame.OnZoomUpDownFrameY(h,s)&&(this.Frame.SetSizeChage(!0),this.Draw(),!0)},this.OnWheel_ChangeDayCount=function(t,e,a){if(!t.ctrlKey)return!1;var i=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(i=-.01*t.deltaY);var r=i>=0?-1:1,n=this.DayCount;if(n+=r,sa.IsPlusNumber(n)){if(sa.IsPlusNumber(this.MaxDayCount)&&n>this.MaxDayCount)return!0;this.ChangeDayCount(n)}return!0},this.OnDoubleClick=function(t,e,a){u.Chart.Log("[MinuteChartContainer::OnDoubleClick]",a);var i,r=!1;if(this.ChartCorssCursor){var n={e:a,X:t,Y:e,Draw:!1};this.ChartCorssCursor.OnDBClick(n),r=n.Draw}if(this.EnableYDrag&&(this.EnableYDrag.Left||this.EnableYDrag.Right)&&this.Frame&&this.Frame.PtInFrameY){var o=F(),s=(t=(a.clientX-this.UIElement.getBoundingClientRect().left)*o,e=(a.clientY-this.UIElement.getBoundingClientRect().top)*o,this.Frame.PtInFrameY(t,e));s&&s.Index>=0&&this.CancelZoomUpDownFrameY(s)}null!=this.ClickChartTimer&&(clearTimeout(this.ClickChartTimer),this.ClickChartTimer=null),this.SelectedChart.EnableSelected&&(i=this.PtInChart(t,e));var h={SelectedChart:i};if(this.DBClickEvent(h,a),!i&&this.EnableZoomIndexWindow){var l=this.Frame.PtInFrame(t,e);u.Chart.Log("[MinuteChartContainer::OnDoubleClick] frameId",l),l>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(l,{X:t,Y:e})&&(this.Frame.SetSizeChage(!0),r=!0)}r&&this.Draw()},this.GetDataItem=function(t){if(!t)return null;if(!sa.IsNumber(t.Index))return null;if(!this.SourceData||!this.SourceData.Data)return null;var e=this.SourceData,a=t.ClientPos;if(2==a||3==a||a>=200&&a<=299||a>=300&&a<=399){if(!this.ChartCorssCursor||!this.ChartCorssCursor.CallAcutionXOperator)return null;var i=!0===this.Frame.IsHScreen,r=this.ChartCorssCursor.CallAcutionXOperator;if(r.Value=i?t.Point.Y:t.Point.X,r.Point={X:t.Point.X,Y:t.Point.Y},r.ClientPos=a,2==a){if(!this.BeforeOpenData)return null}else if(3==a){if(!this.AfterCloseData)return null}else if(a>=200&&a<=299){if(!this.MultiDayBeforeOpenData||!sa.IsNonEmptyArray(this.MultiDayBeforeOpenData))return}else if(a>=300&&tclientPos<=399&&(!this.MultiDayAfterCloseData||!sa.IsNonEmptyArray(this.MultiDayAfterCloseData)))return;if(r.Operator()){var n=r.Item;return{Type:a,Item:n,Index:r.DataIndex}}return null}var o=parseInt(t.Index.toFixed(0)),s=o+e.DataOffset;if(s>=e.Data.length)return null;n=e.Data[s];return{Type:a,Item:n,Index:s}},this.UpdatePointByCursorIndex=function(){this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Frame.SourceData;if(!(e.DataOffset+t>=e.Data.length)){var a=e.Data[e.DataOffset+t],i=null;i=a.Before?a.Before.Close:a.Close,this.LastPoint.Y=this.Frame.GetYFromData(i)}},this.Create=function(t,e){var a=this;this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new ma,this.ChartCorssCursor.PtInClient=function(t,e){return a.PtInClient(t,e)},this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=Aa.Create("CorssCursor_Minute_XStringFormat"),this.ChartCorssCursor.StringFormatX.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY=Aa.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ShareAfterVol=this.ShareAfterVol,this.ChartCorssCursor.StringFormatY.HQChart=this,this.ChartCorssCursor.CallAcutionXOperator=new ca,this.ChartCorssCursor.GetEventCallback=function(t){return a.GetEventCallback(t)},this.ChartCorssCursor.OnChangeStatusCallback=function(t,e){a.OnChangeCorssCursorStatus(t,e)},this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new nt,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.TitleHeight=0,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.Frame.GetExtendChartRightWidth=function(){return a.GetExtendChartRightWidth()},this.Frame.GetEventCallback=function(t){return a.GetEventCallback(t)},this.Frame.ZoomStartWindowIndex=2,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.CreateExtendChart("RectSelectPaint",e?e.SelectRect:null),this.EnableIndexChartDrag&&this.CreateExtendChart("DragMovePaint"),this.CreateDragSelectRect(e?e.DragSelectRect:null);for(var i=0;i<this.Frame.SubFrame.length;++i){var r=new Va;0!=i&&1!=i||(r.IsShowMainIndexTitle=!1),r.Frame=this.Frame.SubFrame[i].Frame,r.Canvas=this.Canvas,r.LanguageID=this.LanguageID,r.GetEventCallback=function(t){return a.GetEventCallback(t)},r.SelectedChart=this.SelectedChart,r.MainTitlePaint=this.TitlePaint[0],r.HQChart=this,this.TitlePaint.push(r)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame,this.ChartCorssCursor.CallAcutionXOperator&&(this.ChartCorssCursor.CallAcutionXOperator.Frame=this.Frame.SubFrame[0].Frame);var n=!0,o=!0;if(e&&e.Listener){var s=e.Listener;!1===s.KeyDown&&(n=!1,u.Chart.Log("[MinuteChartContainer::Create] not register keydown event.")),!1===s.Wheel&&(o=!1,u.Chart.Log("[MinuteChartContainer::Create] not register wheel event."))}n&&this.UIElement.addEventListener("keydown",(function(t){a.OnKeyDown(t)}),!0),o&&this.UIElement.addEventListener("wheel",(function(t){a.OnWheel(t)}),!0)},this.CreateChildWindow=function(t){for(var e=this,a=this.GetEventCallback(m.ON_CREATE_FRAME),i=0;i<t;++i){var r=new X;r.UIElement=this.UIElement;var n=new z;n.Canvas=this.Canvas,n.ChartBorder=r,n.Identify=i,n.GlobalOption=this.GlobalOption,i<2&&(n.ChartBorder.TitleHeight=0),n.XPointCount=243,n.HQChart=this,n.GetEventCallback=function(t){return e.GetEventCallback(t)};var o=[9,8,7,6,5,4,3,2,1];for(var s in n.HorizontalMax=o[0],n.HorizontalMin=o[o.length-1],0==i?(n.YSplitOperator=new Ca,n.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),n.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},n.YSplitOperator.DayOffset=this.DayOffset,n.YSplitOperator.GlobalOption=this.GlobalOption,n.YSplitOperator.HQChart=this):(n.YSplitOperator=new la,n.YSplitOperator.LanguageID=this.LanguageID,n.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),n.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},n.YSplitOperator.HQChart=this,1==i&&(n.YSplitOperator.ShareAfterVol=this.ShareAfterVol)),n.YSplitOperator.Frame=n,n.YSplitOperator.ChartBorder=r,n.XSplitOperator=new Da,n.XSplitOperator.Frame=n,n.XSplitOperator.ChartBorder=r,n.XSplitOperator.DayOffset=this.DayOffset,n.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i!=t-1&&(n.XSplitOperator.ShowText=!1),n.XSplitOperator.Operator(),o)n.HorizontalInfo[s]=new Y,n.HorizontalInfo[s].Value=o[s],0==i&&s==n.HorizontalMin||(n.HorizontalInfo[s].Message[1]=o[s].toString(),n.HorizontalInfo[s].Font="14px 微软雅黑");var h=new it;if(n.FrameData.SubFrameItem=h,h.Frame=n,h.Height=0==i?20:10,this.Frame.SubFrame[i]=h,a&&a.Callback){var l={SubFrame:this.Frame.SubFrame[i],WindowIndex:i};a.Callback(a,l,this)}}},this.CreateSubFrameItem=function(t,e){var a=this,i=new X;if(i.UIElement=this.UIElement,e&&e.ChartBorder&&e.ChartBorder.MultiDayMinute){var r=e.ChartBorder.MultiDayMinute;i.MultiDayMinute.Count=r.Count,i.MultiDayMinute.Left=r.Left,i.MultiDayMinute.Right=r.Right}var n=null;n="MinuteChartHScreenContainer"==this.ClassName?new J:new z,n.Canvas=this.Canvas,n.ChartBorder=i,n.Identify=t,n.XPointCount=243,n.GlobalOption=this.GlobalOption,n.HQChart=this,n.GetEventCallback=function(t){return a.GetEventCallback(t)};var o=[9,8,7,6,5,4,3,2,1];if(n.HorizontalMax=o[0],n.HorizontalMin=o[o.length-1],n.YSplitOperator=new la,n.YSplitOperator.LanguageID=this.LanguageID,n.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),n.YSplitOperator.Frame=n,n.YSplitOperator.ChartBorder=i,n.YSplitOperator.HQChart=this,n.XSplitOperator=new Da,n.XSplitOperator.Frame=n,n.XSplitOperator.ChartBorder=i,n.XSplitOperator.ShowText=!1,n.XSplitOperator.DayOffset=this.DayOffset,n.XSplitOperator.GetEventCallback=function(t){return a.GetEventCallback(t)},n.YSplitOperator.GetEventCallback=function(t){return a.GetEventCallback(t)},n.XSplitOperator.Symbol=this.Symbol,this.DayCount>1){var s=this.DayCount;sa.IsNonEmptyArray(this.DayData)&&(s=this.DayData.length),n.XSplitOperator.DayCount=s,n.XSplitOperator.DayData=this.DayData,n.DayCount=s}var h=this.Frame.SubFrame[0].Frame.XPointCount;for(var l in n.XPointCount=h,n.Data=this.ChartPaint[0].Data,o)n.HorizontalInfo[l]=new Y,n.HorizontalInfo[l].Value=o[l],n.HorizontalInfo[l].Message[1]=o[l].toString(),n.HorizontalInfo[l].Font="14px 微软雅黑";var u=new it;n.FrameData.SubFrameItem=u,u.Frame=n,u.Height=10;var C=this.GetEventCallback(m.ON_CREATE_FRAME);if(C&&C.Callback){var D={SubFrame:u,WindowIndex:t};C.Callback(C,D,this)}return u},this.AddNewSubFrame=function(t){var e=this,a=this.Frame.SubFrame[0].Frame,i=this.Frame.SubFrame.length,r=this.CreateSubFrameItem(i,a),n=F();r.Frame.ChartBorder.TitleHeight*=n,this.Frame.SubFrame[i]=r;var o=new Va;o.Frame=this.Frame.SubFrame[i].Frame,o.Canvas=this.Canvas,o.LanguageID=this.LanguageID,o.GetEventCallback=function(t){return e.GetEventCallback(t)},o.MainTitlePaint=this.TitlePaint[0],o.HQChart=this,this.TitlePaint[i+1]=o,this.SetSubFrameOption(r,t),this.UpdateSubFrameDataWidth(r.Frame);for(var s=0;s<this.Frame.SubFrame.length;++s){var h=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?h.XSplitOperator.ShowText=!0:h.XSplitOperator.ShowText=!1}return this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw(),i},this.UpdateXShowText=function(){for(var t=!0,e=this.Frame.SubFrame.length-1;e>=0;--e){var a=this.Frame.SubFrame[e].Frame,i=this.Frame.SubFrame[e];t?(a.XSplitOperator.ShowText=!0,i.Height>0&&(t=!1)):a.XSplitOperator.ShowText=!1}},this.DeleteIndexPaint=function(t,e){var a=this.Frame.SubFrame[t].Frame;if(a){for(var i=[],r=0;r<this.ChartPaint.length;++r){var n=this.ChartPaint[r],o=n.ChartFrame.Guid==a.Guid||n.ChartFrame==a;0!=r&&o?!0===e&&n&&n.OnDestroy&&n.OnDestroy():i.push(n)}a.YSpecificMaxMin=null,a.IsLocked=!1,a.YSplitOperator.SplitType=a.YSplitOperator.DefaultSplitType,this.ChartPaint=i;var s=t+1;this.TitlePaint[s].Data=[],this.TitlePaint[s].Title=null}},this.CreateStockInfo=function(){this.ExtendChartPaint[0]=new We,this.ExtendChartPaint[0].Canvas=this.Canvas,this.ExtendChartPaint[0].ChartBorder=this.Frame.ChartBorder,this.ExtendChartPaint[0].ChartFrame=this.Frame,this.Frame.ChartBorder.Right=300},this.CreateMainKLine=function(){var t=this,e=xt.Create("ChartMinutePriceLine");e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Line",e.Identify="Minute-Line",e.Color=qi.Minute.PriceColor,e.LineWidth=qi.Minute.PriceLineWidth,e.AreaColor=qi.Minute.AreaPriceColor,e.GetEventCallback=function(e){return t.GetEventCallback(e)},this.ChartPaint[0]=e;var a=new le;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,a.ChartFrame=this.Frame.SubFrame[0].Frame,a.Name="Minute-Average-Line",a.Identify="Minute-Average-Line",a.Color=qi.Minute.AvPriceColor,a.IsDrawArea=!1,this.ChartPaint[1]=a;var i=xt.Create("ChartMinuteVolumBar");i.Color=qi.Minute.VolBarColor,i.Canvas=this.Canvas,i.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,i.ChartFrame=this.Frame.SubFrame[1].Frame,i.Name="Minute-Vol-Bar",i.Identify="Minute-Vol-Bar",i.ShareAfterVol=this.ShareAfterVol,this.ChartPaint[2]=i;var r=xt.Create("ChartMinuteBuySellBar");r.Canvas=this.Canvas,r.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,r.ChartFrame=this.Frame.SubFrame[0].Frame,r.Name="Minute-BuySell-Bar",r.Identify="Minute-BuySell-Bar",r.BuySellData=this.BuySellData,r.HQChart=this,this.ChartPaint[3]=r,this.TitlePaint[0]=new Pa,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].LanguageID=this.LanguageID,this.TitlePaint[0].CallAcutionXOperator=new ca,this.TitlePaint[0].CallAcutionXOperator.Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].HQChart=this},this.ChangeScriptIndex=function(t,e,a){this.DeleteIndexPaint(t,!0),this.WindowIndex[t]=new pn(e.Name,e.Script,e.Args,e);var i=this.SourceData;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t,!0);var a=e.API;this.WindowIndex[t]=new xn(a.Name,a.Script,a.Args,e),e&&e.Window&&this.SetFrameToolbar(t,e.Window),this.Frame.ClearUpDonwFrameYData({Index:t});var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(!(this.Frame.SubFrame.length<3)){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=new f,r=i.Get(e);if(r)return t<2&&(t=2),t>=this.Frame.SubFrame.length&&(t=2),f.ModifyAttribute(r,a),this.ChangeScriptIndex(t,r,a)}},this.ChangeIndexWindowCount=function(t){var e=this;if(!(t<2)&&this.Frame.SubFrame.length!=t){var a=this.Frame.SubFrame.length;if(a>t){for(var i=this.GetEventCallback(m.ON_DELETE_FRAME),r=a-1;r>=t;--r){this.DeleteIndexPaint(r),this.DeleteChartPaintExtend({WindowIndex:r});var n=this.Frame.SubFrame[r].Frame;if(n.ClearToolbar&&n.ClearToolbar(),i&&i.Callback){var o={SubFrame:this.Frame.SubFrame[r],WindowIndex:r};i.Callback(i,o,this)}}this.Frame.SubFrame.splice(t,a-t),this.WindowIndex.splice(t,a-t),this.TitlePaint.splice(t+1,a-t)}else{var s=this.Frame.SubFrame[0].Frame;for(r=a;r<t;++r){var h=this.CreateSubFrameItem(r,s);this.Frame.SubFrame[r]=h;var l=new Va;l.Frame=this.Frame.SubFrame[r].Frame,l.Canvas=this.Canvas,l.LanguageID=this.LanguageID,l.GetEventCallback=function(t){return e.GetEventCallback(t)},l.SelectedChart=this.SelectedChart,l.MainTitlePaint=this.TitlePaint[0],l.HQChart=this,this.TitlePaint[r+1]=l}var u=["RSI","MACD","DMA","DMI","KDJ","WR"],C=new f;for(r=a;r<t;++r){var D=u[r%u.length],c=C.Get(D);this.WindowIndex[r]=new pn(c.Name,c.Script,c.Args,c);var d=this.SourceData;this.BindIndexData(r,d)}for(r=0;r<this.Frame.SubFrame.length;++r){n=this.Frame.SubFrame[r].Frame;r==this.Frame.SubFrame.length-1?n.XSplitOperator.ShowText=!0:n.XSplitOperator.ShowText=!1}this.UpdataDataoffset()}this.UpdateXShowText(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}},this.ChangeIndexTemplate=function(t){var e=this;if(Array.isArray(t.Windows)){var a=t.Windows.length,i=this.Frame.SubFrame.length;a+=2;var r=null,n=null;sa.IsNumber(t.DayCount)&&t.DayCount!=this.DayCount&&(r=t.DayCount),t.Symbol&&(n=t.Symbol);for(var o=null!=r||null!=n,s=2;s<i;++s){this.DeleteIndexPaint(s);var h=this.Frame.SubFrame[s];h.YSpecificMaxMin=null,h.IsLocked=!1,h.YSplitScale=null}if(i>a){var l=this.GetEventCallback(m.ON_DELETE_FRAME);for(s=i-1;s>=a;--s)if(this.Frame.SubFrame[s].Frame.ClearToolbar(),l&&l.Callback){var u={SubFrame:this.Frame.SubFrame[s],WindowIndex:s};l.Callback(l,u,this)}this.Frame.SubFrame.splice(a,i-a),this.WindowIndex.splice(a,i-a),this.TitlePaint.splice(a+1,i-a)}else for(s=i;s<a;++s){var C=this.CreateSubFrameItem(s);this.Frame.SubFrame[s]=C;var D=new Va;D.Frame=this.Frame.SubFrame[s].Frame,D.Canvas=this.Canvas,D.LanguageID=this.LanguageID,D.GetEventCallback=function(t){return e.GetEventCallback(t)},D.SelectedChart=this.SelectedChart,D.MainTitlePaint=this.TitlePaint[0],D.HQChart=this,this.TitlePaint[s+1]=D}for(s=0;s<a;++s){var c=s,d=null,I=null;t.Frame&&t.Frame.length>s&&(I=t.Frame[c]),c>=2&&(d=t.Windows[c-2]);var S=c+1;if(this.TitlePaint[S].Data=[],this.TitlePaint[S].Title=null,d)if(d.Script)this.WindowIndex[c]=new pn(d.Name,d.Script,d.Args,d);else if(d.API){var T=d.API;this.WindowIndex[c]=new xn(T.Name,T.Script,T.Args,d)}else{var v=d.Index,p=tr.Get(v);if(p)this.WindowIndex[c]=p.Create(),this.CreateWindowIndex(c);else{var g=new f,x=g.Get(v);x&&(f.ModifyAttribute(x,d),this.WindowIndex[c]=new pn(x.Name,x.Script,x.Args,x))}}this.SetSubFrameAttribute(this.Frame.SubFrame[c],d,I)}for(s=0;s<this.Frame.SubFrame.length;++s)this.DeleteWindowsOverlayIndex(s);for(s=0;s<this.Frame.SubFrame.length;++s){d=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?d.XSplitOperator.ShowText=!0:d.XSplitOperator.ShowText=!1}var F=[];if(sa.IsNonEmptyArray(t.OverlayIndex))for(s=0;s<t.OverlayIndex.length;++s){d=t.OverlayIndex[s];d.Index&&(d.IndexName=d.Index),d.Windows>=0&&(d.WindowIndex=d.Windows);var E=this.CreateOverlayWindowsIndex(d);E&&F.push({WindowsIndex:d.WindowIndex,Overlay:E})}if(this.Frame.SetSizeChage(!0),o){n||(n=this.Symbol);t={};sa.IsNumber(r)&&(t.DayCount=r),this.ChangeSymbol(n,t)}else{if(!this.SourceData)return void this.Draw();var L=this.SourceData;for(s=0;s<a;++s)this.BindIndexData(s,L);for(s=0;s<F.length;++s){d=F[s];this.BindOverlayIndexData(d.Overlay,d.WindowsIndex,L)}this.UpdataDataoffset(),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}}},this.RemoveIndexWindow=function(t){if(u.Chart.Log("[MinuteChartContainer::RemoveIndexWindow] remove id",t),!(t<2)&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.RestoreIndexWindows();this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.DeleteChartPaintExtend({WindowIndex:t}),this.Frame.SubFrame[t].Frame.ClearToolbar();var e=this.GetEventCallback(m.ON_DELETE_FRAME);if(e&&e.Callback){var a={SubFrame:this.Frame.SubFrame[t],WindowIndex:t};e.Callback(e,a,this)}this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var i=0;i<this.Frame.SubFrame.length;++i){var r=this.Frame.SubFrame[i].Frame;i==this.Frame.SubFrame.length-1?r.XSplitOperator.ShowText=!0:r.XSplitOperator.ShowText=!1,r.Identify=i}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.AutoUpdateEvent=function(t,e){var a=t?m.RECV_START_AUTOUPDATE:m.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,DayCount:this.DayCount},Explain:e};t&&(n.Callback=function(t){i.RecvMinuteData(t)}),r.Callback(r,n,this)}},this.ClearIndexPaint=function(){if(this.Frame&&this.Frame.SubFrame)for(var t=0;t<this.Frame.SubFrame.length;++t){t>=2&&this.DeleteIndexPaint(t,!0);var e=this.Frame.SubFrame[t];if(sa.IsNonEmptyArray(e.OverlayIndex))for(var a=0;a<e.OverlayIndex.length;++a){for(var i=e.OverlayIndex[a],r=0;r<i.ChartPaint.length;++r){var n=i.ChartPaint[r];n&&n.OnDestroy&&n.OnDestroy()}i.ChartPaint=[]}}for(t=1;t<this.TitlePaint.length;++t){e=this.TitlePaint[t];e.OverlayIndex=new Map}},this.ResetDayOffset=function(){this.PageInfo.Enable?(this.DayOffset.Offset=this.PageInfo.Offset,this.DayOffset.ShowDayCount=this.PageInfo.ShowDayCount):(this.DayOffset.Offset=0,this.DayOffset.ShowDayCount=-1),this.DayOffset.PageInfo=null},this.ResetDataStatus=function(){this.DataStatus.MultiDay=!1,this.DataStatus.LatestDay=!1,this.DataStatus.LatestDate=null},this.ClearOverlaySymbolData=function(){for(var t=0;t<this.OverlayChartPaint.length;++t){var e=this.OverlayChartPaint[t];e.Status=Rt.STATUS_NONE_ID,e.Data.Data=[]}},this.ChangeSymbol=function(t,e){if(this.StopDisplayLatest(),this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"MinuteChartContainer::ChangeSymbol"),this.Symbol=t,this.ResetDayOffset(),this.ResetDataStatus(),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.ReloadChartDrawPicture(),this.ClearIndexRunCount(),this.ClearStockCache(),this.UnlockCorssCursor(),this.Frame.ClearYCoordinateMaxMin(),e){if(sa.IsNumber(e.DayCount)&&(this.DayCount=e.DayCount),sa.IsNonEmptyArray(e.Windows))for(var a=0;a<e.Windows.length;++a){var i=2+a;if(i>=this.WindowIndex.length)break;var r=e.Windows[a];if(r)if(r.Script)this.WindowIndex[i]=new pn(r.Name,r.Script,r.Args,r);else if(r.API){var n=r.API;this.WindowIndex[i]=new xn(n.Name,n.Script,n.Args,r)}else{var o=new f,s=r.Index,h=o.Get(s);h&&(f.ModifyAttribute(h,r),h.ID=s,this.WindowIndex[i]=new pn(h.Name,h.Script,h.Args,h))}}if(!0===e.ClearOverlay){for(a=0;a<this.OverlayChartPaint.length;++a){r=this.OverlayChartPaint[a];r.IsDelete=!0}this.OverlayChartPaint=[],this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint}if(e.Overlay&&sa.IsNonEmptyArray(e.Overlay)){var l=new Set;for(a=0;a<this.OverlayChartPaint.length;++a){r=this.OverlayChartPaint[a];l.add(r.Symbol)}for(a=0;a<e.Overlay.length;++a){r=e.Overlay[a];if(!l.has(r.Symbol)){var u=new ue;u.Canvas=this.Canvas,u.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,u.ChartFrame=this.Frame.SubFrame[0].Frame,u.Name="Overlay-Minute",u.Symbol=r.Symbol,u.Identify="Overlay-Minute-".concat(r.Symbol),r.Color?u.Color=r.Color:u.Color=qi.OverlaySymbol.Color[qi.OverlaySymbol.Random%qi.OverlaySymbol.Color.length],++qi.OverlaySymbol.Random,u.MainData=this.SourceData,u.SetOption&&u.SetOption(r),this.OverlayChartPaint.push(u)}}}sa.IsNonEmptyArray(e.AryDate)&&(this.AryDate=e.AryDate.slice())}!t||this.DayCount<=0?this.DrawEmpty():(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestData())},this.SetPageInfo=function(t){t&&(sa.IsBool(t.Enable)&&(this.PageInfo.Enable=t.Enable),sa.IsNumber(t.Offset)&&(this.PageInfo.Offset=t.Offset),sa.IsNumber(t.ShowDayCount)&&(this.PageInfo.ShowDayCount=t.ShowDayCount))},this.ClearMinuteData=function(){this.SourceData=null,this.DayData=null,this.BeforeOpenData=null,this.AfterCloseData=null,this.MultiDayBeforeOpenData=null,this.MultiDayAfterCloseData=null},this.ChangeDayCount=function(t,e){t<0||(this.StopDisplayLatest(),this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"MinuteChartContainer::ChangeDayCount"),this.DayCount=t,this.ClearMinuteData(),this.ClearStockCache(),this.UnlockCorssCursor(),this.Frame.ClearYCoordinateMaxMin(),e&&e.PageInfo&&(this.SetPageInfo(e.PageInfo),this.ResetDayOffset()),e&&sa.IsNonEmptyArray(e.AryDate)&&(this.AryDate=e.AryDate.slice()),this.ReloadChartDrawPicture(),this.ResetDataStatus(),this.ClearIndexPaint(),this.Frame.ClearYCoordinateMaxMin(),this.ResetOverlaySymbolStatus(),this.RequestData())},this.ChangeBaselineType=function(t){this.BaselineType!=t&&(this.BaselineType=t,this.DayCount>1&&this.RequestData())},this.OverlaySymbols=function(t,e){if(e&&!0===e.ClearAll){for(var a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];i.IsDelete=!0}this.OverlayChartPaint=[]}for(var r=[],n=(a=0,0);a<t.length;++a){var o=t[a],s=o.Symbol,h=!1;for(n=0;n<this.OverlayChartPaint.length;++n){i=this.OverlayChartPaint[n];if(i.Symbol==s){h=!0,console.warn("[MinuteChartContainer::OverlaySymbols] overlay symbol=".concat(s," exist."));break}}h||r.push(o)}if(!sa.IsNonEmptyArray(r))return!0;for(a=0;a<r.length;++a){o=r[a],s=o.Symbol;var l=new ue;l.Canvas=this.Canvas,l.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,l.ChartFrame=this.Frame.SubFrame[0].Frame,l.Name="Overlay-Minute",l.Symbol=s,l.Identify="Overlay-Minute-".concat(s),o.Option&&o.Option.Color?l.Color=o.Option.Color:l.Color=qi.OverlaySymbol.Color[qi.OverlaySymbol.Random%qi.OverlaySymbol.Color.length],++qi.OverlaySymbol.Random,l.MainData=this.SourceData,l.SetOption&&l.SetOption(o.Option),this.OverlayChartPaint.push(l)}return this.DayCount<=1?this.RequestOverlayMinuteData():this.RequestOverlayHistoryMinuteData(),!0},this.OverlaySymbol=function(t,e){var a=null;if(sa.IsString(t)?a=[t]:Array.isArray(t)&&(a=t),!sa.IsNonEmptyArray(a))return!1;for(var i=[],r=0,n=0;r<a.length;++r){var o=a[r],s=!1;for(n=0;n<this.OverlayChartPaint.length;++n){var h=this.OverlayChartPaint[n];if(h.Symbol==o){s=!0,console.warn("[MinuteChartContainer::OverlaySymbol] overlay symbol=".concat(o," exist."));break}}s||i.push(o)}if(!sa.IsNonEmptyArray(i))return!0;for(r=0;r<i.length;++r){o=i[r];var l=new ue;l.Canvas=this.Canvas,l.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,l.ChartFrame=this.Frame.SubFrame[0].Frame,l.Name="Overlay-Minute",l.Symbol=o,l.Identify="Overlay-Minute-".concat(o),e&&e.Color?l.Color=e.Color:l.Color=qi.OverlaySymbol.Color[qi.OverlaySymbol.Random%qi.OverlaySymbol.Color.length],++qi.OverlaySymbol.Random,l.MainData=this.SourceData,l.SetOption&&l.SetOption(e),this.OverlayChartPaint.push(l)}return this.DayCount<=1?this.RequestOverlayMinuteData():this.RequestOverlayHistoryMinuteData(),!0},this.DeleteOverlaySymbol=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol===t)return a.IsDelete=!0,this.OverlayChartPaint.splice(e,1),this.UpdateFrameMaxMin(),this.Draw(),!0}return console.warn("[MinuteChartContainer::DeleteOverlaySymbol] overlay symbol=".concat(t," not exist.")),!1},this.ClearOverlaySymbol=function(){for(var t in this.OverlayChartPaint){var e=this.OverlayChartPaint[t];e.IsDelete=!0}this.OverlayChartPaint=[],this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.UpdateFrameMaxMin(),this.Draw()},this.ShowBeforeData=function(t,e){this.ShowCallAuctionData({Left:t},e)},this.ShowCallAuctionData=function(t,e){if(t){var a=!1;if(sa.IsBool(t.Left)&&this.IsShowBeforeData!=t.Left&&(this.IsShowBeforeData=t.Left,a=!0),sa.IsBool(t.Right)&&this.IsShowAfterData!=t.Right&&(this.IsShowAfterData=t.Right,a=!0),t.MultiDay){var i=t.MultiDay;sa.IsBool(i.Left)&&this.IsShowMultiDayBeforeData!=i.Left&&(this.IsShowMultiDayBeforeData=i.Left,a=!0),sa.IsBool(i.Right)&&this.IsShowMultiDayAfterData!=i.Right&&(this.IsShowMultiDayAfterData=i.Right,a=!0)}if(e){if(e.BeforeOpen){i=e.BeforeOpen;sa.IsNumber(i.Left)&&this.ExtendWidth.Left!=i.Left&&(this.ExtendWidth.Left=i.Left,a=!0)}if(e.AfterClose){i=e.AfterClose;sa.IsNumber(i.Right)&&this.ExtendWidth.Right!=i.Right&&(this.ExtendWidth.Right=i.Right,a=!0)}if(e.MultiDay){i=e.MultiDay;sa.IsNumber(i.Left)&&this.MultiDayExtendWidth.Left!=i.Left&&(this.MultiDayExtendWidth.Left=i.Left,a=!0),sa.IsNumber(i.Right)&&this.MultiDayExtendWidth.Right!=i.Right&&(this.MultiDayExtendWidth.Right=i.Right,a=!0)}}a&&(this.Frame.ClearYCoordinateMaxMin(),this.RequestData())}},this.RequestData=function(t){t&&!0===t.ClearYCoordinateMaxMin&&this.Frame.ClearYCoordinateMaxMin(),this.DayCount<=1?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.ChangeDrawType=function(t){if(!(this.ChartPaint.length<=0)){if(0==t)this.ChartPaint[0].IsDrawArea=!0;else{if(1!=t)return;this.ChartPaint[0].IsDrawArea=!1}this.Draw()}},this.UpdateDataOffset=function(){this.SourceData.DataOffset=this.DayOffset.DataOffset;for(var t=0;t<this.ChartPaint.length;++t){var e=this.ChartPaint[t];e.Data&&(e.Data.DataOffset=this.DayOffset.DataOffset,"ChartMinuteVolumBar"!=e.ClassName&&"ChartMinutePriceLine"!=e.ClassName||(e.DayOffset=this.DayOffset))}for(t=0;t<this.OverlayChartPaint.length;++t){e=this.OverlayChartPaint[t];e.Data&&(e.Data.DataOffset=this.DayOffset.DataOffset)}for(t=0;t<this.Frame.SubFrame.length;++t)for(var a=this.Frame.SubFrame[t],i=0;i<a.OverlayIndex.length;++i)for(var r=a.OverlayIndex[i],n=0;n<r.ChartPaint.length;++n){e=r.ChartPaint[n];e.Data&&(e.Data.DataOffset=this.DayOffset.DataOffset)}},this.RequestHistoryMinuteData=function(){var t=this;if(this.IsBeforeData=!1,this.IsAfterData=!1,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.NetworkFilter){var e={Before:this.IsShowMultiDayBeforeData,After:this.IsShowMultiDayAfterData},a=this.IsShowMinuteBuySellBar(),i={Name:"MinuteChartContainer::RequestHistoryMinuteData",Explain:"多日分时数据",Request:{Url:t.HistoryMinuteApiUrl,Data:{daycount:t.DayCount,symbol:t.Symbol,callcation:e,AryDate:this.AryDate,IsShowBuySellBar:a},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)})),1==i.PreventDefault)return}io.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)}})},this.RecvHistoryMinuteData=function(t){if(this.EnableVerifyRecvData&&t.symbol!=this.Symbol)u.Chart.Warn("[MinuteChartContainer::RecvHistoryMinuteData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.symbol,"]"));else{this.DayData=sr.JsonDataToMinuteDataArray(t),this.ColorLineData=sr.JsonDataToHistoryMinuteLineColorData(t),this.MultiDayBeforeOpenData=sr.JosnDataToBeforeOpenDataArray(t),this.MultiDayAfterCloseData=sr.JosnDataToAfterCloseDataArray(t);var e=sr.JsonDataToHistoryMinuteLastUpdateTime(t);this.DataStatus.MultiDay=!0;var a=null;sa.IsNonEmptyArray(t.data)&&t.data[0]&&(a=t.data[0]),a&&this.RecvBuySellData(a.BuySellData),this.CaclutateCallCationYRange(),this.Symbol=t.symbol,this.Name=t.name,this.SetCallCationDataBorder({Left:!1,Right:!1,MultiDay:{Left:this.IsShowMultiDayBeforeData,Right:this.IsShowMultiDayAfterData}}),this.CaclutateLimitPrice(this.DayData[0].YClose,t.data[0].limitprice),this.UpdateHistoryMinuteUI(e),this.RecvMinuteDataEvent({FunctionName:"RecvHistoryMinuteData"}),this.RequestOverlayHistoryMinuteData(),this.BindAllOverlayIndexData(this.SourceData),this.AutoUpdateEvent(!0,"MinuteChartContainer::RequestHistoryMinuteData"),this.AutoUpdate()}},this.CaclutateCallCationYRange=function(){var t=null,e=null;if(sa.IsNonEmptyArray(this.MultiDayAfterCloseData)){for(var a={Max:null,Min:null},i=0;i<this.MultiDayAfterCloseData.length;++i){var r=this.MultiDayAfterCloseData[i];(null==a.Max||a.Max<r.VolMax)&&(a.Max=r.VolMax),(null==a.Min||a.Min>r.VolMin)&&(a.Min=r.VolMin)}t=a}if(sa.IsNonEmptyArray(this.MultiDayBeforeOpenData)){for(a={Max:null,Min:null},i=0;i<this.MultiDayBeforeOpenData.length;++i){r=this.MultiDayBeforeOpenData[i];(null==a.Max||a.Max<r.VolMax)&&(a.Max=r.VolMax),(null==a.Min||a.Min>r.VolMin)&&(a.Min=r.VolMin)}e=a}if(2==this.ShareAfterVol&&t&&e){var n=Math.max(t.Max,e.Max),o=Math.min(t.Min,e.Min);t.Max=e.Max=n,t.Min=e.Min=o}if(t)for(i=0;i<this.MultiDayAfterCloseData.length;++i){r=this.MultiDayAfterCloseData[i];r.VolMax=t.Max,r.VolMin=t.Min}if(e)for(i=0;i<this.MultiDayBeforeOpenData.length;++i){r=this.MultiDayBeforeOpenData[i];r.VolMax=e.Max,r.VolMin=e.Min}},this.UpdateHistoryMinuteUI=function(t){var e=this.HistoryMinuteDataToArray(this.DayData),a=new dt;if(a.Data=e,t&&(a.UpdateTime=t),this.SourceData=a,this.TradeDate=this.DayData[0].Date,this.PageInfo&&this.PageInfo.Enable){this.DayOffset.DayCount=this.DayData.length,-1==this.DayOffset.ShowDayCount&&(this.DayOffset.ShowDayCount=this.DayData.length),-8888==this.DayOffset.Offset&&(this.DayOffset.Offset=this.DayOffset.DayCount-this.DayOffset.ShowDayCount);var i=this.DayOffset.ShowDayCount;this.Frame.SetDayCount(i)}else{this.DayOffset.Offset=0,this.DayOffset.ShowDayCount=this.DayData.length;i=this.DayOffset.ShowDayCount;this.Frame.SetDayCount(this.DayData.length)}var r=this.Symbol.toUpperCase(),n=Pr.IsFutures(r),o=this.DayData[0];1===this.BaselineType&&(o=this.DayData[this.DayData.length-1]);var s=o.YClose;sa.IsNumber(o.YClearing)&&n&&(s=o.YClearing),this.BindMainData(a,s),Pr.IsForeignExchange(r)&&(this.ChartPaint[1].Data=null);for(var h=0;h<this.Frame.SubFrame.length;++h){var l=this.Frame.SubFrame[h];for(var u in l.Frame.XSplitOperator.Symbol=this.Symbol,l.Frame.XSplitOperator.DayCount=i,l.Frame.XSplitOperator.DayData=this.DayData,l.Frame.XSplitOperator.Operator(),l.Frame.XSplitOperator.IsBeforeData=this.IsBeforeData,l.Frame.XSplitOperator.IsAfterData=this.IsAfterData,l.Frame.YSplitOperator.Symbol=this.Symbol,l.Frame.YSplitOperator.IsBeforeData=this.IsBeforeData,l.Frame.YSplitOperator.IsAfterData=this.IsAfterData,l.OverlayIndex){var C=l.OverlayIndex[u];C.Frame.XPointCount=l.Frame.XPointCount,C.Frame.MinuteCount=l.Frame.MinuteCount}}if(this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.IsBeforeData=this.IsBeforeData,this.ChartCorssCursor.StringFormatX.IsAfterData=this.IsAfterData,this.TitlePaint[0].IsShowDate=!0,this.UpdateDataOffset(),this.UpdateFrameMaxMin(),this.CreateChartDrawPictureByStorage(),this.Frame.SubFrame.length>2){var D=new dt;D.Data=e;for(var f=2;f<this.Frame.SubFrame.length;++f)this.BindIndexData(f,D)}this.Frame.SetSizeChage(!0),this.Draw()},this.HistoryMinuteDataToArray=function(t){for(var e=[],a=t.length-1;a>=0;--a)for(var i=t[a],r=0;r<i.Data.length;++r)e.push(i.Data[r]);return e},this.UpdateLatestMinuteData=function(t,e,a){if(this.DayData){for(var i=0;i<this.DayData.length;++i){var r=this.DayData[i];if(r.Date===e)return r.Data=t,a&&sa.IsNumber(a.yclose)&&(r.YClose=a.yclose),void(a&&sa.IsNumber(a.yclearing)&&(r.YClearing=a.yclearing))}if(this.DayData.length>0&&this.DayData[0].Date<e){var n=new dt;n.Date=e,n.Data=t,a&&sa.IsNumber(a.yclose)&&(n.YClose=a.yclose),a&&sa.IsNumber(a.yclearing)&&(n.YClearing=a.yclearing),this.DayData.unshift(n)}}},this.UpdateLatestMinuteDataV2=function(t){if(this.DayCount>1){if(!this.DayData)return;for(var e=null,a=0;a<this.DayData.length;++a){var i=this.DayData[a];if(i.Date===date){e=i;break}}if(!e)return;var r=-1,n=t.Data[0];for(a=0;a<e.Data.length;++a){i=e.Data[a];if(i.Date==n.Date&&i.Time==n.Time){r=a;break}}r<0&&(r=e.Data.length);a=0;for(var o=r;a<t.Data.length;++a,++o){i=t.Data[a];e.Data[o]=i}}else{if(!this.SourceData)return;for(r=-1,n=t.Data[0],a=0;a<this.SourceData.Data.length;++a){i=this.SourceData.Data[a];if(i.Date==n.Date&&i.Time==n.Time){r=a;break}}r<0&&(r=this.SourceData.Data.length);for(a=0,o=r;a<t.Data.length;++a,++o){i=t.Data[a];this.SourceData.Data[o]=i}}},this.RequestMinuteData=function(){var t=this,e=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","minute","minutecount"],a=this.Symbol.toUpperCase();Pr.IsFutures(a)&&(e.push("clearing"),e.push("yclearing")),this.IsBeforeData=!1,this.IsShowBeforeData&&1===this.DayCount&&Pr.IsSHSZStockA(t.Symbol)&&(this.IsBeforeData=!0,e.push("before")),this.IsAfterData=!1,this.IsShowAfterData&&1===this.DayCount&&Pr.IsSHSZStockA(t.Symbol)&&(this.IsAfterData=!0);var i=this.IsShowMinuteBuySellBar();if(this.NetworkFilter){var r=null;if(this.DayCount>1){if(sa.IsNonEmptyArray(this.DayData)){var n=this.DayData[0];r=n.GetDateRange()}}else this.SourceData&&(r=this.SourceData.GetDateRange());var o={Before:this.IsShowBeforeData,After:this.IsShowAfterData};this.DayCount>1&&(o={Before:this.IsShowMultiDayBeforeData,After:this.IsShowMultiDayAfterData});var s={Name:"MinuteChartContainer::RequestMinuteData",Explain:"最新分时数据",Request:{Url:t.MinuteApiUrl,Data:{field:e,symbol:[t.Symbol],callcation:o,AryDate:this.AryDate,IsShowBuySellBar:i},Type:"POST"},Self:this,PreventDefault:!1};if(r&&(s.DateRange=r),this.NetworkFilter(s,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)})),1==s.PreventDefault)return}io.HttpRequest({url:t.MinuteApiUrl,data:{field:e,symbol:[t.Symbol],start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)}})},this.RecvMinuteDataEvent=function(t){if(this.mapEvent.has(m.RECV_MINUTE_DATA)){var e=this.mapEvent.get(m.RECV_MINUTE_DATA),a={MinuteData:this.SourceData,Stock:{Symbol:this.Symbol,Name:this.Name},Option:t,DataStatus:this.DataStatus};e.Callback(e,a,this)}},this.UpdateLineColorData=function(t,e){if(this.ColorLineData){var a=this.ColorLineData.filter((function(t,a,i){return t.Date!=e}));if(sa.IsNonEmptyArray(t))for(var i in t)a.push(t[i]);this.ColorLineData=a}else this.ColorLineData=t},this.UpdateCallCationData=function(t,e){if(t&&sa.IsNonEmptyArray(this.MultiDayBeforeOpenData)){var a=this.MultiDayBeforeOpenData[this.MultiDayBeforeOpenData.length-1];a.Date==t.Date?this.MultiDayBeforeOpenData[this.MultiDayBeforeOpenData.length-1]=t:a.Date<t.Date&&this.MultiDayBeforeOpenData.push(t)}if(e&&sa.IsNonEmptyArray(this.MultiDayAfterCloseData)){a=this.MultiDayAfterCloseData[this.MultiDayAfterCloseData.length-1];a.Date==e.Date?this.MultiDayAfterCloseData[this.MultiDayAfterCloseData.length-1]=e:a.Date<e.Date&&this.MultiDayAfterCloseData.push(e)}this.CaclutateCallCationYRange()},this.RecvUpdateMinuteData=function(t){var e=sr.JsonDataToUpdateMinuteData(t),a=sr.JsonDataToMinuteLineColorData(t),i=sr.JsonDataToBeforeOpenData(t),r=sr.JsonDataToAfterCloseData(t),n=sr.JsonDataToMinuteLastUpdateTime(t);if(this.DayCount>1)return this.UpdateCallCationData(i,r),this.UpdateLineColorData(a,e.date),this.UpdateLatestMinuteDataV2(e),this.UpdateHistoryMinuteUI(n),this.RecvMinuteDataEvent({FunctionName:"RecvUpdateMinuteData"}),this.RequestOverlayMinuteData(),this.BindAllOverlayIndexData(this.SourceData),this.AutoUpdateEvent(!0,"MinuteChartContainer::RecvUpdateMinuteData"),void this.AutoUpdate();this.IsBeforeData&&i&&(this.BeforeOpenData=i),this.IsAfterData&&r&&(this.AfterCloseData=r),this.UpdateLatestMinuteDataV2(e),this.UpdateMinuteUI(t.stock[0],{FunctionName:"RecvUpdateMinuteData"}),!1===t.AutoUpdate||(this.AutoUpdateEvent(!0,"MinuteChartContainer::RecvUpdateMinuteData"),this.AutoUpdate())},this.RecvBuySellData=function(t){t&&(Array.isArray(t.AryBuy)&&(this.BuySellData.AryBuy=t.AryBuy.slice()),Array.isArray(t.ArySell)&&(this.BuySellData.ArySell=t.ArySell.slice()))},this.RecvMinuteData=function(t){if(t)if(1!=t.dataType){if(t.stock[0])if(t.stock[0].symbol!=this.Symbol&&this.EnableVerifyRecvData)u.Chart.Warn("[MinuteChartContainer::RecvMinuteData] recv data symbol not match. HQChart[".concat(this.Symbol,"] , Recv[").concat(t.stock[0].symbol,"]"));else{var e=sr.JsonDataToMinuteData(t),a=sr.JsonDataToMinuteLineColorData(t);this.BeforeOpenData=null,this.AfterCloseData=null;var i=sr.JsonDataToBeforeOpenData(t),r=sr.JsonDataToAfterCloseData(t),n=sr.JsonDataToMinuteLastUpdateTime(t);this.IsBeforeData&&(this.BeforeOpenData=i),this.IsAfterData&&(this.AfterCloseData=r);var o=0==this.DataStatus.LatestDay;if(sa.IsNonEmptyArray(t.stock)&&t.stock[0]&&(this.DataStatus.LatestDate=t.stock[0].date,this.RecvBuySellData(t.stock[0].BuySellData)),this.DataStatus.LatestDay=!0,this.DayCount>1)return this.UpdateCallCationData(i,r),this.UpdateLineColorData(a,t.stock[0].date),this.UpdateLatestMinuteData(e,t.stock[0].date,t.stock[0]),this.UpdateTradeStatusData(t.TradeStatus),this.UpdateHistoryMinuteUI(n),this.RecvMinuteDataEvent({FunctionName:"RecvMinuteData"}),this.RequestOverlayMinuteData(),this.BindAllOverlayIndexData(this.SourceData),this.AutoUpdateEvent(!0,"MinuteChartContainer::RecvMinuteData"),void this.AutoUpdate();if(1==this.IsOnTouch&&this.SourceData&&sa.IsNonEmptyArray(this.SourceData.Data))this.AutoUpdate();else{var s=new dt;s.Data=e,s.UpdateTime=n,this.SourceData=s,this.ColorLineData=a,this.UpdateTradeStatusData(t.TradeStatus),this.UpdateMinuteUI(t.stock[0],{FunctionName:"RecvMinuteData",Day:{IsFirstData:o}}),!1===t.AutoUpdate||(this.AutoUpdateEvent(!0,"MinuteChartContainer::RecvMinuteData"),this.AutoUpdate())}}}else this.RecvUpdateMinuteData(t);else u.Chart.Warn("[MinuteChartContainer::RecvMinuteData] recv data is null")},this.UpdateMinuteUI=function(t,e){if(this.TradeDate=t.date,this.Frame.SetDayCount(1),this.Symbol=t.symbol,this.Name=t.name,this.SetCallCationDataBorder({Left:this.IsBeforeData,Right:this.IsAfterData,MultiDay:{Left:!1,Right:!1}}),2==this.ShareAfterVol&&this.BeforeOpenData&&this.AfterCloseData){var a=Math.max(this.BeforeOpenData.VolMax,this.AfterCloseData.VolMax),i=Math.min(this.BeforeOpenData.VolMin,this.AfterCloseData.VolMin);this.BeforeOpenData.VolMax=this.AfterCloseData.VolMax=a,this.BeforeOpenData.VolMin=this.AfterCloseData.VolMin=i}var r=t.yclose,n=this.Symbol.toUpperCase(),o=Pr.IsFutures(n);t.yclearing>0&&o&&(r=t.yclearing),this.CaclutateLimitPrice(r,t.limitprice);var s=null;if(t.high>0&&t.low>0&&(s={High:t.high,Low:t.low}),this.BindMainData(this.SourceData,r,s),this.Frame.SubFrame.length>2){var h=new dt;h.Data=this.SourceData.Data;for(var l=2;l<this.Frame.SubFrame.length;++l)this.BindIndexData(l,h)}l=0;for(var u=0;l<this.Frame.SubFrame.length;++l){var C=this.Frame.SubFrame[l];for(C.Frame.XSplitOperator.Symbol=this.Symbol,C.Frame.XSplitOperator.DayCount=1,C.Frame.XSplitOperator.Operator(),C.Frame.YSplitOperator.Symbol=this.Symbol,u=0;u<C.OverlayIndex.length;++u){var D=C.OverlayIndex[u];D.Frame.XPointCount=C.Frame.XPointCount,D.Frame.MinuteCount=C.Frame.MinuteCount}}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,Pr.IsSHSZ(n)&&(this.TitlePaint[0].IsShowDate=!1),1==t.IsHistoryMinute&&(this.TitlePaint[0].IsShowDate=!0);var f=this.GetChartMinuteInfo();f&&(f.SourceData=this.SourceData),e&&this.RecvMinuteDataEvent(e),this.RequestMinuteInfoData(),this.RequestOverlayMinuteData(),this.CreateChartDrawPictureByStorage(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindAllOverlayIndexData(this.SourceData)},this.CaclutateLimitPrice=function(t,e){if(this.LimitPrice=null,e&&e.max>0&&e.min>0)this.LimitPrice={Max:e.max,Min:e.min};else{var a=Pr.GetLimitPriceRange(this.Symbol,this.Name);a?t<=0||(this.LimitPrice={Max:t*(1+a.Max),Min:t*(1+a.Min)},u.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] ".concat(this.Symbol," yClose:").concat(t," max:").concat(this.LimitPrice.Max," min:").concat(this.LimitPrice.Min)),this.LimitPrice.Max=parseFloat(this.LimitPrice.Max.toFixed(2)),this.LimitPrice.Min=parseFloat(this.LimitPrice.Min.toFixed(2)),u.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] ".concat(this.Symbol," tofixed(2) max:").concat(this.LimitPrice.Max," min:").concat(this.LimitPrice.Min))):u.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] ".concat(this.Symbol," no limit price."))}},this.RequestSingleOverlayMinuteData=function(t,e,a){var i=this;if(a.Status=Rt.STATUS_REQUESTDATA_ID,this.NetworkFilter){var r={Name:"MinuteChartContainer::RequestOverlayMinuteData",Explain:"叠加股票最新分时数据",Request:{Url:this.HistoryMinuteApiUrl,Data:{days:[e],symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){a.Status=Rt.STATUS_RECVDATA_ID,i.RecvOverlayMinuteData(t,a)})),1==r.PreventDefault)return}io.HttpRequest({url:this.HistoryMinuteApiUrl,data:{symbol:t,days:[e]},type:"post",dataType:"json",async:!0,success:function(t){a.Status=Rt.STATUS_RECVDATA_ID,i.RecvOverlayMinuteData(t,a)}})},this.RequestOverlayMinuteData=function(){for(var t=this.TradeDate,e=0;e<this.OverlayChartPaint.length;++e){var a=this.OverlayChartPaint[e];if(a.MainData&&a.Status==Rt.STATUS_NONE_ID){var i=a.Symbol;i&&this.RequestSingleOverlayMinuteData(i,t,a)}}},this.RecvMultiOverlayMinuteData=function(t){if(sa.IsNonEmptyArray(t)){for(var e=!1,a=0;a<t.length;++a){var i=t[a];if(i.symbol)for(var r=0;r<this.OverlayChartPaint.length;++r){var n=this.OverlayChartPaint[r];if(n.MainData&&i.symbol==n.Symbol){this.RecvOverlayMinuteData(i,n,{Redraw:!1}),e=!0;break}}}e&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.RecvOverlayMinuteData=function(t,e,a){if(!e.IsDelete)if(this.EnableVerifyRecvData&&t.symbol!=e.Symbol)u.Chart.Warn("[MinuteChartContainer::RecvOverlayMinuteData] recv data symbol not match. paint[".concat(e.Symbol,"] , Recv[").concat(t.symbol,"]"));else{var i,r=sr.JsonDataToMinuteDataArray(t),n=null;if(this.DayCount>1){if(r.length<=0)return;var o=r[0];for(var s in e.SourceData){var h=e.SourceData[s];if(h.Date==o.Date){e.SourceData[s]=o;var l=this.HistoryMinuteDataToArray(e.SourceData);n=new dt;n.Data=l,i=o.YClose;break}}if(null==n)return}else n=r.length>0?r[0]:new dt,i=n.YClose;e.Data=n,e.Title=t.name,e.Symbol=t.symbol,e.YClose=i,e.Status=Rt.STATUS_FINISHED_ID;var C=!0;a&&0==a.Redraw&&(C=!1),C&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.RequestSingleOverlayHistoryMinuteData=function(t,e,a){var i=this;if(a.Status=Rt.STATUS_REQUESTDATA_ID,this.NetworkFilter){var r={Name:"MinuteChartContainer::RequestOverlayHistoryMinuteData",Explain:"叠加股票多日分时数据",Request:{Url:i.HistoryMinuteApiUrl,Data:{days:e,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){a.Status=Rt.STATUS_RECVDATA_ID,i.RecvOverlayHistoryMinuteData(t,a)})),1==r.PreventDefault)return}io.HttpRequest({url:i.HistoryMinuteApiUrl,data:{symbol:t,days:e},type:"post",dataType:"json",async:!0,success:function(t){a.Status=Rt.STATUS_RECVDATA_ID,i.RecvOverlayHistoryMinuteData(t,a)}})},this.RequestOverlayHistoryMinuteData=function(){if(sa.IsNonEmptyArray(this.DayData)){for(var t=[],e=0;e<this.DayData.length;++e){var a=this.DayData[e];t.push(a.Date)}if(!(t.length<=0))for(e=0;e<this.OverlayChartPaint.length;++e){a=this.OverlayChartPaint[e];var i=a.Symbol;i&&(a.Status==Rt.STATUS_NONE_ID&&this.RequestSingleOverlayHistoryMinuteData(i,t,a))}}},this.RecvOverlayHistoryMinuteData=function(t,e){if(this.EnableVerifyRecvData&&t.symbol!=e.Symbol)u.Chart.Warn("[MinuteChartContainer::RecvOverlayHistoryMinuteData] recv data symbol not match. paint[".concat(e.Symbol,"] , Recv[").concat(t.symbol,"]"));else if(sa.IsNonEmptyArray(this.DayData)){var a=sr.JsonDataToMinuteDataArray(t);if(sa.IsNonEmptyArray(a)){for(var i=[],r=0;r<this.DayData.length;++r){for(var n=this.DayData[r],o=!1,s=0;s<a.length;++s)if(n.Date==a[s].Date){i.push(a[s]),o=!0;break}if(!o){var h=new dt;h.Date=n.Date,h.Data.length=n.Data.length,i.push(h)}}e.SourceData=i;var l=this.HistoryMinuteDataToArray(i),C=i[0].YClose,D=new dt;D.Data=l,e.Data=D,e.Title=t.name,e.Symbol=t.symbol,e.YClose=C,e.Status=Rt.STATUS_FINISHED_ID,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var t=this,e=Pr.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.ResetOverlaySymbolStatus(),t.RequestMinuteData()}),a))}else this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),2e4)}},this.BindIndexData=function(t,e,a){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e))},this.BindMainData=function(t,e,a){var i=this.IsShowMultiDayBeforeData?this.MultiDayBeforeOpenData:null,r=this.IsShowMultiDayAfterData?this.MultiDayAfterCloseData:null,n=new dt;if(n.Data=t.GetClose(),this.ChartPaint[0].Data=n,this.ChartPaint[0].YClose=e,this.ChartPaint[0].NotSupportMessage=null,this.ChartPaint[0].IsShowLead=!1,this.ChartPaint[0].LeadData=null,this.ChartPaint[0].BeforeOpenData=this.BeforeOpenData,this.ChartPaint[0].AfterCloseData=this.AfterCloseData,this.ChartPaint[0].MultiDayBeforeOpenData=i,this.ChartPaint[0].MultiDayAfterCloseData=r,this.ChartPaint[0].ColorLineData=this.ColorLineData,this.ChartPaint[0].Source=t,Pr.IsSHSZIndex(this.Symbol)&&1==this.DayCount&&this.IsShowLead){var o=new dt;o.Data=t.GetLead(),this.ChartPaint[0].LeadData=o,this.ChartPaint[0].IsShowLead=!0}var s=this.Frame.SubFrame[0].Frame;for(var h in s.YSplitOperator.YClose=e,s.YSplitOperator.Data=n,this.Frame.Data=this.ChartPaint[0].Data,this.Frame.SourceData=t,this.Frame.SubFrame){var l=this.Frame.SubFrame[h].Frame;l.Data=t}n=new dt,n.Data=t.GetMinuteAvPrice(),this.ChartPaint[1].Data=n;var u=this.Symbol.toUpperCase();(Pr.IsForeignExchange(u)||Pr.IsShowAvPrice&&!Pr.IsShowAvPrice(u))&&(this.ChartPaint[1].Data=null),s.YSplitOperator.AverageData=n,s.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,s.YSplitOperator.LimitPrice=this.LimitPrice,s.YSplitOperator.MultiDayBeforeOpenData=i,s.YSplitOperator.MultiDayAfterCloseData=r,s.YSplitOperator.DayCount=this.DayCount,a?(s.YSplitOperator.High=a.High,s.YSplitOperator.Low=a.Low):(s.YSplitOperator.High=null,s.YSplitOperator.Low=null),this.ChartPaint[2].Data=t,this.ChartPaint[2].YClose=e,this.ChartPaint[2].Symbol=this.Symbol,this.ChartPaint[2].BeforeOpenData=this.BeforeOpenData,this.ChartPaint[2].AfterCloseData=this.AfterCloseData,this.ChartPaint[2].MultiDayBeforeOpenData=i,this.ChartPaint[2].MultiDayAfterCloseData=r;for(h=0;h<this.ChartPaintEx.length;++h){l=this.ChartPaintEx[h];"ChartMinuteBarCallAuction"==l.ClassName&&(l.YClose=e,l.Symbol=this.Symbol,l.BeforeOpenData=this.BeforeOpenData,l.AfterCloseData=this.AfterCloseData,l.MultiDayBeforeOpenData=i,l.MultiDayAfterCloseData=r)}for(var h in this.Frame.SubFrame){l=this.Frame.SubFrame[h];l.Frame.YSplitOperator.BeforeOpenData=this.BeforeOpenData,l.Frame.YSplitOperator.IsBeforeData=this.IsBeforeData,l.Frame.YSplitOperator.AfterCloseData=this.AfterCloseData,l.Frame.YSplitOperator.IsAfterData=this.IsAfterData,l.Frame.YSplitOperator.MultiDayBeforeOpenData=i,l.Frame.YSplitOperator.MultiDayAfterCloseData=r}Pr.IsShowMinutePostionLine(u)?this.BindOverlayPositionData(t,e):this.ClearBindOverlayPositionData(),this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].YClose=e,this.TitlePaint[0].BeforeOpenData=this.BeforeOpenData,this.TitlePaint[0].AfterCloseData=this.AfterCloseData,this.TitlePaint[0].MultiDayBeforeOpenData=this.IsShowMultiDayBeforeData?this.MultiDayBeforeOpenData:null,this.TitlePaint[0].MultiDayAfterCloseData=this.IsShowMultiDayAfterData?this.MultiDayAfterCloseData:null,this.TitlePaint[0].CallAcutionXOperator&&(this.TitlePaint[0].CallAcutionXOperator.BeforeOpenData=this.BeforeOpenData,this.TitlePaint[0].CallAcutionXOperator.AfterCloseData=this.AfterCloseData,this.TitlePaint[0].CallAcutionXOperator.MultiDayBeforeOpenData=i,this.TitlePaint[0].CallAcutionXOperator.MultiDayAfterCloseData=r,this.TitlePaint[0].CallAcutionXOperator.DayOffset=this.DayOffset),this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.YClose=e,this.ChartCorssCursor.StringFormatY.BeforeOpenData=this.BeforeOpenData,this.ChartCorssCursor.StringFormatY.AfterCloseData=this.AfterCloseData,this.ChartCorssCursor.StringFormatY.MultiDayBeforeOpenData=i,this.ChartCorssCursor.StringFormatY.MultiDayAfterCloseData=r,this.ChartCorssCursor.StringFormatY.DayOffset=this.DayOffset,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.ChartCorssCursor.StringFormatX.BeforeOpenData=this.BeforeOpenData,this.ChartCorssCursor.StringFormatX.AfterCloseData=this.AfterCloseData,this.ChartCorssCursor.StringFormatX.MultiDayBeforeOpenData=i,this.ChartCorssCursor.StringFormatX.MultiDayAfterCloseData=r,this.ChartCorssCursor.StringFormatX.DayOffset=this.DayOffset,this.ChartCorssCursor.CallAcutionXOperator&&(this.ChartCorssCursor.CallAcutionXOperator.BeforeOpenData=this.BeforeOpenData,this.ChartCorssCursor.CallAcutionXOperator.AfterCloseData=this.AfterCloseData,this.ChartCorssCursor.CallAcutionXOperator.MultiDayBeforeOpenData=i,this.ChartCorssCursor.CallAcutionXOperator.MultiDayAfterCloseData=r,this.ChartCorssCursor.CallAcutionXOperator.DayOffset=this.DayOffset)),this.ExtendChartPaint[0]&&(this.ExtendChartPaint[0].Symbol=this.Symbol,this.ExtendChartPaint[0].Name=this.Name);for(h=0;h<this.OverlayChartPaint.length;++h){l=this.OverlayChartPaint[h];l.MainData=t}},this.BindOverlayPositionData=function(t,e){var a=this;if(!(this.Frame.SubFrame.length<2)){for(var i=null,r=null,n=this.Frame.SubFrame[1],o=null,s=0;s<n.OverlayIndex.length;++s){var h=n.OverlayIndex[s];if("Position_Line_Frame"==h.Identify){o=h;break}}if(o){r=o.Frame;for(s=0;s<o.ChartPaint.length;++s){h=o.ChartPaint[s];if("Position-Line"==h.Name){i=h;break}}i||(i=new Ce,i.Canvas=this.Canvas,i.Name="Position-Line",i.ChartBorder=r.ChartBorder,i.ChartFrame=r,i.Identify=o.Identify,i.Color=qi.Minute.PositionColor,o.ChartPaint.push(i))}else{o=new rt,o.Identify="Position_Line_Frame",r="MinuteChartContainer"==this.ClassName?new Z:new Q,r.Canvas=this.Canvas,r.MainFrame=n.Frame,r.ChartBorder=n.Frame.ChartBorder,r.GlobalOption=this.GlobalOption,o.Frame=r,r.YSplitOperator=new la,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=r.ChartBorder,r.YSplitOperator.HQChart=this,r.YSplitOperator.SplitCount=n.Frame.YSplitOperator.SplitCount,r.YSplitOperator.GetEventCallback=function(t){return a.GetEventCallback(t)},r.YSplitOperator.OverlayIdentify=o.Identify,r.YSplitOperator.FloatPrecision=0;i=new Ce;i.Canvas=this.Canvas,i.Name="Position-Line",i.ChartBorder=r.ChartBorder,i.ChartFrame=r,i.Identify=o.Identify,i.Color=qi.Minute.PositionColor,o.ChartPaint.push(i),n.OverlayIndex.push(o),n.Frame.RightFrame=r}var l=this.Frame.SubFrame[0].Frame.XPointCount;r.XPointCount=l,n.Frame.IsShowPositionTitle=!0;var u=new dt;u.Data=t.GetPosition(),i.Data=u}},this.ClearBindOverlayPositionData=function(){if(!(this.Frame.SubFrame.length<2)){var t=this.Frame.SubFrame[1];for(var e in t.Frame.RightFrame=null,t.Frame.IsShowPositionTitle=!1,t.OverlayIndex){var a=t.OverlayIndex[e];if("Position_Line_Frame"==a.Identify){t.OverlayIndex.splice(e,1);break}}}},this.GetOverlayIndexByIdentify=function(t){for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e];if(sa.IsNonEmptyArray(a.OverlayIndex))for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];if(r.Identify===t)return{OverlayItem:r,WindowIndex:e}}}return null},this.RecvOverlayIndex=function(t,e){var a=this.GetOverlayIndexByIdentify(t);if(null!=a){if(a.Script&&"function"==typeof a.RecvSubscribeData){var i=this.SourceData;i&&a.Script.RecvSubscribeData(e,this,a.WindowIndex,i)}}else console.warn("[MinuteChartContainer::RecvOverlayIndex] can't find overlay index. [identify=".concat(t,"]"))},this.UpdateOverlayIndex=function(t){var e=this.GetOverlayIndexByIdentify(t);if(null!=e){var a=this.SourceData;a&&this.BindOverlayIndexData(e.OverlayItem,e.WindowIndex,a)}else console.warn("[MinuteChartContainer::UpdateOverlayIndex] can't find overlay index. [identify=".concat(t,"]"))},this.AddOverlayIndex=function(t){var e=this.CreateOverlayWindowsIndex(t);if(e){var a=this.SourceData;this.BindOverlayIndexData(e,t.WindowIndex,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateOverlayWindowsIndex=function(t){var e=this,a=t.IndexName,i=t.WindowIndex,r=null,n=null,o=null;if(t.API)r=t.API;else if(t.Script)n={Script:t.Script,ID:t.indexName,Name:t.indexName},t.Name&&(n.Name=t.Name);else{var s=new f;if(n=s.Get(a),!n&&(o=tr.Get(a),!o))return console.warn("[MinuteChartContainer::CreateOverlayIndex] can not find index[".concat(a,"]")),null}var h=this.Frame.SubFrame[i],l=new rt;t.Identify&&(l.Identify=t.Identify);var u=null;if(u="MinuteChartContainer"==this.ClassName?new Z:new Q,u.Canvas=this.Canvas,u.MainFrame=h.Frame,u.ChartBorder=h.Frame.ChartBorder,u.GlobalOption=this.GlobalOption,sa.IsBool(t.ShowRightText)&&(u.IsShow=t.ShowRightText),sa.IsBool(t.IsShareY)&&(u.IsShareY=t.IsShareY),sa.IsBool(t.IsCalculateYMaxMin)&&(u.IsCalculateYMaxMin=t.IsCalculateYMaxMin),sa.IsNumber(t.IsShowMainFrame)&&(u.IsShowMainFrame=t.IsShowMainFrame),u.YSplitOperator=new la,u.YSplitOperator.LanguageID=this.LanguageID,u.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),u.YSplitOperator.Frame=u,u.YSplitOperator.ChartBorder=u.ChartBorder,u.YSplitOperator.SplitCount=h.Frame.YSplitOperator.SplitCount,u.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},u.YSplitOperator.HQChart=this,u.YSplitOperator.OverlayIdentify=l.Identify,t.Frame){var C=t.Frame;C.Custom&&(u.YSplitOperator.Custom=C.Custom)}if(l.Frame=u,r){var D=new xn(r.Name,r.Script,r.Args,t,!0);D.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},l.Script=D}else if(n){f.ModifyAttribute(n,t);var c=new gn(n.Name,n.Script,n.Args,n);c.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},l.Script=c}else{c=o.Create();c.OverlayIndex={IsOverlay:!0,Identify:l.Identify,WindowIndex:i,Frame:l},c.Create(this,i),l.Script=c}return h.OverlayIndex.push(l),l},this.DeleteOverlayWindowsIndex=function(t){this.DeleteOverlayIndex(t,null)&&(this.Frame.ResetXYSplit(!0),this.Draw())},this.BindAllOverlayIndexData=function(t,e){if(this.Frame&&this.Frame.SubFrame)for(var a=0;a<this.Frame.SubFrame.length;++a)for(var i=this.Frame.SubFrame[a],r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];this.BindOverlayIndexData(n,a,t,e)}},this.BindOverlayIndexData=function(t,e,a,i){t.Script&&("function"!=typeof t.Script.RequestData?"function"!=typeof t.Script.ExecuteScript?t.Script.BindData(this,e,a):t.Script.ExecuteScript(this,e,a):t.Script.RequestData(this,e,a))},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(!(a<3)){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.OnTouchFinished=function(){if(!0===this.EnableClickModel){if(1==this.ClickModel.IsShowCorssCursor&&this.ClickModel.PreventHide)return;if(1==this.ClickModel.IsShowCorssCursor&&this.TouchDrawCount>0)return;return this.ClickModel.IsShowCorssCursor=!1,void this.DrawDynamicInfo()}!0!==this.CorssCursorTouchEnd||this.DrawDynamicInfo()},this.CreateExtendChart=function(t,e){var a;switch(t){case"MinuteTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new ke,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"MinutePCTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new Xe,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"MinuteBackgroundPaint":return a=new $e,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"BackgroundPaint":case"背景图":return a=new je,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return a=Ve.Create(t),a?(a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a):null}},this.SetMinuteInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=Rr.Get(t[a]);if(i){var r=i.Create();this.ChartInfo.push(r)}}1==e&&this.RequestMinuteInfoData()},this.GetChartMinuteInfo=function(){return this.ChartInfoPaint},this.CreateMinuteInfo=function(t){var e=new fe;return e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.HQChartBorder=this.Frame.ChartBorder,e.ChartMinutePrice=this.ChartPaint[0],t&&e.SetOption&&e.SetOption(t),this.ChartInfoPaint=e,e},this.RequestMinuteInfoData=function(){if(!(this.ChartInfo.length<=0)){var t=this.GetChartMinuteInfo();for(var e in t||(t=this.CreateMinuteInfo(null)),t.SourceData=this.SourceData,this.ChartInfo)this.ChartInfo[e].RequestData(this)}},this.UpdataChartInfo=function(){var t=this.GetChartMinuteInfo();if(t){var e=new Map;for(var a in this.ChartInfo){var i=this.ChartInfo[a].Data;for(var r in i){var n=i[r],o="".concat(n.Date," ").concat(n.Time);e.has(o)?e.get(o).Data.push(n):e.set(o,{Data:new Array(n)})}}t.Data=e}},this.RecvWindowIndex=function(t,e){var a=this.WindowIndex[t];if(a&&"function"==typeof a.RecvSubscribeData){var i=this.SourceData;a.RecvSubscribeData(e,this,t,i)}},this.UpdateWindowIndex=function(t){if(!(t<2)){var e=this.SourceData;this.BindIndexData(t,e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateChartDrawPicture=function(t,e,a){var i=null,r=Ha.GetDrawPictureByName(t);if(r&&(i=r.Create()),!i&&Ha.MapIonFont.has(t)){var n=Ha.MapIonFont.get(t);i=new hi,i.FontOption.Family=n.Family,i.Text=n.Text,n.Color&&(i.LineColor=n.Color)}if(!i)return!1;i.Canvas=this.Canvas,i.Status=0,i.Symbol=this.Symbol,i.Period=888888888,i.Option=this.ChartDrawOption,a&&(i.FinishedCallback=a),e&&i.SetOption(e);var o=this;return i.Update=function(){o.DrawDynamicInfo()},i.GetActiveDrawPicture=function(){return o.GetActiveDrawPicture()},this.CurrentChartDrawPicture=i,u.Chart.Log("[MinuteChartContainer::CreateChartDrawPicture] ",t,this.CurrentChartDrawPicture),!0},this.AddChartDrawPicture=function(t){if(!t)return null;if(t.FrameID<0||t.FrameID>=this.Frame.SubFrame.length)return null;var e=this,a=Ha.GetDrawPictureByClassName(t.ClassName);if(!a)return null;var i=a.Create();return i.Canvas=this.Canvas,i.Status=10,i.Frame=this.Frame.SubFrame[t.FrameID].Frame,i.Symbol=this.Symbol,i.Period=888888888,t.Value&&(i.Value=t.Value),t.Guid&&(i.Guid=t.Guid),i.ImportStorageData&&i.ImportStorageData(t),i.SetOption(t),t.EnableUpdateXValue&&i.UpdateXValue(),i.ValueToPoint(),i.GetActiveDrawPicture=function(){return e.GetActiveDrawPicture()},this.ChartDrawPicture.push(i),1==t.Draw&&this.DrawDynamicInfo(),i},this.ReloadChartDrawPicture=function(){this.ChartDrawPicture=[],this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture=null,this.MoveOnChartDrawPicture=null,this.ChartDrawStorage&&(this.ChartDrawStorageCache=this.ChartDrawStorage.GetDrawData({Symbol:this.Symbol,Period:888888888}))},this.CreateChartDrawPictureByStorage=function(){var t=this;if(this.ChartDrawStorageCache&&!(this.ChartDrawStorageCache.length<=0)){for(var e=0;e<this.ChartDrawStorageCache.length;++e){var a=this.ChartDrawStorageCache[e];if(!(a.FrameID<0||!this.Frame.SubFrame||this.Frame.SubFrame.length<a.FrameID)){var i=Ha.CreateChartDrawPicture(a);i&&(i.Canvas=this.Canvas,i.Status=10,i.Frame=this.Frame.SubFrame[a.FrameID].Frame,i.ImportStorageData&&i.ImportStorageData(a),i.ResetXValue(),i.UpdateXValue(),i.ValueToPoint(),i.GetActiveDrawPicture=function(){return t.GetActiveDrawPicture()},this.ChartDrawPicture.push(i))}}this.ChartDrawStorageCache=null}},this.SetSizeChange=function(t){for(var e in this.Frame.SetSizeChage(t),this.ExtendChartPaint){var a=this.ExtendChartPaint[e];a.SizeChange=t}},this.SetSizeChage=this.SetSizeChange,this.GetDataIndexByPoint=function(t){var e=this.Frame;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame),e){var a=e.GetXData(t),i=parseInt(a.toFixed(0));return i}},this.GetDateTimeByPoint=function(t,e){var a=this.PtInClient_V2(t,e);if(a<=0)return null;if(!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return null;var i=this.Frame.SubFrame[0].Frame,r=this.Frame.SourceData;if(!r||!sa.IsNonEmptyArray(r.Data))return null;var n=-1,o={ClientPos:a};if(1==a){var s=i.GetXData(t);n=parseInt(s.toFixed(0)),sa.IsNumber(r.DataOffset)&&(n+=r.DataOffset)}else{if(!(a>=100&&a<=199))return null;var h=a-100;s=i.GetXData(t);n=parseInt(s.toFixed(0));var l=n%i.MinuteCount;o.DayIndex=h,o.DataIndex=l}if(n<0||n>=r.Data.length)return null;o.Index=n;var u=r.Data[n];return u?(o.Date=u.Date,o.Time=u.Time,o):null},this.GetSelectRectData=function(t){if(Math.abs(t.XStart-t.XEnd)<5)return!1;var e=this.PtInClient(t.XStart,t.YStart),a=this.PtInClient(t.XEnd,t.YEnd);t.StartClientPos=e,t.EndClientPos=a;var i=this.SourceData;if(!i)return!1;if(!sa.IsNonEmptyArray(i.Data))return!1;var r=this.GetDataIndexByPoint(t.XStart),n=this.GetDataIndexByPoint(t.XEnd);if(Math.abs(r-n)<2)return!1;t.Data=i;var o=i.DataOffset;r+=o,n+=o,r>n?(t.Start=n,t.End=r):(t.Start=r,t.End=n);var s=i.Data.length;return t.End>=s&&(t.End=s-1),!0},this.Super_UpdateFrameMaxMin=this.UpdateFrameMaxMin,this.UpdateFrameMaxMin=function(){if(this.Super_UpdateFrameMaxMin(),1==this.DayCount){var t=this.Frame.SubFrame[1];t.Frame&&(t.Frame.XYSplit=!0)}},this.ExportMainData=function(t,e){var a=t.ExportMinuteData(e);return a},this.DisplayLatest=function(){var t=this.GetEventCallback(m.ON_DISPLAY_LATEST);if(t){var e={PreventDefault:!1};if(t.Callback(t,e,this),e.PreventDefault)return}this.CursorIndex=null,this.LastPoint.X=0,this.LastPoint.Y=0,this.GlobalOption.IsDisplayLatest=!0,this.DrawDynamicInfo()},this.TryClickIndexTitle=function(t,e){for(var a=0;a<this.TitlePaint.length;++a){var i=this.TitlePaint[a];if(i.IsClickTitle&&i.IsClickTitle(t,e)){var r={Point:{X:t,Y:e},Title:i.Title,FrameID:i.Frame.Identify};u.Chart.Log("[MinuteChartContainer::TryClickIndexTitle] click title ",r);var n=this.GetEventCallback(m.ON_CLICK_INDEXTITLE);return n&&n.Callback&&n.Callback(n,r,this),!0}}return!1},this.ClearSelectedXBorder=function(){if(this.GlobalOption&&this.GlobalOption.SelectedXBorder){var t=this.GlobalOption.SelectedXBorder;t.Date=null}},this.DrawSelectedXBorder=function(){if(this.DayCount<=1)return null;if(!0===this.Frame.IsHScreen)return null;if(this.GlobalOption&&this.GlobalOption.SelectedXBorder){var t=this.GlobalOption.SelectedXBorder;if(sa.IsPlusNumber(t.Mode)&&sa.IsPlusNumber(t.Date)&&sa.IsNonEmptyArray(this.DayData)){var e=null,a=t.DayIndex,i=this.Frame.ChartBorder.GetBorder(),r={Left:i.Left,Top:i.Top,Right:i.Right,Bottom:i.Bottom};r.Width=r.Right-r.Left;var n=this.Frame.SubFrame[0].Frame,o=n.XPointCount,s=n.MinuteCount,h=o/s,l=r.Width/h;if(i.DayBorder){a=-1;for(var u=0;u<this.DayData.length;++u){var C=this.DayData[u];if(C.Date==t.Date){a=this.DayData.length-1-u;break}}if(a<0)return;t=i.DayBorder[a];if(!t)return;e={Left:t.LeftEx,Right:t.RightEx,Top:i.Bottom,Bottom:i.ChartHeight},e.Width=e.Right-e.Left,e.Height=e.Bottom-e.Top}else{for(a=-1,u=0;u<this.DayData.length;++u){C=this.DayData[u];if(C.Date==t.Date){a=this.DayData.length-1-u;break}}if(a<0)return;e={Left:i.Left+a*l,Width:l,Top:i.Bottom,Bottom:i.ChartHeight},e.Right=e.Left+e.Width,e.Height=e.Bottom-e.Top}n.Canvas.strokeStyle=qi.SelFrameBorderColor,n.Canvas.strokeRect(A(e.Left),A(e.Top),b(e.Width),b(e.Height)-1)}}},this.PtInMulitDayMinute=function(t,e){if(this.DayCount<=1)return null;if(!0===this.Frame.IsHScreen)return null;if(!sa.IsNonEmptyArray(this.DayData))return null;var a=this.Frame.ChartBorder.GetBorder(),i={Left:a.Left,Top:a.Top,Right:a.Right,Bottom:a.Bottom};if(i.Width=i.Right-i.Left,!(t>i.Left&&t<i.Right&&e>i.Top&&e<i.Bottom))return null;if(a.DayBorder)for(var r=0;r<a.DayBorder.length;++r){var n=a.DayBorder[r],o={Left:n.LeftEx,Right:n.RightEx};if(t>=o.Left&&t<=o.Right){var s=this.DayData[this.DayData.length-1-r];return s?s.Date:null}}else{var h=this.Frame.SubFrame[0].Frame,l=h.XPointCount,u=h.MinuteCount,C=l/u,D=i.Width/C;for(o={Left:i.Left,Right:D+i.Left},r=0;r<C;++r){if(t>=o.Left&&t<=o.Right){s=this.DayData[this.DayData.length-1-r];return s?s.Date:null}o.Left+=D,o.Right+=D}}return null},this.DrawTooltipDialog=function(){this.DialogTooltip&&this.UpdateTooltipDialog()},this.UpdateTooltipDialog=function(){if(!this.DialogTooltip)return!1;if(!this.ChartCorssCursor)return!1;var t=null,e=0;if(this.ChartCorssCursor.ClientPos>=0){var a=this.TitlePaint[0];if(a&&a.PointInfo){var i=a.PointInfo;if(2==i.ClientPos||3==i.ClientPos||i.ClientPos>=200&&i.ClientPos<=299||i.ClientPos>=300&&i.ClientPos<=399){var r=a.GetCurrentAuctionData();if(!r)return!1;t={Type:1,Data:r}}else{var n=a.GetCurrentKLineData();if(!n)return!1;t={Type:0,Data:n}}}}else{if(!this.SourceData||!sa.IsNonEmptyArray(this.SourceData.Data))return!1;n=this.SourceData.Data[this.SourceData.Data.length-1];var o={Symbol:this.Symbol,Date:n.Date,Time:n.Time};if(!this.DialogTooltip.IsEqualDataID(o))return!1;t={Type:0,Data:n},e=2}var s={DataType:e,ClientPos:this.ChartCorssCursor.ClientPos,IsShowCorss:this.ChartCorssCursor.IsShowCorss,MinItem:t,Symbol:this.Symbol,Name:this.Name,LastValue:this.ChartCorssCursor.LastValue};return this.DialogTooltip.Update(s),!0},this.DrawSelectRectDialog=function(t){this.DialogSelectRect&&this.UpdateSelectRectDialog(t)},this.UpdateSelectRectDialog=function(t){if(!this.DialogSelectRect)return!1;var e,a,i=t.data;if(i&&sa.IsNumber(i.X)&&sa.IsNumber(i.Y)){F();var r=this.UIElement.getBoundingClientRect(),n=w();e=i.X,a=i.Y,e+=r.left+n.Left,a+=r.top+n.Top}var o={Symbol:this.Symbol,Name:this.Name,SelectData:i.SelectData,X:e,Y:a,e:t};this.DialogSelectRect.Update(o)},this.GetKData=function(){if(!this.SourceData)return null;var t=this.SourceData;return t||null},this.IsCallAuctionFrame=function(t){if(!sa.IsNonEmptyArray(this.ChartPaintEx))return!1;if(!sa.IsNonEmptyArray(this.Frame.SubFrame))return!1;if(t<0||t>=this.Frame.SubFrame.length)return!1;var e=this.Frame.SubFrame[t];if(!e||!e.Frame)return!1;for(var a=e.Frame,i=0;i<this.ChartPaintEx.length;++i){var r=this.ChartPaintEx[i];if(r.ChartFrame&&r.ChartFrame.Guid==a.Guid)return!0}return!1}}function hr(t){this.newMethod=or,this.newMethod(t),delete this.newMethod,this.ClassName="CustomKLineChartContainer",this.CustomKLineApiUrl=qi.Domain+"/API/IndexCalculate",this.CustomStock,this.QueryDate={Start:20180101,End:20180627},this.RequestHistoryData=function(){var t=this;this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),io.HttpRequest({url:this.CustomKLineApiUrl,data:{stock:t.CustomStock,Name:t.Symbol,date:{startdate:t.QueryDate.Start,enddate:t.QueryDate.End}},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e)}})},this.RecvHistoryData=function(t){var e=or.JsonDataToHistoryData(t),a=new dt;a.Data=e,a.DataType=0;var i=new dt;if(i.Data=e,i.Right=this.Right,i.Period=this.Period,i.DataType=0,i.Right>0){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if(dt.IsDayPeriod(this.Period,!1)){var n=a.GetPeriodData(i.Period);i.Data=n}this.SourceData=a,this.Name=t.name,this.BindMainData(i,this.PageSize);for(var o=0;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,i);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function lr(t,e){!0===e?(this.newMethod=Cr,this.newMethod(t),delete this.newMethod):(this.newMethod=or,this.newMethod(t),delete this.newMethod),this.BuySellPaint,this.TrainDataCount=300,this.TrainStartDate,this.AutoRunTimer=null,this.BuySellData=[],this.TrainCallback,this.DragMode=1,this.IsAutoUpdate=!1,this.KLineSourceData,this.TrainInfo={Start:{},End:{}},this.Super_RecvFlowCapitalData=this.RecvFlowCapitalData,this.CreateBuySellPaint=function(){var t=new Ge;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="KLine-Train-BuySell",this.ChartPaintEx[0]=t},this.GetKDataIndexByDateTime=function(t,e){if(!e||!t)return-1;for(var a=0;a<t.length;++a){var i=t[a];if(dt.IsMinutePeriod(this.Period,!0)){if(sa.IsNumber(this.TrainStartDate.Time)){if(i.Date>=this.TrainStartDate.Date&&i.Time>=this.TrainStartDate.Time)return a}else if(i.Date>=this.TrainStartDate.Date)return a}else if((dt.IsDayPeriod(this.Period,!0)||dt.IsTickPeriod(this.Period))&&i.Date>=this.TrainStartDate.Date)return a}return-1},this.AfterBindMainData=function(t){this.ChartPaintEx[0]||this.CreateBuySellPaint();var e=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=e;var a=e.Data[e.Data.length-1];this.TrainInfo.LastShowData=a,this.TrainInfo.LastData=this.SourceData.Data[this.SourceData.Data.length-1],"Update"!=t&&this.UpdateTrainUICallback("开始")},this.BeforeBindMainData=function(t){if("Update"!=t){this.KLineSourceData=new dt,this.KLineSourceData.Data=this.SourceData.Data.slice(0);var e=this.SourceData.Data.length,a=e-this.TrainDataCount-20,i=this.GetKDataIndexByDateTime(this.SourceData.Data,this.TrainStartDate);i>=0&&(a=i+1,e-a<this.TrainDataCount&&(this.TrainDataCount=e-a));var r=a-1,n=this.SourceData.Data[r];this.TrainInfo.Start.Index=r,this.TrainInfo.Start.Date=n.Date,this.TrainInfo.Start.Time=n.Time,this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,this.TrainInfo.LastData=n,this.SourceData.Data.length=a}},this.Run=function(t){if(!this.AutoRunTimer&&!(this.TrainDataCount<=0)){var e=this;this.AutoRunTimer=setInterval((function(){e.MoveNextKLineData(t)||clearInterval(e.AutoRunTimer)}),1e3)}},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=1;t&&t.Step>1&&(e=t.Step);for(var a=0,i=0;i<e;++i){var r=this.TrainInfo.End.Index+1;if(r>=this.KLineSourceData.Data.length)break;var n=this.KLineSourceData.Data[r];if(this.SourceData.Data.push(n),this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,--this.TrainDataCount,++a,this.TrainDataCount<=0)break}if(0==a)return!1;var o=this.Frame.GetCurrentPageSize();return sa.IsNumber(o)&&(this.PageSize=o-this.RightSpaceCount),t&&t.PageSize>0&&(this.PageSize=t.PageSize),this.Update(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("结束"),!1):(this.UpdateTrainUICallback("训练中"),!0)},this.UpdateTrainUICallback=function(t){if(this.mapEvent.has(m.RECV_TRAIN_MOVE_STEP)){var e=this.mapEvent.get(m.RECV_TRAIN_MOVE_STEP);if(e.Callback){var a={TrainDataCount:this.TrainDataCount,BuySellData:this.BuySellData,KLine:{Start:{Index:this.TrainInfo.Start.Index,Date:this.TrainInfo.Start.Date},End:{Index:this.TrainInfo.End.Index,Date:this.TrainInfo.End.Date}},LastData:this.TrainInfo.LastData,LastShowData:this.TrainInfo.LastShowData};sa.IsNumber(this.TrainInfo.Start.Time)&&(a.KLine.Start.Time=this.TrainInfo.Start.Time),sa.IsNumber(this.TrainInfo.End.Time)&&(a.KLine.End.Time=this.TrainInfo.End.Time),t&&(a.Description=t),this.TrainDataCount<=0&&(a.Symbol=this.Symbol,a.Name=this.Name),e.Callback(e,a,this)}}},this.FinishTrainData=function(){u.Chart.Log("[KLineTrainChartContainer::FinishTrainData] trian end ")},this.Stop=function(){null!=this.AutoRunTimer&&clearInterval(this.AutoRunTimer),this.AutoRunTimer=null},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=r.Data.length-1,o={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(o.Op=1);var s=n;o.Key=s,this.BuySellData.push(o),i.AddTradeItem(o),1==e&&this.Draw()},this.RestartTrain=function(t){u.Chart.Log("[KLineTrainChartContainer::RestartTrain] option ",t),this.TrainInfo={Start:{},End:{}},this.BuySellData=[],this.KLineSourceData=null;var e=this.ChartPaintEx[0];e&&(e.Data=null,e.ClearTradeData()),t.Symbol&&(this.Symbol=t.Symbol),sa.IsNumber(t.Period)&&(this.Period=t.Period),sa.IsNumber(t.Right)&&(this.Right=t.Right),t.Train&&(t.Train.DataCount>1&&(this.TrainDataCount=t.Train.DataCount),t.Train.DateTime&&(this.TrainStartDate=t.Train.DateTime));var a=this.Symbol;this.ChangeSymbol(a)},this.RecvFlowCapitalData=function(t){if(t.stock&&1==t.stock.length){var e=t.stock[0],a=new Array;for(var i in e.stockday){var r=e.stockday[i],n=new Dt;n.Date=r.date;var o=r.capital;o&&(o.a>0&&(n.Value=o.a,a.push(n)))}if(dt.IsMinutePeriod(this.Period,!0)){var s=this.SourceData.GetMinuteFittingFinanceData(a);for(var h in this.SourceData.Data){r=this.SourceData.Data[h];s[h]&&(r.FlowCapital=s[h].Value)}var l=this.ChartPaint[0].Data,u=new dt;if(u.Data=this.SourceData.Data,dt.IsMinutePeriod(l.Period,!1)){var C=u.GetPeriodData(l.Period);u.Data=C}l.Data=u.Data;s=this.KLineSourceData.GetMinuteFittingFinanceData(a);for(var D in this.KLineSourceData.Data){r=this.KLineSourceData.Data[D];s[D]&&(r.FlowCapital=s[D].Value)}}else{s=this.SourceData.GetFittingFinanceData(a);for(var f in this.SourceData.Data){r=this.SourceData.Data[f];s[f]&&(r.FlowCapital=s[f].Value)}l=this.ChartPaint[0].Data,u=new dt;if(u.Data=this.SourceData.Data,l.Right>0){var c=u.GetRightData(l.Right,{AlgorithmType:this.RightFormula});u.Data=c}if(dt.IsDayPeriod(l.Period,!1)){C=u.GetPeriodData(l.Period);u.Data=C}l.Data=u.Data;s=this.KLineSourceData.GetFittingFinanceData(a);for(var m in this.KLineSourceData.Data){r=this.KLineSourceData.Data[m];s[m]&&(r.FlowCapital=s[m].Value)}}this.FlowCapitalReady=!0;var d=!1;for(var I in this.ExtendChartPaint){r=this.ExtendChartPaint[I];if("StockChip"==r.ClassName){d=!0;break}}d&&this.Draw()}},this.AutoUpdate()}function ur(t,e){this.newMethod=lr,this.newMethod(t,e),delete this.newMethod,this.IsHScreen=e,this.IsZoomLockRight=!0,this.RightSpaceCount=0,this.RecvFlowCapitalData=function(t){this.Super_RecvFlowCapitalData(t)},this.BeforeBindMainData=function(t){},this.UpdateLastDataIcon=function(){if(this.ChartPaintEx[0]){var t=this.ChartPaintEx[0];t.LastDataIndex=this.TrainInfo.End.Index}},this.AfterBindMainData=function(t){if(this.ChartPaintEx[0]||(this.CreateBuySellPaint(),this.ChartPaintEx[0].LastDataDrawType=1),"Update"!=t){var e=this.ChartOperator_Temp_GetHistoryData();if(!e)return!1;var a=e.Data.length,i=a-this.TrainDataCount-20,r=this.Frame.SubFrame[0].Frame.XPointCount,n=this.GetKDataIndexByDateTime(e.Data,this.TrainStartDate);n>=0&&(i=n+1,a-i<this.TrainDataCount&&(this.TrainDataCount=a-i));var o=i-r;e.DataOffset=o;var s=i-1,h=e.Data[s];this.TrainInfo.LastShowData=h,this.TrainInfo.LastData=h,this.TrainInfo.Start.Index=s,this.TrainInfo.Start.Date=h.Date,this.TrainInfo.Start.Time=h.Time,this.TrainInfo.End.Index=s,this.TrainInfo.End.Date=h.Date,this.TrainInfo.End.Time=h.Time,this.UpdateLastDataIcon(),this.UpdateTrainUICallback("开始")}},this.Super_UpdataDataoffset=this.UpdataDataoffset,this.UpdataDataoffset=function(){this.Super_UpdataDataoffset();var t=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=t},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=this.ChartOperator_Temp_GetHistoryData();if(!e)return!1;var a=1;t&&t.Step>1&&(a=t.Step);for(var i=e.Data.length,r=0,n=0;n<a;++n){var o=this.TrainInfo.End.Index+1;if(o>=i)break;var s=e.Data[o];if(this.TrainInfo.End.Index=o,this.TrainInfo.End.Date=s.Date,this.TrainInfo.End.Time=s.Time,--this.TrainDataCount,++r,this.TrainDataCount<=0)break}if(0==r)return!1;this.TrainInfo.LastShowData=s,this.TrainInfo.LastData=s;var h=this.TrainInfo.End.Index,l=this.Frame.SubFrame[0].Frame.XPointCount,u=h-l+1;return e.DataOffset=u,this.UpdateLastDataIcon(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("结束"),!1):(this.UpdateTrainUICallback("训练中"),!0)},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=this.TrainInfo.End.Index,o={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(o.Op=1);var s=n;o.Key=s,this.BuySellData.push(o),i.AddTradeItem(o),1==e&&this.Draw()},this.DataMove=function(t,e){var a=this.GetMoveOneStepWidth(),i=t;if(t=parseInt(t/a),t<=0)return!1;var r=this.ChartOperator_Temp_GetHistoryData();if(!r)return!1;var n=0;if(n=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!n)return!1;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&this.Frame.SubFrame[0].Frame){var o=this.Frame.SubFrame[0].Frame;(o.DataWidth<=1||o.DistanceWidth<=1)&&sa.IsPlusNumber(this.StepPixel)&&(t=i*this.StepPixel)}if(e){if(this.RightSpaceCount>0){if(n+r.DataOffset>=r.Data.length+this.RightSpaceCount-1)return!1;r.DataOffset+=t,r.DataOffset+n>=r.Data.length+this.RightSpaceCount&&(r.DataOffset=r.Data.length-(n-this.RightSpaceCount))}else{var s=this.TrainInfo.End.Index+1;if(n+r.DataOffset>=s)return!1;r.DataOffset+=t,r.DataOffset+n>=s&&(r.DataOffset=s-n)}return!0}return!(r.DataOffset<=0)&&(r.DataOffset-=t,r.DataOffset<0&&(r.DataOffset=0),!0)},this.DataMoveRight=function(){var t=this.ChartOperator_Temp_GetHistoryData();if(!t)return!1;var e=0;if(e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!e)return!1;var a=this.TrainInfo.End.Index+1;return!(e+t.DataOffset>=a)&&(++t.DataOffset,!0)}}function Cr(t){this.newMethod=or,this.newMethod(t),delete this.newMethod,this.ClassName="KLineChartHScreenContainer",this.OnMouseMove=function(t,e,a,i){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e);var r={ParentFunction:"OnMouseMove",Point:{X:t,Y:e},IsPhone:!0===i};this.DrawDynamicInfo(r)},t.onmousedown=function(e){if(this.JSChartContainer&&0!=this.JSChartContainer.DragMode){var a=F();if(this.JSChartContainer.TryClickLock){var i=(e.clientX-this.getBoundingClientRect().left)*a,r=(e.clientY-this.getBoundingClientRect().top)*a;if(this.JSChartContainer.TryClickLock(i,r))return}var n={Click:{},LastMove:{}};n.Click.X=e.clientX,n.Click.Y=e.clientY,n.LastMove.X=e.clientX,n.LastMove.Y=e.clientY,this.JSChartContainer.MouseDrag=n,document.JSChartContainer=this.JSChartContainer,this.JSChartContainer.SelectChartDrawPicture=null,t.ondblclick=function(t){var e=t.clientX-this.getBoundingClientRect().left,a=t.clientY-this.getBoundingClientRect().top;this.JSChartContainer&&this.JSChartContainer.OnDoubleClick(e,a,t)},document.onmousemove=function(t){if(this.JSChartContainer&&(!this.JSChartContainer.ChartSplashPaint||1!=this.JSChartContainer.ChartSplashPaint.IsEnableSplash)){var e=this.JSChartContainer.MouseDrag;if(e){var a=Math.abs(e.LastMove.Y-t.clientY);if(1==this.JSChartContainer.DragMode){if(a<5)return;var i=this.JSChartContainer.GetMoveOneStepWidth();if(a<i)return;var r=!0;e.LastMove.Y<t.clientY&&(r=!1),this.JSChartContainer.DataMove(a,r)&&(this.JSChartContainer.UpdataDataoffset(),this.JSChartContainer.UpdatePointByCursorIndex(),this.JSChartContainer.UpdateFrameMaxMin(),this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.Draw()),e.LastMove.X=t.clientX,e.LastMove.Y=t.clientY}}}},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,this.JSChartContainer.MouseDrag=null,this.JSChartContainer.CurrentChartDrawPicture=null,this.JSChartContainer=null}}},this.OnTouchStart=function(e){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsPress=!1,this.PhonePinch=null,this.IsOnTouch=!0,this.TouchDrawCount=0,this.StopDragTimer();var a=this.IsSingleTouch(e);if(e.cancelable&&e.preventDefault(),this.IsPhoneDragging(e)){var i=this.GetToucheData(e,!1),r=this.PointAbsoluteToRelative(i[0].clientX,i[0].clientY,!0);if(this.TryPhoneClickButton(r.X,r.Y,e))return;this.EnableVerticalDrag&&(this.VerticalDrag={IsDrag:!1},this.Frame.PtInFrameVertical(r.X,r.Y)&&(this.VerticalDrag.IsDrag=!0));var n=!0;this.ChartDrawOption.IsLockScreen?n=!1:this.DragMode==I.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(n=!1):this.DragMode==I.DISABLE_DRAG_ID?n=!1:a||(n=!1),this.VerticalDrag&&(n=!1);var o={Click:{},LastMove:{},StartTime:Date.now()};if(o.Click.X=i[0].clientX,o.Click.Y=i[0].clientY,o.LastMove.X=i[0].clientX,o.LastMove.Y=i[0].clientY,this.MouseDrag=o,this.PhoneTouchInfo={Start:{X:i[0].clientX,Y:i[0].clientY},End:{X:i[0].clientX,Y:i[0].clientY}},this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture){var s=this.CurrentChartDrawPicture;return 2==s.Status?this.SetChartDrawPictureThirdPoint(o.Click.X,o.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(o.Click.X,o.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(e.cancelable&&e.preventDefault())}var h={};F();if(h.X=i[0].clientX-t.getBoundingClientRect().left,h.Y=i[0].clientY-t.getBoundingClientRect().top,this.GetChartDrawPictureByPoint(h)){h.ChartDrawPicture.Status=20,h.ChartDrawPicture.ValueToPoint(),h.ChartDrawPicture.MovePointIndex=h.PointIndex,h.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=h.ChartDrawPicture,this.SelectChartDrawPicture=h.ChartDrawPicture;var l=this.GetEventCallback(m.ON_CLICK_DRAWPICTURE);if(l&&l.Callback){var u={DrawPicture:h.ChartDrawPicture};l.Callback(l,u,this)}return void(e.cancelable&&e.preventDefault())}if(n){var C=this;this.DragTimer=setTimeout((function(){if(C.IsPress=!1,o.Click.X==o.LastMove.X&&o.Click.Y==o.LastMove.Y){C.MouseDrag;C.MouseDrag=null,C.MoveCorssCursor(o.Click,e)}}),C.PressTime)}this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==I.CLICK_TOUCH_MODE_ID||(this.DragMode==I.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(o.Click,e)):this.VerticalDrag?this.VerticalDrag.IsDrag||this.MoveCorssCursor(o.Click,e):this.IsClickShowCorssCursor&&this.MoveCorssCursor(o.Click,e))}else if(this.IsPhonePinching(e)){var D={Start:{},Last:{},StartTime:Date.now()};i=this.GetToucheData(e,!1);D.Start={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},D.Last={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},this.PhonePinch=D,this.SelectChartDrawPicture=null}this.TouchEvent({EventID:m.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},e)}},this.OnTouchMove=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){t.cancelable&&t.preventDefault();var e=this.GetToucheData(t,!1);if(this.IsPhoneDragging(t)){var a=this.MouseDrag;if(null==a)this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:e[0].clientX,Y:e[0].clientY},t);else{var i=Math.abs(a.LastMove.Y-e[0].clientY),r=Math.abs(a.LastMove.X-e[0].clientX),n=this.DragMode==I.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.VerticalDrag&&(n=!0!==this.VerticalDrag.IsDrag),this.CurrentChartDrawPicture){var o=this.CurrentChartDrawPicture;if(1==o.Status||2==o.Status){if(i<5&&r<5)return;this.SetChartDrawPictureSecondPoint(e[0].clientX,e[0].clientY,!0)&&this.DrawDynamicInfo()}else if(3==o.Status)this.SetChartDrawPictureThirdPoint(e[0].clientX,e[0].clientY,!0)&&this.DrawDynamicInfo();else if(20==o.Status){if(i<5&&r<5)return;this.MoveChartDrawPicture(e[0].clientX-a.LastMove.X,e[0].clientY-a.LastMove.Y,!0)&&this.DrawDynamicInfo()}a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}else if(n){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(a.Click,t)}else if(1==this.DragMode||0==n){if(i<5)return;var s=this.GetMoveOneStepWidth();if(i<s)return;if(this.EnableVerticalDrag){if(!this.VerticalDrag)return;if(!this.VerticalDrag.IsDrag)return}var h=!0;a.LastMove.Y<e[0].clientY&&(h=!1),this.DataMove(i,h)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw(),this.OnKLinePageChange("OnTouchMove")):this.DragDownloadData&&this.DragDownloadData(),a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=e[0].clientX,this.PhoneTouchInfo.End.Y=e[0].clientY)}else if(this.IsPhonePinching(t)){if(this.DragMode==I.DISABLE_DRAG_ID)return;var l=this.PhonePinch;if(!l)return;var u=Math.abs(e[0].pageX-e[1].pageX),C=Math.abs(l.Last.X-l.Last.X2),D=u-C;if(Math.abs(D)<5)return;if(D>0){var f={};if(f.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(f))return;this.CursorIndex=f.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("OnTouchMove")}else{f={};if(f.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(f))return;this.CursorIndex=f.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("OnTouchMove")}l.Last={X:e[0].pageX,Y:e[0].pageY,X2:e[1].pageX,Y2:e[1].pageY}}}},this.OnTouchEnd=function(t){if(u.Chart.Log("[KLineChartHScreenContainer:OnTouchEnd]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){if(this.CurrentChartDrawPicture){var e=this.CurrentChartDrawPicture;2==e.Status||1==e.Status||3==e.Status?(e.PointStatus=e.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():!1):20==e.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}this.IsOnTouch=!1,this.VerticalDrag=null,this.StopDragTimer(),this.TouchEvent({EventID:m.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0}},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new ma,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=Aa.Create("CorssCursor_XStringFormat"),this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY=Aa.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ExtendChartPaint=this.ExtendChartPaint,this.ChartCorssCursor.StringFormatY.HQChart=this,this.ChartCorssCursor.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new ot,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new Va;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,i.GetEventCallback=function(t){return e.GetEventCallback(t)},i.SelectedChart=this.SelectedChart,i.HQChart=this,this.TitlePaint.push(i)}this.UIElement.addEventListener("keydown",L,!0)},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new X;i.UIElement=this.UIElement;var r=W.Create("KLineHScreenFrame",{ID:a});if(r.Canvas=this.Canvas,r.GetExtraCanvas=function(t){return e.GetExtraCanvas(t)},r.ChartBorder=i,r.Identify=a,r.RightSpaceCount=this.RightSpaceCount,r.GetEventCallback=function(t){return e.GetEventCallback(t)},r.GlobalOption=this.GlobalOption,r.HorizontalMax=20,r.HorizontalMin=10,0==a){r.YSplitOperator=new ha,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.HQChart=this;var n=F();i.TopSpace=12*n,i.BottomSpace=12*n}else r.YSplitOperator=new la,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.HQChart=this;r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new ua,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},a!=t-1&&(r.XSplitOperator.ShowText=!1);for(var o=r.HorizontalMin;o<=r.HorizontalMax;o+=1)r.HorizontalInfo[o]=new Y,r.HorizontalInfo[o].Value=o,0==a&&o==r.HorizontalMin||(r.HorizontalInfo[o].Message[1]=o.toString(),r.HorizontalInfo[o].Font="14px 微软雅黑");var s=new it;r.FrameData.SubFrameItem=s,s.Frame=r,s.Height=0==a?20:10,this.Frame.SubFrame[a]=s}},this.CreateStockChipPhone=function(t){var e=new Ke;return e.Canvas=this.Canvas,e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.HQChart=this,e.Left=this.Frame.ChartBorder.Bottom,e.SetOption(t),this.ExtendChartPaint.push(e),this.Frame.ChartBorder.Bottom+=e.Width,this.GlobalOption.RightHorizontal.Show=!1,e},this.DeleteStockChipChart=function(){var t=this.GetStockChipChart();if(t){var e=t.Chart.Width;this.DeleteExtendChart(t),this.Frame.ChartBorder.Bottom-=e,"StockChipPhone"==t.Chart.ClassName&&(this.GlobalOption.RightHorizontal.Show=!0,this.Frame.ResetXYSplit()),this.SetSizeChange(!0),this.Draw()}}}function Dr(t){this.newMethod=sr,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartHScreenContainer",this.OnMouseMove=function(t,e,a,i){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e);var r=this.PtInClient(t,e),n={ParentFunction:"OnMouseMove",Point:{X:t,Y:e},IsPhone:!0===i,ClientPos:r};this.DrawDynamicInfo(n)},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new ma,this.ChartCorssCursor.PtInClient=function(t,a){return e.PtInClient(t,a)},this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=Aa.Create("CorssCursor_Minute_XStringFormat"),this.ChartCorssCursor.StringFormatX.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY=Aa.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.StringFormatY.HQChart=this,this.ChartCorssCursor.CallAcutionXOperator=new ca,this.ChartCorssCursor.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new ot,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new Va;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,i.GetEventCallback=function(t){return e.GetEventCallback(t)},i.SelectedChart=this.SelectedChart,i.HQChart=this,this.TitlePaint.push(i)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame,this.ChartCorssCursor.CallAcutionXOperator.Frame=this.Frame.SubFrame[0].Frame,this.UIElement.addEventListener("keydown",L,!0)},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new X;i.UIElement=this.UIElement;var r=new J;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,a<2&&(r.ChartBorder.TitleHeight=0),r.XPointCount=243,r.HQChart=this,r.GetEventCallback=function(t){return e.GetEventCallback(t)};var n=[9,8,7,6,5,4,3,2,1];for(var o in r.HorizontalMax=n[0],r.HorizontalMin=n[n.length-1],0==a?(r.YSplitOperator=new Ca,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.DayOffset=this.DayOffset,r.YSplitOperator.HQChart=this):(r.YSplitOperator=new la,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.HQChart=this),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new Da,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,r.XSplitOperator.DayOffset=this.DayOffset,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},a!=t-1&&(r.XSplitOperator.ShowText=!1),r.XSplitOperator.Operator(),n)r.HorizontalInfo[o]=new Y,r.HorizontalInfo[o].Value=n[o],0==a&&o==r.HorizontalMin||(r.HorizontalInfo[o].Message[1]=n[o].toString(),r.HorizontalInfo[o].Font="14px 微软雅黑");var s=new it;r.FrameData.SubFrameItem=s,s.Frame=r,s.Height=0==a?20:10,this.Frame.SubFrame[a]=s}}}function fr(t){this.newMethod=g,this.newMethod(t),delete this.newMethod,this.ClassName="DepthChartContainer",this.Symbol,this.MapAsk=new Map,this.MapBid=new Map,this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.DefaultZoom=.8,this.MaxVolRate=1.1,this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new da,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.Frame=new st,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.ChartBorder.TitleHeight=0,this.Frame.Canvas=this.Canvas,this.Frame.Identify=0;var a=new la;a.FrameSplitData=this.FrameSplitData.get("double"),a.LanguageID=this.LanguageID,a.Frame=this.Frame,a.SplitCount=5,a.LineType=3,a.IgnoreYValue=[0],a.ChartBorder=this.Frame.ChartBorder,a.GetEventCallback=function(t){return e.GetEventCallback(t)},this.Frame.YSplitOperator=a;var i=new fa;i.Frame=this.Frame,i.ChartBorder=this.Frame.ChartBorder,i.LanguageID=this.LanguageID,i.LineType=3,i.GetEventCallback=function(t){return e.GetEventCallback(t)},this.Frame.XSplitOperator=i,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame;var r=new _e;r.Canvas=this.Canvas,r.ChartBorder=this.Frame.ChartBorder,r.ChartFrame=this.Frame,r.Name="深度图",this.ChartPaint.push(r);var n=!0;t&&!1===t.Wheel&&(n=!1,u.Chart.Log("[DepthChartContainer::Create] not register wheel event.")),this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),n&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0)},this.OnWheel=function(t){u.Chart.Log("[KLineChartContainer::OnWheel]",t);var e,a=t.clientX-this.UIElement.getBoundingClientRect().left,i=t.clientY-this.UIElement.getBoundingClientRect().top;this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),e=this.Canvas.isPointInPath(a,i);var r=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(r=-.01*t.deltaY);var n=!0;this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Wheel&&(n=!1),e&&r<0&&n?this.Frame.ZoomDown()&&(this.UpdateFrameMaxMin(),this.Draw()):e&&r>0&&n&&this.Frame.ZoomUp()&&(this.UpdateFrameMaxMin(),this.Draw()),t.preventDefault?t.preventDefault():t.returnValue=!1},this.UIOnMouseDown=function(t){},this.OnTouchStart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null;var e=this.IsSingleTouch(t);if(0!=this.EnableScrollUpDown&&e||t.cancelable&&t.preventDefault(),this.IsPhoneDragging(t)){var a={Click:{},LastMove:{}},i=this.GetToucheData(t,this.IsForceLandscape);a.Click.X=i[0].clientX,a.Click.Y=i[0].clientY,a.LastMove.X=i[0].clientX,a.LastMove.Y=i[0].clientY,this.MouseDrag=a,this.MoveCorssCursor(a.Click,t)}else if(this.IsPhonePinching(t)){var r={Start:{},Last:{}};i=this.GetToucheData(t,this.IsForceLandscape);r.Start={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},r.Last={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},this.PhonePinch=r}}},this.OnTouchMove=function(e){var a=this.GetToucheData(e,!1);if(this.IsPhoneDragging(e)){var i=this.MouseDrag;if(null==i){var r=F(),n=a[0].clientX-t.getBoundingClientRect().left*r,o=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,o,e)}else{var s=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),h=Math.abs(i.LastMove.X-a[0].clientX),l=Math.abs(i.LastMove.Y-a[0].clientY);if(h=parseInt(h),(l>0&&h<=3||s<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return;this.PreventTouchEvent(e),this.MouseDrag=null;r=F(),n=a[0].clientX-t.getBoundingClientRect().left*r,o=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,o,e)}}else if(this.IsPhonePinching(e)){this.PreventTouchEvent(e);var u=this.PhonePinch;if(!u)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var C=Math.abs(a[0].pageY-a[1].pageY),D=Math.abs(u.Last.Y-u.Last.Y2),f=C-D,c=Math.abs(a[0].pageX-a[1].pageX),m=Math.abs(u.Last.X-u.Last.X2),d=c-m,I=this.ZoomStepPixel;if(Math.abs(f)<I&&Math.abs(d)<I)return;var S=f;if(Math.abs(f)<I&&(S=d),S>0){if(!this.Frame.ZoomUp())return;this.UpdateFrameMaxMin(),this.Draw()}else{if(!this.Frame.ZoomDown())return;this.UpdateFrameMaxMin(),this.Draw()}u.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}this.PreventTouchEvent(e)},this.OnTouchEnd=function(t){u.Chart.Log("[DepthChartContainer::OnTouchEnd]",t),this.IsOnTouch=!1,this.OnTouchFinished(),this.TouchDrawCount=0},this.OnTouchFinished=function(){!0!==this.CorssCursorTouchEnd||this.DrawDynamicInfo()},this.ChangeSymbol=function(t){this.CancelAutoUpdate(),this.Symbol=t,this.MapBid=new Map,this.MapAsk=new Map,this.Frame.VerticalRange.Differ=null,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestDepthData()},this.RequestDepthData=function(){var t=this;if(this.NetworkFilter){var e={Name:"DepthChartContainer::RequestDepthData",Explain:"深度图数据",Request:{Data:{symbol:t.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDepthData(e),t.AutoUpdate()})),1==e.PreventDefault)return}},this.RecvDepthData=function(t){this.UpdateAskAndBid(t);var e=Array.from(this.MapAsk.values());e.sort((function(t,e){return t.Price-e.Price}));var a=0;for(var i in e){var r=e[i];a+=r.Vol,e[i]={Price:r.Price,Vol:a}}var n=Array.from(this.MapBid.values());n.sort((function(t,e){return e.Price-t.Price}));a=0;for(var i in n){r=n[i];a+=r.Vol,n[i]={Price:r.Price,Vol:a}}var o={Asks:e,Bids:n},s=this.ChartPaint[0];s.Data=o,this.Frame.XSplitOperator.Symbol=this.Symbol,this.ChartCorssCursor.Data=o,this.ChartCorssCursor.Symbol=this.Symbol,this.UpdateFramePriceList(),this.UpdateFrameMaxMin(),this.Draw()},this.UpdateAskAndBid=function(t){for(var e in"snapshot"==t.datatype&&(this.MapBid=new Map,this.MapAsk=new Map),t.asks){var a=t.asks[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapAsk.has(i)){var n=this.MapAsk.get(i);r<=0?this.MapAsk.delete(i):n.Vol=r}else r>0&&this.MapAsk.set(i,{Price:i,Vol:r})}for(var e in t.bids){a=t.bids[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapBid.has(i)){n=this.MapBid.get(i);r<=0?this.MapBid.delete(i):n.Vol=r}else r>0&&this.MapBid.set(i,{Price:i,Vol:r})}},this.UpdateFramePriceList=function(){var t=Array.from(this.MapAsk.keys()),e=Array.from(this.MapBid.keys());t.sort((function(t,e){return t-e})),e.sort((function(t,e){return t-e}));var a={Max:88,Min:8};if(t.length>1&&e.length>1){var i=t[0],r=t[t.length-1],n=e[0],o=e[e.length-1],s=r-i,h=o-n,l=Math.max(s,h),u={Min:i,Max:i+l},C={Max:o,Min:o-l};a={Max:u.Max,Min:C.Min}}this.Frame.SetPriceList(t,e);var D=this.Frame.VerticalRange;D.Max=a.Max,D.Center=a.Min+(a.Max-a.Min)/2,D.Min=a.Min,D.MaxDiffer=l,D.Ask=u,D.Bid=C,sa.IsNumber(D.Differ)||(D.Differ=l*this.DefaultZoom),D.Min=D.Center-D.Differ,D.Max=D.Center+D.Differ},this.UpdateFrameMaxMin=function(){var t=this.ChartPaint[0].GetMaxMin();this.Frame.HorizontalMax=t.Max*this.MaxVolRate,this.Frame.HorizontalMin=0,this.Frame.XYSplit=!0},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var t=this,e=Pr.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.RequestDepthData()}),a))}}}}function cr(t,e){this.Name=t,this.Param=e,this.LineColor,this.ReqeustData=null}function mr(t){this.Index,this.Name=t,this.Script=null,this.ClassName="BaseIndex",this.OverlayIndex=null,this.GetEventCallback,this.Status=0,this.Guid=N(),this.Create=function(t,e){},this.NotSupport=function(t,e,a){var i=this.IsOverlay();if(!i){t.DeleteIndexPaint(e);var r=t.Frame.SubFrame[e].Frame,n=new _t;n.Canvas=t.Canvas,n.ChartBorder=r.ChartBorder,n.ChartFrame=r,n.NotSupportMessage=a,t.ChartPaint.push(n)}},this.FormatIndexTitle=function(){var t=this.Name,e=null;for(var a in this.Index){var i=this.Index[a];null!=i.Param&&(e?e+=","+i.Param.toString():e=i.Param.toString())}return e&&(t+="("+e+")"),t},this.IsOverlay=function(){return!(!this.OverlayIndex||1!=this.OverlayIndex.IsOverlay)},this.CreateChart=function(t){return new Vt},this.CreatePaints=function(t,e){var a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var r=[];for(var n in this.Index){var o=this.CreateChart(n);o.Color=this.Index[n].LineColor,o.Canvas=t.Canvas,o.Name=this.Name+"-"+n.toString(),o.ChartBorder=a.ChartBorder,o.ChartFrame=a,i?this.OverlayIndex.Frame.ChartPaint.push(o):t.ChartPaint.push(o),r.push(o)}return r},this.SendEvent=function(t,e,a,i){if(t.GetIndexEvent){var r=t.GetIndexEvent();if(r){var n={Data:this.GetOutData(),WindowIndex:e,Name:this.Name,HistoryData:a,Stock:{Symbol:t.Symbol,Name:t.Name}};i&&(n.Error=i),r.Callback(r,n,self)}}},this.GetOutData=function(){return null}}function dr(){this.newMethod=mr,this.newMethod("OX"),delete this.newMethod,this.ClassName="JSIndex_OX",this.IsUsePageData=!0,this.BlockSize=.5,this.Arguments=[{Name:"Reversal",Value:3}],this.SetArgs=function(t){if(t&&sa.IsNonEmptyArray(t))for(var e=0;e<t.length;++e){var a=t[e];"Reversal"==a.Name&&this.SetParamValue(a.Name,a.Value)}},this.SetParamValue=function(t,e){for(var a=0;a<this.Arguments.length;++a){var i=this.Arguments[a];i.Name==t&&(i.Value=e)}},this.GetParamValue=function(t){for(var e=0;e<this.Arguments.length;++e){var a=this.Arguments[e];if(a.Name==t)return a.Value}},this.RequestData=function(t,e,a){return this.BindData(t,e,a),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),!0},this.CreatePaints=function(t,e){var a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var r=[],n=new Oe;return n.Canvas=t.Canvas,n.Name=this.Name+"-0",n.ChartBorder=a.ChartBorder,n.ChartFrame=a,i?this.OverlayIndex.Frame.ChartPaint.push(n):t.ChartPaint.push(n),r.push(n),r},this.CalculateBlockSize=function(t,e){var a=t-e;return a<=5?.25:a<=20?.5:a<=100?1:a<=200?2:a<=500?5:a<=1e3?10:50},this.Calculate=function(t,e){if(!t.ChartPaint[0])return null;var a=t.ChartPaint[0].ShowRange;if(!a)return null;if(!sa.IsNonEmptyArray(e.Data))return null;for(var i=null,r=null,n=null,o=a.Start;o<=a.End&&o<e.Data.length;++o){var s=e.Data[o];null==i?sa.IsNumber(s.High)&&(i=s.High):sa.IsNumber(s.High)&&i<s.High&&(i=s.High),null==r?sa.IsNumber(s.Low)&&(r=s.Low):sa.IsNumber(s.Low)&&r>s.Low&&(r=s.Low),null==n&&sa.IsNumber(s.High)&&(n=s.High)}var h=this.GetParamValue("Reversal"),l=this.CalculateBlockSize(i,r);this.BlockSize=l;for(var u={Max:i+l,Min:r-l,StartPrice:n,Data:[],BlockSize:l},C=1,D=n,f={Type:0,Data:[],Start:null,End:null},c=(o=a.Start,0);o<=a.End&&o<e.Data.length;++o){s=e.Data[o];if(1==C){if(s.High>=D+l){var m=parseInt((s.High-D)/l);for(c=0;c<m;++c)D+=l,f.Data.push(D)}else if(s.Low<=D-l*h){C=0,f&&sa.IsNonEmptyArray(f.Data)&&u.Data.push(f),f={Type:1,Data:[],Start:null,End:null};m=parseInt((D-s.Low)/l);for(c=0;c<m;++c)D-=l,f.Data.push(D)}}else if(s.Low<=D-l){m=parseInt((D-s.Low)/l);for(c=0;c<m;++c)D-=l,f.Data.push(D)}else if(s.High>=D+l*h){C=1,f&&sa.IsNonEmptyArray(f.Data)&&u.Data.push(f),f={Type:0,Data:[],Start:null,End:null};m=parseInt((s.High-D)/l);for(c=0;c<m;++c)D+=l,f.Data.push(D)}null==f.Start&&(f.Start=s),f.End=s}return f&&sa.IsNonEmptyArray(f.Data)&&u.Data.push(f),u},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay(),n=t.GetEventCallback(m.ON_CALCULATE_INDEX_OX);if(n&&n.Callback){var o={HQChart:t,WidnowIndex:e,HisData:a,OXData:null};n.Callback(n,o,this),i[0].OXData=o.OXData}else i[0].OXData=this.Calculate(t,a);var s=this.BlockSize,h=this.GetParamValue("Reversal"),l="".concat(this.Name," BlockSize=").concat(s," Reversal=").concat(h),u=e+1;if(r){var C=t.TitlePaint[u];C.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:""})}else t.TitlePaint[u].Title=l;return!0}}function Ir(t){this.newMethod=mr,this.newMethod("VRVR"),delete this.newMethod,this.ClassName="VolProfileVisibleRangeIndex",this.IsUsePageData=!0,this.ChartVolProfile,this.HQChart,this.WindowIndex,this.RequestTimer=null,this.DelayRequestFrequency=500,this.VolType=0,this.BarPosition=1,this.BarWidthRate=.3,this.Arguments=[{Name:"VAVol",Value:70},{Name:"BarPosition",Value:0}],this.SetArgs=function(t){if(t&&sa.IsNonEmptyArray(t))for(var e=0;e<t.length;++e){var a=t[e];("VAVol"==a.Name||"BarPosition"==a.Name)&&this.SetParamValue(a.Name,a.Value)}},this.SetParamValue=function(t,e){for(var a=0;a<this.Arguments.length;++a){var i=this.Arguments[a];i.Name==t&&(i.Value=e)}},t&&(sa.IsNumber(t.VolType)&&(this.VolType=t.VolType),sa.IsNumber(t.BarWidthRate)&&(this.BarWidthRate=t.BarWidthRate),sa.IsNumber(t.DelayRequestFrequency)&&(this.DelayRequestFrequency=t.DelayRequestFrequency),t.Args&&this.SetArgs(t.Args),sa.IsNumber(t.BarPosition)&&(this.BarPosition=t.BarPosition,this.SetParamValue("BarPosition",this.BarPosition))),this.GetParamValue=function(t){for(var e=0;e<this.Arguments.length;++e){var a=this.Arguments[e];if(a.Name==t)return a.Value}},this.Create=function(t,e){this.HQChart=t,this.WindowIndex=e},this.CreateChart=function(t,e){var a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var r=[],n=new be;return n.Canvas=t.Canvas,n.Name=this.Name+"-0",n.ChartBorder=a.ChartBorder,n.ChartFrame=a,n.HQChart=this.HQChart,n.Identify=this.Guid,n.SetOption(this),i?this.OverlayIndex.Frame.ChartPaint.push(n):t.ChartPaint.push(n),r.push(n),this.ChartVolProfile=n,r},this.CancelRequestTimer=function(){this.RequestTimer&&(clearTimeout(this.RequestTimer),this.RequestTimer=null)},this.RequestData=function(t,e,a,i){var r=this;this.CancelRequestTimer();var n=function(){var e=t.ChartPaint[0],a=e.Data;if(a&&!sa.IsNonEmptyArray(!a.Data)){var i=e.DrawKRange;if(i&&sa.IsNumber(i.Start)&&sa.IsNumber(i.End)){var n=a.Data[i.Start],o=a.Data[i.End],s={Start:{Date:n.Date,DataIndex:i.Start},End:{Date:o.Date,DataIndex:i.End},Chart:r};sa.IsNumber(n.Time)&&(s.Start.Time=n.Time),sa.IsNumber(o.Time)&&(s.End.Time=o.Time),s.ValueAreaVol=r.Arguments[0].Value,r.Arguments[1].Value>0?r.BarPosition=1:r.BarPosition=0,r.ChartVolProfile&&r.ChartVolProfile.SetOption({BarPosition:r.BarPosition}),r.DataStatus=0,t&&t.RequestVolumeProfileData&&t.RequestVolumeProfileData(s)}}};return i&&1==i.Type?this.RequestTimer=setTimeout((function(){n()}),this.DelayRequestFrequency):n(),!0},this.OnRecvVolumeProfileData=function(t){return this.BindData(t),this.HQChart.UpdataDataoffset(),this.HQChart.UpdateFrameMaxMin(),this.HQChart.Draw(),!0},this.BindData=function(t){this.ChartVolProfile&&1!=this.ChartVolProfile.IsDestroy||this.CreateChart(this.HQChart,this.WindowIndex);var e=this.ChartVolProfile;if(e.Data=null,t&&sa.IsNonEmptyArray(t.Data)&&sa.IsNumber(t.MaxPrice)&&sa.IsNumber(t.MinPrice)){for(var a=0,i=0,r=null,n=0,o=0;n<t.Data.length;++n){var s=t.Data[n];for(i=0,o=0;o<s.Vol.length;++o){var h=s.Vol[o];sa.IsNumber(h.Value)&&(i+=h.Value)}a<i&&(a=i,r=s.Price)}if(!(this.maxVolPrice<=0||this.maxVol<=0)){e.MaxVolPrice=r,e.MaxVol=a,e.MaxPrice=t.MaxPrice,e.MinPrice=t.MinPrice,e.Data=t;var l=this.WindowIndex+1;this.HQChart.TitlePaint[l].Title="VPVR",this.HQChart.TitlePaint[l].Identify=this.Guid;var u=new _a(e.Data,"VPVR",e.Data);u.ChartClassName="ChartVolProfileVisibleRange",u.Chart=e,this.HQChart.TitlePaint[l].Data[0]=u}}}}function Sr(){this.newMethod=mr,this.newMethod("CJL"),delete this.newMethod,this.Index=new Array(new cr("VOL",null),new cr("OPID",null)),this.Index[0].LineColor=qi.Index.LineColor[0],this.Index[1].LineColor=qi.Index.LineColor[1],this.CreateChart=function(t){if(0==t){var e=new $t;return e}if(1==t){e=new Wt;return e.LineWidth=1*F(),e}},this.RequestData=function(t,e,a){return this.BindData(t,e,a),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),!0},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;var n=a.GetVol(),o=a.GetPosition();i[0].HistoryData=a,i[0].Data.Data=n,i[1].Data.Data=o;var s=e+1;if(r){var h=t.TitlePaint[s];for(var l in h.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:""}),i){var u=new _a(i[l].Data,this.Index[l].Name,this.Index[l].LineColor);h.OverlayIndex.get(this.OverlayIndex.Identify).Data[l]=u}}else t.TitlePaint[s].Data[0]=new _a(i[0].Data,this.Index[0].Name,this.Index[0].LineColor),t.TitlePaint[s].Data[1]=new _a(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[s].Title=this.Name;return!0}}function Tr(t,e,a,i){this.newMethod=mr,this.newMethod(t),delete this.newMethod,this.Script=e,this.Arguments=[],this.OutVar=[],this.ApiUrl=qi.PyIndexDomain+"/hq/code",a&&(this.Arguments=a),this.RequestData=function(t,e,a){this.OutVar=[];var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a},n="";for(var o in this.Arguments){n.length>0&&(n+=",");var s=this.Arguments[o];n+='"'+s.Name+'":'+s.Value}n="{"+n+"}";var h=JSON.parse(n),l=JSON.stringify({code:this.Script,symbol:r.HQChart.Symbol,period:r.HQChart.Period,right:r.HQChart.Right,params:h,numcount:t.MaxRequestDataCount});return io.HttpRequest({url:this.ApiUrl,data:l,type:"post",dataType:"json",contentType:" application/json; charset=utf-8",async:!0,success:function(t){i.RecvData(t,r)},complete:function(t){},error:function(t,e){i.RecvError(t,e,r)}}),!0},this.RecvError=function(t,e,a){u.Chart.Log("[PyScriptIndex::RecvError] error",e),a.HQChart.ScriptErrorCallback&&a.HQChart.ScriptErrorCallback(e)},this.RecvData=function(t,e){if(0!=t.code)return u.Chart.Log("[PyScriptIndex::RecvData] failed.",t),void(e.HQChart.ScriptErrorCallback&&e.HQChart.ScriptErrorCallback(t.msg));u.Chart.Log("[PyScriptIndex::RecvData] recv data.",t);var a=t.date;for(var i in t.data){for(var r=t.data[i],n=[],o=0;o<a.length&&o<a.length;++o)if(!(o>=r.data.length)){var s=new Dt;s.Date=a[o],s.Value=r.data[o],n.push(s)}var h=e.HistoryData.GetFittingData(n),l=new dt;l.Data=h,l.Period=e.HQChart.Period,l.Right=e.HQChart.Right;var C={Name:r.name,Type:r.graph,LineWidth:r.width,Data:l.GetValue(),Color:r.color};this.OutVar.push(C)}this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()},this.BindData=function(t,e,a){for(var i in t.DeleteIndexPaint(e),this.OutVar){var r=this.OutVar[i];switch(r.Type){case"line":this.CreateLine(t,e,r,i);break;case"colorstick":this.CreateColorStock(t,e,r,i);break}}var n=e+1;t.TitlePaint[n].Title=this.Name;var o="";for(var s in this.Arguments){var h=this.Arguments[s];o.length>0&&(o+=","),o+=h.Value.toString()}return o.length>0&&(t.TitlePaint[n].Title=this.Name+"("+o+")"),!0},this.CreateLine=function(t,e,a,i){var r=new Vt;r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=a.Color:r.Color=this.GetDefaultColor(i),a.LineWidth>0&&(r.LineWidth=a.LineWidth),0==a.IsShow&&(r.IsShow=!1);var n=e+1;r.Data.Data=a.Data,t.TitlePaint[n].Data[i]=new _a(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateColorStock=function(t,e,a,i){var r=new ce;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame;var n=e+1;r.Data.Data=a.Data,t.TitlePaint[n].Data[i]=new _a(r.Data,a.Name,this.GetDefaultColor(i)),t.ChartPaint.push(r)},this.GetDefaultColor=function(t){var e=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],a=parseInt(t);return e[a%(e.length-1)]}}function vr(t,e,a,i){this.newMethod=Tr,this.newMethod(t),delete this.newMethod,this.JsonData,i.JsonData&&(this.JsonData=i.JsonData),this.RequestData=function(t,e,a){if(this.JsonData){var i={HQChart:t,WindowIndex:e,HistoryData:a};this.JsonData.code=0;var r=this.JsonData;this.RecvData(r,i)}else console.warn("[PyScriptIndex::RequestData] JsonData is null"),i.HQChart.ScriptErrorCallback&&i.HQChart.ScriptErrorCallback("json 数据不能为空")}}function pr(){}function gr(){this.MaxRequestDataCount=1e3,this.StartDate=20160101,this.Data,this.ClassName="IKLineInfo",this.Explain="IKLineInfo",this.GetToday=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();return e},this.GetRequestData=function(t){var e={Symbol:t.Symbol,MaxRequestDataCount:t.MaxRequestDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Period:t.Period},a=null;return t.ChartOperator_Temp_GetHistoryData&&(a=t.ChartOperator_Temp_GetHistoryData()),a&&(e.DateRange=a.GetDateRange()),e},this.NetworkFilter=function(t,e){if(!t.NetworkFilter)return!1;var a=this,i={HQChart:t},r={Name:"".concat(this.ClassName,"::RequestData"),Explain:this.Explain,Request:this.GetRequestData(t),Self:this,HQChart:t,PreventDefault:!1};return e&&(1==e.Update&&(r.Update={Start:{Date:e.StartDate}},i.Update={Start:{Date:e.StartDate}}),r.CallFunctionName=e.FunctionName),t.NetworkFilter(r,(function(t){a.RecvData(t,i)})),1==r.PreventDefault}}function xr(){this.newMethod=gr,this.newMethod(),delete this.newMethod,this.ClassName="InvestorInfo",this.Explain="互动易",this.RequestData=function(t,e){var a=this,i={HQChart:t};if(this.Data=[],!this.NetworkFilter(t,e)){var r={filed:["question","answerdate","symbol","id"],symbol:[i.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxRequestDataCount},n=qi.Domain+qi.KLine.Info.Investor.ApiUrl;return io.HttpRequest({url:n,data:r,type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0}},this.RecvData=function(t,e){if(!(t.list.length<=0)){for(var a in t.list){var i=t.list[a],r=new ct;r.Date=i.answerdate,r.Title=i.question,r.InfoType=ft.INVESTOR,this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function Fr(){this.newMethod=gr,this.newMethod(),delete this.newMethod,this.ClassName="AnnouncementInfo",this.Explain="公告",this.ApiType=1,this.RequestData=function(t,e){var a=this,i={HQChart:t};if(e&&!0===e.Update||(this.Data=[]),!this.NetworkFilter(t,e))if(1==this.ApiType){var r="".concat(qi.CacheDomain,"/cache/analyze/shszreportlist/").concat(i.HQChart.Symbol,".json");io.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)},error:function(t,e){a.RecvError(t,e,i)}})}else{r=qi.Domain+qi.KLine.Info.Announcement.ApiUrl;io.HttpRequest({url:r,data:{filed:["title","releasedate","symbol","id"],symbol:[i.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)},error:function(t,e){a.RecvError(t,e,i)}})}},this.RecvData=function(t,e){if(sa.IsNonEmptyArray(t.report)){for(var a=[],i=0;i<t.report.length;++i){var r=t.report[i],n=new ct;for(var o in n.Date=r.releasedate,n.Title=r.title,n.InfoType=ft.ANNOUNCEMENT,sa.IsNumber(r.time)&&(n.Time=r.time),r.type){var s=r.type[o];switch(s){case"一季度报告":n.InfoType=ft.ANNOUNCEMENT_QUARTER_1;break;case"半年度报告":n.InfoType=ft.ANNOUNCEMENT_QUARTER_2;break;case"三季度报告":n.InfoType=ft.ANNOUNCEMENT_QUARTER_3;break;case"年度报告":n.InfoType=ft.ANNOUNCEMENT_QUARTER_4;break}}for(var o in r.typeex){var h=r.typeex[o];n.InfoType=ft.ANNOUNCEMENT_EX_START+h;break}a.push(n)}!0===t.Update&&this.Data.length>0?this.UpdateData(a):this.Data=a,e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}},this.UpdateData=function(t){if(t&&!(t.length<=0)){var e=new Set;for(var a in this.Data){var i=this.Data[a],r="".concat(i.Date,"-").concat(i.Time,"-").concat(i.InfoType,"-").concat(i.Title);e.add(r)}var n=0;for(var a in t){i=t[a],r="".concat(i.Date,"-").concat(i.Time,"-").concat(i.InfoType,"-").concat(i.Title);e.has(r)||(this.Data.push(i),++n)}u.Chart.Log("[AnnouncementInfo::UpdateData] add new count=".concat(n))}},this.RecvError=function(t,e,a){console.warn("[AnnouncementInfo::RecvError] error, http ",e,t)}}function Er(){this.newMethod=gr,this.newMethod(),delete this.newMethod,this.ClassName="PforecastInfo",this.Explain="业绩预告",this.RequestData=function(t,e){this.Data=[];qi.Domain,qi.KLine.Info.Pforecast.ApiUrl;if(!this.NetworkFilter(t,e))return console.warn("[PforecastInfo::RequestData] NetworkFilter error."),!0},this.RecvData=function(t,e){if(sa.IsNonEmptyArray(t.report)){for(var a=0;a<t.report.length;++a){var i=t.report[a],r=new ct;r.Date=i.date,r.Title=i.title,r.InfoType=ft.PFORECAST,r.ExtendData={Type:i.title,ReportDate:i.reportdate},i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function Lr(){this.newMethod=gr,this.newMethod(),delete this.newMethod,this.ClassName="ResearchInfo",this.Explain="调研",this.RequestData=function(t,e){this.Data=[];qi.Domain,qi.KLine.Info.Research.ApiUrl;if(!this.NetworkFilter(t,e))return console.warn("[ResearchInfo::RequestData] NetworkFilter error."),!0},this.RecvData=function(t,e){if(sa.IsNonEmptyArray(t.list)){for(var a=0;a<t.list.length;++a){var i=t.list[a],r=new ct;r.ID=i.id,r.Date=i.researchdate,r.InfoType=ft.RESEARCH,r.ExtendData={Level:i.level,Type:i.type},this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function Mr(){this.newMethod=gr,this.newMethod(),delete this.newMethod,this.ClassName="BlockTrading",this.Explain="大宗交易",this.RequestData=function(t,e){var a=this,i={HQChart:t};this.Data=[];var r=qi.Domain+qi.KLine.Info.BlockTrading.ApiUrl;if(!this.NetworkFilter(t,e))return io.HttpRequest({url:r,data:{field:["blocktrading.price","blocktrading.vol","blocktrading.premium","fweek","price"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["blocktrading.vol","int32","gte","0"]}],symbol:[i.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var a in t.stock[0].stockday){var i=t.stock[0].stockday[a],r=new ct;r.Date=i.date,r.InfoType=ft.BLOCKTRADING,r.ExtendData={Price:i.blocktrading.price,Premium:i.blocktrading.premium,Vol:i.blocktrading.vol,ClosePrice:i.price},i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function yr(){this.newMethod=gr,this.newMethod(),delete this.newMethod,this.ClassName="TradeDetail",this.Explain="大宗交易",this.RequestData=function(t,e){var a=this,i={HQChart:t};this.Data=[];var r=qi.Domain+qi.KLine.Info.TradeDetail.ApiUrl;if(!this.NetworkFilter(t,e))return io.HttpRequest({url:r,data:{field:["tradedetail.typeexplain","tradedetail.type","fweek"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["tradedetail.type","int32","gte","0"]}],symbol:[i.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var a in t.stock[0].stockday){var i=t.stock[0].stockday[a],r=new ct;for(var n in r.Date=i.date,r.InfoType=ft.TRADEDETAIL,r.ExtendData={Detail:new Array},i.tradedetail){var o=i.tradedetail[n];r.ExtendData.Detail.push({Type:o.type,TypeExplain:o.typeexplain})}i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function Rr(){}function Nr(){this.Data,this.ClassName="IMinuteInfo"}function wr(){this.newMethod=Nr,this.newMethod(),delete this.newMethod,this.ClassName="MarketEventInfo",this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t},i=qi.CacheDomain+"/cache/analyze/shszevent/marketevent/concept/"+t.TradeDate+".json";if(t.NetworkFilter){var r={Name:"MarketEventInfo::RequestData",Explain:"大盘异动",Request:{Url:i,Type:"Get",Data:{Date:t.TradeDate,Symbol:t.Symbol}},Self:this,PreventDefault:!1};if(t.NetworkFilter(r,(function(t){e.RecvData(t,a),a.HQChart.UpdataChartInfo(),a.HQChart.Draw()})),1==r.PreventDefault)return}return io.HttpRequest({url:i,type:"get",dataType:"json",async:!0,success:function(t){e.RecvData(t,a)},error:function(t,e){console.warn("[MarketEventInfo::RequestData] error, http ",e,t)}}),!0},this.RecvData=function(t,e){for(var a in t.event){var i=t.event[a];for(var r in i.data){var n=i.data[r];if(Array.isArray(n)){if(n.length<2)continue;var o={Date:i.date,Time:n[0],Title:n[1],Type:0};n.length>=3&&n[2]&&"string"==typeof n[2]&&(o.Color=n[2]),n.length>=4&&n[3]&&"string"==typeof n[3]&&(o.BGColor=n[3]),this.Data.push(o)}else{if(!sa.IsNumber(n.Date)||!sa.IsNumber(n.Time)||!n.Title)continue;o={Date:n.Date,Time:n.Time,Title:n.Title,Type:0};n.Color&&(o.Color=n.Color),n.BGColor&&(o.BGColor=n.BGColor),sa.IsNumber(n.Price)&&(o.Price=n.Price),n.Content&&(o.Content=n.Content),n.Link&&(o.Link=n.Link),this.Data.push(o)}}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}or.JsonDataToHistoryData=function(t){var e=[];if(!t.data)return e;var a=null;t.symbol&&(a=t.symbol.toUpperCase());a&&Pr.IsFutures(a);for(var i=t.data,r=T.KLINE_ORDERFLOW,n=T.KLINE_COLOR_DATA,o=T.KLINE_HEATMAP,s=T.KLINE_DAY_EXTENDDATA,h=0;h<i.length;++h){var l=new ht,u=i[h];l.Date=u[0],l.Open=u[2],l.YClose=u[1],l.Close=u[5],l.High=u[3],l.Low=u[4],l.Vol=u[6],l.Amount=u[7],sa.IsNumber(u[8])&&(l.Position=u[8]),sa.IsNumber(u[9])&&(l.FClose=u[9]),sa.IsNumber(u[10])&&(l.YFClose=u[10]),sa.IsNumber(u[15])&&(l.FlowCapital=u[15]),sa.IsNumber(u[11])&&(l.BFactor=u[11]),sa.IsNumber(u[12])&&(l.AFactor=u[12]),sa.IsBool(u[13])&&(l.IsVirtual=u[13]),sa.IsBool(u[14])&&(l.IsNonTrade=u[14]),(sa.IsNumber(l.Open)||!0===l.IsVirtual)&&(u[r]&&(l.OrderFlow=u[r]),u[n]&&(l.ColorData=u[n]),u[s]&&(l.ExtendData=u[s]),u[o]&&(l.HeatMap=u[o]),e.push(l))}return e},or.JsonDataToRealtimeDataV2=function(t,e){if(!sa.IsNonEmptyArray(t.stock))return null;for(var a=null,i=0;i<t.stock.length;++i){var r=t.stock[i];if(r.symbol==e){a=r;break}}return a?or.JsonDataToHistoryData(a):null},or.JsonDataToRealtimeData=function(t,e){if(!t.stock)return null;var a;for(var i in t.stock){var r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase(),o=(Pr.IsSHSZ(n),new ht);return o.Date=a.date,o.Open=a.open,o.YClose=a.yclose,o.High=a.high,o.Low=a.low,o.Vol=a.vol,o.Amount=a.amount,o.Close=a.price,sa.IsNumber(a.position)&&(o.Position=a.position),sa.IsNumber(a.yclearing)&&(o.YFClose=a.yclearing),sa.IsNumber(a.clearing)&&(o.FClose=a.clearing),sa.IsNumber(a.bfactor)&&(o.BFactor=a.bfactor),sa.IsNumber(a.afactor)&&(o.AFactor=a.afactor),a.colordata&&(o.ColorData=a.colordata),a.extendData&&(o.ExtendData=a.extendData),a.heatmapData&&(o.HeatMap=a.heatmapData),sa.IsBool(a.isvirtual)&&(o.IsVirtual=a.isvirtual),sa.IsBool(a.isnontrade)&&(o.IsNonTrade=a.isnontrade),sa.IsNumber(a.flowCapital)&&(o.FlowCapital=a.flowCapital),o},or.JsonDataToMinuteRealtimeData=function(t,e){if(!t.stock)return null;var a;for(var i in t.stock){var r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase(),o=(Pr.IsSHSZ(n),Pr.IsFutures(n)),s=new Array,h=a.yclose,l=a.date;for(var i in o&&a.yclearing&&(h=a.yclearing),a.minute){var u=a.minute[i],C=new ht;C.Close=u.price,C.Open=u.open,C.High=u.high,C.Low=u.low,C.Vol=u.vol,C.Amount=u.amount,u.date>0?C.Date=u.date:C.Date=l,C.Time=u.time,C.YClose=h,sa.IsNumber(u.position)&&(C.Position=u.position),sa.IsNumber(C.Close)||(C.Close=h,C.Open=C.High=C.Low=C.Close),sa.IsNumber(C.Open)||(C.Open=null),sa.IsNumber(C.Close)||(C.Close=null),sa.IsNumber(C.High)||(C.High=null),sa.IsNumber(C.Low)||(C.Low=null),sa.IsNumber(u.price)&&(h=u.price),s[i]=C}return s},or.JsonDataToMinuteRealtimeDataV2=function(t,e){if(!t||!t.overlay||!e)return null;for(var a=null,i=0;i<t.overlay.length;++i){var r=t.overlay[i];if(r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase(),o=(Pr.IsSHSZ(n),Pr.IsFutures(n),T.KLINE_ORDERFLOW),s=null,h=[];for(i=0;i<a.data.length;++i){r=new ht;var l=a.data[i];r.Date=l[0],r.Open=l[2],r.YClose=l[1],r.Close=l[5],r.High=l[3],r.Low=l[4],r.Vol=l[6],r.Amount=l[7],r.Time=l[8],sa.IsNumber(l[9])&&(r.Position=l[9]),sa.IsNumber(r.YClose)||sa.IsNumber(s)&&(r.YClose=s),sa.IsNumber(r.Close)&&(s=r.Close),l[o]&&(r.OrderFlow=l[o]),h.push(r)}return h},or.JsonDataToMinuteHistoryData=function(t){var e=null;t.symbol&&(e=t.symbol.toUpperCase());e&&Pr.IsSHSZ(e);e&&Pr.IsFutures(e);for(var a=t.data,i=new Array,r=T.KLINE_ORDERFLOW,n=T.KLINE_COLOR_DATA,o=T.KLINE_HEATMAP,s=T.KLINE_MINUTE_EXTENDDATA,h=null,l=0;l<a.length;++l){var u=new ht,C=a[l];u.Date=C[0],u.Open=C[2],u.YClose=C[1],u.Close=C[5],u.High=C[3],u.Low=C[4],u.Vol=C[6],u.Amount=C[7],u.Time=C[8],sa.IsNumber(C[9])&&(u.Position=C[9]),sa.IsNumber(C[10])&&(u.FClose=C[10]),sa.IsNumber(C[11])&&(u.YFClose=C[11]),sa.IsNumber(C[12])&&(u.BFactor=C[12]),sa.IsNumber(C[13])&&(u.AFactor=C[13]),sa.IsNumber(u.YClose)||sa.IsNumber(h)&&(u.YClose=h),sa.IsNumber(u.Close)&&(h=u.Close),C[r]&&(u.OrderFlow=C[r]),C[n]&&(u.ColorData=C[n]),C[s]&&(u.ExtendData=C[s]),C[o]&&(u.HeatMap=C[o]),i.push(u)}return i},or.JsonDataToTickData=function(t){var e=[];if(!t.detail)return e;var a=t.date,i=t.yclose;for(var r in t.detail){var n=new ht,o=t.detail[r];o&&(n.Date=a,n.Time=o[0],n.Low=n.High=n.Close=n.Open=o[1],n.YClose=i,n.Vol=o[2],n.Amount=o[3],n.Flag=o[4],sa.IsNumber(n.Open)&&e.push(n))}return e},or.JsonDataToTickDataV2=function(t){var e=[];if(!sa.IsNonEmptyArray(t.data))return e;for(var a=0;a<t.data.length;++a){var i=new ht,r=t.data[a];r&&(i.Date=r[0],i.Time=r[1],i.YClose=r[2],i.Low=i.High=i.Close=i.Open=r[3],e.push(i),r[4]&&(i.ExtendData=r[4]))}return e},sr.JsonDataToBeforeOpenData=function(t){var e=t.stock[0].symbol,a=e.toUpperCase(),i=(Pr.IsSHSZ(a),Pr.GetVolUnit(a)),r=t.stock[0].yclose,n=t.stock[0].yclose,o=t.stock[0],s=o.date,h={Data:[],TotalCount:15,Ver:1,Date:s},l=T.MINUTE_BEFOREOPEN_EXTENDDATA;if(o.beforeinfo&&(sa.IsNumber(o.beforeinfo.totalcount)&&(h.TotalCount=o.beforeinfo.totalcount),sa.IsNumber(o.beforeinfo.ver)&&(h.Ver=o.beforeinfo.ver)),1==h.Ver){if(sa.IsNonEmptyArray(o.before))for(var u=0;u<o.before.length;++u){var C=new ut,D=o.before[u];C.YClose=r,C.Time=D[0],C.Date=s,C.Price=D[1],C.Price?n=C.Price:C.Price=n,C.Vol[0]=D[2],C.Amount=D[3],sa.IsNumber(D[4])&&D[4]>19000101&&(C.Date=D[4]),C.DateTime="".concat(C.Date," ").concat(C.Time),h.Data.push(C)}}else if(2==h.Ver){var f=0;for(var u in o.before){C=new ut,D=o.before[u];C.YClose=r,C.Time=D[0],C.Date=s,C.Price=D[1],C.Vol[0]=D[2],C.Vol[1]=D[3],C.ColorID=D[4],sa.IsNumber(D[6])&&(C.Date=D[6]),C.DateTime="".concat(C.Date," ").concat(C.Time,")");var c=C.Vol[0]+C.Vol[1];sa.IsNumber(D[5])&&(c=D[5]),c>f&&(f=c),D[l]&&(C.ExtendData=D[l]),h.Data.push(C)}h.VolMax=f/i,h.VolMin=0}else if(3==h.Ver){f=0;for(var u in o.before){C=new ut,D=o.before[u];C.YClose=r,C.Time=D[0],C.Date=s,C.Price=D[1],C.AvPrice=D[2],C.Vol[0]=D[3],C.ColorID=D[4],C.DateTime=s.toString()+" "+C.Time.toString();c=C.Vol[0];sa.IsNumber(D[5])&&(c=D[5]),c>f&&(f=c),D[l]&&(C.ExtendData=D[l]),h.Data.push(C)}h.VolMax=f/i,h.VolMin=0}return h},sr.JsonDataToAfterCloseData=function(t){var e=t.stock[0].yclose,a=(t.stock[0].yclose,t.stock[0]),i=a.date;if(!a.afterinfo)return null;var r=t.stock[0].symbol,n=r.toUpperCase(),o={Data:[],TotalCount:180,Ver:2,Date:i},s=a.afterinfo;sa.IsNumber(s.totalcount)&&(o.TotalCount=s.totalcount),sa.IsNumber(s.ver)&&(o.Ver=s.ver);var h=T.MINUTE_AFTERCLOSE_EXTENDDATA,l=Pr.GetVolUnit(n);if(1==o.Ver)for(var u=0;u<a.after.length;++u){s=new Ct;var C=a.after[u];s.YClose=e,s.Time=C[0],s.Date=i,s.Price=C[1],s.Vol[0]=C[2],s.Amount=C[3],sa.IsNumber(C[4])&&(s.Date=C[4]),s.DateTime="".concat(s.Date," ").concat(s.Time),o.Data.push(s)}else if(2==o.Ver){var D=0;for(var u in a.after){s=new Ct,C=a.after[u];s.YClose=e,s.Time=C[0],s.Date=i,s.Price=C[1],s.Vol[0]=C[2],s.Vol[1]=C[3],s.ColorID=C[4],s.DateTime=i.toString()+" "+s.Time.toString();var f=s.Vol[0]+s.Vol[1];sa.IsNumber(C[5])&&(f=C[5]),f>D&&(D=f),C[h]&&(s.ExtendData=C[h]),o.Data.push(s)}o.VolMax=D/l,o.VolMin=0}else if(3==o.Ver){D=0;for(var u in a.after){s=new Ct,C=a.after[u];s.YClose=e,s.Time=C[0],s.Date=i,s.Price=C[1],s.AvPrice=C[2],s.Vol[0]=C[3],s.ColorID=C[4],s.DateTime=i.toString()+" "+s.Time.toString();f=s.Vol[0];sa.IsNumber(C[5])&&(f=C[5]),f>D&&(D=f),C[h]&&(s.ExtendData=C[h]),o.Data.push(s)}o.VolMax=D/l,o.VolMin=0}return o},sr.JsonDataToMinuteData=function(t,e){var a=t.stock[0].symbol,i=a.toUpperCase(),r=(Pr.IsSHSZ(i),Pr.IsFutures(i)),n=Pr.IsSHO(i),o=Pr.IsSZO(i),s=[],h=t.stock[0].yclose,l=t.stock[0].yclose,u=t.stock[0].yclose,C=t.stock[0].yclearing;if(r&&C&&(h=l=C),!sa.IsNonEmptyArray(t.stock[0].minute))return s;for(var D=t.stock[0].date,f=0;f<t.stock[0].minute.length;++f){var c=t.stock[0].minute[f],m=new lt;m.YClearing=C,m.YClose=u,m.Close=c.price,m.Open=c.open,m.High=c.high,m.Low=c.low,m.Vol=c.vol,m.Amount=c.amount,c.date>0&&(D=c.date),m.DateTime=D.toString()+" "+c.time.toString(),m.Date=D,m.Time=c.time,(r||n||o||sa.IsNumber(c.position))&&(m.Position=c.position),m.Increase=c.increase,m.Risefall=c.risefall,m.AvPrice=c.avprice,sa.IsNumber(c.lead)&&(m.Lead=c.lead),sa.IsNumber(m.Close)||(m.Close=h,m.Open=m.High=m.Low=m.Close),m.AvPrice||(m.AvPrice=l),u&&m.Close&&(m.Increase=(m.Close-u)/u*100),r&&C&&m.Close&&(m.Increase=(m.Close-C)/C*100),sa.IsNumber(c.price)&&(h=c.price),sa.IsNumber(c.avprice)&&m.AvPrice===c.avprice&&(l=c.avprice),c.ExtendData&&(m.ExtendData=c.ExtendData),s[f]=m}return s},sr.JsonDataToUpdateMinuteData=function(t){if(!t||!t.stock)return null;var e=t.stock[0];if(!sa.IsNumber(e.date))return null;var a=t.stock[0].symbol,i=a.toUpperCase(),r=(Pr.IsSHSZ(i),Pr.IsFutures(i)),n={Date:e.date,Data:[],Symbol:a,Name:e.name},o=T.MINUTE_DAY_EXTENDDATA;if(sa.IsNumber(e.high)&&(n.High=e.high),sa.IsNumber(e.low)&&(n.Low=e.low),sa.IsNumber(e.yclose)&&(n.YClose=e.yclose),sa.IsNumber(e.YClearing)&&(n.YClearing=e.yclearing),sa.IsNonEmptyArray(e.minute))for(var s=0;s<e.minute.length;++s){var h=e.minute[s],l=new lt;l.YClearing=n.YClearing,l.YClose=n.YClose,l.Date=h[0],l.Time=h[1],l.Open=h[2],l.High=h[3],l.Low=h[4],l.Close=h[5],l.AvPrice=h[6],l.Vol=h[7],l.Amount=h[8],sa.IsNumber(h[9])&&(l.Increase=h[9]),sa.IsNumber(h[10])&&(l.Risefall=h[10]),sa.IsNumber(h[11])&&(l.Lead=h[11]),sa.IsNumber(h[12])&&(l.Position=h[12]),h[o]&&(l.ExtendData=h[o]),l.DateTime="".concat(l.Date," ").concat(l.Time),sa.IsNumber(n.YClose)&&l.Close&&(l.Increase=(l.Close-n.YClose)/n.YClose*100),r&&n.YClearing&&l.Close&&(l.Increase=(l.Close-n.YClearing)/n.YClearing*100),n.Data.push(l)}return n},sr.JsonDataToMinuteLineColorData=function(t){if(!t||!t.stock[0])return null;var e=t.stock[0];if(!e.linecolor||!sa.IsNonEmptyArray(e.linecolor.data))return null;var a=[];for(var i in e.linecolor.data){var r=e.linecolor.data[i];if(sa.IsNumber(r.type)&&sa.IsNumber(r.date)&&sa.IsNumber(r.start)&&sa.IsNumber(r.end)&&r.color&&!(r.start>=r.end)){var n={Type:r.type,Date:r.date,Start:r.start,End:r.end,Color:r.color};sa.IsPlusNumber(r.linewidth)&&(n.LineWidth=r.linewidth),a.push(n)}}return a},sr.JsonDataToMinuteLastUpdateTime=function(t){if(!t||!t.stock[0])return null;var e=t.stock[0];return sa.IsNumber(e.date)&&sa.IsNumber(e.time)?{Date:e.date,Time:e.time}:null},sr.JsonDataToHistoryMinuteLastUpdateTime=function(t){if(!t||!t.updatetime)return null;var e=t.updatetime;return sa.IsNumber(e.date)&&sa.IsNumber(e.time)?{Date:e.date,Time:e.time}:null},sr.JsonDataToMinuteDataArray=function(t){var e=t.symbol,a=e.toUpperCase(),i=(Pr.IsSHSZ(a),Pr.IsSHO(a)),r=Pr.IsSZO(a),n=Pr.IsFutures(a),o=[],s=T.MINUTE_MULTI_DAY_EXTENDDATA;for(var h in t.data){var l=[],u=t.data[h],C=u.date,D=u.yclearing,f=u.yclose,c=f,m=null;for(var d in n&&D&&(c=m=D),u.minute){var I=u.minute[d];I[2]&&(c=I[2]);var S=new lt;S.YClearing=D,S.YClose=f,S.Close=I[2],S.Open=I[1],S.High=I[3],S.Low=I[4],S.Increase=null,S.Vol=I[5],S.Amount=I[6],7<I.length&&I[7]>0&&(S.AvPrice=I[7]),S.DateTime=C.toString()+" "+I[0].toString(),S.Date=C,S.Time=I[0],8<I.length&&I[8]>0&&(S.Date=I[8],S.DateTime=S.Date.toString()+" "+I[0].toString()),(n||i||r)&&9<I.length&&(S.Position=I[9]),sa.IsNumber(S.Close)||(S.Close=c,S.Open=S.High=S.Low=S.Close),!S.AvPrice&&m&&(S.AvPrice=m),S.Close&&f&&(S.Increase=(S.Close-f)/f*100),S.Close&&D&&n&&(S.Increase=(S.Close-D)/D*100),I.length>7&&I[7]>0&&S.AvPrice===I[7]&&(m=I[7]),I[s]&&(S.ExtendData=I[s]),l[d]=S}var v=new dt;v.Data=l,v.YClose=f,sa.IsNumber(D)&&(v.YClearing=D),v.Close=u.close,v.Date=C,o.push(v)}return o},sr.JsonDataToHistoryMinuteLineColorData=function(t){if(!t)return null;var e=[];for(var a in t.data){var i=t.data[a];if(i.linecolor)for(var r in i.linecolor.data){var n=i.linecolor.data[r];if(sa.IsNumber(n.type)&&sa.IsNumber(n.date)&&sa.IsNumber(n.start)&&sa.IsNumber(n.end)&&n.color&&!(n.start>=n.end)){var o={Type:n.type,Date:n.date,Start:n.start,End:n.end,Color:n.color};sa.IsPlusNumber(n.linewidth)&&(o.LineWidth=n.linewidth),e.push(o)}}}return e.length>0?e:null},sr.JsonDataToCallAuctionItem=function(t,e,a,i){var r=i?i.toUpperCase():null,n=Pr.GetVolUnit(r),o=e.Date,s=e.YClose,h=e.YClearing,l=a?T.MINUTE_BEFOREOPEN_EXTENDDATA:T.MINUTE_AFTERCLOSE_EXTENDDATA;if(1==e.Ver){var u=null;for(var C in t){var D=a?new ut:new Ct,f=t[C];D.YClose=s,D.YClearing=h,D.Time=f[0],D.Date=o,D.Price=f[1],D.Price?u=D.Price:D.Price=u,D.Vol[0]=f[2],D.Amount=f[3],sa.IsNumber(f[4])&&(D.Date=f[4]),D.DateTime="".concat(D.Date," ").concat(D.Time),e.Data.push(D)}}else if(2==e.Ver){var c=0;for(var C in t){D=a?new ut:new Ct,f=t[C];D.YClose=s,D.YClearing=h,D.Time=f[0],D.Date=o,D.Price=f[1],D.Vol[0]=f[2],D.Vol[1]=f[3],D.ColorID=f[4],D.DateTime=o.toString()+" "+D.Time.toString();var m=D.Vol[0]+D.Vol[1];sa.IsNumber(f[5])&&(m=f[5]),m>c&&(c=m),f[l]&&(D.ExtendData=f[l]),e.Data.push(D)}e.VolMax=c/n,e.VolMin=0}else if(3==beforeOpenData.Ver){c=0;for(var C in t){D=a?new ut:new Ct,f=t[C];D.YClose=s,D.YClearing=h,D.Time=f[0],D.Date=o,D.Price=f[1],D.AvPrice=f[2],D.Vol[0]=f[3],D.ColorID=f[4],D.DateTime=o.toString()+" "+D.Time.toString();m=D.Vol[0];sa.IsNumber(f[5])&&(m=f[5]),m>c&&(c=m),f[l]&&(D.ExtendData=f[l]),e.Data.push(D)}e.VolMax=c/n,e.VolMin=0}},sr.JosnDataToBeforeOpenDataArray=function(t){if(!t||!t.data)return null;var e=[];for(var a in t.data){var i=t.data[a],r={Data:[],TotalCount:15,Ver:1,Date:i.date,YClose:i.yclose,YClearing:i.YClearing};i.beforeinfo&&(sa.IsNumber(i.beforeinfo.totalcount)&&(r.TotalCount=i.beforeinfo.totalcount),sa.IsNumber(i.beforeinfo.ver)&&(r.Ver=i.beforeinfo.ver)),sr.JsonDataToCallAuctionItem(i.before,r,!0,t.symbol),e.push(r)}return e.sort((function(t,e){return t.Date-e.Date})),e},sr.JosnDataToAfterCloseDataArray=function(t){if(!t||!t.data)return null;var e=[];for(var a in t.data){var i=t.data[a],r={Data:[],TotalCount:15,Ver:1,Date:i.date,YClose:i.yclose,YClearing:i.YClearing};i.afterinfo&&(sa.IsNumber(i.afterinfo.totalcount)&&(r.TotalCount=i.afterinfo.totalcount),sa.IsNumber(i.afterinfo.ver)&&(r.Ver=i.afterinfo.ver)),sr.JsonDataToCallAuctionItem(i.after,r,!1,t.symbol),e.push(r)}return e.sort((function(t,e){return t.Date-e.Date})),e},Tr.prototype.GetDefaultColor=function(t){var e=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],a=parseInt(t);return e[a%(e.length-1)]},pr.Get=function(t){var e=new Map([["互动易",{Create:function(){return new xr}}],["公告",{Create:function(){return new Fr}}],["业绩预告",{Create:function(){return new Er}}],["调研",{Create:function(){return new Lr}}],["大宗交易",{Create:function(){return new Mr}}],["龙虎榜",{Create:function(){return new yr}}]]);return e.get(t)},pr.GetClassInfo=function(t){var e=new Map([["互动易",{ClassName:"InvestorInfo"}],["公告",{ClassName:"AnnouncementInfo"}],["业绩预告",{ClassName:"PforecastInfo"}],["调研",{ClassName:"ResearchInfo"}],["大宗交易",{ClassName:"BlockTrading"}],["龙虎榜",{ClassName:"TradeDetail"}]]);return e.get(t)},pr.GetIconUrl=function(t){switch(t){case ft.INVESTOR:return qi.KLine.Info.Investor.Icon;case ft.PFORECAST:return qi.KLine.Info.Pforecast.Icon;case ft.ANNOUNCEMENT:return qi.KLine.Info.Announcement.Icon;case ft.ANNOUNCEMENT_QUARTER_1:case ft.ANNOUNCEMENT_QUARTER_2:case ft.ANNOUNCEMENT_QUARTER_3:case ft.ANNOUNCEMENT_QUARTER_4:return qi.KLine.Info.Announcement.IconQuarter;case ft.RESEARCH:return qi.KLine.Info.Research.Icon;case ft.BLOCKTRADING:return qi.KLine.Info.BlockTrading.Icon;case ft.TRADEDETAIL:return qi.KLine.Info.TradeDetail.Icon;default:return qi.KLine.Info.Announcement.Icon}},pr.GetIconLibrary=function(t){var e=qi.KLine.Info.IconLibrary;if(!e||!e.Icon)return qi.KLine.Info.Announcement.IconFont;if(t>=0&&t<e.Icon.length){var a=e.Icon[t],i={Text:a.Text,HScreenText:a.HScreenText,Color:a.Color,Family:e.Family};return i}return qi.KLine.Info.Announcement.IconFont},pr.GetIconFont=function(t){if(t>=ft.ANNOUNCEMENT_EX_START&&t<=ft.ANNOUNCEMENT_EX_END){var e=t-ft.ANNOUNCEMENT_EX_START;return pr.GetIconLibrary(e)}switch(t){case ft.INVESTOR:return qi.KLine.Info.Investor.IconFont;case ft.PFORECAST:return qi.KLine.Info.Pforecast.IconFont;case ft.ANNOUNCEMENT:return qi.KLine.Info.Announcement.IconFont;case ft.ANNOUNCEMENT_QUARTER_1:case ft.ANNOUNCEMENT_QUARTER_2:case ft.ANNOUNCEMENT_QUARTER_3:case ft.ANNOUNCEMENT_QUARTER_4:return qi.KLine.Info.Announcement.IconFont2;case ft.RESEARCH:return qi.KLine.Info.Research.IconFont;case ft.BLOCKTRADING:return qi.KLine.Info.BlockTrading.IconFont;case ft.TRADEDETAIL:return qi.KLine.Info.TradeDetail.IconFont;default:return qi.KLine.Info.Announcement.IconFont}},Rr.InfoMap=new Map([["大盘异动",{Create:function(){return new wr}}]]),Rr.Get=function(t){return Rr.InfoMap.get(t)};var Ar=new function(){this.DataMap=new Map([["ChartPictureSettingMenu",{Create:function(t){return new br(t)}}]]),this.Create=function(t,e){if(!this.DataMap.has(t))return u.Chart.Warn("[DialogFactory::Create] can't find class=".concat(t,".")),null;var a=this.DataMap.get(t);return a.Create(e)},this.Add=function(t,e){this.DataMap.set(t,{Create:e.Create})}};function Or(t){this.DivElement=t,this.ID=null,this.TimeOut=null,this.Hide=function(){$("#"+this.ID).hide()},this.Show=function(t,e,a,i){var r={display:"block"};sa.IsNumber(t)&&(r.left=t+"px"),sa.IsNumber(e)&&(r.top=e+"px"),sa.IsNumber(a)&&(r.width=a+"px"),sa.IsNumber(i)&&(r.height=i+"px"),$("#"+this.ID).css(r)}}function br(t){this.newMethod=Or,this.newMethod(t),delete this.newMethod,this.HQChart,this.ChartPicture,this.SubToolsDiv,this.SettingMenu,this.SettingPV,this.DoModal=function(t){if(!this.SubToolsDiv){this.ID=N();var e=document.createElement("div");e.className="subTolls",e.id=this.ID,this.DivElement.appendChild(e),this.SubToolsDiv=e}this.HQChart=t.data.HQChart,this.ChartPicture=t.data.ChartPicture;var a=F(),i=this.HQChart.Frame.SubFrame[0].Frame,r=i.ChartBorder.Top+40,n=i.ChartBorder.Right,o=i.ChartBorder.GetLeft(),s=this.ChartPicture.ClassName,h=this.ChartPicture.LineColor;0!=h.indexOf("rgb(")&&0!=h.indexOf("RGB(")||(h=Ha.RGBToHex(h.toLowerCase()));var l="";l="ChartDrawPictureText"===s?'<span class="changes-color" title="改变图形颜色"><i class="iconfont icon-bianji"></i><input type="color" name="color" id="color" class="change-color" value="'+h+'"></span>\n<span class="subtool-set" title="设置"><i class="iconfont icon-shezhi"></i></span><span class="subtool-del"><i class="iconfont icon-recycle_bin"></i></span>':"ChartDrawVolProfile"==s?'<span class="vp-set" title="设置"><i class="iconfont icon-shezhi"></i></span><span class="subtool-del"><i class="iconfont icon-recycle_bin"></i></span>':'<p class="changes-color" title="改变图形颜色"><i class="iconfont icon-bianji"></i><input type="color" name="color" id="color" class="change-color" value="'+h+'"></p>\n        <p class="subtool-del"><i class="iconfont icon-recycle_bin"></i></p>',this.SubToolsDiv.style.right=n/a+"px",this.SubToolsDiv.style.top=r/a+"px",this.SubToolsDiv.innerHTML=l,this.SubToolsDiv.style.position="absolute",this.SubToolsDiv.style.display="block";var C=this.HQChart,D=this.ChartPicture;this.SubToolsDiv;$(".subtool-del").click((function(){C.SelectChartDrawPicture=null,C.ClearChartDrawPicture(D),$(".subTolls").css("display","none")}));var f=this;$(".subtool-set").click((function(){$(f.SubToolsDiv).hide(),f.SettingMenu||(f.SettingMenu=new ChartPictureTextSettingMenu(i.ChartBorder.UIElement.parentNode)),f.SettingMenu.ChartPicture=D,f.SettingMenu.HQChart=C,f.SettingMenu.Position={Left:n+80,Top:r+20},f.SettingMenu.DoModal()})),$(".changes-color").click((function(){document.getElementById("color").click(),$(".change-color").change((function(){var t=$(".change-color").val();D.LineColor=t,D.PointColor=t,C.ChartDrawStorage&&C.ChartDrawStorage.SaveDrawData(D)}))})),$(".vp-set").click((function(){f.SettingPV||(f.SettingPV=new Br(i.ChartBorder.UIElement.parentNode)),f.SettingPV.ChartPicture=D,f.SettingPV.HQChart=C,f.SettingPV.Position={Left:n+80,Top:r+20},f.SettingPV.DoModal()})),u.Chart.Log("[ChartPictureSettingMenu::DoModal]",{Top:r,Left:o,Right:n})}}function Br(t){this.newMethod=Or,this.newMethod(t),delete this.newMethod,this.ChartPicture,this.SettingDiv,this.Position,this.ID=N(),this.Close=function(){this.SettingDiv&&this.DivElement.removeChild(this.SettingDiv)},this.DoModal=function(){var t=this.ChartPicture.VAVol,e=this.ChartPicture.BarPosition,a=this,i=document.getElementById(this.ID);i||(i=document.createElement("div"),i.className="jchart-modifyindex-box",i.id=this.ID,this.DivElement.appendChild(i)),this.SettingDiv=i,i.innerHTML="<div class='parameter'>            <div class='parameter-header'>                <span>固定范围成交量分布设置</span>                <strong id='close' class='icon iconfont icon-close'></strong>            </div>            <div class='parameter-content'>\n                <input class='row-line' value=".concat(t," />VAVol <br>\n                <input class='row-line' value=").concat(e," />BarPosition\n            </div>            <div class='parameter-footer'>                <button class='submit' >确定</button>                <button class='cancel' >取消</button>            </div>        </div>");var r=F(),n=this.HQChart.Frame.SubFrame[0].Frame,o=n.ChartBorder.Top+40,s=n.ChartBorder.Right;n.ChartBorder.GetLeft();this.SettingDiv.style.right=s/r+"px",this.SettingDiv.style.top=o/r+"px",this.SettingDiv.style.position="absolute",this.SettingDiv.style.display="block";var h=i.getElementsByClassName("cancel")[0];h.onclick=function(){a.Close()};var l=i.getElementsByClassName("icon iconfont icon-close")[0];l.onclick=function(){a.Close()};var u=i.getElementsByClassName("submit")[0];u.onclick=function(){var t=i.getElementsByClassName("row-line")[0].value;a.ChartPicture.VAVol=parseFloat(t);t=parseInt(i.getElementsByClassName("row-line")[1].value);a.ChartPicture.BarPosition=t>0?1:0,a.ChartPicture.RequestVolumeProfileData(),a.Close()}}}var Pr={SH:".SH",SZ:".SZ",SHSZ_C_Index:".CI",BJ:".BJ",SHO:".SHO",SZO:".SZO",HK:".HK",FHK:".FHK",SHFE:".SHF",SHFE2:".SHFE",CFFEX:".CFE",CFFEX2:".CFFEX",CFFEX3:".CF",DCE:".DCE",CZCE:".CZC",GZFE:".GZFE",USA:".USA",FTSE:".FTSE",BIT:".BIT",BIZ:".BIZ",FOREX:".FOREX",NYMEX:".NYMEX",COMEX:".COMEX",NYBOT:".NYBOT",CBOT:".CBOT",LME:".LME",TOCOM:".TOCOM",IPE:".IPE",TW:".TW",JP:".JP",HSX:".HSX",HNX:".HNX",UPCOM:".UPCOM",ET:".ET",IsET:function(t){return!!t&&t.indexOf(this.ET)>0},IsETShowAvPrice:function(t){return!1},IsHSX:function(t){return!!t&&t.indexOf(this.HSX)>0},IsHNX:function(t){return!!t&&t.indexOf(this.HNX)>0},IsUPCOM:function(t){return!!t&&t.indexOf(this.UPCOM)>0},IsNYMEX:function(t){return!!t&&t.indexOf(this.NYMEX)>0},IsCOMEX:function(t){return!!t&&t.indexOf(this.COMEX)>0},IsNYBOT:function(t){return!!t&&t.indexOf(this.NYBOT)>0},IsCBOT:function(t){return!!t&&t.indexOf(this.CBOT)>0},IsLME:function(t){return!!t&&t.indexOf(this.LME)>0},IsTOCOM:function(t){return!!t&&t.indexOf(this.TOCOM)>0},IsIPE:function(t){return!!t&&t.indexOf(this.IPE)>0},IsForeignExchange:function(t){return!!t&&t.indexOf(this.FOREX)>0},IsFTSE:function(t){return!!t&&t.indexOf(this.FTSE)>0},IsFHK:function(t){return!!t&&t.indexOf(this.FHK)>0},IsBIT:function(t){return!!t&&(t.indexOf(this.BIT)>0||t.indexOf(this.BIZ)>0)},IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var e=t.length-this.SH.length,a=t.indexOf(this.SH);return a==e},IsSZ:function(t){var e=t.length-this.SZ.length,a=t.indexOf(this.SZ);return a==e},IsBJ:function(t){var e=t.length-this.BJ.length,a=t.indexOf(this.BJ);return a==e},IsSHSZCustomIndex:function(t){var e=t.length-this.SHSZ_C_Index.length,a=t.indexOf(this.SHSZ_C_Index);return a==e},IsSHO:function(t){if(this.IsSH(t)&&11==t.length&&"1"==t[0])return!0;var e=t.length-this.SHO.length,a=t.indexOf(this.SHO);return a==e},IsSZO:function(t){if(this.IsSZ(t)&&11==t.length&&"9"==t[0])return!0;var e=t.length-this.SZO.length,a=t.indexOf(this.SZO);return a==e},IsHK:function(t){var e=t.length-this.HK.length,a=t.indexOf(this.HK);return a==e},IsTW:function(t){var e=t.length-this.TW.length,a=t.indexOf(this.TW);return a==e},IsJP:function(t){var e=t.length-this.JP.length,a=t.indexOf(this.JP);return a==e},IsSHFE:function(t){return!!t&&(t.indexOf(this.SHFE)>0||t.indexOf(this.SHFE2)>0)},IsCFFEX:function(t){if(!t)return!1;if(t.indexOf(this.CFFEX)>0)return!0;if(t.indexOf(this.CFFEX2)>0)return!0;var e=t.indexOf(this.CFFEX3);return e>0&&e+this.CFFEX3.length==t.length},IsDCE:function(t){return!!t&&t.indexOf(this.DCE)>0},IsCZCE:function(t){return!!t&&t.indexOf(this.CZCE)>0},IsGZFE:function(t){return!!t&&t.indexOf(this.GZFE)>0},IsChinaFutures:function(t){return this.IsSHO(t)||this.IsSZO(t)||this.IsGZFE(t)||this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)},IsFutures:function(t){return!!t&&(this.IsChinaFutures(t)||this.IsNYMEX(t)||this.IsCOMEX(t)||this.IsNYBOT(t)||this.IsCBOT(t)||this.IsLME(t)||this.IsTOCOM(t))},IsSHSZ:function(t){return this.IsSZ(t)||this.IsSH(t)||this.IsSHSZCustomIndex(t)},IsSHSZETFOption:function(t){if(!t)return!1;if(this.IsSH(t)){var e=c.GetShortSymbol(t);if("1"==e.charAt(0)&&8==e.length)return!0}else if(this.IsSZ(t)){e=c.GetShortSymbol(t);if("9"==e.charAt(0)&&8==e.length)return!0}return!1},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if("5"==t.charAt(0)){var e=t.charAt(1);if(["1","2","3","4","5","7","6","8"].includes(e))return!0}}else if(this.IsSZ(t)&&"1"==t.charAt(0)&&("5"==t.charAt(1)||"6"==t.charAt(1)||"7"==t.charAt(1)||"8"==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){var a=e.replace(".SH","");if("0"==e.charAt(0)&&parseInt(a)<=3e3)return!0}else if(this.IsSZ(e)){if("3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(this.IsSHSZCustomIndex(e))return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){e.replace(".SH","");if("6"==e.charAt(0))return!0}else if(this.IsSZ(e))if("0"==e.charAt(0)){if("0"==e.charAt(1)&&"2"==e.charAt(2))return!0;if("7"!=e.charAt(1)&&"8"!=e.charAt(1))return!0}else if("3"==e.charAt(0)&&"0"==e.charAt(1)){if("0"==e.charAt(2))return!0;if("1"==e.charAt(2))return!0}return!1},IsBJStock:function(t){if(!t)return!1;var e=t.toUpperCase();if(!this.IsBJ(e))return!1;var a=e.charAt(0);return"4"==a||"8"==a},IsSHStockSTAR:function(t){if(!t)return!1;var e=t.toUpperCase();return!!this.IsSH(e)&&("6"==e.charAt(0)&&"8"==e.charAt(1)&&"8"==e.charAt(2))},IsSHGEM:function(t){if(!t)return!1;var e=t.toUpperCase();return!!this.IsSH(e)&&("3"==e.charAt(0)&&"0"==e.charAt(1))},GetMarketStatus:function(t){if(!t)return 0;var e=t.toUpperCase(),a=new Date,i=a.getDay(),r=100*a.getHours()+a.getMinutes();if(this.IsUSA(e)){var n=Zr(-4);i=n.getDay(),r=100*n.getHours()+n.getMinutes();return 6==i||0==i?0:r>1730?3:r<930?1:2}return this.IsBIT(e)||this.IsForeignExchange(e)?2:this.IsFTSE(e)?6==i||0==i?0:r>=830&&r<=2359||r>=0&&r<=500?2:0:this.IsFHK(e)?6==i||0==i?0:r>=900&&r<=2359||r>=0&&r<=320?2:0:this.IsET(e)?this.GetETMarketStatus(t):this.IsHK(e)?6==i||0==i?0:r>1630?3:r<925?1:2:this.IsTW(e)?6==i||0==i?0:r>1410?3:r<820?1:2:this.IsJP(e)?6==i||0==i?0:r>1520?3:r<830?1:2:this.IsNYMEX(e)?this.GetNYMEXMarketStatus(e):this.IsCOMEX(e)?this.GetCOMEXMarketStatus(e):this.IsNYBOT(e)?this.GetNYBOTMarketStatus(e):this.IsCBOT(e)?this.GetCBOTMarketStatus(e):this.IsLME(e)?this.GetLMEMarketStatus(e):this.IsTOCOM(e)?this.GetTOCOMMarketStatus(e):this.IsChinaFutures(e)?6==i||0==i?0:this.IsCFFEX(e)?r>1540?3:r<910?1:2:r>=2100||r<=240||r>=830&&r<=1510?2:1:6==i||0==i?0:r>1540?3:r<910?1:2},GetLimitPriceRange:function(t,e){return this.IsSHSZStockA(t)?this.IsSHStockSTAR(t)||this.IsSHGEM(t)?{Max:.2,Min:-.2}:e?e.indexOf("ST")>=0?{Max:.05,Min:-.05}:{Max:.1,Min:-.1}:null:null},GetDefaultDecimal:function(t){return 2},GetSHDecimal:function(t){return 2},GetSZDecimal:function(t){return 2},GetFHKDecimal:function(t){return 0},GetFTSEDecimal:function(t){return 0},GetBITDecimal:function(t){return 2},GetSHODecimal:function(t){return 4},GetETDecimal:function(t){return 2},GetHKDecimal:function(t){return 2},GetTWDecimal:function(t){return 2},GetJPDecimal:function(t){return 2},GetHSXDecimal:function(t){return 2},GetHNXDecimal:function(t){return 2},GetUPCOMDecimal:function(t){return 2},GetForeignExchangeDecimal:function(t){return 4},GetNYMEXDecimal:function(t){return Yr.GetDecimal(t)},GetCOMEXDecimal:function(t){return kr.GetDecimal(t)},GetNYBOTDecimal:function(t){return Xr.GetDecimal(t)},GetCBOTDecimal:function(t){return Wr.GetDecimal(t)},GetLMEDecimal:function(t){return Ur.GetDecimal(t)},GetTOCOMDecimal:function(t){return Kr.GetDecimal(t)},GetIPEDecimal:function(t){return zr.GetDecimal(t)},GetETMarketStatus:function(t){return 2},GetNYMEXMarketStatus:function(t){return Yr.GetMarketStatus(t)},GetCOMEXMarketStatus:function(t){return kr.GetMarketStatus(t)},GetNYBOTMarketStatus:function(t){return Xr.GetMarketStatus(t)},GetCBOTMarketStatus:function(t){return Wr.GetMarketStatus(t)},GetLMEMarketStatus:function(t){return Ur.GetMarketStatus(t)},GetTOCOMMarketStatus:function(t){return Kr.GetMarketStatus(t)},GetIPEMarketStatus:function(t){return zr.GetMarketStatus(t)},IsShowMinuteVolTitle:function(t){if(!t)return!1;t.toUpperCase();return!1},IsShowMinutePostionLine:function(t){return!!(Pr.IsFutures(t)||Pr.IsSHO(t)||Pr.IsSZO(t))},IsShowMinuteColorVolBar:function(t){return!!qi.Minute.VolBarColor},IsEnableRight:function(t,e,a){return!(!Pr.IsSHSZStockA(e)&&!Pr.IsBJStock(e))&&(!dt.IsTickPeriod(t)&&(!!sa.IsPlusNumber(a)||!dt.IsMinutePeriod(t,!0)))},GetVolUnit:function(t){return t?Pr.IsSHSZETFOption(t)?1:Pr.IsSHSZ(t)||Pr.IsBJ(t)?100:1:1}};function Gr(){this.TIME_SPLIT=[{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1900,Text:"19:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"CL",Decimal:2,Time:0,Name:"原油"},{Symbol:"NG",Decimal:3,Time:0,Name:"天然气"},{Symbol:"RB",Decimal:4,Time:0,Name:"汽油"},{Symbol:"PL",Decimal:1,Time:0,Name:"铂金"},{Symbol:"PA",Decimal:2,Time:0,Name:"钯金"},{Symbol:"HR",Decimal:0,Time:0,Name:"热轧钢卷"},{Symbol:"QM",Decimal:3,Time:0,Name:"迷你原油"},{Symbol:"HO",Decimal:4,Time:0,Name:"燃油"}],this.MarketSuffix=".NYMEX",this.TimeType=0,this.GetFuturesInfo=function(t){if(t.indexOf(this.MarketSuffix)<=0)return null;for(var e in this.FUTURES_LIST){var a=this.FUTURES_LIST[e];if(0==t.indexOf(a.Symbol))return a}return null},this.GetSplitData=function(t){var e=0==this.TimeType?this.TIME_SPLIT:this.TIME_SPLIT2,a=this.GetFuturesInfo(t);return a?e[a.Time]:e[0]},this.GetDecimal=function(t){var e=this.GetFuturesInfo(t);return e?e.Decimal:3},this.GetMarketStatus=function(t){var e=Zr(-4),a=new Date,i=e.getDay(),r=100*a.getHours()+a.getMinutes();return 6==i||0==i?0:r>430&&r<730?1:2},this.AddNewFutures=function(t){if(t){for(var e={Symbol:t.Symbol,Time:t.Time,Decimal:t.Decimal,Name:t.Name},a=0;a<this.FUTURES_LIST.length;++a){var i=this.FUTURES_LIST[a];if(i.Symbol==e.Symbol)return void(this.FUTURES_LIST[a]=e)}this.FUTURES_LIST.push(e)}}}var _r=new function(){this.SHSZ=null,this.BJ=null,this.SHO=null,this.SZO=null,this.HK=null,this.Futures=new Map,this.USA=null,this.FTSE=null,this.FHK=null,this.ForeEx=null,this.BIT=null,this.TW=null,this.JP=null,this.HSX=null,this.HNX=null,this.UPCOM=null,this.Initialize=function(){},this.GetET=function(t){throw{Name:"MinuteTimeStringData::GetET",Error:"not implement"}},this.GetSHSZ=function(t){return this.SHSZ||(this.SHSZ=this.CreateSHSZData()),this.SHSZ},this.GetBJ=function(t){return this.BJ||(this.BJ=this.CreateBJData()),this.BJ},this.GetSHO=function(t){return this.SHO||(this.SHO=this.CreateSHOData()),this.SHO},this.GetSZO=function(t){return this.SZO||(this.SZO=this.CreateSZOData()),this.SZO},this.GetHK=function(t){return this.HK||(this.HK=this.CreateHKData()),this.HK},this.GetTW=function(t){return this.TW&&(this.TW=this.CreateTWData()),this.TW},this.GetJP=function(t){return this.JP&&(this.JP=this.CreateJPData()),this.JP},this.GetHSX=function(t){return this.HSX&&(this.HSX=this.CreateHSXData()),this.HSX},this.GetHNX=function(t){return this.HNX&&(this.HSX=this.CreateHNXData()),this.HNX},this.GetUPCOM=function(t){return this.UPCOM&&(this.UPCOM=this.CreateUPCOMData()),this.UPCOM},this.GetFutures=function(t){if(!this.Futures.has(t.Name)){var e=this.CreateTimeData(t.Data);this.Futures.set(t.Name,e)}return this.Futures.get(t.Name)},this.GetUSA=function(t){return this.USA||(this.USA=this.CreateUSAData(0)),this.USA},this.GetFTSE=function(){return this.FTSE||(this.FTSE=this.CreateFTSEData()),this.FTSE},this.GetFHK=function(){return this.FHK||(this.FHK=this.CreateFHKData()),this.FHK},this.GetForeignExchange=function(t){return this.ForeEx||(this.ForeEx=this.CreateForeignExchangeData()),this.ForeEx},this.GetBIT=function(t){return this.BIT||(this.BIT=this.CreateBITData()),this.BIT},this.CreateSHSZData=function(){return this.CreateTimeData([{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}])},this.CreateBJData=function(){return this.CreateTimeData([{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}])},this.CreateSHOData=function(){return this.CreateTimeData([{Start:930,End:1129},{Start:1300,End:1500}])},this.CreateSZOData=function(){return this.CreateTimeData([{Start:930,End:1129},{Start:1300,End:1500}])},this.CreateHKData=function(){return this.CreateTimeData([{Start:930,End:1200},{Start:1300,End:1600}])},this.CreateTWData=function(){return this.CreateTimeData([{Start:900,End:1330}])},this.CreateJPData=function(){return this.CreateTimeData([{Start:900,End:1130},{Start:1230,End:1500}])},this.CreateFTSEData=function(){return this.CreateTimeData([{Start:1700,End:2359},{Start:0,End:445},{Start:900,End:1630}])},this.CreateFHKData=function(){return this.CreateTimeData([{Start:1715,End:2359},{Start:0,End:300},{Start:915,End:1200},{Start:1300,End:1630}])},this.CreateHSXData=function(){throw{Name:"MinuteTimeStringData::CreateHSXData",Error:"not implement"}},this.CreateHNXData=function(){throw{Name:"MinuteTimeStringData::CreateHNXData",Error:"not implement"}},this.CreateUPCOMData=function(){throw{Name:"MinuteTimeStringData::CreateUPCOMData",Error:"not implement"}},this.CreateUSAData=function(t){if(1==t){return this.CreateTimeData([{Start:2130,End:2359},{Start:0,End:400}])}if(2==t){return this.CreateTimeData([{Start:2230,End:2359},{Start:0,End:500}])}return this.CreateTimeData([{Start:930,End:1600}])},this.CreateForeignExchangeData=function(){return this.CreateTimeData([{Start:600,End:2359},{Start:0,End:559}])},this.CreateBITData=function(){return this.CreateTimeData([{Start:600,End:2359},{Start:0,End:559}])},this.CreateTimeData=function(t){var e=[];for(var a in t)for(var i=t[a],r=i.Start;r<=i.End;++r)r%100>=60||e.push(r);return e},this.GetTimeData=function(t){if(!t)return this.SHSZ;var e=t.toLocaleUpperCase();if(Pr.IsSHO(e))return this.GetSHO();if(Pr.IsSZO(e))return this.GetSZO();if(Pr.IsSH(e)||Pr.IsSZ(e))return this.GetSHSZ(e);if(Pr.IsBJ(e))return this.GetBJ(e);if(Pr.IsHK(e))return this.GetHK(e);if(Pr.IsTW(e))return this.GetTW(e);if(Pr.IsJP(e))return this.GetJP(e);if(Pr.IsUSA(e))return this.GetUSA(e);if(Pr.IsCFFEX(e)||Pr.IsCZCE(e)||Pr.IsDCE(e)||Pr.IsSHFE(e)||Pr.IsGZFE(e)){var a=Hr.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsFTSE(e))return this.GetFTSE();if(Pr.IsFHK(e))return this.GetFHK();if(Pr.IsForeignExchange(e))return this.GetForeignExchange(e);if(Pr.IsET(e))return this.GetET(e);if(Pr.IsBIT(e))return this.GetBIT(e);if(Pr.IsHSX(e))return this.GetHSX(e);if(Pr.IsHNX(e))return this.GetHNX(e);if(Pr.IsUPCOM(e))return this.GetUPCOM(e);if(Pr.IsNYMEX(e)){a=Yr.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsCOMEX(e)){a=kr.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsNYBOT(e)){a=Xr.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsCBOT(e)){a=Wr.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsLME(e)){a=Ur.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsTOCOM(e)){a=Kr.GetSplitData(e);return a?this.GetFutures(a):null}if(Pr.IsIPE(e)){a=zr.GetSplitData(e);return a?this.GetFutures(a):null}}},Vr=new function(){var t={Full:[[0,0,"rgb(200,200,200)","09:30"],[31,0,"RGB(200,200,200)","10:00"],[61,0,"RGB(200,200,200)","10:30"],[91,0,"RGB(200,200,200)","11:00"],[122,1,"RGB(200,200,200)","13:00"],[152,0,"RGB(200,200,200)","13:30"],[182,0,"RGB(200,200,200)","14:00"],[212,0,"RGB(200,200,200)","14:30"],[242,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[61,0,"RGB(200,200,200)","10:30"],[122,1,"RGB(200,200,200)","13:00"],[182,0,"RGB(200,200,200)","14:00"],[242,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[122,1,"RGB(200,200,200)","13:00"],[242,1,"RGB(200,200,200)","15:00"]],Count:243,MiddleCount:122,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},e={Full:[[0,0,"rgb(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,0,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","13:00"],[150,0,"RGB(200,200,200)","13:30"],[180,0,"RGB(200,200,200)","14:00"],[210,0,"RGB(200,200,200)","14:30"],[240,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[60,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","13:00"],[180,0,"RGB(200,200,200)","14:00"],[240,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[120,1,"RGB(200,200,200)","13:00"],[240,1,"RGB(200,200,200)","15:00"]],Count:241,MiddleCount:120,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},a={Full:[[0,1,"RGB(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,1,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","11:30"],[151,0,"RGB(200,200,200)","13:00"],[181,1,"RGB(200,200,200)","13:30"],[211,0,"RGB(200,200,200)","14:00"],[241,1,"RGB(200,200,200)","14:30"],[271,0,"RGB(200,200,200)","15:00"],[301,1,"RGB(200,200,200)","15:30"],[331,1,"RGB(200,200,200)","16:00"]],Simple:[[0,1,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:30"],[211,0,"RGB(200,200,200)","14:00"],[271,0,"RGB(200,200,200)","15:00"],[331,1,"RGB(200,200,200)","16:00"]],Min:[[0,1,"RGB(200,200,200)","09:30"],[151,0,"RGB(200,200,200)","13:00"],[331,1,"RGB(200,200,200)","16:00"]],Count:332,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},i={Full:[[0,0,"rgb(200,200,200)","9:30"],[30,0,"RGB(200,200,200)","10:00"],[90,1,"RGB(200,200,200)","11:00"],[150,0,"RGB(200,200,200)","12:00"],[210,0,"RGB(200,200,200)","13:00"],[270,0,"RGB(200,200,200)","14:00"],[330,0,"RGB(200,200,200)","15:00"],[390,0,"RGB(200,200,200)","16:00"]],Simple:[[30,0,"rgb(200,200,200)","10:00"],[150,1,"RGB(200,200,200)","12:00"],[270,0,"RGB(200,200,200)","14:00"],[390,0,"RGB(200,200,200)","16:00"]],Min:[[30,0,"rgb(200,200,200)","10:00"],[210,1,"RGB(200,200,200)","13:00"],[390,0,"RGB(200,200,200)","16:00"]],Count:391,MiddleCount:211,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},r={Full:[[0,1,"RGB(200,200,200)","17:00"],[120,1,"RGB(200,200,200)","19:00"],[240,1,"RGB(200,200,200)","21:00"],[360,1,"RGB(200,200,200)","23:00"],[480,1,"RGB(200,200,200)","01:00"],[600,1,"RGB(200,200,200)","03:00"],[706,1,"RGB(200,200,200)","09:00"],[826,1,"RGB(200,200,200)","11:00"],[946,1,"RGB(200,200,200)","13:00"],[1066,1,"RGB(200,200,200)","15:00"],[1156,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:00"],[240,1,"RGB(200,200,200)","21:00"],[480,1,"RGB(200,200,200)","01:00"],[706,1,"RGB(200,200,200)","09:00"],[946,1,"RGB(200,200,200)","13:00"],[1156,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:00"],[706,1,"RGB(200,200,200)","09:00"],[1156,1,"RGB(200,200,200)","16:30"]],Count:1157,MiddleCount:707,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},n={Full:[[0,1,"RGB(200,200,200)","17:15"],[105,1,"RGB(200,200,200)","19:00"],[225,1,"RGB(200,200,200)","21:00"],[345,1,"RGB(200,200,200)","23:00"],[586,0,"RGB(200,200,200)","09:15"],[691,1,"RGB(200,200,200)","11:00"],[812,1,"RGB(200,200,200)","14:00"],[963,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:15"],[225,1,"RGB(200,200,200)","21:00"],[586,0,"RGB(200,200,200)","09:15"],[752,1,"RGB(200,200,200)","13:00"],[963,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:15"],[586,0,"RGB(200,200,200)","09:15"],[963,1,"RGB(200,200,200)","16:30"]],Count:963,MiddleCount:526,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},o={Full:[[0,1,"RGB(200,200,200)","06:00"],[120,1,"RGB(200,200,200)","08:00"],[240,1,"RGB(200,200,200)","10:00"],[360,1,"RGB(200,200,200)","12:00"],[480,0,"RGB(200,200,200)","14:00"],[600,1,"RGB(200,200,200)","16:00"],[720,1,"RGB(200,200,200)","18:00"],[840,1,"RGB(200,200,200)","20:00"],[960,1,"RGB(200,200,200)","22:00"],[1080,1,"RGB(200,200,200)","0:00"],[1200,1,"RGB(200,200,200)","02:00"],[1320,1,"RGB(200,200,200)","04:00"]],Simple:[[0,1,"RGB(200,200,200)","06:00"],[240,1,"RGB(200,200,200)","10:00"],[480,0,"RGB(200,200,200)","14:00"],[720,1,"RGB(200,200,200)","18:00"],[960,1,"RGB(200,200,200)","22:00"],[1200,1,"RGB(200,200,200)","02:00"]],Min:[[0,1,"RGB(200,200,200)","06:00"],[480,0,"RGB(200,200,200)","14:00"],[960,1,"RGB(200,200,200)","22:00"]],Count:1440,MiddleCount:600,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},s={Full:[[0,1,"RGB(200,200,200)","09:00"],[30,0,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:00"],[90,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:00"],[150,0,"RGB(200,200,200)","11:30"],[180,1,"RGB(200,200,200)","12:00"],[210,0,"RGB(200,200,200)","12:30"],[240,1,"RGB(200,200,200)","13:00"],[270,0,"RGB(200,200,200)","13:30"]],Simple:[[0,1,"RGB(200,200,200)","09:00"],[60,1,"RGB(200,200,200)","10:00"],[120,1,"RGB(200,200,200)","11:00"],[180,1,"RGB(200,200,200)","12:00"],[270,0,"RGB(200,200,200)","13:30"]],Min:[[0,1,"RGB(200,200,200)","09:00"],[60,1,"RGB(200,200,200)","11:00"],[270,0,"RGB(200,200,200)","13:30"]],Count:271,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}};this.GetCoordinateData=function(e,a){var i=null;if(e){var r=e.toLocaleUpperCase();if(Pr.IsSHO(r))i=this.GetSHOData(r,a);else if(Pr.IsSZO(r))i=this.GetSZOData(r,a);else if(Pr.IsSH(r)||Pr.IsSZ(r)||Pr.IsSHSZIndex(r))i=this.GetSHSZData(r,a);else if(Pr.IsBJ(r))i=this.GetBJData(r,a);else if(Pr.IsHK(r))i=this.GetHKData(r,a);else if(Pr.IsTW(r))i=this.GetTWData(r,a);else if(Pr.IsJP(r))i=this.GetJPData(r,a);else{if(Pr.IsCFFEX(r)||Pr.IsCZCE(r)||Pr.IsDCE(r)||Pr.IsSHFE(r)||Pr.IsGZFE(r))return this.GetChinatFuturesData(r,a);if(Pr.IsUSA(r))i=this.GetUSAData(r,a);else if(Pr.IsFTSE(r))i=this.GetFTSEData(r,a);else if(Pr.IsFHK(r))i=this.GetFHKData(r,a);else if(Pr.IsForeignExchange(r))i=this.GetForeignExchangeData(r);else if(Pr.IsBIT(r,a))i=this.GetBITData(r,a);else if(Pr.IsET(r))i=this.GetETData(r,a);else{if(Pr.IsNYMEX(r))return this.GetNYMEXData(r,a);if(Pr.IsCOMEX(r))return this.GetCOMEXData(r,a);if(Pr.IsNYBOT(r))return this.GetNYBOTData(r,a);if(Pr.IsCBOT(r))return this.GetCBOTData(r,a);if(Pr.IsLME(r))return this.GetLMEData(r,a);if(Pr.IsTOCOM(r))return this.GetTOCOMData(r,a);if(Pr.IsIPE(r))return this.GetIPEData(r,a);if(Pr.IsHSX(r))return this.GetHSXData(r,a);if(Pr.IsHNX(r))return this.GetHNXData(r,a);if(Pr.IsUPCOM(r))return this.GetUPCOMData(r,a)}}}else i=t;var n={Count:i.Count,MiddleCount:i.MiddleCount,Data:i.GetData(a)};return n},this.GetSHSZData=function(e,a){var i=t;return i},this.GetBJData=function(e,a){var i=t;return i},this.GetUSAData=function(t,e){var a=i;return a},this.GetHKData=function(t,e){var i=a;return i},this.GetTWData=function(t,e){return s},this.GetSHOData=function(t,a){var i=e;return i},this.GetSZOData=function(t,a){var i=e;return i},this.GetFuturesData=function(t,e,a){var i=a.GetSplitData(t);if(!i)return null;var r=_r.GetFutures(i);if(!r)return null;var n={Count:r.length},o=null;o=e<200?i.Coordinate.Min:e<480?i.Coordinate.Simple:i.Coordinate.Full;for(var s=[],h=0;h<r.length;++h)for(var l=r[h],u=0;u<o.length;++u){var C=o[u];if(l==C.Value){var D=[h,0,"RGB(200,200,200)",C.Text];s.push(D);break}}return n.Data=s,n},this.GetChinatFuturesData=function(t,e){return this.GetFuturesData(t,e,Hr)},this.GetNYMEXData=function(t,e){return this.GetFuturesData(t,e,Yr)},this.GetCOMEXData=function(t,e){return this.GetFuturesData(t,e,kr)},this.GetNYBOTData=function(t,e){return this.GetFuturesData(t,e,Xr)},this.GetCBOTData=function(t,e){return this.GetFuturesData(t,e,Wr)},this.GetLMEData=function(t,e){return this.GetFuturesData(t,e,Ur)},this.GetTOCOMData=function(t,e){return this.GetFuturesData(t,e,Kr)},this.GetIPEData=function(t,e){return this.GetFuturesData(t,e,zr)},this.GetFTSEData=function(t,e){var a=r;return a},this.GetFHKData=function(t,e){var a=n;return a},this.GetForeignExchangeData=function(t,e){var a=o;return a},this.GetBITData=function(t,e){var a=o;return a},this.GetETData=function(t,e){throw{Name:"MinuteCoordinateData::GetETData",Error:"not implement"}},this.GetJPData=function(t,e){throw{Name:"MinuteCoordinateData::GetJPData",Error:"not implement"}},this.GetHSXData=function(t,e){throw{Name:"MinuteCoordinateData::GetHSXData",Error:"not implement"}},this.GetHNXData=function(t,e){throw{Name:"MinuteCoordinateData::GetHNXData",Error:"not implement"}},this.GetUPCOMData=function(t,e){throw{Name:"MinuteCoordinateData::GetUPCOMData",Error:"not implement"}}},Hr=new function(){this.TIME_SPLIT=[{Name:"9:00-10:15,10:31-11:30,13:31-15:00",Data:[{Start:900,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1100,Text:"11:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1330,Text:"13:30"},{Value:1500,Text:"15:00"}]}},{Name:"9:30-11:30,13:01-15:15",Data:[{Start:930,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1515,Text:"15:15"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1515,Text:"15:15"}],Min:[{Value:930,Text:"9:30"},{Value:1300,Text:"13:00"},{Value:1515,Text:"15:15"}]}},{Name:"9:30-11:30,13:00-15:00",Data:[{Start:930,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:930,Text:"9:30"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:30,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2330},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-1:00,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2100,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-2:30,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2100,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:01-10:15,10:30-11:30,13:31-15:00",Data:[{Start:2100,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:00-11:30,13:00-15:00",Data:[{Start:900,End:1130},{Start:1300,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2300},{Start:900,End:1015},{Start:1030,End:1130},{Start:1330,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:901,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:901,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1330,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Min:[{Value:901,Text:"9:00"},{Value:1330,Text:"13:30"},{Value:1500,Text:"15:00"}]}},{Name:"21:01-1:00,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2101,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2101,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2101,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:01-23:00,9:01-10:15,10:30-11:30,13:31-15:00",Data:[{Start:2101,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2101,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:01-2:30,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2101,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"}],Min:[{Value:2101,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:30-11:30,13:01-15:15",Data:[{Start:931,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:931,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1301,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1515,Text:"15:15"}],Simple:[{Value:931,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1301,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1515,Text:"15:15"}],Min:[{Value:931,Text:"9:30"},{Value:1301,Text:"13:00"},{Value:1515,Text:"15:15"}]}},{Name:"9:31-11:30,13:01-15:00",Data:[{Start:931,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:931,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1301,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:931,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1301,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:931,Text:"9:30"},{Value:1301,Text:"13:00"},{Value:1500,Text:"15:00"}]}}],this.MAP_TWOWORDS=new Map([[Pr.DCE+"-JD",{Time:0,Decimal:0,Name:"鸡蛋"}],[Pr.DCE+"-FB",{Time:0,Decimal:2,Name:"纤板"}],[Pr.DCE+"-BB",{Time:0,Decimal:2,Name:"胶板"}],[Pr.DCE+"-PP",{Time:6,Decimal:0,Name:"丙烯"}],[Pr.DCE+"-JM",{Time:6,Decimal:1,Name:"焦煤"}],[Pr.DCE+"-EG",{Time:6,Decimal:0,Name:"乙二醇"}],[Pr.DCE+"-EB",{Time:6,Decimal:0,Name:"苯乙烯"}],[Pr.DCE+"-CS",{Time:6,Decimal:0,Name:"淀粉"}],[Pr.DCE+"-PG",{Time:6,Decimal:0,Name:"液化气"}],[Pr.DCE+"-RR",{Time:6,Decimal:0,Name:"梗米"}],[Pr.DCE+"-LH",{Time:0,Decimal:0,Name:"生猪"}],[Pr.SHFE+"-CU",{Time:4,Decimal:0,Name:"铜"}],[Pr.SHFE+"-AL",{Time:4,Decimal:0,Name:"铝"}],[Pr.SHFE+"-NI",{Time:4,Decimal:0,Name:"镍"}],[Pr.SHFE+"-SN",{Time:4,Decimal:0,Name:"沪锡"}],[Pr.SHFE+"-ZN",{Time:4,Decimal:0,Name:"沪锌"}],[Pr.SHFE+"-PB",{Time:4,Decimal:0,Name:"沪铅"}],[Pr.SHFE+"-RU",{Time:6,Decimal:0,Name:"天然橡胶"}],[Pr.SHFE+"-FU",{Time:6,Decimal:0,Name:"燃料油"}],[Pr.SHFE+"-RB",{Time:6,Decimal:0,Name:"螺纹钢"}],[Pr.SHFE+"-BU",{Time:6,Decimal:0,Name:"石油沥青"}],[Pr.SHFE+"-HC",{Time:6,Decimal:0,Name:"热轧卷板"}],[Pr.SHFE+"-SP",{Time:6,Decimal:0,Name:"纸浆"}],[Pr.SHFE+"-WR",{Time:0,Decimal:0,Name:"线材"}],[Pr.SHFE+"-AG",{Time:5,Decimal:0,Name:"白银"}],[Pr.SHFE+"-AU",{Time:5,Decimal:2,Name:"黄金"}],[Pr.SHFE+"-SS",{Time:4,Decimal:0,Name:"不锈钢"}],[Pr.SHFE+"-AO",{Time:4,Decimal:0,Name:"氧化铝"}],[Pr.SHFE+"-BR",{Time:6,Decimal:0,Name:"合成橡胶"}],[Pr.SHFE+"-NR",{Time:6,Decimal:1,Name:"20号胶"}],[Pr.SHFE+"-SC",{Time:5,Decimal:1,Name:"原油"}],[Pr.SHFE+"-LU",{Time:6,Decimal:0,Name:"低硫燃油"}],[Pr.SHFE+"-BC",{Time:4,Decimal:0,Name:"国际铜"}],[Pr.SHFE+"-EC",{Time:0,Decimal:0,Name:"集运指数"}],[Pr.CZCE+"-CF",{Time:6,Decimal:0,Name:"棉花"}],[Pr.CZCE+"-SR",{Time:6,Decimal:0,Name:"白糖"}],[Pr.CZCE+"-MA",{Time:6,Decimal:0,Name:"甲醇"}],[Pr.CZCE+"-ZC",{Time:6,Decimal:1,Name:"动力煤"}],[Pr.CZCE+"-TA",{Time:6,Decimal:0,Name:"精对苯二甲酸(PTA)"}],[Pr.CZCE+"-RM",{Time:6,Decimal:0,Name:"菜籽粕"}],[Pr.CZCE+"-OI",{Time:6,Decimal:0,Name:"菜籽油"}],[Pr.CZCE+"-ME",{Time:3,Decimal:0,Name:"甲醇(老)"}],[Pr.CZCE+"-FG",{Time:6,Decimal:0,Name:"平板玻璃"}],[Pr.CZCE+"-WS",{Time:0,Decimal:0}],[Pr.CZCE+"-WT",{Time:0,Decimal:0}],[Pr.CZCE+"-GN",{Time:0,Decimal:0}],[Pr.CZCE+"-RO",{Time:0,Decimal:0}],[Pr.CZCE+"-RS",{Time:0,Decimal:0,Name:"菜籽"}],[Pr.CZCE+"-ER",{Time:0,Decimal:0}],[Pr.CZCE+"-RI",{Time:0,Decimal:0,Name:"早籼稻"}],[Pr.CZCE+"-WH",{Time:0,Decimal:0,Name:"强麦"}],[Pr.CZCE+"-AP",{Time:0,Decimal:0,Name:"苹果"}],[Pr.CZCE+"-PM",{Time:0,Decimal:0,Name:"普麦"}],[Pr.CZCE+"-QM",{Time:0,Decimal:0}],[Pr.CZCE+"-TC",{Time:0,Decimal:0}],[Pr.CZCE+"-JR",{Time:0,Decimal:0,Name:"粳稻"}],[Pr.CZCE+"-LR",{Time:0,Decimal:0,Name:"晚籼稻"}],[Pr.CZCE+"-SF",{Time:0,Decimal:0,Name:"硅铁"}],[Pr.CZCE+"-SM",{Time:0,Decimal:0,Name:"锰硅"}],[Pr.CZCE+"-CJ",{Time:0,Decimal:2,Name:"红枣"}],[Pr.CZCE+"-CY",{Time:6,Decimal:0,Name:"棉纱"}],[Pr.CZCE+"-UR",{Time:0,Decimal:0,Name:"尿素"}],[Pr.CZCE+"-SA",{Time:6,Decimal:0,Name:"纯碱"}],[Pr.CZCE+"-PF",{Time:6,Decimal:0,Name:"短纤"}],[Pr.CZCE+"-PK",{Time:0,Decimal:0,Name:"花生"}],[Pr.CZCE+"-PR",{Time:6,Decimal:0,Name:"瓶片"}],[Pr.CFFEX+"-TF",{Time:1,Decimal:3,Name:"二债"}],[Pr.CFFEX+"-TS",{Time:1,Decimal:3,Name:"五债"}],[Pr.CFFEX+"-IH",{Time:2,Decimal:1,Name:"上证股指期货"}],[Pr.CFFEX+"-IC",{Time:2,Decimal:1,Name:"中证股指期货"}],[Pr.CFFEX+"-IF",{Time:2,Decimal:1,Name:"沪深股指期货"}],[Pr.CFFEX+"-IM",{Time:2,Decimal:1,Name:"中证1000股指期货"}],[Pr.CFFEX+"-IO",{Time:2,Decimal:1,Name:"沪深300股指期权"}],[Pr.CFFEX+"-MO",{Time:2,Decimal:1,Name:"中证1000股指期权"}],[Pr.CFFEX+"-HO",{Time:2,Decimal:1,Name:"上证50股指期权"}],[Pr.GZFE+"-SI",{Time:0,Decimal:2,Name:"工业硅"}],[Pr.GZFE+"-LC",{Time:0,Decimal:2,Name:"碳酸锂"}]]),this.MAP_ONEWORD=new Map([[Pr.DCE+"-C",{Time:6,Decimal:0,Name:"玉米"}],[Pr.DCE+"-L",{Time:6,Decimal:0,Name:"乙烯"}],[Pr.DCE+"-V",{Time:6,Decimal:0,Name:"PVC"}],[Pr.DCE+"-A",{Time:6,Decimal:0,Name:"豆一"}],[Pr.DCE+"-B",{Time:6,Decimal:0,Name:"豆二"}],[Pr.DCE+"-M",{Time:6,Decimal:0,Name:"豆粕"}],[Pr.DCE+"-Y",{Time:6,Decimal:0,Name:"豆油"}],[Pr.DCE+"-P",{Time:6,Decimal:0,Name:"棕榈"}],[Pr.DCE+"-J",{Time:6,Decimal:1,Name:"焦炭"}],[Pr.DCE+"-I",{Time:6,Decimal:1,Name:"铁矿"}],[Pr.CFFEX+"-T",{Time:1,Decimal:3,Name:"十债"}]]),this.AddNewFutures=function(t){if(t){var e=t.Suffix+"-"+t.Symbol,a={Time:t.Time,Decimal:t.Decimal,Name:t.Name};1==t.Symbol.length?this.MAP_ONEWORD.set(e,a):2==t.Symbol.length&&this.MAP_TWOWORDS.set(e,a)}},this.GetData=function(t){var e=t.charAt(0),a=t.substr(0,2),i=null,r=null;return Pr.IsDCE(t)?(i=Pr.DCE+"-"+e,r=Pr.DCE+"-"+a):Pr.IsSHFE(t)?(i=Pr.SHFE+"-"+e,r=Pr.SHFE+"-"+a):Pr.IsCFFEX(t)?(i=Pr.CFFEX+"-"+e,r=Pr.CFFEX+"-"+a):Pr.IsCZCE(t)?(i=Pr.CZCE+"-"+e,r=Pr.CZCE+"-"+a):Pr.IsGZFE(t)&&(i=Pr.GZFE+"-"+e,r=Pr.GZFE+"-"+a),this.MAP_TWOWORDS.has(r)?this.MAP_TWOWORDS.get(r):this.MAP_ONEWORD.has(i)?this.MAP_ONEWORD.get(i):null},this.GetSplitData=function(t){var e=this.GetData(t);return e?this.TIME_SPLIT[e.Time]:null},this.GetDecimal=function(t){var e=this.GetData(t);return e?e.Decimal:2}},Yr=new Gr,kr=new function(){this.newMethod=Gr,this.newMethod(),delete this.newMethod,this.FUTURES_LIST=[{Symbol:"GC",Decimal:1,Time:0,Name:"COMEX黄金"},{Symbol:"QO",Decimal:2,Time:0,Name:"迷你黄金"},{Symbol:"MG",Decimal:1,Time:0,Name:"微型黄金"},{Symbol:"QI",Decimal:4,Time:0,Name:"迷你白银"},{Symbol:"SI",Decimal:3,Time:0,Name:"COMEX白银"},{Symbol:"HG",Decimal:4,Time:0,Name:"COMEX铜"}],this.MarketSuffix=".COMEX"},Xr=new function(){this.newMethod=Gr,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"9:00-2:20",Data:[{Start:900,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1700,Text:"17:00"},{Value:100,Text:"1:00"}]}},{Name:"15:30-1:00",Data:[{Start:1530,End:2359},{Start:0,End:100}],Coordinate:{Full:[{Value:1600,Text:"16:00"},{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"}],Simple:[{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"}],Min:[{Value:1600,Text:"16:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}]}}],this.TIME_SPLIT2=[{Name:"10:00-3:20",Data:[{Start:1e3,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:1e3,Text:"10:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"16:30-2:00",Data:[{Start:1630,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Min:[{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SB",Decimal:2,Time:1},{Symbol:"CT",Decimal:2,Time:0}],this.MarketSuffix=".NYBOT",this.GetMarketStatus=function(t){var e=Zr(-4),a=e.getDay(),i=100*e.getHours()+e.getMinutes();if(6==a||0==a)return 0;var r=this.GetFuturesInfo(t);if(!r)return 2;if("SB"==r.Symbol){if(i>300&&i<1400)return 2}else if("CT"==r.Symbol)return i>=0&&i<=1500||i>=2e3&&i<=2359?2:1;return 0}},Wr=new function(){this.newMethod=Gr,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"8:00-2:20",Data:[{Start:800,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}},{Name:"08:00-20:45 21:31-02:20",Data:[{Start:800,End:2045},{Start:2131,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2045},{Start:2131,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"06:00-04:15 04:31-05:00",Data:[{Start:600,End:2359},{Start:0,End:415},{Start:431,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"9:00-3:20",Data:[{Start:900,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"9:00-3:45",Data:[{Start:900,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}},{Name:"09:00-21:45 22:31-03:20",Data:[{Start:900,End:2145},{Start:2231,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"09:00-21:45 22:31-03:45",Data:[{Start:900,End:2145},{Start:2231,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"07:00-05:15 05:31-06:00",Data:[{Start:700,End:2359},{Start:0,End:515},{Start:531,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"ZC",Decimal:2,Time:0,Name:"玉米"},{Symbol:"XC",Decimal:2,Time:1,Name:"迷你玉米"},{Symbol:"ZS",Decimal:2,Time:0,Name:"大豆"},{Symbol:"XK",Decimal:2,Time:1,Name:"迷你大豆"},{Symbol:"ZL",Decimal:2,Time:0,Name:"豆油"},{Symbol:"ZR",Decimal:2,Time:0,Name:"稻谷"},{Symbol:"ZO",Decimal:2,Time:0,Name:"燕麦"},{Symbol:"ZW",Decimal:2,Time:0,Name:"小麦"},{Symbol:"XW",Decimal:2,Time:1,Name:"迷你小麦"},{Symbol:"ZM",Decimal:1,Time:0,Name:"豆粕"},{Symbol:"EH",Decimal:3,Time:2},{Symbol:"YM",Decimal:0,Time:2,Name:"小型道指"},{Symbol:"ES",Decimal:2,Time:2,Name:"小型标普"},{Symbol:"NQ",Decimal:2,Time:2,Name:"小型纳指"},{Symbol:"TY",Decimal:4,Time:2,Name:"10年美国债"},{Symbol:"TU",Decimal:4,Time:2,Name:"2年美国债"},{Symbol:"FV",Decimal:4,Time:2,Name:"5年美国债"},{Symbol:"US",Decimal:4,Time:2,Name:"30年美国债"},{Symbol:"UL",Decimal:4,Time:2,Name:"超国债"}],this.MarketSuffix=".CBOT"},Ur=new function(){this.newMethod=Gr,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"LME 9:00-3:00",Data:[{Start:900,End:2359},{Start:0,End:300}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1800,Text:"18:00"},{Value:300,Text:"3:00"}]}}],this.TIME_SPLIT=[{Name:"LME 8:00-2:00",Data:[{Start:800,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SN",Decimal:0,Time:0,Name:"LME锡"},{Symbol:"AH",Decimal:2,Time:0,Name:"LME铝"},{Symbol:"PB",Decimal:2,Time:0,Name:"LME铅"},{Symbol:"ZS",Decimal:2,Time:0,Name:"LME锌"},{Symbol:"CA",Decimal:2,Time:0,Name:"LME铜"},{Symbol:"NI",Decimal:0,Time:0,Name:"LME镍"}],this.MarketSuffix=".LME"},Kr=new function(){this.newMethod=Gr,this.newMethod(),delete this.newMethod,this.TimeType=0,this.TIME_SPLIT=[{Name:"15:30-04:30 07:46-14:15",Data:[{Start:1530,End:2359},{Start:0,End:430},{Start:746,End:1415}],Coordinate:{Full:[{Value:1530,Text:"15:30"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"},{Value:430,Text:"4:30"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1415,Text:"14:15"}],Simple:[{Value:1530,Text:"15:30"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:430,Text:"4:30"},{Value:1100,Text:"11:00"},{Value:1415,Text:"14:15"}],Min:[{Value:1530,Text:"15:30"},{Value:100,Text:"1:00"},{Value:1415,Text:"14:15"}]}}],this.FUTURES_LIST=[{Symbol:"JRV",Decimal:0,Time:0,Name:"东京TSR20橡胶"},{Symbol:"JPL",Decimal:0,Time:0,Name:"东京铂金"},{Symbol:"JAU",Decimal:0,Time:0,Name:"东京黄金"},{Symbol:"JCO",Decimal:0,Time:0,Name:"中东原油"},{Symbol:"JRU",Decimal:1,Time:0,Name:"东京RSS3橡胶橡胶"},{Symbol:"JAG",Decimal:1,Time:0,Name:"日白银"},{Symbol:"JPA",Decimal:1,Time:0,Name:"日钯金"}],this.MarketSuffix=".TOCOM"},zr=new function(){this.newMethod=Gr,this.newMethod(),delete this.newMethod,this.MarketSuffix=".IPE",this.TIME_SPLIT=[{Name:"8:00-6:00",Data:[{Start:800,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"},{Value:600,Text:"6:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"},{Value:400,Text:"4:00"},{Value:600,Text:"6:00"}],Min:[{Value:800,Text:"8:00"},{Value:2e3,Text:"20:00"},{Value:600,Text:"6:00"}]}}],this.TIME_SPLIT2=[{Name:"09:00-07:00",Data:[{Start:900,End:2359},{Start:0,End:700}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"},{Value:700,Text:"7:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"},{Value:500,Text:"5:00"},{Value:700,Text:"7:00"}],Min:[{Value:900,Text:"9:00"},{Value:2100,Text:"21:00"},{Value:700,Text:"7:00"}]}}],this.FUTURES_LIST=[{Symbol:"RC",Decimal:2,Time:0,Name:"罗布斯塔咖啡"},{Symbol:"W",Decimal:2,Time:0,Name:"白糖"},{Symbol:"C",Decimal:2,Time:0,Name:"伦敦可可"},{Symbol:"R",Decimal:2,Time:0,Name:"长期英国国债"},{Symbol:"L",Decimal:2,Time:0,Name:"3个月英镑利率"},{Symbol:"T",Decimal:2,Time:0,Name:"WTI原油"},{Symbol:"G",Decimal:2,Time:0,Name:"低硫柴油"},{Symbol:"B",Decimal:2,Time:0,Name:"布伦特原油"}]};function Jr(t){var e=2;if(!t)return e;var a=t.toUpperCase();return"function"==typeof Pr.GetCustomDecimal?Pr.GetCustomDecimal(a):(e=Pr.IsSHSZFund(a)?3:Pr.IsSHO(a)||Pr.IsSZO(a)?Pr.GetSHODecimal(a):Pr.IsChinaFutures(a)?Hr.GetDecimal(a):Pr.IsFHK(a)?Pr.GetFHKDecimal(a):Pr.IsFTSE(a)?Pr.GetFTSEDecimal(a):Pr.IsBIT(a)?Pr.GetBITDecimal(a):Pr.IsET(a)?Pr.GetETDecimal(a):Pr.IsForeignExchange(a)?Pr.GetForeignExchangeDecimal(a):Pr.IsNYMEX(a)?Yr.GetDecimal(a):Pr.IsCOMEX(a)?kr.GetDecimal(a):Pr.IsNYBOT(a)?Xr.GetDecimal(a):Pr.IsCBOT(a)?Wr.GetDecimal(a):Pr.IsLME(a)?Ur.GetDecimal(a):Pr.IsTOCOM(a)?Kr.GetDecimal(a):Pr.IsIPE(a)?zr.GetDecimal(a):Pr.IsHK(a)?Pr.GetHKDecimal(a):Pr.IsTW(a)?Pr.GetTWDecimal(a):Pr.IsJP(a)?Pr.GetJPDecimal(a):Pr.IsHSX(a)?Pr.GetHSXDecimal(a):Pr.IsHNX(a)?Pr.GetHNXDecimal(a):Pr.IsUPCOM(a)?Pr.GetUPCOMDecimal(a):Pr.IsSZ(a)?Pr.GetSZDecimal(a):Pr.IsSH(a)?Pr.GetSHDecimal(a):Pr.GetDefaultDecimal(a),e)}function Zr(t){if("number"===typeof t){var e=new Date,a=e.getTime(),i=6e4*e.getTimezoneOffset(),r=a+i;return new Date(r+36e5*t)}}if(!u)u={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn}};var Qr={Domain:"http://127.0.0.1:8080",CacheDomain:"http://127.0.0.1:8087",DrawIcon:{Family:"iconfont",Data:new Map([[1,{Text:"",Color:"rgb(243,28,15)"}],[2,{Text:"",Color:"rgb(87,247,41)"}],[3,{Text:"",Color:"rgb(237,153,0)"}],[4,{Text:"",Color:"rgb(237,153,0)"}],[5,{Text:"",Color:"rgb(237,153,0)"}],[6,{Text:"",Color:"rgb(140,57,208)"}],[7,{Text:"",Color:"rgb(246,135,37)"}],[8,{Text:"",Color:"rgb(85,231,56)"}],[9,{Text:"",Color:"rgb(227,61,41)"}],[10,{Text:"",Color:"rgb(216,78,48)"}],[11,{Text:"",Color:"rgb(249,187,0)"}],[12,{Text:"",Color:"rgb(249,187,0)"}],[13,{Text:"",Color:"rgb(216,42,0)"}],[14,{Text:"",Color:"rgb(58,90,236)"}],[15,{Text:"",Color:"rgb(227,149,0)"}],[16,{Text:"",Color:"rgb(208,82,78)"}],[17,{Text:"",Color:"rgb(234,114,26)"}],[18,{Text:"",Color:"rgb(116,25,255)"}],[19,{Text:"",Color:"rgb(102,9,11)"}],[20,{Text:"",Color:"rgb(127,125,137)"}],[21,{Text:"",Color:"rgb(110,188,255)"}],[22,{Text:"",Color:"rgb(238,79,51)"}],[23,{Text:"",Color:"rgb(244,71,0)"}],[24,{Text:"",Color:"rgb(102,183,248)"}],[25,{Text:"",Color:"rgb(234,88,231)"}],[26,{Text:"",Color:"rgb(242,171,0)"}],[27,{Text:"",Color:"rgb(87,247,168)"}],[28,{Text:"",Color:"rgb(97,204,113)"}],[29,{Text:"",Color:"rgb(84,115,193)"}],[30,{Text:"",Color:"rgb(141,51,255)"}],[31,{Text:"",Color:"rgb(200,126,24)"}],[32,{Text:"",Color:"rgb(195,41,32)"}],[33,{Text:"",Color:"rgb(215,85,194)"}],[34,{Text:"",Color:"rgb(250,222,105)"}],[35,{Text:"",Color:"rgb(112,249,224)"}],[36,{Text:"",Color:"rgb(217,107,98)"}],[37,{Text:"",Color:"rgb(114,231,17)"}],[38,{Text:"",Color:"rgb(238,31,25)"}],[39,{Text:"",Color:"rgb(92,247,113)"}],[40,{Text:"",Color:"rgb(175,175,175)"}],[41,{Text:"",Color:"rgb(252,228,23)"}],[42,{Text:"",Color:"rgb(88,195,235)"}],[43,{Text:"",Color:"rgb(55,74,94)"}],[44,{Text:"",Color:"rgb(248,175,33)"}],[45,{Text:"",Color:"rgb(194,180,112)"}],[46,{Text:"",Color:"rgb(50,153,28)"}],[47,{Text:"",Color:"rgb(17,65,152)"}],[48,{Text:"",Color:"rgb(194,55,26)"}],[49,{Text:"",Color:"rgb(243,0,0)"}]])},CustomDrawIcon:{Data:new Map},CustomFunction:{Data:new Map},CustomVariant:{Data:new Map},CustomDataFunction:{Data:new Map([["L2_VOLNUM",{Name:"L2_VOLNUM",Description:"单数分档,按: N(0--1):(超大+大)/(中+小),M(0--1):买/卖二类,沪深京品种的资金流向,仅日线以上周期,用于特定版本",ArgCount:2}],["L2_VOL",{Name:"L2_VOL",Description:"成交量分档,按: N(0--3):超大/大/中/小四档处理,M(0--3):买入/卖出/主买/主卖四类,沪深京品种的资金流向,仅日线以上周期,用于特定版本",ArgCount:2}],["L2_AMO",{Name:"L2_AMO",Description:"成交额分档,按: N(0--3):超大/大/中/小四档处理,M(0--3):买入/卖出/主买/主卖四类,沪深京品种的资金流向,仅日线以上周期,用于特定版本",ArgCount:2}]])},GetDrawIcon:function(t){var e;if(Qr.CustomDrawIcon.Data.has(t)){var a=Qr.CustomDrawIcon.Data.get(t);return e=a.Symbol?{Symbol:a.Symbol,Color:a.Color,IconFont:!1,ID:t}:{Symbol:a.Text,Color:a.Color,Family:a.Family,IconFont:!0,ID:t},e}if(Qr.DrawIcon.Data.has(t)){var i=Qr.DrawIcon.Data.get(t);return e={Symbol:i.Text,Color:i.Color,Family:Qr.DrawIcon.Family,IconFont:!0,ID:t},e}return null},GetDrawTextIcon:function(t){var e=new Map([[1,{Symbol:"↑",Color:"rgb(238,44,44)"}],[2,{Symbol:"↓",Color:"rgb(0,139,69)"}],[3,{Symbol:"😧"}],[4,{Symbol:"😨"}],[5,{Symbol:"😁"}],[6,{Symbol:"😱"}],[7,{Symbol:"B",Color:"rgb(238,44,44)"}],[8,{Symbol:"S",Color:"rgb(0,139,69)"}],[9,{Symbol:"💰"}],[10,{Symbol:"📪"}],[11,{Symbol:"👆"}],[12,{Symbol:"👇"}],[13,{Symbol:"B",Color:"rgb(178,34,34)"}],[14,{Symbol:"S",Color:"rgb(0,139,69)"}],[36,{Symbol:"Χ",Color:"rgb(238,44,44)"}],[37,{Symbol:"X",Color:"rgb(0,139,69)"}],[38,{Symbol:"▲",Color:"rgb(238,44,44)"}],[39,{Symbol:"▼",Color:"rgb(0,139,69)"}],[40,{Symbol:"◉",Color:"rgb(238,44,44)"}],[41,{Symbol:"◈",Color:"rgb(238,44,44)"}],[42,{Symbol:"📌"}],[43,{Symbol:"💎"}],[44,{Symbol:"🥇"}],[45,{Symbol:"🥈"}],[46,{Symbol:"🥉"}],[47,{Symbol:"🏅"}]]),a=e.get(t);return a},IsCustomFunction:function(t){return!!Qr.CustomFunction.Data.has(t)},IsCustomVariant:function(t){return!!Qr.CustomVariant.Data.has(t)},IsCustomDataFunction:function(t){return!!Qr.CustomDataFunction.Data.has(t)}},qr={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"},jr={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},$r={FromCodePoint:function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10))+String.fromCharCode(56320+(t-65536&1023))},IsWhiteSpace:function(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0},IsLineTerminator:function(t){return 10===t||13===t||8232===t||8233===t},IsIdentifierStart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||12304===t||12305===t||9650===t||9660===t||t>=128&&jr.NonAsciiIdentifierStart.test($r.FromCodePoint(t))},IsIdentifierPart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||35===t||12304===t||12305===t||9650===t||9660===t||t>=128&&jr.NonAsciiIdentifierPart.test($r.FromCodePoint(t))},IsDecimalDigit:function(t){return t>=48&&t<=57},IsHexDigit:function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},isOctalDigit:function(t){return t>=48&&t<=55}},tn={};function en(){}function an(){this.Error=[],this.RecordError=function(t){this.Error.push(t)},this.ConstructError=function(t,e){var a=new Error(t);try{throw a}catch(i){Object.create&&Object.defineProperties&&(a=Object.create(i),a.Column=e)}return a},this.CreateError=function(t,e,a,i,r){var n="Line "+e+": "+i,o=this.ConstructError(n,a);return o.Index=t,o.LineNumber=e,o.Description=i,o.Word=r,o},this.ThrowError=function(t,e,a,i,r){var n=this.CreateError(t,e,a,i,r);throw n},this.ThrowDownloadJob=function(t,e,a,i,r){var n=this.CreateError(t,e,a,i);throw n.Job=r,n}}function rn(t,e){this.Source=t,this.ErrorHandler=e,this.Length=t.length,this.Index=0,this.LineNumber=t.length>0?1:0,this.LineStart=0,this.CurlyStack=[],this.SaveState=function(){return{Index:this.Index,LineNumber:this.LineNumber,LineStart:this.LineStart}},this.RestoreState=function(t){this.Index=t.Index,this.LineNumber=t.LineNumber,this.LineStart=t.LineStart},this.IsEOF=function(){return this.Index>=this.Length},this.IsKeyword=function(t){return!1},this.CodePointAt=function(t){var e=this.Source.charCodeAt(t);if(e>=55296&&e<=56319){var a=this.Source.charCodeAt(t+1);if(a>=56320&&a<=57343){var i=e;e=1024*(i-55296)+a-56320+65536}}return e},this.Lex=function(){if(this.IsEOF())return{Type:2,Value:"",LineNumber:this.LineNumber,LineStart:this.LineStart,Start:this.Index,End:this.Index};var t=this.Source.charCodeAt(this.Index);return $r.IsIdentifierStart(t)?this.ScanIdentifier():40===t||41===t||59===t?this.ScanPunctuator():39===t||34===t?this.ScanStringLiteral():46==t?$r.IsDecimalDigit(this.Source.charCodeAt(this.Index+1))?this.ScanNumericLiteral():this.ScanPunctuator():$r.IsDecimalDigit(t)?this.ScanNumericLiteral():t>=55296&&t<57343&&$r.IsIdentifierStart(this.CodePointAt(this.Index))?this.ScanIdentifier():this.ScanPunctuator()},this.ScanIdentifier=function(){var t,e=this.Index,a=92===this.Source.charCodeAt(e)?this.GetComplexIdentifier():this.GetIdentifier();if(t=a.length?3:this.IsKeyword(a)?4:null==a?5:"true"==a||"false"==a?1:3,3!=t&&e+a.length!=this.Index){this.Index;throw this.Index=e,qr.InvalidEscapedReservedWord}return"AND"!=a&&"OR"!=a||(t=7),{Type:t,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.GetIdentifier=function(){var t=this.Index++;while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(92==e)return this.Index=t,this.GetComplexIdentifier();if(e>=55296&&e<57343)return this.Index=t,this.GetComplexIdentifier();if(!$r.IsIdentifierPart(e))break;++this.Index}return this.Source.slice(t,this.Index)},this.ScanPunctuator=function(){var t=this.Index,e=this.Source[this.Index];switch(e){case"(":++this.Index;break;case")":case";":case",":++this.Index;break;case".":++this.Index;break;default:e=this.Source.substr(this.Index,3),"AND"==e?this.Index+=3:(e=this.Source.substr(this.Index,2),"&&"===e||"||"===e||"=="===e||"!="===e||"<="===e||">="===e||"=>"===e||":="==e||"OR"==e||"<>"==e?this.Index+=2:(e=this.Source[this.Index],"<>=!+-*%&|^/:".indexOf(e)>=0&&++this.Index))}return this.Index==t&&this.ThrowUnecpectedToken(),{Type:7,Value:e,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanStringLiteral=function(){var t=this.Index,e=this.Source[this.Index];++this.Index;var a="";while(!this.IsEOF()){var i=this.Source[this.Index++];if(i==e){e="";break}if("\\"==i)throw"not complete";if($r.IsLineTerminator(i.charCodeAt(0)))break;a+=i}return""!=e&&(this.Index=t,this.ThrowUnecpectedToken()),{Type:8,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanNumericLiteral=function(){var t=this.Index,e=this.Source[this.Index],a="";if("."!=e){if(a=this.Source[this.Index++],e=this.Source[this.Index],"0"==a&&("x"==e||"X"==e))return++this.Index,this.ScanHexLiteral(t);while($r.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("."==e){a+=this.Source[this.Index++];while($r.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("e"==e||"E"==e)if(a+=this.Source[this.Index++],e=this.Source[this.Index],"+"!=e&&"-"!=e||(a+=this.Source[this.Index]),$r.IsDecimalDigit(this.Source.charCodeAt(this.Index)))while($r.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];else this.ThrowUnecpectedToken();return $r.IsIdentifierStart(this.Source.charCodeAt(this.Index))&&this.ThrowUnecpectedToken(),{Type:6,Value:parseFloat(a),LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanComments=function(){this.Index;while(!this.IsEOF()){var t=this.Source.charCodeAt(this.Index);if($r.IsWhiteSpace(t))++this.Index;else if($r.IsLineTerminator(t))++this.Index,13==t&&10==this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,!0;else if(47==t){if(t=this.Source.charCodeAt(this.Index+1),47!=t)break;this.Index+=2;this.SkipSingleLineComment(2);!0}else{if(123!=t)break;this.Index+=1;this.SkipMultiLineComment()}}},this.SkipMultiLineComment=function(){var t=[];while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if($r.IsLineTerminator(e))++this.LineNumber,++this.Index,this.LineStart=this.Index;else{if(125==e)return this.Index+=1,t;++this.Index}}return t},this.SkipSingleLineComment=function(t){var e=[];while(!this.IsEOF()){var a=this.Source.charCodeAt(this.Index);if(++this.Index,$r.IsLineTerminator(a))return 13===a&&10===this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,e}return e},this.ThrowUnecpectedToken=function(t,e){return t||(t=qr.UnexpectedTokenIllegal),this.ErrorHandler.ThrowError(this.Index,this.LineNumber,this.Index-this.LineStart+1,t,e)}}function nn(t){this.ErrorHandler=new an,this.Scanner=new rn(t,this.ErrorHandler),this.Buffer=[],this.GetNextToken=function(){if(0==this.Buffer.length){this.Scanner.ScanComments();if(!this.Scanner.IsEOF()){var t=this.Scanner.Lex(),e={Type:tn[t.Type],Value:this.Scanner.Source.slice(t.Start,t.End)};this.Buffer.push(e)}}return this.Buffer.shift()}}tn[1]="Boolean",tn[2]="<end>",tn[3]="Identifier",tn[4]="Keyword",tn[5]="Null",tn[6]="Numeric",tn[7]="Punctuator",tn[8]="String",tn[9]="RegularExpression",tn[10]="Template",en.GetPeriodInfo=function(t){var e=[{Name:"MIN1",Period:4,Order:1},{Name:"MIN5",Period:5,Order:2},{Name:"MIN15",Period:6,Order:3},{Name:"MIN30",Period:7,Order:4},{Name:"MIN60",Period:8,Order:5},{Name:"DAY",Period:0,Order:1e3},{Name:"MULTIDAY",Period:40002,Order:1002},{Name:"DAY2",Period:40002,Order:1002},{Name:"DAY3",Period:40003,Order:1003},{Name:"DAY4",Period:40004,Order:1004},{Name:"DAY5",Period:40005,Order:1005},{Name:"WEEK",Period:1,Order:1005},{Name:"DAY6",Period:40006,Order:1006},{Name:"DAY7",Period:40007,Order:1007},{Name:"DAY8",Period:40008,Order:1008},{Name:"DAY9",Period:40009,Order:1009},{Name:"DAY10",Period:40009,Order:1010},{Name:"WEEK2",Period:21,Order:1010},{Name:"DAY11",Period:40011,Order:1011},{Name:"DAY12",Period:40012,Order:1012},{Name:"DAY13",Period:40013,Order:1013},{Name:"DAY14",Period:40014,Order:1014},{Name:"MONTH",Period:2,Order:1030},{Name:"SEASON",Period:9,Order:1090},{Name:"HALFYEAR",Period:22,Order:1180},{Name:"YEAR",Period:3,Order:1365}];if(t.Name){for(var a in e)if(t.Name&&e[a].Name==t.Name)return e[a];return null}if(sa.IsNumber(t.PeriodID)){for(var a in e)if(e[a].Period==t.PeriodID)return e[a];return null}return null},en.GetConvertValueName=function(t){var e;return"COVER_C"==t?e="CLOSE":"COVER_O"==t?e="OPEN":"COVER_H"==t?e="HIGH":"COVER_L"==t?e="LOW":"COVER_A"==t?e="AMOUNT":"COVER_V"==t&&(e="VOL"),e};var on={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"};function sn(t){this.IsNeedIndexData=!1,this.IsNeedLatestIndexData=!1,this.IsNeedSymbolData=!1,this.IsNeedMarginData=new Set,this.IsNeedNewsAnalysisData=new Set,this.NeedBlockIncreaseData=[],this.IsNeedSymbolExData=new Set,this.NeedHK2SHSZData=[],this.IsNeedSectionFinance=new Map,this.FunctionData=[],this.Dynainfo=[],this.IsAPIData=[],this.ExecuteIndex=[],this.OtherSymbolData=[],this.PeriodSymbolData=[],this.ErrorHandler=t,this.GetDataJobList=function(){var t=[];this.IsNeedSymbolData&&t.push({ID:fn.JOB_DOWNLOAD_SYMBOL_DATA}),this.IsNeedIndexData&&t.push({ID:fn.JOB_DOWNLOAD_INDEX_DATA}),this.IsNeedLatestIndexData&&t.push({ID:fn.JOB_DOWNLOAD_LATEST_INDEX_DATA});for(var e=0;e<this.Dynainfo.length;++e){var a=this.Dynainfo[e];t.push(a)}for(var e in this.NeedBlockIncreaseData)t.push(this.NeedBlockIncreaseData[e]);var i,r=(0,l.default)(this.IsNeedMarginData);try{for(r.s();!(i=r.n()).done;){var n=i.value;t.push({ID:n})}}catch(f){r.e(f)}finally{r.f()}for(var e in this.NeedHK2SHSZData)t.push(this.NeedHK2SHSZData[e]);var o,s=(0,l.default)(this.IsNeedNewsAnalysisData);try{for(s.s();!(o=s.n()).done;){n=o.value;t.push({ID:n})}}catch(f){s.e(f)}finally{s.f()}var h,u=(0,l.default)(this.IsNeedSymbolExData);try{for(u.s();!(h=u.n()).done;){n=h.value;t.push({ID:n})}}catch(f){u.e(f)}finally{u.f()}var C,D=(0,l.default)(this.IsNeedSectionFinance);try{for(D.s();!(C=D.n()).done;){a=C.value;t.push({ID:fn.JOB_DOWNLOAD_SECTION_SF,SF:a})}}catch(f){D.e(f)}finally{D.f()}for(var e in this.IsAPIData){a=this.IsAPIData[e];t.push(a)}for(var e in this.ExecuteIndex){a=this.ExecuteIndex[e];t.push(a)}for(var e in this.OtherSymbolData){a=this.OtherSymbolData[e];t.push(a)}for(var e in this.PeriodSymbolData){a=this.PeriodSymbolData[e];t.push(a)}for(var e in this.FunctionData){a=this.FunctionData[e];t.push(a)}return t},this.VerifySymbolVariable=function(t,e){var a=new Set(["INDEXA","INDEXC","INDEXH","INDEXL","INDEXO","INDEXV","INDEXDEC","INDEXADV"]);if(a.has(t))this.IsNeedIndexData=!0;else{var i=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(i.has(t))this.IsNeedSymbolData=!0;else{"VOLR"===t&&(this.IsNeedSymbolExData.has(fn.JOB_DOWNLOAD_VOLR_DATA)||this.IsNeedSymbolExData.add(fn.JOB_DOWNLOAD_VOLR_DATA));var r=new Set(["CAPITAL","TOTALCAPITAL","EXCHANGE","HSL","HYBLOCK","DYBLOCK","GNBLOCK","FGBLOCK","ZSBLOCK","ZHBLOCK","ZDBLOCK","HYZSCODE","GNBLOCKNUM","FGBLOCKNUM","ZSBLOCKNUM","ZHBLOCKNUM","ZDBLOCKNUM","HYSYL","HYSJL","FROMOPEN","LARGEINTRDVOL","LARGEOUTTRDVOL","TRADENUM","TRADEINNUM","TRADEOUTNUM","LARGETRDINNUM","LARGETRDOUTNUM","CUR_BUYORDER","CUR_SELLORDER","ACTINVOL","ACTOUTVOL","BIDORDERVOL","BIDCANCELVOL","AVGBIDPX","OFFERORDERVOL","OFFERCANCELVOL","AVGOFFERPX"]);if(r.has(t)){var n={ID:fn.JOB_DOWNLOAD_VARIANT,VariantName:t};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}if("ADVANCE"==t||"DECLINE"==t){n={ID:fn.JOB_DOWNLOAD_INDEX_INCREASE_DATA,IsSelfSymbol:!0,FunctionName:t};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.NeedBlockIncreaseData.push(n)}if(t.indexOf("#")>0){var o=t.split("#");if(2!=o.length){var s="".concat(t,", 跨周期语法错误, 变量名#周期");this.ThrowUnexpectedToken(e,s)}else{if(["C","CLOSE","O","OPEN","H","HIGH","L","LOW","AMOUNT","AMO","VOL","V","VOLINSTK"].indexOf(o[0])<0){s="".concat(t,", 跨周期语法错误, 数据只支持'OPEN,HIGH,LOW,CLOSE,VOL,AMOUNT,VOLINSTK'");this.ThrowUnexpectedToken(e,s)}if(["MIN1","MIN5","MIN15","MIN30","MIN60","MIN120","MIN240","DAY","WEEK","MONTH","SEASON","YEAR","HALFYEAR","WEEK2","MULTIDAY","DAY2","DAY3","DAY4","DAY5","DAY6","DAY7","DAY8","DAY9","DAY10","DAY11","DAY12","DAY13","DAY14","DAY15"].indexOf(o[1])<0){s="".concat(t,", 跨周期语法错误， 周期只支持'MIN1,MIN5,MIN15,MIN30,MIN60,DAY,WEEK,MONTH,SEASON,YEAR'");this.ThrowUnexpectedToken(e,s)}n={ID:fn.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA,VarName:t,ValueName:o[0],PeriodName:o[1]};e&&(n.Token={Index:e.Start,Line:e.LineNumber}),this.PeriodSymbolData.push(n)}}else if(Qr.IsCustomVariant(t)){n={VariantName:t,ID:fn.JOB_CUSTOM_VARIANT_DATA};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}}}},this.VerifySymbolLiteral=function(t,e){if(sa.IsString(t)&&t.indexOf("$")>0){var a=t.split("$");if(2!=a.length)return;var i={Literal:t,ID:fn.JOB_DOWNLOAD_OTHER_SYMBOL_DATA};e&&(i.Token={Index:e.Start,Line:e.LineNumber}),this.OtherSymbolData.push(i)}},this.VerifySymbolFunction=function(t,e,a){if(Qr.IsCustomFunction(t.Name)){var i={FunctionName:t.Name,ID:fn.JOB_CUSTOM_FUNCTION_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if(Qr.IsCustomDataFunction(t.Name)){i={FunctionName:t.Name,ID:fn.JOB_CUSTOM_DATA_FUNCTION,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("DYNAINFO"!=t.Name){if("FINANCE"==t.Name){i={ID:fn.JOB_DOWNLOAD_FINANCE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINVALUE"==t.Name){i={ID:fn.JOB_DOWNLOAD_FINVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINONE"==t.Name){i={ID:fn.JOB_DOWNLOAD_FINONE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}for(var r=0;r<cn.length;++r){var n=cn[r];if(n.Name==t.Name){i={ID:n.JobID,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}}if("MARGIN"!==t.Name)if("NEWS"!==t.Name){if("HK2SHSZ"===t.Name){i={ID:fn.JOB_DOWNLOAD_HK_TO_SHSZ,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.NeedHK2SHSZData.push(i)}if("COST"==t.Name||"WINNER"==t.Name||"PPART"==t.Name||"COSTEX"==t.Name||"LWINNER"==t.Name||"PWINNER"==t.Name){i={ID:fn.JOB_DOWNLOAD_FINANCE,Args:[7],FunctionName:"FINANCE",FunctionName2:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("INBLOCK"==t.Name){i={ID:fn.JOB_DOWNLOAD_VARIANT,VariantName:"INBLOCK"};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("BETA"!==t.Name){if("UPCOUNT"==t.Name||"DOWNCOUNT"==t.Name){i={ID:fn.JOB_DOWNLOAD_INDEX_INCREASE_DATA,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.NeedBlockIncreaseData.push(i)}if("STKINDI"==t.Name||"CALCSTOCKINDEX"==t.Name){i={ID:fn.JOB_EXECUTE_INDEX,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.ExecuteIndex.push(i)}if(t.Type==on.Literal){i={ID:fn.JOB_EXECUTE_INDEX,Args:e,FunctionName:t.Value,DynamicName:t.Value};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.ExecuteIndex.push(i)}if("COVER_C"==t.Name||"COVER_O"==t.Name||"COVER_H"==t.Name||"COVER_L"==t.Name||"COVER_A"==t.Name||"COVER_V"==t.Name){var o=e[0].Value;if(["MIN1","MIN5","MIN15","MIN30","MIN60","DAY","WEEK","MONTH","SEASON","YEAR"].indexOf(o)<0){var s="".concat(t.Name,", 跨周期函数错误， 周期只支持'MIN1,MIN5,MIN15,MIN30,MIN60,DAY,WEEK,MONTH,SEASON,YEAR'");this.ThrowUnexpectedToken(a,s)}var h=en.GetConvertValueName(t.Name);i={ID:fn.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA,FunctionName:t.Name,ValueName:h,PeriodName:o};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.PeriodSymbolData.push(i)}if("SF"!=t.Name){if("LOADAPIDATA"==t.Name){i={Name:t.Name,ID:fn.JOB_DOWNLOAD_CUSTOM_API_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.IsAPIData.push(i)}var l=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(l.has(t.Name)){i={Name:t.Name,ID:fn.JOB_DOWNLOAD_OTHER_SYMBOL_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.OtherSymbolData.push(i)}}else{var u=fn.GetSectionReportPeriod(e[0].Value,e[1].Value);if(!u)return;var C=fn.GetSectionFinanceID(e[2].Value);if(!C)return;var D=u.Year+"-"+u.Quarter;if(this.IsNeedSectionFinance.has(D)){f=this.IsNeedSectionFinance.get(D);f.Fields.has(C)||f.Fields.add(C)}else{var f={Period:u,Fields:new Set([C])};this.IsNeedSectionFinance.set(D,f)}}}else this.IsNeedIndexData=!0}else{var c=fn.GetNewsAnalysisID(e[0].Value);c&&!this.IsNeedNewsAnalysisData.has(c)&&this.IsNeedNewsAnalysisData.add(c)}else{var m=fn.GetMarginJobID(e[0].Value);m&&!this.IsNeedMarginData.has(m)&&this.IsNeedMarginData.add(m)}}else{var i={ID:fn.JOB_DOWNLOAD_SYMBOL_LATEST_DATA,Args:e,FunctionName:t.Name};this.Dynainfo.push(i)}},this.VerifyMemberVariable=function(t,e,a){var i={ID:fn.JOB_EXECUTE_INDEX,Member:{Object:t,Property:e}};a&&(i.Token={Index:a.Start,Line:a.LineNumber}),this.ExecuteIndex.push(i)},this.ExpressionStatement=function(t){return{Type:on.ExpressionStatement,Expression:t}},this.Script=function(t){return{Type:on.Program,Body:t,SourceType:"通达信脚本"}},this.SequenceExpression=function(t){return{Type:on.SequenceExpression,Expression:t}},this.BinaryExpression=function(t,e,a){var i="||"===t||"&&"===t||"AND"==t||"OR"==t,r=i?on.LogicalExpression:on.BinaryExpression;return{Type:r,Operator:t,Left:e,Right:a}},this.Literal=function(t,e,a){return this.VerifySymbolLiteral(t,a),{Type:on.Literal,Value:t,Raw:e}},this.Identifier=function(t,e){return this.VerifySymbolVariable(t,e),{Type:on.Identifier,Name:t}},this.MemberIdentifier=function(t,e){return{Type:on.Identifier,Name:t}},this.AssignmentExpression=function(t,e,a){return{Type:on.AssignmentExpression,Operator:t,Left:e,Right:a}},this.UnaryExpression=function(t,e){return{Type:on.UnaryExpression,Operator:t,Argument:e,Prefix:!0}},this.EmptyStatement=function(){return{Type:on.EmptyStatement}},this.CallExpression=function(t,e,a){return this.VerifySymbolFunction(t,e,a),{Type:on.CallExpression,Callee:t,Arguments:e}},this.StaticMemberExpression=function(t,e,a){return this.VerifyMemberVariable(t,e,a),{Type:on.MemberExpression,Computed:!1,Object:t,Property:e}},this.Directive=function(t,e){return{Type:on.ExpressionStatement,Expression:t,Directive:e}},this.ThrowUnexpectedToken=function(t,e){throw this.UnexpectedTokenError(t,e)},this.UnexpectedTokenError=function(t,e){var a=e||qr.UnexpectedToken,i="ILLEGAL";if(t&&(i=t.Value),a=a.replace("%0",i),t&&"number"==typeof t.LineNumber){var r=t.Start,n=t.LineNumber;return this.ErrorHandler.CreateError(r,n,-1,a)}}}function hn(t){this.ErrorHandler=new an,this.Scanner=new rn(t,this.ErrorHandler),this.Node=new sn(this.ErrorHandler),this.LookAhead={Type:2,Value:"",LineNumber:this.Scanner.LineNumber,LineStart:0,Start:0,End:0},this.HasLineTerminator=!1,this.Context={IsModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,FirstCoverInitializedNameError:null,IsAssignmentTarget:!1,IsBindingElement:!1,InFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},Strict:!1},this.PeratorPrecedence={")":0,";":0,",":0,"]":0,"||":1,OR:1,"&&":2,AND:2,"|":3,"^":4,"&":5,"==":6,"=":6,"!=":6,"<>":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.StartMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.LastMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.Initialize=function(){this.NextToken(),this.LastMarker={Index:this.Scanner.Index,Line:this.Scanner.LineNumber,Column:this.Scanner.Index-this.Scanner.LineStart}},this.CreateNode=function(){return{Index:this.StartMarker.Index,Line:this.StartMarker.Line,Column:this.StartMarker.Column}},this.StartNode=function(t,e){void 0==e&&(e=0);var a=t.Start-t.LineStart,i=t.LineNumber;return a<0&&(a+=e,i--),{Index:t.Start,Line:i,Column:a}},this.Match=function(t){return 7==this.LookAhead.Type&&this.LookAhead.Value==t},this.Expect=function(t,e){var a=this.NextToken();7==a.Type&&a.Value==t||this.ThrowUnexpectedToken(a,e)},this.MatchAssign=function(){if(7!=this.LookAhead.Type)return!1;var t=this.LookAhead.Value;return":"==t||":="==t},this.GetTokenRaw=function(t){return this.Scanner.Source.slice(t.Start,t.End)},this.NextToken=function(){var t=this.LookAhead;this.LastMarker.Index=this.Scanner.Index,this.LastMarker.Line=this.Scanner.LineNumber,this.LastMarker.Column=this.Scanner.Index-this.Scanner.LineStart,this.CollectComments(),this.Scanner.Index!==this.StartMarker.Index&&(this.StartMarker.Index=this.Scanner.Index,this.StartMarker.Line=this.Scanner.LineNumber,this.StartMarker.Column=this.Scanner.Index-this.Scanner.LineStart);var e=this.Scanner.Lex();return this.HasLineTerminator=t.LineNumber!=e.LineNumber,e&&this.Context.Strict&&e.Type,this.LookAhead=e,t},this.CollectComments=function(){this.Scanner.ScanComments()},this.ParseScript=function(){var t=this.CreateNode(),e=this.ParseDirectivePrologues();while(2!=this.LookAhead.Type)e.push(this.ParseStatementListItem());return this.Finalize(t,this.Node.Script(e))},this.ParseDirective=function(){var t=this.LookAhead,e=this.CreateNode(),a=this.ParseExpression(),i=a.Type===on.Literal?this.GetTokenRaw(t).slice(1,-1):null;return this.ConsumeSemicolon(),this.Finalize(e,i?this.Node.Directive(a,i):this.Node.ExpressionStatement(a))},this.ParseDirectivePrologues=function(){var t=[];while(1){var e=this.LookAhead;if(8!=e.Type)break;var a=this.ParseDirective();t.push(a)}return t},this.ParseStatementListItem=function(){var t;return this.Context.IsAssignmentTarget=!0,this.Context.IsBindingElement=!0,4==this.LookAhead.Type||(t=this.ParseStatement()),t},this.ParseStatement=function(){var t;switch(this.LookAhead.Type){case 1:case 5:case 6:case 8:case 10:case 9:t=this.ParseExpressionStatement();break;case 7:var e=this.LookAhead.Value;t="("===e?this.ParseExpressionStatement():";"===e?this.ParseEmptyStatement():this.ParseExpressionStatement();break;case 3:t=this.ParseLabelledStatement();break;case 4:break;default:t="error"}return t},this.ParseEmptyStatement=function(){var t=this.CreateNode();return this.Expect(";"),this.Finalize(t,this.Node.EmptyStatement())},this.ParseLabelledStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();this.ConsumeSemicolon();var a=new this.Node.ExpressionStatement(e);return this.Finalize(t,a)},this.ParseExpression=function(){var t=this.LookAhead,e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(this.Match(",")){var a=[];a.push(e);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),a.push(this.IsolateCoverGrammar(this.ParseAssignmentExpression))}e=this.Finalize(this.StartNode(t),this.Node.SequenceExpression(a))}return e},this.ParseAssignmentExpression=function(){var t,e=this.LookAhead,a=e;if(t=this.ParseConditionalExpression(),this.MatchAssign()){if(!this.Context.IsAssignmentTarget){var i=t.Marker;this.ThrowUnexpectedError(i.Index,i.Line,i.Column,qr.InvalidLHSInAssignment)}this.Match("=")||this.Match(":")?this.ReinterpretExpressionAsPattern(t):(this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1),a=this.NextToken();var r=a.Value,n=this.IsolateCoverGrammar(this.ParseAssignmentExpression);t=this.Finalize(this.StartNode(e),this.Node.AssignmentExpression(r,t,n)),this.Context.FirstCoverInitializedNameError=null}return t},this.ParseConditionalExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseBinaryExpression);return t},this.ParseBinaryExpression=function(){var t=this.LookAhead,e=this.InheritCoverGrammar(this.ParseExponentiationExpression),a=this.LookAhead,i=this.BinaryPrecedence(a);if(i>0){this.NextToken(),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1;var r=[t,this.LookAhead],n=e,o=this.IsolateCoverGrammar(this.ParseExponentiationExpression),s=[n,a.Value,o],h=[i];while(1){if(i=this.BinaryPrecedence(this.LookAhead),i<=0)break;while(s.length>2&&i<=h[h.length-1]){o=s.pop();var l=s.pop();h.pop(),n=s.pop(),r.pop();var u=this.StartNode(r[r.length-1]);s.push(this.Finalize(u,this.Node.BinaryExpression(l,n,o)))}s.push(this.NextToken().Value),h.push(i),r.push(this.LookAhead),s.push(this.IsolateCoverGrammar(this.ParseExponentiationExpression))}var C=s.length-1;e=s[C];var D=r.pop();while(C>1){var f=r.pop(),c=D&&D.LineStart,m=this.StartNode(f,c),d=s[C-1];e=this.Finalize(m,this.Node.BinaryExpression(d,s[C-2],e)),C-=2,D=f}}return e},this.ParseExponentiationExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseUnaryExpression);return t},this.ParseUnaryExpression=function(){var t;if(this.Match("+")||this.Match("-")){var e=this.StartNode(this.LookAhead),a=this.NextToken();t=this.InheritCoverGrammar(this.ParseUnaryExpression),t=this.Finalize(e,this.Node.UnaryExpression(a.Value,t)),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1}else t=this.ParseUpdateExpression();return t},this.ParseUpdateExpression=function(){var t;this.LookAhead;return t=this.InheritCoverGrammar(this.ParseLeftHandSideExpressionAllowCall),t},this.ParseLeftHandSideExpressionAllowCall=function(){var t,e=this.LookAhead;t=this.InheritCoverGrammar(this.ParsePrimaryExpression);while(1)if(this.Match(".")){this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!0,this.Expect(".");var a=this.ParseMemberIdentifierName();t=this.Finalize(this.StartNode(e),this.Node.StaticMemberExpression(t,a,e))}else{if(!this.Match("("))break;this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!1;var i=this.ParseArguments();t=this.Finalize(this.StartNode(e),this.Node.CallExpression(t,i,e))}return t},this.IsIdentifierName=function(t){return 3===t.Type||4===t.Type||1===t.Type||5===t.Type},this.ParseIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.Identifier(e.Value,e))},this.ParseMemberIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.MemberIdentifier(e.Value,e))},this.ParseArguments=function(){this.Expect("(");var t=[];if(!this.Match(")"))while(1){var e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(t.push(e),this.Match(")"))break;if(this.ExpectCommaSeparator(),this.Match(")"))break}return this.Expect(")"),t},this.ExpectCommaSeparator=function(){this.Expect(",","函数参数格式错误")},this.ParsePrimaryExpression=function(){var t,e,a,i=this.CreateNode();switch(this.LookAhead.Type){case 3:e=this.NextToken(),t=this.Finalize(i,this.Node.Identifier(e.Value,e));break;case 6:case 8:this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1,e=this.NextToken(),a=this.GetTokenRaw(e),t=this.Finalize(i,this.Node.Literal(e.Value,a,e));break;case 7:switch(this.LookAhead.Value){case"(":this.Context.IsBindingElement=!1,t=this.InheritCoverGrammar(this.ParseGroupExpression);break;default:t=this.ThrowUnexpectedToken(this.NextToken())}break;default:t=this.ThrowUnexpectedToken(this.NextToken())}return t},this.ParseGroupExpression=function(){var t;if(this.Expect("("),this.Match(")"))this.NextToken();else{this.LookAhead;if(this.Context.IsBindingElement=!0,t=this.InheritCoverGrammar(this.ParseAssignmentExpression),this.Match(",")){this.Context.IsAssignmentTarget=!1,[].push(t);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),this.Match(")")}}this.Expect(")"),this.Context.IsBindingElement=!1}return t},this.ParseExpressionStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();return this.ConsumeSemicolon(),this.Finalize(t,this.Node.ExpressionStatement(e))},this.ConsumeSemicolon=function(){this.Match(";")?this.NextToken():this.HasLineTerminator||(this.LastMarker.Index=this.StartMarker.Index,this.LastMarker.Line=this.StartMarker.Line,this.LastMarker.Column=this.StartMarker.Column)},this.ReinterpretExpressionAsPattern=function(t){switch(t.Type){case on.Identifier:case on.MemberExpression:case on.AssignmentExpression:break;default:break}},this.Finalize=function(t,e){return e.Marker={Line:t.Line,Column:t.Column,Index:t.Index},e},this.BinaryPrecedence=function(t){var e,a=t.Value;return e=7===t.Type&&this.PeratorPrecedence[a]||0,e},this.IsolateCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.FirstCoverInitializedNameError,this.Context.IsBindingElement=e,this.Context.IsAssignmentTarget=a,this.Context.FirstCoverInitializedNameError=i,r},this.InheritCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.IsBindingElement=this.Context.IsBindingElement&&e,this.Context.IsAssignmentTarget=this.Context.IsAssignmentTarget&&a,this.Context.FirstCoverInitializedNameError=i||this.Context.FirstCoverInitializedNameError,r},this.ThrowUnexpectedToken=function(t,e){throw this.UnexpectedTokenError(t,e)},this.ThrowUnexpectedError=function(t,e,a,i){var r=i||"执行异常";return this.ErrorHandler.ThrowError(t,e,a,r)},this.UnexpectedTokenError=function(t,e){var a=e||qr.UnexpectedToken,i="ILLEGAL";if(t&&(i=t.Value),a=a.replace("%0",i),t&&"number"==typeof t.LineNumber){var r=t.Start,n=t.LineNumber,o=this.LastMarker.Index-this.LastMarker.Column,s=t.Start-o+1;return this.ErrorHandler.CreateError(r,n,s,a)}var h=this.LastMarker.Index,l=this.LastMarker.Line,u=this.LastMarker.Column+1;return this.ErrorHandler.CreateError(h,l,u,a)}}function ln(t,e){this.ErrorHandler=t,this.SymbolData=e,this.Add=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t+e;var r,n,o=[];if(!a&&!i){for(var s=Math.max(t.length,e.length),h=0;h<s;++h)o[h]=null,h<t.length&&h<e.length&&this.IsNumber(t[h])&&this.IsNumber(e[h])&&(o[h]=t[h]+e[h]);return o}for(var l in a?(r=t,n=e):(r=e,n=t),n)o[l]=null,this.IsNumber(n[l])&&this.IsNumber(r)&&(o[l]=r+n[l]);return o},this.Subtract=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t-e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)r[o]=null,o<t.length&&o<e.length&&this.IsNumber(t[o])&&this.IsNumber(e[o])&&(r[o]=t[o]-e[o]);return r}if(a)for(var s in e)r[s]=null,this.IsNumber(t)&&this.IsNumber(e[s])&&(r[s]=t-e[s]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsNumber(e)&&(r[h]=t[h]-e);return r},this.Multiply=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t*e;var r,n,o=[];if(!a&&!i){for(var s=Math.max(t.length,e.length),h=0;h<s;++h)o[h]=null,h<t.length&&h<e.length&&this.IsNumber(t[h])&&this.IsNumber(e[h])&&(o[h]=t[h]*e[h]);return o}for(var l in a?(r=t,n=e):(r=e,n=t),n)o[l]=null,this.IsNumber(n[l])&&this.IsNumber(r)&&(o[l]=r*n[l]);return o},this.Divide=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return 0==e?null:t/e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)r[o]=null,o<t.length&&o<e.length&&this.IsNumber(t[o])&&this.IsDivideNumber(e[o])&&(r[o]=t[o]/e[o]);return r}if(a)for(var s in e)r[s]=null,this.IsNumber(t)&&this.IsDivideNumber(e[s])&&(r[s]=t/e[s]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsDivideNumber(e)&&(r[h]=t[h]/e);return r},this.GT=function(t,e){var a=sa.IsNumber(t),i=sa.IsNumber(e);if(a&&i)return t>e?1:0;var r=[];if(Array.isArray(t)&&Array.isArray(e)){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)if(r[o]=null,o<t.length&&o<e.length){if(!sa.IsVaild(t[o]))continue;if(!sa.IsVaild(e[o]))continue;isNaN(t[o])||isNaN(e[o])||(r[o]=t[o]>e[o]?1:0)}return r}if(a&&Array.isArray(e))for(var s in e)r[s]=null,sa.IsVaild(t)&&sa.IsVaild(e[s])&&(isNaN(t)||isNaN(e[s])||(r[s]=t>e[s]?1:0));else if(i&&Array.isArray(t))for(var h in t)r[h]=null,sa.IsVaild(t[h])&&sa.IsVaild(e)&&(isNaN(t[h])||isNaN(e)||(r[h]=t[h]>e?1:0));return r},this.GTE=function(t,e){var a=sa.IsNumber(t),i=sa.IsNumber(e);if(a&&i)return t>=e?1:0;var r=[];if(Array.isArray(t)&&Array.isArray(e)){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)if(r[o]=null,o<t.length&&o<e.length){if(!sa.IsVaild(t[o]))continue;if(!sa.IsVaild(e[o]))continue;r[o]=t[o]>=e[o]?1:0}return r}if(a&&Array.isArray(e))for(var s in e)r[s]=null,sa.IsVaild(t)&&sa.IsVaild(e[s])&&(r[s]=t>=e[s]?1:0);else if(i&&Array.isArray(t))for(var h in t)r[h]=null,sa.IsVaild(t[h])&&sa.IsVaild(e)&&(r[h]=t[h]>=e?1:0);return r},this.LT=function(t,e){var a=sa.IsNumber(t),i=sa.IsNumber(e);if(a&&i)return t<e?1:0;var r=[];if(Array.isArray(t)&&Array.isArray(e)){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)if(r[o]=null,o<t.length&&o<e.length){if(!sa.IsVaild(t[o]))continue;if(!sa.IsVaild(e[o]))continue;r[o]=t[o]<e[o]?1:0}return r}if(a&&Array.isArray(e))for(var s in e)r[s]=null,sa.IsVaild(t)&&sa.IsVaild(e[s])&&(r[s]=t<e[s]?1:0);else if(i&&Array.isArray(t))for(var h in t)r[h]=null,sa.IsVaild(t[h])&&sa.IsVaild(e)&&(r[h]=t[h]<e?1:0);return r},this.LTE=function(t,e){var a=sa.IsNumber(t),i=sa.IsNumber(e);if(a&&i)return t>=e?1:0;var r=[];if(Array.isArray(t)&&Array.isArray(e)){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)if(r[o]=null,o<t.length&&o<e.length){if(!sa.IsVaild(t[o]))continue;if(!sa.IsVaild(e[o]))continue;r[o]=t[o]<=e[o]?1:0}return r}if(a&&Array.isArray(e))for(var s in e)r[s]=null,sa.IsVaild(t)&&sa.IsVaild(e[s])&&(r[s]=t<=e[s]?1:0);else if(i&&Array.isArray(t))for(var h in t)r[h]=null,sa.IsVaild(t[h])&&sa.IsVaild(e)&&(r[h]=t[h]<=e?1:0);return r},this.EQ=function(t,e){var a=sa.IsNumber(t),i=sa.IsNumber(e);if(a&&i)return t==e?1:0;var r=[];if(Array.isArray(t)&&Array.isArray(e)){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)r[o]=null,o<t.length&&o<e.length&&(isNaN(t[o])||isNaN(e[o])||(r[o]=t[o]==e[o]?1:0));return r}if(a&&Array.isArray(e))for(var s in e)r[s]=null,isNaN(t)||isNaN(e[s])||(r[s]=t==e[s]?1:0);else if(i&&Array.isArray(t))for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]==e?1:0);return r},this.NEQ=function(t,e){var a=sa.IsNumber(t),i=sa.IsNumber(e);if(a&&i)return t!=e?1:0;var r=[];if(Array.isArray(t)&&Array.isArray(e)){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)r[o]=null,o<t.length&&o<e.length&&(isNaN(t[o])||isNaN(e[o])||(r[o]=t[o]!=e[o]?1:0));return r}if(a&&Array.isArray(e))for(var s in e)r[s]=null,isNaN(t)||isNaN(e[s])||(r[s]=t!=e[s]?1:0);else if(i&&Array.isArray(t))for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]!=e?1:0);return r},this.And=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t&&e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)r[o]=null,o<t.length&&o<e.length&&(isNaN(t[o])||isNaN(e[o])||(r[o]=t[o]&&e[o]?1:0));return r}if(a)for(var s in e)r[s]=null,isNaN(t)||isNaN(e[s])||(r[s]=t&&e[s]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]&&e?1:0);return r},this.Or=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t||e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)r[o]=null,o<t.length&&o<e.length&&(isNaN(t[o])||isNaN(e[o])||(r[o]=t[o]||e[o]?1:0));return r}if(a)for(var s in e)r[s]=null,isNaN(t)||isNaN(e[s])||(r[s]=t||e[s]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]||e?1:0);return r},this.IF=function(t,e,a){var i=this.IsNumber(t),r=this.IsNumber(e),n=this.IsNumber(a),o=Array.isArray(e),s=Array.isArray(a);if(i)return t?e:a;var h=[];for(var l in t)t[l]?h[l]=r?e:o?e[l]:null:h[l]=n?a:s?a[l]:null;return h},this.IFN=function(t,e,a){return this.IF(t,a,e)},this.REF=function(t,e){var a=[];if("number"==typeof e)if(sa.IsNumber(t)){if(e<0)return a;var i=this.SymbolData.Data.Data;if(!i||i.length<=0)return a;for(var r=i.length,n=e;n<r;++n)a[n]=t}else{if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var o=t[0],s=0;s<e;++s)a.unshift(o)}else for(var h=0;h<t.length;++h)if(a[h]=null,!(h>=e.length)){var l=e[h];a[h]=l>=0&&l<=h?t[h-l]:h?a[h-1]:t[h]}return a},this.REFV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null)}else for(var r=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){var n=e[r];n>=0&&n<=r&&(a[r]=t[r-n])}return a},this.REFX=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return t.length>0?t[t.length-1]:a;a=t.slice(e,t.length);for(var i=t[t.length-1],r=0;r<e;++r)a.push(i)}else for(var n=t.length,o=0;o<t.length;++o)if(a[o]=null,!(o>=e.length)){var s=e[o];a[o]=s>=0&&s+o<n?t[o+s]:o?a[o-1]:t[o]}return a},this.REFXV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(e,t.length);for(var i=0;i<e;++i)a.push(null)}else for(var r=t.length,n=0;n<t.length;++n)if(a[n]=null,!(n>=e.length)){var o=e[n];o>=0&&o+n<r&&(a[n]=t[n+o])}return a},this.MAX=function(t,e){if(0==t.length&&this.ThrowUnexpectedNode(e,"MAX() Error: 参数个数不能为0"),1==t.length)return t[0];var a=[],i=[];for(var r in t){var n=t[r];sa.IsNumber(n)?i.push(n):Array.isArray(n)&&a.push(n)}var o=null;if(i.length>0){o=i[0];for(r=1;r<i.length;++r)o=Math.max(o,i[r])}var s=null;if(a.length>0){s=a[0].slice(0);for(r=1;r<a.length;++r){var h=a[r];for(var l in h){var u=s[l];n=h[l];sa.IsNumber(u)&&(sa.IsNumber(n)?s[l]=Math.max(u,n):s[l]=null)}}}if(null==s&&null!=o)return o;if(s&&null==o)return s;for(var r in s)sa.IsNumber(s[r])&&(s[r]=Math.max(s[r],o));return s},this.MIN=function(t,e){if(0==t.length&&this.ThrowUnexpectedNode(e,"MIN() Error: 参数个数不能为0"),1==t.length)return t[0];var a=[],i=[];for(var r in t){var n=t[r];sa.IsNumber(n)?i.push(n):Array.isArray(n)&&a.push(n)}var o=null;if(i.length>0){o=i[0];for(r=1;r<i.length;++r)o=Math.min(o,i[r])}var s=null;if(a.length>0){s=a[0].slice(0);for(r=1;r<a.length;++r){var h=a[r];for(var l in h){var u=s[l];n=h[l];sa.IsNumber(u)&&(sa.IsNumber(n)?s[l]=Math.min(u,n):s[l]=null)}}}if(null==s&&null!=o)return o;if(s&&null==o)return s;for(var r in s)sa.IsNumber(s[r])&&(s[r]=Math.min(s[r],o));return s},this.ABS=function(t){var e=[];for(var a in t)e[a]=null,isNaN(t[a])||(e[a]=Math.abs(t[a]));return e},this.MA=function(t,e){var a=[];if(e<=0)return a;if(Array.isArray(e)){for(h=0;h<t.length;++h)if(a[h]=null,!(h>=e.length)){var i=e[h];if(this.IsNumber(i)&&!(i<=0)){for(var r=0,n=0,o=h,s=0;o>=0&&s<i;--o,++s)r+=t[o],++n;n>0&&(a[h]=r/n)}}}else{if(e=parseInt(e),e<=0&&(e=1),!t||!t.length)return a;for(var h=0;h<t.length;++h)if(a[h]=null,this.IsNumber(t[h]))break;t=t.slice(0);for(var l=0;h<t.length;++h,++l)if(l<e-1)a[h]=null;else{for(var u=t[h-(e-1)],C=0,D=e-1;D>=0;--D){var f=t[h-D];this.IsNumber(f)?u=f:(f=u,t[h-D]=f),C+=f}a[h]=C/e}}return a},this.EMA=function(t,e){var a=[];if(t.length<=0)return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){var r=e[i];if(this.IsNumber(r)&&(r=parseInt(r),!(r<=0))){r>i+1&&(r=i+1);for(var n=[2/(r+1),(r-1)/(r+1)],o=null,s=null,h=0;h<r;++h){var l=i-(r-h-1),u=t[l];this.IsNumber(u)||coninue,null==s?(o=u,s=o):(o=n[0]*u+n[1]*s,s=o)}a[i]=o}}else{if(e=parseInt(e),e<=0)return a;for(var C=0;C<t.length;++C)if(null!=t[C]&&!isNaN(t[C]))break;var D=C,f=C+1;a[D]=t[D];for(i=C+1;i<t.length;++i,++D,++f)a[f]=(2*t[f]+(e-1)*a[D])/(e+1)}return a},this.XMA=function(t,e){for(var a=[],i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(var r=parseInt((e-2)/2),n=0,o=0,s=0,h=0,l=i,u=0;l<t.length;++l){for(s=l-r-1,h=l+(e-r)-1,u=s;u<h;++u)u>=0&&u<t.length&&this.IsNumber(t[u])&&(n+=t[u],++o);a[l]=0!=o?n/o:null,n=0,o=0}return a},this.SMA=function(t,e,a){var i=[];if(Array.isArray(e))for(var r=0;r<e.length;++r){var n=e[r];if(this.IsNumber(n)&&(n=parseInt(n),!(n<=0))){n>r+1&&(n=r+1);for(var o=null,s=null,h=0;h<n;++h){var l=r-(n-h-1),u=t[l];this.IsNumber(u)&&(null==o?(o=u,s=u):(s=(a*u+(n-a)*o)/n,o=s))}i[r]=s}}else{r=e;for(var C=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){C=t[r],i[r]=C;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*C)/e,C=i[r]}return i},this.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:e[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},this.WMA=function(t,e){var a=[];if(!t||!t.length)return a;if(Array.isArray(e)){for(D=0;D<e.length&&D<t.length;++D){a[D]=null;var i=e[D];if(!(i<=0)){for(var r=0,n=0,o=0,s=0,h=0;h<i;++h)if(o=D-(i-h-1),n=t[o],r=h,this.IsNumber(n)){s=n;break}if(!(r>=i)){for(var l=0,u=0,C=(h=r,1);h<i;++h,++C)o=D-(i-h-1),n=t[o],this.IsNumber(n)?s=n:n=s,u+=C,l+=n*C;a[D]=l/u}}}return a}if(e<=0)return[];var D=0;for(D=0;D<t.length&&!this.IsNumber(t[D]);++D)a[D]=null;t=t.slice(0);for(var f=0;D<t.length;++D,++f)if(f<e-1)a[D]=null;else{for(s=t[D-(e-1)],l=0,u=0,h=e-1;h>=0;--h){n=t[D-h];this.IsNumber(n)?s=n:(n=s,t[D-h]=n),u+=e-h,l+=n*(e-h)}a[D]=l/u}return a},this.MEMA=function(t,e){var a=[];if(!t||!t.length)return a;var i=0,r=0;for(r=0;r<t.length&&!this.IsNumber(t[r]);++r)a[r]=null;if(i=r,e<1||i+e>=t.length)return a;var n=0;for(t=t.slice(0);i<r+e;++i)a[i]=null,!this.IsNumber(t[i])&&i-1>=0&&(t[i]=t[i-1]),n+=t[i];for(a[i-1]=n/e;i<t.length;++i)this.IsNumber(a[i-1])&&this.IsNumber(t[i])?a[i]=(t[i]+a[i-1]*(e-1))/e:i-1>-1&&this.IsNumber(a[i-1])?a[i]=a[i-1]:a[i]=null;return a},this.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.SUMBARS=function(t,e){var a=[];if(!t||!t.length||!e||!e.length)return a;for(var i=0,r=0,n=0;i<t.length&&!this.IsNumber(t[i]);++i)a[i]=null;for(r=t.length-1;r>=i;--r){var o=0;for(n=r,o=0;n>=i&&o<e[r];--n)o+=t[n];a[r]=n<i?null:r-n}for(r=i+1;r<t.length;++r)null==a[r]&&(a[r]=a[r-1]);return a},this.REVERSE=function(t){if(this.IsNumber(t))return 0-t;for(var e=[],a=0;a<t.length&&!this.IsNumber(t[a]);++a)e[a]=null;for(;a<t.length;++a)this.IsNumber(t[a])?e[a]=0-t[a]:e[a]=null;return e},this.COUNT=function(t,e){if(Array.isArray(e)){for(var a=null,i=t.length,r=0;r<i;++r)if(this.IsNumber(t[r])){a=r;break}if(null==a)return[];var n=[],o=0;for(r=0;r<e.length;++r){var s=e[r];if(0!=s){sa.IsNumber(s)?s<0&&(s=r+1):s=r+1,o=0;for(var h=r,l=0;h>=0&&l<s;--h,++l)t[h]&&++o;n[r]=o}else n[r]=0}return n}for(s=e,i=t.length,s=s<1?i:s,r=0,h=0;r<i;++r)if(this.IsNumber(t[r]))break;n=[];for(var u=0;r<i&&h<s;++r,++h)u=t[r]?u+1:u,n[r]=u;for(;r<i;++r)t[r-s]&&u&&u--,u=t[r]?u+1:u,n[r]=u;return n},this.HHV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=null,r=0,n=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){i=null;var o=e[r];if(o>0&&o<=r)for(n=r-o;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);else for(o=r,n=0;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);a[r]=i}}else{if(!sa.IsNonEmptyArray(t))return a;e=parseInt(e),(e<=0||e>t.length)&&(e=t.length);var s=this.GetFirstVaildIndex(t);if(s>=t.length)return a;var h=s;h<t.length&&(a[h]=t[h]);for(r=h+1,n=2;r<t.length&&n<e;++r,++n)t[r]>=t[h]&&(h=r),a[r]=t[h];for(;r<t.length;++r){if(r-h<e)h=t[r]<t[h]?h:r;else for(n=h=r-e+1;n<=r;++n)h=t[n]<t[h]?h:n;a[r]=t[h]}}return a},this.HV=function(t,e){var a=this.HHV(t,e);return this.REF(a,1)},this.LLV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=0;i<t.length;++i)if(a[i]=null,!(i>=e.length)){var r=null,n=e[i];if(n>0&&n<=i)for(var o=i-n;o<=i;++o)(null==r||r>t[o])&&(r=t[o]);else{n=i;for(o=0;o<=i;++o)(null==r||r>t[o])&&(r=t[o])}a[i]=r}}else{if(!sa.IsNonEmptyArray(t))return a;e=parseInt(e),(e<=0||e>t.length)&&(e=t.length);var s=this.GetFirstVaildIndex(t);if(s>=t.length)return a;var h=s;h<t.length&&(a[h]=t[h]);for(i=h+1,o=2;i<t.length&&o<e;++i,++o)t[i]<=t[h]&&(h=i),a[i]=t[h];for(;i<t.length;++i){if(i-h<e)h=t[i]>t[h]?h:i;else for(o=h=i-e+1;o<=i;++o)h=t[o]>t[h]?h:o;a[i]=t[h]}}return a},this.LV=function(t,e){var a=this.LLV(t,e);return this.REF(a,1)},this.STD=function(t,e){var a=[];if(!Array.isArray(t))return a;var i=this.GetFirstVaildIndex(t);if(!sa.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,o=!0,s=0,h=0;for(r+=e-1;r<t.length;++r){if(s=0,o){for(o=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)s+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(s/(e-1))}return a},this.STDDEV=function(t,e){var a=[];if(!Array.isArray(t))return a;var i=this.GetFirstVaildIndex(t);if(!sa.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,o=!0,s=0,h=0;for(r+=e-1;r<t.length;++r){if(s=0,o){for(o=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)s+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(s/(e-1))/Math.sqrt(e)}return a},this.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var o=0;o<e;++o)i+=t[n-o];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(o=0;o<e;++o)i+=Math.abs(t[n-o]-r[n]);a[n]=i/e}return a},this.CROSS=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e)){if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(this.IsNumber(t[i])&&this.IsNumber(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0}else if(Array.isArray(t)&&"number"==typeof e){for(i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e&&t[i-1]<e?1:0}else if("number"==typeof t&&Array.isArray(e)){for(i=0;i<e.length;++i)if(this.IsNumber(e[i]))break;for(++i;i<e.length;++i)a[i]=e[i]<t&&e[i-1]>t?1:0}return a},this.CROSSDOWN=function(t,e){return this.CROSS(e,t)},this.CROSSUP=function(t,e){return this.CROSS(t,e)},this.MULAR=function(t,e){var a=[];if(Array.isArray(e))for(n=0;n<t.length;++n){a[n]=null;var i=e[n];if(this.IsNumber(i)&&(i=parseInt(i),!(i<0)))for(o=n,s=0;o>=0&&s<i;--o,++s)0==s?a[n]=t[o]:a[n]*=t[o]}else{if(t.length<e)return a;if(0==e){for(var r=e;r<t.length;++r)if(this.IsNumber(t[r])){a[r]=t[r];break}for(++r;r<t.length;++r)a[r]=a[r-1]*t[r]}else for(var n=e-1,o=0;n<t.length;++n,++o)for(var s=0;s<e;++s)0==s?a[n]=t[s+o]:a[n]*=t[s+o]}return a},this.SUM=function(t,e){var a=[];if(Array.isArray(e))for(n=0;n<t.length;++n){a[n]=null;var i=e[n];if(i>0)for(o=n,s=0;o>=0&&s<i;--o,++s)0==s?a[n]=t[o]:a[n]+=t[o]}else if(e<=0){for(var r=-1,n=0;n<t.length;++n)if(sa.IsNumber(t[n])){r=n;break}if(r<0)return a;a[r]=t[r];for(var n=r+1;n<t.length;++n)a[n]=a[n-1]+t[n]}else{a[0]=t[0];for(n=1;n<e&&n<t.length;++n)a[n]=a[n-1]+t[n];n=e-1;for(var o=0;n<t.length;++n,++o)for(var s=0;s<e;++s)0==s?a[n]=t[s+o]:a[n]+=t[s+o]}return a},this.BARSCOUNT=function(t){var e=[],a=null;for(var i in t){if(e[i]=0,null==a){if(!this.IsNumber(t[i]))continue;a=0}e[i]=a,++a}return e},this.DEVSQ=function(t,e){if(this.IsNumber(t)&&this.IsNumber(e))return 0;var a=[];if(Array.isArray(t)){var i=null;if(Array.isArray(e)){for(var r=e.length-1;r>=0;--r)if(this.IsNumber(e[r])){i=parseInt(e[r]);break}}else i=parseInt(e);if(!this.IsNumber(i))return a;var n=t.length,o=(r=0,0),s=0,h=0,l=0;for(r=0;r<n&&!this.IsNumber(t[r]);++r)a[r]=null;if(i<1||r+i>n)return a;for(h=0;r<n&&o<i;++r,++o)h+=t[r]/i;if(o==i){for(l=0,r--;s<i;s++)l+=(t[r-s]-h)*(t[r-s]-h);a[r]=l,r++}for(;r<n;++r){for(h+=(t[r]-t[r-i])/i,l=0,s=0;s<i;++s)l+=(t[r-s]-h)*(t[r-s]-h);a[r]=l}}return a},this.NOT=function(t){var e="number"==typeof t;if(e)return t?0:1;var a=[];for(var i in t)a[i]=null,this.IsNumber(t[i])&&(a[i]=t[i]?0:1);return a},this.FORCAST=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n,o,s,h,l,u=0,C=0,D=0,f=0;for(h=0;h<r&&!this.IsNumber(t[h]);++h)a[h]=null;for(s=h+i-1;s<r;++s){for(u=C=D=f=0,h=0,l=i;h<i&&h<=s;++h,--l)u+=l,C+=t[s-h];for(u/=i,C/=i,h=0,l=i;h<i&&h<=s;++h,--l)D+=(l-u)*(t[s-h]-C),f+=(l-u)*(l-u);o=D/f,n=C-u*o,a[s]=o*i+n}return a},this.TSMA=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n,o,s,h,l,u=0,C=0,D=0,f=0;for(h=0;h<r&&!this.IsNumber(t[h]);++h)a[h]=null;for(s=h+i-1;s<r;++s){for(u=C=D=f=0,h=0,l=i;h<i&&h<=s;++h,--l)u+=l,C+=t[s-h];for(u/=i,C/=i,h=0,l=i;h<i&&h<=s;++h,--l)D+=(l-u)*(t[s-h]-C),f+=(l-u)*(l-u);o=D/f,n=C-u*o,a[s]=o*i+n+o}return a},this.SLOPE=function(t,e){var a=[];if("number"!=typeof e&&(e=parseInt(e)),e<1||!t.length)return a;if(e>=t.length)return a;for(var i,r,n,o,s=0,h=0;h<t.length;++h,++s)if(a[h]=null,this.IsNumber(t[h]))break;for(var l=s+e-1;l<t.length;++l){a[l]=null,i=r=n=o=0;for(var u=0;u<e&&u<=l;++u)i+=l-u,r+=t[l-u];for(i/=e,r/=e,u=0;u<e&&u<=l;++u)n+=(l-u-i)*(t[l-u]-r),o+=(l-u-i)*(l-u-i);o?a[l]=n/o:l&&(a[l]=a[l-1])}return a},this.STDP=function(t,e){var a=[];if(!Array.isArray(t))return a;var i=this.GetFirstVaildIndex(t);if(!sa.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,o=!0,s=0,h=0;for(r+=e-1;r<t.length;++r){if(s=0,o){for(o=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)s+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(s/e)}return a},this.VAR=function(t,e){if(this.IsNumber(t)&&this.IsNumber(e))return 0;var a=[];if(Array.isArray(t)&&this.IsNumber(e)){var i,r=parseInt(e),n=t.length;if(r<=0||r>=n)return a;for(s=0;s<n&&!this.IsNumber(t[s]);++s)a[s]=null;for(l=0,s=s+r-1;s<n;++s){for(h=i=0,l=0;l<r&&l<=s;++l)h+=t[s-l]*t[s-l],i+=t[s-l];a[s]=(r*h-i*i)/r*(r-1)}}else if(Array.isArray(t)&&Array.isArray(e))for(var o=this.GetFirstVaildIndex(t),s=o;s<t.length;++s){var h=i=0;if(this.IsNumber(e[s])){r=parseInt(e[s]);if(!(r<=0||s-(r-1)<0)){for(var l=0;l<r;++l)h+=t[s-l]*t[s-l],i+=t[s-l];a[s]=(r*h-i*i)/r*(r-1)}}}return a},this.VARP=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n=0,o=0;for(n=0;n<r&&!this.IsNumber(t[n]);++n)a[n]=null;for(var s=0,h=0;n<r&&o<i;++n,++o)s+=t[n]*t[n],h+=t[n];for(o==i&&(a[n-1]=(i*s-h*h)/(i*i));n<r;++n)s+=t[n]*t[n]-t[n-i]*t[n-i],h+=t[n]-t[n-i],a[n]=(i*s-h*h)/(i*i);return a},this.RANGE=function(t,e,a){var i="number"==typeof t,r="number"==typeof e,n="number"==typeof a;if(i&&r&&n)return t>Math.min(e,a)&&t<Math.max(e,a)?1:0;for(var o,s,h=[],l=0;l<t.length;++l)if(h[l]=null,o=t[l],this.IsNumber(o)){if(r)s=e;else{if(l>=e.length)continue;s=e[l]}if(this.IsNumber(s)){if(n)rangeValue2=a;else{if(l>=a.length)continue;rangeValue2=a[l]}this.IsNumber(rangeValue2)&&(h[l]=o>Math.min(s,rangeValue2)&&o<Math.max(s,rangeValue2)?1:0)}}return h},this.EXIST=function(t,e){if("number"==typeof t)return 0;if(Array.isArray(e)){var a=[];if(t.length<=0)return a;for(var i in t)a[i]=0;for(i=0;i<e.length&&i<t.length;++i){var r=e[i];if(this.IsNumber(r)&&(r=parseInt(r),!(r<=0))){r>i+1&&(r=i+1);for(var n=!1,o=0,s=0;s<r;++s)if(i-(r-s-1),o=t[i],this.IsNumber(o)&&o>0){n=!0;break}a[i]=n?1:0}}return a}e=parseInt(e);for(var h=null,l=(a=[],0);l<t.length;++l)a[l]=null,o=t[l],this.IsNumber(o)&&o>0&&(h=l),a[l]=null!=h&&l-h<e?1:0;return a},this.TFILTER=function(t,e,a){if(!this.IsNumber(a))return[];if(1==a)return this.And(t,this.EQ(this.COUNT(t,this.BARSLAST(e)),1));if(2==a)return this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1));if(0==a){for(var i=this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1)),r=this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1)),n=0;n<i.length;++n){var o=r[n];o>0&&(i[n]=2)}return i}return[]},this.FILTER=function(t,e){for(var a=[],i=0,r=0;i<t.length;++i)if(t[i]){for(a[i]=1,r=0;r<e&&r+i+1<t.length;++r)a[r+i+1]=0;i+=e}else a[i]=0;return a},this.FILTERX=function(t,e,a){for(var i=[],r=0,n=0;r<t.length;++r)if(t[r]){for(i[r]=1,n=0;n<e&&r-n-1>=0;++n)i[r-n-1]=0;r+=e}else i[r]=0;return i},this.BARSLAST=function(t){var e=[];if(!t)return e;for(var a=null,i=0;i<t.length;++i)e[i]=null,t[i]>0?a=0:null!=a&&++a,null!=a&&(e[i]=a);return e},this.BARSLASTS=function(t,e,a){var i=[];if(!t)return i;e<=0&&(e=t.length);for(var r=null,n=0,o=0,s=0;s<t.length;++s){i[s]=null;var h=t[s];h>0?(null==r?(r=0,++o):(++o,o>e&&(r-=n)),n=0):null!=r&&(++r,++n),null!=r&&(i[s]=r)}return i},this.BARSSINCEN=function(t,e){var a=[];if(this.IsNumber(e)&&Array.isArray(t)){var i=e;i<1&&(i=t.length);var r=this.GetFirstVaildIndex(t);if(r>=t.length)return a;var n=0;for(n=r<=i-1?i-1:r,a[n]=n-r;n<t.length;++n)if(this.IsNumber(a[n-1])){if(a[n-1]+1<i)a[n]=a[n-1]+1;else for(var o=n-i+1;o<=n;++o)if(!(Math.abs(t[o])<1e-6)){a[n]=n-o;break}}else Math.abs(t[n])<1e-6||(a[n]=0)}return a},this.BARSSINCE=function(t){for(var e=[],a=null,i=0;i<t.length;++i)e[i]=null,null==a?t[i]&&(a=0):++a,a&&(e[i]=a);return e},this.Trigonometric=function(t,e){if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=e(r):a[i]=null}return a}return this.IsNumber(t)?e(t):null},this.ASIN=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.asin(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.ACOS=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.acos(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.LAST=function(t,e,a){if(!Array.isArray(t))return[];for(var i=[],r=t.length,n=e,o=a,s=0,h=0,l=0,u=0;s<r;++s)if(t[s])break;for(h=s,u=s-o+1;h<r;++h,++u){for(l=0==n?s:Math.max(s,h-n);l<u;++l)if(t[l]<=0)break;i[h]=l<u?0:1}return i},this.ZIG=function(t,e){var a=this.SymbolData.Data;if("number"==typeof t)switch(t){case 0:t=a.GetOpen();break;case 1:t=a.GetHigh();break;case 2:t=a.GetLow();break;case 3:t=a.GetClose();break;default:return[]}return this.ZIG_Calculate(t,e)},this.GetFirstVaildIndex=function(t){for(var e=0;e<t.length;++e)if(this.IsNumber(t[e]))return e;return t.length},this.ZIG_Calculate=function(t,e){var a=[],i=t.length,r=this.GetFirstVaildIndex(t),n=0,o=0,s=0,h=0,l=0;for(n=r+1,o=s=r;n<i-1&&s==r;++n)s=100*Math.abs(t[n]-t[r])>=e*t[r]?t[n]>t[r]?n:-n:r;for(;n<i-1;++n)if(t[n]>=t[n-1]&&t[n]>=t[n+1])if(s<0){if(100*(t[n]-t[-s])<e*t[-s])continue;for(l=(t[o]-t[h=-s])/(-s-o),a[h--]=t[-s];h>=o;h--)a[h]=t[-s]+(-s-h)*l;o=-s,s=n}else t[n]>t[s]&&(s=n);else if(t[n]<=t[n-1]&&t[n]<=t[n+1])if(s>0){if(100*(t[s]-t[n])<e*t[s])continue;for(l=(t[s]-t[h=o])/(s-o),a[h++]=t[o];h<=s;++h)a[h]=t[o]+(h-o)*l;o=s,s=-n}else t[n]<t[-s]&&(s=-n);if(Math.abs(s)>=i-2&&(s>0&&t[i-1]>=t[s]&&(s=i-1),s<0&&t[i-1]<=t[-s]&&(s=1-i)),s>0)for(l=(t[s]-t[h=o])/(s-o),a[h++]=t[o];h<=s;++h)a[h]=t[o]+(h-o)*l;else for(l=(t[o]-t[h=-s])/(-s-o),a[h--]=t[-s];h>=o;h--)a[h]=t[-s]+(-s-h)*l;if((s=Math.abs(s))<i-1)if(t[i-1]>=t[s])for(l=(t[i-1]-t[h=s])/(i-s),a[h++]=t[s];h<i;++h)a[h]=t[s]+(h-s)*l;else for(l=(t[s]-t[h=i-1])/(i-s),a[h--]=t[i-1];h>=s;h--)a[h]=t[i-1]+(i-h)*l;return a},this.JSDraw=null,this.CalculateZIGLine=function(t,e,a,i,r){null==this.JSDraw&&(this.JSDraw=new un(this.ErrorHandler));var n=e.Up,o=t;if(n)for(var s=t.ID+1;s<a.ID;++s){var h=i[s];this.IsNumber(h)&&(o.Value<h&&(o={ID:s,Value:h}))}else for(s=t.ID+1;s<a.ID;++s){h=i[s];this.IsNumber(h)&&(o.Value>h&&(o={ID:s,Value:h}))}e.Value=o.Value,e.ID=o.ID;var l={Start:{ID:t.ID,Value:t.Value},End:{ID:e.ID,Value:e.Value}},u=this.JSDraw.CalculateDrawLine(l);for(var s in u){var C=u[s];r[C.ID]=C.Value}if(a.ID==i.length-1)for(var s in l={Start:{ID:e.ID,Value:e.Value},End:{ID:a.ID,Value:a.Value}},u=this.JSDraw.CalculateDrawLine(l),u){C=u[s];r[C.ID]=C.Value}else t.ID=e.ID,t.Value=e.Value,e.ID=a.ID,e.Value=a.Value,e.Up=t.Value<e.Value},this.TROUGHBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var o=i.length,s=[],h=0;h<n;++h)s[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<o&&i[h]>i[h-1];++h);for(;h<o&&i[h]<i[h-1];++h);for(s[0]=--h;h<o-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=s.slice(0),C=0;C<n;++C)s[C+1]=u[C];s[l=0]=h}}else l=1;s[n]&&(r[h]=h-s[n])}return s[n]&&(r[h]=h-s[n]),r},this.TROUGH=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var o=i.length,s=[],h=0;h<n;++h)s[h]=0;h=1;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<o&&i[h]>i[h-1];++h);for(;h<o&&i[h]<i[h-1];++h);for(s[0]=--h;h<o-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=s.slice(0),C=0;C<n;++C)s[C+1]=u[C];s[l=0]=h}}else l=1;s[n]&&(r[h]=i[s[n]])}return s[n]&&(r[h]=i[s[n]]),r},this.PEAKBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,o=a;if(o<1)return r;for(var s=[],h=0;h<o;++h)s[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(o--;h<n&&i[h]<i[h-1];++h);for(;h<n&&i[h]>i[h-1];++h);for(s[0]=--h;h<n-1;++h){if(i[h]>i[h+1]){if(l){if(o)for(var u=s.slice(0),C=0;C<o;++C)s[C+1]=u[C];s[l=0]=h}}else l=1;s[o]&&(r[h]=h-s[o])}return s[o]&&(r[h]=h-s[o]),r},this.PEAK=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,o=a;if(o<1)return r;for(var s=0,h=[],l=0;l<o;++l)h[l]=0;l=this.GetFirstVaildIndex(i)+1;for(o--;l<n&&i[l]<i[l-1];++l);for(;l<n&&i[l]>i[l-1];++l);for(h[0]=--l;l<n-1;++l){if(i[l]>i[l+1]){if(s){if(o)for(var u=h.slice(0),C=0;C<o;++C)h[C+1]=u[C];h[s=0]=l}}else s=1;h[o]&&(r[l]=i[h[o]])}return h[o]&&(r[l]=i[h[o]]),r},this.EVERY=function(t,e){var a=[];if(e<1)return a;if(sa.IsNumber(e)){e=parseInt(e);for(var i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i]))break;for(var r=0;i<t.length;++i)t[i]?r+=1:r=0,r==e?(a[i]=1,--r):a[i]=0}else if(Array.isArray(e))for(i=0;i<e.length;++i){var n=e[i];if(a[i]=null,sa.IsPlusNumber(n)){n=parseInt(n);r=0;for(var o=i,s=0;o>=0&&s<n;--o,++s)t[o]&&++r;a[i]=r==n?1:0}}return a},this.COST=function(t,e){var a=[],i=t/100;if(i<1e-6||i>1)return a;var r=this.SymbolData.Data.Data;if(!r||r.length<=0)return a;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),o=r[0].High,s=r[0].Low,h=0;h<r.length;++h){var l=r[h];s=Math.min(s,l.Low),o=Math.max(o,l.High)}(s>2e3||s<0||o>2e3||s<0)&&this.ThrowUnexpectedNode(e,"COST() 历史K线最大最小值错误, 超出(0,1000)范围");var u=parseInt(100*o+1),C=parseInt(100*s-1),D=0,f=0,c=0;o=u/100,s=C/100;var m=u-C+1;if(m<1)return a;var d=[],I=[];for(h=0;h<m;++h)d[h]=0,I[h]=0;var S=0,T=0,v=0,p=0;for(h=0;h<r.length;++h)if(!(h>=n.length)){if(n[h]>1){var g=r[h];S=g.Vol/n[h];for(var x=0;x<m;x++)d[x]*=1-S;D=parseInt(Math.min(u,Math.max(C,100*g.Low)))-C,f=parseInt(Math.min(u,Math.max(C,100*g.High)))-C,c=parseInt(Math.min(u,Math.max(C,100*g.Close)))-C;for(x=0;x<m;++x)I[x]=0;var F=parseInt((D+f+2*c)/4);if(F==f||F==D)I[F]+=g.Vol;else{for(var E=g.Vol/(F-D),L=D;L<F;++L)I[L]+=E/(F-D)*(L-D);for(L;L<=f;++L)I[L]+=E/(F-f)*(L-f)}for(T=0,x=D;x<=f;x++)d[x]+=I[x];for(x=0;x<m;x++)T+=d[x];for(x=0,p=v=0;x<m;++x)if(v+=d[x],v>=T*i){p=(o-s)*x/m+s;break}}a[h]=p}return a},this.WINNER=function(t,e){var a=[],i=this.SymbolData.Data.Data;if(!i||i.length<=0)return a;for(var r=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),n=i[0].High,o=i[0].Low,s=0;s<i.length;++s){var h=i[s];o=Math.min(o,h.Low),n=Math.max(n,h.High)}(o>5e3||o<0||n>5e3||o<0)&&this.ThrowUnexpectedNode(e,"WINNER() 历史K线最大最小值错误, 超出(0,5000)范围");var l=parseInt(100*n+1),u=parseInt(100*o-1),C=0,D=0,f=0;n=l/100,o=u/100;var c=l-u+1;if(c<1)return a;var m=[],d=[];for(s=0;s<c;++s)m[s]=0,d[s]=0;var I=0,S=0,T=0;for(s=0;s<i.length;++s)if(!(s>=r.length)&&r[s]>1){var v=i[s];I=v.Vol/r[s];for(var p=0;p<c;p++)m[p]*=1-I;C=parseInt(Math.min(l,Math.max(u,100*v.Low)))-u,D=parseInt(Math.min(l,Math.max(u,100*v.High)))-u,f=parseInt(Math.min(l,Math.max(u,100*v.Close)))-u;for(p=0;p<c;++p)d[p]=0;var g=parseInt((C+D+2*f)/4);if(g==D||g==C)d[g]+=v.Vol;else{for(var x=v.Vol/(g-C),F=C;F<g;++F)d[F]+=x/(g-C)*(F-C);for(F;F<=D;++F)d[F]+=x/(g-D)*(F-D)}for(S=0,p=C;p<=D;p++)m[p]+=d[p];for(p=0;p<c;p++)S+=m[p];D=Array.isArray(t)?parseInt(Math.min(100*t[s]-u,c-1)):parseInt(Math.min(100*t-u,c-1));for(p=0,T=0;p<=D;p++)T+=m[p];S>0?a[s]=T/S:s-1>=0&&(a[s]=a[s-1])}return a},this.COSTEX=function(t,e,a){var i=[],r=this.SymbolData.Data.Data;if(!r||r.length<=0)return i;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:a}),o=r[0].High,s=r[0].Low,h=0;h<r.length;++h){var l=r[h];s=Math.min(s,l.Low),o=Math.max(o,l.High)}(s>5e3||s<0||o>5e3||s<0)&&this.ThrowUnexpectedNode(a,"COSTEX() 历史K线最大最小值错误, 超出(0,5000)范围");var u=parseInt(100*o+1),C=parseInt(100*s-1),D=0,f=0,c=0;o=u/100,s=C/100;var m=u-C+1;if(m<1)return i;var d=[],I=[];for(h=0;h<m;++h)d[h]=0,I[h]=0;for(var S=0,T=0,v=0,p=0,g=0,x=0,F=(h=0,0);h<r.length;++h)if(!(h>=n.length)&&n[h]>1){var E=r[h];S=E.Vol/n[h];for(F=0;F<m;F++)d[F]*=1-S;D=parseInt(Math.min(u,Math.max(C,100*E.Low)))-C,f=parseInt(Math.min(u,Math.max(C,100*E.High)))-C,c=parseInt(Math.min(u,Math.max(C,100*E.Close)))-C;for(F=0;F<m;++F)I[F]=0;var L=parseInt((D+f+2*c)/4);if(L==f||L==D)I[L]+=E.Vol;else{for(var M=E.Vol/(L-D),y=D;y<L;++y)I[y]+=M/(L-D)*(y-D);for(y;y<=f;++y)I[y]+=M/(L-f)*(y-f)}0;for(F=D;F<=f;F++)d[F]+=I[F];for(F=0;F<m;F++)d[F];for(f=Array.isArray(t)?parseInt(Math.min(100*t[h]-C,m-1)):parseInt(Math.min(100*t-C,m-1)),F=0,v=0,p=0;F<=f;F++)v+=d[F],p+=.01*(F+C)*d[F];for(f=Array.isArray(e)?parseInt(Math.min(100*e[h]-C,m-1)):parseInt(Math.min(100*e-C,m-1)),F=0,g=0,x=0;F<=f;F++)g+=d[F],x+=.01*(F+C)*d[F];T=v-g,dPerVolRange=p-x,Math.abs(dPerVolRange)>.001&&0!=T?i[h]=dPerVolRange/T:h-1>=0&&(i[h]=i[h-1])}return i},this.PPART=function(t,e){var a=[],i=t;if(i<0)return a;var r=this.SymbolData.Data.Data;if(!r||r.length<=0)return a;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),o=i,s=0;o<r.length;++o){var h=o-i;if(!(h<0)){var l=0;for(s=0;s<i;++s){var u=r[s+h];l+=u.Vol}if(o<n.length&&n[o]>0){var C=1-l/n[o];a[o]=C}}}return a},this.LWINNER=function(t,e,a){var i=t;i<=0&&this.ThrowUnexpectedNode(a,"LWINNER() 第1个参数错误");var r=[],n=this.SymbolData.Data.Data;if(!n||n.length<=0)return r;for(var o=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:a}),s=0,h=0,l=i-1,u=0,C=0;l<n.length;++l){var D=l-i+1,f=n[D].High,c=n[D].Low;for(u=0;u<i;++u){var m=n[D+u];c=Math.min(c,m.Low),f=Math.max(f,m.High)}(c>5e3||c<0||f>5e3||c<0)&&this.ThrowUnexpectedNode(a,"LWINNER() 历史K线最大最小值错误, 超出(0,5000)范围");var d=parseInt(100*f+1),I=parseInt(100*c-1),S=0,T=0,v=0;f=d/100,c=I/100;var p=d-I+1;if(p<1)return r;var g=[],x=[];for(u=0;u<p;++u)g[u]=0,x[u]=0;for(u=0;u<i;++u){var F=o[D+u];if(!(F<1)){var E=n[D+u],L=E.Vol/F;for(C=0;C<p;C++)g[C]*=1-L;S=parseInt(Math.min(d,Math.max(I,100*E.Low)))-I,T=parseInt(Math.min(d,Math.max(I,100*E.High)))-I,v=parseInt(Math.min(d,Math.max(I,100*E.Close)))-I;for(C=0;C<p;++C)x[C]=0;var M=parseInt((S+T+2*v)/4);if(M==T||M==S)x[M]+=E.Vol;else{for(var y,R=E.Vol/(M-S),N=S;N<M;++N)x[N]+=R/(M-S)*(N-S);for(;y<=T;++y)x[y]+=R/(M-T)*(y-T)}s=0;for(C=S;C<=T;C++)g[C]+=x[C]}}for(u=0;u<p;u++)s+=g[u];for(T=Array.isArray(e)?parseInt(Math.min(100*e[l]-I,p-1)):parseInt(Math.min(100*e-I,p-1)),h=0,C=0;C<=T;C++)h+=g[C];s>0&&h>0&&h<=s?r[l]=h/s:l-1>=0&&(r[l]=r[l-1])}return r},this.PWINNER=function(t,e,a){return[]},this.CalculateChip=function(t,e,a,i){for(var r={Min:null,Max:null,Data:[]},n=1,o=null,s=null,h=t;h>=0;--h){var l={},u=a[h];l.Vol=h==t?u.Vol*e[h]:u.Vol*n,l.Date=u.Date,l.High=u.High,l.Low=u.Low,(null==o||o<l.High)&&(o=l.High),(null==s||s<l.Low)&&(s=l.Low),r.Data[h]=l,n*=1-e[h]/100*i}return r.Max=o,r.Min=s,r},this.UPNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]>t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.DOWNNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]<t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.NDAY=function(t,e,a){var i=[];if(a<1)return i;if(!Array.isArray(t)&&!Array.isArray(e))return i;if(null==t||null==e)return i;if(Array.isArray(t)&&Array.isArray(e)){if(a>=t.length||a>=e.length)return i;for(var r=Math.max(t.length,e.length),n=0,o=0;o<r;++o)i[o]=0,o>=t.length||o>=e.length||(this.IsNumber(t[o])&&this.IsNumber(e[o])?(t[o]>e[o]?++n:n=0,n==a&&(i[o]=1,--n)):n=0)}else if(Array.isArray(t)&&!Array.isArray(e)){if(a>=t.length||!this.IsNumber(e))return;n=0;for(var s in t)i[s]=0,this.IsNumber(t[s])?(t[s]>e?++n:n=0,n==a&&(i[s]=1,--n)):n=0}else if(!Array.isArray(t)&&Array.isArray(e)){if(a>=e.length||!this.IsNumber(t))return;n=0;for(var h in e)i[h]=0,this.IsNumber(e[h])?(t>e[h]?++n:n=0,n==a&&(i[h]=1,--n)):n=0}return i},this.LONGCROSS=function(t,e,a){for(var i=[],r=Math.max(t.length,e.length),n=0;n<r;++n)i[n]=0,n-1<0||n>=t.length||n>=e.length||this.IsNumber(t[n])&&this.IsNumber(e[n])&&this.IsNumber(t[n-1])&&this.IsNumber(e[n-1])&&t[n]>e[n]&&t[n-1]<e[n-1]&&(i[n]=1);for(var o=0,s=0;o<r;++o)if(i[o])for(s=1;s<=a&&o-s>=0;++s)if(t[o-s]>=e[o-s]){i[o]=0;break}return i},this.ISVALID=function(t){if(Array.isArray(t)){for(var e=[],a=0;a<t.length;++a){var i=t[a];e[a]=i?1:0}return e}return t?1:0},this.EXISTR=function(t,e,a){var i=[];if(!Array.isArray(t))return i;if(e=parseInt(e),a=parseInt(a),e<=0&&(e=t.length),a<=0&&(a=1),a>e)return i;i=[];for(var r=0,n=0;r<t.length;++r)if(i[r]=null,!(r-e<0||r-a<0))for(i[r]=0,n=e;n>=a;--n){var o=t[r-n];if(this.IsNumber(o)&&o){i[r]=1;break}}return i},this.RELATE=function(t,e,a){var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),o=Math.max(t.length,e.length),s=0,h=0;s<o;++s)if(i[s]=null,!(s>=t.length||s>=e.length||s>=r.length||s>=n.length)){var l=r[s],u=n[s],C=0,D=0,f=0;for(h=s-a+1;h<=s;++h)C+=(t[h]-l)*(e[h]-u),D+=Math.pow(t[h]-l,2),f+=Math.pow(e[h]-u,2);i[s]=C/a/(Math.sqrt(D/a)*Math.sqrt(f/a))}return i},this.CalculateAverage=function(t,e){var a=[];if(e<1)return a;for(var i=0,r=0;r<t.length;++r)if(this.IsNumber(t[r]))break;for(;r<t.length&&r<e;++r){a[r]=null;var n=t[r];this.IsNumber(n)&&(i+=n)}for(a[r-1]=i/e;r<t.length;++r){n=t[r];var o=t[r-e];this.IsNumber(n)||(n=0),this.IsNumber(o)||(o=0),i=i-o+n,a[r]=i/e}return a},this.COVAR=function(t,e,a){if(this.IsNumber(t)||this.IsNumber(e))return 0;var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),o=Math.max(t.length,e.length),s=(o=Math.max(t.length,e.length),0),h=0;s<o;++s)if(i[s]=null,!(s>=t.length||s>=e.length||s>=r.length||s>=n.length)){var l=r[s],u=n[s],C=0;for(h=s-a+1;h<=s;++h)C+=(t[h]-l)*(e[h]-u);i[s]=C/a}return i},this.HHVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var o=null,s=n;s<t.length;++s)if(this.IsNumber(t[s])){o=s;break}for(var h=0;s<t.length&&h<r;++h,++s)t[s]>=t[o]&&(o=s);null!=o&&(a[i]=i-o)}}else{e<1&&(e=t.length);for(o=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){o=i;break}s=0;for(i=o+1;i<t.length&&s<e;++i,++s)t[i]>=t[o]&&(o=i),e==t.length&&(a[i]=i-o);for(;i<t.length;++i){if(i-o<e)t[i]>=t[o]&&(o=i);else for(o=i-e+1,s=o;s<=i;++s)t[s]>=t[o]&&(o=s);a[i]=i-o}}return a},this.LLVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var o=null,s=n;s<t.length;++s)if(this.IsNumber(t[s])){o=s;break}for(var h=0;s<t.length&&h<r;++h,++s)t[s]<=t[o]&&(o=s);null!=o&&(a[i]=i-o)}}else{e<1&&(e=t.length);for(o=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){o=i;break}s=0;for(i=o+1;i<t.length&&s<e;++i,++s)t[i]<=t[o]&&(o=i),e==t.length&&(a[i]=i-o);for(;i<t.length;++i){if(i-o<e)t[i]<=t[o]&&(o=i);else for(o=i-e+1,s=o;s<=i;++s)t[s]<=t[o]&&(o=s);a[i]=i-o}}return a},this.BETA=function(t){var e=[],a=this.SymbolData.Data,i=this.SymbolData.IndexData;t<=0&&(t=1);for(var r=[],n=[],o=0;o<a.Data.length;++o){r[o]=0,n[o]=0;var s=a.Data[o],h=i.Data[o];s.Close>0&&s.YClose>0&&(r[o]=(s.Close-s.YClose)/s.YClose),h.Close>0&&h.YClose>0&&(n[o]=(h.Close-h.YClose)/h.YClose)}for(var l=this.CalculateAverage(r,t),u=this.CalculateAverage(n,t),C=0,D=0;C<a.Data.length;++C)if(e[C]=null,!(C>=r.length||C>=n.length||C>=l.length||C>=u.length)){var f=l[C],c=u[C],m=0,d=0;for(D=C-t+1;D<=C;++D){var I=n[D]-c,S=r[D]-f;m+=I*S,d+=I*I}this.IsDivideNumber(d)&&this.IsNumber(m)&&(e[C]=m/d)}return e},this.BETA2=function(t,e,a){var i=[];a<=0&&(a=1);for(var r=[null],n=[null],o=Math.max(t.length,e.length),s={X:t[0],Y:e[0]},h=1;h<o;++h){r[h]=0,n[h]=0;var l=t[h],u=e[h];s.X>0&&(r[h]=(l-s.X)/s.X),s.Y>0&&(n[h]=(u-s.Y)/s.Y),s={X:l,Y:u}}for(var C=this.CalculateAverage(r,a),D=this.CalculateAverage(n,a),f=(h=0,0);h<o;++h)if(i[h]=null,!(h>=r.length||h>=n.length||h>=C.length||h>=D.length)){var c=C[h],m=D[h],d=0,I=0;for(f=h-a+1;f<=h;++f){var S=r[f]-c,T=n[f]-m;d+=S*T,I+=S*S}this.IsDivideNumber(I)&&this.IsNumber(d)&&(i[h]=d/I)}return i},this.SAR=function(t,e,a){var i=[],r=this.SymbolData.Data;if(t>=r.Data.length)return i;for(var n=null,o=null,s=0;s<t;++s){var h=r.Data[s];(null==n||n<h.High)&&(n=h.High),(null==o||o>h.Low)&&(o=h.Low)}var l=0;i[t-1]=o;var u=o,C=r.Data[0].High,D=e/100;for(s=t;s<r.Data.length;++s){var f=C,c=(h=r.Data[s],r.Data[s-1]);0==l?h.Low<i[s-1]?(l=1,C=h.Low,D=e/100,u=Math.max(h.High,c.High),u=Math.max(u,f+D*(C-f))):(l=0,h.High>f&&(C=h.High,D=Math.min(D+e/100,a/100)),u=Math.min(h.Low,c.Low),u=Math.min(u,i[s-1]+D*(C-i[s-1]))):1==l&&(h.High>i[s-1]?(l=0,C=h.High,D=e/100,u=Math.min(h.Low,c.Low),u=Math.min(u,i[s-1]+D*(C-f))):(l=1,h.Low<f&&(C=h.Low,D=Math.min(D+e/100,a/100)),u=Math.max(h.High,c.High),u=Math.max(u,i[s-1]+D*(C-i[s-1])))),i[s]=u}return i},this.SARTURN=function(t,e,a){var i=[],r=this.SAR(t,e,a),n=this.SymbolData.Data,o=0;for(o=0;o<r.length;++o)if(this.IsNumber(r[o]))break;var s=0;o<n.Data.length&&(s=n.Data[o].Close>r[o]);for(var h=o+1;h<n.Data.length;++h){var l=n.Data[h];l.Close<r[h]&&s?i[h]=-1:i[h]=l.Close>r[h]&&!s?1:0,s=l.Close>r[h]}return i},this.BACKSET=function(t,e){var a=[];if(!t)return a;var i=t.length;if(!this.IsNumber(i)||i<=0)return a;if(Array.isArray(e)){for(var r=0;r<i;++r)a[r]=0;for(r=0;r<i;++r){var n=t[r],o=e[r];if(this.IsNumber(n)&&n&&this.IsNumber(o))for(var s=r,h=0;s>=0&&h<o;--s,++h)a[s]=1}}else{for(r=0;r<i;++r)a[r]=0;for(var l=0;l<i;++l)if(this.IsNumber(t[l]))break;if(l==i)return a;var u=Math.min(i-l,Math.max(e,1));for(r=i-1,s=0;r>=0;--r){n=t[r];if(this.IsNumber(n)&&n)for(s=r;s>r-u;--s)a[s]=1}if(t[r])for(s=r;s>=l;--s)a[s]=1}return a},this.BETWEEN=function(t,e,a){var i=[],r="number"==typeof t,n="number"==typeof e,o="number"==typeof a;if(r&&n&&o)return t>=e&&t<=a?1:0;for(var s in t){i[s]=0;var h=t[s],l=null,u=null;n?l=e:s<e.length-1&&(l=e[s]),o?u=a:s<a.length-1&&(u=a[s]),null!=l&&null!=u&&(l>u?h>=u&&h<=l&&(i[s]=1):h<=u&&h>=l&&(i[s]=1))}return i},this.STRCAT=function(t,e){var a=[];return sa.IsString(t)&&sa.IsString(e)&&(a=t+e),a},this.VARCAT=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=Math.max(t.length,e.length),r="",n=0;n<i;++n){if(a[n]=null,r="",n<t.length){var o=t[n];sa.IsString(o)&&(r+=o)}if(n<e.length){o=e[n];sa.IsString(o)&&(r+=o)}""!=r&&(a[n]=r)}else if(sa.IsString(t)&&Array.isArray(e))for(n=0;n<e.length;++n){a[n]=null;o=e[n];sa.IsString(o)&&(a[n]=t+o)}else if(Array.isArray(t)&&sa.IsString(e))for(n=0;n<t.length;++n){a[n]=null;o=t[n];sa.IsString(o)&&(a[n]=o+e)}else sa.IsString(t)&&sa.IsString(e)&&(a=t+e);return a},this.FINDSTR=function(t,e){var a,i,r=[];if(a=sa.IsNumber(t)?t.toString():t,i=sa.IsNumber(e)?e.toString():e,sa.IsString(a)&&sa.IsString(i))return a.indexOf(i)>=0?1:0;if(Array.isArray(t)&&sa.IsString(i))for(var n=0;n<t.length;++n){var o=t[n];sa.IsString(o)?r[n]=o.indexOf(i)>=0?1:0:sa.IsNumber(o)?(a=o.toString(),r[n]=a.indexOf(i)>=0?1:0):r[n]=0}return r},this.STRLEN=function(t){if(sa.IsString(t))return t.length;if(Array.isArray(t)){for(var e=[],a=0;a<t.length;++a){var i=t[a];sa.IsString(i)?e[a]=i.length:e[a]=null}return e}return null},this.STRCMP=function(t,e){return sa.IsString(t)&&sa.IsString(e)?t==e?1:0:null},this.STRSPACE=function(t){var e=[];if(Array.isArray(t))for(var a=0;a<t.length;++a){e[a]=null;var i=t[a];sa.IsString(i)&&(e[a]=i+" ")}else sa.IsString(t)&&(e=t+" ");return e},this.CON2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=t.length-1;i>=0;--i){var r=t[i];if(this.IsNumber(r))return a=r.toFixed(e),a}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.VAR2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=0;i<t.length;++i){a[i]=null;var r=t[i];this.IsNumber(r)&&(a[i]=r.toFixed(e))}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.MOD=function(t,e){var a=[],i="number"==typeof t,r="number"==typeof e;if(i&&r)return ln.MOD(t,e);if(!i&&!r){for(var n=Math.max(t.length,e.length),o=0;o<n;++o)a[o]=null,o<t.length&&o<e.length&&this.IsNumber(t[o])&&this.IsNumber(e[o])&&(a[o]=ln.MOD(t[o],e[o]));return a}if(i&&!r){for(var s in e)a[s]=null,this.IsNumber(t)&&this.IsNumber(e[s])&&(a[s]=ln.MOD(t,e[s]));return a}if(!i&&r){for(var s in t)a[s]=null,this.IsNumber(t[s])&&this.IsNumber(e)&&(a[s]=ln.MOD(t[s],e));return a}return a},this.POW=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=0;i<t.length;++i){var r=t[i],n=e[i];this.IsNumber(r)&&this.IsNumber(n)?a[i]=Math.pow(r,n):a[i]=null}else if(sa.IsNumber(t)&&Array.isArray(e))for(i=0;i<e.length;++i){var o=e[i];this.IsNumber(o)?a[i]=Math.pow(t,o):a[i]=null}else{if(sa.IsNumber(t)&&sa.IsNumber(e))return Math.pow(t,e);if(Array.isArray(t)&&sa.IsNumber(e))for(i=0;i<t.length;++i){o=t[i];this.IsNumber(o)?a[i]=Math.pow(o,e):a[i]=null}}return a},this.CEILING=function(t){var e="number"==typeof t;if(e)return parseInt(t);var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=parseInt(r):a[i]=null}return a},this.FLOOR=function(t){var e="number"==typeof t;if(e)return parseInt(t-1);var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=parseInt(r-1):a[i]=null}return a},this.ZTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1+e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1+e)*t;return a}},this.DTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1-e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1-e)*t;return a}},this.FRACPART=function(t){if(Array.isArray(t)){var e=[],a=0;for(var i in t){var r=t[i];this.IsNumber(r)?(a=parseInt(r),e[i]=r-a):e[i]=null}return e}if(this.IsNumber(t)){a=parseInt(t);e=t-a;return e}},this.SIGN=function(t){if(Array.isArray(t)){for(var e=[],a=0;a<t.length;++a){var i=t[a];e[a]=null,sa.IsNumber(i)&&(e[a]=i>0?1:0==i?0:-1)}return e}return t>0?1:0==t?0:-1},this.BARSLASTCOUNT=function(t){var e=null;if(Array.isArray(t)){if(e=[],t.length>0)for(var a=0,i=t.length-1;i>=0;--i){a=0;for(var r=i;r>=0;--r){if(!t[r])break;++a}e[i]=a}}else e=t?1:0;return e},this.INTPART=function(t){var e=null;if(Array.isArray(t))for(var a in e=[],t){var i=t[a];this.IsNumber(i)?e[a]=parseInt(i):e[a]=null}else this.IsNumber(t)&&(e=parseInt(t));return e},this.CONST=function(t){if(Array.isArray(t)){var e=t.length;return e>0?t[e-1]:null}return t},this.TOPRANGE=function(t){if(this.IsNumber(t))return 0;var e=[];if(Array.isArray(t))for(var a=t.length,i=a-1;i>=0;--i){e[i]=0;var r=t[i];if(this.IsNumber(r)){for(var n=0,o=i-1;o>=0;--o){if(t[o]>r)break;++n}e[i]=n}}return e},this.LOWRANGE=function(t){if(this.IsNumber(t))return 0;var e=[];if(Array.isArray(t))for(var a=t.length,i=a-1;i>=0;--i){e[i]=0;var r=t[i];if(this.IsNumber(r)){for(var n=0,o=i-1;o>=0;--o){if(t[o]<r)break;++n}e[i]=n}}return e},this.FINDLOW=function(t,e,a,i){if(this.IsNumber(t))return t;var r=[];if(Array.isArray(t))for(var n=t.length,o=n-1;o>=0;--o){r[o]=null;for(var s=[],h=e;h<a;++h){var l=o-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&s.push(u)}if(s.length>0){s.sort((function(t,e){return t-e}));l=i-1;l<0?l=0:l>=s.length&&(l=s.length-1),r[o]=s[l]}}return r},this.FINDHIGH=function(t,e,a,i){if(this.IsNumber(t))return t;var r=[];if(Array.isArray(t))for(var n=t.length,o=n-1;o>=0;--o){r[o]=null;for(var s=[],h=e;h<a;++h){var l=o-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&s.push(u)}if(s.length>0){s.sort((function(t,e){return e-t}));l=i-1;l<0?l=0:l>=s.length&&(l=s.length-1),r[o]=s[l]}}return r},this.FINDHIGHBARS=function(t,e,a,i){if(this.IsNumber(t))return a-e-i;var r=[];if(Array.isArray(t))for(var n=t.length,o=n-1;o>=0;--o){r[o]=null;for(var s=[],h=e;h<a;++h){var l=o-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&s.push({Value:u,Period:h})}if(s.length>0){s.sort((function(t,e){return e.Value-t.Value}));l=i-1;l<0?l=0:l>=s.length&&(l=s.length-1),r[o]=s[l].Period}}return r},this.FINDLOWBARS=function(t,e,a,i){if(this.IsNumber(t))return a-e-i;var r=[];if(Array.isArray(t))for(var n=t.length,o=n-1;o>=0;--o){r[o]=null;for(var s=[],h=e;h<a;++h){var l=o-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&s.push({Value:u,Period:h})}if(s.length>0){s.sort((function(t,e){return t.Value-e.Value}));l=i-1;l<0?l=0:l>=s.length&&(l=s.length-1),r[o]=s[l].Period}}return r},this.HOD=function(t,e){var a=[];if(sa.IsNumber(t))return 1;if(Array.isArray(t))for(var i=t.length,r=i-1;r>=0;--r){var n=t[r];if(sa.IsNumber(n)){if(Array.isArray(e))var o=parseInt(e[r]);else o=parseInt(e);e<=0&&(o=r);for(var s=1,h=r-1,l=1;h>=0&&l<o;--h,++l){var u=t[h];sa.IsNumber(u)&&u>n&&++s}a[r]=s}}return a},this.LOD=function(t,e){var a=[];if(sa.IsNumber(t))return 1;if(Array.isArray(t))for(var i=t.length,r=i-1;r>=0;--r){var n=t[r];if(sa.IsNumber(n)){if(Array.isArray(e))var o=parseInt(e[r]);else o=parseInt(e);e<=0&&(o=r);for(var s=1,h=r-1,l=1;h>=0&&l<o;--h,++l){var u=t[h];sa.IsNumber(u)&&u<n&&++s}a[r]=s}}return a},this.BARSNEXT=function(t){if(!Array.isArray(t))return 0;for(var e=[],a=0;a<t.length;++a){e[a]=0;for(var i=a,r=0;i<t.length;++i,++r){var n=t[i];if(n>0){e[a]=r;break}}}return e},this.RAND=function(t){if(Array.isArray(t)){var e=[];for(var a in t){e[a]=null;var i=t[a],r=parseInt(i);r<=0||(e[a]=Math.ceil(Math.random()*r))}return e}r=parseInt(t);if(r<=0)return null;var n=this.SymbolData.Data,o=n.Data.length;for(e=[],a=0;a<o;++a)e[a]=Math.ceil(Math.random()*r);return e},this.AMA=function(t,e){var a,i=[];if(Array.isArray(e)){for(var r=t.length-1;r>=0;--r)if(this.IsNumber(e[r])){a=e[r];break}}else a=e;if(this.IsNumber(a)){if(a>1)return i;var n=0,o=0;for(n;n<t.length;++n)if(i[n]=null,this.IsNumber(t[n])){o=t[n],i[n]=o;break}for(r=n+1;r<t.length;++r){var s=t[r];i[r]=i[r-1]+a*(s-i[r-1])}}return i},this.TMA=function(t,e,a){var i=[];if(this.IsNumber(e)&&e<=1&&this.IsNumber(a)&&a<1){var r=!1;for(var n in t)if(i[n]=null,0==r){var o=t[n];this.IsNumber(o)&&(i[n]=o,i[n],r=!0)}else{o=t[n];if(!this.IsNumber(o))continue;i[n]=e*i[n-1]+a*o,i[n]}}return i},this.ROUND=function(t){if(this.IsNumber(t))return Math.round(t);var e=[];if(Array.isArray(t))for(var a in t){var i=t[a];this.IsNumber(i)?e[a]=Math.round(i):e[a]=null}return e},this.ROUND2=function(t,e){var a=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12],i=0;if(this.IsNumber(e)&&(i=parseInt(e)),e<0?i=0:e>=a.length&&(i=a.length-1),this.IsNumber(t))return Math.round(t*a[i])/a[i];var r=[];if(Array.isArray(t))for(var n in t){var o=t[n];this.IsNumber(o)?r[n]=Math.round(o*a[i])/a[i]:r[n]=null}return r},this.TRMA=function(t,e){if(!this.IsNumber(e)||e<=0)return[];e=parseInt(e);var a=0,i=0;e%2==0?(a=parseInt(e/2),i=a+1):(a=parseInt((e+1)/2),i=a);var r=this.MA(t,a),n=this.MA(r,i);return n},this.VALUEWHEN=function(t,e){if(Array.isArray(t)){var a=[];if(Array.isArray(e)){var i=null;for(var r in t)if(r>=e.length)a[r]=i;else{var n=e[r];t[r]?(a[r]=n,i=n):a[r]=i}}else{i=null;for(var r in t)t[r]?(a[r]=e,i=e):a[r]=i}return a}return t?1:0},this.HARMEAN=function(t,e){var a=[];if(Array.isArray(t))if(Array.isArray(e))for(var i=0;i<t.length;++i)if(i>=e.length)a[i]=null;else{var r=parseInt(e[i]);if(r<=0||r>i)a[i]=null;else{for(var n=0,o=0;o<r;++o){var s=t[i-o];if(!this.IsNumber(s)||0==s){n=null;break}n+=1/s}a[i]=null==n?null:1/(n/r)}}else if(this.IsNumber(e)){if(e=parseInt(e),e<=0)return a;for(i=0;i<t.length;++i)if(e>i)a[i]=null;else{for(n=0,o=0;o<e;++o){s=t[i-o];if(!this.IsNumber(s)||0==s){n=null;break}n+=1/s}a[i]=null==n?null:1/(n/e)}}return a},this.DATETODAY=function(t){var e=[],a=new Date("1990-12-19");if(Array.isArray(t))for(var i in t){e[i]=null;var r=t[i];if(this.IsNumber(r)){var n=r+19e6;if(!(n<19901219)){var o=parseInt(n/1e4),s=parseInt(n%1e4/100),h=parseInt(n%100),l=new Date("".concat(o,"-").concat(s,"-").concat(h));e[i]=Math.round((l-a)/864e5)}}}else if(this.IsNumber(t)){n=t+19e6;if(n>=19901219){o=parseInt(n/1e4),s=parseInt(n%1e4/100),h=parseInt(n%100),l=new Date("".concat(o,"-").concat(s,"-").concat(h));return Math.round((l-l)/864e5)}}return e},this.DAYTODATE=function(t){var e=new Date("1990-12-19"),a=[];if(Array.isArray(t))for(var i in t){a[i]=null;var r=t[i];if(this.IsNumber(r)){e.setDate(e.getDate()+r);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();n-=19e6,a[i]=n,e.setDate(e.getDate()-r)}}else if(this.IsNumber(t)){e.setDate(e.getDate()+t);n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();return n-=19e6,n}return a},this.TIMETOSEC=function(t){var e=parseInt(t/1e4),a=parseInt(t%1e4/100),i=t%100,r=60*e*60+60*a+i;return r},this.SECTOTIME=function(t){Math.floor(t/86400);var e=Math.floor(t%86400/3600),a=Math.floor(t%3600/60),i=t%60,r=1e4*e+100*a+i;return r},this.ANY=function(t,e){e<=0&&(e=1);var a=[];if(Array.isArray(t)){if(e>=t.length)return 0;for(var i=e,r=0;i<t.length;++i){var n=0;for(r=0;r<e;++r){var o=t[i-r];if(o>0){n=1;break}}a[i]=n}return a}if(sa.IsNumber(t)){if(t<=0)return 0;if(e>=this.SymbolData.Data.Data.length)return 0;for(i=e;i<this.SymbolData.Data.Data.length;++i)a[i]=1;return a}return 0},this.ALL=function(t,e){e<=0&&(e=1);var a=[];if(Array.isArray(t)){if(e>=t.length)return 0;for(var i=e,r=0;i<t.length;++i){var n=1;for(r=0;r<e;++r){var o=t[i-r];if(!(o>0)){n=0;break}}a[i]=n}return a}if(sa.IsNumber(t)){if(t<=0)return 0;if(e>=this.SymbolData.Data.Data.length)return 0;for(i=e;i<this.SymbolData.Data.Data.length;++i)a[i]=1;return a}return 0},this.TESTSKIP=function(t,e){if(Array.isArray(t)){if(t.length<=0)return!1;var a=t[t.length-1];return!!a}return sa.IsNumber(t)?!(t<=0):!!t},this.IFC=function(t){if(Array.isArray(t)){var e=t[t.length-1];return!!sa.IsNumber(e)&&e>0}return!!sa.IsNumber(t)&&t>0},this.ALIGNRIGHT=function(t){if(Array.isArray(t)){for(var e=[],a=t.length-1,i=t.length-1;i>=0;--i){var r=t[i];(sa.IsNumber(r)||sa.IsString(r))&&(e[a]=r,--a)}for(i=a;i>=0;--i)e[i]=null;return e}return t},this.SUMBARS=function(t,e){var a=Array.isArray(t),i=Array.isArray(e),r=sa.IsNumber(t),n=sa.IsNumber(e),o=[];if(a&&n)for(var s=0,h=0;s<t.length;++s){for(var l=0,u=(h=0,s-1);u>=0;--u,++h){var C=t[s];if(sa.IsNumber(C)&&(l+=t[u],l>e))break}o[s]=h}else if(a&&i){var D=Math.max(t.length,e.length);for(s=0;s<D;++s){o[s]=null;l=0,h=0;var f=e[s];if(sa.IsNumber(f)){for(u=s-1;u>=0;--u,++h){C=t[s];if(sa.IsNumber(C)&&(l+=t[u],l>f))break}o[s]=h}}}else if(r&&i)for(s=0;s<e.length;++s){o[s]=null;l=0,h=0,f=e[s];if(sa.IsNumber(f)){for(u=s-1;u>=0;--u,++h)if(l+=t,l>f)break;o[s]=h}}return o},this.STRFORMAT=function(t,e,a){var i=t.match(/{[0-9.:]+}/g);if(!sa.IsNonEmptyArray(i))return null;for(var r=new Map,n=-1,o=0;o<i.length;++o){var s=i[o];if(!(s.length<3)){var h=s.slice(1,s.length-1),u=-1,C=-1;if(h.indexOf(":")>0){var D=h.split(":");if(D&&(D[0]&&(u=parseInt(D[0])),D[1]))if(D[1].indexOf(".")>=0){for(var f=0,c=D[1],m=c.length-1;m>=0;--m){if("0"!=c[m])break;++f}f>0&&(C=f)}else"0"==D[1]&&(C=0)}else u=parseInt(h);if(!(u<0)){var d={Src:s,Index:u,Text:null,Decimal:null};C>=0&&(d.Decimal=C),n<u&&(n=u),r.set(u,d)}}}var I=!1,S=0;for(o=1;o<e.length;++o){s=e[o];Array.isArray(s)&&(I=!0,S<s.length&&(S=s.length))}if(I){var T=[];for(o=0;o<S;++o){var v,p=t,g=(0,l.default)(r);try{for(g.s();!(v=g.n()).done;){s=v.value;var x=s[1],F=(d=e[x.Index+1],"null");if(d)if(Array.isArray(d)){h=d[o];h&&(F=sa.IsNumber(x.Decimal)?"".concat(h.toFixed(x.Decimal)):"".concat(h))}else F="".concat(d);p=p.replace(x.Src,F)}}catch(M){g.e(M)}finally{g.f()}T[o]=p}return T}T=t;var E,L=(0,l.default)(r);try{for(L.s();!(E=L.n()).done;){s=E.value,x=s[1],d=e[x.Index+1],F="null";d&&(F="".concat(d)),T=T.replace(x.Src,F)}}catch(M){L.e(M)}finally{L.f()}return T},this.CallFunction=function(t,e,a,i){switch(t){case"MAX":case"MAX6":return this.MAX(e,a);case"MIN":case"MIN6":return this.MIN(e,a);case"REF":return this.REF(e[0],e[1]);case"REFV":return this.REFV(e[0],e[1]);case"REFX":return this.REFX(e[0],e[1]);case"REFXV":return this.REFXV(e[0],e[1]);case"REFX1":return this.REFX(e[0],e[1]);case"ABS":return this.ABS(e[0]);case"MA":return this.MA(e[0],e[1]);case"EMA":return this.EMA(e[0],e[1]);case"SMA":return this.SMA(e[0],e[1],e[2]);case"DMA":return this.DMA(e[0],e[1]);case"XMA":return this.XMA(e[0],e[1]);case"EXPMA":return this.EXPMA(e[0],e[1]);case"EXPMEMA":return this.EXPMEMA(e[0],e[1]);case"COUNT":return this.COUNT(e[0],e[1]);case"LLV":return this.LLV(e[0],e[1]);case"LV":return this.LV(e[0],e[1]);case"LLVBARS":return this.LLVBARS(e[0],e[1]);case"HHV":return this.HHV(e[0],e[1]);case"HV":return this.HV(e[0],e[1]);case"HHVBARS":return this.HHVBARS(e[0],e[1]);case"MULAR":return this.MULAR(e[0],e[1]);case"CROSS":return this.CROSS(e[0],e[1]);case"LONGCROSS":return this.LONGCROSS(e[0],e[1],e[2]);case"ISVALID":return this.ISVALID(e[0]);case"CROSSDOWN":return this.CROSSDOWN(e[0],e[1]);case"CROSSUP":return this.CROSSUP(e[0],e[1]);case"AVEDEV":return this.AVEDEV(e[0],e[1]);case"STD":return this.STD(e[0],e[1]);case"STDDEV":return this.STDDEV(e[0],e[1]);case"IF":case"IFF":case"IFELSE":return this.IF(e[0],e[1],e[2]);case"IFN":return this.IFN(e[0],e[1],e[2]);case"NOT":return this.NOT(e[0]);case"SUM":return this.SUM(e[0],e[1]);case"RANGE":return this.RANGE(e[0],e[1],e[2]);case"EXIST":return this.EXIST(e[0],e[1]);case"EXISTR":return this.EXISTR(e[0],e[1],e[2]);case"FILTER":return this.FILTER(e[0],e[1]);case"TFILTER":return this.TFILTER(e[0],e[1],e[2]);case"FILTERX":return this.FILTERX(e[0],e[1],a);case"SLOPE":return this.SLOPE(e[0],e[1]);case"BARSLAST":return this.BARSLAST(e[0]);case"BARSLASTS":return this.BARSLASTS(e[0],e[1],a);case"BARSCOUNT":return this.BARSCOUNT(e[0]);case"BARSSINCEN":return this.BARSSINCEN(e[0],e[1]);case"BARSSINCE":return this.BARSSINCE(e[0]);case"LAST":return this.LAST(e[0],e[1],e[2]);case"EVERY":return this.EVERY(e[0],e[1]);case"DEVSQ":return this.DEVSQ(e[0],e[1]);case"ZIG":return this.ZIG(e[0],e[1]);case"TROUGHBARS":return this.TROUGHBARS(e[0],e[1],e[2]);case"TROUGH":return this.TROUGH(e[0],e[1],e[2]);case"PEAKBARS":return this.PEAKBARS(e[0],e[1],e[2]);case"PEAK":return this.PEAK(e[0],e[1],e[2]);case"COST":return this.COST(e[0]);case"WINNER":return this.WINNER(e[0],a);case"PPART":return this.PPART(e[0],a);case"COSTEX":return this.COSTEX(e[0],e[1],a);case"LWINNER":return this.LWINNER(e[0],e[1],a);case"PWINNER":return this.PWINNER(e[0],e[1],a);case"FORCAST":return this.FORCAST(e[0],e[1]);case"TSMA":return this.TSMA(e[0],e[1]);case"STDP":return this.STDP(e[0],e[1]);case"VAR":return this.VAR(e[0],e[1]);case"VARP":return this.VARP(e[0],e[1]);case"UPNDAY":return this.UPNDAY(e[0],e[1]);case"DOWNNDAY":return this.DOWNNDAY(e[0],e[1]);case"NDAY":return this.NDAY(e[0],e[1],e[2]);case"RELATE":return this.RELATE(e[0],e[1],e[2]);case"COVAR":return this.COVAR(e[0],e[1],e[2]);case"BETA":return this.BETA(e[0]);case"BETA2":return this.BETA2(e[0],e[1],e[2]);case"WMA":return this.WMA(e[0],e[1]);case"MEMA":return this.MEMA(e[0],e[1]);case"SUMBARS":return this.SUMBARS(e[0],e[1]);case"REVERSE":return this.REVERSE(e[0]);case"SAR":return this.SAR(e[0],e[1],e[2]);case"SARTURN":return this.SARTURN(e[0],e[1],e[2]);case"BACKSET":return this.BACKSET(e[0],e[1]);case"BETWEEN":return this.BETWEEN(e[0],e[1],e[2]);case"STRCAT":return this.STRCAT(e[0],e[1]);case"CON2STR":return this.CON2STR(e[0],e[1]);case"VAR2STR":return this.VAR2STR(e[0],e[1]);case"VARCAT":return this.VARCAT(e[0],e[1]);case"STRSPACE":return this.STRSPACE(e[0]);case"FINDSTR":return this.FINDSTR(e[0],e[1]);case"STRCMP":return this.STRCMP(e[0],e[1]);case"STRLEN":return this.STRLEN(e[0]);case"STRFORMAT":return this.STRFORMAT(e[0],e,a);case"DTPRICE":return this.DTPRICE(e[0],e[1]);case"ZTPRICE":return this.ZTPRICE(e[0],e[1]);case"MOD":return this.MOD(e[0],e[1]);case"POW":return this.POW(e[0],e[1]);case"CEILING":return this.CEILING(e[0]);case"FLOOR":return this.FLOOR(e[0]);case"FRACPART":return this.FRACPART(e[0]);case"SIGN":return this.SIGN(e[0]);case"BARSLASTCOUNT":return this.BARSLASTCOUNT(e[0]);case"INTPART":return this.INTPART(e[0]);case"CONST":return this.CONST(e[0]);case"TOPRANGE":return this.TOPRANGE(e[0]);case"LOWRANGE":return this.LOWRANGE(e[0]);case"FINDLOW":return this.FINDLOW(e[0],e[1],e[2],e[3]);case"FINDLOWBARS":return this.FINDLOWBARS(e[0],e[1],e[2],e[3]);case"FINDHIGH":return this.FINDHIGH(e[0],e[1],e[2],e[3]);case"FINDHIGHBARS":return this.FINDHIGHBARS(e[0],e[1],e[2],e[3]);case"BARSNEXT":return this.BARSNEXT(e[0]);case"HOD":return this.HOD(e[0],e[1]);case"LOD":return this.LOD(e[0],e[1]);case"AMA":return this.AMA(e[0],e[1]);case"TMA":return this.TMA(e[0],e[1],e[2]);case"ROUND":return this.ROUND(e[0]);case"ROUND2":return this.ROUND2(e[0],e[1]);case"TRMA":return this.TRMA(e[0],e[1]);case"VALUEWHEN":return this.VALUEWHEN(e[0],e[1]);case"HARMEAN":return this.HARMEAN(e[0],e[1]);case"DATETODAY":return this.DATETODAY(e[0]);case"DAYTODATE":return this.DAYTODATE(e[0]);case"TIMETOSEC":return this.TIMETOSEC(e[0]);case"SECTOTIME":return this.SECTOTIME(e[0]);case"ANY":return this.ANY(e[0],e[1]);case"ALL":return this.ALL(e[0],e[1]);case"TESTSKIP":return this.TESTSKIP(e[0],a);case"SUMBARS":return this.SUMBARS(e[0],e[1]);case"ALIGNRIGHT":return this.ALIGNRIGHT(e[0]);case"ATAN":return this.Trigonometric(e[0],Math.atan);case"ACOS":return this.ACOS(e[0]);case"ASIN":return this.ASIN(e[0]);case"COS":return this.Trigonometric(e[0],Math.cos);case"SIN":return this.Trigonometric(e[0],Math.sin);case"TAN":return this.Trigonometric(e[0],Math.tan);case"LN":return this.Trigonometric(e[0],Math.log);case"LOG":return this.Trigonometric(e[0],Math.log10);case"EXP":return this.Trigonometric(e[0],Math.exp);case"SQRT":return this.Trigonometric(e[0],Math.sqrt);case"RAND":return this.RAND(e[0]);default:this.ThrowUnexpectedNode(a,"函数"+t+"不存在",t)}},this.CallCustomFunction=function(t,e,a,i){var r=Qr.CustomFunction.Data.get(t),n=a.GetStockCacheData({CustomName:t,Node:i});if(!r.Invoke)return{Out:n};u.Complier.Log("[JSAlgorithm::CallCustomFunction] call custom function functionInfo=",r);var o=this,s={Name:t,Args:e,Symbol:a.Symbol,Period:a.Period,Right:a.Right,KData:a.Data,DownloadData:n,ThrowError:function(t){o.ThrowUnexpectedNode(i,t)}};return r.Invoke(s)},this.ThrowUnexpectedNode=function(t,e,a){var i=t.Marker,r=e||"执行异常";return this.ErrorHandler.ThrowError(i.Index,i.Line,i.Column,r,a)}}function un(t,e){this.ErrorHandler=t,this.SymbolData=e,this.DRAWTEXT=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWTEXT",Text:a};if(Array.isArray(t)){if(t.length<=0)return r;var n=this.IsNumber(e),o=!1;for(var s in"TOP"!==e&&"BOTTOM"!==e||(r.FixedPosition=e,o=!0),t)i[s]=null,!isNaN(t[s])&&t[s]&&(n||o?i[s]=e:this.IsNumber(e[s])&&(i[s]=e[s]))}else if(this.IsNumber(t)&&t){n=this.IsNumber(e),o=!1;"TOP"!==e&&"BOTTOM"!==e||(r.FixedPosition=e,o=!0);for(s=0;s<this.SymbolData.Data.Data.length;++s)n||o?i[s]=e:this.IsNumber(e[s])&&(i[s]=e[s])}return r},this.DRAWTEXT_FIX=function(t,e,a,i,r){var n={Value:[],Text:[]},o={DrawData:n,DrawType:"DRAWTEXT_FIX",Text:null,Position:{X:e,Y:a,Type:i}};if(t.length<=0)return o;if(Array.isArray(t))for(var s in t)n.Text[s]=null,n.Value[s]=0,!isNaN(t[s])&&t[s]&&(n.Value[s]=1,n.Text[s]=r);else if(t)for(s=0;s<this.SymbolData.Data.Data.length;++s)n.Text[s]=r,n.Value[s]=1;return o},this.SUPERDRAWTEXT=function(t,e,a,i,r){var n=[],o={DrawData:n,DrawType:"SUPERDRAWTEXT",Text:a,YOffset:r,Direction:i,TextAlign:"center"};if(t.length<=0)return o;var s="number"==typeof e;for(var h in t)n[h]=null,!isNaN(t[h])&&t[h]&&(s?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return o},this.STICKLINE=function(t,e,a,i,r){var n=[],o={DrawData:n,DrawType:"STICKLINE",Width:i,Type:r};o.Width<0&&(o.Width=3);var s="number"==typeof e,h="number"==typeof a;if(Array.isArray(t)){if(t.length<=0)return o;for(var l in t)if(n[l]=null,!isNaN(t[l])&&t[l])if(s&&h)n[l]={Value:e,Value2:a};else if(s&&!h){if(isNaN(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!s&&h){if(isNaN(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(isNaN(e[l])||isNaN(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}else{if(!t)return o;for(l=0;l<this.SymbolData.Data.Data.length;++l)if(n[l]=null,s&&h)n[l]={Value:e,Value2:a};else if(s&&!h){if(!sa.IsNumber(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!s&&h){if(!sa.IsNumber(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(!sa.IsNumber(e[l])||!sa.IsNumber(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}return o},this.DRAWLINE=function(t,e,a,i,r){var n=[],o={DrawData:n,DrawType:"DRAWLINE",Expand:r};if(t.length<=0)return o;for(var s=Math.max(t.length,a.length),h=!1,l=!1,u={Start:{},End:{},List:new Array},C=0;C<s;++C){if(n[C]=null,C<t.length&&C<a.length)if(0==h&&0==l){if(null==t[C]||!t[C])continue;h=!0,u.Start={ID:C,Value:e[C]}}else if(1==h&&0==l){var D=null!=a[C]&&a[C];if(!D){t[C]&&(u.Start={ID:C,Value:e[C]});continue}D&&(l=!0,u.End={ID:C,Value:i[C]})}else if(1==h&&1==l){D=null!=a[C]&&a[C];if(D)u.End={ID:C,Value:i[C]};else if(t[C]){var f=this.CalculateDrawLine(u);for(var c in f){var m=f[c];n[m.ID]=m.Value}1==r&&this.CalculateDrawDataExtendLine(n,u.Start.ID-2),h=l=!1,u={Start:{},End:{}},h=!0,l=!1,u.Start={ID:C,Value:e[C]}}}if(1==h&&1==l){var d=this.CalculateDrawLine(u);for(var I in d){var S=d[I];n[S.ID]=S.Value}}}return 1==r&&this.CalculateDrawDataExtendLine(n),o},this.DRAWBAND=function(t,e,a,i){sa.IsNumber(e)&&(e="rgb(".concat(e,",0,0)")),sa.IsNumber(i)&&(i="rgb(".concat(i,",0,0)"));var r=[],n={DrawData:r,DrawType:"DRAWBAND",Color:[null,null]};e&&(n.Color[0]=e.toLowerCase()),i&&(n.Color[1]=i.toLowerCase());var o=sa.IsNumber(t),s=sa.IsNumber(a);if(o||s){if(o&&!s)for(h=a.length,l=0;l<h;++l){u={Value:t,Value2:null};l<a.length&&(u.Value2=a[l]),r.push(u)}else if(!o&&s)for(h=t.length,l=0;l<h;++l){u={Value:null,Value2:a};l<t.length&&(u.Value=t[l]),r.push(u)}else if(o&&s)for(h=this.SymbolData.Data.Data.length,l=0;l<h;++l){u={Value:t,Value2:a};r.push(u)}}else for(var h=Math.max(t.length,a.length),l=0;l<h;++l){var u={Value:null,Value2:null};l<t.length&&(u.Value=t[l]),l<a.length&&(u.Value2=a[l]),r.push(u)}return n},this.GetDataByIndex=function(t,e){var a={Result:!1,Data:null};return this.IsNumber(t)?(a.Result=!0,a.Data=t):e<t.length?(a.Result=!0,a.Data=t[e]):a.Result=!1,a},this.FILLRGN=function(t,e,a){var i=[],r={DrawData:i,DrawType:"FILLRGN"};this.IsNumber(e),this.IsNumber(a);if(Array.isArray(t))for(var n in t){i[n]=null;var o=t[n];if(o){var s=this.GetDataByIndex(e,n);if(s.Result){var h=this.GetDataByIndex(a,n);if(h.Result){var l={Value:s.Data,Value2:h.Data};i[n]=l}}}}else if(t)for(n=0;n<this.SymbolData.Data.Data.length;++n){i[n]=null;s=this.GetDataByIndex(e,n);if(s.Result){h=this.GetDataByIndex(a,n);if(h.Result){l={Value:s.Data,Value2:h.Data};i[n]=l}}}return r},this.DRAWKLINE=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWKLINE"},o=Math.max(t.length,e.length,a.length,i.length),s=0;s<o;++s){var h={Open:null,High:null,Low:null,Close:null};s<t.length&&s<e.length&&s<a.length&&s<i.length&&(h.Open=e[s],h.High=t[s],h.Low=a[s],h.Close=i[s]),r[s]=h}return n},this.DRAWKLINE_IF=function(t,e,a,i,r){for(var n=[],o={DrawData:n,DrawType:"DRAWKLINE_IF"},s=Math.max(t.length,e.length,a.length,i.length,r.length),h=0;h<s;++h){var l={Open:null,High:null,Low:null,Close:null};h<e.length&&h<a.length&&h<i.length&&h<r.length&&h<t.length&&t[h]&&(l.Open=a[h],l.High=e[h],l.Low=i[h],l.Close=r[h]),n[h]=l}return o},this.DRAWOVERLAYKLINE=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWOVERLAYKLINE"},o=Math.max(e.length,t.length,a.length,i.length),s=this.SymbolData.Data.Data,h=0;h<o;++h){var l={Open:null,High:null,Low:null,Close:null},u=s[h];h<e.length&&h<t.length&&h<a.length&&h<i.length&&sa.IsNumber(t[h])&&sa.IsNumber(e[h])&&sa.IsNumber(a[h])&&sa.IsNumber(a[h])&&(l.Open=t[h],l.High=e[h],l.Low=a[h],l.Close=i[h],l.Date=u.Date,sa.IsNumber(u.Time)&&(l.Time=u.Time)),r[h]=l}return n},this.DRAWCOLORKLINE=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWCOLORKLINE",IsEmptyBar:!(0==a),Color:e};if(Array.isArray(t))for(var n=0;n<t.length&&n<this.SymbolData.Data.Data.length;++n){i[n]=null;var o=t[n];if(o){var s=this.SymbolData.Data.Data[n];s&&(i[n]={Open:s.Open,High:s.High,Low:s.Low,Close:s.Close})}}else if(t)for(n=0;n<this.SymbolData.Data.Data.length;++n){i[n]=null;s=this.SymbolData.Data.Data[n];s&&(i[n]={Open:s.Open,High:s.High,Low:s.Low,Close:s.Close})}return r},this.POLYLINE=function(t,e){var a=[],i={DrawData:a,DrawType:"POLYLINE"},r=sa.IsNumber(e),n=!1;if(r){if(this.IsNumber(t)){if(t)for(var o=this.SymbolData.Data.Data.length,s=0;s<o;++s)a[s]=e}else if(Array.isArray(t)){var h=!1;for(s=0;s<t.length;++s)if(a[s]=null,h)a[s]=e;else{if(!t[s])continue;h=!0,a[s]=e}}}else if(sa.IsNumber(t)){if(!t)return i;var l={Start:{},End:{},List:[]};for(s=0;s<e.length;++s)if(a[s]=null,0==n){if(!this.IsNumber(e[s]))continue;n=!0,l.Start={ID:parseInt(s),Value:e[s]}}else if(1==n){if(!this.IsNumber(e[s]))continue;l.End={ID:parseInt(s),Value:e[s]};var u=this.CalculateDrawLine(l);for(var C in u){var D=u[C];a[D.ID]=D.Value}var f={ID:l.End.ID,Value:l.End.Value};l={Start:f,End:{}}}this.CalculateDrawDataExtendLine(a)}else{var c={Start:{},End:{},List:[]};for(var m in t)if(a[m]=null,0==n){if(null==t[m]||!t[m])continue;if(m>=e.length||!this.IsNumber(e[m]))continue;n=!0,c.Start={ID:parseInt(m),Value:e[m]}}else if(1==n){if(null==t[m]||!t[m])continue;if(m>=e.length||!this.IsNumber(e[m]))continue;c.End={ID:parseInt(m),Value:e[m]};var d=this.CalculateDrawLine(c);for(var I in d){var S=d[I];a[S.ID]=S.Value}var T={ID:c.End.ID,Value:c.End.Value};c={Start:T,End:{}}}this.CalculateDrawDataExtendLine(a)}return i},this.CalculateDrawDataExtendLine=function(t,e){if(!(e<0)){var a=null,i=t.length;this.IsNumber(e)&&e<i&&(i=e);for(var r=i-1;r>=0;--r)if(this.IsNumber(t[r])){a=r;break}if(null!=a&&a-1>=0){var n=a-1;for(r=a+1;r<i;++r){var o=t[n],s=t[a],h=(o-s)*(r-n)/(a-n);if(o-h<0)break;t[r]=o-h}}}},this.DRAWNUMBER=function(t,e,a,i){var r={Value:[],Text:[]},n={DrawData:r,DrawType:"DRAWNUMBER"},o=2;sa.IsNumber(i)&&(o=i);var s={DataType:0,SingleValue:null,ArrayValue:null};Array.isArray(e)?(s.ArrayValue=e,s.DataType=2):("TOP"!==e&&"BOTTOM"!==e||(n.FixedPosition=e),s.SingleValue=e,s.DataType=1);var h={DataType:0,SingleValue:null,ArrayValue:null};if(Array.isArray(a)?(h.ArrayValue=a,h.DataType=2):(h.SingleValue=a,h.DataType=1,sa.IsNumber(a)&&(sa.IsInteger(a)?h.SingleValue=a.toString():text=a.toFixed(o))),Array.isArray(t))for(var l=0;l<t.length;++l)r.Value[l]=null,t[l]&&(r.Value[l]=this.DRAWNUMBER_Temp_PriceItem(l,s),r.Text[l]=this.DRAWNUMBER_Temp_NumberItem(l,h,o));else if(this.IsNumber(t)&&t)for(l=0;l<this.SymbolData.Data.Data.length;++l)r.Value[l]=this.DRAWNUMBER_Temp_PriceItem(l,s),r.Text[l]=this.DRAWNUMBER_Temp_NumberItem(l,h,o);return n},this.DRAWNUMBER_Temp_PriceItem=function(t,e){return e?1==e.DataType?e.SingleValue:sa.IsNonEmptyArray(e.ArrayValue)?e.ArrayValue[t]:null:null},this.DRAWNUMBER_Temp_NumberItem=function(t,e,a){if(!e)return null;if(1==e.DataType)return e.SingleValue;if(!sa.IsNonEmptyArray(e.ArrayValue))return null;var i=e.ArrayValue[t];return this.IsNumber(i)?sa.IsInteger(i)?i.toString():i.toFixed(a):i.toString()},this.DRAWNUMBER_FIX=function(t,e,a,i,r){var n={Value:[],Text:[]},o={DrawData:n,DrawType:"DRAWNUMBER_FIX",Position:{X:e,Y:a,Type:i}},s=sa.IsNumber(r);if(Array.isArray(t)){for(var h in t)if(n.Text[h]=null,n.Value[h]=null,t[h])if(s)n.Text[h]=this.RemoveZero(r.toFixed(2)),n.Value[h]=r;else{if(h>=r.length||!sa.IsNumber(r[h]))continue;var l=r[h];n.Text[h]=this.RemoveZero(l.toFixed(2)),n.Value[h]=l}}else if(t)for(h=0;h<this.SymbolData.Data.Data.length;++h)if(s)n.Text[h]=this.RemoveZero(r.toFixed(2)),n.Value[h]=r;else{if(h>=r.length||!sa.IsNumber(r[h]))continue;l=r[h];n.Text[h]=this.RemoveZero(l.toFixed(2)),n.Value[h]=l}else;return o},this.DRAWICON=function(t,e,a){if(sa.IsString(a)){var i=a.replace("ICO","");a=parseInt(i)}var r=Qr.GetDrawIcon(a);r||Qr.GetDrawTextIcon(a),r||(r={Symbol:"🚩"});var n=[],o={DrawData:n,DrawType:"DRAWICON",Icon:r,IconType:a};if(t.length<=0)return o;var s="number"==typeof e;if("number"==typeof t){if(!t)return o;for(var h=0;h<this.SymbolData.Data.Data.length;++h)s?n[h]=e:h<e.length&&this.IsNumber(e[h])?n[h]=e[h]:n[h]=null;return o}for(var h in t)n[h]=null,t[h]&&(s?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return o},this.ICON=function(t,e){if(sa.IsString(e)){var a=e.replace("ICO","");e=parseInt(a)}var i=Qr.GetDrawIcon(e);i||Qr.GetDrawTextIcon(e),i||(i={Symbol:"🚩"});for(var r=[],n={DrawData:r,DrawType:"ICON",Icon:i},o=0;o<this.SymbolData.Data.Data.length;++o){var s=this.SymbolData.Data.Data[o];s&&(0==t?r[o]=s.Low:1==t&&(r[o]=s.High))}return n},this.TIPICON=function(t,e,a,i){if(sa.IsString(a)){var r=a.replace("ICO","");a=parseInt(r)}var n=Qr.GetDrawIcon(a),o=[],s={DrawData:o,DrawType:"TIPICON",Icon:n,IconType:a,Text:i};if(t.length<=0)return s;var h="number"==typeof e;if(sa.IsNumber(t)){if(!t)return s;for(var l=0;l<this.SymbolData.Data.Data.length;++l)h?o[l]=e:l<e.length&&sa.IsNumber(e[l])?o[l]=e[l]:o[l]=null}else if(Array.isArray(t))for(l=0;l<t.length;++l)o[l]=null,t[l]&&(h?o[l]=e:sa.IsNumber(e[l])&&(o[l]=e[l]));return s},this.DRAWCHANNEL=function(t,e,a,i,r,n,o){var s=[],h={DrawData:s,DrawType:"DRAWCHANNEL",Border:{}};if(t.length<=0)return h;if(i&&(h.Border.Color=i),o&&(h.AreaColor=o),r>0&&(h.Border.Width=r),n)if("0"==n)h.Border.Dotted=[];else{var l=n.split(",");for(var u in h.Border.Dotted=[],l){var C=l[u];if(C){var D=parseInt(l[u]);sa.IsNumber(D)&&(D<=0||h.Border.Dotted.push(D))}}h.Border.Dotted.length<=0&&(h.Border.Dotted=null)}var f="number"==typeof e,c="number"==typeof a;if("number"==typeof t){if(!t)return h;for(u=0;u<this.SymbolData.Data.Data.length;++u)if(s[u]=null,f&&c)s[u]={Value:e,Value2:a};else if(f&&!c){if(isNaN(a[u]))continue;s[u]={Value:e,Value2:a[u]}}else if(!f&&c){if(isNaN(e[u]))continue;s[u]={Value:e[u],Value2:a}}else{if(isNaN(e[u])||isNaN(a[u]))continue;s[u]={Value:e[u],Value2:a[u]}}}else for(u=0;u<t.length;++u)if(s[u]=null,!isNaN(t[u])&&t[u])if(f&&c)s[u]={Value:e,Value2:a};else if(f&&!c){if(isNaN(a[u]))continue;s[u]={Value:e,Value2:a[u]}}else if(!f&&c){if(isNaN(e[u]))continue;s[u]={Value:e[u],Value2:a}}else{if(isNaN(e[u])||isNaN(a[u]))continue;s[u]={Value:e[u],Value2:a[u]}}return h},this.RGB=function(t,e,a){var i="RGB(".concat(t,",").concat(e,",").concat(a,")");return i},this.RGBA=function(t,e,a,i){var r="RGB(".concat(t,",").concat(e,",").concat(a,",").concat(i,")");return r},this.UPCOLOR=function(t){return t},this.DOWNCOLOR=function(t){return t},this.STICKTYPE=function(t){return t},this.XMOVE=function(t){return t},this.YMOVE=function(t){return t},this.LINEDASH=function(t){return sa.IsNonEmptyArray(t)?t.slice():[]},this.KLINETYPE=function(t){return t},this.FIRSTDRAW=function(t){return t},this.SOUND=function(t){return{Name:"SOUND",Value:t}},this.PLAYSOUND=function(t,e){return null},this.PARTLINE=function(t){var e=[],a={DrawData:e,DrawType:"PARTLINE"};if(t.length<3)return a;for(var i=t[0],r=[],n=1;n<t.length&&n+1<t.length;n+=2)r.push({Cond:t[n],RGB:t[n+1]});for(var n in i){var o={Value:null,RGB:null};e[n]=o;var s=i[n];if(this.IsNumber(s)){var h=null;for(var l in r){var u=r[l];if(Array.isArray(u.Cond)){if(n<u.Cond.length&&u.Cond[n]){h=u.RGB;break}}else if(this.IsNumber(u.Cond)&&u.Cond){h=u.RGB;break}}h&&(o.Value=s,o.RGB=h)}}return a},this.FILLRGN2=function(t){var e=[],a={DrawData:e,DrawType:"FILLRGN2"};if(t.length<4)return a;for(var i=t[0],r=t[1],n=[],o=2;o<t.length&&o+1<t.length;o+=2)n.push({Cond:t[o],Color:t[o+1]});for(o=0;o<this.SymbolData.Data.Data.length;++o){e[o]=null;var s={Value:null,Value2:null,Color:null};for(var h in n){var l=n[h];if(Array.isArray(l.Cond)){if(o<l.Cond.length&&l.Cond[o]){s.Color=l.Color;break}}else if(this.IsNumber(l.Cond)&&l.Cond){s.Color=l.Color;break}}if(s.Color){if(Array.isArray(i)){if(o>=i.length)continue;if(!this.IsNumber(i[o]))continue;s.Value=i[o]}else{if(!this.IsNumber(i))continue;s.Value=i}if(Array.isArray(r)){if(o>=r.length)continue;if(!this.IsNumber(r[o]))continue;s.Value2=r[o]}else{if(!this.IsNumber(r))continue;s.Value2=r}e[o]=s}}return a},this.FLOATRGN=function(t){var e=[],a={DrawData:e,DrawType:"FLOATRGN"};if(t.length<4)return a;for(var i=t[0],r=t[1],n=[],o=2;o<t.length&&o+1<t.length;o+=2)n.push({Cond:t[o],Color:t[o+1]});for(o=0;o<this.SymbolData.Data.Data.length;++o){e[o]=null;var s={Value:null,Value2:null,Color:null};for(var h in n){var l=n[h];if(Array.isArray(l.Cond)){if(o<l.Cond.length&&l.Cond[o]){s.Color=l.Color;break}}else if(this.IsNumber(l.Cond)&&l.Cond){s.Color=l.Color;break}}if(s.Color){if(Array.isArray(i)){if(o>=i.length)continue;if(!this.IsNumber(i[o]))continue;s.Value=i[o]}else{if(!this.IsNumber(i))continue;s.Value=i}if(Array.isArray(r)){if(o>=r.length)continue;if(!this.IsNumber(r[o]))continue;s.Value2=r[o]}else{if(!this.IsNumber(r))continue;s.Value2=r}e[o]=s}}return a},this.FILLBGRGN=function(t,e){var a=[],i={DrawData:a,DrawType:1==t?"FILLTOPRGN":"FILLBOTTOMRGN"};if(e.length<3)return i;for(var r=e[0],n=[],o=1;o<e.length&&o+1<e.length;o+=2)n.push({Cond:e[o],Color:e[o+1]});for(o=0;o<this.SymbolData.Data.Data.length;++o){a[o]=null;var s={Value:null,Color:null};for(var h in n){var l=n[h];if(Array.isArray(l.Cond)){if(o<l.Cond.length&&l.Cond[o]){s.Color=l.Color;break}}else if(this.IsNumber(l.Cond)&&l.Cond){s.Color=l.Color;break}}if(s.Color){if(Array.isArray(r)){if(o>=r.length)continue;if(!this.IsNumber(r[o]))continue;s.Value=r[o]}else{if(!this.IsNumber(r))continue;s.Value=r}a[o]=s}}return i},this.FILLVERTICALRGN=function(t){var e=[],a={DrawData:e,DrawType:"FILLVERTICALRGN"};if(t.length<2)return a;for(var i=[],r=0;r<t.length&&r+1<t.length;r+=2)i.push({Cond:t[r],Color:t[r+1]});for(r=0;r<this.SymbolData.Data.Data.length;++r){e[r]=null;var n={Color:null};for(var o in i){var s=i[o];if(Array.isArray(s.Cond)){if(r<s.Cond.length&&s.Cond[r]){n.Color=s.Color;break}}else if(this.IsNumber(s.Cond)&&s.Cond){n.Color=s.Color;break}}n.Color&&(e[r]=n)}return a},this.DRAWGBK=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK"};if(Array.isArray(t))for(var o in t){var s=t[o];if(s){n.DrawData=r;break}}else t&&(n.DrawData=r);return n},this.DRAWGBK2=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK2"};if(Array.isArray(t)){for(var o in r.Data=[],t){var s=t[o];r.Data[o]=s?1:0}n.DrawData=r}else t&&(n.DrawData=r,n.DrawType="DRAWGBK");return n},this.DRAWGBK_DIV=function(t,e,a,i,r){var n={AryColor:[e,a],ColorType:i,FillType:r,Data:[]},o={DrawData:n,DrawType:"DRAWGBK_DIV"};if(!this.SymbolData||!this.SymbolData.Data||!sa.IsNonEmptyArray(this.SymbolData.Data.Data))return o;var s=this.SymbolData.Data.Data;if(Array.isArray(t))for(var h=0;h<s.length;++h){var l=t[h],u=null;if(l){var C=s[h];u=1==r?{AryValue:[C.High,C.Low]}:2==r?{AryValue:[C.Open,C.Close]}:{AryValue:null}}n.Data[h]=u}else if(t)for(h=0;h<s.length;++h){C=s[h],u=null;u=1==r?{AryValue:[C.High,C.Low]}:2==r?{AryValue:[C.Open,C.Close]}:{AryValue:null},n.Data[h]=u}return o},this.DRAWTEXT_LINE=function(t,e,a,i,r,n,o){var s={Text:{Title:a,Color:i},Line:{Type:n,Color:o}};r<=0&&(r=12),s.Text.Font=r*F()+"px 微软雅黑";var h={DrawData:null,DrawType:"DRAWTEXT_LINE"};if(Array.isArray(t)){var l=null;sa.IsNonEmptyArray(t)&&(l=t[t.length-1]),l&&(Array.isArray(e)?s.Price=e[t.length-1]:s.Price=e,h.DrawData=s)}else if(t){if(Array.isArray(e)){var u=null;e.length>0&&(u=e[e.length-1]),s.Price=u}else s.Price=e;h.DrawData=s}return h},this.DRAWRECTREL=function(t,e,a,i,r){var n={Rect:{Left:Math.min(t,a),Top:Math.min(e,i),Right:Math.max(a,t),Bottom:Math.max(i,e)},Color:r};0==r&&(n.Color=null);var o={DrawData:n,DrawType:"DRAWRECTREL"};return o},this.DRAWTEXTREL=function(t,e,a){var i={Point:{X:t,Y:e}};sa.IsString(a)?i.Text=a:sa.IsNonEmptyArray(a)&&(i.Text=a[0]);var r={DrawData:i,DrawType:"DRAWTEXTREL"};return r},this.DRAWTEXTABS=function(t,e,a){var i={Point:{X:t,Y:e}};sa.IsString(a)?i.Text=a:sa.IsNonEmptyArray(a)&&(i.Text=a[0]);var r={DrawData:i,DrawType:"DRAWTEXTABS"};return r},this.DRAWOVERLAYLINE=function(t,e,a){var i={Data:t,MainData:e};a&&"string"==typeof a&&(i.Title=a);var r={DrawData:i,DrawType:"DRAWOVERLAYLINE"};return r},this.DRAWSL=function(t,e,a,i,r){var n={Data:[],Option:[]},o={DrawData:n,DrawType:"DRAWSL"},s=this.IsNumber(e);if(Array.isArray(t))for(var h in t)n.Data[h]=null,t[h]&&(s?(n.Data[h]=e,n.Option[h]={Slope:a,Length:i,Direct:r}):h<e.length&&this.IsNumber(e[h])&&(n.Data[h]=e[h],n.Option[h]={Slope:a,Length:i,Direct:r}));else if(t){var l=this.SymbolData.Data.Data.length;for(h=0;h<l;++h)n.Data[h]=null,s?(n.Data[h]=e,n.Option[h]={Slope:a,Length:i,Direct:r}):h<e.length&&this.IsNumber(e[h])&&(n.Data[h]=e[h],n.Option[h]={Slope:a,Length:i,Direct:r})}return o},this.VERTLINE=function(t,e){var a={Data:[],LineType:e},i={DrawData:a,DrawType:"VERTLINE"};if(Array.isArray(t))for(var r=0;r<t.length;++r){var n=t[r];a.Data[r]=n?1:0}return i},this.HORLINE=function(t,e,a,i){var r={Data:[],LineType:a,Extend:i},n={DrawData:r,DrawType:"HORLINE"};if(Array.isArray(t)&&Array.isArray(e))for(var o=0;o<t.length;++o){var s=t[o];if(r.Data[o]=null,s&&!(o>=e.length)){var h=e[o];sa.IsNumber(h)&&(r.Data[o]=h)}}else if(Array.isArray(t)&&sa.IsNumber(e))for(o=0;o<t.length;++o){s=t[o];r.Data[o]=null,s&&(r.Data[o]=e)}else if(sa.IsNumber(t)&&t&&this.SymbolData&&this.SymbolData.Data&&this.SymbolData.Data.Data)if(Array.isArray(e)){var l=this.SymbolData.Data.Data.length;for(o=0;o<l;++o)if(r.Data[o]=null,!(o>=e.length)){h=e[o];sa.IsNumber(h)&&(r.Data[o]=h)}}else if(sa.IsNumber(e))for(l=this.SymbolData.Data.Data.length,o=0;o<l;++o)r.Data[o]=e;return n},this.BACKGROUND=function(t,e,a,i,r,n){var o={Margin:[0,1,1,1]};return t&&(o.Color=t),e&&(o.Border=e),sa.IsNumber(a)&&(o.Margin[2]=a),sa.IsNumber(i)&&(o.Margin[3]=i),sa.IsNumber(r)&&(o.Margin[0]=r),sa.IsNumber(n)&&(o.Margin[1]=n),o},this.CKLINE=function(t,e,a,i){var r={Color:t,LineWidth:1,LineType:0,LineDot:[3,3]};if(sa.IsPlusNumber(e)&&(r.LineWidth=e),sa.IsPlusNumber(a)&&(r.LineType=a),i){var n=i.split(","),o=[];for(var s in n){var h=n[s];if(h){var l=parseInt(n[s]);l<=0||o.push(l)}}o.length>0&&(r.LineDotted=o)}r.Data=[];for(s=0;s<this.SymbolData.Data.Data.length;++s){h=this.SymbolData.Data.Data[s];r.Data[s]={High:h.High,Low:h.Low}}return r},this.BUY=function(t,e,a,i){var r={Color:"rgb(0,255,0)",Type:"SVG",Icon:""};sa.IsString(a)&&(r.Icon=a),i&&(r.Color=i);var n=this.CalculateTradeData(t,e,r);return n.DrawType="BUY",n},this.BUYSHORT=function(t,e,a,i){var r={Color:"rgb(0,255,0)",Type:"SVG",Icon:""};sa.IsString(a)&&(r.Icon=a),i&&(r.Color=i);var n=this.CalculateTradeData(t,e,r);return n.DrawType="BUYSHORT",n},this.SELL=function(t,e,a,i){var r={Color:"rgb(255,0,0)",Type:"SVG",Icon:""};sa.IsString(a)&&(r.Icon=a),i&&(r.Color=i);var n=this.CalculateTradeData(t,e,r);return n.DrawType="SELL",n},this.SELLSHORT=function(t,e,a,i){var r={Color:"rgb(255,0,0)",Type:"SVG",Icon:""};sa.IsString(a)&&(r.Icon=a),i&&(r.Color=i);var n=this.CalculateTradeData(t,e,r);return n.DrawType="SELLSHORT",n},this.CalculateTradeData=function(t,e,a){var i=[],r=[],n={DrawData:{Data:i,Icons:r}};if(Array.isArray(t))for(var o=Array.isArray(e),s=0;s<t.length;++s)i[s]=0,r[s]=null,t[s]&&(i[s]=1,r[s]=o?{Value:e[s],Type:a.Type,Color:a.Color,Icon:a.Icon}:{Value:e,Type:a.Type,Color:a.Color,Icon:a.Icon});else sa.IsNumber(t);return n},this.DRAWLASTBARICON=function(t,e){if(sa.IsString(e)){var a=e.replace("ICO","");e=parseInt(a)}var i=Qr.GetDrawIcon(e);i||Qr.GetDrawTextIcon(e),i||(i={Symbol:"🚩"});var r={Value:null,Icon:i,IconType:e};sa.IsNonEmptyArray(t)?r.Value=t[t.length-1]:r.Value=t;var n={DrawData:r,DrawType:"DRAWLASTBARICON"};return n},this.DRAWLASTBARTEXT=function(t,e){var a={Value:null,Text:e};sa.IsNonEmptyArray(t)?a.Value=t[t.length-1]:a.Value=t;var i={DrawData:a,DrawType:"DRAWLASTBARTEXT"};return i},this.DRAWLASTBARNUMBER=function(t,e,a,i){var r={Value:null,Text:null,Color:i};sa.IsNonEmptyArray(t)?r.Value=t[t.length-1]:r.Value=t;var n=2;if(sa.IsNumber(a)&&(n=parseInt(a)),sa.IsNumber(e))r.Text=e.toFixed(n);else if(sa.IsNonEmptyArray(e)){var o=e[e.length-1];sa.IsNumber(o)&&(r.Text=o.toFixed(n))}var s={DrawData:r,DrawType:"DRAWLASTBARNUMBER"};return s},this.TABLE_CELL=function(t,e,a,i){var r=null;if(sa.IsString(t))r=t;else if(sa.IsNonEmptyArray(t)){var n=t[t.length-1];sa.IsNumber(n)?r=n.toFixed(2):sa.IsString(n)&&(r=n)}var o={Text:r};if(e&&(o.Color=e),i&&(o.BGColor=i),sa.IsString(a)){var s=a.toLowerCase();o.TextAlign=s}return o},this.TABLE_ROW=function(t){for(var e=[],a=0;a<t.length;++a){var i=t[a];e.push(i)}return e},this.DRAWTABLE=function(t){for(var e=[],a=0;a<t.length;++a){var i=t[a];e.push({AryCell:i})}return result={DrawData:{TableData:e},DrawType:"DRAW_SIMPLE_TABLE"}},this.PIE_CELL=function(t,e,a,i,r){var n=null;if(sa.IsNumber(t))n=t;else if(sa.IsString(t))n=parseFloat(t);else if(sa.IsNonEmptyArray(t)){var o=t[t.length-1];sa.IsNumber(o)?n=o:sa.IsString(o)&&(n=parseFloat(o))}var s={Value:n,Color:e};return a&&(s.Text=a),i&&(s.TextColor=i),r&&(s.LineColor=r),s},this.DRAWPIE=function(t){for(var e=t[0],a=[],i=1;i<t.length;++i)a.push(t[i]);return result={DrawData:{Data:a,Radius:e},DrawType:"DRAW_SIMPLE_PIE"}},this.RADAR_CELL=function(t,e,a,i){var r={Name:t,Max:100,Min:0,Value:null};if(sa.IsNumber(e))r.Value=e;else if(sa.IsString(e))r.Value=parseFloat(e);else if(sa.IsNonEmptyArray(e)){var n=e[e.length-1];sa.IsNumber(n)?r.Value=n:sa.IsString(n)&&(r.Value=parseFloat(n))}return sa.IsNumber(a)&&(r.Max=a),sa.IsNumber(i)&&(r.Min=i),r},this.DRAWRADAR=function(t){for(var e=t[0],a=t[1],i=[],r=[],n=2;n<t.length;++n){var o=t[n];i.push({Name:o.Name,Max:o.Max,Min:o.Min}),r.push({Value:o.Value,Name:o.Name,Group:"Default"})}return result={DrawData:{Data:r,AryIndex:i,Radius:e,AryArea:[{LineColor:a}]},DrawType:"DRAW_SIMPLE_RADAR"}},this.DRAWDOUGHNUT=function(t){for(var e=t[0],a=[],i=1;i<t.length;++i)a.push(t[i]);return result={DrawData:{Data:a,Radius:e,InnerRadius:e/2},DrawType:"DRAW_SIMPLE_DOUGHNUT"}}}ln.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},ln.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},ln.MOD=function(t,e){if(t<0&&e<0||t>=0&&e>=0){if(parseInt(t)==t&&parseInt(e)==e)return t%e;var a=parseFloat((t-Math.floor(t/e)*e).toFixed(1));return a}var i=Math.abs(t),r=Math.abs(e);a=Math.abs(Math.abs(e)*(Math.floor(i/r)+1)-Math.abs(t));return e<0&&(a=-a),a},un.prototype.CalculateDrawLine=function(t){t.List=[];for(var e=t.Start.ID;e<=t.End.ID;++e)t.List.push(e);var a=Math.abs(t.Start.Value-t.End.Value),i=t.List.length-1,r=[];if(r.push({ID:t.Start.ID,Value:t.Start.Value}),t.Start.Value>t.End.Value)for(var n=1;n<t.List.length-1;++n){var o=a*(t.List.length-1-n)/i+t.End.Value;r.push({ID:t.List[n],Value:o})}else for(var s=1;s<t.List.length-1;++s){o=a*s/i+t.Start.Value;r.push({ID:t.List[s],Value:o})}return r.push({ID:t.End.ID,Value:t.End.Value}),r},un.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},un.prototype.IsDrawFunction=function(t){var e=new Set(["STICKLINE","DRAWTEXT","SUPERDRAWTEXT","DRAWLINE","DRAWBAND","DRAWKLINE","DRAWKLINE1","DRAWKLINE_IF","DRAWCOLORKLINE","PLOYLINE","DRAWOVERLAYKLINE","POLYLINE","DRAWNUMBER","DRAWNUMBER_FIX","DRAWICON","DRAWCHANNEL","PARTLINE","DRAWTEXT_FIX","DRAWGBK","DRAWTEXT_LINE","DRAWRECTREL","DRAWTEXTABS","DRAWTEXTREL","DRAWOVERLAYLINE","FILLRGN","FILLRGN2","FILLTOPRGN","FILLBOTTOMRGN","FILLVERTICALRGN","FLOATRGN","DRAWSL","DRAWGBK2","DRAWGBK_DIV","VERTLINE","HORLINE","TIPICON","BUY","SELL","SELLSHORT","BUYSHORT","DRAWLASTBARICON","DRAWLASTBARNUMBER","DRAWLASTBARTEXT","DRAWTABLE","DRAWPIE","DRAWRADAR","DRAWDOUGHNUT"]);return!!e.has(t)},un.prototype.RemoveZero=function(t){while(t.length>0){var e=t.length-1,a=t[e];if("0"!=a){if("."==a){t=t.substr(0,e);break}break}t=t.substr(0,e)}return t};var Cn={YCLOSE:3,OPEN:4,HIGH:5,LOW:6,CLOSE:7,VOL:8,AMOUNT:10,AMPLITUDE:13,INCREASE:14,EXCHANGERATE:37};function Dn(t,e,a){this.AST=t,this.Execute=a,this.Symbol="600000.sh",this.Name,this.Data=null,this.PeriodData=new Map,this.IsApiPeriod=!1,this.SourceData=null,this.MarketValue=null,this.Period=0,this.Right=0,this.DataType=0,this.IsBeforeData=!1,this.DayCount,this.Arguments=[],this.KLineApiUrl=Qr.Domain+"/API/KLine2",this.MinuteKLineApiUrl=Qr.Domain+"/API/KLine3",this.RealtimeApiUrl=Qr.Domain+"/API/stock",this.HistoryMinuteApiUrl=qi.Domain+"/API/StockMinuteData",this.StockHistoryDayApiUrl=Qr.Domain+"/API/StockHistoryDay",this.StockHistoryDay3ApiUrl=Qr.Domain+"/API/StockHistoryDay3",this.StockHistoryDay2ApiUrl=Qr.Domain+"/API/StockHistoryDay2",this.StockNewsAnalysisApiUrl=Qr.CacheDomain+"/cache/newsanalyze",this.HKToSHSZApiUrl=[Qr.CacheDomain+"/cache/historyday/all/hk2shsz.json",Qr.CacheDomain+"/cache/analyze/hk2shsz/hk2shsz.json",Qr.Domain+"/API/HKToSHSZMinuteData",Qr.CacheDomain+"/cache/analyze/hk2szshanalyze"],this.MaxRequestDataCount=1e3,this.MaxRequestMinuteDayCount=5,this.KLineDateTimeRange,this.LatestData=new Map,this.IndexData,this.LatestIndexData,this.MarginData=new Map,this.HKToSHSZData=new Map,this.NewsAnalysisData=new Map,this.ExtendData=new Map,this.UserData=new Map,this.CustomAPIData=new Map,this.ScriptIndexOutData=new Map,this.OtherSymbolData=new Map,this.StockData=new Map,this.SectionFinanceData=new Map,this.ThrowSFPeirod=new Set,this.NetworkFilter,this.DrawInfo,e&&(e.HQDataType&&(this.DataType=e.HQDataType),e.Data&&(this.Data=e.Data,this.DataType!=Sn.MINUTE_ID&&this.DataType!=Sn.MULTIDAY_MINUTE_ID&&this.DataType!=Sn.HISTORY_MINUTE_ID&&(this.Period=e.Data.Period,this.Right=e.Data.Right)),e.SourceData&&(this.SourceData=e.SourceData),e.Symbol&&(this.Symbol=e.Symbol),e.Name&&(this.Name=e.Name),e.MaxRequestDataCount>0&&(this.MaxRequestDataCount=e.MaxRequestDataCount),e.MaxRequestMinuteDayCount>0&&(this.MaxRequestMinuteDayCount=e.MaxRequestMinuteDayCount),e.KLineApiUrl&&(this.KLineApiUrl=e.KLineApiUrl),e.Right&&(this.Right=e.Right),e.Period&&(this.Period=e.Period),!0===e.IsBeforeData&&(this.IsBeforeData=e.IsBeforeData),e.NetworkFilter&&(this.NetworkFilter=e.NetworkFilter),e.DayCount>0&&(this.DayCount=e.DayCount),e.Arguments&&(this.Arguments=e.Arguments),e.KLineRange&&(this.KLineDateTimeRange=e.KLineRange),e.IsApiPeriod&&(this.IsApiPeriod=e.IsApiPeriod),e.DrawInfo&&(this.DrawInfo=e.DrawInfo)),this.RecvError=function(t){throw u.Complier.Log("[JSSymbolData::RecvError] ajax error.",t.status),{FunctionName:"RecvError",Request:t}},this.GetLatestDataKey=function(t){t="DYNAINFO-".concat(t);return t},this.GetLatestData=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetLatestDataKey(a);if(this.LatestData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n={Name:"JSSymbolData::GetLatestData",Explain:"DYNAINFO()",Args:e,Request:{Url:r.RealtimeApiUrl,Type:"POST",Data:{symbol:[this.Symbol],field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","exchangerate","amplitude"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(t){r.RecvLatestData(t),r.Execute.RunNextJob()})),1==n.PreventDefault)return}io.HttpRequest({url:r.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","exchangerate","amplitude"],symbol:[this.Symbol]},type:"post",dataType:"json",async:!0,success:function(t){r.RecvLatestData(t),r.Execute.RunNextJob()},error:function(t){r.RecvError(t)}})},this.RecvLatestData=function(t){if(2!=t.ver){if(t.stock&&1==t.stock.length){var e=t.stock[0];e&&(sa.IsNumber(e.yclose)&&this.LatestData.set(Cn.YCLOSE,e.yclose),sa.IsNumber(e.open)&&this.LatestData.set(Cn.OPEN,e.open),sa.IsNumber(e.high)&&this.LatestData.set(Cn.HIGH,e.high),sa.IsNumber(e.low)&&this.LatestData.set(Cn.LOW,e.low),sa.IsNumber(e.price)&&this.LatestData.set(Cn.CLOSE,e.price),sa.IsNumber(e.vol)&&this.LatestData.set(Cn.VOL,e.vol),sa.IsNumber(e.amount)&&this.LatestData.set(Cn.AMOUNT,e.amount),sa.IsNumber(e.increase)&&this.LatestData.set(Cn.INCREASE,e.increase),sa.IsNumber(e.exchangerate)&&this.LatestData.set(Cn.EXCHANGERATE,e.exchangerate),sa.IsNumber(e.amplitude)&&this.LatestData.set(Cn.AMPLITUDE,e.amplitude),u.Complier.Log("[JSSymbolData::RecvLatestData] symbol, LatestData",e.symbol,this.LatestData))}}else this.RecvLatestDataVer2(t)},this.RecvLatestDataVer2=function(t){if(sa.IsNonEmptyArray(t.data)){for(var e=t.symbol,a=0;a<t.data.length;++a){var i=t.data[a];i&&(sa.IsNumber(i.id)&&(sa.IsNumber(i.value)||sa.IsString(i.value))&&(u.Complier.Log("[JSSymbolData::RecvLatestDataVer2] symbol=".concat(e," DYNAINFO(").concat(i.id,")=").concat(i.value,".")),this.LatestData.set(i.id,i.value)))}u.Complier.Log("[JSSymbolData::RecvLatestDataVer2]",this.LatestData)}},this.GetLatestCacheData=function(t){return this.LatestData.has(t)?this.LatestData.get(t):null},this.GetLatestIndexData=function(){if(this.LatestIndexData)return this.Execute.RunNextJob();var t=this;if(this.NetworkFilter){var e={Name:"JSSymbolData::GetLatestIndexData",Explain:"最新大盘数据",Request:{Url:t.RealtimeApiUrl,Type:"POST",Data:{symbol:["000001.sh"],field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","amplitude"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.RecvLatestIndexData(e),t.Execute.RunNextJob()})),1==e.PreventDefault)return}io.HttpRequest({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","amplitude"],symbol:["000001.sh"]},type:"post",dataType:"json",async:!0,success:function(e){t.RecvLatestIndexData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})},this.RecvLatestIndexData=function(t){if(t.stock&&1==t.stock.length){var e=t.stock[0];this.LatestIndexData={Symbol:e.symbol,Name:e.name,Date:e.date,Time:e.time,YClose:e.yclose,Price:e.price,Open:e.open,High:e.high,Low:e.low,Vol:e.vol,Amount:e.amount,Increase:e.increase,Amplitude:e.amplitude},u.Complier.Log("[JSSymbolData::RecvLatestIndexData]",this.LatestIndexData)}},this.GetVolRateData=function(t,e){var a=t.ID.toString()+"-VolRate-"+this.Symbol;if(this.ExtendData.has(a))return this.Execute.RunNextJob();var i=this,r=30;if(this.NetworkFilter){var n=this.Data.GetDateRange();r=1;this.DataType==Sn.MULTIDAY_MINUTE_ID&&(r=this.DayCount);var o={Name:"JSSymbolData::GetVolRateData",Explain:"分时量比数据(成交量)",Request:{Url:i.KLineApiUrl,Type:"POST",Data:{symbol:i.Symbol,dayCount:r,field:["name","symbol","vol"],period:0,right:0,dateRange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(o,(function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()})),1==o.PreventDefault)return}io.HttpRequest({url:i.KLineApiUrl,data:{field:["name","symbol","vol"],symbol:i.Symbol,start:-1,count:r},type:"post",dataType:"json",async:!0,success:function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}})},this.RecvVolRateData=function(t,e){var a=0,i=0,r=new Map;if(2==t.Ver){if(!sa.IsNonEmptyArray(t.data))return;for(var n=0;n<t.data.length;++n){var o=t.data[n];sa.IsNonEmptyArray(o)&&(o.length<2||sa.IsNumber(o[0])&&sa.IsPlusNumber(o[1])&&r.set(o[0],{AvgVol5:o[1]}))}}else{if(!sa.IsNonEmptyArray(t.data))return;var s=241;sa.IsNumber(t.minutecount)&&(s=t.minutecount);n=0;for(var h=0,l=0;n<t.data.length;++n){for(a=0,h=n,l=0;h>=0&&l<5;--h,++l){o=t.data[h];sa.IsNumber(o[6])&&(a+=o[6])}if(l>0){i=a/l/s;o=t.data[n];r.set(o[0],{AvgVol5:i})}}}r.size>0&&this.ExtendData.set(e,r),u.Complier.Log("[JSSymbolData::RecvVolRateData]",r)},this.GetVolRateCacheData=function(t){var e=fn.JOB_DOWNLOAD_VOLR_DATA.toString()+"-VolRate-"+this.Symbol;e&&this.ExtendData.has(e)||this.Execute.ThrowUnexpectedNode(t,"不支持VOLR");for(var a=[],i=this.ExtendData.get(e),r=0,n=0,o=null,s=0,h=0;s<this.Data.Data.length;++s){a[s]=null;var l=this.Data.Data[s];if(n!=l.Date){if(o=null,h=0,r=0,i.has(l.Date)){var u=i.get(l.Date);o=u.AvgVol5}n=l.Date}null!=o&&(r+=l.Vol,a[s]=r/(h+1)/o*100,++h)}return a},this.GetIndexData=function(){if(this.IndexData)return this.Execute.RunNextJob();var t=this;if(dt.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var e=this.Data.GetDateRange(),a={Name:"JSSymbolData::GetIndexData",Explain:"大盘数据",Period:t.Period,Request:{Url:t.KLineApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol","up","down","stop","unchanged"],indexSymbol:"000001.sh",symbol:this.Symbol,period:this.Period,dateRange:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvIndexHistroyData(e),t.Execute.RunNextJob()})),1==a.PreventDefault)return}io.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","up","down","stop","unchanged"],symbol:"000001.sh",start:-1,count:t.MaxRequestDataCount+500},type:"post",dataType:"json",async:!0,success:function(e){t.RecvIndexHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}else if(dt.IsMinutePeriod(this.Period,!0)){if(this.NetworkFilter){e=this.Data.GetDateRange(),a={Name:"JSSymbolData::GetIndexData",Explain:"大盘数据",Period:t.Period,Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol"],indexSymbol:"000001.sh",symbol:this.Symbol,period:this.Period,dateRange:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvIndexMinuteHistroyData(e),t.Execute.RunNextJob()})),1==a.PreventDefault)return}io.HttpRequest({url:t.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:"000001.sh",start:-1,count:t.MaxRequestMinuteDayCount+5},type:"post",dataType:"json",async:!0,success:function(e){t.RecvIndexMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}},this.RecvIndexHistroyData=function(t){u.Complier.Log("[JSSymbolData::RecvIndexHistroyData] recv data",t);var e=this.JsonDataToHistoryData(t);if(this.IndexData=new dt,this.IndexData.DataType=0,this.IndexData.Data=e,1==this.IsApiPeriod)this.IndexData.Period=this.Period,this.IndexData.Data=this.Data.FixKData(e,this.Period);else{var a=this.SourceData.GetOverlayData(this.IndexData.Data);if(this.IndexData.Data=a,dt.IsDayPeriod(this.Period,!1)){var i=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=i}}},this.RecvIndexMinuteHistroyData=function(t){u.Complier.Log("[JSSymbolData::RecvIndexMinuteHistroyData] recv data",t);var e=this.JsonDataToMinuteHistoryData(t);if(this.IndexData=new dt,this.IndexData.DataType=1,this.IndexData.Data=e,1==this.IsApiPeriod)this.IndexData.Period=this.Period,this.IndexData.Data=this.Data.FixKData(e,this.Period);else if(dt.IsMinutePeriod(this.Period,!1)){var a=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=a}},this.GetOtherSymbolParam=function(t){var e=t.split("$"),a=new Set(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(!a.has(e[1]))return null;var i=e[0];if(6==i.length)"6"==i[0]||"5"==i[0]||"8"==i[0]||"9"==i[0]?i+=".SH":"0"!=i[0]&&"1"!=i[0]&&"2"!=i[0]&&"3"!=i[0]||(i+=".SZ");else if(0==i.indexOf("SZ"))i=i.substr(2)+".SZ";else if(0==i.indexOf("SH"))i=i.substr(2)+".SH";else{if(!(i.indexOf("_")>0))return null;var r=i.split("_");i="".concat(r[1],".").concat(r[0])}return{Symbol:i.toLowerCase(),DataName:e[1]}},this.GetOtherSymbolData=function(t){var e=this.Symbol;if(t.Literal){var a=this.GetOtherSymbolParam(t.Literal.toUpperCase());if(!a){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.Literal," Error."))}e=a.Symbol}else{a=t.Args;if(a.length>0){var r=a[0];if(r.Type==on.Literal)e=r.Value;else if(r.Type==on.Identifier){var n=!1;for(var o in this.Arguments){var s=this.Arguments[o];if(s.Name==r.Name){e=s.Value,n=!0;break}}if(!n){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: can't read ").concat(r.Name))}}}}if(t.Symbol=e.toLowerCase(),t.Symbol==this.Symbol)return this.Execute.RunNextJob();if(this.OtherSymbolData.has(t.Symbol))return this.Execute.RunNextJob();var h=this;if(this.DataType==Sn.KLINE_ID&&dt.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var l=this.Data.GetDateRange(),u={Name:"JSSymbolData::GetOtherSymbolData",Explain:"指定个股数据",Request:{Data:{symbol:t.Symbol,right:h.Right,period:h.Period,dateRange:l}},Self:this,PreventDefault:!1};if(this.NetworkFilter(u,(function(e){h.RecvOtherSymbolKData(e,t),h.Execute.RunNextJob()})),1==u.PreventDefault)return}io.HttpRequest({url:h.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:h.MaxRequestDataCount+500},type:"post",dataType:"json",async:!0,success:function(e){h.RecvOtherSymbolKDayData(e,t),h.Execute.RunNextJob()},error:function(t){h.RecvError(t)}})}else if(dt.IsMinutePeriod(this.Period,!0)||this.DataType==Sn.MINUTE_ID||this.DataType==Sn.MULTIDAY_MINUTE_ID){if(this.NetworkFilter){l=this.Data.GetDateRange(),u={Name:"JSSymbolData::GetOtherSymbolData",Explain:"指定个股数据",Request:{Data:{symbol:t.Symbol,right:h.Right,period:h.Period,dateRange:l}},Self:this,PreventDefault:!1};if(this.NetworkFilter(u,(function(e){h.RecvOtherSymbolKData(e,t),h.Execute.RunNextJob()})),1==u.PreventDefault)return}io.HttpRequest({url:h.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:h.MaxRequestMinuteDayCount+5},type:"post",dataType:"json",async:!0,success:function(e){h.RecvOtherSymbolKMinuteData(e,t),h.Execute.RunNextJob()},error:function(t){h.RecvError(t)}})}},this.RecvOtherSymbolKData=function(t,e){u.Complier.Log("[JSSymbolData::RecvOtherSymbolKData] recv data",t);var a=new dt,i=null,r=this.Period;this.DataType==Sn.KLINE_ID&&dt.IsDayPeriod(this.Period,!0)?(i=this.JsonDataToHistoryData(t),a.DataType=0):(i=this.JsonDataToMinuteHistoryData(t),a.DataType=1,this.DataType!=Sn.MINUTE_ID&&this.DataType!=Sn.MULTIDAY_MINUTE_ID||(r=4)),a.Period=this.Period,a.Right=this.Right,a.Data=this.Data.FixKData(i,r),this.OtherSymbolData.set(e.Symbol,a)},this.RecvOtherSymbolKDayData=function(t,e){u.Complier.Log("[JSSymbolData::RecvOtherSymbolKDayData] recv data",t);var a=this.JsonDataToHistoryData(t),i=new dt;i.DataType=0,i.Data=a;var r=this.SourceData.GetOverlayData(i.Data);if(i.Data=r,dt.IsDayPeriod(this.Period,!1)){var n=i.GetPeriodData(this.Period);i.Data=n}this.OtherSymbolData.set(e.Symbol,i)},this.RecvOtherSymbolKMinuteData=function(t,e){u.Complier.Log("[JSSymbolData::RecvOtherSymbolKMinuteData] recv data",t);var a=this.JsonDataToMinuteHistoryData(t),i=new dt;if(i.DataType=1,i.Data=a,dt.IsMinutePeriod(this.Period,!1)){var r=i.GetPeriodData(this.Period);i.Data=r}this.OtherSymbolData.set(e.Symbol,i)},this.GetOtherSymolCacheData=function(t){var e,a;if(t.FunctionName){a=t.FunctionName;var i=t.Args;if(i.length<=0)return this.GetSymbolCacheData(a);e=i[0].toString().toLowerCase()}else if(t.Literal){i=this.GetOtherSymbolParam(t.Literal.toUpperCase());if(!i)return[];e=i.Symbol,a=i.DataName}if(e==this.Symbol)return this.GetSymbolCacheData(a);if(!this.OtherSymbolData.has(e))return[];var r=this.OtherSymbolData.get(e),n=e.toUpperCase();switch(a){case"CLOSE":case"C":return r.GetClose();case"VOL":case"V":return r.GetVol(Pr.GetVolUnit(n));case"OPEN":case"O":return r.GetOpen();case"HIGH":case"H":return r.GetHigh();case"LOW":case"L":return r.GetLow();case"AMOUNT":case"AMO":return r.GetAmount();case"VOLINSTK":return r.GetPosition()}},this.GetIndexCacheData=function(t){if(!this.IndexData)return new Array;switch(t){case"INDEXA":return this.IndexData.GetAmount();case"INDEXC":return this.IndexData.GetClose();case"INDEXH":return this.IndexData.GetHigh();case"INDEXL":return this.IndexData.GetLow();case"INDEXO":return this.IndexData.GetOpen();case"INDEXV":return this.IndexData.GetVol();case"INDEXADV":return this.IndexData.GetUp();case"INDEXDEC":return this.IndexData.GetDown()}},this.GetBlockSymbol=function(t){var e=new Map([["沪深A股","CNA.ci"],["创业板","GEM.ci"],["沪市A股","SHA.ci"],["中小板","SME.ci"],["深市A股","SZA.ci"]]);if(e.has(t))return e.get(t);if(!t)return null;var a=null,i=t.toUpperCase();if(i.indexOf(".SH")>0||i.indexOf(".SZ")>0){var r=new Set(["000001.SH","000003.SH","000016.SH","000300.SH","000905.SH","399001.SZ"," 399005.SZ","399006.SZ"]);if(!r.has(i))return null;a=t.replace(".SH",".sh"),a=t.replace(".SZ",".sz")}else t.indexOf(".CI")>0&&(a=t.replace(".CI",".ci"));return a},this.GetIndexIncreaseData=function(t){var e=null;if(t.IsSelfSymbol)e=this.Symbol;else{if(!t.Args||t.Args.length<=0){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"".concat(t.FunctionName," Error: 参数不能为空"))}e=t.Args[0].Value}var i=this.GetBlockSymbol(e);if(!i){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"".concat(t.FunctionName," Error: can't support ").concat(e))}var r=t.ID.toString()+"-UpCount-"+i,n=t.ID.toString()+"-DownCount-"+i;if(this.ExtendData.has(r)&&this.ExtendData.has(n))return this.Execute.RunNextJob();var o=this;if(this.NetworkFilter){var s={Type:this.DataType};this.DataType===Sn.KLINE_ID&&(s.Period=this.Period);var h=this.Data.GetDateRange(),l={Name:"JSSymbolData::GetIndexIncreaseData",Explain:"涨停家数统计",DateRange:h,DataType:s,Request:{Url:"数据地址",Type:"POST",Data:{symbol:this.Symbol,blocksymbol:i,field:["up","down"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(l,(function(t){this.DataType===Sn.KLINE_ID?this.RecvHistoryIncreaseDataV2(t,{UpKey:r,DownKey:n}):this.RecvMinuteIncreaseDataV2(t,{UpKey:r,DownKey:n}),o.Execute.RunNextJob()})),1==l.PreventDefault)return}if(this.DataType===Sn.MINUTE_ID||this.DataType===Sn.MULTIDAY_MINUTE_ID){var C=Qr.CacheDomain+"/cache/analyze/increaseanalyze/"+i+".json";u.Complier.Log("[JSSymbolData::GetIndexIncreaseData] minute Get url=",C),io.HttpRequest({url:C,type:"get",dataType:"json",async:!0,success:function(t){o.RecvMinuteIncreaseData(t,{UpKey:r,DownKey:n}),o.Execute.RunNextJob()},error:function(t){o.RecvError(t)}})}else this.DataType===Sn.KLINE_ID&&dt.IsDayPeriod(this.Period,!0)?(u.Complier.Log("[JSSymbolData::GetIndexIncreaseData] K day Get url=",o.KLineApiUrl),io.HttpRequest({url:o.KLineApiUrl,data:{symbol:i,start:-1,count:o.MaxRequestDataCount,field:["up","down"]},type:"post",dataType:"json",async:!0,success:function(t){o.RecvHistoryIncreaseData(t,{UpKey:r,DownKey:n}),o.Execute.RunNextJob()},error:function(t){o.RecvError(t)}})):this.Execute.RunNextJob()},this.RecvHistoryIncreaseDataV2=function(t,e){u.Complier.Log("[JSSymbolData::RecvHistoryIncreaseData] recv data, key",t,e);var a=[],i=[];for(var r in t.data){var n=t.data[r],o=new Dt,s=new Dt,h=n[0],l=null;o.Date=h,s.Date=h,dt.IsMinutePeriod(this.Period,!0)&&sa.IsNumber(n[1])&&(l=n[1],o.Time=l,s.Time=l),o.Value=n[2],a[r]=o,s.Value=n[3],i[r]=s}var C=this.Data.GetFittingData2(a,0),D=this.Data.GetFittingData2(i,0);this.ExtendData.set(e.UpKey,C),this.ExtendData.set(e.DownKey,D)},this.RecvHistoryIncreaseData=function(t,e){u.Complier.Log("[JSSymbolData::RecvHistoryIncreaseData] recv data",t);var a,i,r=[],n=[];for(var o in t.data){var s=t.data[o],h=new Dt,l=new Dt;h.Date=s[0],h.Value=s[8],r[o]=h,l.Date=s[0],l.Value=s[9],n[o]=l}a=this.SourceData?this.SourceData.GetFittingData(r):this.Data.GetFittingData(aryData),i=this.SourceData?this.SourceData.GetFittingData(n):this.Data.GetFittingData(aryData),this.ExtendData.set(e.UpKey,a),this.ExtendData.set(e.DownKey,i)},this.RecvMinuteIncreaseDataV2=function(t,e){u.Complier.Log("[JSSymbolData::RecvMinuteIncreaseDataV2] recv data, key",t,e)},this.RecvMinuteIncreaseData=function(t,e){if(u.Complier.Log("[JSSymbolData::RecvMinuteIncreaseData] recv data",t),t.minute){var a=t.minute;if(a.time&&a.up&&a.down){var i=[],r=[];if(this.IsBeforeData)for(var n=0,o=0;n<this.Data.Data.length;++n){i[n]=null,r[n]=null;var s=this.Data.Data[n];if(!s.Before){var h=s.DateTime;if(h){var l=h.split(" ");if(2==l.length){var C=parseInt(l[0]);C==t.date&&(i[n]=a.up[o],r[n]=a.down[o],++o)}}}}else for(n=0,o=0;n<this.Data.Data.length;++n){i[n]=null,r[n]=null;s=this.Data.Data[n],h=s.DateTime;if(h){l=h.split(" ");if(2==l.length){C=parseInt(l[0]);C==t.date&&(i[n]=a.up[o],r[n]=a.down[o],++o)}}}this.ExtendData.set(e.UpKey,i),this.ExtendData.set(e.DownKey,r)}}},this.GetIndexIncreaseCacheData=function(t,e,a){var i,r=this.GetBlockSymbol(e);if(r||this.Execute.ThrowUnexpectedNode(a,"不支持函数"+t+"("+e+")"),"UPCOUNT"==t||"ADVANCE"==t?i=fn.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-UpCount-"+r:"DOWNCOUNT"!=t&&"DECLINE"!=t||(i=fn.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-DownCount-"+r),i&&this.ExtendData.has(i)||this.Execute.ThrowUnexpectedNode(a,"不支持函数"+t+"("+e+")"),this.DataType===Sn.MINUTE_ID||this.DataType===Sn.MULTIDAY_MINUTE_ID)return this.ExtendData.get(i);if(this.DataType===Sn.KLINE_ID&&dt.IsDayPeriod(this.Period,!0)){var n=this.ExtendData.get(i),o=new dt;if(o.Data=n,o.Period=this.Period,o.Period>0){var s=o.GetPeriodSingleData(o.Period);o.Data=s}return o.GetValue()}return null},this.GetSymbolData=function(){if(this.Data)return this.Execute.RunNextJob();var t=this;if(this.DataType!==Sn.MINUTE_ID)if(this.DataType!==Sn.MULTIDAY_MINUTE_ID){if(dt.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var e={Name:"JSSymbolData::GetSymbolData",Explain:"日线数据",Request:{Url:t.RealtimeApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount,period:this.Period,right:this.Right}},Self:this,PreventDefault:!1};if(this.KLineDateTimeRange&&(e.Request.KLineDataTimeRange={Start:{Date:this.KLineDateTimeRange.Start.Date},End:{Date:this.KLineDateTimeRange.End.Date}},this.IsNumber(this.KLineDateTimeRange.Start.Time)&&(e.Request.KLineDataTimeRange.Start.Time=this.KLineDateTimeRange.Start.Time),this.IsNumber(this.KLineDateTimeRange.End.Time)&&(e.Request.KLineDataTimeRange.End.Time=this.KLineDateTimeRange.End.Time)),this.NetworkFilter(e,(function(e){t.RecvHistroyData(e),t.Execute.RunNextJob()})),1==e.PreventDefault)return}io.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(e){t.RecvHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}else if(dt.IsMinutePeriod(this.Period,!0)||dt.IsSecondPeriod(this.Period)||dt.IsMilliSecondPeriod(this.Period)){if(this.NetworkFilter){e={Name:"JSSymbolData::GetSymbolData",Explain:"分钟K线数据",Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount,period:this.Period,right:this.Right}},Self:this,PreventDefault:!1};if(this.KLineDateTimeRange&&(e.Request.KLineDataTimeRange={Start:{Date:this.KLineDateTimeRange.Start.Date},End:{Date:this.KLineDateTimeRange.End.Date}},this.IsNumber(this.KLineDateTimeRange.Start.Time)&&(e.Request.KLineDataTimeRange.Start.Time=this.KLineDateTimeRange.Start.Time),this.IsNumber(this.KLineDateTimeRange.End.Time)&&(e.Request.KLineDataTimeRange.End.Time=this.KLineDateTimeRange.End.Time)),this.NetworkFilter(e,(function(e){t.RecvMinuteHistroyData(e),t.Execute.RunNextJob()})),1==e.PreventDefault)return}io.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}}else io.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMultiDayMinuteData(e),t.Execute.RunNextJob()}});else io.HttpRequest({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","minute","time","minutecount"],symbol:[t.Symbol],start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMinuteData(e),t.Execute.RunNextJob()}})},this.RecvHistroyData=function(t){u.Complier.Log("[JSSymbolData::RecvHistroyData] recv data",t);var e=this.JsonDataToHistoryData(t);if(this.Data=new dt,this.Data.DataType=0,this.Data.Data=e,this.SourceData=new dt,this.SourceData.Data=e,this.IsApiPeriod);else{if(this.Right>0){var a=this.Data.GetRightData(this.Right);this.Data.Data=a}if(dt.IsDayPeriod(this.Period,!1)){var i=this.Data.GetPeriodData(this.Period);this.Data.Data=i}}this.Data.Right=this.Right,this.Data.Period=this.Period,this.Name=t.name},this.RecvMinuteHistroyData=function(t){u.Complier.Log("[JSSymbolData::RecvMinuteHistroyData] recv data",t);var e=this.JsonDataToMinuteHistoryData(t);if(this.Data=new dt,this.Data.DataType=1,this.Data.Data=e,this.SourceData=new dt,this.SourceData.Data=e,this.IsApiPeriod);else if(dt.IsMinutePeriod(this.Period,!1)){var a=this.Data.GetPeriodData(this.Period);this.Data.Data=a}this.Data.Period=this.Period,this.Name=t.name},this.RecvMinuteData=function(t){u.Complier.Log("[JSSymbolData::RecvMinuteData] recv data",t);var e=this.JsonDataToMinuteData(t);this.Data=new dt,this.Data.DataType=2,this.Data.Data=e,this.Name=t.stock[0].name},this.RecvMultiDayMinuteData=function(t){var e=this.JsonDataToMultiDayMinuteData(t);this.Data=new dt,this.Data.DataType=2,this.Data.Data=e,this.Name=t.name},this.GetSymbolCacheData=function(t){if(!this.Data)return new Array;var e=this.Symbol.toUpperCase();switch(t){case"CLOSE":case"C":return this.Data.GetClose();case"VOL":case"V":return this.Data.GetVol(Pr.GetVolUnit(e));case"OPEN":case"O":return this.Data.GetOpen();case"HIGH":case"H":return this.Data.GetHigh();case"LOW":case"L":return this.Data.GetLow();case"AMOUNT":case"AMO":return this.Data.GetAmount();case"OPI":case"VOLINSTK":return this.Data.GetPosition();case"ZSTJJ":return this.Data.GetAvPrice();case"SETTLE":case"QHJSJ":return this.Data.GetSettlementPrice();case"ISEQUAL":return this.Data.GetIsEqual();case"ISUP":return this.Data.GetIsUp();case"ISDOWN":return this.Data.GetIsDown()}},this.GetSymbolPeriodData=function(t){var e=en.GetPeriodInfo({Name:t.PeriodName}).Period,a={PeriodID:e,PeriodName:t.PeriodName};if(e==this.Period&&this.Execute.RunNextJob(),this.IsApiPeriod){if(this.PeriodData.has(t.PeriodName))return this.Execute.RunNextJob()}else if(dt.IsDayPeriod(e,!0)){if(dt.IsDayPeriod(this.Period,!0))return this.Execute.RunNextJob();a={PeriodID:0,PeriodName:"DAY"}}else{if(!dt.IsMinutePeriod(e,!0))return this.Execute.RunNextJob();if(dt.IsMinutePeriod(this.Period,!0))return this.Execute.RunNextJob();a={PeriodID:4,PeriodName:"MIN1"}}var i=this;if(this.NetworkFilter){var r={Name:"JSSymbolData::GetSymbolPeriodData",Explain:"跨周期数据",Request:{Data:{field:["symbol","name",t.ValueName],period:t.PeriodName,symbol:i.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){i.RecvSymbolPeriodData(t,a),i.Execute.RunNextJob()})),1==r.PreventDefault)return}if(dt.IsMinutePeriod(e,!0))io.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:i.Symbol,start:-1,count:i.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(t){i.RecvSymbolPeriodData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}});else{if(!dt.IsDayPeriod(e,!0))return this.Execute.RunNextJob();io.HttpRequest({url:i.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:i.Symbol,start:-1,count:i.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){i.RecvSymbolPeriodData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}})}},this.RecvSymbolPeriodData=function(t,e){if(u.Complier.Log("[JSSymbolData::RecvSymbolPeriodData] data, periodInfo ",t,e),dt.IsDayPeriod(e.PeriodID,!0)){var a=this.JsonDataToHistoryData(t),i=new dt;i.DataType=0,i.Data=a,i.Right=0,i.Period=e.PeriodID,this.PeriodData.set(e.PeriodName,i)}else if(dt.IsMinutePeriod(e.PeriodID,!0)){a=this.JsonDataToMinuteHistoryData(t);var r=new dt;r.DataType=1,r.Data=a,r.Right=0,r.Period=e.PeriodID,this.PeriodData.set(e.PeriodName,r)}},this.GetSymbolPeriodCacheData=function(t,e){var a=en.GetPeriodInfo({Name:e});if(this.Period==a.Period)return this.GetSymbolCacheData(t);var i=null;if(this.IsApiPeriod){var r=en.GetPeriodInfo({PeriodID:this.Period});if(!r)return null;if(r.Order>a.Order)return null;if(!this.PeriodData.has(e))return null;i=this.PeriodData.get(e),i=i.Data}else{r=en.GetPeriodInfo({PeriodID:this.Period});if(!r)return null;if(r.Order>a.Order)return null;if(dt.IsDayPeriod(a.Period,!0)&&dt.IsMinutePeriod(this.Period,!0)){var n=this.PeriodData.get("DAY");i=0==a.Period?n.Data:n.GetPeriodData(a.Period)}else{var o=new dt;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,dt.IsDayPeriod(a.Period,!0)&&o.Right>0){var s=o.GetRightData(o.Right);o.Data=s}i=o.GetPeriodData(a.Period)}}var h=this.Data.ConverPeriod(i,this.Period,a.Period),l=new dt;l.Data=h;var u=this.Symbol.toUpperCase();switch(t){case"C":case"CLOSE":return l.GetClose();case"O":case"OPEN":return l.GetOpen();case"H":case"HIGH":return l.GetHigh();case"L":case"LOW":return l.GetLow();case"AMO":case"AMOUNT":return l.GetAmount();case"V":case"VOL":return l.GetVol(Pr.GetVolUnit(u));case"VOLINSTK":return l.GetPosition();default:return null}},this.GetSymbolPeriodCacheData2=function(t,e,a){var i=en.GetPeriodInfo({Name:e});if(!i)return null;var r=en.GetPeriodInfo({PeriodID:this.Period});if(!r)return null;if(r.Order>i.Order)return null;if(r.Period==i.Period)u=this.Data;else{var n;if(this.IsApiPeriod){if(!this.PeriodData.has(e))return null;n=this.PeriodData.get(e)}else if(dt.IsMinutePeriod(r.Period,!0)&&dt.IsDayPeriod(i.Period,!0)){var o=this.PeriodData.get("DAY");n=0==i.Period?o:o.GetPeriodData(i.Period)}else{var s=new dt;if(s.Data=this.SourceData.Data,s.Period=this.Period,s.Right=this.Right,dt.IsDayPeriod(i.Period,!0)&&s.Right>0){var h=s.GetRightData(s.Right);s.Data=h}n=s.GetPeriodData(i.Period)}var l=this.Data.ConverPeriod(n,this.Period,i.Period),u=new dt;u.Data=l}if(sa.IsPlusNumber(a)){var C=new dt;l=u.GetRef(a);C.Data=l,u=C}var D=this.Symbol.toUpperCase();switch(t){case"C":case"CLOSE":return u.GetClose();case"O":case"OPEN":return u.GetOpen();case"H":case"HIGH":return u.GetHigh();case"L":case"LOW":return u.GetLow();case"AMO":case"AMOUNT":return u.GetAmount();case"V":case"VOL":return u.GetVol(Pr.GetVolUnit(D));case"VOLINSTK":return u.GetPosition();default:return null}},this.GetCurrBarsCount=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=e-1;a>=0;--a)t.push(a+1);return t},this.GetBarPos=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)t.push(a+1);return t},this.GetTotalTradeMinuteCount=function(){var t=Vr.GetCoordinateData(this.Symbol);return t&&t.Count>0?t.Count-1:242},this.GetTotalBarsCount=function(){var t=this.Data.Data.length;return t},this.GetIsLastBar=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)a==e-1?t.push(1):t.push(0);return t},this.GetBarStatus=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)t[a]=0==a?1:a==e-1?2:0;return t},this.GetTRData=function(t){var e=[];if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return e;for(var a=this.Data.Data.length,i=0;i<a;++i){var r=this.Data.Data[i],n=null;if(sa.IsNumber(r.High)&&sa.IsNumber(r.Low)){var o=Math.abs(r.High-r.Low);(null==n||n<o)&&(n=o)}if(sa.IsNumber(r.High)&&sa.IsNumber(r.YClose)){o=Math.abs(r.High-r.YClose);(null==n||n<o)&&(n=o)}if(sa.IsNumber(r.YClose)&&sa.IsNumber(r.Low)){o=Math.abs(r.Low-r.YClose);(null==n||n<o)&&(n=o)}e[i]=n}return e},this.GetMarginCacheData=function(t,e){var a=fn.GetMarginJobID(t);return a||this.Execute.ThrowUnexpectedNode(e,"不支持MARGIN("+t+")"),this.MarginData.has(a)?this.MarginData.get(a):[]},this.GetMarginData=function(t){if(this.MarginData.has(t))return this.Execute.RunNextJob();u.Complier.Log("[JSSymbolData::GetMarginData] jobID=",t);var e=this,a=["name","date","symbol"];switch(t){case fn.JOB_DOWNLOAD_MARGIN_BALANCE:a.push("margin.balance");break;case fn.JOB_DOWNLOAD_MARGIN_RATE:a.push("margin.rate");break;case fn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case fn.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case fn.JOB_DOWNLOAD_MARGIN_BUY_NET:a.push("margin.buy");break;case fn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case fn.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case fn.JOB_DOWNLOAD_MARGIN_SELL_NET:a.push("margin.sell");break}io.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:a,symbol:[this.Symbol],orderfield:"date"},type:"post",dataType:"json",async:!0,success:function(a){e.RecvMarginData(a,t),e.Execute.RunNextJob()}})},this.RecvMarginData=function(t,e){if(u.Complier.Log(t),t.stock&&1==t.stock.length){var a=t.stock[0],i=new Array,r=[],n=[],o=[];for(var s in a.stockday){var h=a.stockday[s],l=h.margin;if(l){var C=new Dt;switch(C.Date=h.date,e){case fn.JOB_DOWNLOAD_MARGIN_BALANCE:if(!this.IsNumber(l.balance))continue;C.Value=l.balance,i.push(C);break;case fn.JOB_DOWNLOAD_MARGIN_RATE:if(!this.IsNumber(l.rate))continue;C.Value=l.rate,i.push(C);break;case fn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case fn.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case fn.JOB_DOWNLOAD_MARGIN_BUY_NET:var D=l.buy;if(!D)continue;if(!this.IsNumber(D.balance)||!this.IsNumber(D.amount)||!this.IsNumber(D.repay)||!this.IsNumber(D.net))continue;C.Value=D.balance;var f=new Dt;f.Date=h.date,f.Value=D.amount;var c=new Dt;c.Date=h.date,c.Value=D.repay;var m=new Dt;m.Date=h.date,m.Value=D.net,i.push(C),r.push(f),n.push(c),o.push(m);break;case fn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case fn.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case fn.JOB_DOWNLOAD_MARGIN_SELL_NET:var d=l.sell;if(!d)continue;if(!this.IsNumber(d.balance)||!this.IsNumber(d.volume)||!this.IsNumber(d.repay)||!this.IsNumber(d.net))continue;C.Value=D.balance;f=new Dt;f.Date=h.date,f.Value=D.volume;c=new Dt;c.Date=h.date,c.Value=D.repay;m=new Dt;m.Date=h.date,m.Value=D.net,i.push(C),r.push(f),n.push(c),o.push(m);break;default:continue}}}var I=[];for(var S in e===fn.JOB_DOWNLOAD_MARGIN_BALANCE||e===fn.JOB_DOWNLOAD_MARGIN_RATE?I.push({JobID:e,Data:i}):e===fn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE||e===fn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT||e===fn.JOB_DOWNLOAD_MARGIN_BUY_REPAY||e===fn.JOB_DOWNLOAD_MARGIN_BUY_NET?(I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE,Data:i}),I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT,Data:r}),I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_BUY_REPAY,Data:n}),I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_BUY_NET,Data:o})):e!==fn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE&&e!==fn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME&&e!==fn.JOB_DOWNLOAD_MARGIN_SELL_REPAY&&e!==fn.JOB_DOWNLOAD_MARGIN_SELL_NET||(I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE,Data:i}),I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME,Data:r}),I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_SELL_REPAY,Data:n}),I.push({JobID:fn.JOB_DOWNLOAD_MARGIN_SELL_NET,Data:o})),I){var T=this.SourceData.GetFittingData(I[S].Data),v=new dt;if(v.Data=T,v.Period=this.Period,v.Period>0){var p=v.GetPeriodSingleData(v.Period);v.Data=p}var g=v.GetValue();this.MarginData.set(I[S].JobID,g)}}},this.GetNewsAnalysisCacheData=function(t,e){var a=fn.GetNewsAnalysisID(t);return a||this.Execute.ThrowUnexpectedNode(e,"不支持NEWS("+t+")"),this.NewsAnalysisData.has(a)?this.NewsAnalysisData.get(a):[]},this.GetHKToSHSZData=function(t){var e=t.Args,a=this.Symbol;if(e.length>0){var i=e[0];if(i.Type==on.Literal)a=i.Value;else if(i.Type==on.Identifier){var r=!1;for(var n in this.Arguments){var o=this.Arguments[n];if(o.Name==i.Name){a=o.Value,r=!0;break}}if(!r){var s=t.Token;this.Execute.ErrorHandler.ThrowError(s.Index,s.Line,0,"HK2SHSZ() Error: can't read ".concat(i.Name))}}}t.Symbol=a,1==a||2==a||3==a?this.GetHKToSHSZMarketData(a,t):this.GetHKToSHSZStockData(a,t)},this.GetHKToSHSZStockData=function(t,e){if(this.HKToSHSZData.has(t))return this.Execute.RunNextJob();var a=t.toLowerCase(),i=this,r="".concat(this.HKToSHSZApiUrl[3],"/").concat(a,".json");io.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(t){i.RecvHKToSHSZStockData(t,e),i.Execute.RunNextJob()},error:function(t){console.warn("[JSSymbolData::GetHKToSHSZStockData] request url=".concat(r," failed. error=").concat(t.status)),i.RecvHKToSHSZStockData(null,e),i.Execute.RunNextJob()}})},this.RecvHKToSHSZStockData=function(t,e){if(t){for(var a=t.symbol,i=a.toUpperCase(),r=[],n=0;n<t.date.length;++n){var o=new Dt;o.Date=t.date[n],o.Value=t.vol[n],r.push(o)}var s=this.Data.GetFittingData(r),h=new dt;if(h.Data=s,h.Period=this.Period,h.Period>0){var l=h.GetPeriodSingleData(h.Period);h.Data=l}t=h.GetValue();this.HKToSHSZData.set(i,t)}},this.GetHKToSHSZMarketData=function(t,e){if(this.HKToSHSZData.has(t))return this.Execute.RunNextJob();var a,i=0;this.DataType===Sn.MINUTE_ID?i=1:this.DataType==Sn.MULTIDAY_MINUTE_ID?i=2:this.Period<=3&&(i=0),a=this.HKToSHSZApiUrl[i];var r=this;u.Complier.Log("[JSSymbolData::GetHKToSHSZMarketData] code=".concat(t," url=").concat(a,", dataType=").concat(i)),2===i?io.HttpRequest({url:a,data:{symbol:this.Symbol,daycount:this.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(t){r.RecvMulitMinuteHKToSHSZData(t,e),r.Execute.RunNextJob()}}):io.HttpRequest({url:a,type:"get",dataType:"json",async:!0,success:function(t){0==i?r.RecvHKToSHSZData(t,e):1==i&&r.RecvMinuteHKToSHSZData(t,e),r.Execute.RunNextJob()}})},this.RecvMinuteHKToSHSZData=function(t,e){var a=[],i=[],r=[];if(this.IsBeforeData){for(o in this.SourceData.Data){var n=this.SourceData.Data[o];if(!n.Before)break;a.push(null),i.push(null),r.push(null)}for(var o=0;o<t.time.length;++o){var s=t.time[o];if(925!==s){var h=t.hk2sh[o],l=t.hk2sz[o],u=h+l;a.push(u),i.push(h),r.push(l)}}}else for(o=0;o<t.time.length;++o){s=t.time[o],h=t.hk2sh[o],l=t.hk2sz[o],u=h+l;a.push(u),i.push(h),r.push(l)}var C=[{Data:a,ID:1},{Data:i,ID:2},{Data:r,ID:3}];for(var o in C){n=C[o];this.HKToSHSZData.set(n.ID,n.Data)}},this.RecvHKToSHSZData=function(t,e){for(var a=[],i=[],r=[],n=0;n<t.date.length;++n){var o=t.date[n],s=1e6*t.hk2sh[n],h=1e6*t.hk2sz[n],l=s+h,u=new Dt;u.Date=o,u.Value=l;var C=new Dt;C.Date=o,C.Value=s;var D=new Dt;D.Date=o,D.Value=h,a.push(u),i.push(C),r.push(D)}var f=[{Data:a,ID:1},{Data:i,ID:2},{Data:r,ID:3}];for(var c in f){var m=this.Data.GetFittingData(f[c].Data),d=new dt;if(d.Data=m,d.Period=this.Period,d.Period>0){var I=d.GetPeriodSingleData(d.Period);d.Data=I}var S=d.GetValue();this.HKToSHSZData.set(f[c].ID,S)}},this.RecvMulitMinuteHKToSHSZData=function(t,e){if(t.data&&!(t.data.length<=0)){for(var a=[],i=[],r=[],n=0,o=0;n<this.Data.Data.length&&o<t.data.length;){a[n]=null,i[n]=null,r[n]=null;var s=this.Data.Data[n],h=s.DateTime;if(h){var l=h.split(" ");if(2==l.length){var u=parseInt(l[0]),C=t.data[o];if(!C.minute||C.minute.length<=0)++o;else if(C.date>u)++n;else if(C.date<u)++o;else{for(var D in C.minute){var f=C.minute[D],c=f[1],m=f[2],d=c+m;a[n]=d,i[n]=c,r[n]=m,++n}++o}}else++n}else++n}var I=[{Data:a,ID:1},{Data:i,ID:2},{Data:r,ID:3}];for(var n in I){s=I[n];this.HKToSHSZData.set(s.ID,s.Data)}}},this.GetHKToSHSZCacheData=function(t,e){return t||(t=this.Symbol),"string"==typeof t&&(t=t.toUpperCase()),this.HKToSHSZData.has(t)?this.HKToSHSZData.get(t):[]},this.GetNewsAnalysisData=function(t){if(this.NewsAnalysisData.has(t))return this.Execute.RunNextJob();var e=this,a=new Map([[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE,"negative"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH,"research"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT,"interact"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,"holderchange"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,"holderchange"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER,"trustholder"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING,"Blocktrading"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS,"companynews"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS,"topmanagers"],[fn.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE,"Pledge"]]);if(a.has(t)){var i=a.get(t),r=this.StockNewsAnalysisApiUrl+"/"+i+"/"+this.Symbol+".json";io.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(a){e.RecvNewsAnalysisData(a,t),e.Execute.RunNextJob()},error:function(a,i){e.RecvNewsAnalysisDataError(a,i,t),e.Execute.RunNextJob()}})}else this.Execute.RunNextJob()},this.RecvNewsAnalysisDataError=function(t,e,a){u.Complier.Log("[JSSymbolData::RecvNewsAnalysisDataError] ajax error.",t.status);for(var i=[],r=0;r<this.Data.Data.length;++r){var n=new Dt;n.Date=this.Data.Data[r].Date,n.Value=0,i.push(n)}var o=new dt;o.Data=i,this.NewsAnalysisData.set(a,o.GetValue())},this.RecvNewsAnalysisData=function(t,e){if(t.data&&t.date&&!(t.data.length<=0||t.data.length!=t.date.length))if(u.Complier.Log("[JSSymbolData::RecvNewsAnalysisData] jobID",e,t.update),e==fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE||e==fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2){for(var a=[],i=[],r=0;r<t.data.length;++r){var n=new Dt;n.Date=t.date[r],n.Value=t.data[r],this.IsNumber(n.Value)&&a.push(n),r<t.data2.length&&(n=new Dt,n.Date=t.date[r],n.Value=t.data2[r],this.IsNumber(n.Value)&&i.push(n))}var o=this.Data.GetFittingData2(a,0),s=new dt;s.Data=o,this.NewsAnalysisData.set(fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,s.GetValue()),o=this.Data.GetFittingData2(i,0),s=new dt,s.Data=o,this.NewsAnalysisData.set(fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,s.GetValue())}else{for(a=[],r=0;r<t.data.length;++r){n=new Dt;n.Date=t.date[r],n.Value=t.data[r],a.push(n)}var h=this.Data.GetFittingData2(a,0);s=new dt;s.Data=h,this.NewsAnalysisData.set(e,s.GetValue())}},this.GetSectionFinanceData=function(t){var e=t.SF[0],a=t.SF[1].Period;if(this.SectionFinanceData.has(e))return this.Execute.RunNextJob();u.Complier.Log("[JSSymbolData::GetSectionFinanceData] ".concat(a.Year,"-").concat(a.Quarter));var i="announcement"+a.Quarter,r=this,n=["name","date","symbol",i,"finance"+a.Quarter],o=[i+".year","int32","eq",a.Year.toString()];io.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:n,symbol:[this.Symbol],condition:[{item:o}]},type:"post",dataType:"json",async:!0,success:function(e){r.RecvSectionFinanceData(e,t),r.Execute.RunNextJob()}})},this.RecvSectionFinanceData=function(t,e){if(t.stock&&1==t.stock.length){var a=t.stock[0];if(a.stockday&&!(a.stockday.length<=0)){var i=a.stockday[0],r=e.SF[1].Period,n=null;if(1===r.Quarter?n=i.finance1:2===r.Quarter?n=i.finance2:3===r.Quarter?n=i.finance3:4===r.Quarter&&(n=i.finance4),n){t=new Map([[fn.JOB_DOWNLOAD_SECTION_F_01,n.currentassets],[fn.JOB_DOWNLOAD_SECTION_F_02,n.monetaryfunds],[fn.JOB_DOWNLOAD_SECTION_F_03,n.inventory],[fn.JOB_DOWNLOAD_SECTION_F_04,n.currentliabilities],[fn.JOB_DOWNLOAD_SECTION_F_05,n.ncurrentliabilities],[fn.JOB_DOWNLOAD_SECTION_F_06,n.expenses3],[fn.JOB_DOWNLOAD_SECTION_F_07,n.investmentincome],[fn.JOB_DOWNLOAD_SECTION_F_08,n.pcnprofit],[fn.JOB_DOWNLOAD_SECTION_F_09,n.nnetprofit],[fn.JOB_DOWNLOAD_SECTION_F_10,n.npersearning],[fn.JOB_DOWNLOAD_SECTION_F_11,n.woewa],[fn.JOB_DOWNLOAD_SECTION_F_12,n.inprocess],[fn.JOB_DOWNLOAD_SECTION_F_13,n.accdepreciation],[fn.JOB_DOWNLOAD_SECTION_F_14,n.mholderprofit],[fn.JOB_DOWNLOAD_SECTION_F_15,n.lossexchange],[fn.JOB_DOWNLOAD_SECTION_F_16,n.baddebts],[fn.JOB_DOWNLOAD_SECTION_F_17,n.fixedassets],[fn.JOB_DOWNLOAD_SECTION_F_18,n.curdepreciation],[fn.JOB_DOWNLOAD_SECTION_F_19,n.orevenues],[fn.JOB_DOWNLOAD_SECTION_F_20,n.moprofit],[fn.JOB_DOWNLOAD_SECTION_F_21,n.oprofit],[fn.JOB_DOWNLOAD_SECTION_F_22,n.nprofit],[fn.JOB_DOWNLOAD_SECTION_F_23,n.areceivable],[fn.JOB_DOWNLOAD_SECTION_F_24,n.financialcost],[fn.JOB_DOWNLOAD_SECTION_F_25,n.ccfo],[fn.JOB_DOWNLOAD_SECTION_F_26,n.totalassets],[fn.JOB_DOWNLOAD_SECTION_F_27,n.totalliabilities],[fn.JOB_DOWNLOAD_SECTION_F_28,n.totalownersequity],[fn.JOB_DOWNLOAD_SECTION_F_29,n.grossmargin],[fn.JOB_DOWNLOAD_SECTION_F_30,n.percreserve],[fn.JOB_DOWNLOAD_SECTION_F_31,n.peruprofit],[fn.JOB_DOWNLOAD_SECTION_F_32,n.persearning],[fn.JOB_DOWNLOAD_SECTION_F_33,n.pernetasset],[fn.JOB_DOWNLOAD_SECTION_F_34,n.perccfo],[fn.JOB_DOWNLOAD_SECTION_F_38,n.alratio],[fn.JOB_DOWNLOAD_SECTION_F_39,n.profityoy]]);4===r.Quarter&&(t.set(fn.JOB_DOWNLOAD_SECTION_F_35,n.nnprofitincrease),t.set(fn.JOB_DOWNLOAD_SECTION_F_36,n.nnprofitspeed),t.set(fn.JOB_DOWNLOAD_SECTION_F_37,n.nprofitincrease));var o=e.SF[0];this.SectionFinanceData.set(o,t)}}}},this.GetSectionFinanceCacheData=function(t,e,a,i){var r=fn.GetSectionReportPeriod(t,e);r||this.Execute.ThrowUnexpectedNode(i,"不支持FS(".concat(t,", ").concat(e,", '").concat(a,"') 报告期错误"));var n=fn.GetSectionFinanceID(a);n||this.Execute.ThrowUnexpectedNode(i,"不支持FS(".concat(t,", ").concat(e,",'").concat(a,"') 财务数据字段名称错误"));var o=r.Year+"-"+r.Quarter;if(!this.SectionFinanceData.has(o)&&!this.ThrowSFPeirod.has(o)){this.ThrowSFPeirod.add(o);var s={ID:fn.JOB_DOWNLOAD_SECTION_SF,SF:[o,{Period:r,Fields:new Set([n])}]};this.Execute.ThrowDownloadSF(i,s,"FS(".concat(t,", ").concat(e,", '").concat(a,"') 动态下载"))}if(!this.SectionFinanceData.has(o))return this.Execute.ThrowUnexpectedNode(i,"不支持FS(".concat(t,", ").concat(e,", '").concat(a,"') 没有这期财务数据"));var h=this.SectionFinanceData.get(o);return h.has(n)||this.Execute.ThrowUnexpectedNode(i,"不支持FS(".concat(t,", ").concat(e,", '").concat(a,"') 没有这期财务数据字段")),h.get(n)},this.GetStockDataKey=function(t,e){var a=t.FunctionName;if(e.length>0){a+="(";for(var i=0;i<e.length;++i)i>0&&(a+=","),a+=e[i].toString();a+=")"}return a},this.GetFinance=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),o={Name:"JSSymbolData::GetFinance",Explain:"财务数据FINANCE(ID)",JobID:t.ID,Request:{Url:r.RealtimeApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(o,(function(e){e.Error?r.AddStockValueError(i,e.Error):r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==o.PreventDefault)return}var s=new Ln({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});s.Download()},this.GetProFinance=function(t){for(var e=t.ID,a=null,i=0;i<cn.length;++i){var r=cn[i];if(r.JobID==e){a=r;break}}if(!a)return this.Execute.RunNextJob();var n=this.JobArgumentsToArray(t,a.ArgCount),o=this.GetStockDataKey(t,n);if(this.StockData.has(o))return this.Execute.RunNextJob();var s=this,h=0;if([fn.JOB_DOWNLOAD_GPJYVALUE,fn.JOB_DOWNLOAD_SCJYVALUE,fn.JOB_DOWNLOAD_BKJYVALUE].includes(e)&&(h=1==n[2]?0:2),this.NetworkFilter){var l=this.Data.GetDateRange(),C={Name:a.FuncName,Explain:a.Explain,JobID:e,Request:{Url:s.StockHistoryDayApiUrl,Type:"POST",Data:{Args:n,symbol:this.Symbol,daterange:l}},Self:this,PreventDefault:!1};if(this.NetworkFilter(C,(function(e){s.RecvStockValue(e,t,o,h),s.Execute.RunNextJob()})),1==C.PreventDefault)return}u.Chart.Warn("[JSSymbolData::GetProFinance] ".concat(a.FuncName," Not implemented."))},this.GetVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=this;if(this.NetworkFilter){var i=this.Data.GetDateRange(),r={Name:"JSSymbolData::GetVariantData",Explain:"变量数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:i}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(i){if(i.Error)a.AddStockValueError(e,i.Error);else{var r=0;sa.IsNumber(i.DataType)&&(r=i.DataType),a.RecvStockValue(i.Data,t,e,r,i)}a.Execute.RunNextJob()})),1==r.PreventDefault)return}var n,o=function(t){a.AddStockValueError(e,t)};if("CAPITAL"==t.VariantName||"TOTALCAPITAL"==t.VariantName||"EXCHANGE"==t.VariantName||"HSL"==t.VariantName){var s=function(t,e,i){a.RecvStockValue(t,e,i,0),a.Execute.RunNextJob()};n=new Ln({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:s,ErrorCallback:o})}else{if("HYBLOCK"!=t.VariantName&&"DYBLOCK"!=t.VariantName&&"GNBLOCK"!=t.VariantName){if("INBLOCK"==t.VariantName){var h="".concat(t.VariantName,", 请对接外部数据.");return this.AddStockValueError(e,h),void this.Execute.RunNextJob()}h="不支持变量".concat(t.VariantName,", 请对接外部数据.");return this.AddStockValueError(e,h),void this.Execute.RunNextJob()}s=function(t,e,i,r){a.RecvStockValue(t,e,i,r),a.Execute.RunNextJob()};n=new Mn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:s,ErrorCallback:o})}n.Download()},this.GetCustomVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=Qr.CustomVariant.Data.get(e),i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomVariantData",Explain:"自定义变量数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:r,period:this.Period,right:this.Right}},Self:this,VariantInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"自定义变量".concat(e,"下载失败")),this.Execute.RunNextJob()},this.GetCustomFunctionData=function(t){var e=t.FunctionName,a=Qr.CustomFunction.Data.get(e);if(!a.IsDownload)return this.Execute.RunNextJob();if(this.StockData.has(e))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomFunctionData",Explain:"自定义函数数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{FunctionName:t.FunctionName,symbol:this.Symbol,daterange:r,JobItem:t,period:this.Period,right:this.Right}},Self:this,FunctionInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"自定义函数".concat(e,"下载失败")),this.Execute.RunNextJob()},this.GetCustomFunctionDataV2=function(t){var e=t.FunctionName,a=Qr.CustomDataFunction.Data.get(e);if(a){var i=this.JobArgumentsToArray(t,a.ArgCount),r=this.GetStockDataKey(t,i);if(this.StockData.has(r))return this.Execute.RunNextJob();var n=this;if(this.NetworkFilter){var o=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetCustomFunctionData",Explain:"自定义函数数据下载",JobID:t.ID,Request:{Url:"数据地址",Type:"POST",Data:{FunctionName:t.FunctionName,symbol:this.Symbol,daterange:o,JobItem:t,Key:r,period:this.Period,right:this.Right}},Self:this,FunctionInfo:a,PreventDefault:!1};this.NetworkFilter(s,(function(e){e.Error?n.AddStockValueError(r,e.Error):n.RecvStockValue(e.Data,t,r,e.DataType),n.Execute.RunNextJob()}))}else this.AddStockValueError(r,"自定义函数".concat(r,"下载失败")),this.Execute.RunNextJob()}},this.RecvStockValue=function(t,e,a,i,r){if(t){if(0==i)if(Array.isArray(t)){var n=this.Data;if(this.DataType==Sn.KLINE_ID)if(dt.IsDayPeriod(this.Period,!0))D=n.GetFittingFinanceData(t);else{if(!dt.IsMinutePeriod(this.Period,!0))return;D=n.GetMinuteFittingFinanceData(t)}else D=n.GetMinuteFittingFinanceData(t);var o=new dt;o.Data=D;var s=o.GetValue(),h=r&&2==r.Ver;if(!h&&("EXCHANGE"==a||"HSL"==a))for(var l in s){var C=n.Data[l];sa.IsPlusNumber(s[l])&&(s[l]=C.Vol/s[l]*100)}this.StockData.set(a,{Data:s})}else this.StockData.set(a,{Data:t.Value});else if(1==i)this.StockData.set(a,{Data:t.Value});else if(2==i){var D;n=this.Data;if(this.DataType==Sn.KLINE_ID)if(dt.IsDayPeriod(this.Period,!0))D=n.GetFittingTradeData(t,0);else if(dt.IsMinutePeriod(this.Period,!0))D=n.GetMinuteFittingTradeData(t,0);else{if(!dt.IsTickPeriod(this.Period))return;D=n.GetMinuteFittingTradeData(t,0)}else D=n.GetMinuteFittingTradeData(t,0);o=new dt;o.Data=D;s=o.GetValue();this.StockData.set(a,{Data:s})}}else u.Complier.Log("[JSSymbolData::RecvStockValue] key=".concat(a," data is null"))},this.AddStockValueError=function(t,e){this.StockData.set(t,{Error:e})},this.GetStockCacheData=function(t){var e;if(t.FunctionName)e=this.GetStockDataKey({FunctionName:t.FunctionName},t.Args);else if(t.VariantName)e=t.VariantName;else{if(!t.CustomName)return null;e=t.CustomName}if(!this.StockData.has(e))return null;var a=this.StockData.get(e);return a.Error&&this.Execute.ThrowUnexpectedNode(t.Node,a.Error),a.Data},this.IsInBlock=function(t,e){var a=this.GetStockCacheData({VariantName:"INBLOCK",Node:e});if(!a)return 0;for(var i=a.split("|"),r=0;r<i.length;++r){var n=i[r];if(n==t)return 1}return 0},this.JobArgumentsToArray=function(t,e){var a=t.Args;if(a.length!=e){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: argument count error."))}for(var r=[],n=0;n<a.length;++n){var o=a[n];if(sa.IsNumber(o))r.push(o);else if(o.Type==on.Literal)r.push(o.Value);else if(o.Type==on.Identifier){var s=!1;for(var h in this.Arguments){var l=this.Arguments[h];if(l.Name==o.Name){r.push(l.Value),s=!0;break}}if(!s){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"".concat(t.FunctionName,"() Error: can't read ").concat(o.Name))}}}return r},this.DownloadCustomAPIData=function(t){if(!this.NetworkFilter)return this.Execute.RunNextJob();var e=[];for(var a in t.Args){var i=t.Args[a];if(i.Type==on.Literal)e.push(i.Value);else{if(i.Type!=on.Identifier)return this.Execute.RunNextJob();var r=!1;for(var n in this.Arguments){var o=this.Arguments[n];if(o.Name==i.Name){e.push(o.Value),r=!0;break}}if(!r){var s=t.Token;this.Execute.ErrorHandler.ThrowError(s.Index,s.Line,0,"LoadAPIData() Error: can't read ".concat(i.Name))}}}var h=this,l={Name:"JSSymbolData::DownloadCustomAPIData",Explain:"下载自定义api数据",Period:this.Period,Right:this.Right,Symbol:this.Symbol,KData:this.Data,Cache:this.CustomAPIData,Args:e,Self:this,PreventDefault:!1};this.NetworkFilter(l,(function(t){h.RecvCustomAPIData(t,e),h.Execute.RunNextJob()})),1!=l.PreventDefault&&this.Execute.RunNextJob()},this.RecvCustomAPIData=function(t,e){t&&(1==t.Type?this.RecvCustomAPISingleData(t,e):this.RecvCustomAPIGroupData(t,e))},this.RecvCustomAPIGroupData=function(t,e){if(t&&t.data){var a=t.data,i=this.GenerateCustomAPIKey(e);if(dt.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var r=a.date;a.time;for(var n in a)if("date"!=n&&"time"!=n)var o=a[n]}else if(dt.IsDayPeriod(this.Period,!0)){if(!a.date)return;r=a.date;var s={__Type__:"Object"};for(var n in a)if("date"!=n){o=a[n];if(Array.isArray(o)){var h=this.FittingCustomAPIArray(o,r);s[n]=h}else this.IsNumber(o)&&(s[n]=o)}this.CustomAPIData.set(i,s)}}},this.RecvCustomAPISingleData=function(t,e){var a=t.data,i=this.GenerateCustomAPIKey(e);if(dt.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var r=a.date;a.time;for(var n in a)if("date"!=n&&"time"!=n)a[n]}else if(dt.IsDayPeriod(this.Period,!0)){if(!a.date)return;r=a.date;var o=a.value,s=null;s=Array.isArray(o)?1==t.DataType?this.FittingCustomAPIFinanceArray(o,r):this.FittingCustomAPIArray(o,r):o,this.CustomAPIData.set(i,s)}},this.FittingCustomAPIFinanceArray=function(t,e,a){var i,r=this.Data,n=[];for(var o in t){var s=t[o],h=new Dt;h.Date=e[o],a&&o<a.length&&(h.Time=a[o]),h.Value=s,n.push(h)}if(dt.IsDayPeriod(this.Period,!0))i=r.GetFittingFinanceData(n);else{if(!dt.IsMinutePeriod(this.Period,!0))return null;i=r.GetMinuteFittingFinanceData(n)}var l=new dt;l.Data=i;var u=l.GetValue();return u},this.FittingCustomAPIArray=function(t,e,a){var i,r=this.Data,n=[];for(var o in t){var s=t[o],h=new Dt;h.Date=e[o],a&&o<a.length&&(h.Time=a[o]),h.Value=s,n.push(h)}if(dt.IsDayPeriod(this.Period,!0))i=r.GetFittingData(n);else{if(!dt.IsMinutePeriod(this.Period,!0))return null;i=r.GetMinuteFittingData(n)}var l=new dt;l.Data=i;var u=l.GetValue();return u},this.GenerateCustomAPIKey=function(t){if(t.length<=0)return"__12_EMPTY_ARGS__";var e="";for(var a in t)e.length>0&&(e+=","),e+=t[a];return e},this.GetCustomApiData=function(t){var e=this.GenerateCustomAPIKey(t);return this.CustomAPIData.has(e)?this.CustomAPIData.get(e):(u.Complier.Log("[JSSymbolData::GetCustomApiData] can't find api data key=[".concat(e,"]")),null)},this.ReadArgumentValue=function(t,e){if(e.Name=t.Name,t.Type==on.Literal)return e.Value=t.Value,!0;if(t.Type==on.Identifier){var a=!1;for(var i in this.Arguments){var r=this.Arguments[i];if(r.Name==t.Name)return e.Value=r.Value,a=!0,!0}if(!a)return e.Error="can't read ".concat(t.Name),!1}return e.Error="can't read ".concat(t.Name,", type error."),!1},this.ReadIndexFunctionOut=function(t,e){var a={};if("object"===(0,s.default)(t)){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;return e.OutIndex=a.Value,e.Out=null,!0},this.ReadIndexFunctionValue=function(t,e){var a={};if("object"===(0,s.default)(t)){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;var i=a.Value.indexOf(".");if(-1!=i){e.Name=a.Value.slice(0,i);var r=a.Value.indexOf("#",i+1);-1!=r?(e.Out=a.Value.slice(i+1,r),e.Period=a.Value.slice(r+1)):e.Out=a.Value.slice(i+1)}else{r=a.Value.indexOf("#");-1!=r?(e.Name=a.Value.slice(0,r),e.Period=a.Value.slice(r+1)):e.Name=a.Value}var n=new Map([["DAY",0],["WEEK",1],["MONTH",2],["SEASON",9],["YEAR",3],["HALFYEAR",22],["WEEK2",21],["MIN1",4],["MIN5",5],["MIN15",6],["MIN30",7],["MIN60",8],["MIN120",11],["MIN240",12],["DAY2",40002],["MULTIDAY",40002],["DAY3",40003],["DAY4",40004],["DAY5",40005],["DAY6",40006],["DAY7",40007],["DAY8",40008],["DAY9",40009],["DAY10",40010],["DAY11",40011],["DAY12",40012],["DAY13",40013],["DAY14",40014],["DAY15",40015]]);if(e.Period){if(!n.has(e.Period))return e.Error="".concat(e.Period,", 周期错误"),!1;e.PeriodID=n.get(e.Period)}return!0},this.ReadSymbolArgumentValue=function(t,e){var a={};if("object"===(0,s.default)(t)){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;""==a.Value&&(a.Value=this.Symbol);var i=a.Value;return i.indexOf(".SH")>0?e.Symbol=i.replace(".SH",".sh"):i.indexOf(".SZ")>0?e.Symbol=i.replace(".SZ",".sz"):0==i.indexOf("SH")?e.Symbol=i.slice(2)+".sh":0==i.indexOf("SZ")?e.Symbol=i.slice(2)+".sz":e.Symbol=i,!0},this.ReadIndexArgumentValue=function(t,e){for(var a in e.Args=[],e.SytemIndex.Args){var i=e.SytemIndex.Args[a];e.Args.push({Value:i.Value,Name:i.Name})}if(t.length>2&&e.SytemIndex.Args&&e.SytemIndex.Args.length>0){a=2;for(var r=0;a<t.length&&r<e.SytemIndex.Args.length;++a,++r){var n={};i=t[a];if("object"===(0,s.default)(i)){if(!this.ReadArgumentValue(i,n))return e.Error=n.Error,!1}else n.Value=i;e.Args[r].Value=n.Value}}return!0},this.GenerateScriptIndexKey=function(t){var e="",a=t.Args;for(var i in a){e.length>0&&(e+=",");var r=a[i];e+=r.Value.toString()}var n="ALL";t.Out?n=t.Out:sa.IsPlusNumber(t.OutIndex)&&(n="Out[".concat(t.OutIndex-1,"]"));var o="(".concat(t.Symbol,",").concat(t.PeriodID,"), ").concat(t.Name,"(").concat(e,")=>").concat(n);return o},this.CallMemberScriptIndex=function(t){var e=this;if(t.Member.Object.Type!=on.Identifier||t.Member.Property.Type!=on.Identifier){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: 参数错误")}var i=t.Member.Object.Name,r=t.Member.Property.Name;if(""==r||null==r){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: ".concat(i,".").concat(r," 指标输出变量错误"))}if(this.Execute.VarTable.has(i)){var n=this.Execute.VarTable.get(i);if(n.hasOwnProperty(r))return u.Complier.Log("[JSSymbolData::CallMemberScriptIndex] index data ".concat(i,".").concat(r," in cache.")),this.Execute.RunNextJob()}var o=i+"."+r,s={Job:t,PeriodID:this.Period,Symbol:this.Symbol};if(!this.ReadIndexFunctionValue(o,s)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: '".concat(o,"' ").concat(s.Error))}var h=new f,l=h.Get(s.Name);if(!l){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: '".concat(o,"' ").concat(s.Name," 指标不存在"))}if(Array.isArray(l.Args)&&l.Args.length>0)for(var C in s.Args=[],l.Args){var D=l.Args[C];s.Args.push({Value:D.Value,Name:D.Name})}u.Complier.Log("[JSSymbolData::CallMemberScriptIndex] call script index",s);var c=this.Data.GetDateRange(),m={HQDataType:this.DataType,Symbol:s.Symbol,Name:"",Right:this.Right,Period:s.PeriodID,Data:null,SourceData:null,Callback:function(t,a,i){e.RecvMemberScriptIndexData(t,a,i),e.Execute.RunNextJob()},CallbackParam:s,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:s.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,IsApiPeriod:this.IsApiPeriod,KLineRange:c};In.Execute(l.Script,m,(function(t,a){e.ExecuteScriptIndexError(t,a)}))},this.CallDynamicScriptIndex=function(t,e){var a=this,i=t.DynamicName,r={Job:t,PeriodID:this.Period,Symbol:this.Symbol};if(!this.ReadIndexFunctionValue(i,r)){var n=t.Token;this.Execute.ErrorHandler.ThrowError(n.Index,n.Line,0,"CallDynamicScriptIndex() Error: '".concat(i,"' ").concat(r.Error))}var o=new f,s=o.Get(r.Name);if(!s){n=t.Token;this.Execute.ErrorHandler.ThrowError(n.Index,n.Line,0,"CallDynamicScriptIndex() Error: '".concat(i,"' ").concat(r.Name," 指标不存在"))}if(r.SytemIndex=s,!this.ReadDynamicIndexArgumentValue(t.Args,r,e)){n=t.Token;this.Execute.ErrorHandler.ThrowError(n.Index,n.Line,0,"CallDynamicScriptIndex() ".concat(r.Name," 指标参数错误 : ").concat(r.Error," "))}u.Complier.Log("[JSSymbolData::CallMemberScriptIndex] call script index",r);var h=this.Data.GetDateRange(),l={HQDataType:this.DataType,Symbol:r.Symbol,Name:"",Right:this.Right,Period:r.PeriodID,Data:null,SourceData:null,Callback:function(t,e,i){a.RecvDynamicScriptIndexData(t,e,i),a.Execute.RunNextJob()},CallbackParam:r,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:r.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,IsApiPeriod:this.IsApiPeriod,KLineRange:h};In.Execute(s.Script,l,(function(t,e){a.ExecuteScriptIndexError(t,e)}))},this.ReadDynamicIndexArgumentValue=function(t,e,a){e.Args=[];for(var i=0;i<e.SytemIndex.Args.length;++i){var r=e.SytemIndex.Args[i];e.Args.push({Value:r.Value,Name:r.Name,IsDefault:!0})}if(!sa.IsNonEmptyArray(t))return!0;for(i=0;i<t.length;++i){r=t[i];var n=e.Args[i];n&&(r.Type==on.Literal?(n.Value=r.Value,n.IsDefault=!1):r.Type==on.Identifier&&a.has(r.Name)&&(n.Value=a.get(r.Name),n.IsDefault=!1))}return!0},this.CallScriptIndex=function(t,e){var a=this;if(t.Member)return this.CallMemberScriptIndex(t);if(t.DynamicName)return this.CallDynamicScriptIndex(t,e);if(!t.Args||!(t.Args.length>=2)){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"CallScriptIndex() Error: ".concat(t.FunctionName," 参数错误"))}var r={Job:t,PeriodID:this.Period};if(!this.ReadSymbolArgumentValue(t.Args[0],r)){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"CallScriptIndex() Error: ".concat(r.Error))}if(!this.ReadIndexFunctionValue(t.Args[1],r)){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"CallScriptIndex() Error: ".concat(r.Error))}if("CALCSTOCKINDEX"==t.FunctionName&&!this.ReadIndexFunctionOut(t.Args[2],r)){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"CallScriptIndex() Error: ".concat(r.Error))}var n=new f,o=n.Get(r.Name);if(!o){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"CallScriptIndex() ".concat(r.Name," 指标不存在"))}if(r.SytemIndex=o,!this.ReadIndexArgumentValue(t.Args,r)){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,"CallScriptIndex() ".concat(r.Name," 指标参数错误 : ").concat(r.Error," "))}u.Complier.Log("[JSSymbolData::CallScriptIndex] call script index",r);var s=null;if(this.Data&&this.Data.Data.length>0){var h=this.Data.Data[0],l=this.Data.Data[this.Data.Data.length-1];s={Start:{Date:h.Date,Time:h.Time},End:{Date:l.Date,Time:l.Time}}}var C={HQDataType:this.DataType,Symbol:r.Symbol,Name:"",Right:this.Right,Period:r.PeriodID,Data:null,SourceData:null,Callback:function(t,e,i){a.RecvScriptIndexData(t,e,i),a.Execute.RunNextJob()},CallbackParam:r,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:r.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,IsApiPeriod:this.IsApiPeriod,KLineRange:s};In.Execute(r.SytemIndex.Script,C,(function(t,e){a.ExecuteScriptIndexError(t,e)}))},this.RecvMemberScriptIndexData=function(t,e,a){u.Complier.Log("[JSSymbolData::RecvMemberScriptIndexData] ",t,e,a);var i=a.Data.Data,r=t,n=this.Data.FitKLineIndex(i,r,this.Period,e.PeriodID),o=e.Job.Member,s=o.Object.Name,h=(o.Property.Name,{});for(var l in this.Execute.VarTable.has(s)?h=this.Execute.VarTable.get(s):this.Execute.VarTable.set(s,h),n){var C=t[l].Name;e.Period&&(C+="#"+e.Period),h[C]=n[l].Data}},this.RecvDynamicScriptIndexData=function(t,e,a){u.Complier.Log("[JSSymbolData::RecvDynamicScriptIndexData] ",t,e,a);var i=a.Data.Data,r=t,n=this.Data.FitKLineIndex(i,r,this.Period,e.PeriodID),o=e.Name,s={};this.Execute.VarTable.has(o)?s=this.Execute.VarTable.get(o):this.Execute.VarTable.set(o,s);for(var h="",l=0;l<e.Args.length;++l){var C=e.Args[l];!1===C.IsDefault&&(h.length>0&&(h+=","),h+="".concat(C.Value))}var D="(".concat(h,")");for(l=0;l<n.length;++l){var f="".concat(t[l].Name,"#").concat(D);e.Period&&(f+="#"+e.Period),s[f]=n[l].Data}},this.RecvScriptIndexData=function(t,e,a){var i=this.GenerateScriptIndexKey(e);u.Complier.Log("[JSSymbolData::RecvScriptIndexData] ",t,e,a,i);var r=a.Data.Data,n=t;if(e.Out){for(var o=0;o<t.length;++o){var s=t[o];if(s.Name==e.Out){n=[s];break}}var h=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);this.ScriptIndexOutData.set(i,h[0].Data)}else if(sa.IsPlusNumber(e.OutIndex)){var l=e.OutIndex-1;n=[t[l]];h=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);this.ScriptIndexOutData.set(i,h[0].Data)}else{h=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);var C={__Type__:"Object"};for(var o in h){s=h[o];C[s.Name]=s.Data}this.ScriptIndexOutData.set(i,C)}},this.ExecuteScriptIndexError=function(t,e){var a=e.Job.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() ".concat(e.Name," 指标执行错误 : ").concat(t," "))},this.GetScriptIndexOutData=function(t,e,a){var i={PeriodID:this.Period};this.ReadSymbolArgumentValue(t[0],i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() 股票代码错误: ").concat(i.Error)),this.ReadIndexFunctionValue(t[1],i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() 指标错误: ").concat(i.Error)),"CALCSTOCKINDEX"==a&&(this.ReadIndexFunctionOut(t[2],i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() Error: ").concat(i.Error)));var r=new f,n=r.Get(i.Name);n||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"() 指标错误: ").concat(i.Name," 指标不存在")),i.SytemIndex=n,this.ReadIndexArgumentValue(t,i)||this.Execute.ThrowUnexpectedNode(e,"".concat(a,"()  指标参数错误: ").concat(i.Error));var o=this.GenerateScriptIndexKey(i);return this.ScriptIndexOutData.has(o)?this.ScriptIndexOutData.get(o):null},this.JsonDataToHistoryData=function(t){for(var e=t.data,a=new Array,i=0;i<e.length;++i){var r=new ht;r.Date=e[i][0],r.Open=e[i][2],r.YClose=e[i][1],r.Close=e[i][5],r.High=e[i][3],r.Low=e[i][4],r.Vol=e[i][6],r.Amount=e[i][7],e[i].length>8&&(r.Up=e[i][8]),e[i].length>9&&(r.Down=e[i][9]),e[i].length>10&&(r.Stop=e[i][10]),e[i].length>11&&(r.Unchanged=e[i][11]),isNaN(r.Open)||r.Open<=0||a.push(r)}return a},this.JsonDataToMinuteHistoryData=function(t){for(var e=t.data,a=new Array,i=0;i<e.length;++i){var r=new ht;r.Date=e[i][0],r.Open=e[i][2],r.YClose=e[i][1],r.Close=e[i][5],r.High=e[i][3],r.Low=e[i][4],r.Vol=e[i][6],r.Amount=e[i][7],r.Time=e[i][8],a.push(r)}for(var n=0;n<a.length;++n){var o=a[n];if(null==o&&coninue,isNaN(o.Open)||o.Open<=0||isNaN(o.High)||o.High<=0||isNaN(o.Low)||o.Low<=0||isNaN(o.Close)||o.Close<=0||isNaN(o.YClose)||o.YClose<=0)if(0==n)o.YClose>0&&(o.Open=o.YClose,o.High=o.YClose,o.Low=o.YClose,o.Close=o.YClose);else for(var s=n-1;s>=0;--s){var h=a[s];if(null==h&&coninue,h.Open>0&&h.High>0&&h.Low>0&&h.Close>0){o.YClose<=0&&(o.YClose=h.Close),o.Open=h.Open,o.High=h.High,o.Low=h.Low,o.Close=h.Close;break}}}return a},this.JsonDataToMinuteData=function(t){var e=new Array;for(var a in t.stock[0].minute){var i=t.stock[0].minute[a],r=new lt;r.Close=i.price,r.Open=i.open,r.High=i.high,r.Low=i.low,r.Vol=i.vol,r.Amount=i.amount,r.DateTime=0==a?t.stock[0].date.toString()+" 0925":t.stock[0].date.toString()+" "+i.time.toString(),r.Date=t.stock[0].date,r.Time=i.time,r.Increase=i.increase,r.Risefall=i.risefall,r.AvPrice=i.avprice,e[a]=r}return e},this.JsonDataToMultiDayMinuteData=function(t){var e=t.symbol,a=e.toUpperCase(),i=Pr.IsSHSZ(a),r=(Pr.IsChinaFutures(a),[]);for(var n in t.data){var o=[],s=t.data[n],h=s.date,l=s.yclose,u=l,C=null;for(var D in s.minute){var f=s.minute[D];f[2]&&(u=f[2]);var c=new lt;c.Close=f[2],c.Open=f[1],c.High=f[3],c.Low=f[4],c.Vol=f[5]/100,c.Amount=f[6],7<f.length&&f[7]>0&&(c.AvPrice=f[7],C=f[7]),c.DateTime=h.toString()+" "+f[0].toString(),c.Date=h,c.Time=f[0],c.Close||(c.Close=u,c.Open=c.High=c.Low=c.Close),!c.AvPrice&&C&&(c.AvPrice=C),c.Close&&l?c.Increase=(c.Close-l)/l*100:c.Increase=null,0==D&&(i&&(c.DateTime=h.toString()+" 0925"),c.IsFristData=!0),c.Open<=0&&(c.Open=null),c.Close<=0&&(c.Close=null),c.AvPrice<=0&&(c.AvPrice=null),c.High<=0&&(c.High=null),c.Low<=0&&(c.Low=null),c.AvPrice<=0&&(c.AvPrice=null),o[D]=c}var m=new dt;m.Data=o,m.YClose=l,m.Close=s.close,m.Date=h,r.push(m)}for(o=[],n=r.length-1;n>=0;--n){c=r[n];for(var D in c.Data)o.push(c.Data[D])}return o},this.CODELIKE=function(t){return this.Symbol&&0==this.Symbol.indexOf(t)?1:0},this.NAMELIKE=function(t){return this.Name&&0==this.Name.indexOf(t)?1:0},this.SETCODE=function(){return this.Symbol.indexOf(".sh")?1:(this.Symbol.indexOf(".sz"),0)},this.GetSymbol=function(){return this.Symbol},this.GetName=function(){return this.Name},this.DATE=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];t[e]=a.Date-19e6}return t},this.YEAR=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date/1e4):t[e]=null}return t},this.DAY=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date%100):t[e]=null}return t},this.MONTH=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date%1e4/100):t[e]=null}return t},this.TIME=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];this.IsNumber(a.Time)?t[e]=a.Time:t[e]=0}return t},this.TIME2=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];this.IsNumber(a.Time)?t[e]=100*a.Time:t[e]=0}return t},this.DateTime=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=dt.IsMinutePeriod(this.Period,!0),a=0;a<this.Data.Data.length;++a){var i=this.Data.Data[a];t[a]=e?1e4*i.Date+i.Time:i.Date}return t},this.WEEK=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;var e=new Date;for(var a in this.Data.Data){var i=this.Data.Data[a];if(t[a]=null,this.IsNumber(i.Date)){var r=parseInt(i.Date/1e4),n=parseInt(i.Date%1e4/100),o=i.Date%100;e.setFullYear(r,n-1,o),t[a]=e.getDay()}}return t},this.DAYSTOTODAY=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=0;i<this.Data.Data.length;++i){var r=this.Data.Data[i];if(t[i]=null,this.IsNumber(r.Date)){var n=parseInt(r.Date/1e4),o=parseInt(r.Date%1e4/100),s=r.Date%100,h=new Date(n,o-1,s),l=Math.ceil((a-h)/864e5);t[i]=l}}return t},this.WEEKOFYEAR=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(t[e]=null,this.IsNumber(a.Date)){var i=parseInt(a.Date/1e4),r=parseInt(a.Date%1e4/100),n=a.Date%100,o=new Date(i,r-1,n),s=new Date(i,0,1),h=Math.ceil((o-s)/864e5);h+=s.getDay()+1-1;var l=Math.ceil(h/7),u=l;t[e]=u}}return t},this.GetYearWeek=function(t){var e=new Date(t.getFullYear(),0,1),a=t.getDay();0==a&&(a=7);var i=e.getDay();0==i&&(i=7);var r=t.getTime()-e.getTime(),n=Math.floor((r+864e5*(i-a))/864e5);return Math.ceil(n/7)+1},this.REFDATE=function(t,e){var a=null;if(Array.isArray(e)?e.length>0&&(a=e[e.length-1]):this.IsNumber(e)&&(a=e),null==a)return null;a<5e6&&(a+=19e6);var i=null;for(var r in this.Data.Data)if(this.Data.Data[r].Date==a){i=parseInt(r);break}return null==i||i>=t.length?null:t[i]},this.PERIOD=function(){var t=[5,6,7,11,0,1,2,3,4,5,9];return this.Period>=0&&this.Period<=t.length-1?t[this.Period]:this.Period},this.GetDrawNull=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data)t[e]=null;return t},this.HOUR=function(){var t=[];if(!this.Data||!this.Data.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];t[e]=0,sa.IsNumber(a.Time)&&(t[e]=parseInt(a.Time/100))}return t},this.MINUTE=function(){var t=[];if(!this.Data||!this.Data.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];t[e]=0,sa.IsNumber(a.Time)&&(t[e]=a.Time%100)}return t},this.SysParam=function(t,e){if(!this.DrawInfo)return[];if(2==t){if(e.IsUsePageData=!0,sa.IsNumber(this.DrawInfo.Start))return this.DrawInfo.Start+1}else if(3==t){if(e.IsUsePageData=!0,sa.IsNumber(this.DrawInfo.End))return this.DrawInfo.End+1}else{if(4==t){if(e.IsUsePageData=!0,!sa.IsNumber(this.DrawInfo.End)||!sa.IsNumber(this.DrawInfo.Start))return[];if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return[];for(var a=null,i=this.DrawInfo.Start;i<=this.DrawInfo.End&&i<this.Data.Data.length;++i){var r=this.Data.Data[i];sa.IsNumber(r.High)&&((null==a||a<r.High)&&(a=r.High))}return a}if(5==t){if(e.IsUsePageData=!0,!sa.IsNumber(this.DrawInfo.End)||!sa.IsNumber(this.DrawInfo.Start))return[];if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return[];var n=null;for(i=this.DrawInfo.Start;i<=this.DrawInfo.End&&i<this.Data.Data.length;++i){r=this.Data.Data[i];sa.IsNumber(r.Low)&&((null==n||n>r.Low)&&(n=r.Low))}return n}}return[]}}Dn.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},Dn.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},Dn.prototype.JsonDataToFinance=function(t){for(var e,a=1;a<=4;++a){switch(a){case 1:var i=t.finance1,r=t.announcement1;break;case 2:i=t.finance2,r=t.announcement2;break;case 3:i=t.finance3,r=t.announcement3;break;case 4:i=t.finance4,r=t.announcement4;break;default:break}i&&r&&this.IsNumber(r.year)&&this.IsNumber(r.quarter)&&(e?e.Announcement.year<r.year&&(e={Date:t.date,Finance:i,Announcement:r}):e={Date:t.date,Finance:i,Announcement:r})}return e};var fn={JOB_DOWNLOAD_SYMBOL_DATA:1,JOB_DOWNLOAD_INDEX_DATA:2,JOB_DOWNLOAD_SYMBOL_LATEST_DATA:3,JOB_DOWNLOAD_INDEX_INCREASE_DATA:4,JOB_DOWNLOAD_VOLR_DATA:5,JOB_DOWNLOAD_LATEST_INDEX_DATA:8,JOB_DOWNLOAD_OTHER_SYMBOL_DATA:9,JOB_DOWNLOAD_SYMBOL_PERIOD_DATA:10,JOB_DOWNLOAD_FINVALUE:301,JOB_DOWNLOAD_FINONE:302,JOB_DOWNLOAD_FINANCE:303,JOB_DOWNLOAD_GPJYVALUE:304,JOB_DOWNLOAD_VARIANT:305,JOB_DOWNLOAD_SCJYVALUE:306,JOB_DOWNLOAD_GPJYONE:307,JOB_DOWNLOAD_SCJYONE:308,JOB_DOWNLOAD_BKJYVALUE:309,JOB_DOWNLOAD_BKJYONE:310,JOB_DOWNLOAD_MARGIN_BALANCE:1e3,JOB_DOWNLOAD_MARGIN_RATE:1001,JOB_DOWNLOAD_MARGIN_BUY_BALANCE:1010,JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:1011,JOB_DOWNLOAD_MARGIN_BUY_REPAY:1012,JOB_DOWNLOAD_MARGIN_BUY_NET:1013,JOB_DOWNLOAD_MARGIN_SELL_BALANCE:1020,JOB_DOWNLOAD_MARGIN_SELL_VOLUME:1021,JOB_DOWNLOAD_MARGIN_SELL_REPAY:1022,JOB_DOWNLOAD_MARGIN_SELL_NET:1023,JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:2e3,JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:2001,JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:2002,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:2003,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:2004,JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:2005,JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:2006,JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:2007,JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:2008,JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:2009,JOB_DOWNLOAD_HK_TO_SH:2050,JOB_DOWNLOAD_HK_TO_SZ:2051,JOB_DOWNLOAD_HK_TO_SH_SZ:2052,JOB_DOWNLOAD_HK_TO_SHSZ:2053,JOB_CUSTOM_FUNCTION_DATA:6e3,JOB_CUSTOM_VARIANT_DATA:6001,JOB_CUSTOM_DATA_FUNCTION:6002,JOB_DOWNLOAD_SECTION_SF:2e4,JOB_DOWNLOAD_SECTION_F_01:20001,JOB_DOWNLOAD_SECTION_F_02:20002,JOB_DOWNLOAD_SECTION_F_03:20003,JOB_DOWNLOAD_SECTION_F_04:20004,JOB_DOWNLOAD_SECTION_F_05:20005,JOB_DOWNLOAD_SECTION_F_06:20006,JOB_DOWNLOAD_SECTION_F_07:20007,JOB_DOWNLOAD_SECTION_F_08:20008,JOB_DOWNLOAD_SECTION_F_09:20009,JOB_DOWNLOAD_SECTION_F_10:20010,JOB_DOWNLOAD_SECTION_F_11:20011,JOB_DOWNLOAD_SECTION_F_12:20012,JOB_DOWNLOAD_SECTION_F_13:20013,JOB_DOWNLOAD_SECTION_F_14:20014,JOB_DOWNLOAD_SECTION_F_15:20015,JOB_DOWNLOAD_SECTION_F_16:20016,JOB_DOWNLOAD_SECTION_F_17:20017,JOB_DOWNLOAD_SECTION_F_18:20018,JOB_DOWNLOAD_SECTION_F_19:20019,JOB_DOWNLOAD_SECTION_F_20:20020,JOB_DOWNLOAD_SECTION_F_21:20021,JOB_DOWNLOAD_SECTION_F_22:20022,JOB_DOWNLOAD_SECTION_F_23:20023,JOB_DOWNLOAD_SECTION_F_24:20024,JOB_DOWNLOAD_SECTION_F_25:20025,JOB_DOWNLOAD_SECTION_F_26:20026,JOB_DOWNLOAD_SECTION_F_27:20027,JOB_DOWNLOAD_SECTION_F_28:20028,JOB_DOWNLOAD_SECTION_F_29:20029,JOB_DOWNLOAD_SECTION_F_30:20030,JOB_DOWNLOAD_SECTION_F_31:20031,JOB_DOWNLOAD_SECTION_F_32:20032,JOB_DOWNLOAD_SECTION_F_33:20033,JOB_DOWNLOAD_SECTION_F_34:20034,JOB_DOWNLOAD_SECTION_F_35:20035,JOB_DOWNLOAD_SECTION_F_36:20036,JOB_DOWNLOAD_SECTION_F_37:20037,JOB_DOWNLOAD_SECTION_F_38:20038,JOB_DOWNLOAD_SECTION_F_39:20039,JOB_DOWNLOAD_CUSTOM_API_DATA:3e4,JOB_EXECUTE_INDEX:30010,JOB_RUN_SCRIPT:1e4,GetMarginJobID:function(t){var e=new Map([[1,fn.JOB_DOWNLOAD_MARGIN_BALANCE],[2,fn.JOB_DOWNLOAD_MARGIN_RATE],[3,fn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE],[4,fn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT],[5,fn.JOB_DOWNLOAD_MARGIN_BUY_REPAY],[6,fn.JOB_DOWNLOAD_MARGIN_BUY_NET],[7,fn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE],[8,fn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME],[9,fn.JOB_DOWNLOAD_MARGIN_SELL_REPAY],[10,fn.JOB_DOWNLOAD_MARGIN_SELL_NET]]);return e.has(t)?e.get(t):null},GetNewsAnalysisID:function(t){var e=new Map([[1,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE],[2,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH],[3,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT],[4,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE],[5,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2],[6,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER],[7,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING],[8,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS],[9,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS],[10,fn.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE]]);return e.has(t)?e.get(t):null},GetSectionFinanceID:function(t){var e=new Map([["流动资产",fn.JOB_DOWNLOAD_SECTION_F_01],["货币资金",fn.JOB_DOWNLOAD_SECTION_F_02],["存货",fn.JOB_DOWNLOAD_SECTION_F_03],["流动负债",fn.JOB_DOWNLOAD_SECTION_F_04],["非流动负债",fn.JOB_DOWNLOAD_SECTION_F_05],["三项费用",fn.JOB_DOWNLOAD_SECTION_F_06],["投资收益",fn.JOB_DOWNLOAD_SECTION_F_07],["归母净利润",fn.JOB_DOWNLOAD_SECTION_F_08],["扣非净利润",fn.JOB_DOWNLOAD_SECTION_F_09],["扣非每股收益",fn.JOB_DOWNLOAD_SECTION_F_10],["加权平均净资产收益",fn.JOB_DOWNLOAD_SECTION_F_11],["在建工程",fn.JOB_DOWNLOAD_SECTION_F_12],["累计折旧",fn.JOB_DOWNLOAD_SECTION_F_13],["少数股东利润",fn.JOB_DOWNLOAD_SECTION_F_14],["汇兑损益",fn.JOB_DOWNLOAD_SECTION_F_15],["坏账计提",fn.JOB_DOWNLOAD_SECTION_F_16],["固定资产",fn.JOB_DOWNLOAD_SECTION_F_17],["当期折旧",fn.JOB_DOWNLOAD_SECTION_F_18],["营业总收入",fn.JOB_DOWNLOAD_SECTION_F_19],["主营业务利润",fn.JOB_DOWNLOAD_SECTION_F_20],["营业利润",fn.JOB_DOWNLOAD_SECTION_F_21],["净利润",fn.JOB_DOWNLOAD_SECTION_F_22],["应收账款",fn.JOB_DOWNLOAD_SECTION_F_23],["财务费用",fn.JOB_DOWNLOAD_SECTION_F_24],["经营性现金流",fn.JOB_DOWNLOAD_SECTION_F_25],["资产总计",fn.JOB_DOWNLOAD_SECTION_F_26],["负债总计",fn.JOB_DOWNLOAD_SECTION_F_27],["所有者权益总计",fn.JOB_DOWNLOAD_SECTION_F_28],["毛利率",fn.JOB_DOWNLOAD_SECTION_F_29],["每股资本公积金",fn.JOB_DOWNLOAD_SECTION_F_30],["每股未分配利润",fn.JOB_DOWNLOAD_SECTION_F_31],["每股收益",fn.JOB_DOWNLOAD_SECTION_F_32],["每股净资产",fn.JOB_DOWNLOAD_SECTION_F_33],["每股经营性现金流",fn.JOB_DOWNLOAD_SECTION_F_34],["扣非净利润涨幅",fn.JOB_DOWNLOAD_SECTION_F_35],["扣非净利润涨速",fn.JOB_DOWNLOAD_SECTION_F_36],["净利润涨幅",fn.JOB_DOWNLOAD_SECTION_F_37],["资产负债率",fn.JOB_DOWNLOAD_SECTION_F_38],["利润同比",fn.JOB_DOWNLOAD_SECTION_F_39]]);return e.has(t)?e.get(t):null},GetSectionReportPeriod:function(t,e){return t>=2e3&&e>=1&&e<=4?{Year:t,Quarter:e}:null}},cn=[{Name:"GPJYVALUE",JobID:fn.JOB_DOWNLOAD_GPJYVALUE,Explain:"股票交易类数据GPJYVALUE(ID,N,TYPE)",FuncName:"JSSymbolData::GetGPJYValue",ArgCount:3},{Name:"GPJYONE",JobID:fn.JOB_DOWNLOAD_GPJYONE,Explain:"股票交易类数据GPJYONE(ID,N,Y,MMDD)",FuncName:"JSSymbolData::GetGPJYOne",ArgCount:4},{Name:"SCJYVALUE",JobID:fn.JOB_DOWNLOAD_SCJYVALUE,Explain:"市场交易类数据SCJYVALUE(ID,N,TYPE)",FuncName:"JSSymbolData::GetSCJYValue",ArgCount:3},{Name:"SCJYONE",JobID:fn.JOB_DOWNLOAD_SCJYONE,Explain:"市场交易类数据SCJYONE(ID,N,Y,MMDD)",FuncName:"JSSymbolData::GetSCJYOne",ArgCount:4},{Name:"BKJYVALUE",JobID:fn.JOB_DOWNLOAD_BKJYVALUE,Explain:"板块交易类数据BKJYVALUE(ID,N,TYPE)",FuncName:"JSSymbolData::GetBKJYValue",ArgCount:3},{Name:"BKJYONE",JobID:fn.JOB_DOWNLOAD_BKJYONE,Explain:"板块交易类数据BKJYONE(ID,N,Y,MMDD)",FuncName:"JSSymbolData::GetBKJYOne",ArgCount:4},{Name:"FINVALUE",JobID:fn.JOB_DOWNLOAD_FINVALUE,Explain:"财务数据FINVALUE(ID)",FuncName:"JSSymbolData::GetFinValue",ArgCount:1},{Name:"FINONE",JobID:fn.JOB_DOWNLOAD_FINONE,Explain:"财务数据FINONE(ID,Y,MMDD)",FuncName:"JSSymbolData::GetFinOne",ArgCount:3}];function mn(t,e){var a=this;this.AST=t,this.ErrorHandler=new an,this.VarTable=new Map,this.VarDrawTable=new Map,this.OutVarTable=[],this.Arguments=[],this.ErrorCallback,this.GetEventCallback,this.IsUsePageData=!1,this.IndexCtrl,this.Debug=0,this.DebugFilter,this.Interrupt={Exit:!1},this.ConstVarTable=new Map([["CLOSE",null],["VOL",null],["OPEN",null],["HIGH",null],["LOW",null],["AMOUNT",null],["C",null],["V",null],["O",null],["H",null],["L",null],["AMO",null],["VOLR",null],["VOLINSTK",null],["OPI",null],["QHJSJ",null],["SETTLE",null],["ZSTJJ",null],["ISEQUAL",null],["ISUP",null],["ISDOWN"],["DATE",null],["YEAR",null],["MONTH",null],["PERIOD",null],["WEEK",null],["WEEKDAY",null],["TIME",null],["DAY",null],["DATETIME",null],["TIME2",null],["WEEKOFYEAR",null],["DAYSTOTODAY",null],["HOUR",null],["MINUTE",null],["INDEXA",null],["INDEXC",null],["INDEXH",null],["INDEXL",null],["INDEXO",null],["INDEXV",null],["INDEXADV",null],["INDEXDEC",null],["ADVANCE",null],["DECLINE",null],["FROMOPEN",null],["TOTALFZNUM",null],["CURRBARSCOUNT",null],["TOTALBARSCOUNT",null],["ISLASTBAR",null],["BARSTATUS",null],["BARPOS",null],["CAPITAL",null],["TOTALCAPITAL",null],["EXCHANGE",null],["HSL",null],["SETCODE",null],["CODE",null],["STKNAME",null],["TQFLAG",null],["HYBLOCK",null],["DYBLOCK",null],["GNBLOCK",null],["FGBLOCK",null],["ZSBLOCK",null],["ZHBLOCK",null],["ZDBLOCK",null],["HYZSCODE",null],["GNBLOCKNUM",null],["FGBLOCKNUM",null],["ZSBLOCKNUM",null],["ZHBLOCKNUM",null],["ZDBLOCKNUM",null],["HYSYL",null],["HYSJL",null],["DRAWNULL",null],["NULL",null],["MACHINEDATE",null],["MACHINETIME",null],["MACHINEWEEK",null],["TR",null],["AUTOFILTER",null],["LARGEINTRDVOL",null],["LARGEOUTTRDVOL",null],["TRADENUM",null],["TRADEINNUM",null],["TRADEOUTNUM",null],["LARGETRDINNUM",null],["LARGETRDOUTNUM",null],["CUR_BUYORDER",null],["CUR_SELLORDER",null],["ACTINVOL",null],["ACTOUTVOL",null],["BIDORDERVOL",null],["BIDCANCELVOL",null],["AVGBIDPX",null],["OFFERORDERVOL",null],["OFFERCANCELVOL",null],["AVGOFFERPX",null]]),this.SymbolData=new Dn(this.AST,e,this),this.Algorithm=new ln(this.ErrorHandler,this.SymbolData),this.Draw=new un(this.ErrorHandler,this.SymbolData),this.JobList=[],this.UpdateUICallback=null,this.CallbackParam=null,this.IsSectionMode=!1,e&&(e.Callback&&(this.UpdateUICallback=e.Callback),e.CallbackParam&&(this.CallbackParam=e.CallbackParam,this.CallbackParam.HQChart&&(this.GetEventCallback=function(t){return a.CallbackParam.HQChart.GetEventCallback(t)})),e.Arguments&&(this.Arguments=e.Arguments),e.IsSectionMode&&(this.IsSectionMode=e.IsSectionMode),e.Self&&(this.IndexCtrl=e.Self),sa.IsNumber(e.Debug)&&(this.Debug=e.Debug),e.DebugFilter&&(this.DebugFilter=e.DebugFilter)),this.Execute=function(){for(var t in this.OutVarTable=[],this.VarTable=new Map,this.VarDrawTable=new Map,u.Complier.Log("[JSExecute::Execute] Load Arguments",this.Arguments),this.Arguments){var e=this.Arguments[t];this.VarTable.set(e.Name,e.Value)}this.RunNextJob()},this.RunNextJob=function(){if(!(this.JobList.length<=0)){u.Complier.Log("[JSExecute::Execute] JobList",this.JobList);var t=this.JobList.shift();switch(t.ID){case fn.JOB_DOWNLOAD_SYMBOL_DATA:return this.SymbolData.GetSymbolData();case fn.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA:return this.SymbolData.GetSymbolPeriodData(t);case fn.JOB_DOWNLOAD_INDEX_DATA:return this.SymbolData.GetIndexData();case fn.JOB_DOWNLOAD_LATEST_INDEX_DATA:return this.SymbolData.GetLatestIndexData();case fn.JOB_DOWNLOAD_INDEX_INCREASE_DATA:return this.SymbolData.GetIndexIncreaseData(t);case fn.JOB_DOWNLOAD_SYMBOL_LATEST_DATA:return this.SymbolData.GetLatestData(t);case fn.JOB_DOWNLOAD_VOLR_DATA:return this.SymbolData.GetVolRateData(t);case fn.JOB_DOWNLOAD_OTHER_SYMBOL_DATA:return this.SymbolData.GetOtherSymbolData(t);case fn.JOB_DOWNLOAD_MARGIN_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_RATE:case fn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case fn.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case fn.JOB_DOWNLOAD_MARGIN_BUY_NET:case fn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case fn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case fn.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case fn.JOB_DOWNLOAD_MARGIN_SELL_NET:return this.SymbolData.GetMarginData(t.ID);case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:case fn.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:return this.SymbolData.GetNewsAnalysisData(t.ID);case fn.JOB_DOWNLOAD_HK_TO_SHSZ:return this.SymbolData.GetHKToSHSZData(t);case fn.JOB_DOWNLOAD_SECTION_SF:return this.SymbolData.GetSectionFinanceData(t);case fn.JOB_DOWNLOAD_FINANCE:return this.SymbolData.GetFinance(t);case fn.JOB_DOWNLOAD_FINONE:case fn.JOB_DOWNLOAD_FINVALUE:case fn.JOB_DOWNLOAD_GPJYVALUE:case fn.JOB_DOWNLOAD_GPJYONE:case fn.JOB_DOWNLOAD_SCJYVALUE:case fn.JOB_DOWNLOAD_SCJYONE:case fn.JOB_DOWNLOAD_BKJYVALUE:case fn.JOB_DOWNLOAD_BKJYONE:return this.SymbolData.GetProFinance(t);case fn.JOB_DOWNLOAD_VARIANT:return this.SymbolData.GetVariantData(t);case fn.JOB_CUSTOM_VARIANT_DATA:return this.SymbolData.GetCustomVariantData(t);case fn.JOB_CUSTOM_FUNCTION_DATA:return this.SymbolData.GetCustomFunctionData(t);case fn.JOB_CUSTOM_DATA_FUNCTION:return this.SymbolData.GetCustomFunctionDataV2(t);case fn.JOB_DOWNLOAD_CUSTOM_API_DATA:return this.SymbolData.DownloadCustomAPIData(t);case fn.JOB_EXECUTE_INDEX:return this.SymbolData.CallScriptIndex(t,this.VarTable);case fn.JOB_RUN_SCRIPT:return 1===this.Debug&&this.DebugFilter?this.DebugRun():this.Run()}}},this.ReadSymbolData=function(t,e){switch(t){case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":case"OPI":case"VOLINSTK":case"SETTLE":case"QHJSJ":case"ZSTJJ":case"ISEQUAL":case"ISUP":case"ISDOWN":return this.SymbolData.GetSymbolCacheData(t);case"VOLR":return this.SymbolData.GetVolRateCacheData(e);case"TR":return this.SymbolData.GetTRData(e);case"INDEXA":case"INDEXC":case"INDEXH":case"INDEXH":case"INDEXO":case"INDEXV":case"INDEXL":case"INDEXADV":case"INDEXDEC":return this.SymbolData.GetIndexCacheData(t);case"CURRBARSCOUNT":return this.SymbolData.GetCurrBarsCount();case"BARPOS":return this.SymbolData.GetBarPos();case"TOTALBARSCOUNT":return this.SymbolData.GetTotalBarsCount();case"TOTALFZNUM":return this.SymbolData.GetTotalTradeMinuteCount();case"ISLASTBAR":return this.SymbolData.GetIsLastBar();case"BARSTATUS":return this.SymbolData.GetBarStatus();case"TOTALCAPITAL":case"CAPITAL":case"EXCHANGE":case"HSL":case"HYBLOCK":case"DYBLOCK":case"GNBLOCK":case"FGBLOCK":case"ZSBLOCK":case"ZHBLOCK":case"ZDBLOCK":case"HYZSCODE":case"GNBLOCKNUM":case"FGBLOCKNUM":case"ZSBLOCKNUM":case"ZHBLOCKNUM":case"ZDBLOCKNUM":case"HYSYL":case"HYSJL":case"FROMOPEN":case"LARGEINTRDVOL":case"LARGEOUTTRDVOL":case"TRADENUM":case"TRADEINNUM":case"TRADEOUTNUM":case"LARGETRDINNUM":case"LARGETRDOUTNUM":case"CUR_BUYORDER":case"CUR_SELLORDER":case"ACTINVOL":case"ACTOUTVOL":case"BIDORDERVOL":case"BIDCANCELVOL":case"AVGBIDPX":case"OFFERORDERVOL":case"OFFERCANCELVOL":case"AVGOFFERPX":return this.SymbolData.GetStockCacheData({VariantName:t,Node:e});case"SETCODE":return this.SymbolData.SETCODE();case"CODE":return this.SymbolData.GetSymbol();case"STKNAME":return this.SymbolData.GetName();case"TIME":return this.SymbolData.TIME();case"TIME2":return this.SymbolData.TIME2();case"DATE":return this.SymbolData.DATE();case"DATETIME":return this.SymbolData.DateTime();case"YEAR":return this.SymbolData.YEAR();case"MONTH":return this.SymbolData.MONTH();case"WEEK":case"WEEKDAY":return this.SymbolData.WEEK();case"DAY":return this.SymbolData.DAY();case"PERIOD":return this.SymbolData.PERIOD();case"HOUR":return this.SymbolData.HOUR();case"MINUTE":return this.SymbolData.MINUTE();case"DRAWNULL":case"NULL":return this.SymbolData.GetDrawNull();case"ADVANCE":case"DECLINE":return this.SymbolData.GetIndexIncreaseCacheData(t,this.SymbolData.Symbol,e);case"TQFLAG":return this.SymbolData.Right;case"MACHINEDATE":var a=new Date;return 1e4*a.getFullYear()+1*a.getMonth()*100+a.getDate()-19e6;case"MACHINETIME":a=new Date;return 1e4*a.getHours()+1*a.getMinutes()*100+a.getSeconds();case"MACHINEWEEK":a=new Date;return a.getDay();case"WEEKOFYEAR":return this.SymbolData.WEEKOFYEAR();case"DAYSTOTODAY":return this.SymbolData.DAYSTOTODAY()}this.ThrowUnexpectedNode(e,"变量"+t+"不存在",t)},this.ReadCustomVariant=function(t,e){return this.SymbolData.GetStockCacheData({VariantName:t,Node:e})},this.ReadVariable=function(t,e){if(this.ConstVarTable.has(t)){var a=this.ConstVarTable.get(t);return null==a&&(a=this.ReadSymbolData(t,e),this.ConstVarTable.set(t,a)),a}if(Qr.IsCustomVariant(t))return this.ReadCustomVariant(t,e);if(this.VarTable.has(t))return this.VarTable.get(t);if(t.indexOf("#")>0){var i=t.split("#");return this.SymbolData.GetSymbolPeriodCacheData(i[0],i[1])}if(0==t.indexOf("COLOR")){var r=In.ColorVarToRGB(t);if(r)return r}return this.ThrowUnexpectedNode(e,"变量"+t+"不存在",t),null},this.ReadMemberVariable=function(t){var e,a=t.Object,i=t.Property;if(e=a.Type==on.BinaryExpression||a.Type==on.LogicalExpression?this.VisitBinaryExpression(a):a.Type==on.CallExpression?this.VisitCallExpression(a):this.GetNodeValue(a),!e)return null;var r=e[i.Name];return r||null},this.SingleDataToArrayData=function(t){for(var e=this.SymbolData.Data.Data.length,a=[],i=0;i<e;++i)a[i]=t;return a},this.RunAST=function(){this.AST||this.ThrowError(),this.AST.Body||this.ThrowError();for(var t=0;t<this.AST.Body.length;++t){var e=this.AST.Body[t];if(this.RunASTNode(e,t),this.Interrupt&&this.Interrupt.Exit){u.Complier.Log("[JSExecute::RunAST] Interrupt",this.Interrupt);break}}return u.Complier.Log("[JSExecute::RunAST]",this.VarTable),this.OutVarTable},this.RunASTNode=function(t,e){this.VisitNode(t);var a=e;if(t.Type==on.ExpressionStatement&&t.Expression)if(t.Expression.Type==on.AssignmentExpression){if(":"==t.Expression.Operator&&t.Expression.Left){var i=t.Expression,r=i.Left.Name,n=this.VarTable.get(r);if(this.VarDrawTable.has(r)){var o=this.VarDrawTable.get(r);this.OutVarTable.push({Name:o.Name,Draw:o,Type:1})}else{var h=0;if(n&&"object"==(0,s.default)(n)&&"Object"==n.__Type__)h=1e3;else if(!this.IsSectionMode&&!Array.isArray(n))if("string"==typeof n){var l=parseFloat(n);sa.IsNumber(l)?n=this.SingleDataToArrayData(l):(n=this.SingleDataToArrayData(n),h=1001)}else n=this.SingleDataToArrayData(n);this.OutVarTable.push({Name:r,Data:n,Type:h})}}}else if(t.Expression.Type==on.CallExpression){var u=t.Expression;if(this.Draw.IsDrawFunction(u.Callee.Name)){var C=u.Draw;C.Name=u.Callee.Name,this.OutVarTable.push({Name:C.Name,Draw:C,Type:1})}else if("IFC"===u.Callee.Name&&u.Draw){var D=u.Draw;D.Name=D.DrawType,this.OutVarTable.push({Name:D.Name,Draw:D,Type:1})}else{var f=u.Out;I="__temp_c_".concat(u.Callee.Name,"_").concat(a,"__");h=0;Array.isArray(f)||(f=this.SingleDataToArrayData(f)),this.OutVarTable.push({Name:I,Data:f,Type:h,NoneName:!0})}}else if(t.Expression.Type==on.Identifier){var c=t.Expression.Name,m=this.ReadVariable(c,t.Expression);h=0;m&&"object"==(0,s.default)(m)&&"Object"==m.__Type__?h=1e3:this.IsSectionMode||Array.isArray(m)||(m="string"==typeof m?this.SingleDataToArrayData(parseFloat(m)):this.SingleDataToArrayData(m)),c="__temp_i_"+a+"__",this.OutVarTable.push({Name:c,Data:m,Type:h,NoneName:!0})}else if(t.Expression.Type==on.Literal){var d=t.Expression.Value;sa.IsString(d)&&d.indexOf("$")>0&&(d=this.SymbolData.GetOtherSymolCacheData({Literal:d})),I="__temp_li_"+a+"__";h=0;Array.isArray(d)||(d=this.SingleDataToArrayData(d)),this.OutVarTable.push({Name:I,Data:d,Type:h,NoneName:!0})}else if(t.Expression.Type==on.BinaryExpression){var I="__temp_b_"+a+"__",S=t.Expression.Out;h=0;Array.isArray(S)||(S=this.SingleDataToArrayData(S)),this.OutVarTable.push({Name:I,Data:S,Type:h,NoneName:!0})}else if(t.Expression.Type==on.LogicalExpression){I="__temp_l_"+a+"__";var T=t.Expression.Out;h=0;Array.isArray(T)||(T=this.SingleDataToArrayData(T)),this.OutVarTable.push({Name:I,Data:T,Type:h,NoneName:!0})}else if(t.Expression.Type==on.UnaryExpression){I="__temp_u_"+a+"__";var v={};if(this.ReadUnaryExpression(t.Expression,v)){h=0;this.OutVarTable.push({Name:I,Data:v.OutVar,Type:h,NoneName:!0})}}else if(t.Expression.Type==on.MemberExpression){var p=this.ReadMemberVariable(t.Expression);if(p){h=0,I="__temp_di_"+a+"__";Array.isArray(p)||(p=this.SingleDataToArrayData(p)),this.OutVarTable.push({Name:I,Data:p,Type:h,NoneName:!0})}}else if(t.Expression.Type==on.SequenceExpression){for(var g,x,F,E,L,M,y,R=!1,N=!1,w=!1,A=!1,O=!1,b=!1,B=!1,P=!1,G=!1,_=!0,V=!1,H=!1,Y=!1,k=!1,X=!1,W=!0,U=!1,K=!1,z=!1,J=-1,Z=-1,Q=-1,q=null,j=null,$=null,tt=null,et=null,at=null,it=null,rt=0;rt<t.Expression.Expression.length;++rt){var nt=t.Expression.Expression[rt];if(nt.Type==on.AssignmentExpression&&":"==nt.Operator&&nt.Left){if(0==rt){g=nt.Left.Name;var ot=this.VarTable.get(g);this.VarDrawTable.has(g)?x=this.VarDrawTable.get(g):Array.isArray(ot)||(ot=this.SingleDataToArrayData(ot),this.VarTable.set(g,ot))}}else if(nt.Type==on.Identifier){var st=nt.Name;if("COLORSTICK"===st)R=!0;else if("POINTDOT"===st)N=!0;else if("CIRCLEDOT"===st)A=!0;else if("DOTLINE"===st)H=!0;else if("UPDOWNDOT"==st)w=!0;else if("LINESTICK"===st)O=!0;else if("STICK"===st)b=!0;else if("VOLSTICK"===st)B=!0;else if("LINEAREA"==st)P=!0;else if("DRAWABOVE"===st)U=!0;else if("DRAWCENTER"===st)K=!0;else if("DRAWBELOW"==st)z=!0;else if("STEPLINE"==st)G=!0;else if("SINGLELINE"==st)k=!0;else if(0==st.indexOf("COLOR"))F=st;else if(0==st.indexOf("RGBX")&&10==st.length)F=st;else if(0==st.indexOf("LINETHICK"))y=st;else if("ALIGN0"==st)J=0;else if("ALIGN1"==st)J=1;else if("ALIGN2"==st)J=2;else if("VALIGN0"==st)Z=0;else if("VALIGN1"==st)Z=1;else if("VALIGN2"==st)Z=2;else if(0==st.indexOf("NODRAW"))_=!1;else if(0==st.indexOf("EXDATA"))V=!0;else if(0==st.indexOf("LINEOVERLAY"))Y=!0;else if(0==st.indexOf("NOTEXT")||0==st.indexOf("NOTITLE"))W=!1;else if(0==st.indexOf("FONTSIZE")){var ht=st.replace("FONTSIZE","");Q=parseInt(ht)}else if(0==rt){g=nt.Name;var lt=this.ReadVariable(g,nt);Array.isArray(lt)||(lt=this.SingleDataToArrayData(lt)),g="__temp_si_"+a+"__",X=!0,this.VarTable.set(g,lt)}}else if(nt.Type==on.Literal){if(0==rt){var ut=this.SingleDataToArrayData(nt.Value);g=nt.Value.toString(),this.VarTable.set(g,ut)}}else if(nt.Type==on.CallExpression)if(0==rt)if(this.Draw.IsDrawFunction(nt.Callee.Name))x=nt.Draw,x.Name=nt.Callee.Name;else{var Ct=nt.Out;g="__temp_sc_".concat(nt.Callee.Name,"_").concat(a,"__"),X=!0,this.VarTable.set(g,Ct)}else if("RGB"==nt.Callee.Name||"RGBA"==nt.Callee.Name)F=nt.Out;else if("UPCOLOR"==nt.Callee.Name)E=nt.Out;else if("DOWNCOLOR"==nt.Callee.Name)L=nt.Out;else if("STICKTYPE"==nt.Callee.Name)M=nt.Out;else if("XMOVE"==nt.Callee.Name)tt=nt.Out;else if("YMOVE"==nt.Callee.Name)et=nt.Out;else if("LINEDASH"==nt.Callee.Name)sa.IsNonEmptyArray(nt.Out)&&(it=nt.Out.slice());else if("FIRSTDRAW"==nt.Callee.Name)0===nt.Out?$=!1:1===nt.Out&&($=!0);else if("SOUND"==nt.Callee.Name){this.GetSoundEvent();g=null}else if("ICON"==nt.Callee.Name){var Dt=this.VarTable.get(g);Dt&&(x=this.GetOutIconData(Dt,nt.Draw),x&&(x.Name=nt.Callee.Name)),g=null}else"BACKGROUND"==nt.Callee.Name?(q=nt.Draw,g=null):"CKLINE"==nt.Callee.Name?(j=nt.Draw,g=null):"KLINETYPE"==nt.Callee.Name&&(at=nt.Out);else if(nt.Type==on.BinaryExpression){if(0==rt){g="__temp_sb_"+a+"__";var ft=nt.Out;X=!0,this.VarTable.set(g,ft)}}else if(nt.Type==on.UnaryExpression){if(0==rt){g="__temp_su_"+a+"__";v={};this.ReadUnaryExpression(nt,v)&&(X=!0,this.VarTable.set(g,v.OutVar))}}else if(nt.Type==on.MemberExpression&&0==rt){p=this.ReadMemberVariable(nt);p&&(Array.isArray(p)||(varValue=this.SingleDataToArrayData(p)),X=!0,g="__temp_di_"+a+"__",this.VarTable.set(g,p))}}if(N&&g){var ct=this.VarTable.get(g);Array.isArray(ct)||(ct=this.SingleDataToArrayData(ct));var mt={Name:g,Data:ct,Radius:qi.POINTDOT.Radius,Type:3};F&&(mt.Color=F),y&&(mt.LineWidth=y),this.OutVarTable.push(mt)}else if(A&&g){var dt=this.VarTable.get(g);Array.isArray(dt)||(dt=this.SingleDataToArrayData(dt));var It={Name:g,Data:dt,Radius:qi.CIRCLEDOT.Radius,Type:3};F&&(It.Color=F),y&&(It.LineWidth=y),this.OutVarTable.push(It)}else if(w&&g){var St=this.VarTable.get(g);Array.isArray(St)||(St=this.SingleDataToArrayData(St));var Tt={Name:g,Data:St,Radius:qi.CIRCLEDOT.Radius,Type:3,UpDownDot:!0};F&&(Tt.Color=F),y&&(Tt.LineWidth=y),this.OutVarTable.push(Tt)}else if(O&&g){var vt=this.VarTable.get(g),pt={Name:g,Data:vt,Type:4};F&&(pt.Color=F),y&&(pt.LineWidth=y),this.OutVarTable.push(pt)}else if(b&&g){var gt=this.VarTable.get(g),xt={Name:g,Data:gt,Type:5};F&&(xt.Color=F),y&&(xt.LineWidth=y),this.OutVarTable.push(xt)}else if(B&&g){var Ft=this.VarTable.get(g),Et={Name:g,Data:Ft,Type:6};F&&(Et.Color=F),E&&(Et.UpColor=E),L&&(Et.DownColor=L),y&&(Et.LineWidth=y),sa.IsNumber(M)&&(Et.StickType=M),this.OutVarTable.push(Et)}else if(P&&g){var Lt=this.VarTable.get(g),Mt={Name:g,Data:Lt,Type:9};F&&(Mt.Color=F),E&&(Mt.UpColor=E),L&&(Mt.DownColor=L),y&&(Mt.LineWidth=y),this.OutVarTable.push(Mt)}else if(R&&g){var yt=this.VarTable.get(g),Rt={Name:g,Data:yt,Color:F,Type:2};y&&(Rt.LineWidth=y),F&&(Rt.Color=F),E&&(Rt.UpColor=E),L&&(Rt.DownColor=L),this.OutVarTable.push(Rt)}else if(g&&F&&!x){var Nt=this.VarTable.get(g);Array.isArray(Nt)||(Nt=this.SingleDataToArrayData(Nt));var wt={Name:g,Data:Nt,Color:F,Type:0};y&&(wt.LineWidth=y),0==_&&(wt.IsShow=!1),1==V&&(wt.IsExData=!0),1==H&&(wt.IsDotLine=!0),sa.IsNonEmptyArray(it)&&(wt.LineDash=it),1==Y&&(wt.IsOverlayLine=!0),1==k&&(wt.IsSingleLine=!0),1==X&&(wt.NoneName=!0),0==W&&(wt.IsShowTitle=!1),1==G&&(wt.Type=7),this.OutVarTable.push(wt)}else if(x){p={Name:x.Name,Draw:x,Type:1};F&&(p.Color=F),1==H&&(p.IsDotLine=!0),sa.IsNonEmptyArray(it)&&(p.LineDash=it),y&&(p.LineWidth=y),U&&(p.IsDrawAbove=!0),K&&(p.IsDrawCenter=!0),z&&(p.IsDrawBelow=!0),J>=0&&(p.DrawAlign=J),Z>=0&&(p.DrawVAlign=Z),Q>0&&(p.DrawFontSize=Q),q&&(p.Background=q),j&&(p.VerticalLine=j),sa.IsNumber(tt)&&(p.XOffset=tt),sa.IsNumber(et)&&(p.YOffset=et),sa.IsBool($)&&(p.IsFirstDraw=$),sa.IsNumber(at)&&(p.KLineType=at),this.OutVarTable.push(p)}else if(g){var At=this.VarTable.get(g),Ot={Name:g,Data:At,Type:0};F&&(Ot.Color=F),y&&(Ot.LineWidth=y),0==_&&(Ot.IsShow=!1),1==V&&(Ot.IsExData=!0),1==H&&(Ot.IsDotLine=!0),sa.IsNonEmptyArray(it)&&(Ot.LineDash=it),1==Y&&(Ot.IsOverlayLine=!0),1==k&&(Ot.IsSingleLine=!0),0==W&&(Ot.IsShowTitle=!1),1==G&&(Ot.Type=7),this.OutVarTable.push(Ot)}}},this.ReadUnaryExpression=function(t,e){var a=t.Argument,i=null;if(a.Type==on.Literal)i=a.Value,Array.isArray(i)||(i=this.SingleDataToArrayData(i));else if(a.Type==on.Identifier){var r=a.Name;i=this.ReadVariable(r,t.Expression),Array.isArray(i)||(i=this.SingleDataToArrayData(i))}else if(a.Type==on.BinaryExpression)i=a.Out,Array.isArray(i)||(i=this.SingleDataToArrayData(i));else{if(a.Type!=on.CallExpression)return!1;var n=a;if(this.Draw.IsDrawFunction(n.Callee.Name))return!1;if("IFC"===n.Callee.Name&&n.Draw)return!1;i=n.Out,Array.isArray(i)||(i=this.SingleDataToArrayData(i))}return"-"==t.Operator&&i&&(i=this.Algorithm.Subtract(0,i)),e.OutVar=i,!0},this.GetOutIconData=function(t,e){if(Array.isArray(t)){for(var a=0;a<t.length&&a<e.DrawData.length;++a){var i=t[a];i<=0&&(e.DrawData[a]=null)}return e}return t?e:null},this.GetSoundEvent=function(){return this.GetEventCallback?this.GetEventCallback(m.ON_PLAY_SOUND):null},this.Run=function(){try{var t=this.RunAST();u.Complier.Log("[JSComplier.Run] execute finish",t),this.IndexCtrl&&(this.IndexCtrl.Status=0),this.UpdateUICallback&&(u.Complier.Log("[JSComplier.Run] invoke UpdateUICallback."),this.CallbackParam&&this.CallbackParam.Job&&this.CallbackParam.Job.ID==fn.JOB_EXECUTE_INDEX?this.UpdateUICallback(t,this.CallbackParam,this.SymbolData):(this.CallbackParam&&this.CallbackParam.Self&&"ScriptIndexConsole"===this.CallbackParam.Self.ClassName&&(this.CallbackParam.JSExecute=this),1==this.IsUsePageData&&(this.CallbackParam.Self.IsUsePageData=!0),this.UpdateUICallback(t,this.CallbackParam)))}catch(e){u.Complier.Log(e),e.Job?(u.Complier.Log("[JSComplier.Run] download job and reexectue",e.Job),this.JobList.push(e.Job),this.JobList.push({ID:fn.JOB_RUN_SCRIPT}),this.Execute()):this.ErrorCallback&&(this.IndexCtrl&&(this.IndexCtrl.Status=0),this.ErrorCallback(e,this.CallbackParam))}},this.DebugRun_End=function(){var t=this.OutVarTable;u.Complier.Log("[JSComplier.DebugRun_End] execute finish",t),this.IndexCtrl&&(this.IndexCtrl.Status=0),this.UpdateUICallback&&(u.Complier.Log("[JSComplier.DebugRun_End] invoke UpdateUICallback."),this.CallbackParam&&this.CallbackParam.Job&&this.CallbackParam.Job.ID==fn.JOB_EXECUTE_INDEX?this.UpdateUICallback(t,this.CallbackParam,this.SymbolData):(this.CallbackParam&&this.CallbackParam.Self&&"ScriptIndexConsole"===this.CallbackParam.Self.ClassName&&(this.CallbackParam.JSExecute=this),1==this.IsUsePageData&&(this.CallbackParam.Self.IsUsePageData=!0),this.UpdateUICallback(t,this.CallbackParam)))},this.DebugRun_Next=function(t){var e=this;if(t.ExeLine<t.LineCount){var a=this.AST.Body[t.ExeLine];this.RunASTNode(a),++t.ExeLine,this.DebugFilter(t,(function(){e.DebugRun_Next(t)}))}else this.DebugRun_End(),t.Status=2,this.DebugFilter(t,null)},this.DebugRun=function(){var t=this;try{this.AST||this.ThrowError(),this.AST.Body||this.ThrowError();var e={LineCount:this.AST.Body.length,ExeLine:0,Self:this,Status:1};this.DebugFilter(e,(function(){t.DebugRun_Next(e)}))}catch(a){this.ErrorCallback&&(this.IndexCtrl&&(this.IndexCtrl.Status=0),this.ErrorCallback(a,this.CallbackParam))}},this.VisitNode=function(t){switch(t.Type){case on.SequenceExpression:this.VisitSequenceExpression(t);break;case on.ExpressionStatement:this.VisitNode(t.Expression);break;case on.AssignmentExpression:this.VisitAssignmentExpression(t);break;case on.BinaryExpression:case on.LogicalExpression:this.VisitBinaryExpression(t);break;case on.CallExpression:this.VisitCallExpression(t);break;case on.UnaryExpression:this.VisitUnaryExpression(t);break}},this.VisitUnaryExpression=function(t){if("-"==t.Operator)var e=this.GetNodeValueEx(t.Argument),a=this.Algorithm.Subtract(0,e);else a=t.Argument.Value;return a},this.VisitSequenceExpression=function(t){for(var e in t.Expression){var a=t.Expression[e];this.VisitNode(a)}},this.GetDynamicScriptIndex=function(t,e){var a=t.Callee.Value,i=a.split(".");2!=i.length&&this.ThrowUnexpectedNode(t,"调用指标格式'".concat(a,"'错误"));var r=i[0],n=i[1],o=null,s=n.indexOf("#");-1!=s&&(o=n.slice(s+1),n=n.slice(0,s));for(var h="",l=0;l<e.length;++l){var u=e[l];h.length>0&&(h+=","),h+="".concat(u)}var C="(".concat(h,")"),D="".concat(n,"#").concat(C);if(o&&(D+="#".concat(o)),!this.VarTable.has(r))return null;var f=this.VarTable.get(r);u=f[D];return u},this.VisitCallExpression=function(t){for(var e=t.Callee.Name,a=[],i=0;i<t.Arguments.length;++i){var r=t.Arguments[i];if("IFC"===e&&i>=1)break;o=r.Type==on.BinaryExpression||r.Type==on.LogicalExpression?this.VisitBinaryExpression(r):r.Type==on.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),a.push(o)}if(t.Callee.Type==on.Literal){t.Out=[],t.Draw=null;var n=this.GetDynamicScriptIndex(t,a);return n&&(t.Out=n),t.Out}if("IFC"===e){var o,s=this.Algorithm.IFC(a[0]);r=s?t.Arguments[1]:t.Arguments[2];return o=r.Type==on.BinaryExpression||r.Type==on.LogicalExpression?this.VisitBinaryExpression(r):r.Type==on.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),t.Out=o,r.Draw&&(t.Draw=r.Draw),t.Out}if(Qr.IsCustomFunction(e)){n=this.Algorithm.CallCustomFunction(e,a,this.SymbolData,t);return t.Out=[],t.Draw=null,n&&(n.Out&&(t.Out=n.Out),n.Draw&&(t.Draw=n.Draw)),t.Out}if(Qr.IsCustomDataFunction(e)){var h=Qr.CustomDataFunction.Data.get(e);return t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:h.ArgCount,Node:t}),t.Draw=null,t.Out}switch(e){case"DYNAINFO":t.Out=this.SymbolData.GetLatestCacheData(a[0]);break;case"STICKLINE":t.Draw=this.Draw.STICKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT":t.Draw=this.Draw.DRAWTEXT(a[0],a[1],a[2]),t.Out=[];break;case"DRAWTEXT_FIX":t.Draw=this.Draw.DRAWTEXT_FIX(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"SUPERDRAWTEXT":t.Draw=this.Draw.SUPERDRAWTEXT(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWICON":t.Draw=this.Draw.DRAWICON(a[0],a[1],a[2]),t.Out=[];break;case"ICON":t.Draw=this.Draw.ICON(a[0],a[1]),t.Out=[];break;case"TIPICON":t.Draw=this.Draw.TIPICON(a[0],a[1],a[2],a[3]),t.Out=[];break;case"BACKGROUND":t.Draw=this.Draw.BACKGROUND(a[0],a[1],a[2],a[3],a[4],a[5]),t.Out=[];break;case"CKLINE":t.Draw=this.Draw.CKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWLINE":t.Draw=this.Draw.DRAWLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=t.Draw.DrawData;break;case"DRAWBAND":t.Draw=this.Draw.DRAWBAND(a[0],a[1],a[2],a[3]),t.Out=[];break;case"FILLRGN":a.length>=4?t.Draw=this.Draw.FILLRGN2(a):t.Draw=this.Draw.FILLRGN(a[0],a[1],a[2]),t.Out=[];break;case"FLOATRGN":t.Draw=this.Draw.FLOATRGN(a),t.Out=[];break;case"FILLTOPRGN":t.Draw=this.Draw.FILLBGRGN(1,a),t.Out=[];break;case"FILLBOTTOMRGN":t.Draw=this.Draw.FILLBGRGN(0,a),t.Out=[];break;case"FILLVERTICALRGN":t.Draw=this.Draw.FILLVERTICALRGN(a),t.Out=[];break;case"DRAWKLINE":case"DRAWKLINE1":t.Draw=this.Draw.DRAWKLINE(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWKLINE_IF":t.Draw=this.Draw.DRAWKLINE_IF(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"KLINETYPE":t.Out=this.Draw.KLINETYPE(a[0]);break;case"DRAWOVERLAYKLINE":t.Draw=this.Draw.DRAWOVERLAYKLINE(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWCOLORKLINE":t.Draw=this.Draw.DRAWCOLORKLINE(a[0],a[1],a[2]),t.Out=[];break;case"PLOYLINE":case"POLYLINE":t.Draw=this.Draw.POLYLINE(a[0],a[1]),t.Out=t.Draw.DrawData;break;case"DRAWNUMBER":t.Draw=this.Draw.DRAWNUMBER(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Value;break;case"DRAWNUMBER_FIX":t.Draw=this.Draw.DRAWNUMBER_FIX(a[0],a[1],a[2],a[3],a[4]),t.Out=t.Draw.DrawData.Value;break;case"DRAWCHANNEL":t.Draw=this.Draw.DRAWCHANNEL(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),t.Out=[];break;case"RGB":t.Out=this.Draw.RGB(a[0],a[1],a[2]);break;case"RGBA":t.Out=this.Draw.RGBA(a[0],a[1],a[2],a[3]);break;case"UPCOLOR":t.Out=this.Draw.UPCOLOR(a[0]);break;case"DOWNCOLOR":t.Out=this.Draw.DOWNCOLOR(a[0]);break;case"STICKTYPE":t.Out=this.Draw.STICKTYPE(a[0]);break;case"XMOVE":t.Out=this.Draw.XMOVE(a[0]);break;case"YMOVE":t.Out=this.Draw.YMOVE(a[0]);break;case"LINEDASH":t.Out=this.Draw.LINEDASH(a);break;case"FIRSTDRAW":t.Out=this.Draw.FIRSTDRAW(a[0]);break;case"PARTLINE":t.Draw=this.Draw.PARTLINE(a),t.Out=[];break;case"DRAWGBK":t.Draw=this.Draw.DRAWGBK(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWGBK2":t.Draw=this.Draw.DRAWGBK2(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWGBK_DIV":t.Draw=this.Draw.DRAWGBK_DIV(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT_LINE":t.Draw=this.Draw.DRAWTEXT_LINE(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),t.Out=[];break;case"DRAWRECTREL":t.Draw=this.Draw.DRAWRECTREL(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXTREL":t.Draw=this.Draw.DRAWTEXTREL(a[0],a[1],a[2]),t.Out=[];break;case"DRAWTEXTABS":t.Draw=this.Draw.DRAWTEXTABS(a[0],a[1],a[2]),t.Out=[];break;case"DRAWOVERLAYLINE":t.Draw=this.Draw.DRAWOVERLAYLINE(a[0],a[1],a[2]),t.Out=t.Draw.DrawData.Data;break;case"DRAWSL":t.Draw=this.Draw.DRAWSL(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"VERTLINE":t.Draw=this.Draw.VERTLINE(a[0],a[1]),t.Out=t.Draw.DrawData.Data;break;case"HORLINE":t.Draw=this.Draw.HORLINE(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Data;break;case"DRAWLASTBARICON":t.Draw=this.Draw.DRAWLASTBARICON(a[0],a[1]),t.Out=[];break;case"DRAWLASTBARNUMBER":t.Draw=this.Draw.DRAWLASTBARNUMBER(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWLASTBARTEXT":t.Draw=this.Draw.DRAWLASTBARTEXT(a[0],a[1]),t.Out=[];break;case"CODELIKE":t.Out=this.SymbolData.CODELIKE(a[0]);break;case"NAMELIKE":case"NAMEINCLUDE":t.Out=this.SymbolData.NAMELIKE(a[1]);break;case"REFDATE":t.Out=this.SymbolData.REFDATE(a[0],a[1]);break;case"FINANCE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINONE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"GPJYVALUE":case"SCJYVALUE":case"BKJYVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"GPJYONE":case"SCJYONE":case"BKJYONE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:4,Node:t});break;case"MARGIN":t.Out=this.SymbolData.GetMarginCacheData(a[0],t);break;case"HK2SHSZ":t.Out=this.SymbolData.GetHKToSHSZCacheData(a[0],t);break;case"NEWS":t.Out=this.SymbolData.GetNewsAnalysisCacheData(a[0],t);break;case"UPCOUNT":case"DOWNCOUNT":t.Out=this.SymbolData.GetIndexIncreaseCacheData(e,a[0],t);break;case"SF":t.Out=this.SymbolData.GetSectionFinanceCacheData(a[0],a[1],a[2],t);break;case"LOADAPIDATA":t.Out=this.SymbolData.GetCustomApiData(a);break;case"STKINDI":case"CALCSTOCKINDEX":t.Out=this.SymbolData.GetScriptIndexOutData(a,t,e);break;case"SOUND":t.Draw=this.Draw.SOUND(a[0]),t.Out=[];break;case"PLAYSOUND":t.Draw=this.Draw.PLAYSOUND(a[0],a[1]),t.Out=[];break;case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":t.Out=this.SymbolData.GetOtherSymolCacheData({FunctionName:e,Args:a});break;case"INBLOCK":t.Out=this.SymbolData.IsInBlock(a[0],t);break;case"COVER_C":case"COVER_O":case"COVER_H":case"COVER_L":case"COVER_A":case"COVER_V":return 2==a.length?this.SymbolData.GetSymbolPeriodCacheData2(en.GetConvertValueName(e),a[0],a[1]):this.SymbolData.GetSymbolPeriodCacheData(en.GetConvertValueName(e),a[0]);case"SYSPARAM":t.Out=this.SymbolData.SysParam(a[0],this);break;case"TESTSKIP":var l=this.Algorithm.TESTSKIP(a[0],t);if(t.Out=null,l&&(this.Interrupt.Exit=!0,t&&t.Marker)){var u=t.Marker;this.Interrupt.Line=u.Line,this.Interrupt.Index=u.Index,this.Interrupt.Column=u.Column}break;case"BUY":t.Draw=this.Draw.BUY(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Data;break;case"SELL":t.Draw=this.Draw.SELL(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Data;break;case"SELLSHORT":t.Draw=this.Draw.SELLSHORT(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Data;break;case"BUYSHORT":t.Draw=this.Draw.BUYSHORT(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Data;break;case"TABLE_CELL":t.Out=this.Draw.TABLE_CELL(a[0],a[1],a[2],a[3]);break;case"TABLE_ROW":t.Out=this.Draw.TABLE_ROW(a);break;case"DRAWTABLE":t.Draw=this.Draw.DRAWTABLE(a),t.Out=[];break;case"PIE_CELL":t.Out=this.Draw.PIE_CELL(a[0],a[1],a[2],a[3],a[4]);break;case"DRAWPIE":t.Draw=this.Draw.DRAWPIE(a),t.Out=[];break;case"DRAWDOUGHNUT":t.Draw=this.Draw.DRAWDOUGHNUT(a),t.Out=[];break;case"RADAR_CELL":t.Out=this.Draw.RADAR_CELL(a[0],a[1],a[2],a[3]);break;case"DRAWRADAR":t.Draw=this.Draw.DRAWRADAR(a),t.Out=[];break;default:t.Out=this.Algorithm.CallFunction(e,a,t,this.SymbolData);break}return t.Out},this.VisitAssignmentExpression=function(t){var e=t.Left;e.Type!=on.Identifier&&this.ThrowUnexpectedNode(t);var a=e.Name,i=t.Right,r=null,n=null;i.Type==on.BinaryExpression||i.Type==on.LogicalExpression?r=this.VisitBinaryExpression(i):i.Type==on.CallExpression?(r=this.VisitCallExpression(i),i.Draw&&(n=i.Draw)):i.Type==on.Literal?(r=i.Value,sa.IsString(r)&&i.Value.indexOf("$")>0&&(r=this.SymbolData.GetOtherSymolCacheData({Literal:r}))):i.Type==on.Identifier?r=this.ReadVariable(i.Name,i):i.Type==on.MemberExpression?r=this.ReadMemberVariable(i):i.Type==on.UnaryExpression&&(r=this.VisitUnaryExpression(i)),n&&this.VarDrawTable.set(a,n),this.VarTable.set(a,r)},this.VisitBinaryExpression=function(t){var e=[];e.push(t);var a=null;while(0!=e.length)if(a=e[e.length-1],a.Left&&t!=a.Left&&t!=a.Right)e.push(a.Left);else if(a.Right&&t!=a.Right)e.push(a.Right);else{var i=e.pop();if(i.Type==on.BinaryExpression){var r=this.GetNodeValue(i.Left),n=this.GetNodeValue(i.Right);switch(i.Out=null,i.Operator){case"-":i.Out=this.Algorithm.Subtract(r,n);break;case"*":i.Out=this.Algorithm.Multiply(r,n);break;case"/":i.Out=this.Algorithm.Divide(r,n);break;case"+":i.Out=this.Algorithm.Add(r,n);break;case">":i.Out=this.Algorithm.GT(r,n);break;case">=":i.Out=this.Algorithm.GTE(r,n);break;case"<":i.Out=this.Algorithm.LT(r,n);break;case"<=":i.Out=this.Algorithm.LTE(r,n);break;case"==":case"=":i.Out=this.Algorithm.EQ(r,n);break;case"!=":case"<>":i.Out=this.Algorithm.NEQ(r,n);break}0}else if(i.Type==on.LogicalExpression){var o=this.GetNodeValue(i.Left),s=this.GetNodeValue(i.Right);switch(i.Out=null,i.Operator){case"&&":case"AND":i.Out=this.Algorithm.And(o,s);break;case"||":case"OR":i.Out=this.Algorithm.Or(o,s);break}0}t=a}return t.Out},this.GetNodeValueEx=function(t){var e=null;return e=t.Type==on.BinaryExpression||t.Type==on.LogicalExpression?this.VisitBinaryExpression(t):t.Type==on.CallExpression?this.VisitCallExpression(t):this.GetNodeValue(t),e},this.GetNodeValue=function(t){switch(t.Type){case on.Literal:return t.Value;case on.UnaryExpression:var e=this.VisitUnaryExpression(t);return e;case on.Identifier:e=this.ReadVariable(t.Name,t);return e;case on.BinaryExpression:case on.LogicalExpression:return t.Out;case on.CallExpression:return this.VisitCallExpression(t);case on.MemberExpression:return this.ReadMemberVariable(t);default:this.ThrowUnexpectedNode(t)}},this.ThrowUnexpectedNode=function(t,e,a){var i=t.Marker,r=e||"执行异常";return this.ErrorHandler.ThrowError(i.Index,i.Line,i.Column,r,a)},this.ThrowDownloadSF=function(t,e,a){var i=t.Marker,r=a;return this.ErrorHandler.ThrowDownloadJob(i.Index,i.Line,i.Column,r,e)},this.ThrowError=function(){}}function dn(t,e){this.AST=t,this.ErrorHandler=new an,this.ErrorCallback,this.UpdateUICallback,this.CallbackParam,this.JobList=[],this.VarTable=new Map,this.OutVarTable=[],this.MaxValueLength=150,this.ConstVarTable=new Map([["CLOSE","收盘价"],["VOL","成交量"],["OPEN","开盘价"],["HIGH","最高价"],["LOW","最低价"],["AMOUNT","成交量"],["C","收盘价"],["V","成交量"],["O","开盘价"],["H","最高价"],["L","最低价"],["AMO","成交量"],["VOLR","量比"],["VOLINSTK","持仓量"],["OPI","持仓量"],["ZSTJJ","均价"],["QHJSJ","结算价"],["SETTLE","结算价"],["DATE","日期"],["YEAR","年份"],["MONTH","月份"],["DAY","日"],["PERIOD","周期"],["WEEK","星期"],["TIME","时间"],["INDEXA","大盘成交额"],["INDEXC","大盘收盘价"],["INDEXH","大盘最高价"],["INDEXL","大盘最低价"],["INDEXO","大盘开盘价"],["INDEXV","大盘成交量"],["INDEXADV","大盘上涨家数"],["INDEXDEC","´大盘下跌家数"],["ADVANCE","上涨家数"],["DECLINE","下跌家数"],["FROMOPEN","当前离开盘分钟数"],["TOTALFZNUM","总分钟数"],["CURRBARSCOUNT","到最后交易的周期"],["TOTALBARSCOUNT","总的周期数"],["ISLASTBAR","是否是最后一个周期"],["BARSTATUS","数据位置状态"],["CAPITAL","当前流通股本(手)"],["TOTALCAPITAL","当前总股本(手)"],["EXCHANGE","换手率"],["HSL","换手线"],["SETCODE","市场类型"],["CODE","品种代码"],["STKNAME","品种名称"],["TQFLAG","当前复权状态"],["HYBLOCK","所属行业"],["DYBLOCK","所属地域"],["GNBLOCK","所属概念"],["FGBLOCK","所属风格板块"],["ZSBLOCK","所属指数板块"],["ZHBLOCK","所属组合板块"],["ZDBLOCK","所属自定义板块"],["HYZSCODE","所属行业的板块指数代码"],["GNBLOCKNUM","所属概念板块的个数"],["FGBLOCKNUM","所属风格板块的个数"],["ZSBLOCKNUM","所属指数板块的个数"],["ZHBLOCKNUM","所属组合板块的个数"],["ZDBLOCKNUM","所属自定义板块的个数"],["HYSYL","指数市盈率或个股所属行业的市盈率"],["HYSJL","指数市净率或个股所属行业的市净率"],["DRAWNULL","无效数据"],["TR","求真实波幅"],["LARGEINTRDVOL","逐笔买入大单成交量"],["LARGEOUTTRDVOL","逐笔卖出大单成交量"],["TRADENUM","逐笔成交总单数"],["TRADEINNUM","逐笔买入成交单数"],["TRADEOUTNUM","逐笔卖出成交单数"],["LARGETRDINNUM","逐笔买入大单成交单数"],["LARGETRDOUTNUM","逐笔卖出大单成交单数"],["CUR_BUYORDER","总委买量"],["CUR_SELLORDER","总委卖量"],["ACTINVOL","主动买成交量"],["ACTOUTVOL","主动卖成交量"],["BIDORDERVOL","累计总有效委买量"],["BIDCANCELVOL","累计总有效撤买量"],["AVGBIDPX","最新委买均价"],["OFFERORDERVOL","累计总有效委卖量"],["OFFERCANCELVOL","累计总有效撤卖量"],["AVGOFFERPX","最新委卖均价"],["COLORBLACK","黑色"],["COLORBLUE","蓝色"],["COLORGREEN","绿色"],["COLORCYAN","青色"],["COLORRED","红色"],["COLORMAGENTA","洋红色"],["COLORBROWN","棕色"],["COLORLIGRAY","淡灰色"],["COLORGRAY","深灰色"],["COLORLIBLUE","淡蓝色"],["COLORLIGREEN","淡绿色"],["COLORLICYAN","淡青色"],["COLORLIRED","淡红色"],["COLORLIMAGENTA","淡洋红色"],["COLORWHITE","白色"],["COLORYELLOW","黄色"]]),e&&(e.Callback&&(this.UpdateUICallback=e.Callback),e.CallbackParam&&(this.CallbackParam=e.CallbackParam),e.Arguments&&(this.Arguments=e.Arguments)),this.Run=function(){try{for(var t in this.OutVarTable=[],this.VarTable=new Map,u.Complier.Log("[JSExecute::JSExplainer] Load Arguments",this.Arguments),this.Arguments){var e=this.Arguments[t];this.VarTable.set(e.Name,e.Value)}var a=this.RunAST();u.Complier.Log("[JSExplainer.Run] explain finish",a),this.UpdateUICallback&&(u.Complier.Log("[JSExplainer.Run] invoke UpdateUICallback."),this.UpdateUICallback(a))}catch(i){u.Complier.Log("[JSExplainer.Run] throw error ",i),this.ErrorCallback&&this.ErrorCallback(i,this.OutVarTable)}},this.RunAST=function(){this.AST||this.ThrowError(),this.AST.Body||this.ThrowError();for(var t=0;t<this.AST.Body.length;++t){var e=this.AST.Body[t];if(this.VisitNode(e),e.Type==on.ExpressionStatement&&e.Expression)if(e.Expression.Type==on.AssignmentExpression){if(":"==e.Expression.Operator&&e.Expression.Left){var a=e.Expression,i=a.Left.Name,r="输出".concat(i,": ").concat(this.VarTable.get(i));this.OutVarTable.push({Name:i,Data:r,Type:0})}else if(":="==e.Expression.Operator&&e.Expression.Left){var n=e.Expression,o=n.Left.Name,s="赋值".concat(o,": ").concat(this.VarTable.get(o));this.OutVarTable.push({Name:o,Data:s,Type:0,IsOut:!1})}}else if(e.Expression.Type==on.CallExpression){var h=e.Expression;if(this.IsDrawFunction(h.Callee.Name)){var l=h.Out,C=h.Callee.Name;this.OutVarTable.push({Name:C,Draw:"输出: ".concat(l),Type:1})}else{var D=h.Out;d="__temp_c_".concat(h.Callee.Name,"_").concat(t,"__"),this.OutVarTable.push({Name:d,Data:"输出: ".concat(D),Type:0,NoneName:!0})}}else if(e.Expression.Type==on.Identifier){var f=e.Expression.Name,c=this.ReadVariable(f,e.Expression);f="__temp_i_"+t+"__",this.OutVarTable.push({Name:f,Data:"输出: ".concat(c),Type:0,NoneName:!0})}else if(e.Expression.Type==on.Literal){var m=e.Expression.Value;sa.IsString(m)&&m.indexOf("$")>0&&(m=this.GetOtherSymbolExplain({Literal:m},e)),d="__temp_li_"+t+"__";this.OutVarTable.push({Name:d,Data:"输出: ".concat(m),Type:0,NoneName:!0})}else if(e.Expression.Type==on.BinaryExpression){var d="__temp_b_"+t+"__",I=e.Expression.Out;this.OutVarTable.push({Name:d,Data:"输出: ".concat(I),Type:0,NoneName:!0})}else if(e.Expression.Type==on.LogicalExpression){d="__temp_l_"+t+"__";var S=e.Expression.Out;this.OutVarTable.push({Name:d,Data:"输出: ".concat(S),Type:0,NoneName:!0})}else if(e.Expression.Type==on.UnaryExpression){d="__temp_l_"+t+"__";var T=e.Expression.Argument,v=null;if(T.Type==on.Literal)v=T.Value;else if(T.Type==on.Identifier){var p=T.Name;v=this.ReadVariable(p,e.Expression)}else T.Type==on.BinaryExpression&&(v=T.Out);"-"==e.Expression.Operator&&(v="-".concat(v)),this.OutVarTable.push({Name:d,Data:"输出: ".concat(v),Type:0,NoneName:!0})}else if(e.Expression.Type==on.SequenceExpression){var g,x=void 0,F=void 0,E=void 0,L=void 0,M=void 0,y=!1,R=!1,N=!1,w=!1,A=!1,O=!1,b=!0,B=!1,P=!1,G=!1;for(var _ in e.Expression.Expression){var V=e.Expression.Expression[_];if(V.Type==on.AssignmentExpression&&":"==V.Operator&&V.Left){x=V.Left.Name;var H=this.VarTable.get(x);this.VarTable.set(x,this.ConvertToShortValue(H))}else if(V.Type==on.Identifier){var Y=V.Name;if("COLORSTICK"===Y)y=!0;else if("POINTDOT"===Y)R=!0;else if("CIRCLEDOT"===Y)N=!0;else if("DOTLINE"===Y)B=!0;else if("LINESTICK"===Y)w=!0;else if("STICK"===Y)A=!0;else if("VOLSTICK"===Y)O=!0;else if("DRAWABOVE"===Y)G=!0;else if(0==Y.indexOf("COLOR"))L=Y;else if(0==Y.indexOf("LINETHICK"))M=Y;else if("ALIGN0"==Y)0;else if("ALIGN1"==Y)1;else if("ALIGN2"==Y)2;else if("VALIGN0"==Y)0;else if("VALIGN1"==Y)1;else if("VALIGN2"==Y)2;else if(0==Y.indexOf("NODRAW"))b=!1;else if(0==Y.indexOf("EXDATA"))!0;else if(0==Y.indexOf("LINEOVERLAY"))!0;else if(0==Y.indexOf("FONTSIZE")){var k=Y.replace("FONTSIZE","");parseInt(k)}else{x=V.Name;var X=this.ReadVariable(x,V);x="__temp_si_"+t+"__",P=!0,this.VarTable.set(x,this.ConvertToShortValue(X))}}else if(V.Type==on.Literal){var W=V.Value;x=V.Value.toString(),P=!0,this.VarTable.set(x,W)}else if(V.Type==on.CallExpression){if(0==_)if(this.IsDrawFunction(V.Callee.Name))E=V.Out,F=V.Callee.Name;else{var U=V.Out;x="__temp_sc_".concat(V.Callee.Name,"_").concat(t,"__"),P=!0,this.VarTable.set(x,U)}}else if(V.Type==on.BinaryExpression){x="__temp_sb_"+t+"__";var K=V.Out;P=!0,this.VarTable.set(x,K)}else if(V.Type==on.UnaryExpression){x="__temp_sb_"+t+"__";T=V.Argument;var z=null;if(T.Type==on.Literal)z=T.Value;else if(T.Type==on.Identifier){var J=T.Name;z=this.ReadVariable(J,e.Expression)}else T.Type==on.BinaryExpression&&(z=T.Out);"-"==V.Operator&&(z="-".concat(z)),P=!0,this.VarTable.set(x,z)}}if(g=E?"输出: ".concat(E):P?"输出: ".concat(this.VarTable.get(x)):"输出".concat(x,": ").concat(this.VarTable.get(x)),L&&(g+=",颜色".concat(this.GetColorExplain(L))),M&&(g+=",线段粗细".concat(this.GetLineWidthExplain(M))),0==b&&(g+=",不显示"),1==B&&(g+=",画虚线"),1==G&&(g+=",显示在位置之上"),R&&x){g+=",画小圆点线";var Z={Name:x,Draw:g,Radius:qi.POINTDOT.Radius,Type:3};this.OutVarTable.push(Z)}else if(N&&x){g+=",画小圆圈线";var Q={Name:x,Draw:g,Radius:qi.CIRCLEDOT.Radius,Type:3};this.OutVarTable.push(Q)}else if(w&&x){g+=",画出柱状线和指标线";var q={Name:x,Draw:g,Type:4};this.OutVarTable.push(q)}else if(A&&x){g+=",画柱状线";var j={Name:x,Draw:g,Type:5};this.OutVarTable.push(j)}else if(O&&x){g+=",画成交量柱状线";var $={Name:x,Draw:g,Type:6};this.OutVarTable.push($)}else if(x&&L){var tt={Name:x,Data:g,Color:L,Type:0};this.OutVarTable.push(tt)}else if(E){var et={Name:F,Draw:g,Type:1};this.OutVarTable.push(et)}else if(y&&x){g+=",画彩色柱状线";var at={Name:x,Draw:g,Color:L,Type:2};this.OutVarTable.push(at)}else if(x){var it={Name:x,Data:g,Type:0};this.OutVarTable.push(it)}}}return u.Complier.Log("[JSExplainer::Run]",this.VarTable),this.OutVarTable},this.VisitNode=function(t){switch(t.Type){case on.SequenceExpression:this.VisitSequenceExpression(t);break;case on.ExpressionStatement:this.VisitNode(t.Expression);break;case on.AssignmentExpression:this.VisitAssignmentExpression(t);break;case on.BinaryExpression:case on.LogicalExpression:this.VisitBinaryExpression(t);break;case on.CallExpression:this.VisitCallExpression(t);break;case on.UnaryExpression:this.VisitUnaryExpression(t);break}},this.VisitSequenceExpression=function(t){for(var e in t.Expression){var a=t.Expression[e];this.VisitNode(a)}},this.VisitUnaryExpression=function(t){if("-"==t.Operator){var e=this.GetNodeValueEx(t.Argument);return"-"+e}return t.Argument.Value},this.VisitCallExpression=function(t){var e=t.Callee.Name,a=[];for(var i in t.Arguments){var r=t.Arguments[i],n=void 0;n=r.Type==on.BinaryExpression||r.Type==on.LogicalExpression?this.VisitBinaryExpression(r):r.Type==on.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),a.push(n)}if(t.Callee.Type==on.Literal){var o=t.Callee.Value;return t.Out="指标引用'".concat(o,"'"),t.Out}if(Qr.IsCustomFunction(e)){var s=Qr.CustomFunction.Data.get(e);return s.Description?t.Out=s.Description:t.Out="自定义函数".concat(e),t.Out}return t.Out=this.CallFunctionExplain(e,a,t),t.Out},this.FUNCTION_INFO_LIST=new Map([["REF",{Name:"REF",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日前的").concat(t[0])}}],["REFX",{Name:"REFX",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日后的").concat(t[0])}}],["REFV",{Name:"REFV",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日前的(未作平滑处理)").concat(t[0])}}],["REFXV",{Name:"REFXV",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日后的(未作平滑处理)").concat(t[0])}}],["REFDATE",{Name:"REFDATE",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日").concat(t[0])}}],["COUNT",{Name:"COUNT",Param:{Count:2},ToString:function(t){return"统计".concat(t[1],"日中满足").concat(t[0],"的天数")}}],["BARSLASTCOUNT",{Name:"BARSLASTCOUNT",Param:{Count:1},ToString:function(t){return"条件".concat(t[0],"连续成立次数")}}],["BARSCOUNT",{Name:"BARSCOUNT",Param:{Count:1},ToString:function(t){return"".concat(t[0],"有效数据周期数")}}],["BARSLAST",{Name:"BARSLAST",Param:{Count:1},ToString:function(t){return"上次".concat(t[0],"不为0距今天数")}}],["BARSLASTS",{Name:"BARSLASTS",Param:{Count:2},ToString:function(t){return"倒数第N次成立时距今的周期数"}}],["BARSNEXT",{Name:"BARSNEXT",Param:{Count:1},ToString:function(t){return"下次".concat(t[0],"不为0距今天数")}}],["BARSSINCEN",{Name:"BARSSINCEN",Param:{Count:2},ToString:function(t){return"在".concat(t[1],"周期内首次").concat(t[0],"距今天数")}}],["BARSSINCE",{Name:"BARSSINCE",Param:{Count:1},ToString:function(t){return"首次".concat(t[0],"距今天数")}}],["HHV",{Name:"HHV",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日内").concat(t[0],"的最高值")}}],["LLV",{Name:"LLV",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日内").concat(t[0],"的最低值")}}],["ZTPRICE",{Name:"ZTPRICE",Param:{Count:2},ToString:function(t){return"计算涨停价"}}],["DTPRICE",{Name:"DTPRICE",Param:{Count:2},ToString:function(t){return"计算跌停价"}}],["BACKSET",{Name:"BACKSET",Param:{Count:2},ToString:function(t){return"若".concat(t[0],"则将最近").concat(t[1],"周期置为1")}}],["HOD",{Name:"HOD",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日内").concat(t[0],"的高值名次")}}],["LOD",{Name:"LOD",Param:{Count:2},ToString:function(t){return"".concat(t[1],"日内").concat(t[0],"的低值名次")}}],["REVERSE",{Name:"REVERSE",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的相反数")}}],["FILTER",{Name:"FILTER",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日过滤")}}],["FILTERX",{Name:"FILTERX",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日反向过滤")}}],["TFILTER",{Name:"TFILTER",Param:{Count:3},ToString:function(t){return"信号过滤(多头)"}}],["SUMBARS",{Name:"SUMBARS",Param:{Count:2},ToString:function(t){return"".concat(t[0],"累加至").concat(t[1],"的天数")}}],["MA",{Name:"MA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日简单移动平均")}}],["SMA",{Name:"SMA",Param:{Count:3},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日[").concat(t[2],"日权重]移动平均")}}],["MEMA",{Name:"MEMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日平滑移动平均")}}],["EMA",{Name:"EMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日指数移动平均")}}],["EXPMA",{Name:"EXPMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日指数移动平均")}}],["EXPMEMA",{Name:"EXPMEMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日指数平滑移动平均")}}],["WMA",{Name:"WMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日加权移动平均")}}],["DMA",{Name:"DMA",Param:{Count:2},ToString:function(t){return"以".concat(t[1],"为权重").concat(t[0],"的动态移动平均")}}],["XMA",{Name:"XMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日偏移移动平均")}}],["RANGE",{Name:"RANGE",Param:{Count:3},ToString:function(t){return"".concat(t[0],"位于").concat(t[1],"和").concat(t[2],"之间")}}],["CONST",{Name:"CONST",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的最后一日值")}}],["TOPRANGE",{Name:"TOPRANGE",Param:{Count:1},ToString:function(t){return"当前值是近".concat(t[0],"周期的最大值")}}],["LOWRANGE",{Name:"LOWRANGE",Param:{Count:1},ToString:function(t){return"当前值是近".concat(t[0],"周期的最小值")}}],["FINDHIGH",{Name:"FINDHIGH",Param:{Count:4},ToString:function(t){return"".concat(t[0],"在").concat(t[1],"日前的").concat(t[2],"天内第").concat(t[3],"个最高价")}}],["FINDHIGHBARS",{Name:"FINDHIGHBARS",Param:{Count:4},ToString:function(t){return"".concat(t[0],"在").concat(t[1],"日前的").concat(t[2],"天内第").concat(t[3],"个最高价到当前周期的周期数")}}],["FINDLOW",{Name:"FINDLOW",Param:{Count:4},ToString:function(t){return"".concat(t[0],"在").concat(t[1],"日前的").concat(t[2],"天内第").concat(t[3],"个最低价")}}],["FINDLOWBARS",{Name:"FINDLOWBARS",Param:{Count:2},ToString:function(t){return"".concat(t[0],"在").concat(t[1],"日前的").concat(t[2],"天内第").concat(t[3],"个最低价到当前周期的周期数")}}],["SUM",{Name:"SUM",Param:{Count:2},ToString:function(t){return"".concat(t[0]).concat(t[1],"日累加")}}],["MULAR",{Name:"MULAR",Param:{Count:2},ToString:function(t){return"".concat(t[0],"和").concat(t[1],"日累乘")}}],["AMA",{Name:"AMA",Param:{Count:2},ToString:function(t){return"以".concat(t[1],"为权重").concat(t[0],"的自适应均线")}}],["TMA",{Name:"TMA",Param:{Count:3},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日[").concat(t[2],"日权重]移动平均")}}],["CROSS",{Name:"CROSS",Param:{Count:2},ToString:function(t){return"".concat(t[0],"上穿").concat(t[1])}}],["LONGCROSS",{Name:"LONGCROSS",Param:{Count:3},ToString:function(t){return"".concat(t[0],"小于").concat(t[1],"保持").concat(t[2],"个交易日后交叉上穿")}}],["UPNDAY",{Name:"UPNDAY",Param:{Count:2},ToString:function(t){return"最近".concat(t[1],"日").concat(t[0],"连涨")}}],["DOWNNDAY",{Name:"DOWNNDAY",Param:{Count:2},ToString:function(t){return"最近".concat(t[1],"日").concat(t[0],"连跌")}}],["NDAY",{Name:"NDAY",Param:{Count:3},ToString:function(t){return"最近".concat(t[2],"日").concat(t[0],"一直大于").concat(t[1])}}],["EXIST",{Name:"EXIST",Param:{Count:2},ToString:function(t){return"最近".concat(t[1],"日存在").concat(t[0])}}],["EXISTR",{Name:"EXISTR",Param:{Count:3},ToString:function(t){return"从前".concat(t[1],"日到前").concat(t[2],"日存在").concat(t[0])}}],["EVERY",{Name:"EVERY",Param:{Count:2},ToString:function(t){return"最近".concat(t[1],"日一直存在").concat(t[0])}}],["LAST",{Name:"LAST",Param:{Count:3},ToString:function(t){return"从前".concat(t[1],"日到前").concat(t[2],"日持续").concat(t[0])}}],["NOT",{Name:"NOT",Param:{Count:1},ToString:function(t){return"".concat(t[0],"取反")}}],["IF",{Name:"IF",Param:{Count:3},ToString:function(t){return"如果".concat(t[0],",返回").concat(t[1],",否则返回").concat(t[2])}}],["IFF",{Name:"IFF",Param:{Count:3},ToString:function(t){return"如果".concat(t[0],",返回").concat(t[1],",否则返回").concat(t[2])}}],["IFN",{Name:"IFN",Param:{Count:3},ToString:function(t){return"如果".concat(t[0],",返回").concat(t[1],",否则返回").concat(t[2])}}],["IFC",{Name:"IFC",Param:{Count:3},ToString:function(t){return"如果".concat(t[0],",返回").concat(t[1],",否则返回").concat(t[2])}}],["TESTSKIP",{Name:"TESTSKIP",Param:{Count:1},ToString:function(t){return"如果满足条件".concat(t[0],",公式返回")}}],["VALUEWHEN",{Name:"VALUEWHEN",Param:{Count:2},ToString:function(t){return"如果".concat(t[0],",返回").concat(t[1],",否则返回上个输出值 ")}}],["MAX",{Name:"MAX",Param:{Count:2},ToString:function(t){return"".concat(t[0],"和").concat(t[1],"的较大值")}}],["MIN",{Name:"MIN",Param:{Count:2},ToString:function(t){return"".concat(t[0],"和").concat(t[1],"的较小值")}}],["ACOS",{Name:"ACOS",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的反余弦")}}],["ASIN",{Name:"ASIN",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的反正弦")}}],["ATAN",{Name:"ATAN",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的反正切")}}],["COS",{Name:"COS",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的余弦")}}],["SIN",{Name:"SIN",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的正弦")}}],["TAN",{Name:"TAN",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的正切")}}],["EXP",{Name:"EXP",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的指数")}}],["LN",{Name:"LN",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的自然对数")}}],["LOG",{Name:"LOG",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的对数")}}],["SQRT",{Name:"SQRT",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的开方")}}],["ABS",{Name:"ABS",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的绝对值")}}],["POW",{Name:"POW",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"乘幂")}}],["CEILING",{Name:"CEILING",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的向上舍入")}}],["FLOOR",{Name:"FLOOR",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的向上舍入")}}],["INTPART",{Name:"INTPART",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的整数部分")}}],["BETWEEN",{Name:"BETWEEN",Param:{Count:3},ToString:function(t){return"".concat(t[0],"位于").concat(t[1],"和").concat(t[2],"之间")}}],["FRACPART",{Name:"FRACPART",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的小数部分")}}],["ROUND",{Name:"ROUND",Param:{Count:1},ToString:function(t){return"对".concat(t[0],"(进行)四舍五入")}}],["ROUND2",{Name:"ROUND2",Param:{Count:2},ToString:function(t){return"对".concat(t[0],"(进行)四舍五入")}}],["SIGN",{Name:"SIGN",Param:{Count:1},ToString:function(t){return"".concat(t[0],"的符号")}}],["MOD",{Name:"MOD",Param:{Count:2},ToString:function(t){return"".concat(t[0],"关于").concat(t[1],"的模")}}],["RAND",{Name:"RAND",Param:{Count:1},ToString:function(t){return"随机正整数"}}],["AVEDEV",{Name:"AVEDEV",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日平均绝对偏差")}}],["DEVSQ",{Name:"DEVSQ",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日数据偏差平方和")}}],["FORCAST",{Name:"FORCAST",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日线性回归预测值")}}],["TSMA",{Name:"TSMA",Param:{Count:2},ToString:function(t){return"".concat(t[0],"在").concat(t[1],"个周期内的时间序列三角移动平均")}}],["SLOPE",{Name:"SLOPE",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日线性回归斜率")}}],["STD",{Name:"STD",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日估算标准差")}}],["STDP",{Name:"STDP",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日总体标准差")}}],["STDDEV",{Name:"STDDEV",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日标准偏差")}}],["VAR",{Name:"VAR",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日估算样本方差")}}],["VARP",{Name:"VARP",Param:{Count:2},ToString:function(t){return"".concat(t[0],"的").concat(t[1],"日总体样本方差")}}],["COVAR",{Name:"COVAR",Param:{Count:3},ToString:function(t){return"".concat(t[0],"和").concat(t[1],"的").concat(t[2],"周期的协方差")}}],["RELATE",{Name:"RELATE",Param:{Count:3},ToString:function(t){return"".concat(t[0],"和").concat(t[1],"的").concat(t[0],"周期的相关系数")}}],["BETA",{Name:"BETA",Param:{Count:1},ToString:function(t){return"β(Beta)系数"}}],["BETAEX",{Name:"BETAEX",Param:{Count:3},ToString:function(t){return"".concat(t[0],"和").concat(t[1],"的").concat(t[2],"周期的相关放大系数")}}],["COST",{Name:"COST",Param:{Count:1},ToString:function(t){return"获利盘为".concat(t[0],"%的成本分布")}}],["WINNER",{Name:"WINNER",Param:{Count:1},ToString:function(t){return"以".concat(t[0],"计算的获利盘比例")}}],["LWINNER",{Name:"LWINNER",Param:{Count:2},ToString:function(t){return"最近".concat(t[0],"日那部分成本以").concat(t[1],"价格卖出的获利盘比例")}}],["PWINNER",{Name:"PWINNER",Param:{Count:2},ToString:function(t){return"".concat(t[0],"日前那部分成本以").concat(t[1],"价格卖出的获利盘比例")}}],["COSTEX",{Name:"COSTEX",Param:{Count:2},ToString:function(t){return"位于价格".concat(t[0],"和").concat(t[1],"间的成本")}}],["PPART",{Name:"PPART",Param:{Count:2},ToString:function(t){return"".concat(t[0],"日前那部分成本占总成本的比例")}}],["SAR",{Name:"SAR",Param:{Count:3},ToString:function(t){return"步长为".concat(t[1],"极限值为").concat(t[0],"的").concat(t[2],"日抛物转向")}}],["SARTURN",{Name:"SARTURN",Param:{Count:3},ToString:function(t){return"步长为".concat(t[1],"极限值为").concat(t[0],"的").concat(t[2],"日抛物转向点")}}],["CON2STR",{Name:"CON2STR",Param:{Count:2},ToString:function(t){return"".concat(t[0],"转为字符串")}}],["VAR2STR",{Name:"VAR2STR",Param:{Count:2},ToString:function(t){return"".concat(t[0],"转为字符串")}}],["STR2CON",{Name:"STR2CON",Param:{Count:1},ToString:function(t){return"".concat(t[0],"转为数字")}}],["STRLEN",{Name:"STRLEN",Param:{Count:1},ToString:function(t){return"得到".concat(t[0],"字符串长度")}}],["STRCAT",{Name:"STRCAT",Param:{Count:2},ToString:function(t){return"字符串相加"}}],["VARCAT",{Name:"VARCAT",Param:{Count:2},ToString:function(t){return"字符串相加"}}],["STRSPACE",{Name:"STRSPACE",Param:{Count:1},ToString:function(t){return"字符串".concat(t[0],"加一空格")}}],["SUBSTR",{Name:"SUBSTR",Param:{Count:3},ToString:function(t){return"字符串".concat(t[0],"中取一部分")}}],["STRCMP",{Name:"STRCMP",Param:{Count:2},ToString:function(t){return"字符串".concat(t[0],"和字符串").concat(t[1],"比较")}}],["FINDSTR",{Name:"FINDSTR",Param:{Count:2},ToString:function(t){return"字符串".concat(t[0],"中查找字符串").concat(t[1])}}],["NAMEINCLUDE",{Name:"NAMEINCLUDE",Param:{Count:1},ToString:function(t){return"查找品种名称中包含".concat(t[0])}}],["CODELIKE",{Name:"CODELIKE",Param:{Count:1},ToString:function(t){return"查找品种名称中包含".concat(t[0])}}],["INBLOCK",{Name:"AVEDEV",Param:{Count:1},ToString:function(t){return"属于".concat(t[0],"板块")}}],["STKINDI",{Name:"STKINDI",Param:{Dynamic:!0},ToString:function(t){return"指标引用"}}],["STRFORMAT",{Name:"STRFORMAT",Param:{Dynamic:!0},ToString:function(t){return"格式化".concat(t[0],"字符串")}}],["NAMELIKE",{Name:"NAMELIKE",Param:{Count:1},ToString:function(t){return"品种名称是否以'".concat(t[0],"'开头")}}],["HHVBARS",{Name:"HHVBARS",Param:{Count:2},ToString:function(t){return 0==t[1]?"历史".concat(t[0],"新高距今天数"):"".concat(t[1],"日内").concat(t[0],"新高距今天数")}}],["LLVBARS",{Name:"LLVBARS",Param:{Count:2},ToString:function(t){return 0==t[1]?"历史".concat(t[0],"新低距今天数"):"".concat(t[1],"日内").concat(t[0],"新低距今天数")}}],["L2_VOLNUM",{Name:"L2_VOLNUM",Param:{Count:2},ToString:function(t){return"单数分档"}}],["L2_VOL",{Name:"L2_VOL",Param:{Count:2},ToString:function(t){return"成交量分档"}}],["L2_AMO",{Name:"L2_AMO",Param:{Count:2},ToString:function(t){return"成交额分档"}}],["TABLE_CELL",{Name:"TABLE_CELL",Param:{Dynamic:!0},ToString:function(t){return"创建表格单元格"}}],["TABLE_ROW",{Name:"TABLE_ROW",Param:{Dynamic:!0},ToString:function(t){return"创建表格行"}}],["DRAWTABLE",{Name:"DRAWTABLE",Param:{Dynamic:!0},ToString:function(t){return"绘制表格"}}]]),this.CallFunctionExplain=function(t,e,a){if(this.FUNCTION_INFO_LIST.has(t)){var i=this.FUNCTION_INFO_LIST.get(t);return!0===i.Param.Dynamic||i.Param.Count!=e.length&&this.ThrowUnexpectedNode(a,"函数".concat(t,"参数个数不正确. 需要").concat(i.Param.Count,"个参数")),i.ToString(e)}switch(t){case"CALCSTOCKINDEX":return"引用".concat(e[0],"的").concat(e[1],"指标第").concat(e[2],"个输出值");case"PEAK":case"PEAKBARS":case"ZIG":case"ZIGA":case"TROUGH":case"TROUGHBARS":return this.GetZIGExplain(t,e);case"FINANCE":return this.GetFinanceExplain(e);case"DYNAINFO":return this.GetDynainfoExplain(e);case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":return this.GetOtherSymbolExplain({FunctionName:t,Args:e},a);case"PLOYLINE":return"当满足条件".concat(e[0],"时以").concat(e[1],"位置为顶点画折线连接");case"DRAWLINE":return"当满足条件".concat(e[0],"时,在").concat(e[1],"位置画直线起点，当满足条件").concat(e[2],"时,在").concat(e[3],"位置画直线终点,").concat(e[4],"表示是否延长");case"DRAWSL":return"当满足条件".concat(e[0],"时,在").concat(e[1],"位置画斜线线性回归,").concat(e[2],"斜率,").concat(e[3],"长度,").concat(e[4],"方向");case"DRAWKLINE":case"DRAWKLINE1":return"K线";case"DRAWICON":return"当满足条件".concat(e[0],"时,在").concat(e[1],"位置画").concat(e[2],"号图标");case"DRAWTEXT":return"当满足条件".concat(e[0],"时,在").concat(e[1],"位置书写文字");case"DRAWTEXT_FIX":return"当满足条件".concat(e[0],"时,在横轴").concat(e[1],"纵轴").concat(e[2],"位置书写文字");case"DRAWNUMBER":return"当满足条件".concat(e[0],"时,在").concat(e[1],"位置书写数字");case"DRAWNUMBER_FIX":return"当满足条件".concat(e[0],"时,在横轴").concat(e[1],"纵轴").concat(e[2],"位置书写数字");case"RGB":return"自定色[".concat(e[0],",").concat(e[1],",").concat(e[2],"]");case"RGBA":return"自定色[".concat(e[0],",").concat(e[1],",").concat(e[2],",").concat(e[3],"]");case"DRAWBAND":return"画带状线";case"DRAWRECTREL":return"相对位置上画矩形.";case"DRAWGBK":return"填充背景";case"TIPICON":return"当满足条件".concat(e[0],"时,在").concat(e[1],"位置画").concat(e[2],"号图标");case"STICKLINE":var r="";return r=-1==e[4]?"虚线空心柱":0==e[4]?"实心柱":"实线空心柱","当满足条件".concat(e[0],"时, 在").concat(e[1],"和").concat(e[2],"位置之间画柱状线,宽度为").concat(e[3],",").concat(r);case"PARTLINE":return"画折线";case"SELL":return"卖出平仓";case"BUY":return"买入开仓";case"SELLSHORT":return"卖出开仓";case"BUYSHORT":return"买入平仓";case"DRAWLASTBARNUMBER":return"在最后一根k线输出数值";case"DRAWLASTBARTEXT":return"在最后一根k线显示文字";case"DRAWLASTBARICON":return"在最后一根k线绘制图标";case"YMOVE":return;case"BACKGROUND":return"绘制背景";case"UPCOLOR":return"上涨颜色".concat(e[0]);case"DOWNCOLOR":return"下跌颜色".concat(e[0]);case"STICKTYPE":case"FIRSTDRAW":return"";default:this.ThrowUnexpectedNode(a,"函数".concat(t,"不存在"))}},this.GetDynainfoExplain=function(t){var e=new Map([[3,"前收盘价"],[4,"开盘价"],[5,"最高价"],[6,"最低价"],[7,"现价"],[8,"总量"],[9,"现量"],[10,"总金额"],[11,"均价"],[12,"日涨跌"],[13,"振幅"],[14,"涨幅"],[15,"开盘时的成交金额"],[16,"前5日每分钟均量"],[17,"量比"],[18,"上涨家数"],[19,"下跌家数"]]),a=t[0];return e.has(a)?e.get(a):"即时行情[".concat(a,"]")},this.GetFinanceExplain=function(t){var e=new Map([[1,"总股本"],[2,"市场类型"],[3,"沪深品种类型"],[4,"沪深行业代码"],[5,"B股"],[6,"H股"],[7,"流通股本[股]"],[8,"股东人数[户]"],[9,"资产负债率%"],[10,"总资产"],[11,"流动资产"],[12,"固定资产"],[13,"无形资产"],[15,"流动负债"],[16,"少数股东权益"]]),a=t[0];return e.has(a)?e.get(a):"财务数据[".concat(a,"]")},this.GetZIGExplain=function(t,e){var a=e[0];switch(0==a?a="开盘价":1==a?a="最高价":2==a?a="最低价":3==a&&(a="收盘价"),t){case"PEAK":return"".concat(a,"的").concat(e[1],"%之字转向的前").concat(e[2],"个波峰值");case"PEAKBARS":return"".concat(a,"的").concat(e[1],"5%之字转向的前").concat(e[2],"个波峰位置");case"ZIG":return"".concat(a,"的").concat(e[1],"的之字转向");case"ZIGA":return"".concat(a,"变化").concat(e[1],"的之字转向");case"TROUGH":return"".concat(a,"的").concat(e[1],"%之字转向的前").concat(e[2],"个波谷值");case"TROUGHBARS":return"".concat(a,"的").concat(e[1],"%之字转向的前").concat(e[2],"个波谷位置")}},this.GetColorExplain=function(t){var e=new Map([["COLORBLACK","黑色"],["COLORBLUE","蓝色"],["COLORGREEN","绿色"],["COLORCYAN","青色"],["COLORRED","红色"],["COLORMAGENTA","洋红色"],["COLORBROWN","棕色"],["COLORLIGRAY","淡灰色"],["COLORGRAY","深灰色"],["COLORLIBLUE","淡蓝色"],["COLORLIGREEN","淡绿色"],["COLORLICYAN","淡青色"],["COLORLIRED","淡红色"],["COLORLIMAGENTA","淡洋红色"],["COLORWHITE","白色"],["COLORYELLOW","黄色"]]);return e.has(t)?e.get(t):0==t.indexOf("COLOR")?"#"+t.substr(5):"rgb(30,144,255)"},this.GetLineWidthExplain=function(t){var e=parseInt(t.replace("LINETHICK",""));return sa.IsPlusNumber(e)?e:1},this.SymbolPeriodExplain=function(t,e){var a=new Map([["CLOSE","收盘价"],["C","收盘价"],["VOL","成交量"],["V","成交量"],["OPEN","开盘价"],["O","开盘价"],["HIGH","最高价"],["H","最高价"],["LOW","最低价"],["L","最低价"],["AMOUNT","成交金额"],["AMO","成交金额"],["VOLINSTK","持仓量"]]),i=new Map([["MIN1","1分钟"],["MIN5","5分钟"],["MIN15","15分钟"],["MIN30","30分钟"],["MIN60","60分钟"],["DAY","日"],["WEEK","周"],["MONTH","月"],["SEASON","季"],["YEAR","年"],["WEEK2","双周"],["HALFYEAR","半年"]]),r=t;a.has(t)&&(r=a.get(t));var n=e;return i.has(e)&&(n=i.get(e)),"".concat(r,"[取").concat(n,"数据]")},this.GetOtherSymbolExplain=function(t,e){var a=new Map([["CLOSE","收盘价"],["C","收盘价"],["VOL","成交量"],["V","成交量"],["OPEN","开盘价"],["O","开盘价"],["HIGH","最高价"],["H","最高价"],["LOW","最低价"],["L","最低价"],["AMOUNT","成交金额"],["AMO","成交金额"],["VOLINSTK","持仓量"]]);if(t.FunctionName){var i=t.Args,r=a.get(t.FunctionName);return"[".concat(i[0],"]").concat(r)}if(t.Literal){var n=t.Literal.toUpperCase();i=n.split("$");if(!a.has(i[1]))return"";var o=i[0];r=a.get(i[1]);return"[".concat(o,"]").concat(r)}},this.IsDrawFunction=function(t){var e=new Set(["STICKLINE","DRAWTEXT","SUPERDRAWTEXT","DRAWLINE","DRAWBAND","DRAWKLINE","DRAWKLINE1","DRAWKLINE_IF","PLOYLINE","POLYLINE","DRAWNUMBER","DRAWNUMBER_FIX","DRAWICON","DRAWCHANNEL","PARTLINE","DRAWTEXT_FIX","DRAWGBK","DRAWTEXT_LINE","DRAWRECTREL","DRAWTEXTABS","DRAWOVERLAYLINE","FILLRGN","FILLRGN2","FILLTOPRGN","FILLBOTTOMRGN","FILLVERTICALRGN","FLOATRGN","DRAWSL","DRAWGBK2","BUY","BUYSHORT","SELL","SELLSHORT"]);return!!e.has(t)},this.VisitAssignmentExpression=function(t){var e=t.Left;e.Type!=on.Identifier&&this.ThrowUnexpectedNode(t);var a=e.Name,i=t.Right,r=null;i.Type==on.BinaryExpression||i.Type==on.LogicalExpression?r=this.VisitBinaryExpression(i):i.Type==on.CallExpression?r=this.VisitCallExpression(i):i.Type==on.Literal?(r=i.Value,sa.IsString(r)&&i.Value.indexOf("$")>0&&(r=this.GetOtherSymbolExplain({Literal:r},t))):i.Type==on.Identifier?r=this.ReadVariable(i.Name,i):i.Type==on.MemberExpression?r=this.ReadMemberVariable(i):i.Type==on.UnaryExpression&&(r=this.VisitUnaryExpression(i)),this.VarTable.set(a,this.ConvertToShortValue(r))},this.ConvertToShortValue=function(t){var e=this.MaxValueLength;if(t&&t.length>=e){var a=t.slice(0,e-10);return a+="......",a}return t},this.ReadMemberVariable=function(t){var e,a=t.Object,i=t.Property;if(a.Type==on.BinaryExpression||a.Type==on.LogicalExpression)e=this.VisitBinaryExpression(a);else{if(a.Type!=on.CallExpression){if(i.Name.indexOf("#")>0)var r=i.Name.split("#"),n="".concat(a.Name,"的").concat(r[0],"[周期").concat(r[1],"]");else n="".concat(a.Name,"的").concat(i.Name);return n}e=this.VisitCallExpression(a)}if(!e)return null;n=e[i.Name];return n||null},this.VisitBinaryExpression=function(t){var e=[];e.push(t);var a=null;while(0!=e.length)if(a=e[e.length-1],a.Left&&t!=a.Left&&t!=a.Right)e.push(a.Left);else if(a.Right&&t!=a.Right)e.push(a.Right);else{var i=e.pop();if(i.Type==on.BinaryExpression){var r=this.GetNodeValue(i.Left),n=this.GetNodeValue(i.Right);0,i.Out=null,i.Out="(".concat(r," ").concat(i.Operator," ").concat(n,")"),"收盘价"==r&&"开盘价"==n?">"==i.Operator?i.Out="(收阳线)":"<"==i.Operator?i.Out="(收阴线)":"="==i.Operator&&(i.Out="(平盘)"):"开盘价"==r&&"收盘价"==n&&("<"==i.Operator?i.Out="(收阳线)":">"==i.Operator?i.Out="(收阴线)":"="==i.Operator&&(i.Out="(平盘)"))}else if(i.Type==on.LogicalExpression){var o=this.GetNodeValue(i.Left),s=this.GetNodeValue(i.Right);switch(i.Out=null,i.Operator){case"&&":case"AND":i.Out="(".concat(o," 并且 ").concat(s,")");break;case"||":case"OR":i.Out="(".concat(o," 或者 ").concat(s,")");break}0}t=a}return t.Out},this.GetNodeValueEx=function(t){var e=null;return e=t.Type==on.BinaryExpression||t.Type==on.LogicalExpression?this.VisitBinaryExpression(t):t.Type==on.CallExpression?this.VisitCallExpression(t):this.GetNodeValue(t),e},this.GetNodeValue=function(t){switch(t.Type){case on.Literal:return t.Value;case on.UnaryExpression:return this.VisitUnaryExpression(t);case on.Identifier:var e=this.ReadVariable(t.Name,t);return e;case on.BinaryExpression:case on.LogicalExpression:return t.Out;case on.CallExpression:return this.VisitCallExpression(t);default:this.ThrowUnexpectedNode(t)}},this.ReadVariable=function(t,e){if(this.ConstVarTable.has(t)){var a=this.ConstVarTable.get(t);return a}if(Qr.IsCustomVariant(t)){var i=Qr.CustomVariant.Data.get(t);return i.Description?i.Description:t}if(this.VarTable.has(t))return this.VarTable.get(t);if(t.indexOf("#")>0){var r=t.split("#");return this.SymbolPeriodExplain(r[0],r[1])}return"AUTOFILTER"==t?this.AUTOFILTER():(this.ThrowUnexpectedNode(e,"变量"+t+"不存在"),t)},this.AUTOFILTER=function(){return null},this.ThrowUnexpectedNode=function(t,e){var a=t.Marker,i=e||"执行异常";return this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,i)},this.ThrowError=function(){}}function In(){}In.Tokenize=function(t){u.Complier.Log("[JSComplier.Tokenize]",t);var e=new nn(t),a=[];try{while(1){var i=e.GetNextToken();if(!i)break;a.push(i)}}catch(r){}return a},In.Parse=function(t){u.Complier.Log("[JSComplier.Parse]",t);var e=new hn(t);e.Initialize();var a=e.ParseScript(),i=a;return i},In.Execute=function(t,e,a){(function(){try{e.Self&&(e.Self.Status=1),u.Complier.Log("[JSComplier.Execute]",t,e),u.Complier.Log("[JSComplier.Execute] parser .....");var i=new hn(t);i.Initialize();var r=i.ParseScript(),n=r;u.Complier.Log("[JSComplier.Execute] parser finish.",n),e.Self&&(e.Self.Status=2),u.Complier.Log("[JSComplier.Execute] execute .....");var o=new mn(n,e);o.ErrorCallback=a,o.JobList=i.Node.GetDataJobList(),"ScriptIndexConsole"!=e.ClassName||e.Data||o.JobList.unshift({ID:fn.JOB_DOWNLOAD_SYMBOL_DATA}),o.JobList.push({ID:fn.JOB_RUN_SCRIPT}),e.Self&&(e.Self.Status=3);o.Execute()}catch(s){u.Complier.Log(s),a&&a(s,e.CallbackParam),e.Self&&(e.Self.Status=0)}})(),u.Complier.Log("[JSComplier.Execute] async execute.")},In.Explain=function(t,e,a){(function(){try{u.Complier.Log("[JSComplier.Explain]",t,e),u.Complier.Log("[JSComplier.Explain] parser .....");var i=new hn(t);i.Initialize();var r=i.ParseScript(),n=r;u.Complier.Log("[JSComplier.Explain] parser finish.",n),u.Complier.Log("[JSComplier.Explain] explain .....");var o=new dn(n,e);o.ErrorCallback=a,o.JobList=i.Node.GetDataJobList(),o.JobList.push({ID:fn.JOB_RUN_SCRIPT});o.Run()}catch(s){u.Complier.Log(s),a&&a(s,e.CallbackParam)}})(),u.Complier.Log("[JSComplier.Explain] async explain.")},In.SetDomain=function(t,e){t&&(Qr.Domain=t),e&&(Qr.CacheDomain=e)},In.AddIcon=function(t){Qr.CustomDrawIcon.Data.set(t.ID,t)},In.AddFunction=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();Qr.CustomFunction.Data.set(e,t)}},In.AddVariant=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();Qr.CustomVariant.Data.set(e,t)}},In.ColorVarToRGB=function(t){var e=new Map([["COLORBLACK","rgb(0,0,0)"],["COLORBLUE","rgb(18,95,216)"],["COLORGREEN","rgb(25,158,0)"],["COLORCYAN","rgb(0,255,198)"],["COLORRED","rgb(238,21,21)"],["COLORMAGENTA","rgb(255,0,222)"],["COLORBROWN","rgb(149,94,15)"],["COLORLIGRAY","rgb(218,218,218)"],["COLORGRAY","rgb(133,133,133)"],["COLORLIBLUE","rgb(94,204,255)"],["COLORLIGREEN","rgb(183,255,190)"],["COLORLICYAN","rgb(154,255,242)"],["COLORLIRED","rgb(255,172,172)"],["COLORLIMAGENTA","rgb(255,145,241)"],["COLORWHITE","rgb(255,255,255)"],["COLORYELLOW","rgb(255,198,0)"]]);if(e.has(t))return e.get(t);if(0==t.indexOf("COLOR")){var a=t.substr(5);if(6!=a.length)return null;var i=a.substr(0,2),r=parseInt(i,16);i=a.substr(2,2);var n=parseInt(i,16);i=a.substr(4,2);var o=parseInt(i,16);return"rgb(".concat(o,",").concat(n,",").concat(r,")")}if(0==t.indexOf("RGBX")){a=t.substr(4);if(6!=a.length)return null;i=a.substr(0,2),o=parseInt(i,16);i=a.substr(2,2);n=parseInt(i,16);i=a.substr(4,2);r=parseInt(i,16);return"rgb(".concat(o,",").concat(n,",").concat(r,")")}return null};var Sn={KLINE_ID:0,MINUTE_ID:2,HISTORY_MINUTE_ID:3,MULTIDAY_MINUTE_ID:4},Tn={OVERLAY_BARS:"OVERLAY_BARS",KLINE_TABLE:"KLINE_TABLE",SCATTER_PLOT:"SCATTER_PLOT",SCATTER_PLOT_V2:"SCATTER_PLOT_V2",CLIP_COLOR_STICK:"CLIP_COLOR_STICK",DRAW_KLINE:"DRAWKLINE"};var vn=new function(){this.DataMap=new Map,this.Add=function(t,e){this.DataMap.set(t,{MinuteFittingCallback:e.MinuteFittingCallback,KLineFittingCallback:e.KLineFittingCallback,CreateChartCallback:e.CreateChartCallback,FormatTitleCallback:e.FormatTitleCallback})},this.Get=function(t){return this.DataMap.has(t)?this.DataMap.get(t):null},this.Has=function(t){return this.DataMap.has(t)}};function pn(t,e,a,i){this.newMethod=mr,this.newMethod(t),delete this.newMethod,this.ClassName="ScriptIndex",this.Script=e,this.Arguments=[],this.OutVar=[],this.ID,this.FloatPrecision=2,this.StringFormat,this.IsShowIndexTitle=!0,this.KLineType=null,this.InstructionType,this.YSpecificMaxMin=null,this.YSplitScale=null,this.Condition=null,this.OutName=null,this.YSplitType,this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=20,this.LockMinWidth=null,this.TitleFont=qi.TitleFont,this.IsShortTitle=!1,this.IsUsePageData=!1,this.YAxis=null,this.Debug,this.IsSync=!1,this.IsShow=!0,this.RunCount=0,this.MaxRunCount=-1,i&&(i.FloatPrecision>=0&&(this.FloatPrecision=i.FloatPrecision),i.StringFormat>0&&(this.StringFormat=i.StringFormat),sa.IsBool(i.IsShowIndexTitle)&&(this.IsShowIndexTitle=i.IsShowIndexTitle),i.ID&&(this.ID=i.ID),(i.KLineType>=0||-1===i.KLineType)&&(this.KLineType=i.KLineType),i.InstructionType&&(this.InstructionType=i.InstructionType),i.YSpecificMaxMin&&(this.YSpecificMaxMin=i.YSpecificMaxMin),i.YSplitScale&&(this.YSplitScale=i.YSplitScale),i.Condition&&(this.Condition=i.Condition),i.TitleFont&&(this.TitleFont=i.TitleFont),i.IsShortTitle&&(this.IsShortTitle=i.IsShortTitle),i.OutName&&(this.OutName=i.OutName),sa.IsNumber(i.YSplitType)&&(this.YSplitType=i.YSplitType),sa.IsBool(i.IsSync)&&(this.IsSync=i.IsSync),sa.IsNumber(i.MaxRunCount)&&(this.MaxRunCount=i.MaxRunCount),i.Debug&&sa.IsPlusNumber(i.Debug.Count)&&i.Debug.Callback&&(this.Debug={Count:i.Debug.Count,Callback:i.Debug.Callback})),i&&i.Lock&&(1==i.Lock.IsLocked&&(this.IsLocked=!0),i.Lock.Callback&&(this.LockCallback=i.Lock.Callback),i.Lock.ID&&(this.LockID=i.Lock.ID),i.Lock.BG&&(this.LockBG=i.Lock.BG),i.Lock.TextColor&&(this.LockTextColor=i.Lock.TextColor),i.Lock.Text&&(this.LockText=i.Lock.Text),i.Lock.Font&&(this.LockFont=i.Lock.Font),i.Lock.Count&&(this.LockCount=i.Lock.Count),i.Lock.MinWidth&&(this.LockMinWidth=i.Lock.MinWidth*F())),i&&i.YAxis&&(this.YAxis={},sa.IsNumber(i.YAxis.FloatPrecision)&&(this.YAxis.FloatPrecision=i.YAxis.FloatPrecision),sa.IsNumber(i.YAxis.StringFormat)&&(this.YAxis.StringFormat=i.YAxis.StringFormat),sa.IsBool(i.YAxis.EnableRemoveZero)&&(this.YAxis.EnableRemoveZero=i.YAxis.EnableRemoveZero),sa.IsBool(i.YAxis.ExcludeValue)&&(this.YAxis.ExcludeValue=i.YAxis.ExcludeValue)),a&&(this.Arguments=a),this.CopyTo=function(t){t.FloatPrecision=this.FloatPrecision,t.StringFormat=this.StringFormat,t.KLineType=this.KLineType,t.InstructionType=this.InstructionType,t.Condition=this.Condition,t.TitleFont=this.TitleFont,t.IsShortTitle=this.IsShortTitle,t.OutName=this.OutName,t.Arguments=this.Arguments,t.Script=this.Script,t.Name=this.Name,t.ID=this.ID},this.SetLock=function(t){1==t.IsLocked?(this.IsLocked=!0,t.Callback&&(this.LockCallback=t.Callback),t.ID&&(this.LockID=t.ID),t.BG&&(this.LockBG=t.BG),t.TextColor&&(this.LockTextColor=t.TextColor),t.Text&&(this.LockText=t.Text),t.Font&&(this.LockFont=t.Font),t.Count&&(this.LockCount=t.Count),t.MinWidth&&(this.LockMinWidth=t.MinWidth*F())):(this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=20)},this.IsExcessRunCount=function(){return!(this.MaxRunCount<0)&&this.RunCount>=this.MaxRunCount},this.ExecuteScript=function(t,e,a){this.OutVar=[];var i={HQChart:t,WindowIndex:e,HistoryData:a,Self:this},r=Sn.KLINE_ID;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?r=t.DayCount>1?Sn.MULTIDAY_MINUTE_ID:Sn.MINUTE_ID:"HistoryMinuteChartContainer"===t.ClassName&&(r=Sn.HISTORY_MINUTE_ID);var n={HQDataType:r,Symbol:t.Symbol,Name:t.Name,Data:a,SourceData:t.SourceData,Callback:this.RecvResultData,CallbackParam:i,Async:!0,MaxRequestDataCount:t.MaxRequestDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Arguments:this.Arguments,Condition:this.Condition,IsBeforeData:t.IsBeforeData,IsApiPeriod:t.IsApiPeriod,DrawInfo:null,Self:this};if(this.Debug&&sa.IsPlusNumber(this.Debug.Count)&&this.Debug.Callback&&(--this.Debug.Count,n.Debug=1,n.DebugFilter=this.Debug.Callback),t&&t.ChartPaint[0]){var o=t.ChartPaint[0];o&&o.DrawKRange&&(n.DrawInfo={Start:o.DrawKRange.Start,End:o.DrawKRange.End})}if(r===Sn.HISTORY_MINUTE_ID&&(n.TrateDate=t.TradeDate),r===Sn.MULTIDAY_MINUTE_ID&&(n.DayCount=t.DayCount),t.NetworkFilter&&(n.NetworkFilter=t.NetworkFilter),!this.Condition||this.IsMeetCondition(i,n)){++this.RunCount;var s=this.Script;In.Execute(s,n,t.ScriptErrorCallback)}else this.ShowConditionError(i,this.Condition.Message)},this.IsMeetCondition=function(t,e){if(u.Complier.Log("[ScriptIndex::IsMeetCondition] ",this.Condition),this.Condition.Period){if(!this.IsMeetPeriodCondition(t,e))return!1;if(!this.IsMeetIncludeCondition(t,e))return!1}return!0},this.IsMeetPeriodCondition=function(t,e){if(!this.Condition.Period)return!0;for(var a in this.Condition.Period){var i=this.Condition.Period[a];switch(i){case C.MINUTE_ID:if(e.HQDataType==Sn.MINUTE_ID)return!0;break;case C.MULTIDAY_MINUTE_ID:if(e.HQDataType==Sn.MULTIDAY_MINUTE_ID)return!0;break;case C.KLINE_DAY_ID:case C.KLINE_WEEK_ID:case C.KLINE_MONTH_ID:case C.KLINE_YEAR_ID:case C.KLINE_TWOWEEK_ID:case C.KLINE_QUARTER_ID:case C.KLINE_MINUTE_ID:case C.KLINE_5_MINUTE_ID:case C.KLINE_15_MINUTE_ID:case C.KLINE_30_MINUTE_ID:case C.KLINE_60_MINUTE_ID:if(t.HQChart.Period==i)return!0;break}}return!1},this.IsMeetIncludeCondition=function(t,e){if(!this.Condition.Include||this.Condition.Include.length<=0)return!0;var a=t.HQChart.Symbol;for(var i in a&&(a=a.toUpperCase()),this.Condition.Include){var r=this.Condition.Include[i];if(a==r)return!0}return!1},this.ShowConditionError=function(t,e){var a=t.HQChart,i=t.WindowIndex;a.DeleteIndexPaint(i),0==i&&a.ShowKLine(!0);var r="指标不支持当前品种或周期";e&&(r=e);var n=new Vt;n.Canvas=a.Canvas,n.ChartBorder=a.Frame.SubFrame[i].Frame.ChartBorder,n.ChartFrame=a.Frame.SubFrame[i].Frame,n.NotSupportMessage=r,a.ChartPaint.push(n),a.UpdataDataoffset(),a.UpdateFrameMaxMin(),a.Draw()},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;if(e.Self.OutVar=t,e.Self.BindData(a,i,r),0==e.Self.IsLocked)e.HQChart.Frame.SubFrame[i].Frame.SetLock(null);else{var n={IsLocked:!0,Callback:e.Self.LockCallback,IndexName:e.Self.Name,ID:e.Self.LockID,BG:e.Self.LockBG,Text:e.Self.LockText,TextColor:e.Self.LockTextColor,Font:e.Self.LockFont,Count:e.Self.LockCount,MinWidth:e.Self.LockMinWidth};e.HQChart.Frame.SubFrame[i].Frame.SetLock(n)}if(e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),!1===e.Self.IsSync&&e.HQChart.Draw(),a.GetIndexEvent){var o=a.GetIndexEvent();if(o){var s=e.Self,h={OutVar:s.OutVar,WindowIndex:i,Name:s.Name,Arguments:s.Arguments,HistoryData:r,Stock:{Symbol:a.Symbol,Name:a.Name}};o.Callback(o,h,s)}}},this.SetChartIndexName=function(t){this.Name?t.IndexName=this.Name:this.ID&&(t.IndexName,this.ID),this.ID&&(t.IndexID=this.ID),this.YAxis&&sa.IsBool(this.YAxis.ExcludeValue)&&(t.IsExcludeYValue=this.YAxis.ExcludeValue),t.Script=this},this.SetTitleData=function(t,e){t.ChartClassName=e.ClassName,t.IsVisible=e.IsVisible},this.ReloadChartResource=function(t,e,a){var i=t.GetEventCallback(m.ON_RELOAD_INDEX_CHART_RESOURCE);if(i&&i.Callback){var r={Chart:a,IndexName:this.Name,IndexID:this.ID,HQChart:t,WindowIndex:e};i.Callback(i,r,this)}},this.CreateLine=function(t,e,a,i,r){if(7==r)var n=new Jt;else n=new Vt;if(n.Canvas=t.Canvas,n.DrawType=1,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.Identify=this.Guid,n.HQChart=t,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),8==r&&(n.DrawType=2,n.BreakPoint=a.BreakPoint),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(n.LineWidth=o)}a.IsDotLine&&(n.IsDotLine=!0,n.LineDash=qi.DOTLINE.LineDash.slice()),sa.IsNonEmptyArray(a.LineDash)&&(n.LineDash=a.LineDash),sa.IsBool(a.IsShow)&&(n.IsShow=a.IsShow),sa.IsNonEmptyArray(a.AryBreakPoint)&&(n.AryBreakPoint=a.AryBreakPoint);var s=e+1;n.Data.Data=a.Data,this.ReloadChartResource(t,e,n),!1===a.IsShowTitle||sa.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(a.NoneName?t.TitlePaint[s].Data[i]=new _a(n.Data,null,n.Color):t.TitlePaint[s].Data[i]=new _a(n.Data,a.Name,n.Color),this.SetTitleData(t.TitlePaint[s].Data[i],n)),this.SetChartIndexName(n),t.ChartPaint.push(n)},this.CreateArea=function(t,e,a,i){var r=new Yt;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Identify=this.Guid,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.DownColor?r.AreaColor=a.DownColor:a.UpColor&&(r.AreaColor=a.UpColor,r.AreaDirection=1),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));sa.IsPlusNumber(n)&&(r.LineWidth=n)}sa.IsNonEmptyArray(a.LineDash)&&(r.LineDash=a.LineDash),0==a.IsShow&&(r.IsShow=!1);var o=e+1;r.Data.Data=a.Data,!1===a.IsShowTitle||sa.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(a.NoneName?t.TitlePaint[o].Data[i]=new _a(r.Data,null,r.Color):t.TitlePaint[o].Data[i]=new _a(r.Data,a.Name,r.Color),t.TitlePaint[o].Data[i].ChartClassName=r.ClassName),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateTitle=function(t,e,a,i){var r=new Ht;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Identify=this.Guid,r.Data=t.GetKData(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),r.AryTitle=a.Draw.DrawData.AryTitle,r.BuildCacheData();var n=e+1,o=new _a(r.Data,a.Name,r.Color);o.DataType="ChartIndexTitle",o.Chart=r,t.TitlePaint[n].Data[i]=o,this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateOverlayLine=function(t,e,a,i,r){if(7==r)var n=new Jt;n=new Wt;if(n.Canvas=t.Canvas,n.DrawType=1,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(n.LineWidth=o)}a.IsDotLine&&(n.IsDotLine=!0),0==a.IsShow&&(n.IsShow=!1);var s=e+1;n.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new _a(n.Data,a.Name,n.Color),t.TitlePaint[s].Data[i].ChartClassName=n.ClassName,t.ChartPaint.push(n)},this.CreateSingleLine=function(t,e,a,i,r){var n=new Kt;if(n.Canvas=t.Canvas,n.DrawType=1,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.Identify=this.Guid,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(n.LineWidth=o)}a.IsDotLine&&(n.IsDotLine=!0),0==a.IsShow&&(n.IsShow=!1);var s=e+1;n.Data.Data=a.Data,this.ReloadChartResource(t,e,n),!1===a.IsShowTitle||sa.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(a.NoneName?t.TitlePaint[s].Data[i]=new _a(n.Data,null,n.Color):t.TitlePaint[s].Data[i]=new _a(n.Data,a.Name,n.Color),this.SetTitleData(t.TitlePaint[s].Data[i],n)),this.SetChartIndexName(n),t.ChartPaint.push(n)},this.CreateBar=function(t,e,a,i){var r=new ie;r.Canvas=t.Canvas,a.Draw.Width>0?r.Width=a.Draw.Width:r.Width=0,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i);r.Data.Data=a.Draw.DrawData,r.BarType=a.Draw.Type,this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateText=function(t,e,a,i,r){var n=new re;n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.ReloadResource(),a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(n.TextAlign="center"),!0===a.IsDrawAbove&&(n.Direction=1),!0===a.IsDrawBelow&&(n.Direction=2);a.Draw.Position&&(n.Position=a.Draw.Position),a.Draw.DrawData&&(n.Data.Data=a.Draw.DrawData),n.Text=a.Draw.Text,a.Draw.Direction>0&&(n.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(n.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(n.TextAlign=a.Draw.TextAlign),a.DrawVAlign>=0&&(0==a.DrawVAlign?n.Direction=1:1==a.DrawVAlign?n.Direction=0:2==a.DrawVAlign&&(n.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?n.TextAlign="left":1==a.DrawAlign?n.TextAlign="center":2==a.DrawAlign&&(n.TextAlign="right")),a.DrawFontSize>0&&(n.FixedFontSize=a.DrawFontSize),a.Background&&(n.TextBG=a.Background),this.SetChartIndexName(n),t.ChartPaint.push(n)},this.CreateDrawNumber=function(t,e,a,i){var r=new se;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(r.TextAlign="center"),!0===a.IsDrawAbove&&(r.TextBaseline="bottom"),!0===a.IsDrawBelow&&(r.TextBaseline="top"),r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?r.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(r.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.TextBaseline="top":1==a.DrawVAlign?r.TextBaseline="middle":2==a.DrawVAlign&&(r.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),a.VerticalLine&&(r.VerticalLine=a.VerticalLine);t.ChartPaint.push(r)},this.CreateDrawTextV2=function(t,e,a,i){var r=new oe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(r.TextAlign="center"),!0===a.IsDrawAbove&&(r.TextBaseline="bottom"),!0===a.IsDrawBelow&&(r.TextBaseline="top"),a.Draw.DrawData&&(r.Data.Data=a.Draw.DrawData),r.Text=a.Draw.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?r.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(r.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.TextBaseline="top":1==a.DrawVAlign?r.TextBaseline="middle":2==a.DrawVAlign&&(r.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),a.VerticalLine&&(r.VerticalLine=a.VerticalLine),sa.IsNumber(a.YOffset)&&(r.ShowOffset.Y=a.YOffset),sa.IsNumber(a.XOffset)&&(r.ShowOffset.X=a.XOffset);this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateMACD=function(t,e,a,i){var r=new ce;if(r.Canvas=t.Canvas,r.Identify=this.Guid,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var o=e+1;r.Data.Data=a.Data;var s=this.GetDefaultColor(i);a.Color&&(s=this.GetColor(a.Color)),a.UpColor&&(r.UpColor=a.UpColor),a.DownColor&&(r.DownColor=a.DownColor),this.ReloadChartResource(t,e,r),t.TitlePaint[o].Data[i]=new _a(r.Data,a.Name,s),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreatePointDot=function(t,e,a,i,r){var n=new Qt;if(n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.Radius&&(n.Radius=a.Radius),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(n.Radius=o)}sa.IsBool(a.UpDownDot)&&(n.EnableUpDownColor=a.UpDownDot,n.HistoryData=r);var s=e+1;n.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new _a(n.Data,a.Name,n.Color),this.SetChartIndexName(n),t.ChartPaint.push(n)},this.CreateStick=function(t,e,a,i){var r=new qt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var o=e+1;r.Data.Data=a.Data,this.ReloadChartResource(t,e,r),t.TitlePaint[o].Data[i]=new _a(r.Data,a.Name,r.Color),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateLineStick=function(t,e,a,i){var r=new jt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var o=e+1;r.Data.Data=a.Data,t.TitlePaint[o].Data[i]=new _a(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateStraightLine=function(t,e,a,i){var r=new Vt;if(r.DrawType=1,r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var o=e+1;r.Data.Data=a.Draw.DrawData,"DRAWLINE"==a.Name&&(t.TitlePaint[o].Data[i]=new _a(r.Data,null,r.Color)),t.ChartPaint.push(r)},this.CreateVolStick=function(t,e,a,i,r){var n=new $t;if(n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.KLineDrawType=t.KLineDrawType,n.Identify=this.Guid,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.UpColor&&(n.UpColor=a.UpColor),a.DownColor&&(n.DownColor=a.DownColor),sa.IsNumber(a.StickType)&&(n.BarType=a.StickType),sa.IsNumber(a.BarColorType)&&(n.BarColorType=a.BarColorType),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));sa.IsPlusNumber(o)&&(n.BarWidth=o)}var s=e+1;if(n.Data.Data=a.Data,n.HistoryData=r,this.ReloadChartResource(t,e,n),!1===a.IsShowTitle);else if(sa.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT"));else{var h=new _a(n.Data,a.Name,n.Color);t.TitlePaint[s].Data[i]=h,this.SetTitleData(h,n)}this.SetChartIndexName(n),t.ChartPaint.push(n)},this.CreateBand=function(t,e,a,i){var r=new de;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.FirstColor=a.Draw.Color[0],r.SecondColor=a.Draw.Color[1],r.Data.Data=a.Draw.DrawData,sa.IsBool(a.IsFirstDraw)&&(r.IsDrawFirst=a.IsFirstDraw);var n=e+1,o=new _a(r.Data,a.Name,r.Color);o.DataType=r.ClassName,o.ExtendData={Color:[r.FirstColor,r.SecondColor]},t.TitlePaint[n].Data[i]=o,this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateFillRGN=function(t,e,a,i){var r=new Ie;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),t.ChartPaint.push(r)},this.CreateFillRGN2=function(t,e,a,i){var r=new Se;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateFillBGRGN=function(t,e,a,i){var r=new ve;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateFLOATRGN=function(t,e,a,i){var r=new Te;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateKLine=function(t,e,a,i){var r=new Lt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.Identify=this.Guid,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,r.IsShowMaxMinPrice=!1,r.IsShowKTooltip=!1,sa.IsNumber(a.KLineType)&&(r.DrawType=a.KLineType),a.Color&&(r.UnchagneColor=r.DownColor=r.UpColor=this.GetColor(a.Color)),a.Draw.Config){var n=a.Draw.Config;sa.IsBool(n.IsShowMaxMinPrice)&&(r.IsShowMaxMinPrice=n.IsShowMaxMinPrice),sa.IsBool(n.IsShowKTooltip)&&(r.IsShowKTooltip=n.IsShowKTooltip),n.Symbol&&(r.Symbol=n.Symbol),n.Name&&(r.Title=n.Name)}var o=!1;if(sa.IsBool(a.IsShowTitle)&&(o=a.IsShowTitle),o){var s=e+1,h=new _a(r.Data,a.Name,r.Color);h.DataType="DRAWKLINE",h.Symbol=r.Symbol,t.TitlePaint[s].Data[i]=h}this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateOverlayKLine=function(t,e,a,i){var r=null;if(t.IsKLineContainer())r=new Nt;else{if(!t.IsMinuteContainer())return;r=new ue}r.Canvas=t.Canvas,r.Name=a.Name,r.Identify=this.Guid,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),r.Data.Data=a.Draw.DrawData,r.MainData=t.ChartPaint[0].Data,t.ChartPaint.push(r)},this.CreateDrawColorKLine=function(t,e,a,i){var r=new Mt;r.Canvas=t.Canvas,r.Name=a.Name,r.DrawName="DRAWCOLORKLINE",r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,sa.IsBool(a.Draw.IsEmptyBar)&&(r.IsEmptyBar=a.Draw.IsEmptyBar),a.Draw.Color&&(r.Color=a.Draw.Color),t.ChartPaint.push(r)},this.CreatePolyLine=function(t,e,a,i){var r=new Vt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDotLine&&(r.IsDotLine=!0),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var o=e+1;r.Data.Data=a.Draw.DrawData,t.TitlePaint[o].Data[i]=new _a(r.Data," ",r.Color),t.ChartPaint.push(r)},this.CreateChartSlopeLine=function(t,e,a,i){var r=new Zt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDotLine&&(r.IsDotLine=!0),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var o=e+1;r.Data.Data=a.Draw.DrawData.Data,r.Option=a.Draw.DrawData.Option,t.TitlePaint[o].Data[i]=new _a(r.Data,null,r.Color),t.ChartPaint.push(r)},this.CreateChartVericaltLine=function(t,e,a,i){var r=new te;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}this.SetChartLineDash(r,a.Draw.DrawData),r.Data.Data=a.Draw.DrawData.Data,t.ChartPaint.push(r)},this.SetChartLineDash=function(t,e){if(sa.IsNumber(e.LineType)){var a=e.LineType,i=F();switch(a){case 1:t.LineType=[10*i,10*i];break;case 2:t.LineType=[0,10*i],t.LineCap="square";break;case 3:t.LineType=[10*i,3*i,3*i,3*i];break;case 4:t.LineType=[10*i,3*i,3*i,3*i,3*i,3*i];break}}else if(sa.IsString(e.LineType)){for(var r=e.LineType.split(","),n=[],o=0;o<r.length;++o)n.push(parseInt(r[o]));t.LineType=n}},this.CreateChartHorizontalLine=function(t,e,a,i){var r=new ee;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}this.SetChartLineDash(r,a.Draw.DrawData),r.ExtendType=a.Draw.DrawData.Extend,r.Data.Data=a.Draw.DrawData.Data,t.ChartPaint.push(r)},this.CreateBackgroud=function(t,e,a,i){var r=new ge;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Color=n.Color,r.ColorAngle=n.Angle,n.Data&&(r.Data.Data=n.Data)}t.ChartPaint.push(r)},this.CreateBackgroundDiv=function(t,e,a,i){var r=new xe;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.AryColor=n.AryColor,r.ColorType=n.ColorType,n.Data&&(r.Data.Data=n.Data)}t.ChartPaint.push(r)},this.CreateLineMultiData=function(t,e,a,i){var r=new ae;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Color=n.Color,n.PointColor&&(r.PointColor=n.PointColor),sa.IsPlusNumber(n.PointRadius)&&(r.PointRadius=n.PointRadius),sa.IsPlusNumber(n.LineWidth)&&(r.LineWidth=n.LineWidth),n.Data&&(r.Data.Data=n.Data)}var o=e+1,s=new _a(r.Data,a.Name,r.Color);s.DataType="MULTI_POINT_LINE",t.TitlePaint[o].Data[i]=s,t.ChartPaint.push(r)},this.CreateSimpleTable=function(t,e,a,i){var r=new At;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;n.TableData&&(r.Data.Data=n.TableData),n.BGColor&&(r.BGColor=n.BGColor),n.BorderColor&&(r.BorderColor=n.BorderColor),n.TextFont&&(r.TextFontConfig=n.TextFont),n.TextColor&&(r.TextColor=n.TextColor),sa.IsNumber(n.XOffset)&&(r.Offset.X=n.XOffset),sa.IsNumber(n.YOffset)&&(r.Offset.Y=n.YOffset)}t.ChartPaint.push(r)},this.CreateSimplePie=function(t,e,a,i){var r=new Ot;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;n.Data&&(r.Data.Data=n.Data),n.BorderColor&&(r.BorderColor=n.BorderColor),n.TextFont&&(r.TextFontConfig=n.TextFont),n.TextColor&&(r.TextColor=n.TextColor),sa.IsNumber(n.XOffset)&&(r.Offset.X=n.XOffset),sa.IsNumber(n.YOffset)&&(r.Offset.Y=n.YOffset),sa.IsPlusNumber(n.Radius)&&(r.Radius=n.Radius)}t.ChartPaint.push(r)},this.CreateSimpleRadar=function(t,e,a,i){var r=new Bt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;n.Data&&(r.Data.Data=n.Data),n.AryIndex&&(r.AryIndex=n.AryIndex),sa.IsPlusNumber(n.Radius)&&(r.Radius=n.Radius),n.BorderColor&&(r.BorderColor=n.BorderColor),n.TextFont&&(r.TextFontConfig=n.TextFont),n.TextColor&&(r.TextColor=n.TextColor),n.BorderColor&&(r.BorderColor=n.BorderColor),sa.IsNumber(n.XOffset)&&(r.Offset.X=n.XOffset),sa.IsNumber(n.YOffset)&&(r.Offset.Y=n.YOffset),sa.IsNonEmptyArray(n.AryArea)&&(r.AryAreaConfig=n.AryArea),r.BuildCacheData()}t.ChartPaint.push(r)},this.CreateSimpleDoughnut=function(t,e,a,i){var r=new bt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;n.Data&&(r.Data.Data=n.Data),n.BorderColor&&(r.BorderColor=n.BorderColor),n.TextFont&&(r.TextFontConfig=n.TextFont),n.TextColor&&(r.TextColor=n.TextColor),sa.IsNumber(n.XOffset)&&(r.Offset.X=n.XOffset),sa.IsNumber(n.YOffset)&&(r.Offset.Y=n.YOffset),sa.IsPlusNumber(n.Radius)&&(r.Radius=n.Radius),sa.IsPlusNumber(n.InnerRadius)&&(r.InnerRadius=n.InnerRadius)}t.ChartPaint.push(r)},this.CreateTradeIcon=function(t,e,a,i){var r=new ne;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData.Data,r.AryIcon=a.Draw.DrawData.Icons,r.TradeType=a.Draw.DrawType,a.Color&&sa.IsNonEmptyArray(r.AryIcon))for(var n=0;n<r.AryIcon.length;++n){var o=r.AryIcon[n];o&&o.Color&&(o.Color=a.Color)}a.DrawFontSize>0&&(r.SVG.Size=a.DrawFontSize*F()),t.ChartPaint.push(r)},this.CreateTextLine=function(t,e,a,i){var r=new Ee;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Text=n.Text,r.Line=n.Line,r.Price=n.Price}t.ChartPaint.push(r)},this.CreateNumberText=function(t,e,a,i){var r=new re;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),r.TextAlign="center",a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=2,a.Draw.Position&&(r.Position=a.Draw.Position);r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateDrawText=function(t,e,a,i){var r=new re;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=0,a.DrawFontSize>0&&(r.TextFont="".concat(a.DrawFontSize*F(),"px 微软雅黑")),a.Font&&(r.TextFont=a.Font),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.Direction=1:1==a.DrawVAlign?r.Direction=0:2==a.DrawVAlign&&(r.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right"));r.DrawData=a.Draw.DrawData,this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateIcon=function(t,e,a,i){var r=new re;r.Canvas=t.Canvas,r.TextAlign="center",r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Direction=2,a.IsDrawAbove&&(r.Direction=1),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.Direction=1:1==a.DrawVAlign?r.Direction=0:2==a.DrawVAlign&&(r.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right"));r.Data.Data=a.Draw.DrawData;var n=a.Draw.Icon;1==n.IconFont?(r.IconFont={Family:n.Family,Text:n.Symbol,Color:n.Color},a.Color&&(r.IconFont.Color=this.GetColor(a.Color))):(r.Text=n.Symbol,a.Color?r.Color=this.GetColor(a.Color):n.Color?r.Color=n.Color:r.Color="rgb(0,0,0)"),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),sa.IsNumber(a.XOffset)&&(r.ShowOffset.X=a.XOffset),sa.IsNumber(a.YOffset)&&(r.ShowOffset.Y=a.YOffset),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateTipIcon=function(t,e,a,i){var r=new Ae;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint[0].IsMinuteFrame()?r.Data=t.SourceData:r.Data=t.ChartPaint[0].Data,r.Family=a.Draw.Icon.Family,r.TextFont=qi.TIPICON.TextFont;var n=qi.TIPICON.Size,o=qi.TIPICON.Color,s=0,h=2;if(sa.IsNumber(a.YOffset)&&(s=a.YOffset),a.Color&&(o=this.GetColor(a.Color)),a.DrawFontSize>0&&(n=a.DrawFontSize),a.DrawVAlign>=0&&(h=a.DrawVAlign),a.Draw&&sa.IsNonEmptyArray(a.Draw.DrawData)&&a.Draw.Icon){var l=a.Draw.DrawData,u=[],C=Array.isArray(a.Draw.Text),D=null;!C&&a.Draw.Text&&(D={Text:a.Draw.Text});for(var f=0;f<l.length;++f){var c=l[f],m=r.Data.Data[f];if(sa.IsNumber(c)){var d={Value:c,Date:m.Date,Time:m.Time,SVG:{Symbol:a.Draw.Icon.Symbol,Size:n,Color:o,YOffset:s,VAlign:h}};if(C){var I=a.Draw.Text[f];I&&(d.Tooltip={Text:I})}else d.Tooltip=D;u.push(d)}}r.Texts=u}r.BuildCacheData(),t.ChartPaint.push(r)},this.CreateDrawLastBarText=function(t,e,a,i){var r=new he;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint[0].IsMinuteFrame()?r.Data=t.SourceData:r.Data=t.ChartPaint[0].Data;var n=a.Draw.DrawData;n&&(n.Color?n.Color=this.GetColor(n.Color):n.Color=this.GetDefaultColor(i),a.Color&&(n.Color=this.GetColor(a.Color)),a.DrawVAlign>=0&&(0==a.DrawVAlign?n.TextBaseline="top":1==a.DrawVAlign?n.TextBaseline="middle":2==a.DrawVAlign&&(n.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?n.TextAlign="left":1==a.DrawAlign?n.TextAlign="center":2==a.DrawAlign&&(n.TextAlign="right")),sa.IsNumber(a.YOffset)&&(n.YOffset=a.YOffset),sa.IsNumber(a.XOffset)&&(n.XOffset=a.XOffset),a.DrawFontSize>0&&(n.FontSize=a.DrawFontSize)),r.LastBarItem=n,t.ChartPaint.push(r)},this.CreateChannel=function(t,e,a,i){var r=new pe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw.AreaColor?r.AreaColor=a.Draw.AreaColor:a.Color?r.AreaColor=this.GetColor(a.Color):r.AreaColor=this.GetDefaultColor(i),a.Draw.Border.Color?r.LineColor=a.Draw.Border.Color:r.LineColor=null,a.Draw.Border.Dotted&&(r.LineDotted=a.Draw.Border.Dotted),a.Draw.Border.Width>0&&(r.LineWidth=a.Draw.Border.Width),r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreatePartLine=function(t,e,a,i){var r=new zt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));sa.IsPlusNumber(n)&&(r.LineWidth=n)}sa.IsBool(a.IsDotLine)&&(r.IsDotLine=a.IsDotLine),sa.IsNonEmptyArray(a.LineDash)&&(r.LineDash=a.LineDash),r.Data.Data=a.Draw.DrawData,this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateMultiLine=function(t,e,a,i){var r=new Me;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Lines=a.Draw.DrawData,a.Draw.Name&&(r.Name=a.Draw.Name),a.Draw.LineDash&&(r.LineDash=a.Draw.LineDash),sa.IsNumber(a.Draw.LineWidth)&&(r.LineWidth=a.Draw.LineWidth),sa.IsBool(a.Draw.IsFullRangeMaxMin)&&(r.IsFullRangeMaxMin=a.Draw.IsFullRangeMaxMin),a.Draw.Arrow){var n=a.Draw.Arrow;1==n.Start&&(r.Arrow.Start=!0),1==n.End&&(r.Arrow.End=!0),sa.IsNumber(n.Angle)&&(r.ArrawAngle=n.Angle),sa.IsNumber(n.Length)&&(r.ArrawLength=n.Length),sa.IsNumber(n.LineWidth)&&(r.ArrawLineWidth=n.LineWidth)}this.ReloadChartResource(t,e,r),this.SetChartIndexName(r),t.ChartPaint.push(r);var o=e+1,s=!0;if(!1===a.IsShowTitle&&(s=!1),s){var h=new _a(r.Data,r.Name,null);h.DataType="ChartMultiLine",h.Lines=r.Lines,t.TitlePaint[o].Data[i]=h}},this.CreateMultiPoint=function(t,e,a,i){var r=new ye;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.GetKData(),r.PointGroup=a.Draw.DrawData,a.Draw.Name&&(r.Name=a.Draw.Name),r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r);var n=e+1,o=!0;if(!1===a.IsShowTitle&&(o=!1),o){var s=new _a(r.Data,r.Name,null);s.DataType="ChartMultiPoint",s.GetItemCallback=function(t){return r.GetItem(t)},t.TitlePaint[n].Data[i]=s}},this.CreateMultiBar=function(t,e,a,i){var r=new Le;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.GetKData(),r.Bars=a.Draw.DrawData,r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r);var n=e+1,o=!0;if(!1===a.IsShowTitle&&(o=!1),o){var s=new _a(r.Data,a.Name,null);s.DataType="ChartMultiBar",s.GetItemCallback=function(t){return r.GetItem(t)},t.TitlePaint[n].Data[i]=s}},this.CreateMultiText=function(t,e,a,i){var r=new Re;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.GetKData(),r.Texts=a.Draw.DrawData,r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateMultiSVGIcon=function(t,e,a,i){var r=new Ne;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.GetKData(),r.Family=a.Draw.DrawData.Family,r.AryIcon=a.Draw.DrawData.Icon,r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateChartDrawSVG=function(t,e,a,i){var r=new Ae;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.GetKData(),sa.IsBool(a.Draw.DrawData.EnableTooltip)&&(r.EnableTooltip=a.Draw.DrawData.EnableTooltip),sa.IsBool(a.Draw.DrawData.IsDrawFirst)&&(r.IsDrawFirst=a.Draw.DrawData.IsDrawFirst),sa.IsBool(a.Draw.EnalbeDetailNoOverlap)&&(r.EnalbeDetailNoOverlap=a.Draw.EnalbeDetailNoOverlap),sa.IsBool(a.Draw.EnableClick)&&(r.EnableClick=a.Draw.EnableClick),a.Draw.BuildKeyCallback&&(r.BuildKeyCallback=a.Draw.BuildKeyCallback),r.Family=a.Draw.DrawData.Family,r.TextFont=a.Draw.DrawData.TextFont,r.Texts=a.Draw.DrawData.Data,r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=new we;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,r.DrawCallback=a.Draw.Callback,t.ChartPaint.push(r)},this.CreateStackedBar=function(t,e,a,i){var r=new Be;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data.Data=a.Draw.DrawData,sa.IsNonEmptyArray(a.Draw.BarColor)&&(r.BarColor=a.Draw.BarColor),sa.IsNonEmptyArray(a.Draw.BarName)&&(r.BarName=a.Draw.BarName),sa.IsNumber(a.Draw.LineWidth)&&(r.LineWidth=a.Draw.LineWidth),sa.IsNumber(a.Draw.BarType)&&(r.BarType=a.Draw.BarType),t.ChartPaint.push(r);var n=e+1,o=new _a(r.Data,r.BarName,r.BarColor);o.DataType="ChartStackedBar",t.TitlePaint[n].Data[i]=o},this.CreateKLineTable=function(t,e,a,i){var r=new wt;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data=t.GetKData(),r.AryTableData=a.Draw.DrawData,sa.IsNumber(a.Draw.RowCount)&&(r.RowCount=a.Draw.RowCount),sa.IsNonEmptyArray(a.Draw.RowName)&&(r.RowName=a.Draw.RowName);var n=a.Draw.Config;if(n){if(n.BGColor&&(r.BGColor=n.BGColor),n.TextColor&&(r.TextColor=n.TextColor),n.BorderColor&&(r.BorderColor=n.BorderColor),sa.IsNumber(n.RowNamePosition)&&(r.RowNamePosition=n.RowNamePosition),sa.IsNumber(n.RowHeightType)&&(r.RowHeightType=n.RowHeightType),n.ItemMergin){var o=n.ItemMergin;sa.IsNumber(o.Left)&&(r.ItemMergin.Left=o.Left),sa.IsNumber(o.Top)&&(r.ItemMergin.Top=o.Top),sa.IsNumber(o.Bottom)&&(r.ItemMergin.Bottom=o.Bottom),sa.IsNumber(o.Right)&&(r.ItemMergin.Right=o.Right),sa.IsNumber(o.YOffset)&&(r.ItemMergin.YOffset=o.YOffset)}if(n.TextFont){o=n.TextFont;sa.IsNumber(o.FontMaxSize)&&(r.TextFontConfig.FontMaxSize=o.FontMaxSize),o.Family&&(r.TextFontConfig.Family=o.Family)}}r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r);var s=e+1,h=new _a(r.Data,r.BarName,r.BarColor);h.DataType="ChartKLineTable",t.TitlePaint[s].Data[i]=h},this.CreateScatterPlot=function(t,e,a,i){var r=new kt;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data.Data=a.Draw.DrawData,r.Color=a.Draw.Color,r.Radius=a.Draw.Radius,t.ChartPaint.push(r)},this.CreateScatterPlotV2=function(t,e,a,i){var r=new Xt;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data=t.GetKData(),r.AryPoint=a.Draw.DrawData;var n=a.Draw.Config;n&&(n.Color&&(r.Color=n.Color),sa.IsNumber(n.Radius)&&(r.Radius=n.Radius),n.TextColor&&(r.TextColor=n.TextColor),n.Font&&(r.Font=n.Font)),r.BuildCacheData(),this.SetChartIndexName(r),t.ChartPaint.push(r)},this.CreateClipColorStick=function(t,e,a,i){var r=new me;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data.Data=a.Draw.DrawData,a.Option&&r.SetOption&&r.SetOption(a.Option),t.ChartPaint.push(r);var n=e+1;if(!1===a.IsShowTitle);else{var o=this.GetDefaultColor(i);a.Option&&a.Option.TitleColor&&(o=this.GetColor(a.Option.TitleColor)),t.TitlePaint[n].Data[i]=new _a(r.Data,a.Name,o)}},this.CreateColorKLine=function(t,e,a,i){var r=new Mt;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.KLineColor=a.Draw.DrawData.KLine,a.Color&&(r.Color=a.Color),t.ChartPaint.push(r)},this.CreateRectangle=function(t,e,a,i){var r=new Fe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Color=[a.Draw.DrawData.Color],r.Rect=a.Draw.DrawData.Rect,a.Color&&(r.BorderColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateScriptOverlayLine=function(t,e,a,i){var r=new Ut;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}a.IsDotLine&&(r.IsDotLine=!0),0==a.IsShow&&(r.IsShow=!1);var o=e+1;r.Data.Data=a.Draw.DrawData.Data,r.MainData.Data=a.Draw.DrawData.MainData,a.Draw.DrawData.Title&&(t.TitlePaint[o].Data[i]=new _a(r.Data,a.Draw.DrawData.Title,r.Color)),t.ChartPaint.push(r)},this.CreateSelfKLine=function(t,e,a){var i=new Lt;i.Canvas=t.Canvas,i.Name="Self Kline",i.Identify=this.Guid,i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.Data=a,i.IsShowMaxMinPrice=!1,i.IsShowKTooltip=!1,i.DrawType=this.KLineType,t.ChartPaint.push(i)},this.BindInstructionData=function(t,e,a){if(!(null==this.OutVar||this.OutVar.length<0)){var i="";for(var r in this.Arguments){var n=this.Arguments[r];i.length>0&&(i+=","),i+=n.Value.toString()}if(i.length>0&&(i="("+i+")"),2==this.InstructionType){var o=this.OutVar[this.OutVar.length-1];return t.SetInstructionData(this.InstructionType,{Data:o.Data,Name:this.Name,Param:i,ID:this.ID}),!0}if(1==this.InstructionType){var s,h;for(var l in this.OutVar){var u=this.OutVar[l];"ENTERLONG"==u.Name?s=u.Data:"EXITLONG"==u.Name&&(h=u.Data)}return t.SetInstructionData(this.InstructionType,{Buy:s,Sell:h,Name:this.Name,Param:i,ID:this.ID}),!0}}},this.BindData=function(t,e,a){if(0==e&&this.InstructionType)this.BindInstructionData(t,e,a);else if(t.DeleteIndexPaint(e),0==e&&t.ShowKLine(!0),!(null==this.OutVar||this.OutVar.length<0)){if(null!=this.KLineType&&(0===this.KLineType||1===this.KLineType||2===this.KLineType?this.CreateSelfKLine(t,e,a):-1===this.KLineType&&0==e&&t.ShowKLine(!1)),e>=1&&t.Frame){var i=t.Frame.SubFrame[e].Frame.YSplitOperator;i&&(i.Reset(),i.FloatPrecision=this.FloatPrecision,this.YAxis&&i.SetOption(this.YAxis)),this.YSpecificMaxMin&&(t.Frame.SubFrame[e].Frame.YSpecificMaxMin=this.YSpecificMaxMin),this.YSplitScale&&(t.Frame.SubFrame[e].Frame.YSplitScale=this.YSplitScale)}sa.IsNumber(this.YSplitType)&&(t.Frame.SubFrame[e].Frame.YSplitOperator.SplitType=this.YSplitType);for(var r=0;r<this.OutVar.length;++r){var n=this.OutVar[r];if(!0!==n.IsExData&&(1e3!=n.Type&&1001!=n.Type)){if(0==n.Type)n.IsOverlayLine?this.CreateOverlayLine(t,e,n,r,n.Type):n.IsSingleLine?this.CreateSingleLine(t,e,n,r,n.Type):this.CreateLine(t,e,n,r,n.Type);else if(1==n.Type)switch(n.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,n,r);break;case"DRAWTEXT":this.CreateDrawTextV2(t,e,n,r);break;case"SUPERDRAWTEXT":this.CreateText(t,e,n,r);break;case"DRAWLINE":this.CreateStraightLine(t,e,n,r);break;case"DRAWBAND":this.CreateBand(t,e,n,r);break;case"FILLRGN":this.CreateFillRGN(t,e,n,r);break;case"FILLRGN2":this.CreateFillRGN2(t,e,n,r);break;case"FILLTOPRGN":case"FILLBOTTOMRGN":case"FILLVERTICALRGN":this.CreateFillBGRGN(t,e,n,r);break;case"FLOATRGN":this.CreateFLOATRGN(t,e,n,r);break;case"DRAWKLINE":case"DRAWKLINE1":this.CreateKLine(t,e,n,r);break;case"DRAWOVERLAYKLINE":this.CreateOverlayKLine(t,e,n,r);break;case"DRAWCOLORKLINE":this.CreateDrawColorKLine(t,e,n,r);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,n,r);break;case"POLYLINE":this.CreatePolyLine(t,e,n,r);break;case"DRAWGBK":case"DRAWGBK2":this.CreateBackgroud(t,e,n,r);break;case"DRAWGBK_DIV":this.CreateBackgroundDiv(t,e,n,r);break;case"DRAWTEXT_LINE":this.CreateTextLine(t,e,n,r);break;case"DRAWNUMBER":this.CreateDrawNumber(t,e,n,r);break;case"DRAWNUMBER_FIX":case"DRAWTEXT_FIX":this.CreateNumberText(t,e,n,r);break;case"DRAWICON":this.CreateIcon(t,e,n,r);break;case"ICON":this.CreateIcon(t,e,n,r);break;case"TIPICON":this.CreateTipIcon(t,e,n,r);break;case"DRAWCHANNEL":this.CreateChannel(t,e,n,r);break;case"PARTLINE":this.CreatePartLine(t,e,n,r);break;case"DRAWRECTREL":this.CreateRectangle(t,e,n,r);break;case"DRAWTEXTABS":case"DRAWTEXTREL":this.CreateDrawText(t,e,n,r);break;case"DRAWOVERLAYLINE":this.CreateScriptOverlayLine(t,e,n,r);break;case"DRAWSL":this.CreateChartSlopeLine(t,e,n,r);break;case"VERTLINE":this.CreateChartVericaltLine(t,e,n,r);break;case"HORLINE":this.CreateChartHorizontalLine(t,e,n,r);break;case"MULTI_LINE":this.CreateMultiLine(t,e,n,r);break;case"MULTI_POINT":this.CreateMultiPoint(t,e,n,r);break;case"MULTI_BAR":this.CreateMultiBar(t,e,n,r);break;case"MULTI_TEXT":this.CreateMultiText(t,e,n,r);break;case"MULTI_SVGICON":this.CreateMultiSVGIcon(t,e,n,r);break;case"DRAWSVG":this.CreateChartDrawSVG(t,e,n,r);break;case"DRAWTITLE":this.CreateTitle(t,e,n,r);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,n,r);break;case"COLOR_KLINE":this.CreateColorKLine(t,e,n,r);break;case"KLINE_BG":this.CreateBackgroud(t,e,n,r);break;case"MULTI_POINT_LINE":this.CreateLineMultiData(t,e,n,r);break;case"DRAW_SIMPLE_TABLE":this.CreateSimpleTable(t,e,n,r);break;case"DRAW_SIMPLE_PIE":this.CreateSimplePie(t,e,n,r);break;case"DRAW_SIMPLE_RADAR":this.CreateSimpleRadar(t,e,n,r);break;case"DRAW_SIMPLE_DOUGHNUT":this.CreateSimpleDoughnut(t,e,n,r);break;case"BUY":case"SELL":case"SELLSHORT":case"BUYSHORT":this.CreateTradeIcon(t,e,n,r);break;case"DRAWLASTBARICON":case"DRAWLASTBARNUMBER":case"DRAWLASTBARTEXT":this.CreateDrawLastBarText(t,e,n,r);break;case Tn.OVERLAY_BARS:this.CreateStackedBar(t,e,n,r);break;case Tn.KLINE_TABLE:this.CreateKLineTable(t,e,n,r);break;case Tn.SCATTER_PLOT:this.CreateScatterPlot(t,e,n,r);break;case Tn.SCATTER_PLOT_V2:this.CreateScatterPlotV2(t,e,n,r);break;case Tn.CLIP_COLOR_STICK:this.CreateClipColorStick(t,e,n,r);break;default:var o=vn.Get(n.Draw.DrawType);o&&o.CreateChartCallback&&o.CreateChartCallback(t,e,n,r,this);break}else 2==n.Type?this.CreateMACD(t,e,n,r):3==n.Type?this.CreatePointDot(t,e,n,r,a):4==n.Type?this.CreateLineStick(t,e,n,r):5==n.Type?this.CreateStick(t,e,n,r):6==n.Type?this.CreateVolStick(t,e,n,r,a):7==n.Type||8==n.Type?this.CreateLine(t,e,n,r,n.Type):9==n.Type&&this.CreateArea(t,e,n,r);var s=t.TitlePaint[e+1];s&&s.Data&&r<s.Data.length&&(this.StringFormat>0&&(s.Data[r].StringFormat=this.StringFormat),this.FloatPrecision>=0&&(s.Data[r].FloatPrecision=this.FloatPrecision),this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&s.SetDynamicTitle(this.OutName,this.Arguments))}}var h=e+1;s=t.TitlePaint[h];if(s.Title=this.Name,s.Identify=this.Guid,s.ArgumentsText=null,s.Script=this,s.IsShowMainIndexTitle=this.IsShowIndexTitle,!this.IsShortTitle){for(var l="",u=0;u<this.Arguments.length;++u){var C=this.Arguments[u];l.length>0&&(l+=","),l+=C.Value.toString()}l.length>0&&(s.ArgumentsText="(".concat(l,")"))}return this.TitleFont&&(s.Font=this.TitleFont),!0}},this.GetDefaultColor=function(t){var e=null;qi&&qi.Index&&qi.Index.LineColor&&(e=qi.Index.LineColor),e&&Array.isArray(e)||(e=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"]);var a=parseInt(t);return e[a%(e.length-1)]},this.GetColor=function(t){if(0==t.indexOf("RGB("))return t.toLowerCase();if(0==t.indexOf("rgb("))return t;if(0==t.indexOf("RGBA("))return t.toLowerCase();if(0==t.indexOf("rgba("))return t;var e=In.ColorVarToRGB(t);return e||"rgb(30,144,255)"}}function gn(t,e,a,i){this.newMethod=pn,this.newMethod(t,e,a,i),delete this.newMethod,this.ClassName="OverlayScriptIndex",this.OverlayIndex=null,this.ShowConditionError=function(t,e){var a=t.HQChart,i=(t.WindowIndex,"指标不支持当前品种或周期");e&&(i=e);var r=this.OverlayIndex,n=r.Frame;n.ChartPaint=[];var o=new Vt;o.Canvas=a.Canvas,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.NotSupportMessage=i,n.ChartPaint.push(o),a.Draw()},this.BindData=function(t,e,a){if(this.OverlayIndex&&1==this.OverlayIndex.IsOverlay&&(this.OverlayIndex.Frame.ChartPaint=[],sa.IsNonEmptyArray(this.OutVar))){var i=this.OverlayIndex.Frame.Frame.YSplitOperator;i&&(i.Reset(),i.FloatPrecision=this.FloatPrecision,sa.IsNumber(this.YSplitType)&&(i.SplitType=this.YSplitType),this.YAxis&&i.SetOption(this.YAxis));var r={Data:[],Title:this.Name,Frame:this.OverlayIndex.Frame.Frame,Script:this,IsShowIndexTitle:this.IsShowIndexTitle},n="";for(var o in this.Arguments){var s=this.Arguments[o];n.length>0&&(n+=","),n+=s.Value.toString()}n.length>0&&(r.Title=this.Name+"("+n+")");var h=e+1,l=t.TitlePaint[h];if(l.OverlayIndex.set(this.OverlayIndex.Identify,r),this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&l.SetDynamicTitle(this.OutName,this.Arguments,this.OverlayIndex.Identify),this.OverlayIndex.Frame.Frame.Title=this.Name,t.Frame.SubFrame[e]){var u=t.Frame.SubFrame[e].Frame;u&&(this.OverlayIndex.Frame.Frame.XPointCount=u.XPointCount)}for(o=0;o<this.OutVar.length;++o){var C=this.OutVar[o];if(!0!==C.IsExData){if(0==C.Type)this.CreateLine(t,e,C,o,C.Type);else if(1==C.Type)switch(C.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,C,o);break;case"DRAWTEXT":this.CreateDrawTextV2(t,e,C,o);break;case"SUPERDRAWTEXT":this.CreateText(t,e,C,o);break;case"DRAWLINE":this.CreateStraightLine(t,e,C,o);break;case"DRAWBAND":this.CreateBand(t,e,C,o);break;case"DRAWKLINE":this.CreateKLine(t,e,C,o);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,C,o);break;case"POLYLINE":this.CreatePolyLine(t,e,C,o);break;case"DRAWGBK":case"DRAWGBK2":this.CreateBackgroud(t,e,C,o);break;case"DRAWNUMBER":case"DRAWNUMBER_FIX":case"DRAWTEXT_FIX":this.CreateNumberText(t,e,C,o);break;case"DRAWICON":this.CreateIcon(t,e,C,o);break;case"TIPICON":this.CreateTipIcon(t,e,C,o);break;case"DRAWCHANNEL":this.CreateChannel(t,e,C,o);break;case"DRAWTEXT_LINE":this.CreateTextLine(t,e,C,o);break;case"VERTLINE":this.CreateChartVericaltLine(t,e,C,o);break;case"HORLINE":this.CreateChartHorizontalLine(t,e,C,o);break;case"MULTI_LINE":this.CreateMultiLine(t,e,C,o);break;case"MULTI_POINT":this.CreateMultiPoint(t,e,C,o);break;case"MULTI_BAR":this.CreateMultiBar(t,e,C,o);break;case"MULTI_TEXT":this.CreateMultiText(t,e,C,o);break;case"MULTI_SVGICON":this.CreateMultiSVGIcon(t,e,C,o);break;case"DRAWSVG":this.CreateChartDrawSVG(t,e,C,o);break;case"DRAWTITLE":this.CreateTitle(t,e,C,o);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,C,o);break;case"DRAW_SIMPLE_TABLE":this.CreateSimpleTable(t,e,C,o);break;case"DRAW_SIMPLE_PIE":this.CreateSimplePie(t,e,C,o);break;case"DRAW_SIMPLE_DOUGHNUT":this.CreateSimpleDoughnut(t,e,C,o);break;case"DRAW_SIMPLE_RADAR":this.CreateSimpleRadar(t,e,C,o);break;case"KLINE_BG":this.CreateBackgroud(t,e,C,o);break;case"PARTLINE":this.CreatePartLine(t,e,C,o);break;case"DRAWTEXTABS":case"DRAWTEXTREL":this.CreateDrawText(t,e,C,o);break;case Tn.OVERLAY_BARS:this.CreateStackedBar(t,e,C,o);break;case"DRAWCOLORKLINE":this.CreateDrawColorKLine(t,e,C,o);break;default:var D=vn.Get(C.Draw.DrawType);D&&D.CreateChartCallback&&D.CreateChartCallback(t,e,C,o,this);break}else 2==C.Type?this.CreateMACD(t,e,C,o):3==C.Type?this.CreatePointDot(t,e,C,o,a):4==C.Type?this.CreateLineStick(t,e,C,o):5==C.Type?this.CreateStick(t,e,C,o):6==C.Type?this.CreateVolStick(t,e,C,o,a):(7==C.Type||8==C.Type)&&this.CreateLine(t,e,C,o,C.Type);var f=r.Data[o];f&&(this.FloatPrecision>=0&&(f.FloatPrecision=this.FloatPrecision),sa.IsNumber(this.StringFormat)&&(f.StringFormat=this.StringFormat))}}return!0}},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;e.Self.OutVar=t,e.Self.BindData(a,i,r),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),!1===e.Self.IsSync&&e.HQChart.Draw();var n=a.GetOverlayIndexEvent();if(n){var o=e.Self,s={OutVar:o.OutVar,WindowIndex:i,Name:o.Name,Arguments:o.Arguments,HistoryData:r,Identify:o.OverlayIndex.Identify,Stock:{Symbol:a.Symbol,Name:a.Name}};n.Callback(n,s,o)}},this.ReloadChartResource=function(t,e,a){var i=t.GetEventCallback(m.ON_RELOAD_OVERLAY_INDEX_CHART_RESOURCE);if(i&&i.Callback){var r=this.OverlayIndex,n=r.Frame,o=n.Script,s={Chart:a,IndexName:o.Name,IndexID:o.ID,HQChart:t,WindowIndex:e,Guid:r.Identify};i.Callback(i,s,this)}},this.CreateLine=function(t,e,a,i,r){var n=this.OverlayIndex,o=n.Frame;if(7==r)var s=new Jt;else s=new Vt;if(s.Canvas=t.Canvas,s.DrawType=1,s.Name=a.Name,s.ChartBorder=o.Frame.ChartBorder,s.ChartFrame=o.Frame,s.Identify=n.Identify,s.HQChart=t,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),8==r&&(s.DrawType=2,s.BreakPoint=a.BreakPoint),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(h)&&h>0&&(s.LineWidth=h)}sa.IsNonEmptyArray(a.AryBreakPoint)&&(s.AryBreakPoint=a.AryBreakPoint),0==a.IsShow&&(s.IsShow=!1),s.Data.Data=a.Data,this.ReloadChartResource(t,e,s);var l=e+1,u=t.TitlePaint[l],C=new _a(s.Data,a.Name,s.Color);this.SetTitleData(C,s),u.OverlayIndex.get(n.Identify).Data[i]=C,this.SetChartIndexName(s),o.ChartPaint.push(s)},this.CreateBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new ie;o.Canvas=t.Canvas,a.Draw.Width>0?o.Width=a.Draw.Width:o.Width=1,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i);o.Data.Data=a.Draw.DrawData,this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateDrawText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new re;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.ReloadResource(),a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.IsDrawAbove?o.Direction=1:o.Direction=0,o.DrawData=a.Draw.DrawData,a.DrawFontSize>0&&(o.TextFont="".concat(a.DrawFontSize*F(),"px 微软雅黑")),n.ChartPaint.push(o)},this.CreateDrawTextV2=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new oe;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.ReloadResource(),a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(o.TextAlign="center"),!0===a.IsDrawAbove&&(o.TextBaseline="bottom"),!0===a.IsDrawBelow&&(o.TextBaseline="top"),a.Draw.DrawData&&(o.Data.Data=a.Draw.DrawData),o.Text=a.Draw.Text,a.Draw.Direction>0&&(o.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(o.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(o.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?o.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(o.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?o.TextBaseline="top":1==a.DrawVAlign?o.TextBaseline="middle":2==a.DrawVAlign&&(o.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?o.TextAlign="left":1==a.DrawAlign?o.TextAlign="center":2==a.DrawAlign&&(o.TextAlign="right")),a.DrawFontSize>0&&(o.FixedFontSize=a.DrawFontSize),a.Background&&(o.TextBG=a.Background),a.VerticalLine&&(o.VerticalLine=a.VerticalLine),sa.IsNumber(a.XOffset)&&(o.ShowOffset.X=a.XOffset),sa.IsNumber(a.YOffset)&&(o.ShowOffset.Y=a.YOffset),n.ChartPaint.push(o)},this.CreateText=function(t,e,a,i,r){var n=this.OverlayIndex,o=n.Frame,s=new re;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=o.Frame.ChartBorder,s.ChartFrame=o.Frame,s.Identify=n.Identify,s.ReloadResource(),a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i);a.Draw.Position&&(s.Position=a.Draw.Position),a.Draw.DrawData&&(s.Data.Data=a.Draw.DrawData),s.Text=a.Draw.Text,a.Draw.Direction>0&&(s.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(s.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(s.TextAlign=a.Draw.TextAlign),o.ChartPaint.push(s)},this.CreateMACD=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new ce;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify;var s=e+1;o.Data.Data=a.Data;var h=t.TitlePaint[s],l=this.GetDefaultColor(i);a.Color&&(l=this.GetColor(a.Color)),a.UpColor&&(o.UpColor=a.UpColor),a.DownColor&&(o.DownColor=a.DownColor),this.ReloadChartResource(t,e,o),h.OverlayIndex.get(r.Identify).Data[i]=new _a(o.Data,a.Name,l),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreatePointDot=function(t,e,a,i,r){var n=this.OverlayIndex,o=n.Frame,s=new Qt;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=o.Frame.ChartBorder,s.ChartFrame=o.Frame,s.Identify=n.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.Radius&&(s.Radius=a.Radius),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(h)&&h>0&&(s.Radius=h)}sa.IsBool(a.UpDownDot)&&(s.EnableUpDownColor=a.UpDownDot,s.HistoryData=r);var l=e+1;s.Data.Data=a.Data;var u=t.TitlePaint[l];u.OverlayIndex.get(n.Identify).Data[i]=new _a(s.Data,a.Name,s.Color),this.SetChartIndexName(s),o.ChartPaint.push(s)},this.CreateStick=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new qt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(o.LineWidth=s)}var h=e+1;o.Data.Data=a.Data,this.ReloadChartResource(t,e,o);var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new _a(o.Data,a.Name,o.Color),n.ChartPaint.push(o)},this.CreateLineStick=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new jt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(o.LineWidth=s)}var h=e+1;o.Data.Data=a.Data;var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new _a(o.Data,a.Name,o.Color),n.ChartPaint.push(o)},this.CreateStraightLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Vt;if(o.DrawType=1,o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(o.LineWidth=s)}o.Data.Data=a.Draw.DrawData,n.ChartPaint.push(o)},this.CreateVolStick=function(t,e,a,i,r){var n=this.OverlayIndex,o=n.Frame,s=new $t;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=o.Frame.ChartBorder,s.ChartFrame=o.Frame,s.Identify=n.Identify,s.KLineDrawType=t.KLineDrawType,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.UpColor&&(s.UpColor=a.UpColor),a.DownColor&&(s.DownColor=a.DownColor),sa.IsNumber(a.StickType)&&(s.BarType=a.StickType),sa.IsNumber(a.BarColorType)&&(s.BarColorType=a.BarColorType),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));sa.IsPlusNumber(h)&&(s.BarWidth=h)}var l=e+1;s.Data.Data=a.Data,s.HistoryData=r,this.ReloadChartResource(t,e,s);var u=t.TitlePaint[l],C=new _a(s.Data,a.Name,s.Color);u.OverlayIndex.get(n.Identify).Data[i]=C,this.SetTitleData(C,s),this.SetChartIndexName(s),o.ChartPaint.push(s)},this.CreateBand=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new de;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.FirstColor=a.Draw.Color[0],o.SecondColor=a.Draw.Color[1],o.Data.Data=a.Draw.DrawData,sa.IsBool(a.IsFirstDraw)&&(o.IsDrawFirst=a.IsFirstDraw),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateKLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Lt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data.Data=a.Draw.DrawData,o.IsShowMaxMinPrice=!1,o.IsShowKTooltip=!1,a.Color&&(o.UnchagneColor=o.DownColor=o.UpColor=this.GetColor(a.Color)),a.Draw.Config){var s=a.Draw.Config;sa.IsBool(s.IsShowMaxMinPrice)&&(o.IsShowMaxMinPrice=s.IsShowMaxMinPrice),sa.IsBool(s.IsShowKTooltip)&&(o.IsShowKTooltip=s.IsShowKTooltip),s.Symbol&&(o.Symbol=s.Symbol),s.Name&&(o.Title=s.Name)}var h=!1;if(sa.IsBool(a.IsShowTitle)&&(h=a.IsShowTitle),h){var l=e+1;o.Data.Data=a.Draw.DrawData;var u=t.TitlePaint[l],C=new _a(o.Data,a.Name,o.Color);C.DataType="DRAWKLINE",C.Symbol=o.Symbol,u.OverlayIndex.get(r.Identify).Data[i]=C}n.ChartPaint.push(o)},this.CreatePolyLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Vt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(o.LineWidth=s)}var h=e+1;o.Data.Data=a.Draw.DrawData;var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new _a(line.Data," ",line.Color),n.ChartPaint.push(o)},this.CreateNumberText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new re;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.ReloadResource(),o.TextAlign="center",a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.IsDrawAbove?o.Direction=1:o.Direction=2,a.Draw.Position&&(o.Position=a.Draw.Position);o.Data.Data=a.Draw.DrawData.Value,o.Text=a.Draw.DrawData.Text,this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateTextLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Ee;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;o.Text=s.Text,o.Line=s.Line,o.Price=s.Price}n.ChartPaint.push(o)},this.CreateTitle=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Ht;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),o.AryTitle=a.Draw.DrawData.AryTitle,o.BuildCacheData();var s=e+1,h=t.TitlePaint[s],l=new _a(o.Data,o.Name,o.Color);l.DataType="ChartIndexTitle",l.Chart=o,h.OverlayIndex.get(r.Identify).Data[i]=l,this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateStackedBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Be;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,sa.IsNonEmptyArray(a.Draw.BarColor)&&(o.BarColor=a.Draw.BarColor),sa.IsNonEmptyArray(a.Draw.BarName)&&(o.BarName=a.Draw.BarName),sa.IsNumber(a.Draw.LineWidth)&&(o.LineWidth=a.Draw.LineWidth),sa.IsNumber(a.Draw.BarType)&&(o.BarType=a.Draw.BarType),o.Data.Data=a.Draw.DrawData;var s=e+1,h=t.TitlePaint[s],l=new _a(o.Data,o.BarName,o.BarColor);l.DataType="ChartStackedBar",h.OverlayIndex.get(r.Identify).Data[i]=l,n.ChartPaint.push(o)},this.CreateDrawColorKLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Mt;o.Canvas=t.Canvas,o.Name=a.Name,o.DrawName="DRAWCOLORKLINE",o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data.Data=a.Draw.DrawData,sa.IsBool(a.Draw.IsEmptyBar)&&(o.IsEmptyBar=a.Draw.IsEmptyBar),a.Draw.Color&&(o.Color=a.Draw.Color),n.ChartPaint.push(o)},this.CreateIcon=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new re;o.Canvas=t.Canvas,o.TextAlign="center",o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.DrawVAlign>=0&&(0==a.DrawVAlign?o.Direction=1:1==a.DrawVAlign?o.Direction=0:2==a.DrawVAlign&&(o.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?o.TextAlign="left":1==a.DrawAlign?o.TextAlign="center":2==a.DrawAlign&&(o.TextAlign="right")),sa.IsNumber(a.XOffset)&&(o.ShowOffset.X=a.XOffset),sa.IsNumber(a.YOffset)&&(o.ShowOffset.Y=a.YOffset),o.Data.Data=a.Draw.DrawData;var s=a.Draw.Icon;1==s.IconFont?o.IconFont={Family:s.Family,Text:s.Symbol,Color:s.Color}:(o.Text=s.Symbol,a.Color?o.Color=this.GetColor(a.Color):s.Color?o.Color=s.Color:o.Color="rgb(0,0,0)"),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateTipIcon=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Ae;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),o.Family=a.Draw.Icon.Family,o.TextFont=qi.TIPICON.TextFont;var s=qi.TIPICON.Size,h=qi.TIPICON.Color,l=0,u=2;if(sa.IsNumber(a.YOffset)&&(l=a.YOffset),a.Color&&(h=this.GetColor(a.Color)),a.DrawFontSize>0&&(s=a.DrawFontSize),a.DrawVAlign>=0&&(u=a.DrawVAlign),a.Draw&&sa.IsNonEmptyArray(a.Draw.DrawData)&&a.Draw.Icon){var C=a.Draw.DrawData,D=[],f=Array.isArray(a.Draw.Text),c=null;!f&&a.Draw.Text&&(c={Text:a.Draw.Text});for(var m=0;m<C.length;++m){var d=C[m],I=o.Data.Data[m];if(sa.IsNumber(d)){var S={Value:d,Date:I.Date,Time:I.Time,SVG:{Symbol:a.Draw.Icon.Symbol,Size:s,Color:h,YOffset:l,VAlign:u}};if(f){var T=a.Draw.Text[m];T&&(S.Tooltip={Text:T})}else S.Tooltip=c;D.push(S)}}o.Texts=D}o.BuildCacheData(),n.ChartPaint.push(o)},this.CreateChannel=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new pe;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Draw.AreaColor?o.AreaColor=a.Draw.AreaColor:a.Color?o.AreaColor=this.GetColor(a.Color):o.AreaColor=this.GetDefaultColor(i),a.Draw.Border.Color?o.LineColor=a.Draw.Border.Color:o.LineColor=null,a.Draw.Border.Dotted&&(o.LineDotted=a.Draw.Border.Dotted),a.Draw.Border.Width>0&&(o.LineWidth=a.Draw.Border.Width),o.Data.Data=a.Draw.DrawData,n.ChartPaint.push(o)},this.CreatePartLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new zt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));sa.IsPlusNumber(s)&&(o.LineWidth=s)}sa.IsBool(a.IsDotLine)&&(o.IsDotLine=a.IsDotLine),sa.IsNonEmptyArray(a.LineDash)&&(o.LineDash=a.LineDash),o.Data.Data=a.Draw.DrawData,this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateMultiLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Me;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.ChartPaint[0].Data,o.Lines=a.Draw.DrawData,a.Draw.LineDash&&(o.LineDash=a.Draw.LineDash),sa.IsNumber(a.Draw.LineWidth)&&(o.LineWidth=a.Draw.LineWidth),sa.IsBool(a.Draw.IsFullRangeMaxMin)&&(o.IsFullRangeMaxMin=a.Draw.IsFullRangeMaxMin),a.Draw.Arrow){var s=a.Draw.Arrow;1==s.Start&&(o.Arrow.Start=!0),1==s.End&&(o.Arrow.End=!0),sa.IsNumber(s.Angle)&&(o.ArrawAngle=s.Angle),sa.IsNumber(s.Length)&&(o.ArrawLength=s.Length),sa.IsNumber(s.LineWidth)&&(o.ArrawLineWidth=s.LineWidth)}this.ReloadChartResource(t,e,o),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateMultiPoint=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new ye;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),o.PointGroup=a.Draw.DrawData,o.BuildCacheData();var s=e+1,h=!0;if(!1===a.IsShowTitle&&(h=!1),h){var l=t.TitlePaint[s],u=new _a(o.Data,a.Name,null);u.DataType="ChartMultiPoint",u.GetItemCallback=function(t){return o.GetItem(t)},l.OverlayIndex.get(r.Identify).Data[i]=u}this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateBackgroud=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new ge;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;o.Color=s.Color,o.ColorAngle=s.Angle,s.Data&&(o.Data.Data=s.Data)}n.ChartPaint.push(o)},this.CreateMultiBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Le;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),o.Bars=a.Draw.DrawData,o.BuildCacheData();var s=e+1,h=!0;if(!1===a.IsShowTitle&&(h=!1),h){var l=t.TitlePaint[s],u=new _a(o.Data,a.Name,null);u.DataType="ChartMultiBar",u.GetItemCallback=function(t){return o.GetItem(t)},l.OverlayIndex.get(r.Identify).Data[i]=u}this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateMultiText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Re;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),o.Texts=a.Draw.DrawData,o.BuildCacheData(),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateMultiSVGIcon=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Ne;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),o.Family=a.Draw.DrawData.Family,o.AryIcon=a.Draw.DrawData.Icon,o.BuildCacheData(),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateChartDrawSVG=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Ae;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.Data=t.GetKData(),sa.IsBool(a.Draw.DrawData.EnableTooltip)&&(o.EnableTooltip=a.Draw.DrawData.EnableTooltip),sa.IsBool(a.Draw.DrawData.IsDrawFirst)&&(o.IsDrawFirst=a.Draw.DrawData.IsDrawFirst),a.Draw.BuildKeyCallback&&(o.BuildKeyCallback=a.Draw.BuildKeyCallback),o.Family=a.Draw.DrawData.Family,o.TextFont=a.Draw.DrawData.TextFont,o.Texts=a.Draw.DrawData.Data,a.Draw.AutoPosition&&(o.AutoPosition=a.Draw.AutoPosition),sa.IsBool(a.Draw.EnalbeDetailNoOverlap)&&(o.EnalbeDetailNoOverlap=a.Draw.EnalbeDetailNoOverlap),sa.IsBool(a.Draw.EnableClick)&&(o.EnableClick=a.Draw.EnableClick),this.ReloadChartResource(t,e,o),o.BuildCacheData(),this.SetChartIndexName(o),n.ChartPaint.push(o)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new we;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,o.Data=t.ChartPaint[0].Data,o.Texts=a.Draw.DrawData,o.DrawCallback=a.Draw.Callback,n.ChartPaint.push(o)},this.CreateSimpleTable=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new At;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;s.TableData&&(o.Data.Data=s.TableData),s.BGColor&&(o.BGColor=s.BGColor),s.BorderColor&&(o.BorderColor=s.BorderColor),s.TextFont&&(o.TextFontConfig=s.TextFont),s.TextColor&&(o.TextColor=s.TextColor),sa.IsNumber(s.XOffset)&&(o.Offset.X=s.XOffset),sa.IsNumber(s.YOffset)&&(o.Offset.Y=s.YOffset)}n.ChartPaint.push(o)},this.CreateSimplePie=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Ot;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;s.Data&&(o.Data.Data=s.Data),s.BorderColor&&(o.BorderColor=s.BorderColor),s.TextFont&&(o.TextFontConfig=s.TextFont),s.TextColor&&(o.TextColor=s.TextColor),sa.IsNumber(s.XOffset)&&(o.Offset.X=s.XOffset),sa.IsNumber(s.YOffset)&&(o.Offset.Y=s.YOffset),sa.IsPlusNumber(s.Radius)&&(o.Radius=s.Radius)}n.ChartPaint.push(o)},this.CreateSimpleDoughnut=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new bt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;s.Data&&(o.Data.Data=s.Data),s.BorderColor&&(o.BorderColor=s.BorderColor),s.TextFont&&(o.TextFontConfig=s.TextFont),s.TextColor&&(o.TextColor=s.TextColor),sa.IsNumber(s.XOffset)&&(o.Offset.X=s.XOffset),sa.IsNumber(s.YOffset)&&(o.Offset.Y=s.YOffset),sa.IsPlusNumber(s.Radius)&&(o.Radius=s.Radius),sa.IsPlusNumber(s.InnerRadius)&&(o.InnerRadius=s.InnerRadius)}n.ChartPaint.push(o)},this.CreateSimpleRadar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new Bt;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,a.Draw&&a.Draw.DrawData){var s=a.Draw.DrawData;s.Data&&(o.Data.Data=s.Data),s.AryIndex&&(o.AryIndex=s.AryIndex),sa.IsPlusNumber(s.Radius)&&(o.Radius=s.Radius),s.BorderColor&&(o.BorderColor=s.BorderColor),s.TextFont&&(o.TextFontConfig=s.TextFont),s.TextColor&&(o.TextColor=s.TextColor),s.BorderColor&&(o.BorderColor=s.BorderColor),sa.IsNumber(s.XOffset)&&(o.Offset.X=s.XOffset),sa.IsNumber(s.YOffset)&&(o.Offset.Y=s.YOffset),sa.IsNonEmptyArray(s.AryArea)&&(o.AryAreaConfig=s.AryArea),o.BuildCacheData()}n.ChartPaint.push(o)},this.CreateChartVericaltLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new te;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(o.LineWidth=s)}this.SetChartLineDash(o,a.Draw.DrawData),o.Data.Data=a.Draw.DrawData.Data,n.ChartPaint.push(o)},this.CreateChartHorizontalLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,o=new ee;if(o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=n.Frame.ChartBorder,o.ChartFrame=n.Frame,o.Identify=r.Identify,o.HQChart=t,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(o.LineWidth=s)}this.SetChartLineDash(o,a.Draw.DrawData),o.ExtendType=a.Draw.DrawData.Extend,o.Data.Data=a.Draw.DrawData.Data,n.ChartPaint.push(o)},this.CreateSelfKLine=function(t,e,a){var i=this.OverlayIndex,r=i.Frame,n=new Lt;n.Canvas=t.Canvas,n.Name="Self Kline",n.ChartBorder=r.Frame.ChartBorder,n.ChartFrame=r.Frame,n.Identify=i.Identify,n.Data=a,n.IsShowMaxMinPrice=!1,n.IsShowKTooltip=!1,n.DrawType=this.KLineType,r.ChartPaint.push(n)},this.GetDefaultColor=function(t){var e=["rgb(24,71,178)","rgb(42,230,215)","rgb(252,96,154)","rgb(0,128,255)","rgb(229,0,79)","rgb(68,114,196)","rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)"],a=parseInt(t);return e[a%(e.length-1)]}}function xn(t,e,a,i,r){this.newMethod=r?gn:pn,this.newMethod(t,e,a,i),delete this.newMethod,this.ClassName="APIScriptIndex",this.IsOverlayIndex=1==r,this.ApiUrl,this.HQDataType,this.Version=1,i&&i.API&&(i.API.Url&&(this.ApiUrl=i.API.Url),i.API.Name&&(this.Name=this.ID=i.API.Name),i.API.ID&&(this.ID=i.API.ID),i.API.Version>0&&(this.Version=i.API.Version),!0===i.API.IsUsePageData&&(this.IsUsePageData=i.API.IsUsePageData)),this.Super_CopyTo=this.CopyTo,this.CopyTo=function(t){this.Super_CopyTo(t),t.ApiUrl=this.ApiUrl,t.Version=this.Version,t.IsOverlayIndex=this.IsOverlayIndex},this.RecvSubscribeData=function(t,e,a,i){2==this.Version?this.RecvAPIData2(t,e,a,i):this.RecvAPIData(t,e,a,i)},this.ExecuteScript=function(t,e,a){u.Complier.Log("[APIScriptIndex::ExecuteScript] name, Arguments ",this.Name,this.Arguments);var i=Sn.KLINE_ID,r=null;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?(i=t.DayCount>1?Sn.MULTIDAY_MINUTE_ID:Sn.MINUTE_ID,r=a.GetDateRange()):"HistoryMinuteChartContainer"===t.ClassName?i=Sn.HISTORY_MINUTE_ID:r=a.GetDateRange();var n,o=[];if(this.Arguments)for(var s in this.Arguments){var h=this.Arguments[s];o.push({name:h.Name,value:h.Value})}t.GetRequestDataCount&&(n=t.GetRequestDataCount());var l=this,C={indexname:this.ID,symbol:t.Symbol,script:this.Script,args:o,period:t.Period,right:t.Right,hqdatatype:i};if(r&&(C.DateRange=r),n&&(C.maxdatacount=n.MaxRequestDataCount,C.maxminutedaycount=n.MaxRequestMinuteDayCount),i!=Sn.MULTIDAY_MINUTE_ID&&i!=Sn.MINUTE_ID||(C.daycount=t.DayCount),this.HQDataType=i,++this.RunCount,t.NetworkFilter){var D={Name:"APIScriptIndex::ExecuteScript",Explain:"指标计算",Request:{Url:l.ApiUrl,Type:"POST",Data:C},Self:this,HQChart:t,PreventDefault:!1};if(t.NetworkFilter(D,(function(i){2==l.Version?l.RecvAPIData2(i,t,e,a):l.RecvAPIData(i,t,e,a)})),1==D.PreventDefault)return}io.HttpRequest({url:l.ApiUrl,data:C,type:"post",dataType:"json",async:!0,success:function(i){l.RecvAPIData(i,t,e,a)},error:function(t){l.RecvError(t)}})},this.RecvAPIData2=function(t,e,a,i){if(u.Complier.Log("[APIScriptIndex::RecvAPIData2] recv data ",this.Name,t),(this.HQDataType==Sn.KLINE_ID||this.HQDataType==Sn.MINUTE_ID||this.HQDataType==Sn.MULTIDAY_MINUTE_ID)&&(this.OutVar=this.ConvertToLocalData(t,e),u.Complier.Log("[APIScriptIndex::RecvAPIData2] conver to OutVar ",this.OutVar)),this.BindData(e,a,i),e.UpdataDataoffset(),e.UpdateFrameMaxMin(),e.Draw(),e.GetIndexEvent){var r=e.GetIndexEvent();if(r){t={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:i,Stock:{Symbol:e.Symbol,Name:e.Name}};r.Callback(r,t,this)}}},this.ConvertToLocalData=function(t,e){var a=t.OutVar;if("MinuteChartContainer"==e.ClassName||"MinuteChartHScreenContainer"==e.ClassName)var i=e.SourceData,r=i.GetAPIDataIndex(t.Date,t.Time);else{i=e.ChartPaint[0].Data;if(dt.IsDayPeriod(t.Period,!0))r=i.GetAPIDataIndex(t.Date);else r=i.GetAPIDataIndex(t.Date,t.Time)}var n=[];for(var o in a){var s=a[o],h={Type:s.Type,Name:s.Name};if(0==s.Type){h.Data=[];for(var l=0;l<r.length;++l){var u=r[l];u.Index<0?h.Data[l]=null:h.Data[l]=s.Data[u.Index]}h.Name&&h.Name.indexOf("@NODRAW@")>=0&&(h.Name=h.Name.replace("@NODRAW@",""))}else{if(1!=s.Type)continue;h.Name=s.DrawType,h.Draw={DrawType:s.DrawType};var C=s.Draw;switch(s.DrawType){case"STICKLINE":var D=[];for(l=0;l<r.length;++l){D[l]=null;u=r[l];var f=u.Index;if(!(f<0)){var c=C.Price[f],m=C.Price2[f];sa.IsNumber(c)&&sa.IsNumber(m)&&(D[l]={Value:c,Value2:m})}}h.Draw.DrawData=D,h.Draw.Width=C.Width,h.Draw.Type=C.Empty;break;case"DRAWTEXT":D=[];var d=[];for(l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){c=C.Price[f];if(sa.IsNumber(c)&&(D[l]=c),Array.isArray(C.Text)){s=C.Text[f];sa.IsString(s)&&(d[l]=s)}}}Array.isArray(C.Text)?h.Draw.Text=d:h.Draw.Text=C.Text,h.Draw.DrawData=D;break;case"DRAWNUMBER":for(D={Value:[],Text:[]},l=0;l<r.length;++l){D.Value[l]=null,D.Text[l]=null;u=r[l],f=u.Index;if(!(f<0)){c=C.Price[f];var I=C.Number[f];sa.IsNumber(c)&&sa.IsNumber(I)&&(D.Value[l]=c,D.Text[l]=I.toFixed(2))}}h.Draw.DrawData=D;break;case"DRAWBAND":for(D=[],l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){c=C.Val1[f],m=C.Val2[f];sa.IsNumber(c)&&sa.IsNumber(m)&&(D[l]={Value:c,Value2:m})}}h.Draw.DrawData=D,h.Draw.Color=[null,null],C.Color1&&(h.Draw.Color[0]=C.Color1.toLowerCase()),C.Color2&&(h.Draw.Color[1]=C.Color2.toLowerCase());break;case"DRAWKLINE":for(D=[],l=0;l<r.length;++l){s={Open:null,High:null,Low:null,Close:null};D[l]=s;u=r[l],f=u.Index;if(!(f<0)){var S=C.High[f],T=C.Low[f],v=C.Open[f],p=C.Close[f];sa.IsPlusNumber(S)&&sa.IsPlusNumber(T)&&sa.IsPlusNumber(v)&&sa.IsPlusNumber(p)&&(s.Open=v,s.Close=p,s.High=S,s.Low=T)}}h.Draw.DrawData=D;break;case"DRAWTEXT_FIX":for(D={Value:[],Text:[]},l=0;l<r.length;++l){D.Value[l]=0,D.Text[l]=null;u=r[l],f=u.Index;if(!(f<0)){var g=C.Cond[f];g&&(D.Value[l]=1,D.Text[l]=C.Text)}}h.Draw.DrawData=D,h.Draw.Position={X:C.X,Y:C.Y,Type:C.Type};break;case"DRAWNUMBER_FIX":for(D={Value:[],Text:[]},l=0;l<r.length;++l){D.Value[l]=null,D.Text[l]=null;u=r[l],f=u.Index;if(!(f<0)){var x=C.Number[f];sa.IsNumber(x)&&(D.Value[l]=x,D.Text[l]=sa.RemoveZero(x.toFixed(2)))}}h.Draw.DrawData=D,h.Draw.Position={X:C.X,Y:C.Y,Type:C.Type};break;case"DRAWICON":var F=Qr.GetDrawIcon(C.Type);F||Qr.GetDrawTextIcon(C.Type),F||(F={Symbol:"🚩"}),h.Draw.Icon=F;for(D=[],l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){x=C.Price[f];sa.IsNumber(x)&&(D[l]=x)}}h.Draw.DrawData=D;break;case"PARTLINE":for(D=[],l=0;l<r.length;++l){D[l]={Value:null,RGB:null};u=r[l],f=u.Index;if(!(f<0)){var E=C.Color[f];if(sa.IsString(E)){x=C.Price[f];sa.IsNumber(x)&&(D[l].Value=x,D[l].RGB=E)}}}h.Draw.DrawData=D;break;case"FILLRGN":for(D=[],l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){E=C.Color[f];if(sa.IsString(E)){x=C.Price[f];if(sa.IsNumber(x)){var L=C.Price2[f];sa.IsNumber(L)&&(D[l]={Value:x,Value2:L,Color:E})}}}}h.Draw.DrawData=D,h.Draw.DrawType="FILLRGN2";break;default:continue}}for(var o in s.Attribute){var M=s.Attribute[o];switch(M){case"COLORSTICK":h.Type=2;break;case"POINTDOT":h.Radius=qi.POINTDOT.Radius,h.Type=3;break;case"CIRCLEDOT":h.Radius=qi.CIRCLEDOT.Radius,h.Type=3;break;case"DOTLINE":h.IsDotLine=!0;break;case"DRAWABOVE":h.IsDrawAbove=!0;break;case"LINESTICK":h.Type=4;break;case"STICK":h.Type=5;break;case"VOLSTICK":h.Type=6;break;case"LINEAREA":h.Type=9;break;case"NODRAW":h.IsShow=!1;break;case"NONE_OUT_NAME":h.NoneName=!0;break;case"NOTEXT":h.IsShowTitle=!1;break}0==M.indexOf("COLOR")?h.Color=M:0==M.indexOf("LINETHICK")&&(h.LineWidth=M)}n.push(h)}return n},this.RecvAPIData=function(t,e,a,i){if(u.Complier.Log("[APIScriptIndex::RecvAPIData] recv data ",this.Name,t),0==t.code)if(!e.EnableVerifyRecvData||t.stock&&e.Symbol==t.stock.symbol)if(t.error&&sa.IsString(t.error.message)){var r={HQChart:e,WindowIndex:a,HistoryData:i,Self:this};this.ShowConditionError(r,t.error.message)}else{if(t.outdata&&t.outdata.name&&(this.Name=t.outdata.name),t.outdata.args)for(var n in this.Arguments=[],t.outdata.args){var o=t.outdata.args[n];this.Arguments.push({Name:o.name,Value:o.value})}if(this.HQDataType==Sn.KLINE_ID?(this.OutVar=this.FittingData(t.outdata,e),u.Complier.Log("[APIScriptIndex::RecvAPIData] conver to OutVar ",this.OutVar)):this.OutVar=this.FittingMinuteData(t.outdata,e),this.BindData(e,a,i),!this.IsOverlayIndex)if(0==this.IsLocked)e.Frame.SubFrame[a].Frame.SetLock(null);else{var s={IsLocked:!0,Callback:this.LockCallback,IndexName:this.Name,ID:this.LockID,BG:this.LockBG,Text:this.LockText,TextColor:this.LockTextColor,Font:this.LockFont,Count:this.LockCount,MinWidth:this.LockMinWidth};e.Frame.SubFrame[a].Frame.SetLock(s)}if(e.UpdataDataoffset(),e.UpdateFrameMaxMin(),!1===t.Redraw||!1===this.IsSync&&e.Draw(),e.GetIndexEvent){var h=e.GetIndexEvent();if(h){t={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:i,Stock:{Symbol:e.Symbol,Name:e.Name}};h.Callback(h,t,this)}}}else u.Chart.Warn("[APIScriptIndex::RecvAPIData] recv data symbol not match. HQChart[".concat(e.Symbol,"]"))},this.FittingArray=function(t,e,a,i,r){var n,o=i.ChartPaint[0].Data,s=[];for(var h in t){var l=t[h],u=new Dt;u.Date=e[h],a&&h<a.length&&(u.Time=a[h]),u.Value=l,s.push(u)}n=dt.IsDayPeriod(i.Period,!0)?o.GetFittingData(s):o.GetMinuteFittingData(s);var C,D=new dt;return D.Data=n,C=1==r?D.GetObject():D.GetValue(),C},this.FittingMultiLine=function(t,e,a,i){var r=i.ChartPaint[0].Data;if(dt.IsDayPeriod(i.Period,!0)){r=i.ChartPaint[0].Data;var n=[];for(var o in t){var s=t[o];for(var h in s.Point){var l=s.Point[h];n.push(l)}}return n.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(n),t}if(dt.IsMinutePeriod(i.Period,!0)||dt.IsTickPeriod(i.Period)||dt.IsSecondPeriod(i.Period)){r=i.ChartPaint[0].Data,n=[];for(var o in t){s=t[o];for(var h in s.Point){l=s.Point[h];n.push(l)}}return n.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(n),t}if(this.HQDataType==Sn.MINUTE_ID||this.HQDataType==Sn.MULTIDAY_MINUTE_ID){var u=i.SourceData;n=[];for(var o in t){s=t[o];for(var h in s.Point){l=s.Point[h];n.push(l)}}return n.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),u.GetDateTimeIndex(n),t}return null},this.FittingMultiText=function(t,e,a,i){if(dt.IsDayPeriod(i.Period,!0)){var r=i.ChartPaint[0].Data;return t.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(t),t}if(dt.IsMinutePeriod(i.Period,!0)||dt.IsTickPeriod(i.Period)||dt.IsSecondPeriod(i.Period)||dt.IsMilliSecondPeriod(i.Period)){r=i.ChartPaint[0].Data;return t.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(t),t}if(this.HQDataType==Sn.MINUTE_ID||this.HQDataType==Sn.MULTIDAY_MINUTE_ID){var n=i.SourceData;return t.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),n.GetDateTimeIndex(t),t}return null},this.FittingData=function(t,e){var a=t.outvar,i=t.date,r=t.time,n=(e.ChartPaint[0].Data,[]);if(!a)return n;for(var o=0;o<a.length;++o){var s=a[o],h={Name:s.name,Type:s.type};if(s.color&&(h.Color=s.color),sa.IsBool(s.IsShowTitle)&&(h.IsShowTitle=s.IsShowTitle),sa.IsNumber(s.DrawVAlign)&&(h.DrawVAlign=s.DrawVAlign),sa.IsNumber(s.DrawAlign)&&(h.DrawAlign=s.DrawAlign),s.data)h.Data=this.FittingArray(s.data,i,r,e),s.color&&(h.Color=s.color),s.linewidth&&(h.LineWidth=s.linewidth),sa.IsBool(s.isshow)&&(h.IsShow=s.isshow),1==s.isexdata&&(h.IsExData=!0),s.BreakPoint&&(h.BreakPoint=s.BreakPoint),s.UpColor&&(h.UpColor=s.UpColor),s.DownColor&&(h.DownColor=s.DownColor),sa.IsBool(s.isDotLine)&&(h.IsDotLine=s.isDotLine),sa.IsNonEmptyArray(s.lineDash)&&(h.LineDash=s.lineDash),sa.IsBool(s.isSingleLine)&&(h.IsSingleLine=s.isSingleLine),sa.IsNumber(s.StickType)&&(h.StickType=s.StickType),sa.IsNumber(s.BarColorType)&&(h.BarColorType=s.BarColorType),sa.IsNonEmptyArray(s.AryBreakPoint)&&(h.AryBreakPoint=s.AryBreakPoint),n.push(h);else if(s.Draw){var l=s.Draw,u={};if("DRAWICON"==l.DrawType)u.Icon=l.Icon,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("DRAWTEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("STICKLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.Width=l.Width,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if("DRAWBAND"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),u.Color=l.Color,h.Draw=u,n.push(h);else if("MULTI_LINE"==l.DrawType){if(u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),sa.IsNonEmptyArray(u.DrawData))for(var C=0;C<u.DrawData.length;++C)this.GetKLineData(u.DrawData[C].Point,e);h.Draw=u,l.LineDash&&(u.LineDash=l.LineDash),sa.IsBool(l.IsFullRangeMaxMin)&&(u.IsFullRangeMaxMin=l.IsFullRangeMaxMin),l.Arrow&&(u.Arrow=l.Arrow),sa.IsNumber(l.LineWidth)&&(u.LineWidth=l.LineWidth),n.push(h)}else if("MULTI_POINT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("MULTI_BAR"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if(l.DrawType==Tn.OVERLAY_BARS)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.BarName=l.BarName,u.BarColor=l.BarColor,u.LineWidth=l.LineWidth,u.BarType=l.BarType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if(l.DrawType==Tn.SCATTER_PLOT)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),u.Color=l.Color,u.Radius=l.Radius,h.Draw=u,n.push(h);else if(l.DrawType==Tn.SCATTER_PLOT_V2)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,u.Config=l.Config,h.Draw=u,n.push(h);else if(l.DrawType==Tn.KLINE_TABLE)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,u.RowCount=l.RowCount,u.RowName=l.RowName,u.Config=l.Config,h.Draw=u,n.push(h);else if("MULTI_TEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("MULTI_SVGICON"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={Icon:l.DrawData.Icon,Family:l.DrawData.Family},h.Draw=u,n.push(h);else if("DRAWSVG"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,l.AutoPosition&&(u.AutoPosition=l.AutoPosition),u.EnalbeDetailNoOverlap=l.EnalbeDetailNoOverlap,u.EnableClick=l.EnableClick,l.BuildKeyCallback&&(u.BuildKeyCallback=l.BuildKeyCallback),u.DrawData={Data:l.Data,Family:l.Family,TextFont:l.TextFont,EnableTooltip:l.EnableTooltip,IsDrawFirst:l.IsDrawFirst},h.Draw=u,n.push(h);else if("DRAWTITLE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("MULTI_HTMLDOM"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.Callback=l.Callback,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h);else if("COLOR_KLINE"==l.DrawType){u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType;var D=this.FittingMultiText(l.DrawData.KLine,i,r,e),f=new Map;for(var o in D){s=D[o];f.set(s.Index,s)}u.DrawData={KLine:f},l.Color&&(h.Color=l.Color),h.Draw=u,n.push(h)}else if("KLINE_BG"==l.DrawType)u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={},u.DrawData.Color=l.Color,u.DrawData.Angle=l.Angle,2==l.Ver?u.DrawData.Data=this.FittingKLineBG_V2(l.DrawData,e):u.DrawData.Data=this.FittingKLineBG(l.DrawData,e),h.Draw=u,h.Name=l.DrawType,n.push(h);else if("MULTI_POINT_LINE"==l.DrawType)u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={},u.DrawData.Color=l.Color,u.DrawData.PointRadius=l.PointRadius,u.DrawData.PointColor=l.PointColor,u.DrawData.LineWidth=l.LineWidth,u.DrawData.Data=this.FittingMultiPointLine(l.DrawData,e),h.Draw=u,n.push(h);else if("PARTLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,sa.IsString(l.LineWidth)&&(h.LineWidth=l.LineWidth),sa.IsBool(l.IsDotLine)&&(h.IsDotLine=l.IsDotLine),sa.IsNonEmptyArray(l.LineDash)&&(h.LineDash=l.LineDash),n.push(h);else if(l.DrawType==Tn.CLIP_COLOR_STICK)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.Data,i,r,e),h.Draw=u,l.LineWidth&&(h.LineWidth=l.LineWidth),l.UpColor&&(h.UpColor=l.UpColor),l.DownColor&&(h.DownColor=l.DownColor),n.push(h);else if("DRAWCOLORKLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,l.Color&&(u.Color=l.Color),sa.IsBool(l.IsEmptyBar)&&(u.IsEmptyBar=l.IsEmptyBar),n.push(h);else if("DRAWTEXTREL"==l.DrawType||"DRAWTEXTABS"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,l.Font&&(h.Font=l.Font),n.push(h);else if("DRAWTEXT_LINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,l.Font&&(h.Font=l.Font),n.push(h);else if("DRAW_SIMPLE_TABLE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("DRAW_SIMPLE_PIE"==l.DrawType||"DRAW_SIMPLE_DOUGHNUT"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("DRAW_SIMPLE_RADAR"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if(l.DrawType==Tn.DRAW_KLINE)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),u.Config=l.Config,h.Draw=u,n.push(h);else{var c=vn.Get(l.DrawType);c&&c.KLineFittingCallback&&c.KLineFittingCallback(s,h,{Date:i,Time:r,HQChart:e},this)&&n.push(h)}}}return n},this.GetKLineData=function(t,e){if(t&&Array.isArray(t)){if(this.HQDataType==Sn.MINUTE_ID||this.HQDataType==Sn.MULTIDAY_MINUTE_ID)var a=e.SourceData;else a=e.ChartPaint[0].Data;for(var i in t){var r=t[i];if(sa.IsString(r.Value)&&(sa.IsNumber(r.Index)&&!(r.Index<0||r.Index>=a.Data.length))){var n=r.Value.toUpperCase(),o=a.Data[r.Index];switch(n){case"HIGH":case"H":r.Value=o.High;break;case"L":case"LOW":r.Value=o.Low;break;case"C":case"CLOSE":r.Value=o.Close;break}}}}},this.FittingKLineBG=function(t,e){var a=e.ChartPaint[0].Data,i=[];if(dt.IsDayPeriod(e.Period,!0)){for(var r=!1,n=0,o=0;n<a.Data.length;){i[n]=0;var s=a.Data[n];if(o>=t.length)++n;else{var h=t[o];h.Date<s.Date?++o:(h.Date>s.Date||(r=!0,i[n]=1,++o),++n)}}if(r)return i}else if(dt.IsMinutePeriod(e.Period,!0)){for(r=!1,n=0,o=0;n<a.Data.length;){i[n]=0;s=a.Data[n];if(o>=t.length)++n;else{h=t[o];h.Date<s.Date||h.Date==s.Date&&h.Time<s.Time?++o:(h.Date>s.Date||h.Date==s.Date&&h.Time>s.Time||(r=!0,i[n]=1,++o),++n)}}if(r)return i}return null},this.FittingKLineBG_V2=function(t,e){var a=e.ChartPaint[0].Data,i=[];if(dt.IsDayPeriod(e.Period,!0)){for(var r=!1,n=0,o=0;n<a.Data.length;++n){i[n]=0;var s=a.Data[n],h=s.Date;for(o=0;o<t.length;++o){var l=t[o];if(h>=l.Start.Date&&h<=l.End.Date){i[n]=1,r=!0;break}}}if(r)return i}else if(dt.IsMinutePeriod(e.Period,!0)){var u=[];for(n=0;n<t.length;++n){var C=t[n],D=1e4*C.Start.Date;sa.IsNumber(C.Start.Time)&&(D+=C.Start.Time);var f=1e4*C.End.Date;sa.IsNumber(C.End.Time)&&(f+=C.End.Time),u.push({Start:D,End:f})}for(r=!1,n=0,o=0;n<a.Data.length;++n){i[n]=0;s=a.Data[n],h=1e4*s.Date+s.Time;for(o=0;o<u.length;++o){l=u[o];if(h>=l.Start&&h<=l.End){i[n]=1,r=!0;break}}}if(r)return i}return null},this.FittingMinuteData=function(t,e){for(var a=t.outvar,i=t.date,r=t.time,n=[],o=0;o<a.length;++o){var s=a[o],h={Name:s.name,Type:s.type};if(sa.IsBool(s.IsShowTitle)&&(h.IsShowTitle=s.IsShowTitle),s.data)h.Data=this.FittingMinuteArray(s.data,i,r,e),s.color&&(h.Color=s.color),s.linewidth&&(h.LineWidth=s.linewidth),0==s.isshow&&(h.IsShow=!1),1==s.isexdata&&(h.IsExData=!0),s.BreakPoint&&(h.BreakPoint=s.BreakPoint),s.UpColor&&(h.UpColor=s.UpColor),s.DownColor&&(h.DownColor=s.DownColor),sa.IsBool(s.isDotLine)&&(h.IsDotLine=s.isDotLine),sa.IsNonEmptyArray(s.lineDash)&&(h.LineDash=s.lineDash),sa.IsBool(s.isSingleLine)&&(h.IsSingleLine=s.isSingleLine),sa.IsNonEmptyArray(s.AryBreakPoint)&&(h.AryBreakPoint=s.AryBreakPoint),n.push(h);else if(s.Draw){var l=s.Draw,u={};if("DRAWICON"==l.DrawType)u.Icon=l.Icon,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("DRAWTEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("STICKLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.Width=l.Width,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if(l.DrawType==Tn.OVERLAY_BARS)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.BarName=l.BarName,u.BarColor=l.BarColor,u.LineWidth=l.LineWidth,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if(l.DrawType==Tn.CLIP_COLOR_STICK)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.Data,i,r,e),h.Draw=u,l.Option&&(h.Option=l.Option),n.push(h);else if("MULTI_LINE"==l.DrawType){for(var C in u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),u.DrawData)this.GetKLineData(u.DrawData[C].Point,e);h.Draw=u,l.LineDash&&(u.LineDash=l.LineDash),l.Arrow&&(u.Arrow=l.Arrow),n.push(h)}else if("MULTI_POINT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("MULTI_TEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("MULTI_SVGICON"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={Icon:l.DrawData.Icon,Family:l.DrawData.Family},h.Draw=u,n.push(h);else if("DRAWSVG"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,l.AutoPosition&&(u.AutoPosition=l.AutoPosition),u.EnalbeDetailNoOverlap=l.EnalbeDetailNoOverlap,u.EnableClick=l.EnableClick,l.BuildKeyCallback&&(u.BuildKeyCallback=l.BuildKeyCallback),u.DrawData={Data:l.Data,Family:l.Family,TextFont:l.TextFont,EnableTooltip:l.EnableTooltip,IsDrawFirst:l.IsDrawFirst},h.Draw=u,n.push(h);else if("MULTI_HTMLDOM"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.Callback=l.Callback,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h);else if("MULTI_BAR"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else if("DRAWCOLORKLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,l.Color&&(u.Color=l.Color),sa.IsBool(l.IsEmptyBar)&&(u.IsEmptyBar=l.IsEmptyBar),n.push(h);else if("DRAWTEXT_LINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,l.Font&&(h.Font=l.Font),n.push(h);else if("DRAWTITLE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=l.DrawData,h.Draw=u,n.push(h);else{var D=vn.Get(l.DrawType);D&&D.MinuteFittingCallback&&D.MinuteFittingCallback(s,h,{Date:i,Time:r,HQChart:e},this)&&n.push(h)}}}return n},this.FittingMinuteArray=function(t,e,a,i,r){var n,o=i.SourceData,s=[];for(var h in t){var l=t[h],u=new Dt;u.Date=e[h],a&&h<a.length&&(u.Time=a[h]),u.Value=l,s.push(u)}n=5==r?o.GetMinuteFittingDataV2(s):o.GetMinuteFittingData(s);var C=new dt;C.Data=n;var D=C.GetValue();return D},this.FittingMultiPointLine=function(t,e){var a=e.Period,i=t.Data,r=[];if(dt.IsDayPeriod(a,!0)){var n=i[0],o=e.ChartPaint[0].Data,s=o.Data[0],h=0,l=0;if(n.Date>s.Date){var u=0;for(h=0;h<o.Data.length;++h){var C=o.Data[h];if(C.Date==n.Date)break;if(C.Date>n.Date){h=u;break}u=h}}else for(l=0;l<i.length;++l){var D=i[l];if(D.Date>=s.Date)break}for(var f=null,c=h,m=l;c<o.Data.length&&m<i.length;){C=o.Data[c],D=i[m];D.Date<=C.Date?(r[c]||(r[c]=[]),r[c].push({Date:D.Date,Value:D.Value,Data:D.Data,KDate:C.Date,Type:1}),f=D,++m):(f&&!r[c]&&(r[c]={Date:f.Date,Value:f.Value,Type:0}),++c)}if(f)for(;c<o.Data.length;++c)r[c]||(r[c]={Date:f.Date,Value:f.Value,Type:0});return r}if(dt.IsMinutePeriod(a,!0)){o=e.ChartPaint[0].Data;return r}}}function Fn(t,e,a){this.newMethod=pn,this.newMethod(t,null,e,null),delete this.newMethod,this.JsonData,a.JsonData&&(this.JsonData=a.JsonData),this.RequestData=function(t,e,a){if(!this.JsonData)return console.warn("[LocalJsonDataIndex::RequestData] JsonData is null"),void(param.HQChart.ScriptErrorCallback&&param.HQChart.ScriptErrorCallback("json 数据不能为空"));this.OutVar=this.FittingData(this.JsonData,a),this.BindData(t,e,a)},this.FittingData=function(t,e){for(i in outVar=t.OutVar,date=t.Date,time=t.Time,result=[],outVar)if(item=outVar[i],u.Complier.Log("[LocalJsonDataIndex::FittingData] item",item),0==item.Type||3==item.Type){var a=[];for(j in outVarItem={Name:item.Name,Type:item.Type},item.Data){var r=new Dt;r.Date=date[j],time&&j<time.length&&(r.Time=time[j]),r.Value=item.Data[j],a.push(r)}if(e.Period<4)var n=e.GetFittingData(a);else n=e.GetMinuteFittingData(a);var o=new dt;o.Data=n,outVarItem.Data=o.GetValue(),result.push(outVarItem)}else console.warn("[LocalJsonDataIndex::FittingData] can't support ",item.Name,item.Type);return result}}function En(t){this.ID,this.Name,this.Script,this.Arguments=[],this.ClassName="ScriptIndexConsole",this.ErrorCallback,this.FinishCallback,this.IsSectionMode=!1,this.NetworkFilter,this.IsApiPeriod=!1,t&&(t.Name&&(this.Name=t.Name),t.Script&&(this.Script=t.Script),t.ID&&(this.ID=t.ID),t.Args&&(this.Arguments=t.Args),t.ErrorCallback&&(this.ErrorCallback=t.ErrorCallback),t.FinishCallback&&(this.FinishCallback=t.FinishCallback),t.IsSectionMode&&(this.IsSectionMode=t.IsSectionMode),t.NetworkFilter&&(this.NetworkFilter=t.NetworkFilter),sa.IsBool(t.IsApiPeriod)&&(this.IsApiPeriod=t.IsApiPeriod)),this.ExecuteScript=function(t){this.OutVar=[];var e={Self:this},a={HQDataType:t.HQDataType,Symbol:t.Stock.Symbol,Name:t.Stock.Name,Period:t.Period,Right:t.Right,Callback:this.RecvResultData,CallbackParam:e,Async:!0,MaxRequestDataCount:t.Request.MaxDataCount,MaxRequestMinuteDayCount:t.Request.MaxMinuteDayCount,Arguments:this.Arguments,IsSectionMode:this.IsSectionMode,ClassName:"ScriptIndexConsole",NetworkFilter:this.NetworkFilter,IsApiPeriod:this.IsApiPeriod,Self:this};t.HQDataType===Sn.HISTORY_MINUTE_ID&&(a.TrateDate=t.Request.TradeDate),t.HQDataType==Sn.MULTIDAY_MINUTE_ID&&(a.DayCount=t.DayCount),t.Data&&(a.Data=t.Data);var i=this.Script;In.Execute(i,a,this.ErrorCallback)},this.RecvResultData=function(t,e){var a=e.Self,i=e.JSExecute,r=null;i.SymbolData.Data&&(r=i.SymbolData.Data.GetDate());var n={Out:t,Date:r,Stock:{Name:i.SymbolData.Name,Symbol:i.SymbolData.Symbol},Index:{Name:a.Name,ID:a.ID}};(i.SymbolData.DataType==Sn.MULTIDAY_MINUTE_ID||i.SymbolData.DataType==Sn.MINUTE_ID||i.SymbolData.DataType==Sn.KLINE_ID&&dt.IsMinutePeriod(i.SymbolData.Period,!0))&&(n.Time=i.SymbolData.Data.GetTime()),a.FinishCallback&&a.FinishCallback(n,e.JSExecute)}}function Ln(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case 1:case 7:case"EXCHANGE":case"HSL":this.DownloadHistoryData(t);break;case 3:this.GetSymbolType(t);break;case 9:case 18:case 30:case 32:case 33:case 34:case 38:case 40:case 41:case 42:case 43:case"CAPITAL":case"TOTALCAPITAL":case 100:this.DownloadRealtimeData(t);break;default:this.DownloadRealtimeData(t);break}},this.GetSymbolType=function(t){var e=1;Pr.IsSHSZIndex(this.Symbol)&&(e=0);var a={Date:null,Value:e};this.RecvCallback(a,this.Job,this.DataKey)},this.DownloadRealtimeData=function(t){var e=this,a=this.GetFieldList();if(!a)return this.Job.FunctionName2?message="".concat(this.Job.FunctionName2," can't support."):this.Job.FunctionName?message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."):message="".concat(this.Args[0]," can't support."),this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);io.HttpRequest({url:this.RealtimeUrl,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:10},type:"post",dataType:"json",async:!0,success:function(t){var a=e.RealtimeDataToHQChartData(t);e.RecvCallback(a,e.Job,e.DataKey)}})},this.DownloadHistoryData=function(t){var e=this,a=this.GetFieldList();if(!a)return message="".concat(this.Job.FunctionName,"(").concat(this.Args[0],") can't support."),this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);io.HttpRequest({url:this.Url,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:200},type:"post",dataType:"json",async:!0,success:function(t){var a=e.ToHQChartData(t);a&&a.sort((function(t,e){return t.Date-e.Date})),e.RecvCallback(a,e.Job,e.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["capital.total","capital.date"];case 7:return["capital.a","capital.date"];case"HSL":case"EXCHANGE":return["capital.a","capital.date"];case 9:return["finance.peruprofit","symbol","date"];case 18:return["finance.percreserve","symbol","date"];case 30:return["finance.nprofit","symbol","date"];case 32:return["finance.peruprofit","symbol","date"];case 33:return["finance.persearning","symbol","date"];case 34:return["finance.pernetasset","symbol","date"];case 38:return["finance.persearning","symbol","date"];case 40:return["capital.a","capital.date","symbol","date","price"];case 41:return["capital.total","capital.date","symbol","date","price"];case"CAPITAL":return["capital.a","capital.date","symbol","date"];case"TOTALCAPITAL":return["capital.total","capital.date","symbol","date"];case 42:return["company.releasedate","symbol","date"];case 43:return["dividendyield","symbol","date"];case 100:return["shareholder","symbol","date"];default:return null}},this.RealtimeDataToHQChartData=function(t,e){if(!t.stock||1!=t.stock.length)return null;var a=t.stock[0],i=(e=this.Args[0],a.date);switch(e){case 9:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 18:return a.finance?{Date:i,Value:a.finance.percreserve}:null;case 30:return a.finance?{Date:i,Value:a.finance.nprofit}:null;case 32:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 33:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 34:return a.finance?{Date:i,Value:a.finance.pernetasset}:null;case 38:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 40:return a.capital?{Date:i,Value:a.capital.a*a.price}:null;case 41:return a.capital?{Date:i,Value:a.capital.total*a.price}:null;case 42:if(!a.company)return null;var r=a.company.releasedate,n=parseInt(r/1e4),o=parseInt(r%1e4/100),s=r%100,h=new Date(n,o-1,s),l=new Date,u=parseInt((l.getTime()-h.getTime())/864e5);return{Date:i,Value:u+1};case 43:return a.dividendyield?{Date:i,Value:a.dividendyield.quarter4}:null;case 100:return a.shareholder?{Date:i,Value:a.shareholder.count}:null;case"CAPITAL":return a.capital?{Date:i,Value:a.capital.a/100}:null;case"TOTALCAPITAL":return a.capital?{Date:i,Value:a.capital.total/100}:null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new Set,i=t.stock[0],r=this.Args[0];for(var n in i.stockday){var o=i.stockday[n],s=this.ToHQChartItemData(o,r);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}return e},this.ToHQChartItemData=function(t,e){if(!t)return null;var a=t.date;switch(e){case 1:return t.capital?{Date:a,Value:t.capital.total}:null;case 7:case"HSL":case"EXCHANGE":return t.capital?{Date:a,Value:t.capital.a}:null;default:return null}}}function Mn(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case"HYBLOCK":case"DYBLOCK":case"GNBLOCK":this.DownloadGroupName(t);break}},this.DownloadGroupName=function(t){var e=this,a=["name","symbol"];"HYBLOCK"==t?a.push("industry"):"DYBLOCK"==t?a.push("region"):"GNBLOCK"==t&&a.push("concept"),io.HttpRequest({url:e.RealtimeUrl,data:{field:a,symbol:[this.Symbol]},type:"post",dataType:"json",async:!0,success:function(t){var a=e.RecvGroupName(t);e.RecvCallback(a,e.Job,e.DataKey,1)},error:function(t){e.ErrorCallback(t)}})},this.RecvGroupName=function(t){if(!t.stock||1!=t.stock.length)return null;var e=t.stock[0],a=this.Args[0],i=null;if("HYBLOCK"==a){var r=e.industry;if(!r)return null;for(var n in r){var o=r[n];i=o.name}}else if("DYBLOCK"==a){var s=e.region;if(!s)return null;for(var n in s){o=s[n];i=o.name}}else if("GNBLOCK"==a){var h=e.concept;if(!h)return null;for(var n in i="",h){o=h[n];i.length>0&&(i+=" "),i+=o.name}}return{Value:i}}}En.SetDomain=function(t,e){In.SetDomain(t,e)},In.AddVariant({Name:"DHIGH",Description:"不定周期最高价"}),In.AddVariant({Name:"DOPEN",Description:"不定周期开盘价"}),In.AddVariant({Name:"DLOW",Description:"不定周期最低价"}),In.AddVariant({Name:"DCLOSE",Description:"不定周期收盘价"}),In.AddVariant({Name:"DVOL",Description:"不定周期成交量价"});var yn={BLACK_ID:1,WHITE_ID:0};function Rn(){}function Nn(t){this.DivElement=t,this.JSChartContainer,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jsdeallist-drawing",this.CanvasElement.id=N(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&u.Chart.Log("[JSDealChart::JSDealList] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OnSize=function(){var t=parseInt(this.DivElement.style.height.replace("px",""));this.CanvasElement.height=t,this.CanvasElement.width=parseInt(this.DivElement.style.width.replace("px","")),this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var e=F();this.CanvasElement.height*=e,this.CanvasElement.width*=e,u.Chart.Log("[JSDealChart::OnSize] devicePixelRatio=".concat(window.devicePixelRatio,", height=").concat(this.CanvasElement.height,", width=").concat(this.CanvasElement.width)),this.JSChartContainer&&this.JSChartContainer.OnSize&&this.JSChartContainer.OnSize()},this.SetOption=function(t){var e=this.CreateJSDealChartContainer(t);if(!e)return!1;if(t.OnCreatedCallback&&t.OnCreatedCallback(e),this.JSChartContainer=e,this.DivElement.JSChart=this,t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}t.MinuteChartTooltip&&t.MinuteChartTooltip.Enable&&e.InitalMinuteChartTooltip(t.MinuteChartTooltip),t.Symbol?e.ChangeSymbol(t.Symbol):e.Draw()},this.CreateJSDealChartContainer=function(t){var e=new wn(this.CanvasElement);if(e.Create(t),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),sa.IsNonEmptyArray(t.Column)&&e.SetColumn(t.Column),sa.IsNumber(t.ShowOrder)&&(e.ChartPaint[0].ShowOrder=t.ShowOrder),this.SetChartBorder(e,t),null!=t.IsAutoUpdate&&(e.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),sa.IsBool(t.EnableFilter)&&(e.EnableFilter=t.EnableFilter),t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}return e},this.SetChartBorder=function(t,e){if(e.Border){e.Border;sa.IsNumber(e.Border.Left)&&(t.Frame.ChartBorder.Left=e.Border.Left),sa.IsNumber(e.Border.Right)&&(t.Frame.ChartBorder.Right=e.Border.Right),sa.IsNumber(e.Border.Top)&&(t.Frame.ChartBorder.Top=e.Border.Top),sa.IsNumber(e.Border.Bottom)&&(t.Frame.ChartBorder.Bottom=e.Border.Bottom);var a=F();t.Frame.ChartBorder.Left*=a,t.Frame.ChartBorder.Right*=a,t.Frame.ChartBorder.Top*=a,t.Frame.ChartBorder.Bottom*=a}},this.ChangeSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t,e)},this.SetColumn=function(t,e){this.JSChartContainer&&this.JSChartContainer.SetColumn(t,e)},this.EnableFilter=function(t,e){this.JSChartContainer&&this.JSChartContainer.EnableFilter(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(u.Chart.Log("[JSDealChart:AddEventCallback] obj=",t),this.JSChartContainer.AddEventCallback(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(u.Chart.Log("[JSDealChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.ChartDestroy=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestroy&&this.JSChartContainer.ChartDestroy()}}function wn(t){this.ClassName="JSDealChartContainer",this.Frame,this.ChartPaint=[],this.ChartSplashPaint=null,this.LoadDataSplashTitle="数据加载中",this.Canvas=t.getContext("2d"),this.ShowCanvas=null,this.Symbol,this.Name,this.TradeDate,this.NetworkFilter,this.Data={DataOffset:0,Data:[]},this.SourceData={DataOffset:0,Data:[]},this.IsShowLastPage=!0,this.mapEvent=new Map,this.AutoUpdateTimer=null,this.AutoUpdateFrequency=15e3,this.LoadDataSplashTitle="数据加载中",this.TooltipMinuteChart,this.UIElement=t,this.LastPoint=new V,this.LastMouseStatus={MoveStatus:null,TooltipStatus:null,MouseOnStatus:null},this.IsDestroy=!1,this.ChartDestroy=function(){this.IsDestroy=!0,this.StopAutoUpdate()},this.EnableFilterData=!1,this.InitalMinuteChartTooltip=function(t){this.TooltipMinuteChart||(this.TooltipMinuteChart=new JSTooltipMinuteChart,this.TooltipMinuteChart.Inital(this,t),this.TooltipMinuteChart.Create())},this.DestroyMinuteChartTooltip=function(){this.TooltipMinuteChart&&(this.TooltipMinuteChart.Destroy(),this.TooltipMinuteChart=null)},this.ShowMinuteChartTooltip=function(t,e,a){if(this.TooltipMinuteChart){var i=this.UIElement.getBoundingClientRect(),r=w(),n=i.left+r.Left,o=i.top+r.Top;a.Offset={Left:n,Top:o},this.TooltipMinuteChart.Show(a,t,e)}},this.HideMinuteChartTooltip=function(){this.TooltipMinuteChart&&this.TooltipMinuteChart.Hide()},this.HideAllTooltip=function(){this.HideMinuteChartTooltip()},this.FilterData=function(t){if(!this.EnableFilterData)return t;var e=this.GetEventCallback(m.ON_FILTER_DEAL_DATA);if(!e||!e.Callback)return t;var a={Data:t,Result:[]};return e.Callback(e,a,this),a.Result},this.EnableFilter=function(t,e){this.EnableFilterData=t,this.Data.Data=this.FilterData(this.SourceData.Data),this.Data.DataOffset=0,e&&(1==e.GotoLastPage&&this.GotoLastPage(),1==e.Redraw&&this.Draw())},this.CloneArray=function(t){var e=[];if(!sa.IsNonEmptyArray(t))return e;for(var a=0;a<t.length;++a)e.push(t[a]);return e},this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.Frame=new An,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame;var a=new Bn;a.Frame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.UIElement=this.UIElement,a.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartPaint[0]=a,t&&(sa.IsBool(t.IsSingleTable)&&(a.IsSingleTable=t.IsSingleTable),sa.IsBool(t.IsShowHeader)&&(a.IsShowHeader=t.IsShowHeader),sa.IsBool(t.IsShowLastPage)&&(this.IsShowLastPage=t.IsShowLastPage),sa.IsNumber(t.BorderLine)&&(this.Frame.BorderLine=t.BorderLine));var i=!0,r=!0;t&&(!1===t.KeyDown&&(i=!1,u.Chart.Log("[JSDealChartContainer::Create] not register keydown event.")),!1===t.Wheel&&(r=!1,u.Chart.Log("[JSDealChartContainer::Create] not register wheel event.")),sa.IsBool(t.EnableSelected)&&(a.SelectedData.Enable=t.EnableSelected)),i&&this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),r&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0),this.UIElement.onmousedown=function(t){e.UIOnMouseDown(t)},this.UIElement.ondblclick=function(t){e.UIOnDblClick(t)},this.UIElement.oncontextmenu=function(t){e.UIOnContextMenu(t)},this.UIElement.onmousemove=function(t){e.UIOnMouseMove(t)}},this.Draw=function(){if(!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var t=F();if(this.Canvas.lineWidth=t,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw();this.Frame.Draw(),this.Frame.DrawLogo();for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.IsDrawFirst&&a.Draw()}for(e=0;e<this.ChartPaint.length;++e){a=this.ChartPaint[e];a.IsDrawFirst||a.Draw()}}},this.ChangeSymbol=function(t,e){this.Symbol=t,this.Data=null,this.SourceData=null;var a=this.ChartPaint[0];a&&(a.Data=null),e&&sa.IsNumber(e.TradeDate)&&(this.TradeDate=e.TradeDate),this.Symbol?this.RequestDealData():this.Draw()},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.AutoUpdateEvent=function(t,e){var a=t?m.RECV_START_AUTOUPDATE:m.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,DayCount:this.DayCount},Explain:e};t&&(n.Callback=function(t){i.RecvDealUpdateData(t)}),r.Callback(r,n,this)}},this.RequestDealData=function(){this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw();var t=this;if(this.NetworkFilter){var e={Name:"JSDealChartContainer::RequestDealData",Explain:"成交明细",Request:{Data:{symbol:t.Symbol,tradeDate:t.TradeDate}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDealData(e),t.AutoUpdateEvent(!0,"JSDealChartContainer::RequestDealData"),t.AutoUpdate()})),1==e.PreventDefault)return}var a="".concat(qi.CacheDomain,"/cache/dealday/today/").concat(this.Symbol,".json");io.HttpRequest({url:a,type:"get",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDealData(e),t.AutoUpdate(1)},error:function(e,a){t.ChartSplashPaint.EnableSplash(!1),t.AutoUpdate()}})},this.RecvDealData=function(t){var e=wn.JsonDataToDealData(t);this.SourceData={DataOffset:0,Data:e},this.Data={DataOffset:0,Data:this.FilterData(this.CloneArray(e))},this.Symbol=t.symbol,this.Name=t.name;var a=this.ChartPaint[0];a.Data=this.Data,a.Symbol=this.Symbol,a.YClose=t.yclose,a.Open=t.open,this.IsShowLastPage&&this.SetLastPageDataOffset(),this.Draw()},this.SetLastPageDataOffset=function(){var t=this.ChartPaint[0],e=0;sa.IsNonEmptyArray(this.SourceData.Data)&&(e=this.SourceData.Data.length);var a=t.GetPageSize(!0),i=e-a;i<0&&(i=0),this.Data.DataOffset=i},this.RequestDealUpdateData=function(){var t=this;if(this.NetworkFilter){var e={Name:"JSDealChartContainer::RequestDealUpdateData",Explain:"增量成交明细",Request:{Data:{symbol:t.Symbol}},Self:this,PreventDefault:!1};if(this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var a=this.Data.Data[this.Data.Data.length-1];e.LastItem=a}if(this.NetworkFilter(e,(function(e){t.RecvDealUpdateData(e),t.AutoUpdate()})),1==e.PreventDefault)return}},this.RecvDealUpdateData=function(t){var e=wn.JsonDataToDealData(t);sa.IsNonEmptyArray(e)&&(1===t.UpdateType?(this.SourceData.Data=e,this.Data.Data=this.FilterData(this.CloneArray(e)),this.Data.DataOffset>=this.Data.Data.length&&(this.Data.DataOffset=0),this.IsShowLastPage&&this.SetLastPageDataOffset()):(this.AddDealData(this.SourceData,e),this.AddDealData(this.Data,this.FilterData(e))),this.Draw())},this.AddDealData=function(t,e){if(t.Data){var a=0,i=this.ChartPaint[0];i&&(a=i.GetPageSize());for(var r=0;r<e.length;++r)t.Data.push(e[r]),t.DataOffset+a<t.Data.length&&++t.DataOffset}else t.Data=e},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var e=this,a=Pr.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),i):2==a&&(this.AutoUpdateTimer=setTimeout((function(){e.RequestDealUpdateData()}),i))}}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"JSDealChartContainer::StopAutoUpdate"),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.OnSize=function(){if(this.Frame){this.SetSizeChange(!0);var t=this.ChartPaint[0];if(t&&this.Data&&this.Data.DataOffset>0&&sa.IsNonEmptyArray(this.Data.Data)){var e=t.GetPageSize(!0);e+this.Data.DataOffset>=this.Data.Data.length&&this.GotoLastPage()}this.Draw()}},this.SetSizeChange=function(t){var e=this.ChartPaint[0];e&&(e.SizeChange=t)},this.OnWheel=function(t){if(u.Chart.Log("[JSDealChartContainer::OnWheel]",t),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var e,a=t.clientX-this.UIElement.getBoundingClientRect().left,i=t.clientY-this.UIElement.getBoundingClientRect().top;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),e=this.Canvas.isPointInPath(a,i),e){var r=this.ChartPaint[0];if(r){var n=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(n=-.01*t.deltaY),n<0?(this.HideAllTooltip(),this.GotoNextPage()&&this.Draw()):n>0&&(this.HideAllTooltip(),this.GotoPreviousPage()&&this.Draw()),t.preventDefault?t.preventDefault():t.returnValue=!1}}}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=t.keyCode?t.keyCode:t.which;switch(e){case 38:this.HideAllTooltip(),this.GotoPreviousPage()&&this.Draw();break;case 40:this.HideAllTooltip(),this.GotoNextPage()&&this.Draw();break}t.preventDefault?t.preventDefault():t.returnValue=!1}},this.GetReportChart=function(){var t=this.ChartPaint[0];return t},this.UIOnMouseDown=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=this.ChartPaint[0];if(r){var n=r.OnMouseDown(a,i,t);n&&(1!=n.Type||0!=t.button&&2!=t.button||1==n.Redraw&&this.Draw())}},this.UIOnMouseMove=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;this.LastMouseStatus.MouseOnStatus;this.LastMouseStatus.OnMouseMove=null;this.LastMouseStatus.TooltipStatus,this.LastMouseStatus.TooltipStatus=null;var r=!1,n=null;this.LastMouseStatus.OnMouseMove={X:a,Y:i};var o={Cursor:"default",Name:"Default"},s=this.GetReportChart();if(s){var h=s.GetTooltipData(a,i);h&&20==h.Type&&h.Data&&h.Data.Symbol&&(r=!0,n={Symbol:h.Data.Symbol,Rect:h.Rect})}o&&(this.UIElement.style.cursor=o.Cursor),r||this.HideMinuteChartTooltip(),r&&this.ShowMinuteChartTooltip(null,null,n)},this.UIOnDblClick=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=this.ChartPaint[0];r&&r.OnDblClick(a,i,t)},this.UIOnContextMenu=function(t){t.preventDefault()},this.GotoNextPage=function(){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var t=this.ChartPaint[0];if(!t)return!1;var e=t.GetPageSize();if(e>this.Data.Data.length)return!1;var a=this.Data.DataOffset+e;return a+e!=this.Data.Data.length-1&&(a+e>this.Data.Data.length?this.Data.DataOffset=this.Data.Data.length-e:this.Data.DataOffset=a,!0)},this.GotoPreviousPage=function(){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var t=this.ChartPaint[0];if(!t)return!1;if(this.Data.DataOffset<=0)return!1;var e=t.GetPageSize(),a=this.Data.DataOffset;return a-=e,a<0&&(a=0),this.Data.DataOffset=a,!0},this.GotoLastPage=function(){var t=this.ChartPaint[0];if(t){var e=t.GetPageSize(!0),a=this.Data.Data.length-e;a<0&&(a=0),this.Data.DataOffset=a}},this.SetColumn=function(t,e){var a=this.ChartPaint[0];a&&(a.SetColumn(t),a.SizeChange=!0,e&&e.Redraw&&this.Draw())},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}t&&t.Redraw&&(this.SetSizeChange(!0),this.Draw())}}function An(){this.ChartBorder,this.Canvas,this.BorderColor=qi.DealList.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font,this.ReloadResource=function(t){this.BorderColor=qi.DealList.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font},this.Draw=function(t){var e=A(this.ChartBorder.GetLeft()),a=A(this.ChartBorder.GetTop()),i=A(this.ChartBorder.GetRight()),r=A(this.ChartBorder.GetBottom()),n=i-e,o=r-a;sa.IsNumber(this.BorderLine)?(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(i,a)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(e,r),this.Canvas.lineTo(i,r)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(e,r)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(i,a),this.Canvas.lineTo(i,r)),this.Canvas.stroke()):(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(e,a,n,o))},this.DrawLogo=function(){var t=qi.FrameLogo.Text;if(sa.IsString(t)){this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var e=this.ChartBorder.GetLeft()+5,a=this.ChartBorder.GetBottom()-5;this.Canvas.fillText(t,e,a)}}}Rn.GetStyleConfig=function(t){switch(t){case yn.BLACK_ID:return function(){var t={BGColor:"rgb(0,0,0)",TooltipBGColor:"rgb(255, 255, 255)",TooltipAlpha:.92,SelectRectBGColor:"rgba(1,130,212,0.06)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(228,228,228)",EmptyBarBGColor:"rgb(0,0,0)",SplashScreen:{BGColor:"rgba(112,128,144,0.5)",TextColor:"rgb(230,230,230)"},HLCArea:{HighLineColor:"rgb(238,21,21)",LowLineColor:"rgb(25,158,0)",CloseLineColor:"rgb(156,156,156)",LineWidth:2*F(),UpAreaColor:"rgba(238,21,21, 0.3)",DownAreaColor:"rgba(25,158,0, 0.3)"},Minute:{VolBarColor:null,PriceColor:"rgb(25,180,231)",AreaPriceColor:"rgba(63,158,255,.3)",AvPriceColor:"rgb(255,236,0)",PositionColor:"rgb(201, 9, 224)",VolTitleColor:"rgb(190,190,190)",Before:{BGColor:"rgba(105,105,105,0.5)",AvPriceColor:"rgb(248,248,255)",CloseIcon:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"}},After:{BGColor:"rgba(105,105,105,0.5)",AvPriceColor:"rgb(248,248,255)"},NightDay:{NightBGColor:"rgb(22,22,22)",Font:"".concat(12*F(),"px 微软雅黑"),Day:{Color:"rgb(153,153,153)",BGColor:"rgb(51,51,51)",BorderColor:"rgb(51,51,51)",Margin:{Left:5,Top:2,Bottom:2,Right:5}},Night:{Color:"rgb(153,153,153)",BGColor:"rgb(51,51,51)",BorderColor:"rgb(51,51,51)",Margin:{Left:5,Top:2,Bottom:2,Right:5}}},BuySellBar:{BuyColor:"rgb(102, 33, 33)",SellColor:"rgb(20, 63, 31)",Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(220,220,220)"}},PopMinuteChart:{BGColor:"rgba(0,0,0,0.85)",BorderColor:"rgb(230,230,230)",Mark:{LineColor:"rgba(255,215,0,0.6)"}},PopKLineChart:{BGColor:"rgba(0,0,0,0.85)",BorderColor:"rgb(230,230,230)"},DefaultTextColor:"rgb(101,104,112)",DefaultTextFont:14*F()+"px 微软雅黑",TitleFont:13*F()+"px 微软雅黑",IndexTitleColor:"rgb(190, 190 ,190)",IndexTitleBGColor:"rgb(0,0,0)",IndexTitleBorderColor:"rgb(211, 211, 211)",IndexTitleBorderMoveOnColor:"rgb(30,144,255)",UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(190, 190 ,190)",CloseLineColor:"rgb(250,250,250)",IndexTitle:{UpDownArrow:{UpColor:"rgb(238,21,21)",DownColor:"rgb(25,158,0)",UnchangeColor:"rgb(190, 190 ,190)"},NameArrow:{Color:"rgb(190, 190 ,190)",Space:2,Symbol:"▼"}},Title:{TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(190, 190 ,190)",AmountColor:"rgb(190, 190 ,190)",DateTimeColor:"rgb(190, 190 ,190)",SettingColor:"rgb(190, 190 ,190)",NameColor:"rgb(190, 190 ,190)",TurnoverRateColor:"rgb(101,104,112)",PositionColor:"rgb(101,104,112)"},FrameBorderPen:"rgb(47,51,62)",MultiDayBorderPen:"rgba(236,236,236,0.5)",FrameSplitPen:"rgba(236,236,236,0.13)",FrameSplitTextColor:"rgb(220,220,220)",FrameSplitTextFont:12*F()+"px 微软雅黑",FrameTitleBGColor:"rgb(0,0,0)",OverlayIndexTitleBGColor:"rgba(0,0,0,0.7)",Frame:{XBottomOffset:2*F(),PercentageText:{PriceColor:"rgb(220,220,220)",PercentageColor:"rgb(220,220,220)",SplitColor:"rgb(220,220,220)",Font:14*F()+"px 微软雅黑"}},OverlayFrame:{BolderPen:"rgb(130,130,130)",TitleColor:"rgb(181,181,181)",TitleFont:11*F()+"px arial"},FrameLatestPrice:{TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(190,190,190)",BGAlpha:.6,EmptyBGColor:"rgb(0,0,0)"},CorssCursorBGColor:"rgb(43,54,69)",CorssCursorTextColor:"rgb(255,255,255)",CorssCursorTextFont:12*F()+"px 微软雅黑",CorssCursorHPenColor:"rgb(130,130,130)",CorssCursorVPenColor:"rgb(130,130,130)",CorssCursor:{RightButton:{BGColor:"rgb(43,54,69)",PenColor:"rgb(255,255,255)",Icon:{Text:"",Color:"rgb(255,255,255)",Family:"iconfont",Size:12}},CorssPoint:{Center:{Color:"rgb(50,171,205)"},Border:{Color:"rgba(0,0,0,0.8)",Width:1*F()}}},OrderFlow:{UpColor:{BG:"rgb(223,191,180)",Border:"rgb(196,84,86)"},DownColor:{BG:"rgb(176,212,184)",Border:"rgb(66,94,74)"},UnchagneColor:{BG:"rgb(216,221,177)",Border:"rgb(209,172,129)"},Text:{Color:"rgb(248,248,255)",Family:"Arial",FontMaxSize:16,MaxValue:"8888"},Line:{UpDownColor:"rgb(220,220,220)",MiddleColor:"rgb(211,211,211)"}},KLine:{MaxMin:{Font:12*F()+"px 微软雅黑",Color:"rgb(255,250,240)",RightArrow:"→",LeftArrow:"←",HighYOffset:0,LowYOffset:0},Info:{Investor:{ApiUrl:"/API/NewsInteract",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#1c65db"}},Announcement:{ApiUrl:"/API/ReportList",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#f5a521"},IconFont2:{Family:"iconfont",Text:"",HScreenText:"",Color:"#ed7520"}},Pforecast:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#986cad"}},Research:{ApiUrl:"/API/InvestorRelationsList",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#19b1b7"}},BlockTrading:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#f39f7c"}},TradeDetail:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"",HScreenText:"",Color:"#b22626"}}},NumIcon:{Color:"rgb(251,80,80)",Family:"iconfont",Text:["","","","","","","","","","","","","","","","","","","","",""]},TradeIcon:{Family:"iconfont",Buy:{Color:"rgb(255,15,4)",Text:"",HScreenText:""},Sell:{Color:"rgb(64,122,22)",Text:"",HScreenText:""}}},VirtualKLine:{Color:"rgb(119,136,153)",LineDash:[2,2]},PredictionKLine:{Line:{Color:"rgb(220,220,220)",LineDash:[3*F(),3*F()]},Bar:{UpColor:"rgb(30,144,255)",DownColor:"rgb(30,144,255)",UnchangeColor:"rgb(30,144,255)",DrawType:3}},PriceGapStyple:{Line:{Color:"rgb(128,128,128)"},Text:{Color:"rgb(219,220,220)",Font:"".concat(12*F(),"px 微软雅黑")}},DaySummaryKLine:{TextColor:"rgb(255,165,0)"},IndexLock:{BGColor:"rgb(105,105,105)",TextColor:"rgb(255,0,0)"},Index:{LineColor:["rgb(255,189,09)","rgb(22,198,255)","rgb(174,35,161)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],NotSupport:{Font:"".concat(14*F(),"px 微软雅黑"),TextColor:"rgb(250,250,250)"}},ColorArray:["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],Buttons:{CloseOverlayIndex:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},CloseWindow:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},ChangeIndex:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},OverlayIndex:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},ModifyIndexParam:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},MaxMinWindow:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},TitleWindow:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},ExportData:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},AddIndexWindow:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},Tooltip:{Color:"rgb(204,204,204)",ColorBG:"rgb(32,32,32)",ColorBorder:"rgb(69,69,69)"}},DrawPicture:{LineColor:["rgb(41,98,255)"],PointColor:["rgb(41,98,255)","rgb(89,135,255)","rgb(0,0,0)"]},TooltipPaint:{BGColor:"rgba(20,20,20,0.8)",BorderColor:"rgb(210,210,210)",TitleColor:"rgb(210,210,210)",TitleFont:13*F()+"px 微软雅黑",DateTimeColor:"rgb(210,210,210)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(210,210,210)",PositionColor:"rgb(255,215,0)"},PCTooltipPaint:{BGColor:"rgba(20,20,20,0.8)",BorderColor:"rgb(210,210,210)",TitleColor:"rgb(210,210,210)",TitleFont:12*F()+"px 微软雅黑",DateTimeColor:"rgb(210,210,210)",VolColor:"rgb(161,154,3)",AmountColor:"rgb(161,154,3)"},DialogTooltip:{BGColor:"rgb(20,20,20)",BorderColor:"rgb(170,170,170)",TitleColor:"rgb(250,250,250)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(210,210,210)",DateTimeColor:"rgb(210,210,210)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(255,0,255)",TextColor:"rgb(210,210,210)",ValueColor:"rgb(210,210,210)",TitleBGColor:"rgb(200, 66, 69)"},FloatTooltip:{BGColor:"rgb(20,20,20)",BorderColor:"rgb(170,170,170)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(210,210,210)",DateTimeColor:"rgb(210,210,210)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(255,0,255)",TextColor:"rgb(210,210,210)",ValueColor:"rgb(210,210,210)"},DialogSelectRect:{BGColor:"rgb(20,20,20)",BorderColor:"rgb(170,170,170)",TitleColor:"rgb(210,210,210)",VolColor:"rgb(255, 185, 15)",AmountColor:"rgb(210,210,210)",TextColor:"rgb(210,210,210)",ValueColor:"rgb(210,210,210)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(255,0,255)"},DialogSearchIndex:{BGColor:"rgb(20,20,20)",BorderColor:"rgb(170,170,170)",TitleColor:"rgb(230,230,230)",IndexNameColor:"rgb(210,210,210)",GroupNameColor:"rgb(210,210,210)",InputTextColor:"rgb(210,210,210)"},DialogPopKeyboard:{BGColor:"rgb(20,20,20)",BorderColor:"rgb(170,170,170)",TitleColor:"rgb(240,240,240)",Input:{BGColor:"rgb(20,20,20)",TextColor:"rgb(250,250,250)"}},MinuteInfo:{TextColor:"rgb(84,143,255)",Font:14*F()+"px 微软雅黑",PointColor:"rgb(38,113,254)",LineColor:"rgb(120,167,255)",TextBGColor:"rgba(255,255,255,1)"},DepthMapPaint:{LineColor:"rgba(255,185,15)",AreaColor:"rgba(255,185,15,0.8)",TextColor:"rgba(255,255,255)",TextBGColor:"rgb(43,54,69)"},KLineYAxisBGPaint:{Font:12*F()+"px 微软雅黑",TextColor:"rgb(255,255,255)",LineColor:"rgb(255,255,255)"},StockChip:{InfoColor:"rgb(255,255,255)",DayInfoColor:"rgb(0,0,0)",PhoneCloseButton:{Family:"iconfont",Size:16*F(),Text:"",Color:"rgb(255,255,255)",Border:{BGColor:"rgb(40,42,44)"}}},DepthChart:{BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.5)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.5)"},LineWidth:4},DepthCorss:{BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(54,54,54, 0.8)",TextColor:"rgb(203,215,224)",Border:{Top:5,Left:20,Bottom:5,Center:5},Font:14*F()+"px 微软雅黑",LineHeight:16}},ChartSimpleTable:{TextColor:"rgb(250,250,250)",BGColor:"rgba(0,0,0,0.85)",BorderColor:"rgb(90,90,90)"},ChartSimplePie:{BorderColor:"rgb(220,220,220)"},ChartSimpleDoughnut:{BorderColor:"rgb(220,220,220)"},ChartSimpleRadar:{BorderColor:"rgb(230, 230, 230)",TextColor:"rgb(250, 250, 250)",AryBGColor:["rgba(63,61,82,0.9)","rgba(56,55,80,0.9)"],AryArea:[{Color:"rgba(242,154,118,0.4)",LineColor:"rgb(242,154,118)"},{Color:"rgba(121,197,228,0.4)",LineColor:"rgb(92,165,196)"}]},ChartDrawVolProfile:{BGColor:"rgba(244,250,254,0.3)",BorderColor:"rgba(255,255,255)",VolLineColor:"rgb(232,5,9)",UpVolColor:"rgba(103,179,238, 0.24)",DownVolColor:"rgba(237,208,105,0.24)",AreaUpColor:"rgb(103,179,238,0.7)",AreaDonwColor:"rgba(237,208,105,0.7)",Text:{Color:"rgb(0,0,0)",Family:"Arial",FontMaxSize:18,FontMinSize:6}},RectSelect:{LineColor:"rgb(115,83,64)",LineWidth:1*F(),LineDotted:[3,3],AreaColor:"rgba(26,13,7,0.5)"},RectDrag:{LineColor:"rgb(220,220,220)",LineWidth:1*F(),BGColor:"rgba(220,220,220,0.2)"},SelectedChart:{LineWidth:1,LineColor:"rgb(55,100,100)",Radius:4,MinSpace:200,BGColor:"rgb(255,255,255)"},DragMovePaint:{TextColor:"rgb(255,255,255)"},SessionBreaksPaint:{BGColor:[null,"rgb(42,46,57)"],SplitLine:{Color:"rgb(73,133,231)",Width:1*F(),Dash:[5*F(),5*F()]}},DealList:{BorderColor:"rgb(38,38,41)",Header:{Color:"RGB(245,245,245)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:12,Name:"微软雅黑"}},Row:{Mergin:{Top:2,Bottom:2},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2}},FieldColor:{Vol:"rgb(192,192,0)",Time:"rgb(245,245,245)",Deal:"rgb(111,128,112)",Index:"rgb(245,245,245)",BarTitle:"rgb(245,245,245)",Text:"rgb(245,245,245)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(228,228,228)",Selected:{BGColor:"rgb(49,48,56)"}},Report:{BorderColor:"rgb(38,38,41)",SelectedColor:"rgb(49,48,56)",SelectedLine:{Color:"rgb(250,250,250)"},Header:{Color:"RGB(245,245,245)",SortColor:"rgb(255,0,0)",Font:{Size:12,Name:"微软雅黑"}},SortIcon:{Color:["rgb(105,105,105)","rgb(255,255,255)","rgb(255,255,255)"]},Item:{Mergin:{Top:2,Bottom:4,Left:5,Right:5},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},FixedItem:{Font:{Size:15,Name:"微软雅黑"}},LimitBorder:{Color:"rgb(64,64,64)",Mergin:{Top:1,Bottom:1,Left:0,Right:0}},FieldColor:{Index:"rgb(245,245,245)",Symbol:"rgb(255,255,255)",Name:"rgb(255,255,255)",Amount:"rgb(2,226,244)",Vol:"rgb(192,192,0)",BarTitle:"rgb(245,245,245)",Text:"rgb(245,245,245)"},NameSymbolV2:{Name:{Size:14,Name:"微软雅黑",Color:"rgb(250,250,250)"},Symbol:{Size:12,Name:"微软雅黑",Color:"rgb(190, 190, 190)"}},CloseLine:{CloseColor:"rgb(30,144,255)",YCloseColor:"rgba(220,220,220,0.5)",AreaColor:"rgba(220,220,220,0.2)"},KLine:{UpColor:"rgb(255,0,0)",DownColor:"rgb(0,128,0)",UnchagneColor:"rgb(240,240,240)",DataWidth:16,DistanceWidth:3},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(228,228,228)",Tab:{Font:{Size:12,Name:"微软雅黑"},ScrollBarWidth:100,ButtonColor:"rgb(13,12,15)",BarColor:"rgb(48,48,48)",BorderColor:"rgb(48,48,48)",TabTitleColor:"rgb(153,153,153)",TabSelectedTitleColor:"rgb(255,255,255)",TabSelectedBGColor:"rgb(234,85,4)",TabMoveOnTitleColor:"rgb(255,255,255)",TabBGColor:"rgb(28,28,31)"},PageInfo:{Font:{Size:15,Name:"微软雅黑"},TextColor:"rgb(255,255,255)",BGColor:"rgba(49,48,56,0.8)",Mergin:{Left:5,Right:5,Top:4,Bottom:2}},DragRow:{Color:"rgba(255,250, 250,0.8)",TextColor:"rgba(0,0, 0, 0.8)",MoveRowColor:"rgb(37,47,69)",SrcRowColor:"rgb(49,48,56)"},VScrollbar:{BarWidth:40,ScrollBarHeight:60,ButtonColor:"rgba(13,12,15,0.8)",BarColor:"rgba(48,48,48,0.9)",BorderColor:"rgba(48,48,48,0.9)",BGColor:"rgba(211,211,211,0.5)"},CheckBox:{Family:"iconfont",Size:15,Checked:{Color:"rgb(69,147,238)",Symbol:"",DisableColor:"rgb(120,120,120)",MouseOnColor:"rgb(69,147,238)"},Unchecked:{Color:"rgb(210,210,210)",Symbol:"",DisableColor:"rgb(120,120,120)",MouseOnColor:"rgb(69,147,238)"}},Link:{Font:"".concat(12*F(),"px 微软雅黑"),TextColor:"rgb(0,144,255)",Disable:{TextColor:"rgb(211,211,211)"},MouseOn:{TextColor:"rgb(0,144,255)"}},ProgressBar:{BGColor:"rgb(20,24,28)",BarColor:"rgb(47,124,197)",Margin:{Left:2,Right:2,Bottom:2,Top:2},BarMargin:{Left:2,Right:2,Bottom:2,Top:2},TextColor:"rgb(230,230,230)",Font:"".concat(12*F(),"px 微软雅黑"),TextMargin:{Left:40,Right:2,Bottom:2,Top:2},Disable:{BGColor:"rgb(61,61,61)",BarColor:"rgb(131,131,131)",TextColor:"rgb(159,161,159)"}}},TReport:{BorderColor:"rgb(38,38,41)",SelectedColor:"rgb(180,180,180)",Header:{Color:"rgb(187,187,187)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:14,Name:"微软雅黑"}},Item:{Mergin:{Top:2,Bottom:0,Left:5,Right:5},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},CenterItem:{TextColor:"rgb(16,226,217)",BaseTextColor:"rgb(60,60,83)",BGColor:"rgb(65,65,65)"},FieldColor:{Index:"rgb(250,250,250)",Symbol:"rgb(60,60,60)",Name:"rgb(250,250,250)",Vol:"rgb(192,165,3)",Position:"rgb(250,250,250)",Amount:"rgb(16,226,217)",Text:"rgb(250,250,250)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchangeTextColor:"rgb(187,187,187)",UpBGColor:"rgb(35,5,5)",DownBGColor:"rgb(5,35,5)",MarkBorder:{MaxPositionColor:"rgb(192,192,0)"}},Keyboard:{BorderColor:"rgb(38,38,41)",SelectedColor:"rgb(49,48,56)",TextColor:"rgb(245,245,245)",Item:{Mergin:{Top:2,Bottom:0,Left:1,Right:1},Font:{Size:15,Name:"微软雅黑"},BarMergin:{Top:2,Left:0,Right:0,Bottom:2},NameFont:{Size:14,Name:"微软雅黑"},SymbolFont:{Size:12,Name:"微软雅黑"}},VScrollbar:{ScrollBarHeight:50,ButtonColor:"rgba(13,12,15,0.8)",BarColor:"rgba(48,48,48,0.9)",BorderColor:"rgba(48,48,48,0.9)",BGColor:"rgba(211,211,211,0.5)",BarWidth:{Size:8}}},ScrollBar:{BorderColor:"rgb(38,38,41)",XSplitTextColor:"rgb(240,240,240)",XSplitLineColor:"rgb(38,38,41)",Slider:{DateFont:"".concat(14*F(),"px 微软雅黑"),DateColor:"rgb(240,240,240)",BarColor:"rgb(105,105,105)",BarAreaColor:"rgba(128,128,128,0.65)"},BGChart:{Color:"rgb(105,113,125)",LineWidth:1,AreaColor:"rgba(24,28,42,0.5)"}},FrameButtomToolbar:{BGColor:"rgb(25,25,25)",BorderColor:"rgb(60,60,60)",Button:{Font:{Family:"微软雅黑"},TitleColor:{Selected:"rgb(255,255,255)",Default:"rgb(140,140,140)",MoveOn:"rgb(255,255,255)"},BGColor:{Selected:"rgb(234,85,4)",Default:"rgb(25,25,25)",MoveOn:"rgb(59,59,59)"},BorderColor:"rgb(60,60,60)"}}};return t}();case yn.WHITE_ID:return new Qi;default:return null}},Nn.Init=function(t){var e=new Nn(t);return e.OnSize(),e},wn.JsonDataToDealData=function(t){t.symbol;var e=[];if(!sa.IsNonEmptyArray(t.detail))return e;for(var a=0;a<t.detail.length;++a){var i=t.detail[a],r={Time:i[0],Price:i[1],Vol:i[2],BS:i[4],Amount:i[3],Guid:N()};r.Source=i,i[5]&&(r.StrTime=i[5]),i[6]&&(r.ID=i[6]),i[11]&&(r.Symbol=i[11]),i[12]&&(r.Name=i[12]),i[100]&&(r.Guid=i[100]),sa.IsNumber(i[101])&&(r.ReserveNumber1=i[101]),sa.IsNumber(i[102])&&(r.ReserveNumber2=i[102]),sa.IsNumber(i[103])&&(r.ReserveNumber3=i[103]),sa.IsNumber(i[104])&&(r.ReserveNumber4=i[104]),sa.IsNumber(i[105])&&(r.ReserveNumber5=i[105]),sa.IsNumber(i[106])&&(r.ReserveNumber6=i[106]),sa.IsNumber(i[107])&&(r.ReserveNumber7=i[107]),sa.IsNumber(i[108])&&(r.ReserveNumber8=i[108]),sa.IsNumber(i[109])&&(r.ReserveNumber9=i[109]),sa.IsNumber(i[110])&&(r.ReserveNumber10=i[110]),(sa.IsString(i[201])||sa.IsObject(i[201]))&&(r.ReserveString1=i[201]),(sa.IsString(i[202])||sa.IsObject(i[202]))&&(r.ReserveString2=i[202]),(sa.IsString(i[203])||sa.IsObject(i[203]))&&(r.ReserveString3=i[203]),(sa.IsString(i[204])||sa.IsObject(i[204]))&&(r.ReserveString4=i[204]),(sa.IsString(i[205])||sa.IsObject(i[205]))&&(r.ReserveString5=i[205]),(sa.IsString(i[206])||sa.IsObject(i[206]))&&(r.ReserveString6=i[206]),(sa.IsString(i[207])||sa.IsObject(i[207]))&&(r.ReserveString7=i[207]),(sa.IsString(i[208])||sa.IsObject(i[208]))&&(r.ReserveString8=i[208]),(sa.IsString(i[209])||sa.IsObject(i[209]))&&(r.ReserveString9=i[209]),(sa.IsString(i[210])||sa.IsObject(i[210]))&&(r.ReserveString10=i[210]),e.push(r)}return e};var On={TIME_ID:0,PRICE_ID:1,VOL_ID:2,DEAL_ID:3,BS_ID:4,UPDOWN_ID:5,STRING_TIME_ID:6,INDEX_ID:7,MULTI_BAR_ID:8,CENTER_BAR_ID:9,CUSTOM_TEXT_ID:10,SYMBOL_ID:11,NAME_ID:12,RESERVE_NUMBER1_ID:201,RESERVE_NUMBER2_ID:202,RESERVE_NUMBER3_ID:203,RESERVE_NUMBER4_ID:204,RESERVE_NUMBER5_ID:205,RESERVE_NUMBER6_ID:206,RESERVE_NUMBER7_ID:207,RESERVE_NUMBER8_ID:208,RESERVE_NUMBER9_ID:209,RESERVE_NUMBER10_ID:210,RESERVE_STRING1_ID:301,RESERVE_STRING2_ID:302,RESERVE_STRING3_ID:303,RESERVE_STRING4_ID:304,RESERVE_STRING5_ID:305,RESERVE_STRING6_ID:306,RESERVE_STRING7_ID:307,RESERVE_STRING8_ID:308,RESERVE_STRING9_ID:309,RESERVE_STRING10_ID:310},bn=new Map([[On.SYMBOL_ID,"Symbol"],[On.NAME_ID,"Name"],[On.PRICE_ID,"Price"],[On.RESERVE_NUMBER1_ID,"ReserveNumber1"],[On.RESERVE_NUMBER2_ID,"ReserveNumber2"],[On.RESERVE_NUMBER3_ID,"ReserveNumber3"],[On.RESERVE_NUMBER4_ID,"ReserveNumber4"],[On.RESERVE_NUMBER5_ID,"ReserveNumber5"],[On.RESERVE_NUMBER6_ID,"ReserveNumber6"],[On.RESERVE_NUMBER7_ID,"ReserveNumber7"],[On.RESERVE_NUMBER8_ID,"ReserveNumber8"],[On.RESERVE_NUMBER9_ID,"ReserveNumber9"],[On.RESERVE_NUMBER10_ID,"ReserveNumber10"],[On.RESERVE_STRING1_ID,"ReserveString1"],[On.RESERVE_STRING2_ID,"ReserveString2"],[On.RESERVE_STRING3_ID,"ReserveString3"],[On.RESERVE_STRING4_ID,"ReserveString4"],[On.RESERVE_STRING5_ID,"ReserveString5"],[On.RESERVE_STRING6_ID,"ReserveString6"],[On.RESERVE_STRING7_ID,"ReserveString7"],[On.RESERVE_STRING8_ID,"ReserveString8"],[On.RESERVE_STRING9_ID,"ReserveString9"],[On.RESERVE_STRING10_ID,"ReserveString10"]]);function Bn(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartDealList",this.IsDrawFirst=!1,this.GetEventCallback,this.Data,this.Symbol,this.YClose,this.Open,this.Decimal=2,this.IsSingleTable=!1,this.IsShowHeader=!0,this.ShowOrder=1,this.SelectedData={Index:null,Guid:null,Enable:!1},this.SizeChange=!0,this.UpColor=qi.DealList.UpTextColor,this.DownColor=qi.DealList.DownTextColor,this.UnchangeColor=qi.DealList.UnchagneTextColor,this.BorderColor=qi.DealList.BorderColor,this.SelectedConfig={BGColor:qi.DealList.Selected.BGColor},this.HeaderFontConfig={Size:qi.DealList.Header.Font.Size,Name:qi.DealList.Header.Font.Name},this.HeaderColor=qi.DealList.Header.Color,this.HeaderMergin={Left:qi.DealList.Header.Mergin.Left,Right:qi.DealList.Header.Mergin.Right,Top:qi.DealList.Header.Mergin.Top,Bottom:qi.DealList.Header.Mergin.Bottom},this.ItemFontConfig={Size:qi.DealList.Row.Font.Size,Name:qi.DealList.Row.Font.Name},this.RowMergin={Top:qi.DealList.Row.Mergin.Top,Bottom:qi.DealList.Row.Mergin.Bottom},this.BarMergin={Top:qi.DealList.Row.BarMergin.Top,Left:qi.DealList.Row.BarMergin.Left,Right:qi.DealList.Row.BarMergin.Right,Bottom:qi.DealList.Row.BarMergin.Bottom},this.HeaderFont=12*F()+"px 微软雅黑",this.ItemFont=15*F()+"px 微软雅黑",this.RowCount=0,this.TableWidth=0,this.TableCount=0,this.HeaderHeight=0,this.Column=[{Type:On.TIME_ID,Title:"时间",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.Time,MaxText:"88:88:88",Foramt:"HH:MM:SS"},{Type:On.PRICE_ID,Title:"价格",TextAlign:"center",Width:null,MaxText:"888888.88"},{Type:On.VOL_ID,Title:"成交",TextAlign:"right",Width:null,TextColor:qi.DealList.FieldColor.Vol,MaxText:"888888"},{Type:On.BS_ID,Title:"",TextAlign:"right",Width:null,MaxText:"擎"}],this.RectClient={},this.AryCellRect=[],this.TooltipRect=[],this.ReloadResource=function(t){this.UpColor=qi.DealList.UpTextColor,this.DownColor=qi.DealList.DownTextColor,this.UnchangeColor=qi.DealList.UnchagneTextColor,this.BorderColor=qi.DealList.BorderColor,this.HeaderFontConfig={Size:qi.DealList.Header.Font.Size,Name:qi.DealList.Header.Font.Name},this.HeaderColor=qi.DealList.Header.Color,this.HeaderMergin={Left:qi.DealList.Header.Mergin.Left,Right:qi.DealList.Header.Mergin.Right,Top:qi.DealList.Header.Mergin.Top,Bottom:qi.DealList.Header.Mergin.Bottom},this.ItemFontConfig={Size:qi.DealList.Row.Font.Size,Name:qi.DealList.Row.Font.Name},this.RowMergin={Top:qi.DealList.Row.Mergin.Top,Bottom:qi.DealList.Row.Mergin.Bottom};for(var e=0;e<this.Column.length;++e){var a=this.Column[e];a.Type==On.TIME_ID||a.Type==On.STRING_TIME_ID?a.TextColor=qi.DealList.FieldColor.Time:a.Type==On.VOL_ID?a.TextColor=qi.DealList.FieldColor.Vol:a.Type==On.DEAL_ID?a.TextColor=qi.DealList.FieldColor.Deal:a.Type==On.INDEX_ID&&(a.TextColor=qi.DealList.FieldColor.Index)}},this.SetColumn=function(t){if(sa.IsNonEmptyArray(t)){this.Column=[];for(var e=0;e<t.length;++e){var a=t[e],i=this.GetDefaultColunm(a.Type);if(i){if(a.Title&&(i.Title=a.Title),a.TextAlign&&(i.TextAlign=a.TextAlign),a.TextColor&&(i.TextColor=a.TextColor),a.MaxText&&(i.MaxText=a.MaxText),a.ChartTooltip&&(i.ChartTooltip={Enable:a.ChartTooltip.Enable,Type:a.ChartTooltip.Type}),a.Type==On.MULTI_BAR_ID||a.Type==On.CENTER_BAR_ID){if(!sa.IsNumber(a.DataIndex))continue;i.DataIndex=a.DataIndex}else a.Type==On.TIME_ID?sa.IsString(a.Foramt)&&(i.Foramt=a.Foramt):this.IsReserveNumber(a.Type)&&(a.Format&&(i.Format=a.Format),sa.IsNumber(a.ColorType)&&(i.ColorType=a.ColorType));this.Column.push(i)}}}},this.GetDefaultColunm=function(t){for(var e=[{Type:On.TIME_ID,Title:"时间",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.Time,MaxText:"88:88:88",Foramt:"HH:MM:SS"},{Type:On.PRICE_ID,Title:"价格",TextAlign:"center",Width:null,MaxText:"888888.88"},{Type:On.VOL_ID,Title:"成交",TextAlign:"right",Width:null,TextColor:qi.DealList.FieldColor.Vol,MaxText:"888888"},{Type:On.BS_ID,Title:"",TextAlign:"right",Width:null,MaxText:"擎"},{Type:On.DEAL_ID,Title:"笔数",TextAlign:"right",Width:null,TextColor:qi.DealList.FieldColor.Deal,MaxText:"8888"},{Type:On.UPDOWN_ID,Title:"涨跌",TextAlign:"right",Width:null,MaxText:"-8888.88"},{Type:On.STRING_TIME_ID,Title:"时间",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.Time,MaxText:"88:88:88"},{Type:On.INDEX_ID,Title:"序号",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.Index,MaxText:"88888"},{Type:On.MULTI_BAR_ID,Title:"柱子",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.BarTitle,MaxText:"888888"},{Type:On.CENTER_BAR_ID,Title:"柱子2",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.BarTitle,MaxText:"888888"},{Type:On.CUSTOM_TEXT_ID,Title:"自定义",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.Text,MaxText:"擎擎擎擎擎"},{Type:On.NAME_ID,Title:"股票名称",TextAlign:"center",Width:null,TextColor:qi.DealList.FieldColor.Text,MaxText:"擎擎擎擎*"},{Type:On.RESERVE_NUMBER1_ID,Title:"数值1",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER2_ID,Title:"数值2",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER3_ID,Title:"数值3",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER4_ID,Title:"数值4",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER5_ID,Title:"数值5",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER6_ID,Title:"数值6",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER7_ID,Title:"数值7",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER8_ID,Title:"数值8",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER9_ID,Title:"数值9",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_NUMBER10_ID,Title:"数值10",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:On.RESERVE_STRING1_ID,Title:"文字1",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING2_ID,Title:"文字2",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING3_ID,Title:"文字3",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING4_ID,Title:"文字4",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING5_ID,Title:"文字5",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING6_ID,Title:"文字6",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING7_ID,Title:"文字7",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING8_ID,Title:"文字8",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING9_ID,Title:"文字9",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:On.RESERVE_STRING10_ID,Title:"文字10",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"}],a=0;a<e.length;++a){var i=e[a];if(i.Type==t)return i}return null},this.Draw=function(){this.AryCellRect=[],this.TooltipRect=[],this.SizeChange?this.CalculateSize():this.UpdateCacheData(),this.DrawBorder(),this.DrawHeader(),this.DrawBody(),this.SizeChange=!1},this.UpdateCacheData=function(){this.RectClient.Left=this.ChartBorder.GetLeft(),this.RectClient.Right=this.ChartBorder.GetRight(),this.RectClient.Top=this.ChartBorder.GetTop(),this.RectClient.Bottom=this.ChartBorder.GetBottom(),this.Decimal=Jr(this.Symbol)},this.GetPageSize=function(t){t&&this.CalculateSize();var e=this.TableCount*this.RowCount;return e},this.CalculateSize=function(){this.UpdateCacheData();var t=F();this.HeaderFont="".concat(this.HeaderFontConfig.Size*t,"px ").concat(this.HeaderFontConfig.Name),this.ItemFont="".concat(this.ItemFontConfig.Size*t,"px ").concat(this.ItemFontConfig.Name),this.Canvas.font=this.ItemFont;for(var e=0,a=0,i=0;i<this.Column.length;++i){var r=this.Column[i];a=this.Canvas.measureText(r.MaxText).width,r.Width=a+4,e+=r.Width}var n=this.RectClient.Right-this.RectClient.Left;this.TableCount=parseInt(n/e),this.TableCount<=0&&(this.TableCount=1),this.IsSingleTable&&(this.TableCount=1),this.TableWidth=n/this.TableCount,this.HeaderHeight=this.GetFontHeight(this.HeaderFont,"擎")+this.HeaderMergin.Top+this.HeaderMergin.Bottom,this.IsShowHeader||(this.HeaderHeight=0),this.RowHeight=this.GetFontHeight(this.ItemFont,"擎")+this.HeaderMergin.Top+this.HeaderMergin.Bottom,this.RowCount=parseInt((this.RectClient.Bottom-this.RectClient.Top-this.HeaderHeight)/this.RowHeight)},this.DrawHeader=function(){if(this.IsShowHeader){var t=this.RectClient.Left+this.HeaderMergin.Left,e=this.RectClient.Top,a=e+this.HeaderMergin.Top+(this.HeaderHeight-this.HeaderMergin.Top-this.HeaderMergin.Bottom)/2;this.Canvas.font=this.HeaderFont,this.Canvas.fillStyle=this.HeaderColor;for(var i=0,r=0;i<this.TableCount;++i){var n=t+this.TableWidth*i,o=n;for(r=0;r<this.Column.length;++r){var s=this.Column[r],h=s.Width;r==this.Column.length-1&&(h=this.TableWidth-(o-n)-this.HeaderMergin.Right-this.HeaderMergin.Left);var l=o;"center"==s.TextAlign?(l=o+h/2,this.Canvas.textAlign="center"):"right"==s.TextAlign?(l=o+h,this.Canvas.textAlign="right"):this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(s.Title,l,a),o+=s.Width}}}},this.DrawBorder=function(){var t=A(this.RectClient.Left),e=A(this.RectClient.Right),a=A(this.RectClient.Top),i=A(this.RectClient.Bottom);this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.IsShowHeader&&(this.Canvas.moveTo(t,a+this.HeaderHeight),this.Canvas.lineTo(e,a+this.HeaderHeight));for(var r=A(t+this.TableWidth),n=1;n<this.TableCount;++n)this.Canvas.moveTo(r,a),this.Canvas.lineTo(r,i),r=A(r+this.TableWidth);this.Canvas.stroke()},this.DrawBody=function(){if(this.Data&&sa.IsNonEmptyArray(this.Data.Data)){this.Canvas.font=this.ItemFont;var t=this.RectClient.Top+this.HeaderHeight,e=this.RectClient.Left+this.HeaderMergin.Left,a=this.Data.Data.length,i=this.Data.DataOffset;if(1==this.ShowOrder){i=this.Data.DataOffset+this.TableCount*this.RowCount;i>=a&&(i=a-1);for(var r=0,n=0;r<this.TableCount;++r){var o=e+this.TableWidth*r,s=o,h=t;for(n=0;n<this.RowCount&&i>=0;++n,--i){var l=this.Data.Data[i];this.DrawSelectedRow(l,i,u),this.DrawRow(l,s,h,i),h+=this.RowHeight}}}else for(r=0,n=0;r<this.TableCount;++r){o=e+this.TableWidth*r,s=o,h=t;for(n=0;n<this.RowCount&&i<a;++n,++i){l=this.Data.Data[i];var u={Left:s-this.HeaderMergin.Left,Top:h,Height:this.RowHeight,Width:this.TableWidth};u.Right=u.Left+u.Width,u.Bottom=u.Top+u.Height,this.DrawSelectedRow(l,i,u),this.DrawRow(l,s,h,i),this.AryCellRect.push({Rect:u,Type:1,DataIndex:i}),h+=this.RowHeight}}}},this.DrawRow=function(t,e,a,i,r){for(var n=e,o=e+this.TableWidth,s=0;s<this.Column.length;++s){var h=this.Column[s],l=h.TextColor,u=null,C=h.Width,D=h.TextAlign;if(e+C>o)break;s==this.Column.length-1&&(C=this.TableWidth-(e-n)-this.HeaderMergin.Right-this.HeaderMergin.Left);var f={Text:null,TextColor:h.TextColor,TextAlign:h.TextAlign,Tooltip:null,Index:i,ColumnIndex:s},c={Left:e,Top:a,Width:C,Height:this.RowHeight};c.Right=c.Left+c.Width,c.Bottom=c.Top+c.Height,f.Rect=c;var m=!1;if(h.Type==On.TIME_ID)u=sa.FormatTimeString(t.Time,h.Foramt);else if(h.Type==On.STRING_TIME_ID)u=t.StrTime;else if(h.Type==On.PRICE_ID)l=t.Price>this.YClose?this.UpColor:t.Price<this.YClose?this.DownColor:this.UnchangeColor,u=t.Price.toFixed(this.Decimal);else if(h.Type==On.VOL_ID)u=sa.FormatValueString(t.Vol,0),l=this.GetVolColor(h,t);else if(h.Type==On.DEAL_ID)u=sa.FormatValueString(t.Deal,0);else if(h.Type==On.BS_ID)1==t.BS?(u="B",l=this.UpColor):2==t.BS&&(u="S",l=this.DownColor);else if(h.Type==On.UPDOWN_ID){if(sa.IsNumber(this.YClose)){var d=t.Price-this.YClose;u=d.toFixed(2),l=d>0?this.UpColor:d<0?this.DownColor:this.UnchangeColor}}else if(h.Type==On.INDEX_ID)u=(i+1).toString();else if(h.Type==On.MULTI_BAR_ID){c={Left:e,Top:a,Width:C,Height:this.RowHeight};this.DrawMultiBar(h,t,c)}else if(h.Type==On.CENTER_BAR_ID){c={Left:e,Top:a,Width:C,Height:this.RowHeight};this.DrawCenterBar(h,t,c)}else if(h.Type==On.CUSTOM_TEXT_ID){var I={Text:null,TextColor:null,TextAlign:null};c={Left:e,Top:a,Width:C,Height:this.RowHeight};this.DrawCustomText(h,t,c,i,s,I)&&(I.Text&&(u=I.Text),I.TextColor&&(l=I.TextColor),I.TextAlign&&(D=I.TextAlign))}else this.IsReserveString(h.Type)?(this.FormatReserveString(h,t,f),m=!0):this.IsReserveNumber(h.Type)&&(this.FormatReserveNumber(h,t,f),m=!0);if(m?this.DrawItemText(f.Text,f.TextColor,f.TextAlign,c.Left,c.Top,c.Width,f.BGColor):this.DrawItemText(u,l,D,e,a,C),h.ChartTooltip&&h.ChartTooltip.Enable&&sa.IsNumber(h.ChartTooltip.Type)){var S={Rect:c,Data:t,Index:i,Column:h,Type:h.ChartTooltip.Type};this.TooltipRect.push(S)}e+=h.Width}},this.FormatReserveNumber=function(t,e,a){t.DefaultText&&(a.Text=t.DefaultText);var i=bn.get(t.Type);if(e&&i){var r=e[i];if(sa.IsNumber(r)){sa.IsNumber(t.ColorType)&&(1==t.ColorType?a.TextColor=this.GetUpDownColor(r,0):2==t.ColorType&&(a.TextColor=this.GetUpDownColorV2(r,0)));var n=r.toFixed(t.FloatPrecision);if(t.Format&&sa.IsNumber(t.Format.Type)){var o=t.Format;switch(o.Type){case 1:n=r.toFixed(t.FloatPrecision);break;case 2:n=sa.FormatValueThousandsString(r,t.FloatPrecision);break;case 3:var s=1;sa.IsNumber(o.ExFloatPrecision)&&(s=o.ExFloatPrecision),n=sa.FormatValueStringV2(r,t.FloatPrecision,s);break}}a.Text=n}}},this.FormatReserveString=function(t,e,a){t.DefaultText&&(a.Text=t.DefaultText);var i=bn.get(t.Type);if(e&&i){var r=e[i];sa.IsObject(r)?(r.Text&&(a.Text=r.Text),r.TextColor&&(a.TextColor=r.TextColor),r.BGColor&&(a.BGColor=r.BGColor)):sa.IsString(r)&&(a.Text=r)}},this.GetUpDownColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchangeColor},this.GetUpDownColorV2=function(t,e){return t>=e?this.UpColor:this.DownColor},this.DrawSelectedRow=function(t,e,a){this.SelectedData&&this.SelectedData.Enable&&this.SelectedData.Guid&&this.SelectedData.Guid==t.Guid&&(this.Canvas.fillStyle=this.SelectedConfig.BGColor,this.Canvas.fillRect(a.Left,a.Top,a.Width,a.Height))},this.DrawItemText=function(t,e,a,i,r,n){var o=i;"center"==a?(o=i+n/2,this.Canvas.textAlign="center"):"right"==a?(o=i+n,this.Canvas.textAlign="right"):this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e,t&&this.Canvas.fillText(t,o,r+this.RowHeight/2)},this.DrawMultiBar=function(t,e,a){if(!e.Source||!sa.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!sa.IsNonEmptyArray(i.Value))return!1;for(var r=a.Width-this.BarMergin.Left-this.BarMergin.Right,n=a.Left+this.BarMergin.Left,o=a.Top+this.RowMergin.Top+this.BarMergin.Top,s=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,h=n+r,l=0;l<i.Value.length;++l){var u=i.Value[l];if(!(u<=0)){if(n>=h)break;var C=r*u;C<1&&(C=1),n+C>h&&(C=h-n);var D=l;sa.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=qi.DealList.FieldColor.Bar[D],this.Canvas.fillRect(n,o,C,s),n+=C}}return!0},this.DrawCenterBar=function(t,e,a){if(!e.Source||!sa.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!sa.IsNonEmptyArray(i.Value))return!1;for(var r=(a.Width-this.BarMergin.Left-this.BarMergin.Right)/2,n=a.Left+this.BarMergin.Left,o=n+r,s=a.Top+this.RowMergin.Top+this.BarMergin.Top,h=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,l=0;l<i.Value.length&&l<2;++l){var u=i.Value[l];if(!(u<=0)){u>1&&(u=1);var C=r*u;C<1&&(C=1);var D=l;sa.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=qi.DealList.FieldColor.Bar[D],0==l?this.Canvas.fillRect(o,s,-C,h):this.Canvas.fillRect(o,s,C,h)}}},this.DrawCustomText=function(t,e,a,i,r,n){var o=this.GetEventCallback(m.ON_DRAW_DEAL_TEXT);if(!o||!o.Callback)return!1;var s={Data:e,DataIndex:i,ColumnIndex:r,ColumnInfo:t,Out:{Text:null,TextColor:null,TextAlign:null}};return o.Callback(o,s,this),!!s.Out.Text&&(n.Text=s.Out.Text,s.Out.TextColor&&(n.TextColor=s.Out.TextColor),s.Out.TextAlign&&(n.TextAlign=s.Out.TextAlign),!0)},this.GetVolColor=function(t,e){var a=this.GetEventCallback(m.ON_DRAW_DEAL_VOL_COLOR);if(a&&a.Callback){var i={Data:e,TextColor:null};if(a.Callback(a,i,this),i.TextColor)return i.TextColor}return t.TextColor},this.GetFontHeight=function(t,e){return E(this.Canvas,t,e)},this.OnMouseDown=function(t,e,a){if(!this.Data)return null;var i,r=F(),n={X:t/r,Y:e/r};i=this.UIElement?{Left:this.UIElement.getBoundingClientRect().left,Top:this.UIElement.getBoundingClientRect().top}:{Left:null,Top:null};var o=this.PtInBody(t,e);if(o){var s=!0,h=o.DataIndex,l=o.Item.Guid;this.SelectedData.Index==h&&this.SelectedData.Guid==l&&(s=!1),this.SelectedData.Index=h,this.SelectedData.Guid=l;var u=m.ON_CLICK_DEAL_ROW;return 2==a.button&&(u=m.ON_RCLICK_DEAL_ROW),this.SendClickEvent(u,{Data:o,X:t,Y:e,e:a,Inside:n,UIElement:i}),{Type:o.Type,Redraw:s,Row:o}}return null},this.OnDblClick=function(t,e,a){if(!this.Data)return!1;var i=this.PtInBody(t,e);return!!i&&(this.SendClickEvent(m.ON_DBCLICK_DEAL_ROW,{Data:i,X:t,Y:e}),!0)},this.PtInBody=function(t,e){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;if(!sa.IsNonEmptyArray(this.AryCellRect))return null;for(var a=0;a<this.AryCellRect.length;++a){var i=this.AryCellRect[a],r=i.Rect;if(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom){var n={Rect:r,DataIndex:i.DataIndex,Item:this.Data.Data[i.DataIndex],Type:i.Type};return n}}return null},this.SendClickEvent=function(t,e){var a=this.GetEventCallback(t);a&&a.Callback&&a.Callback(a,e,this)},this.IsReserveString=function(t){var e=[On.RESERVE_STRING1_ID,On.RESERVE_STRING2_ID,On.RESERVE_STRING3_ID,On.RESERVE_STRING4_ID,On.RESERVE_STRING5_ID,On.RESERVE_STRING6_ID,On.RESERVE_STRING7_ID,On.RESERVE_STRING8_ID,On.RESERVE_STRING9_ID,On.RESERVE_STRING10_ID];return e.includes(t)},this.IsReserveNumber=function(t){var e=[On.RESERVE_NUMBER1_ID,On.RESERVE_NUMBER2_ID,On.RESERVE_NUMBER3_ID,On.RESERVE_NUMBER4_ID,On.RESERVE_NUMBER5_ID,On.RESERVE_NUMBER6_ID,On.RESERVE_NUMBER7_ID,On.RESERVE_NUMBER8_ID,On.RESERVE_NUMBER9_ID,On.RESERVE_NUMBER10_ID];return e.includes(t)},this.GetTooltipData=function(t,e){if(!sa.IsNonEmptyArray(this.TooltipRect))return null;for(var a=0;a<this.TooltipRect.length;++a){var i=this.TooltipRect[a],r=i.Rect;if(r&&(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom))return(0,h.default)({Rect:i.Rect,Data:i.Data,Column:i.Column,Index:i.Index,Type:i.Type},"Data",i.Data)}return null}}function Pn(t){this.DivElement=t,this.JSChartContainer,this.ResizeListener,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jsreportlist-drawing",this.CanvasElement.id=N(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&u.Chart.Log("[JSReportChart::JSReportChart] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.MapExtraCanvasElement=new Map,this.CreateExtraCanvasElement=function(e,a){if(this.MapExtraCanvasElement.has(e))return this.MapExtraCanvasElement.get(e);var i=document.createElement("canvas");i.className="jsreportlist-drawing-extra",i.id=N(),e==Pn.CorssCursorCanvasKey?i.setAttribute("tabindex",5):i.setAttribute("tabindex",1),i.style&&(i.style.outline="none",i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style["pointer-events"]="none"),a&&(sa.IsNumber(a.TabIndex)&&i.setAttribute("tabindex",a.TabIndex),sa.IsNumber(a.ZIndex)&&(i.style["z-index"]=a.ZIndex)),this.CanvasElement&&(i.height=this.CanvasElement.height,i.width=this.CanvasElement.width,i.style&&(i.style.width=this.CanvasElement.style.width,i.style.height=this.CanvasElement.style.height)),t.appendChild(i);var r={Element:i,Canvas:null};this.MapExtraCanvasElement.set(e,r)},this.GetExtraCanvas=function(t){if(!this.MapExtraCanvasElement.has(t))return null;var e=this.MapExtraCanvasElement.get(t);return e.Element?(e.Canvas||(e.Canvas=e.Element.getContext("2d")),e):null},this.OnSize=function(){var t=this.DivElement.offsetHeight,e=this.DivElement.offsetWidth;this.DivElement.style.height&&this.DivElement.style.width&&(this.DivElement.style.height.includes("px")&&(t=parseInt(this.DivElement.style.height.replace("px",""))),this.DivElement.style.width.includes("px")&&(e=parseInt(this.DivElement.style.width.replace("px","")))),this.CanvasElement.height=t,this.CanvasElement.width=e,this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var a=F();this.CanvasElement.height*=a,this.CanvasElement.width*=a;var i,r=(0,l.default)(this.MapExtraCanvasElement);try{for(r.s();!(i=r.n()).done;){var n=i.value,o=n[1],s=o.Element;s&&(s.height=this.CanvasElement.height,s.width=this.CanvasElement.width,s.style.width=this.CanvasElement.style.width,s.style.height=this.CanvasElement.style.height)}}catch(h){r.e(h)}finally{r.f()}u.Chart.Log("[JSReportChart::OnSize] devicePixelRatio=".concat(window.devicePixelRatio,", height=").concat(this.CanvasElement.height,", width=").concat(this.CanvasElement.width)),this.JSChartContainer&&this.JSChartContainer.OnSize&&this.JSChartContainer.OnSize()},this.SetOption=function(t){var e=this.CreateJSReportChartContainer(t);if(!e)return!1;if(t.OnCreatedCallback&&t.OnCreatedCallback(e),this.JSChartContainer=e,this.DivElement.JSChart=this,t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}1==t.EnableResize&&this.CreateResizeListener(),!0===t.EnablePopMenuV2&&e.InitalPopMenu(),t.FloatTooltip&&t.FloatTooltip.Enable&&e.InitalFloatTooltip(t.FloatTooltip),t.MinuteChartTooltip&&t.MinuteChartTooltip.Enable&&e.InitalMinuteChartTooltip(t.MinuteChartTooltip),t.KLineChartTooltip&&t.KLineChartTooltip.Enable&&e.InitalKLineChartTooltip(t.KLineChartTooltip),t.Symbol&&(e.Symbol=t.Symbol),t.Name&&(e.Name=t.Name);var r={Callback:null};e.Symbol&&(r.Callback=function(){e.RequestMemberListData()}),!1===t.LoadStockList?(e.ChartSplashPaint.IsEnableSplash=!1,e.Draw()):e.RequestStockListData(r)},this.CreateJSReportChartContainer=function(t){var e=this,a=new _n(this.CanvasElement);if(a.GetExtraCanvas=function(t){return e.GetExtraCanvas(t)},a.Create(t),t.NetworkFilter&&(a.NetworkFilter=t.NetworkFilter),sa.IsNonEmptyArray(t.Column)&&a.SetColumn(t.Column),sa.IsNonEmptyArray(t.Tab)&&a.SetTab(t.Tab),sa.IsNumber(t.TabSelected)&&a.SetSelectedTab(t.TabSelected),sa.IsBool(t.EnableDragRow)&&(a.EnableDragRow=t.EnableDragRow),sa.IsNumber(t.DragRowType)&&(a.DragRowType=t.DragRowType),sa.IsBool(t.EnableDragHeader)&&(a.EnableDragHeader=t.EnableDragHeader),sa.IsNumber(t.WheelPageType)&&(a.WheelPageType=t.WheelPageType),sa.IsBool(t.PageUpDownCycle)&&(a.PageUpDownCycle=t.PageUpDownCycle),sa.IsObject(t.SplashTitle)){var i=t.SplashTitle;i&&(a.SplashTitle.StockList=i.StockList),i&&(a.SplashTitle.MemberList=i.MemberList)}if(t.VScrollbar&&a.SetVScrollbar(t.VScrollbar),t.SortInfo){i=t.SortInfo;sa.IsNumber(i.Field)&&(a.SortInfo.Field=i.Field),sa.IsNumber(i.Sort)&&(a.SortInfo.Sort=i.Sort)}if(t.VirtualTable){i=t.VirtualTable;sa.IsBool(i.Enable)&&(a.Data.Virtual.Enable=i.Enable)}var r=a.GetReportChart();if(r&&(sa.IsNumber(t.TextOverflowStyle)&&(r.TextOverflowStyle=t.TextOverflowStyle),sa.IsNumber(t.MultiSelectModel)&&(r.MultiSelectModel=t.MultiSelectModel),sa.IsNumber(t.SelectedStyle)&&(r.SelectedStyle=t.SelectedStyle)),this.SetChartBorder(a,t),null!=t.IsAutoUpdate&&(a.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(a.AutoUpdateFrequency=t.AutoUpdateFrequency),sa.IsBool(t.EnableFilter)&&(a.EnableFilter=t.EnableFilter),t.EventCallback)for(var n=0;n<t.EventCallback.length;++n){i=t.EventCallback[n];a.AddEventCallback(i)}return a},this.SetChartBorder=function(t,e){if(e.Border){e.Border;sa.IsNumber(e.Border.Left)&&(t.Frame.ChartBorder.Left=e.Border.Left),sa.IsNumber(e.Border.Right)&&(t.Frame.ChartBorder.Right=e.Border.Right),sa.IsNumber(e.Border.Top)&&(t.Frame.ChartBorder.Top=e.Border.Top),sa.IsNumber(e.Border.Bottom)&&(t.Frame.ChartBorder.Bottom=e.Border.Bottom);var a=F();t.Frame.ChartBorder.Left*=a,t.Frame.ChartBorder.Right*=a,t.Frame.ChartBorder.Top*=a,t.Frame.ChartBorder.Bottom*=a}},this.CreateResizeListener=function(){var t=this;this.ResizeListener=new ResizeObserver((function(e){t.OnDivResize(e)})),this.ResizeListener.observe(this.DivElement)},this.OnDivResize=function(t){u.Chart.Log("[JSReportChart::OnDivResize] entries=",t),this.OnSize()},this.ChangeSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t,e)},this.SetColumn=function(t,e){this.JSChartContainer&&this.JSChartContainer.SetColumn(t,e)},this.SetSelectedRow=function(t){this.JSChartContainer&&this.JSChartContainer.SetSelectedRow(t)},this.DeleteSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.DeleteSymbol(t,e)},this.AddSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.AddSymbol(t,e)},this.EnableFilter=function(t,e){this.JSChartContainer&&this.JSChartContainer.EnableFilter(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(u.Chart.Log("[JSReportChart:AddEventCallback] obj=",t),this.JSChartContainer.AddEventCallback(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(u.Chart.Log("[JSReportChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.ChartDestroy=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestroy&&this.JSChartContainer.ChartDestroy()},this.Draw=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(u.Chart.Log("[JSReportChart:Draw] "),this.JSChartContainer.Draw())}}function Gn(){this.OriginalSymbol,this.Symbol,this.Name,this.YClose,this.Open,this.Price,this.High,this.Low,this.Amount,this.Vol,this.Increase,this.UpDown,this.Exchange,this.Amplitude,this.BuyPrice,this.BuyVol,this.SellPrice,this.SellVol,this.AvPrice,this.LimitHigh,this.LimitLow,this.VolIn,this.VolOut,this.DealNum,this.OutShares,this.TotalShares,this.MarketValue,this.CircMarketValue,this.CloseLine,this.ExtendData,this.Time,this.Date}function _n(t){this.ClassName="JSReportChartContainer",this.Frame,this.ChartPaint=[],this.ChartSplashPaint=null,this.LoadDataSplashTitle="数据加载中",this.SplashTitle={StockList:"下载码表中.....",MemberList:"下载成分中....."},this.Canvas=t.getContext("2d"),this.Symbol,this.Name,this.NetworkFilter,this.Data={XOffset:0,YOffset:0,Data:[],Virtual:{Enable:!1,Count:0}},this.SourceData={Data:[]},this.BlockData=new Map,this.MapStockData=new Map,this.FixedRowData={Data:[],Type:0,Symbol:[]},this.FlashBG=new Map,this.FlashBGTimer=null,this.GlobalOption={FlashBGCount:0},this.SortInfo={Field:-1,Sort:0},this.DragRow,this.DragColumnWidth,this.EnableDragRow=!1,this.DragRowType=0,this.AutoDragScrollTimer=null,this.EnablePageScroll=!1,this.DragMove,this.DragHeader,this.EnableDragHeader=!1,this.mapEvent=new Map,this.AutoUpdateTimer=null,this.AutoUpdateFrequency=15e3,this.DelayUpdateTimer=null,this.DelayUpdateFrequency=500,this.UIElement=t,this.LastPoint=new V,this.IsOnTouch=!1,this.TouchDrag,this.TouchMoveMinAngle=70,this.YStepPixel=5*F(),this.XStepPixel=10*F(),this.PageUpDownCycle=!0,this.DragPageCycle=!0,this.WheelPageType=0,this.DragXScroll=null,this.DragYScroll=null,this.IsShowVScrollbar=!1,this.IsDestroy=!1,this.JSPopMenu,this.IsShowRightMenu=!0,this.TooltipMinuteChart,this.TooltipKLineChart,this.LastMouseStatus={MoveStatus:null,TooltipStatus:null,MouseOnStatus:null},this.ChartDestroy=function(){this.IsDestroy=!0,this.StopAutoUpdate(),this.DestroyMinuteChartTooltip(),this.DestroyKLineChartTooltip(),this.DestroyFloatTooltip()},this.StopAutoDragScrollTimer=function(){u.Chart.Log("[JSReportChartContainer::StopAutoDragScrollTimer] stop "),this.EnablePageScroll=!1,null!=this.AutoDragScrollTimer&&(clearTimeout(this.AutoDragScrollTimer),this.AutoDragScrollTimer=null)},this.InitalPopMenu=function(){this.JSPopMenu||(this.JSPopMenu=new JSPopMenu,this.JSPopMenu.Inital())},this.InitalMinuteChartTooltip=function(t){this.TooltipMinuteChart||(this.TooltipMinuteChart=new JSTooltipMinuteChart,this.TooltipMinuteChart.Inital(this,t),this.TooltipMinuteChart.Create())},this.DestroyMinuteChartTooltip=function(){this.TooltipMinuteChart&&(this.TooltipMinuteChart.Destroy(),this.TooltipMinuteChart=null)},this.InitalKLineChartTooltip=function(t){this.TooltipKLineChart||(this.TooltipKLineChart=new JSTooltipKLineChart,this.TooltipKLineChart.Inital(this,t),this.TooltipKLineChart.Create())},this.DestroyKLineChartTooltip=function(){this.TooltipKLineChart&&(this.TooltipKLineChart.Destroy(),this.TooltipKLineChart=null)},this.InitalFloatTooltip=function(t){this.FloatTooltip||(this.FloatTooltip=new JSFloatTooltip,this.FloatTooltip.Inital(this,t),this.FloatTooltip.Create())},this.HideFloatTooltip=function(){this.FloatTooltip&&this.FloatTooltip.Hide()},this.DestroyFloatTooltip=function(){this.FloatTooltip&&(this.FloatTooltip.Destroy(),this.FloatTooltip=null)},this.DrawFloatTooltip=function(t,e){this.FloatTooltip&&this.UpdateFloatTooltip(t,e)},this.UpdateFloatTooltip=function(t,e){if(this.FloatTooltip){var a={Tooltip:e,Point:t,DataType:3};this.FloatTooltip.Update(a)}},this.ShowMinuteChartTooltip=function(t,e,a){if(this.TooltipMinuteChart){var i=this.UIElement.getBoundingClientRect(),r=w(),n=i.left+r.Left,o=i.top+r.Top;a.Offset={Left:n,Top:o},this.TooltipMinuteChart.Show(a,t,e)}},this.HideMinuteChartTooltip=function(){this.TooltipMinuteChart&&this.TooltipMinuteChart.Hide()},this.ShowKLineChartTooltip=function(t,e,a){if(this.TooltipKLineChart){var i=this.UIElement.getBoundingClientRect(),r=w(),n=i.left+r.Left,o=i.top+r.Top;a.Offset={Left:n,Top:o},this.TooltipKLineChart.Show(a,t,e)}},this.HideKLineChartTooltip=function(){this.TooltipKLineChart&&this.TooltipKLineChart.Hide()},this.HideAllTooltip=function(){this.HideKLineChartTooltip(),this.HideMinuteChartTooltip(),this.HideFloatTooltip()},this.AutoScrollPage=function(t){var e=this;this.AutoDragScrollTimer=setTimeout((function(){e.ChartOperator_Temp_ScrollPage(t)}),300)},this.ChartOperator_Temp_ScrollPage=function(t){if(this.EnablePageScroll){var e=this.GetReportChart();if(e){if(t>0){var a=e.GetCurrentPageStatus();if(a.IsEnd)return;this.MoveYOffset(t,!1),++t}else{if(!(t<0))return;if(this.Data.YOffset<=0)return;this.MoveYOffset(t,!1),--t}this.Draw(),this.EnablePageScroll&&this.AutoScrollPage(t)}}},this.ClearCanvas=function(t){t&&this.UIElement&&t.clearRect(0,0,this.UIElement.width,this.UIElement.height)},this.ClearFixedRowData=function(){this.FixedRowData.Data=[],this.FixedRowData.Symbol=[]},this.SetFixedRowCount=function(t){var e=this.GetReportChart();e&&(e.FixedRowCount=t)},this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.IsEnableSplash=!0,this.Frame=new Vn,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame;var a=new kn;if(a.Frame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.UIElement=this.UIElement,a.GetEventCallback=function(t){return e.GetEventCallback(t)},a.GetStockDataCallback=function(t){return e.GetStockData(t)},a.GetBlockDataCallback=function(t){return e.GetBlockData(t)},a.GetFlashBGDataCallback=function(t,a){return e.GetFlashBGData(t,a)},a.Data=this.Data,a.GlobalOption=this.GlobalOption,a.FixedRowData=this.FixedRowData,a.SortInfo=this.SortInfo,a.Tab=new Xn,a.Tab.Frame=this.Frame,a.Tab.Canvas=this.Canvas,a.Tab.ChartBorder=this.Frame.ChartBorder,a.Tab.Report=a,a.VScrollbar=new Un,a.VScrollbar.Frame=this.Frame,a.VScrollbar.Canvas=this.Canvas,a.VScrollbar.ChartBorder=this.Frame.ChartBorder,a.VScrollbar.Report=a,a.VScrollbar.IsShowCallback=function(){return!!e.DragYScroll||e.IsShowVScrollbar},this.ChartPaint[0]=a,t&&!0===t.PageInfo){var i=new Wn;i.Frame=this.Frame,i.ChartBorder=this.Frame.ChartBorder,i.Canvas=this.Canvas,i.Report=a,this.ChartPaint[1]=i}if(t&&(sa.IsBool(t.IsShowHeader)&&(a.IsShowHeader=t.IsShowHeader),sa.IsNumber(t.FixedColumn)&&(a.FixedColumn=t.FixedColumn),sa.IsNumber(t.BorderLine)&&(this.Frame.BorderLine=t.BorderLine),sa.IsBool(t.TabShow)&&(a.Tab.IsShow=t.TabShow),sa.IsNumber(t.FixedRowCount)&&(a.FixedRowCount=t.FixedRowCount),sa.IsBool(t.ItemBorder)&&(a.IsDrawBorder=t.ItemBorder),sa.IsNumber(t.SelectedModel)&&(a.SelectedModel=t.SelectedModel),sa.IsNumber(t.HeaderRowCount)&&(a.HeaderRowCount=t.HeaderRowCount),sa.IsNonEmptyArray(t.FixedSymbol))){a.FixedRowCount=0,this.FixedRowData.Type=1,this.FixedRowData.Symbol=[];for(var r=t.FixedSymbol,n=0;n<r.length;++n){var o=r[n];this.FixedRowData.Symbol.push(o.Symbol),++a.FixedRowCount}}var s=!0,h=!0;t&&(!1===t.KeyDown&&(s=!1,u.Chart.Log("[JSDealChartContainer::Create] not register keydown event.")),!1===t.Wheel&&(h=!1,u.Chart.Log("[JSDealChartContainer::Create] not register wheel event."))),s&&this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),h&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0),this.UIElement.ondblclick=function(t){e.UIOnDblClick(t)},this.UIElement.onmousedown=function(t){e.UIOnMouseDown(t)},this.UIElement.onmouseup=function(t){e.UIOnMounseUp(t)},this.UIElement.oncontextmenu=function(t){e.UIOnContextMenu(t)},this.UIElement.onmousemove=function(t){e.UIOnMouseMove(t)},this.UIElement.onmouseout=function(t){e.UIOnMounseOut(t)},this.UIElement.onmouseleave=function(t){e.UIOnMouseleave(t)},this.UIElement.ontouchstart=function(t){e.OnTouchStart(t)},this.UIElement.ontouchmove=function(t){e.OnTouchMove(t)},this.UIElement.ontouchend=function(t){e.OnTouchEnd(t)}},this.Draw=function(){if(!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var t=F();if(this.Canvas.lineWidth=t,this.LastMouseStatus.MouseOnStatus=null,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw();this.Frame.Draw(),this.Frame.DrawLogo();for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.IsDrawFirst&&a.Draw(this.LastMouseStatus)}for(e=0;e<this.ChartPaint.length;++e){a=this.ChartPaint[e];a.IsDrawFirst||a.Draw(this.LastMouseStatus)}this.GlobalOption.FlashBGCount>0&&this.DelayDraw(500)}},this.DelayDraw=function(t){var e=this;"number"==typeof this.FlashBGTimer&&(clearTimeout(this.FlashBGTimer),this.FlashBGTimer=null),this.FlashBGTimer=setTimeout((function(){e.Draw()}),t)},this.ResetReportStatus=function(){this.Data.XOffset=0,this.Data.YOffset=0},this.ResetReportSelectStatus=function(){var t=this.GetReportChart();t&&(t.SelectedRow=-1,t.SelectedFixedRow=-1,t.MultiSelectedRow=[])},this.ClearData=function(){this.SourceData.Data=[],this.Data.Data=[],this.Data.Virtual.Count=0,this.BlockData=new Map},this.ClearMapStockData=function(){this.MapStockData=new Map},this.ResetSortStatus=function(){this.SortInfo.Field=-1,this.SortInfo.Sort=0},this.SetSelectedRow=function(t){var e=this.GetReportChart();return!!e&&(!!e.SetSelectedRow(t)&&void this.Draw())},this.SetSymbolList=function(t,e){if(this.ClearData(),this.ResetReportStatus(),this.ResetSortStatus(),sa.IsNonEmptyArray(t))for(var a=0;a<t.length;++a)this.Data.Data.push(t[a]);var i=this.ChartPaint[0];i&&(i.Data=this.Data),this.Draw()},this.ChangeSymbol=function(t,e){var a=this;if(this.Symbol=t,this.ClearData(),this.ResetReportStatus(),this.ResetSortStatus(),this.ResetReportSelectStatus(),e){if(sa.IsNumber(e.TabSelected)){var i=this.GetTabChart();i&&(i.SelectedTabIndex=e.TabSelected)}if(Array.isArray(e.FixedSymbol)){var r=this.GetReportChart();if(r){r.FixedRowCount=0,this.FixedRowData.Type=1,this.FixedRowData.Symbol=[];for(var n=e.FixedSymbol,o=0;o<n.length;++o){var s=n[o];this.FixedRowData.Symbol.push(s.Symbol),++r.FixedRowCount}this.SetSizeChange(!0)}}if(e.SortInfo){s=e.SortInfo;sa.IsNumber(s.Field)&&(this.SortInfo.Field=s.Field),sa.IsNumber(s.Sort)&&(this.SortInfo.Sort=s.Sort)}if(sa.IsBool(e.IsReloadStockList)&&e.IsReloadStockList){var h={Callback:null};return this.Symbol&&(h.Callback=function(){a.RequestMemberListData()}),this.MapStockData=new Map,void this.RequestStockListData(h)}}this.RequestMemberListData()},this.UpdateFullData=function(t){var e=[];if(sa.IsNonEmptyArray(t.data))for(var a=0;a<t.data.length;++a){var i=t.data[a],r=i[0],n=null;this.MapStockData.has(r)?n=this.MapStockData.get(r):(n=new Gn,n.OriginalSymbol=r,this.MapStockData.set(r,n)),n.Symbol=this.GetSymbolNoSuffix(r),n.Name=i[1],this.ReadStockJsonData(n,i),e.push(r)}if(this.Data.Data=[],this.SourceData.Data=[],sa.IsNonEmptyArray(e))for(a=0;a<e.length;++a)this.Data.Data.push(e[a]),this.SourceData.Data.push(e[a]);this.Draw()},this.SetFullData=function(t){this.ClearMapStockData(),this.ClearData(),this.ResetReportStatus(),this.ResetSortStatus(),this.ResetReportSelectStatus(),this.UpdateFullData(t)},this.RequestMemberListData=function(){var t=this;if(this.NetworkFilter){var e={Name:"JSReportChartContainer::RequestMemberListData",Explain:"板块成分数据",Request:{Data:{symbol:this.Symbol}},Self:this,PreventDefault:!1};if(this.SortInfo.Field>=0&&this.SortInfo.Sort>0){var a=this.GetReportChart();if(a){var i=a.Column[this.SortInfo.Field];e.Sort={Column:i,Field:this.SortInfo.Field,Sort:this.SortInfo.Sort}}}if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMemberListData(e)})),1==e.PreventDefault)return}},this.RecvMemberListData=function(t){if(this.ClearData(),sa.IsNonEmptyArray(t.data))for(var e=0;e<t.data.length;++e)this.Data.Data.push(t.data[e]),this.SourceData.Data.push(t.data[e]);if(t.Virtual){var a=t.Virtual;sa.IsNumber(a.Count)&&(this.Data.Virtual.Count=a.Count)}this.Draw(),this.UpdateStockData()},this.DeleteSymbol=function(t,e){if(!sa.IsNonEmptyArray(t))return!1;var a=new Set(t),i=!1;if(sa.IsNonEmptyArray(this.SourceData.Data)){for(var r=[],n=0;n<this.SourceData.Data.length;++n){var o=this.SourceData.Data[n];a.has(o)?i=!0:r.push(o)}i&&(this.SourceData.Data=r)}if(sa.IsNonEmptyArray(this.Data.Data)){for(r=[],n=0;n<this.Data.Data.length;++n){o=this.Data.Data[n];a.has(o)?i=!0:r.push(o)}i&&(this.Data.Data=r)}return!!i&&(this.Draw(),this.UpdateStockData(),!0)},this.AddSymbol=function(t,e){if(!sa.IsNonEmptyArray(t))return!1;var a=!0;e&&sa.IsBool(e.Duplicate)&&(a=e.Duplicate);for(var i=new Map,r=0;r<t.length;++r){var n={Symbol:t[r],IsExist:!1,IsExist2:!1};i.set(n.Symbol,n)}if(a){if(sa.IsNonEmptyArray(this.SourceData.Data))for(r=0;r<this.SourceData.Data.length;++r){n=this.Data.Data[r];i.has(n)&&(i.get(n).IsExist=!0)}if(sa.IsNonEmptyArray(this.Data.Data))for(r=0;r<this.Data.Data.length;++r){n=this.Data.Data[r];i.has(n)&&(i.get(n).IsExist2=!0)}}var o,s=(0,l.default)(i);try{for(s.s();!(o=s.n()).done;){var h=o.value;n=h[1];n.IsExist||this.SourceData.Data.push(n.Symbol),n.IsExist2||this.Data.Data.push(n.Symbol)}}catch(u){s.e(u)}finally{s.f()}return this.Draw(),this.UpdateStockData(),!0},this.RequestStockListData=function(t){this.ChartSplashPaint.SetTitle(this.SplashTitle.StockList),this.ChartSplashPaint.EnableSplash(!0),this.Draw();var e=this;if(this.NetworkFilter){var a={Name:"JSReportChartContainer::RequestStockListData",Explain:"码表数据",Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(a){e.ChartSplashPaint.EnableSplash(!1),e.RecvStockListData(a,t)})),1==a.PreventDefault)return}},this.RecvStockListData=function(t,e){if(sa.IsNonEmptyArray(t.data))for(var a=0;a<t.data.length;++a){var i=t.data[a],r=i[0],n=null;this.MapStockData.has(r)?n=this.MapStockData.get(r):(n=new Gn,n.OriginalSymbol=r,this.MapStockData.set(r,n)),n.Symbol=this.GetSymbolNoSuffix(r),n.Name=i[1],sa.IsNumber(i[88])&&(n.PriceColorType=i[88]),this.ReadStockJsonData(n,i)}e&&e.Callback?e.Callback():(this.Draw(),this.UpdateStockData())},this.UpdateMapStockData=function(t){if(t&&sa.IsNonEmptyArray(t.data))for(var e=0;e<t.data.length;++e){var a=t.data[e],i=a[0],r=null;this.MapStockData.has(i)?r=this.MapStockData.get(i):(r=new Gn,r.OriginalSymbol=i,this.MapStockData.set(i,r)),r.Symbol=this.GetSymbolNoSuffix(i),r.Name=a[1],this.ReadStockJsonData(r,a)}},this.GetStockData=function(t){return this.MapStockData&&this.MapStockData.has(t)?this.MapStockData.get(t):null},this.GetBlockData=function(t){return this.BlockData&&this.BlockData.has(t)?this.BlockData.get(t):null},this.SetFlashBGItem=function(t,e){var a={ID:e.ID,Color:e.Color,Count:1};if(sa.IsNumber(e.Count)&&(a.Count=e.Count),sa.IsNumber(e.Time)?a.Time=e.Time:a.Time=Date.now(),this.FlashBG.has(t)){var i=this.FlashBG.get(t);i.LastTime=a.Time,i.Data.set(a.ID,a)}else{i={LastTime:a.Time,Data:new Map([[a.ID,a]])};this.FlashBG.set(t,i)}},this.GetFlashBGData=function(t,e){if(!this.FlashBG)return null;if(!this.FlashBG.has(t))return null;var a=this.FlashBG.get(t);if(e-a.LastTime>=3e3)return this.FlashBG.delete(t),null;if(!a.Data||a.Data.size<=0)return this.FlashBG.delete(t),null;var i,r=[],n=(0,l.default)(a.Data);try{for(n.s();!(i=n.n()).done;){var o=i.value,s=o[1];(e-s.Time>=3e3||s.Count<=0)&&r.push(s.ID)}}catch(u){n.e(u)}finally{n.f()}if(sa.IsNonEmptyArray(r)){for(var h=0;h<r.length;++h)a.Data.delete(r[h]);if(a.Data.size<=0)return this.FlashBG.delete(t),null}return a},this.DelayUpdateStockData=function(){var t=this;null!=this.DelayUpdateTimer&&(clearTimeout(this.DelayUpdateTimer),this.DelayUpdateTimer=null);var e=this.DelayUpdateFrequency;this.DelayUpdateTimer=setTimeout((function(){t.UpdateStockData()}),e)},this.UpdateStockData=function(){var t=this.ChartPaint[0];if(t)if(this.Data.Virtual&&this.Data.Virtual.Enable)this.RequestVirtualStockData();else if(sa.IsNonEmptyArray(this.Data.Data)){if(this.SortInfo&&this.SortInfo.Field>=0&&this.SortInfo.Sort>0){var e=t.Column[this.SortInfo.Field];if(2==e.Sort)return void this.RequestStockSortData(e,this.SortInfo.Field,this.SortInfo.Sort)}var a=t.ShowSymbol;sa.IsNonEmptyArray(a)&&this.RequestStockData(a)}},this.RequestStockData=function(t){var e=this;if(this.NetworkFilter){var a={Name:"JSDealChartContainer::RequestStockData",Explain:"报价列表股票数据",Request:{Data:{stocks:t},symbol:this.Symbol,name:this.Name},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(t){e.RecvStockData(t),e.AutoUpdate()})),1==a.PreventDefault)return}},this.RecvStockData=function(t){var e=this,a=new Set;if(sa.IsNonEmptyArray(t.data))for(var i=0;i<t.data.length;++i){var r=t.data[i],n=r[0];if(n){var o=null;this.MapStockData.has(n)?o=this.MapStockData.get(n):(o=new Gn,o.OriginalSymbol=n,o.Symbol=this.GetSymbolNoSuffix(n),this.MapStockData.set(n,o)),this.ReadStockJsonData(o,r),a.has(n)||a.add(n)}}var s=this.ChartPaint[0];if(s){var h=!1;s=this.ChartPaint[0];if(s&&1==this.SortInfo.Sort&&sa.IsNumber(this.SortInfo.Field)&&this.SortInfo.Field>=0){var l=s.Column[this.SortInfo.Field],u=this.GetEventCallback(m.ON_REPORT_LOCAL_SORT);if(u&&u.Callback){var C={Column:l,SortInfo:this.SortInfo,SymbolList:this.Data.Data,Result:null};u.Callback(u,C,this),Array.isArray(C.Result)&&(this.Data.Data=C.Result)}else this.Data.Data.sort((function(t,a){return e.LocalSort(t,a,l,e.SortInfo.Sort)}));h=!0}else{var D=s.ShowSymbol;for(i=0;i<D.length;++i)if(a.has(D[i].Symbol)){h=!0;break}}h&&this.Draw()}},this.ReadStockJsonData=function(t,e){sa.IsString(e[1])&&(t.Name=e[1]),sa.IsNumber(e[2])&&(t.YClose=e[2]),sa.IsNumber(e[3])&&(t.Open=e[3]),sa.IsNumber(e[4])&&(t.High=e[4]),sa.IsNumber(e[5])&&(t.Low=e[5]),sa.IsNumber(e[6])&&(t.Price=e[6]),sa.IsNumber(e[7])&&(t.Vol=e[7]),sa.IsNumber(e[8])&&(t.Amount=e[8]),sa.IsNumber(e[9])&&(t.BuyPrice=e[9]),sa.IsNumber(e[10])&&(t.BuyVol=e[10]),sa.IsNumber(e[11])&&(t.SellPrice=e[11]),sa.IsNumber(e[12])&&(t.SellVol=e[12]),sa.IsNumber(e[13])&&(t.AvPrice=e[13]),sa.IsNumber(e[14])&&(t.OutShares=e[14]),sa.IsNumber(e[15])&&(t.TotalShares=e[15]),sa.IsNumber(e[16])&&(t.LimitHigh=e[16]),sa.IsNumber(e[17])&&(t.LimitLow=e[17]),sa.IsNumber(e[18])&&(t.VolIn=e[18]),sa.IsNumber(e[19])&&(t.VolOut=e[19]),sa.IsNumber(e[20])&&(t.DealNum=e[20]),sa.IsNumber(e[21])&&(t.Increase=e[21]),sa.IsNumber(e[22])&&(t.UpDown=e[22]),sa.IsNumber(e[23])&&(t.Exchange=e[23]),sa.IsNumber(e[24])&&(t.Amplitude=e[24]),sa.IsNumber(e[25])&&(t.CircMarketValue=e[25]),sa.IsNumber(e[26])&&(t.MarketValue=e[26]),e[27]&&(t.NameEx=e[27]),sa.IsNumber(e[21])||sa.IsNumber(t.Price)&&sa.IsNumber(t.YClose)&&0!=t.YClose&&(t.Increase=(t.Price-t.YClose)/t.YClose*100),sa.IsNumber(e[22])||sa.IsNumber(t.Price)&&sa.IsNumber(t.YClose)&&(t.UpDown=t.Price-t.YClose),sa.IsNumber(e[23])||sa.IsNumber(t.Vol)&&sa.IsNumber(t.OutShares)&&t.OutShares>0&&(t.Exchange=t.Vol/t.OutShares*100),sa.IsNumber(e[24])||sa.IsNumber(t.High)&&sa.IsNumber(t.Low)&&sa.IsNumber(t.YClose)&&0!=t.YClose&&(t.Amplitude=(t.High-t.Low)/t.YClose*100),sa.IsNumber(e[25])||sa.IsNumber(t.OutShares)&&sa.IsNumber(t.Price)&&(t.CircMarketValue=t.OutShares*t.Price),sa.IsNumber(e[26])||sa.IsNumber(t.TotalShares)&&sa.IsNumber(t.Price)&&(t.MarketValue=t.TotalShares*t.Price),e[30]&&(t.ExtendData=e[30]),e[31]&&this.BlockData.set(t.OriginalSymbol,e[31]),e[32]&&(t.CloseLine=e[32]),e[33]&&(t.KLine=e[33]),sa.IsNumber(e[35])&&(t.Time=e[35]),sa.IsNumber(e[36])&&(t.Date=e[36]),sa.IsBool(e[37])&&(t.Checked=e[37]),sa.IsNumber(e[38])&&(t.Position=e[38]),sa.IsNumber(e[39])&&(t.FClose=e[39]),sa.IsNumber(e[40])&&(t.YFClose=e[40]),sa.IsNumber(e[41])&&(t.OpenPosition=e[41]),sa.IsNumber(e[42])&&(t.ClosePosition=e[42]),sa.IsNumber(e[43])&&(t.RSpeed1M=e[43]),sa.IsNumber(e[44])&&(t.RSpeed3M=e[44]),sa.IsNumber(e[45])&&(t.RSpeed5M=e[45]),sa.IsNumber(e[46])&&(t.RSpeed10M=e[46]),sa.IsNumber(e[47])&&(t.RSpeed15M=e[47]),sa.IsNumber(e[101])&&(t.ReserveNumber1=e[101]),sa.IsNumber(e[102])&&(t.ReserveNumber2=e[102]),sa.IsNumber(e[103])&&(t.ReserveNumber3=e[103]),sa.IsNumber(e[104])&&(t.ReserveNumber4=e[104]),sa.IsNumber(e[105])&&(t.ReserveNumber5=e[105]),sa.IsNumber(e[106])&&(t.ReserveNumber6=e[106]),sa.IsNumber(e[107])&&(t.ReserveNumber7=e[107]),sa.IsNumber(e[108])&&(t.ReserveNumber8=e[108]),sa.IsNumber(e[109])&&(t.ReserveNumber9=e[109]),sa.IsNumber(e[110])&&(t.ReserveNumber10=e[110]),sa.IsString(e[201])&&(t.ReserveString1=e[201]),sa.IsString(e[202])&&(t.ReserveString2=e[202]),sa.IsString(e[203])&&(t.ReserveString3=e[203]),sa.IsString(e[204])&&(t.ReserveString4=e[204]),sa.IsString(e[205])&&(t.ReserveString5=e[205]),sa.IsString(e[206])&&(t.ReserveString6=e[206]),sa.IsString(e[207])&&(t.ReserveString7=e[207]),sa.IsString(e[208])&&(t.ReserveString8=e[208]),sa.IsString(e[209])&&(t.ReserveString9=e[209]),sa.IsString(e[210])&&(t.ReserveString10=e[210]),(sa.IsNumber(e[301])||sa.IsObject(e[301]))&&(t.ReserveProgressBar1=e[301]),(sa.IsNumber(e[302])||sa.IsObject(e[302]))&&(t.ReserveProgressBar2=e[302]),(sa.IsNumber(e[303])||sa.IsObject(e[303]))&&(t.ReserveProgressBar3=e[303]),(sa.IsNumber(e[304])||sa.IsObject(e[304]))&&(t.ReserveProgressBar4=e[304]),(sa.IsNumber(e[305])||sa.IsObject(e[305]))&&(t.ReserveProgressBar5=e[305]),(sa.IsNumber(e[306])||sa.IsObject(e[306]))&&(t.ReserveProgressBar6=e[306]),(sa.IsNumber(e[307])||sa.IsObject(e[307]))&&(t.ReserveProgressBar7=e[307]),(sa.IsNumber(e[308])||sa.IsObject(e[308]))&&(t.ReserveProgressBar8=e[308]),(sa.IsNumber(e[309])||sa.IsObject(e[309]))&&(t.ReserveProgressBar9=e[309]),(sa.IsNumber(e[310])||sa.IsObject(e[310]))&&(t.ReserveProgressBar10=e[310]),sa.IsObject(e[351])&&(t.ReserveButton1=e[351]),sa.IsObject(e[352])&&(t.ReserveButton2=e[352]),sa.IsObject(e[353])&&(t.ReserveButton3=e[353]),sa.IsObject(e[354])&&(t.ReserveButton4=e[354]),sa.IsObject(e[355])&&(t.ReserveButton5=e[355]),sa.IsObject(e[356])&&(t.ReserveButton6=e[356]),sa.IsObject(e[357])&&(t.ReserveButton7=e[357]),sa.IsObject(e[358])&&(t.ReserveButton8=e[358]),sa.IsObject(e[359])&&(t.ReserveButton9=e[359]),sa.IsObject(e[360])&&(t.ReserveButton10=e[360])},this.GetSymbolNoSuffix=function(t){var e=t.lastIndexOf(".");return e>0?t.substring(0,e):t},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate){var e=this,a=2,i=this.GetEventCallback(m.ON_REPORT_MARKET_STATUS);if(i&&i.Callback){var r={MarketStatus:2};i.Callback(i,r,this),sa.IsNumber(r.MarketStatus)&&(a=r.MarketStatus)}if(0!=a&&3!=a){var n=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),n):2==a&&(this.AutoUpdateTimer=setTimeout((function(){e.UpdateStockData()}),n))}}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.OnSize=function(){this.Frame&&(this.SetSizeChange(!0),this.Draw(),this.DelayUpdateStockData())},this.SetSizeChange=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&(a.SizeChange=t)}},this.OnWheel=function(t){if(u.Chart.Log("[JSReportChartContainer::OnWheel]",t),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var e,a=t.clientX-this.UIElement.getBoundingClientRect().left,i=t.clientY-this.UIElement.getBoundingClientRect().top;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),e=this.Canvas.isPointInPath(a,i),e){var r=this.ChartPaint[0];if(r){var n=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(n=-.01*t.deltaY),1==this.WheelPageType?(console.log("[OnWheel] wheelValue=".concat(n)),n<0?(this.LastMouseStatus.TooltipStatus=null,this.HideAllTooltip(),this.GotoNextItem(1)&&(this.Draw(),this.DelayUpdateStockData())):n>0&&(this.LastMouseStatus.TooltipStatus=null,this.HideAllTooltip(),this.GotoNextItem(-1)&&(this.Draw(),this.DelayUpdateStockData()))):n<0?(this.LastMouseStatus.TooltipStatus=null,this.HideAllTooltip(),this.GotoNextPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData())):n>0&&(this.LastMouseStatus.TooltipStatus=null,this.HideAllTooltip(),this.GotoPreviousPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData())),t.preventDefault?t.preventDefault():t.returnValue=!1}}}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this.GetReportChart();if(e){var a=t.keyCode?t.keyCode:t.which,i=this.GetEventCallback(m.ON_KEYDOWN);if(i&&i.Callback){var r={e:t,KeyID:a,PreventDefault:!1,ReportChart:e};if(i.Callback(i,r,this),r.PreventDefault)return}if(116!=a){switch(this.HideAllTooltip(),a){case 33:this.GotoPreviousPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData());break;case 34:this.GotoNextPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData());break;case 38:var n=this.MoveSelectedRow(-1,{EnablePageCycle:this.PageUpDownCycle});n&&(n.Redraw&&this.Draw(),n.Update&&this.DelayUpdateStockData(),this.MoveSelectedRowEvent(n.OldIndex,n.NewIndex));break;case 40:n=this.MoveSelectedRow(1,{EnablePageCycle:this.PageUpDownCycle});n&&(n.Redraw&&this.Draw(),n.Update&&this.DelayUpdateStockData(),this.MoveSelectedRowEvent(n.OldIndex,n.NewIndex));break;case 37:this.MoveXOffset(-1)&&this.Draw();break;case 39:this.MoveXOffset(1)&&this.Draw();break}t.preventDefault?t.preventDefault():t.returnValue=!1}}}},this.UIOnDblClick=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=this.ChartPaint[0];r&&r.OnDblClick(a,i,t)},this.UIOnMouseDown=function(t){var e=this;this.DragXScroll=null,this.DragYScroll=null,this.DragHeader=null,this.DragColumnWidth=null,this.DragMove={Click:{X:t.clientX,Y:t.clientY},Move:{X:t.clientX,Y:t.clientY},PreMove:{X:t.clientX,Y:t.clientY}};var a=F(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a,n=this.ChartPaint[0];if(n){var o=n.PtInHeaderDragBorder(i,r);if(o)this.DragColumnWidth={ClickPoint:{X:i,Y:r},LastPoint:{X:i,Y:r},ClickData:o,ColumnWidth:o.Column.Width};else{var s=n.OnMouseDown(i,r,t);if(!s)return;if(2!=s.Type&&4!=s.Type||0!=t.button&&2!=t.button){if(3==s.Type&&0==t.button)this.DragHeader={ClickPoint:{X:i,Y:r},Click:{X:t.clientX,Y:t.clientY},ClickData:s,LastMove:{X:t.clientX,Y:t.clientY},MovePoint:null,MoveToData:null};else if(1==s.Type&&0==t.button){var h=s.Tab;1==h.Type?this.MoveXOffset(-1)&&this.Draw():2==h.Type?this.MoveXOffset(1)&&this.Draw():3==h.Type?this.DragXScroll={Click:{X:i,Y:r},LastMove:{X:i,Y:r}}:4==h.Type?this.SetXOffset(h.Pos)&&this.Draw():5==h.Type&&this.OnClickTab(h,t)}else if(5==s.Type&&0==t.button){var l=s.VScrollbar;1==l.Type?this.MoveYOffset(-1)&&(this.Draw(),this.DelayUpdateStockData()):2==l.Type?this.MoveYOffset(1)&&(this.Draw(),this.DelayUpdateStockData()):3==l.Type?this.DragYScroll={Click:{X:i,Y:r},LastMove:{X:i,Y:r}}:4==l.Type&&this.SetYOffset(l.Pos)&&(this.Draw(),this.DelayUpdateStockData())}}else 0==t.button&&2==s.Type&&this.EnableDragRow&&this.SortInfo.Sort<=0&&(this.DragRow={Click:{X:t.clientX,Y:t.clientY},LastMove:{X:t.clientX,Y:t.clientY},Data:s}),1==s.Redraw&&this.Draw()}}document.onmousemove=function(t){e.DocOnMouseMove(t)},document.onmouseup=function(t){e.DocOnMouseUp(t)}},this.UIOnMounseUp=function(t){console.log('"UIOnMounseUp')},this.UIOnContextMenu=function(t){if(t.preventDefault(),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.IsShowRightMenu){var e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top;"function"==typeof this.OnRightMenu&&this.OnRightMenu(e,a,t)}},this.OnRightMenu=function(t,e,a){this.PopupRightMenu(t,e,a)},this.PtInReportChart=function(t,e){var a=this.GetReportChart();if(!a)return null;var i=a.PtInHeader(t,e);return i?{Type:3,Row:i,X:t,Y:e}:(i=a.PtInFixedBody(t,e),i?{Type:4,Row:i,X:t,Y:e}:(i=a.PtInBody(t,e),i?{Type:2,Row:i,X:t,Y:e}:{Type:-1,Row:null,X:t,Y:e}))},this.PopupRightMenu=function(t,e,a){var i=this,r=F(),n=this.PtInReportChart(t*r,e*r);if(n&&this.JSPopMenu){n.e=a;var o={Menu:null,Position:JSPopMenu.POSITION_ID.RIGHT_MENU_ID,ClickCallback:function(t){i.OnClickRightMenu(t)}},s=this.GetEventCallback(m.ON_CREATE_RIGHT_MENU);if(s&&s.Callback){var h={MenuData:o,Data:n};s.Callback(s,h,this)}o.Menu&&this.PopupMenuByRClick(o,t,e)}},this.PopupMenuByRClick=function(t,e,a){if(this.JSPopMenu){var i=this.UIElement.getBoundingClientRect(),r=w();e+=i.left+r.Left,a+=i.top+r.Top,this.JSPopMenu.CreatePopMenu(t),this.JSPopMenu.PopupMenuByRight(e,a)}},this.OnClickRightMenu=function(t){if(u.Chart.Log("[JSReportChartContainer::OnClickRightMenu] ",t),t&&t.Data){var e=t.Data.ID,a=t.Data.Args,i=this.GetEventCallback(m.ON_MENU_COMMAND);if(i&&i.Callback){t={PreventDefault:!1,CommandID:e,Args:a,SrcData:t};if(i.Callback(i,t,this),t.PreventDefault)return}this.ExecuteMenuCommand(e,a)}},this.UIOnMouseMove=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=this.LastMouseStatus.MouseOnStatus;this.LastMouseStatus.OnMouseMove=null;this.LastMouseStatus.TooltipStatus,this.LastMouseStatus.TooltipStatus=null;var n=!1,o=!1,s=null;if(!this.DragRow&&!this.DrawHeader&&!this.DragColumnWidth){var h=this.GetTabChart(),l=!1;if(h){var C=h.PtInTab(a,i);if(C){var D=C.Index;h.MoveOnTabIndex!=D&&(h.MoveOnTabIndex=D,l=!0)}else h.MoveOnTabIndex>=0&&(h.MoveOnTabIndex=-1,l=!0)}this.LastMouseStatus.OnMouseMove={X:a,Y:i};var f={Cursor:"default",Name:"Default"},c=this.GetReportChart(),m=!1;if(c){var d=c.PtInHeaderDragBorder(a,i);if(d)f={Cursor:"col-resize",Name:"DragHeaderWidth"},u.Chart.Log("[JSReportChartContainer::UIOnMouseMove] drag column width ",d);else{var I=c.GetButtonData(a,i),S=null;I&&(f={Cursor:"pointer",Name:"Botton"},1!=I.Type&&0!=I.Type&&2!=I.Type||(S={Index:I.Index,ColumnIndex:I.ColumnIndex})),!r&&S||r&&!S?m=!0:r&&S&&(r.Index==S.Index&&r.ColumnIndex==S.ColumnIndex||(m=!0));var T=c.GetTooltipData(a,i);T&&(20==T.Type?T.Stock&&T.Stock.Symbol&&(o=!0,s={Symbol:T.Stock.OriginalSymbol,Rect:T.Rect}):21==T.Type?T.Stock&&T.Stock.Symbol&&(n=!0,s={Symbol:T.Stock.OriginalSymbol,Rect:T.Rect}):(this.LastMouseStatus.TooltipStatus={X:a,Y:i,Data:T,ClientX:t.clientX,ClientY:t.clientY},!0))}var v=c.VScrollbar;if(v.Enable){var p=c.PtInClient(a,i);this.IsShowVScrollbar=p,this.DragYScroll||(p&&!v.LastStatus.Draw||!p&&v.LastStatus.Draw)&&(m=!0)}}if(f&&(this.UIElement.style.cursor=f.Cursor),(m||l)&&this.Draw(),this.LastMouseStatus.TooltipStatus){var g=t.clientX-this.UIElement.getBoundingClientRect().left,x=t.clientY-this.UIElement.getBoundingClientRect().top;this.DrawFloatTooltip({X:g,Y:x,YMove:20/e},this.LastMouseStatus.TooltipStatus.Data)}else this.HideFloatTooltip();n||this.HideKLineChartTooltip(),o||this.HideMinuteChartTooltip(),o&&this.ShowMinuteChartTooltip(null,null,s),n&&this.ShowKLineChartTooltip(null,null,s)}},this.UIOnMounseOut=function(t){this.HideAllTooltip();var e=!1,a=this.GetTabChart();a&&a.MoveOnTabIndex>=0&&(a.MoveOnTabIndex=-1,e=!0,this.Draw());var i=this.GetVScrollbarChart();i.Enable&&(this.IsShowVScrollbar=!1,this.DragYScroll||i.LastStatus.Draw&&(e=!0)),e&&this.Draw()},this.UIOnMouseleave=function(t){this.HideAllTooltip();var e=this.GetTabChart();e&&e.MoveOnTabIndex>=0&&(e.MoveOnTabIndex=-1,this.Draw())},this.DocOnMouseMove=function(t){if(this.DragMove.PreMove.X=this.DragMove.Move.X,this.DragMove.PreMove.Y=this.DragMove.Move.Y,this.DragMove.Move.X=t.clientX,this.DragMove.Move.Y=t.clientX,this.DragMove.Move.X==this.DragMove.PreMove.X&&this.DragMove.Move.Y==this.DragMove.PreMove.Y||this.StopAutoDragScrollTimer(),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(this.DragRow){var r=this.DragRow,n=r.LastMove.Y-t.clientY;if(Math.abs(n)<2)return;var o=this.GetReportChart();if(r.LastMove.X=t.clientX,r.LastMove.Y=t.clientY,r.Inside={X:a,Y:i},o){var s=o.OnDragRow(a,i,t);if(s)if(2==s.Type)s.Data.DataIndex!=r.Data.Row.DataIndex&&(r.MoveRow=s);else if(7==s.Type){var h=o.GetCurrentPageStatus();h.IsEnd||(this.MoveYOffset(1,!1),r.MoveRow=null,this.EnablePageScroll=!0,this.AutoScrollPage(2))}else 5==s.Type&&this.Data.YOffset>0&&(this.MoveYOffset(-1,!1),r.MoveRow=null,this.EnablePageScroll=!0,this.AutoScrollPage(-2));o.DragRow=r}this.Draw()}else if(this.DragXScroll){var l=this.ChartPaint[0];if(!l||!l.Tab)return;this.DragXScroll.LastMove.X=a,this.DragXScroll.LastMove.Y=i;var u=l.Tab.GetScrollPostionByPoint(a,i);this.SetXOffset(u)&&this.Draw()}else if(this.DragYScroll){l=this.ChartPaint[0];if(!l||!l.VScrollbar)return;this.DragYScroll.LastMove.X=a,this.DragYScroll.LastMove.Y=i;u=l.VScrollbar.GetScrollPostionByPoint(a,i);this.SetYOffset(u)&&(this.Draw(),this.DelayUpdateStockData())}else if(this.DragHeader&&this.DragHeader.ClickData){if(this.DragHeader.ClickData.Header.IsFixed)return;if(!this.EnableDragHeader)return;var C=t.clientX-this.DragHeader.Click.X,D=t.clientY-this.DragHeader.Click.Y;if(Math.abs(D)<=1&&Math.abs(C)<=1)return;o=this.GetReportChart();var f=this.DragHeader.ClickData;this.DragHeader.LastMove.X=t.clientX,this.DragHeader.LastMove.Y=t.clientY,this.DragHeader.MovePoint?(this.DragHeader.MovePoint.X=a,this.DragHeader.MovePoint.Y=i):this.DragHeader.MovePoint={X:a,Y:i};var c=o.OnDragHeader(a,i,t);if(!c)return;if(1!=c.Type)return;c.Header.Index!=f.Header.Index&&(this.DragHeader.MoveToData=c),o.DragHeader=this.DragHeader,this.Draw()}else if(this.DragColumnWidth&&this.DragColumnWidth.ClickData){C=a-this.DragColumnWidth.ClickPoint.X;if(Math.abs(C)<1)return;var d=this.DragColumnWidth.ColumnWidth+C;if(d<=10)return;var I=this.DragColumnWidth.ClickData.Index,S=this.GetEventCallback(m.ON_REPORT_DRAG_COLUMN_WIDTH);if(S&&S.Callback){var T={Index:I,Width:d,PreventDefault:!1};if(this.DragColumnWidth&&this.DragColumnWidth.ClickData&&(T.Column=this.DragColumnWidth.ClickData.Column),S.Callback(S,T,this),T.PreventDefault)return}this.SetColumnFixedWidth(I,d),this.DragColumnWidth.LastPoint.X=a,this.DragColumnWidth.LastPoint.Y=i}}},this.SetColumnFixedWidth=function(t,e){var a=this.ChartPaint[0];if(a){var i=a.Column[t];i&&(i.FixedWidth=e,this.SetSizeChange(!0),this.Draw())}},this.DocOnMouseUp=function(t){document.onmousemove=null,document.onmouseup=null,this.StopAutoDragScrollTimer(),this.HideAllTooltip();var e=this.GetReportChart(),a={Cursor:"default",Name:"Default"},i=!1;this.DragRow&&(e&&(this.OnDragRow(),e.DragRow=null),i=!0);var r=this.DragHeader;if(this.DragHeader=null,this.DragXScroll=null,this.DragYScroll&&(i=!0,this.DragYScroll=null),this.DragRow=null,this.DragMove=null,this.DragColumnWidth=null,e.DragHeader&&(i=!0,e.DragHeader=null),i&&this.Draw(),r){var n=r.ClickData,o=r.MoveToData;n&&o?this.SwapColumn(n.Header.Index,o.Header.Index,{Redraw:!0}):this.OnClickHeader(n,t)}a&&(this.UIElement.style.cursor=a.Cursor)},this.OnDragRow=function(){if(this.SourceData&&sa.IsNonEmptyArray(this.SourceData.Data)&&this.DragRow&&this.DragRow.MoveRow){var t=this.DragRow,e=t.Data.Row.DataIndex,a=t.MoveRow.Data.DataIndex;if(!(e==a||e<0||a<0)){var i=this.SourceData.Data;if(!(e>=i.length||a>=i.length)){var r=this.GetEventCallback(m.ON_REPORT_DRAG_ROW);if(r){var n={Symbol:this.Symbol,Src:{Index:e,Symbol:i[e]},To:{Index:a,Symbol:i[a]},PreventDefault:!1};if(r.Callback(r,n,this),n.PreventDefault)return}if(1==this.DragRowType){var o=i[e];i[e]=i[a],i[a]=o,this.Data.Data=i.slice(0)}else{var s=i[e];i.splice(e,1),i.splice(a,0,s),this.Data.Data=i.slice(0)}var h=this.GetReportChart();h&&(0==h.SelectedModel?h.SelectedRow=t.MoveRow.Data.Index:h.SelectedRow=t.MoveRow.Data.DataIndex)}}}},this.IsPhoneDragging=function(t){var e=t.changedTouches.length,a=t.touches.length;return 1==e&&1==a},this.GetTouchData=function(t){for(var e=[],a=F(),i=0;i<t.touches.length;++i){var r=t.touches[i],n={clientX:r.clientX*a,clientY:r.clientY*a,pageX:r.pageX*a,pageY:r.pageY*a,InsideX:(r.clientX-this.UIElement.getBoundingClientRect().left)*a,InsideY:(r.clientY-this.UIElement.getBoundingClientRect().top)*a};e.push(n)}return e},this.GetMoveAngle=function(t,e){var a=Math.abs(t.X-e.X),i=Math.abs(t.Y-e.Y),r=180*Math.atan(a/i)/Math.PI;return r},this.PreventTouchEvent=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},this.OnTouchStart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0;var e=this.GetReportChart();if(e&&this.IsPhoneDragging(t)){var a={Click:{},LastMove:{},InsideClick:{}},i=this.GetTouchData(t);a.Click.X=i[0].clientX,a.Click.Y=i[0].clientY,a.InsideClick.X=i[0].InsideX,a.InsideClick.Y=i[0].InsideY,a.LastMove.X=i[0].clientX,a.LastMove.Y=i[0].clientY,a.IsXMove=!1,a.IsYMove=!1,e.IsPtInBody(a.InsideClick.X,a.InsideClick.Y)&&(this.TouchDrag=a),this.TouchInfo={InsideClick:{X:i[0].InsideX,Y:i[0].InsideY},Click:{X:i[0].clientX,Y:i[0].clientY}},this.PreventTouchEvent(t)}}},this.OnDragYOffset=function(t,e,a,i){if(a<5)return!1;var r=!0;t.LastMove.Y<e[0].clientY&&(r=!1);var n=this.YStepPixel;n<=0&&(n=5);var o=parseInt(a/n);return!(o<=0)&&(0==r&&(o*=-1),this.MoveYOffset(o,this.DragPageCycle)&&(t.IsYMove=!0,this.Draw(),this.DelayUpdateStockData()),!0)},this.OnDragXOffset=function(t,e,a,i){if(a<5)return!1;var r=!0;t.LastMove.X<e[0].clientX&&(r=!1);var n=this.XStepPixel;n<=0&&(n=5);var o=parseInt(a/n);return!(o<=0)&&(r||(o*=-1),this.MoveXOffset(o)&&(t.IsXMove=!0,this.Draw()),!0)},this.OnTouchMove=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this.GetReportChart();if(e){var a=this.GetTouchData(t);if(this.IsPhoneDragging(t)){var i=this.TouchDrag;if(this.TouchInfo.Move={X:a[0].clientX,Y:a[0].clientY},i){this.PreventTouchEvent(t);var r=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),n=Math.abs(i.LastMove.X-a[0].clientX),o=Math.abs(i.LastMove.Y-a[0].clientY);if(1==i.IsYMove){if(this.ShowPageInfo(!0),!this.OnDragYOffset(i,a,o,t))return}else if(1==i.IsXMove){if(!this.OnDragXOffset(i,a,n,t))return}else if(o>0&&r<this.TouchMoveMinAngle){if(this.ShowPageInfo(!0),!this.OnDragYOffset(i,a,o,t))return}else{if(!(n>0&&r>=this.TouchMoveMinAngle))return;if(!this.OnDragXOffset(i,a,n,t))return}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}}}},this.OnTouchEnd=function(t){u.Chart.Log("[JSReportChartContainer:OnTouchEnd]",t),this.ChartSplashPaint&&1==this.ChartSplashPaint.IsEnableSplash||(this.ShowPageInfo(!1),this.OnTouchClick(this.TouchInfo,t),this.IsOnTouch=!1,this.TouchDrag=null,this.TouchInfo=null)},this.OnTouchClick=function(t,e){if(!t||!t.Click)return!1;if(t.Move)return!1;var a=t.InsideClick,i=this.GetReportChart();if(!i)return!1;var r=i.OnMouseDown(a.X,a.Y,e);if(!r)return!1;2==r.Type||4==r.Type?1==r.Redraw&&this.Draw():3==r.Type&&this.OnClickHeader(r,e),u.Chart.Log("[JSReportChartContainer:OnTouchClick] clickData",r)},this.GetTabChart=function(){var t=this.ChartPaint[0];return t?t.Tab:null},this.GetVScrollbarChart=function(){var t=this.ChartPaint[0];return t?t.VScrollbar:null},this.GetReportChart=function(){var t=this.ChartPaint[0];return t},this.GotoNextItem=function(t){if(0==t)return!1;if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize();if(a>this.Data.Data.length)return!1;var i=0;if(t>0)for(var r=0;r<t;++r){if(this.Data.YOffset+a>=this.Data.Data.length)break;++this.Data.YOffset,++i}else if(t<0){t=Math.abs(t);for(r=0;r<t;++r){if(this.Data.YOffset<=0)break;--this.Data.YOffset,++i}}return i>0},this.GotoNextPage=function(t){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize(),i=e.GetAllRowCount();if(a>i)return!1;if(this.Data.YOffset+a>=i)return!0===t&&(this.Data.YOffset=0,!0);this.Data.YOffset+=a;var r=i-this.Data.YOffset;return 0==e.SelectedModel&&e.SelectedRow>r-1&&(e.SelectedRow=r-1),!0},this.GotoPreviousPage=function(t){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize(),i=e.GetAllRowCount();if(a>i)return!1;if(this.Data.YOffset<=0)return!0===t&&(this.Data.YOffset=i-a,!0);var r=this.Data.YOffset;return r-=a,r<0&&(r=0),this.Data.YOffset=r,!0},this.MoveYOffset=function(t,e){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var a=this.ChartPaint[0];if(!a)return!1;var i=a.GetCurrentPageStatus();if(i.IsSinglePage)return!1;if(t>0){var r=this.Data.Data.length,n=i.PageSize,o=this.Data.YOffset;if(e)for(var s=0;s<t;++s)++o,o+n>r&&(o=0);else{if(o+n>=r)return!1;for(s=0;s<t;++s){if(o+n+1>r)break;++o}}return this.Data.YOffset=o,!0}if(t<0){t=Math.abs(t);o=this.Data.YOffset;if(e)for(n=i.PageSize,s=0;s<t;++s)--o,o<0&&(o=this.Data.Data.length-n);else{if(this.Data.YOffset<=0)return!1;for(s=0;s<t;++s){if(o-1<0)break;--o}}return this.Data.YOffset=o,!0}return!1},this.MoveSelectedRow=function(t,e){var a=this.ChartPaint[0];if(!a)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;var i=!1;e&&sa.IsBool(e.EnablePageCycle)&&(i=e.EnablePageCycle);var r={Redraw:!1,Update:!1,OldIndex:-1,NewIndex:-1};if(1==a.MultiSelectModel){var n=a.GetCurrentPageStatus();if(sa.IsNonEmptyArray(n.MultiSelectedRow)){var o=n.MultiSelectedRow[0];if(t>0){if(o==this.Data.Data.length-1)return r;if(o<0||o<n.Start||o>n.End)return a.MultiSelectedRow=[n.Start],r.Redraw=!0,r;for(var s=this.Data.YOffset,h=0;h<t;++h)++o,o>n.End&&++s,o>=this.Data.Data.length&&(o=0,s=0);return r.Redraw=!0,r.Update=s!=this.Data.YOffset,a.MultiSelectedRow=[o],this.Data.YOffset=s,r}if(t<0){if(0==o)return r;if(o<0||o<n.Start||o>n.End)return a.MultiSelectedRow=[n.End],r.Redraw=!0,r;t=Math.abs(t);for(s=this.Data.YOffset,h=0;h<t;++h)--o,o<n.Start&&--s,o<0&&(o=this.Data.Data.length-1,s=this.Data.Data.length-l,s<0&&(s=0));return r.Redraw=!0,r.Update=s!=this.Data.YOffset,a.MultiSelectedRow=[o],this.Data.YOffset=s,r}return null}o=-1;if(t>0)o=n.Start;else{if(!(t<0))return null;o=n.End}return a.MultiSelectedRow=[o],r.Redraw=!0,r}if(0==a.SelectedModel){n=a.GetCurrentPageStatus();var l=n.End-n.Start+1;o=n.SelectedRow;if(r.OldIndex=this.Data.YOffset+o,t>0)return o+=t,o%=l,a.SelectedRow=o,a.SelectedFixedRow=-1,r.Redraw=!0,r.NewIndex=this.Data.YOffset+o,r;if(t<0)return o+=t,o<0&&(o%=l,o=l+o),a.SelectedRow=o,a.SelectedFixedRow=-1,r.NewIndex=this.Data.YOffset+o,r.Redraw=!0,r}else if(1==a.SelectedModel){n=a.GetCurrentPageStatus(),l=n.PageSize,o=n.SelectedRow;if(r.OldIndex=n.SelectedRow,t>0){if(o<0||o<n.Start||o>n.End)return a.SelectedRow=n.Start,r.Redraw=!0,r.NewIndex=n.Start,r;for(s=this.Data.YOffset,h=0;h<t;++h){if(o+1>=this.Data.Data.length&&!i)break;++o,o>n.End&&++s,o>=this.Data.Data.length&&(o=0,s=0)}return r.Redraw=!0,r.Update=s!=this.Data.YOffset,a.SelectedRow=o,this.Data.YOffset=s,r.NewIndex=o,r}if(t<0){if(o<0||o<n.Start||o>n.End)return a.SelectedRow=n.End,r.Redraw=!0,r.NewIndex=n.End,r;t=Math.abs(t);for(s=this.Data.YOffset,h=0;h<t;++h){if(o<=0&&!i)break;--o,o<n.Start&&--s,o<0&&(o=this.Data.Data.length-1,s=this.Data.Data.length-l,s<0&&(s=0))}return r.Redraw=!0,r.Update=s!=this.Data.YOffset,a.SelectedRow=o,this.Data.YOffset=s,r.NewIndex=o,r}}return null},this.MoveSelectedRowEvent=function(t,e){var a=this.ChartPaint[0];if(!a)return null;if(t!=e){var i=this.GetEventCallback(m.ON_MOVE_SELECTED_REPORT_ROW);if(i&&i.Callback&&sa.IsNonEmptyArray(a.Data.Data)){var r=a.Data.Data,n=null,o=null;if(t>=0&&t<r.length){var s=r[t];n={Symbol:s,Index:t}}if(e>=0&&e<r.length){s=r[e];o={Symbol:s,Index:e}}var h={Old:n,Now:o};i.Callback(i,h,this)}}},this.MoveXOffset=function(t){var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetXScrollRange();if(a<=0)return!1;if(t>0){if(this.Data.XOffset>=a)return!1;for(var i=0;i<t;++i){if(this.Data.XOffset>=a)break;++this.Data.XOffset}return!0}if(t<0){if(this.Data.XOffset<=0)return!1;t=Math.abs(t);for(i=0;i<t;++i){if(this.Data.XOffset-1<0)break;--this.Data.XOffset}return!0}return!1},this.SetXOffset=function(t){if(!sa.IsNumber(t))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetXScrollRange();return t<0&&(t=0),t>a&&(t=a),this.Data.XOffset=t,!0},this.SetYOffset=function(t){if(!sa.IsNumber(t))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetYScrollRange();return t<0&&(t=0),t>a&&(t=a),this.Data.YOffset=t,!0},this.GotoLastPage=function(){var t=this.ChartPaint[0];if(t){var e=t.GetPageSize(!0),a=this.Data.Data.length-e;a<0&&(a=0),this.Data.DataOffset=a}},this.SetColumn=function(t,e){var a=this.ChartPaint[0];a&&(a.SetColumn(t),a.SizeChange=!0,e&&e.Redraw&&this.Draw())},this.SetTab=function(t,e){var a=this.ChartPaint[0];if(a){var i=a.Tab;i&&(i.SetTabList(t),e&&e.Redraw&&this.Draw())}},this.SetVScrollbar=function(t){var e=this.GetReportChart();if(e){var a=e.VScrollbar;a&&a.SetOption(t)}},this.SetSelectedTab=function(t,e){var a=this.ChartPaint[0];if(a){var i=a.Tab;i&&(i.SelectedTabIndex=t)}},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}t&&(t.Redraw||t.Draw)&&(this.SetSizeChange(!0),this.Draw()),this.TooltipMinuteChart&&this.TooltipMinuteChart.ReloadResource(t),this.TooltipKLineChart&&this.TooltipKLineChart.ReloadResource(t)},this.SortColumn=function(t,e){var a=this;if(t<0)return!1;var i=this.GetReportChart();if(!i)return!1;var r=i.Column[t];if(!r)return!1;if(1!=r.Sort&&2!=r.Sort)return!1;var n={Field:t,Sort:e};if(this.Data.Virtual&&this.Data.Virtual.Enable)return this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Data.YOffset=0,this.ResetReportSelectStatus(),this.RequestVirtualStockData(),!0;if(0==n.Sort)this.Data.Data=[],sa.IsNonEmptyArray(this.SourceData.Data)&&(this.Data.Data=this.SourceData.Data.slice());else if(1==n.Sort||2==n.Sort)if(1==r.Sort){var o=this.GetEventCallback(m.ON_REPORT_LOCAL_SORT);if(o&&o.Callback){var s={Column:r,SortInfo:n,SymbolList:this.Data.Data,Result:null};o.Callback(o,s,this),Array.isArray(s.Result)&&(this.Data.Data=s.Result)}else this.Data.Data.sort((function(t,e){return a.LocalSort(t,e,r,n.Sort)}))}else if(2==r.Sort){if(!sa.IsNonEmptyArray(this.Data.Data))return;return this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Data.YOffset=0,this.ResetReportSelectStatus(),this.RequestStockSortData(r,n.Field,n.Sort),!0}return this.Data.YOffset=0,this.ResetReportSelectStatus(),this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Draw(),this.DelayUpdateStockData(),!0},this.OnClickHeader=function(t,e){var a=this,i=t.Header;if(i.Column&&i.Column.EnablePopupHeaderMenu)this.PopupHeaderMenu(t,e);else if(i.Column&&(1==i.Column.Sort||2==i.Column.Sort)){var r=i.Index,n={Field:this.SortInfo.Field,Sort:this.SortInfo.Sort},o=i.Column.SortType;if(n.Field!=r)n.Field=r,n.Sort=o[0];else if(1==o.length)n.Sort=o[0];else for(var s=0;s<o.length;++s)if(n.Sort==o[s]){n.Sort=o[(s+1)%o.length];break}if(1==i.Column.Sort||2==i.Column.Sort){if(0==n.Sort){this.Data.Data=[];for(s=0;s<this.SourceData.Data.length;++s)this.Data.Data.push(this.SourceData.Data[s])}else if(1==i.Column.Sort){var h=this.GetEventCallback(m.ON_REPORT_LOCAL_SORT);if(h&&h.Callback){var l={Column:i.Column,SortInfo:n,SymbolList:this.Data.Data,Result:null};h.Callback(h,l,this),Array.isArray(l.Result)&&(this.Data.Data=l.Result)}else this.Data.Data.sort((function(t,e){return a.LocalSort(t,e,i.Column,n.Sort)}))}else if(2==i.Column.Sort){if(!sa.IsNonEmptyArray(this.Data.Data))return;return this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Data.YOffset=0,this.ResetReportSelectStatus(),void this.RequestStockSortData(i.Column,n.Field,n.Sort)}this.Data.YOffset=0,this.ResetReportSelectStatus(),this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Draw(),this.DelayUpdateStockData()}}},this.PopupHeaderMenu=function(t,e){var a=this;if(this.JSPopMenu&&this.GetEventCallback){var i=this.GetEventCallback(m.ON_CREATE_REPORT_HEADER_MENU);if(i&&i.Callback){var r=t.Header,n=r.Column,o={Menu:null,Position:JSPopMenu.POSITION_ID.DROPDOWN_MENU_ID,ClickCallback:function(t){a.OnClickHeaderMenu(n,t)}},s={MenuData:o,Column:n,Index:r.Index,PreventDefault:!1,e:e};i.Callback(i,s,this),1!=s.PreventDefault&&o.Menu&&this.PopupMenuByDrapdown(o,r.Rect)}}},this.PopupMenuByDrapdown=function(t,e){if(this.JSPopMenu){var a=F(),i={Left:e.Left/a,Right:e.Right/a,Bottom:e.Bottom/a,Top:e.Top/a};i.Width=i.Right-i.Left,i.Height=i.Bottom-i.Top;var r=this.UIElement.getBoundingClientRect(),n=w(),o=r.left+n.Left,s=r.top+n.Top;i.Left+=o,i.Right+=o,i.Top+=s,i.Bottom+=s,this.JSPopMenu.CreatePopMenu(t),this.JSPopMenu.PopupMenuByDrapdown(i)}},this.GetTabPopMenu=function(t){var e=[];if(sa.IsNonEmptyArray(t.ArySubMenu))for(var a=0;a<t.ArySubMenu.length;++a){var i=t.ArySubMenu[a],r={Name:i.Title,Data:{ID:i.CommandID,Args:[i.ID]}};i.Text&&(r.Text=i.Text),e.push(r)}return e},this.PopupTabMenu=function(t,e,a){if(this.JSPopMenu){var i=e.Rect,r=F(),n={Left:i.Left/r,Right:i.Right/r,Bottom:i.Bottom/r,Top:i.Top/r};n.Width=n.Right-n.Left,n.Height=n.Bottom-n.Top;var o=this.UIElement.getBoundingClientRect(),s=w(),h=o.left+s.Left,l=o.top+s.Top;n.Left+=h,n.Right+=h,n.Top+=l,n.Bottom+=l,this.JSPopMenu.CreatePopMenu(t),this.JSPopMenu.PopupMenuByTab(n),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()}},this.OnClickTab=function(t,e){var a=this;if(t.Tab){var i=!1,r=F(),n=(e.clientX-this.UIElement.getBoundingClientRect().left)*r,o=(e.clientY,this.UIElement.getBoundingClientRect().top,{Left:this.UIElement.getBoundingClientRect().left,Top:this.UIElement.getBoundingClientRect().top});if(t.Tab.IsMenu){var s={Menu:this.GetTabPopMenu(t.Tab),Position:JSPopMenu.POSITION_ID.TAB_MENU_ID,ClickCallback:function(e){a.OnClickTabPopMenu(t,e)}},h=this.GetEventCallback(m.ON_CLICK_REPORT_TABMENU);if(h&&h.Callback){var l={MenuData:s,Tab:t,PreventDefault:!1,e:e};if(h.Callback(h,l,this),1==l.PreventDefault)return}this.PopupTabMenu(s,t.Tab,e)}else{h=this.GetEventCallback(m.ON_CLICK_REPORT_TAB);if(h&&h.Callback){l={Data:t,IsSide:{X:n,Y:n},UIElement:o,e:e,Redraw:i,PreventDefault:!1};if(h.Callback(h,l,this),sa.IsBool(l.Redraw)&&(i=l.Redraw),1==l.PreventDefault)return}t.Tab.CommandID==v.CMD_REPORT_CHANGE_BLOCK_ID&&(this.ExecuteMenuCommand(t.Tab.CommandID,[t.Tab.ID]),this.SetSelectedTab(t.Index),i=!0)}i&&this.Draw()}},this.OnClickTabPopMenu=function(t,e){u.Chart.Log("[JSReportChartContainer::OnClickTabPopMenu] ",t,e);var a=e.Data.ID,i=e.Data.Args,r=this.GetEventCallback(m.ON_MENU_COMMAND);if(r&&r.Callback){e={PreventDefault:!1,CommandID:a,Args:i,SrcData:e,TabData:t};if(r.Callback(r,e,this),e.PreventDefault)return}this.ExecuteMenuCommand(a,i),this.SetSelectedTab(t.Index),this.Draw()},this.OnClickHeaderMenu=function(t,e){u.Chart.Log("[JSReportChartContainer::OnClickHeaderMenu] ",t,e);var a=e.Data.ID,i=e.Data.Args,r=this.GetEventCallback(m.ON_MENU_COMMAND);if(r&&r.Callback){e={PreventDefault:!1,CommandID:a,Args:i,SrcData:e,MenuData:t};if(r.Callback(r,e,this),e.PreventDefault)return}this.ExecuteMenuCommand(a,i)},this.ExecuteMenuCommand=function(t,e){u.Chart.Log("[JSReportChartContainer::ExecuteMenuCommand] cmdID=, aryArgs=",t,e);var a=null,i=null;switch(sa.IsNonEmptyArray(e)&&(i=e[0],sa.IsNumber(e[0])&&(a=e[0])),t){case v.CMD_REPORT_CHANGE_BLOCK_ID:i&&this.ChangeSymbol(i);break;case v.CMD_REPORT_COLUMN_SORT_ID:sa.IsNumber(a)&&sa.IsNumber(e[1])&&this.SortColumn(a,e[1]);break;case v.CMD_REPORT_COLUMN_MOVE_ID:if(sa.IsNumber(a)&&sa.IsNumber(e[1])){var r=a,n=a+e[1];this.SwapColumn(r,n,{Redraw:!0})}break;case v.CMD_REPORT_COLUMN_DEL_ID:sa.IsNumber(a)&&this.DeleteColumn(a,{Redraw:!0});break;case v.CMD_REPORT_CHANGE_COLUMN_ID:null!=a&&e[1]&&this.ChangeColumn(a,e[1],{Redraw:!0});break}},this.ChangeColumn=function(t,e,a){if(!(t<0)&&e){var i=this.GetReportChart();i&&i.ChangeColumn(t,e)&&(this.SortInfo&&this.SortInfo.Field==t&&this.SortInfo.Sort>0&&(this.SortInfo.Field=-1,this.SortInfo.Sort=0,this.Data.Data=[],sa.IsNonEmptyArray(this.SourceData.Data)&&(this.Data.Data=this.SourceData.Data.slice())),a&&a.Redraw&&(this.SetSizeChange(!0),this.Draw()))}},this.SwapColumn=function(t,e,a){var i=this.GetReportChart();i&&i.SwapColumn(t,e)&&a&&a.Redraw&&(this.SetSizeChange(!0),this.Draw())},this.DeleteColumn=function(t,e){var a=this.GetReportChart();a&&a.DeleteColumn(t)&&e&&e.Redraw&&(this.SetSizeChange(!0),this.Draw())},this.LocalSort=function(t,e,a,i){switch(a.Type){case Hn.SYMBOL_ID:case Hn.NAME_ID:return this.LocalStringSort(t,e,a,i);case Hn.NAME_EX_ID:return this.LocalNameExSort(t,e,a,i);case Hn.PRICE_ID:case Hn.VOL_ID:case Hn.INCREASE_ID:case Hn.UPDOWN_ID:case Hn.BUY_PRICE_ID:case Hn.SELL_PRICE_ID:case Hn.AMOUNT_ID:case Hn.BUY_VOL_ID:case Hn.SELL_VOL_ID:case Hn.YCLOSE_ID:case Hn.OPEN_ID:case Hn.HIGH_ID:case Hn.LOW_ID:case Hn.AVERAGE_PRICE_ID:case Hn.OUTSTANDING_SHARES_ID:case Hn.TOTAL_SHARES_ID:case Hn.CIRC_MARKET_VALUE_ID:case Hn.MARKET_VALUE_ID:case Hn.EXCHANGE_RATE_ID:case Hn.AMPLITUDE_ID:case Hn.LIMIT_HIGH_ID:case Hn.LIMIT_LOW_ID:case Hn.FUTURES_POSITION_ID:case Hn.FUTURES_CLOSE_ID:case Hn.FUTURES_YCLOSE_ID:case Hn.FUTURES_OPEN_POSITION_ID:case Hn.FUTURES_CLOSE_POSITION_ID:case Hn.VOL_IN_ID:case Hn.VOL_OUT_ID:case Hn.DATE_ID:case Hn.RESERVE_NUMBER1_ID:case Hn.RESERVE_NUMBER2_ID:case Hn.RESERVE_NUMBER3_ID:case Hn.RESERVE_NUMBER4_ID:case Hn.RESERVE_NUMBER5_ID:case Hn.RESERVE_NUMBER6_ID:case Hn.RESERVE_NUMBER7_ID:case Hn.RESERVE_NUMBER8_ID:case Hn.RESERVE_NUMBER9_ID:case Hn.RESERVE_NUMBER10_ID:return this.LocalNumberSort(t,e,a,i);case Hn.CUSTOM_NUMBER_TEXT_ID:return this.LoacCustomNumberSort(t,e,a,i);case Hn.CUSTOM_STRING_TEXT_ID:return this.LoacCustomStringSort(t,e,a,i);case Hn.CUSTOM_DATETIME_TEXT_ID:return this.LoacCustomDateTimeSort(t,e,a,i);default:return 0}},this.GetStockExtendData=function(t,e){if(sa.IsNumber(e.DataIndex)){if(e.DataIndex<0)return null;var a=this.GetStockData(t);return a&&a.ExtendData?a.ExtendData[e.DataIndex]:null}if(sa.IsNumber(e.BlockIndex)){if(e.BlockIndex<0)return null;a=this.GetBlockData(t);return a?a[e.BlockIndex]:null}return null},this.LocalNameExSort=function(t,e,a,i){var r=this.GetStockData(t),n=this.GetStockData(e),o="",s="";return 2==i&&(o="啊啊啊啊啊",s="啊啊啊啊啊"),r&&r.Name&&(o=r.Name),n&&n.Name&&(s=n.Name),1==i?s<o?-1:s<o?1:0:o<s?-1:o>s?1:0},this.LocalStringSort=function(t,e,a,i){var r=this.GetStockData(t),n=this.GetStockData(e),o="",s="";2==i&&(o="啊啊啊啊啊",s="啊啊啊啊啊");var h=Yn.get(a.Type);return r&&r[h]&&(o=r[h]),n&&n[h]&&(s=n[h]),1==i?s<o?-1:s<o?1:0:o<s?-1:o>s?1:0},this.LocalNumberSort=function(t,e,a,i){var r=this.GetStockData(t),n=this.GetStockData(e),o=-99999999999999,s=-99999999999999;2==i&&(o=s=99999999999999);var h=Yn.get(a.Type);return r&&sa.IsNumber(r[h])&&(o=r[h]),n&&sa.IsNumber(n[h])&&(s=n[h]),1==i?s<o?-1:s<o?1:0:o<s?-1:o>s?1:0},this.LoacCustomNumberSort=function(t,e,a,i){var r=-99999999999999,n=-99999999999999;2==i&&(r=n=99999999999999);var o=this.GetStockExtendData(t,a);sa.IsNumber(o)&&(r=o);o=this.GetStockExtendData(e,a);return sa.IsNumber(o)&&(n=o),1==i?n<r?-1:n<r?1:0:r<n?-1:r>n?1:0},this.LoacCustomDateTimeSort=function(t,e,a,i){var r=-99999999999999,n=-99999999999999;2==i&&(r=n=99999999999999);var o=this.GetStockExtendData(t,a);sa.IsNumber(o)&&(r=o);o=this.GetStockExtendData(e,a);return sa.IsNumber(o)&&(n=o),1==i?n<r?-1:n<r?1:0:r<n?-1:r>n?1:0},this.LoacCustomStringSort=function(t,e,a,i){var r="",n="";2==i&&(n=r="啊啊啊啊啊");var o=this.GetStockExtendData(t,a);sa.IsString(o)&&(r=o);o=this.GetStockExtendData(e,a);return sa.IsString(o)&&(n=o),1==i?n<r?-1:n<r?1:0:r<n?-1:r>n?1:0},this.RequestStockSortData=function(t,e,a){var i=this.ChartPaint[0];if(i){var r=this,n=this.Data.YOffset,o=i.GetPageSize(),s=n+o;if(s>=this.Data.Data.length&&(s=this.Data.Data.length-1),this.NetworkFilter){var h={Name:"JSDealChartContainer::RequestStockSortData",Explain:"报价列表股票排序数据",Request:{Data:{range:{start:n,end:s,count:this.Data.Data.length},column:{name:t.Title,type:t.Type,index:e,ID:t.ID},sort:a,symbol:this.Symbol,name:this.Name,pageSize:o}},Self:this,PreventDefault:!1};if(i.FixedRowCount>0&&1==i.FixedRowData.Type){for(var l=[],u=0;u<i.FixedRowData.Symbol.length;++u){var C=i.FixedRowData.Symbol[u];C&&l.push(C)}h.Request.FixedSymbol=l}if(this.NetworkFilter(h,(function(t){r.RecvStockSortData(t),r.AutoUpdate()})),1==h.PreventDefault)return}}},this.RecvStockSortData=function(t){var e=[];if(sa.IsNonEmptyArray(t.data))for(var a=0;a<t.data.length;++a){var i=t.data[a],r=i[0];if(r){var n=null;this.MapStockData.has(r)?n=this.MapStockData.get(r):(n=new Gn,n.OriginalSymbol=r,n.Symbol=this.GetSymbolNoSuffix(r),this.MapStockData.set(r,n)),this.ReadStockJsonData(n,i),e.push(r)}}if(sa.IsNonEmptyArray(t.index))for(a=0;a<t.index.length;++a){var o=t.index[a],s=e[a],h=this.Data.Data[o];s!=h&&(this.Data.Data[o]=s)}if(t.Virtual){i=t.Virtual;sa.IsNumber(i.Count)&&(this.Data.Virtual.Count=i.Count)}var l=this.ChartPaint[0];if(l){this.Draw()}},this.RequestVirtualStockData=function(){var t=this.ChartPaint[0];if(t){var e=this,a=this.Data.YOffset,i=t.GetPageSize(),r=a+i,n=t.GetAllRowCount();if(r>=n&&(r=n-1),this.NetworkFilter){var o={range:{start:a,end:r,count:t.GetAllRowCount()},column:null,sort:0,symbol:this.Symbol,name:this.Name,pageSize:i};if(this.SortInfo&&this.SortInfo.Field>=0&&this.SortInfo.Sort>0){var s=t.Column[this.SortInfo.Field];o.column={name:s.Title,type:s.Type,index:this.SortInfo.Field,ID:s.ID},o.sort=this.SortInfo.Sort}var h={Name:"JSDealChartContainer::RequestVirtualStockData",Explain:"报价列表股票数据(虚拟表格)",Request:{Data:o},Self:this,PreventDefault:!1};if(t.FixedRowCount>0&&1==t.FixedRowData.Type){for(var l=[],u=0;u<t.FixedRowData.Symbol.length;++u){var C=t.FixedRowData.Symbol[u];C&&l.push(C)}h.Request.FixedSymbol=l}this.NetworkFilter(h,(function(t){e.RecvStockSortData(t),e.AutoUpdate()})),h.PreventDefault}}},this.ShowPageInfo=function(t){var e=this.ChartPaint[1];return!!e&&(e.IsShow=t,!0)}}function Vn(){this.ChartBorder,this.Canvas,this.BorderLine=null,this.BorderColor=qi.Report.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font,this.ReloadResource=function(t){this.BorderColor=qi.Report.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font},this.Draw=function(){var t=A(this.ChartBorder.GetLeft()),e=A(this.ChartBorder.GetTop()),a=A(this.ChartBorder.GetRight()),i=A(this.ChartBorder.GetBottom()),r=a-t,n=i-e;sa.IsNumber(this.BorderLine)?(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke()):(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,e,r,n))},this.DrawLogo=function(){var t=qi.FrameLogo.Text;if(sa.IsString(t)){this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="right",this.Canvas.textBaseline="bottom";var e=this.ChartBorder.GetRight()-30,a=this.ChartBorder.GetBottom()-5;this.Canvas.fillText(t,e,a)}}}Pn.Init=function(t){var e=new Pn(t);return e.OnSize(),e},Pn.SetStyle=function(t){t&&qi.SetStyle(t)},Pn.GetResource=function(){return qi};var Hn={SYMBOL_ID:0,NAME_ID:1,PRICE_ID:2,VOL_ID:3,INCREASE_ID:4,UPDOWN_ID:5,BUY_PRICE_ID:6,SELL_PRICE_ID:7,AMOUNT_ID:8,BUY_VOL_ID:9,SELL_VOL_ID:10,YCLOSE_ID:11,OPEN_ID:12,HIGH_ID:13,LOW_ID:14,AVERAGE_PRICE_ID:15,INDEX_ID:16,OUTSTANDING_SHARES_ID:17,TOTAL_SHARES_ID:18,CIRC_MARKET_VALUE_ID:19,MARKET_VALUE_ID:20,EXCHANGE_RATE_ID:21,AMPLITUDE_ID:22,LIMIT_HIGH_ID:23,LIMIT_LOW_ID:24,VOL_IN_ID:25,VOL_OUT_ID:26,NAME_EX_ID:27,CLOSE_LINE_ID:28,KLINE_ID:29,TIME_ID:31,DATE_ID:32,CHECKBOX_ID:33,FUTURES_POSITION_ID:34,FUTURES_CLOSE_ID:35,FUTURES_YCLOSE_ID:36,FUTURES_OPEN_POSITION_ID:37,FUTURES_CLOSE_POSITION_ID:38,RISING_SPEED_1M_ID:60,RISING_SPEED_3M_ID:61,RISING_SPEED_5M_ID:62,RISING_SPEED_10M_ID:63,RISING_SPEED_15M_ID:64,SYMBOL_NAME_V2_ID:98,SYMBOL_NAME_ID:99,CUSTOM_STRING_TEXT_ID:100,CUSTOM_NUMBER_TEXT_ID:101,CUSTOM_DATETIME_TEXT_ID:102,CUSTOM_ICON_ID:103,CUSTOM_CHECKBOX_ID:104,CUSTOM_BUTTON_ID:105,CUSTOM_PROGRESS_ID:106,CUSTOM_LINK_ID:107,MULTI_LINE_CONTAINER:108,RESERVE_NUMBER1_ID:201,RESERVE_NUMBER2_ID:202,RESERVE_NUMBER3_ID:203,RESERVE_NUMBER4_ID:204,RESERVE_NUMBER5_ID:205,RESERVE_NUMBER6_ID:206,RESERVE_NUMBER7_ID:207,RESERVE_NUMBER8_ID:208,RESERVE_NUMBER9_ID:209,RESERVE_NUMBER10_ID:210,RESERVE_STRING1_ID:301,RESERVE_STRING2_ID:302,RESERVE_STRING3_ID:303,RESERVE_STRING4_ID:304,RESERVE_STRING5_ID:305,RESERVE_STRING6_ID:306,RESERVE_STRING7_ID:307,RESERVE_STRING8_ID:308,RESERVE_STRING9_ID:309,RESERVE_STRING10_ID:310,RESERVE_PROGRESS_BAR1_ID:401,RESERVE_PROGRESS_BAR2_ID:402,RESERVE_PROGRESS_BAR3_ID:403,RESERVE_PROGRESS_BAR4_ID:404,RESERVE_PROGRESS_BAR5_ID:405,RESERVE_PROGRESS_BAR6_ID:406,RESERVE_PROGRESS_BAR7_ID:407,RESERVE_PROGRESS_BAR8_ID:408,RESERVE_PROGRESS_BAR9_ID:409,RESERVE_PROGRESS_BAR10_ID:410,RESERVE_BUTTON1_ID:451,RESERVE_BUTTON2_ID:452,RESERVE_BUTTON3_ID:453,RESERVE_BUTTON4_ID:454,RESERVE_BUTTON5_ID:455,RESERVE_BUTTON6_ID:456,RESERVE_BUTTON7_ID:457,RESERVE_BUTTON8_ID:458,RESERVE_BUTTON9_ID:459,RESERVE_BUTTON10_ID:460},Yn=new Map([[Hn.SYMBOL_ID,"Symbol"],[Hn.NAME_ID,"Name"],[Hn.PRICE_ID,"Price"],[Hn.INCREASE_ID,"Increase"],[Hn.UPDOWN_ID,"UpDown"],[Hn.VOL_ID,"Vol"],[Hn.BUY_PRICE_ID,"BuyPrice"],[Hn.SELL_PRICE_ID,"SellPrice"],[Hn.AMOUNT_ID,"Amount"],[Hn.BUY_VOL_ID,"BuyVol"],[Hn.SELL_VOL_ID,"SellVol"],[Hn.YCLOSE_ID,"YClose"],[Hn.OPEN_ID,"Open"],[Hn.HIGH_ID,"High"],[Hn.LOW_ID,"Low"],[Hn.AVERAGE_PRICE_ID,"AvPrice"],[Hn.OUTSTANDING_SHARES_ID,"OutShares"],[Hn.TOTAL_SHARES_ID,"TotalShares"],[Hn.CIRC_MARKET_VALUE_ID,"CircMarketValue"],[Hn.MARKET_VALUE_ID,"MarketValue"],[Hn.EXCHANGE_RATE_ID,"Exchange"],[Hn.AMPLITUDE_ID,"Amplitude"],[Hn.LIMIT_HIGH_ID,"LimitHigh"],[Hn.LIMIT_LOW_ID,"LimitLow"],[Hn.VOL_IN_ID,"VolIn"],[Hn.VOL_OUT_ID,"VolOut"],[Hn.NAME_EX_ID,"NameEx"],[Hn.DATE_ID,"Date"],[Hn.FUTURES_POSITION_ID,"Position"],[Hn.FUTURES_CLOSE_ID,"FClose"],[Hn.FUTURES_YCLOSE_ID,"YFClose"],[Hn.FUTURES_OPEN_POSITION_ID,"OpenPosition"],[Hn.FUTURES_CLOSE_POSITION_ID,"ClosePosition"],[Hn.RISING_SPEED_1M_ID,"RSpeed1M"],[Hn.RISING_SPEED_3M_ID,"RSpeed3M"],[Hn.RISING_SPEED_5M_ID,"RSpeed5M"],[Hn.RISING_SPEED_10M_ID,"RSpeed10M"],[Hn.RISING_SPEED_15M_ID,"RSpeed15M"],[Hn.RESERVE_NUMBER1_ID,"ReserveNumber1"],[Hn.RESERVE_NUMBER2_ID,"ReserveNumber2"],[Hn.RESERVE_NUMBER3_ID,"ReserveNumber3"],[Hn.RESERVE_NUMBER4_ID,"ReserveNumber4"],[Hn.RESERVE_NUMBER5_ID,"ReserveNumber5"],[Hn.RESERVE_NUMBER6_ID,"ReserveNumber6"],[Hn.RESERVE_NUMBER7_ID,"ReserveNumber7"],[Hn.RESERVE_NUMBER8_ID,"ReserveNumber8"],[Hn.RESERVE_NUMBER9_ID,"ReserveNumber9"],[Hn.RESERVE_NUMBER10_ID,"ReserveNumber10"],[Hn.RESERVE_STRING1_ID,"ReserveString1"],[Hn.RESERVE_STRING2_ID,"ReserveString2"],[Hn.RESERVE_STRING3_ID,"ReserveString3"],[Hn.RESERVE_STRING4_ID,"ReserveString4"],[Hn.RESERVE_STRING5_ID,"ReserveString5"],[Hn.RESERVE_STRING6_ID,"ReserveString6"],[Hn.RESERVE_STRING7_ID,"ReserveString7"],[Hn.RESERVE_STRING8_ID,"ReserveString8"],[Hn.RESERVE_STRING9_ID,"ReserveString9"],[Hn.RESERVE_STRING10_ID,"ReserveString10"],[Hn.RESERVE_PROGRESS_BAR1_ID,"ReserveProgressBar1"],[Hn.RESERVE_PROGRESS_BAR2_ID,"ReserveProgressBar2"],[Hn.RESERVE_PROGRESS_BAR3_ID,"ReserveProgressBar3"],[Hn.RESERVE_PROGRESS_BAR4_ID,"ReserveProgressBar4"],[Hn.RESERVE_PROGRESS_BAR5_ID,"ReserveProgressBar5"],[Hn.RESERVE_PROGRESS_BAR6_ID,"ReserveProgressBar6"],[Hn.RESERVE_PROGRESS_BAR7_ID,"ReserveProgressBar7"],[Hn.RESERVE_PROGRESS_BAR8_ID,"ReserveProgressBar8"],[Hn.RESERVE_PROGRESS_BAR9_ID,"ReserveProgressBar9"],[Hn.RESERVE_PROGRESS_BAR10_ID,"ReserveProgressBar10"],[Hn.RESERVE_BUTTON1_ID,"ReserveButton1"],[Hn.RESERVE_BUTTON2_ID,"ReserveButton2"],[Hn.RESERVE_BUTTON3_ID,"ReserveButton3"],[Hn.RESERVE_BUTTON4_ID,"ReserveButton4"],[Hn.RESERVE_BUTTON5_ID,"ReserveButton5"],[Hn.RESERVE_BUTTON6_ID,"ReserveButton6"],[Hn.RESERVE_BUTTON7_ID,"ReserveButton7"],[Hn.RESERVE_BUTTON8_ID,"ReserveButton8"],[Hn.RESERVE_BUTTON9_ID,"ReserveButton9"],[Hn.RESERVE_BUTTON10_ID,"ReserveButton10"]]);function kn(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartReport",this.UIElement,this.IsDrawFirst=!1,this.GetEventCallback,this.GetStockDataCallback,this.GetFlashBGDataCallback,this.GetBlockDataCallback,this.Data,this.FixedRowData,this.SortInfo,this.FixedColumn=2,this.FixedRowCount=0,this.IsShowHeader=!0,this.SizeChange=!0,this.SelectedModel=0,this.SelectedRow=-1,this.SelectedFixedRow=-1,this.SelectedStyle=1,this.IsDrawBorder=1,this.HeaderRowCount=1,this.MultiSelectModel=0,this.MultiSelectedRow=[],this.ShowSymbol=[],this.DragRow,this.DragHeader,this.Tab,this.VScrollbar,this.GlobalOption,this.TextOverflowStyle=0,this.UpColor=qi.Report.UpTextColor,this.DownColor=qi.Report.DownTextColor,this.UnchagneColor=qi.Report.UnchagneTextColor,this.BorderColor=qi.Report.BorderColor,this.SelectedColor=qi.Report.SelectedColor,this.SelectedLineConfig={Color:qi.Report.SelectedLine.Color,Width:qi.Report.SelectedLine.Width},this.HeaderFontConfig={Size:qi.Report.Header.Font.Size,Name:qi.Report.Header.Font.Name},this.HeaderColor=qi.Report.Header.Color,this.HeaderMergin={Left:qi.Report.Header.Mergin.Left,Right:qi.Report.Header.Mergin.Right,Top:qi.Report.Header.Mergin.Top,Bottom:qi.Report.Header.Mergin.Bottom},this.SortConfig={Size:qi.Report.SortIcon.Size,Family:qi.Report.SortIcon.Family,Arrow:qi.Report.SortIcon.Arrow.slice(),Color:qi.Report.SortIcon.Color.slice(),Margin:{Left:qi.Report.SortIcon.Margin.Left,Right:qi.Report.SortIcon.Margin.Right,Bottom:qi.Report.SortIcon.Margin.Bottom}},this.ItemFontConfig={Size:qi.Report.Item.Font.Size,Name:qi.Report.Item.Font.Name},this.ItemFixedFontConfg={Size:qi.Report.FixedItem.Font.Size,Name:qi.Report.FixedItem.Font.Name},this.ItemMergin={Left:qi.Report.Item.Mergin.Left,Right:qi.Report.Item.Mergin.Right,Top:qi.Report.Item.Mergin.Top,Bottom:qi.Report.Item.Mergin.Bottom},this.BarMergin={Top:qi.Report.Item.BarMergin.Top,Left:qi.Report.Item.BarMergin.Left,Right:qi.Report.Item.BarMergin.Right,Bottom:qi.Report.Item.BarMergin.Bottom},this.LimitDrawType=0,this.LimitBorderColor=qi.Report.LimitBorder.Color,this.LimitUpBGColor=qi.Report.LimitColor.UpColor,this.LimitDownBGColor=qi.Report.LimitColor.DownColor,this.LimitTextColor=qi.Report.LimitColor.TextColor,this.LimitMergin={Top:qi.Report.LimitBorder.Mergin.Top,Left:qi.Report.LimitBorder.Mergin.Left,Right:qi.Report.LimitBorder.Mergin.Right,Bottom:qi.Report.LimitBorder.Mergin.Bottom},this.DragRowColor=qi.Report.DragRow.Color,this.DragRowTextColor=qi.Report.DragRow.TextColor,this.DragMoveRowColor=qi.Report.DragRow.MoveRowColor,this.DragSrcRowColor=qi.Report.DragRow.SrcRowColor,this.CloseLineConfig={CloseColor:qi.Report.CloseLine.CloseColor,YCloseColor:qi.Report.CloseLine.YCloseColor,AreaColor:qi.Report.CloseLine.AreaColor},this.KLineConfig={UpColor:qi.Report.KLine.UpColor,DownColor:qi.Report.KLine.DownColor,UnchagneColor:qi.Report.KLine.UnchagneColor,DataWidth:qi.Report.KLine.DataWidth,DistanceWidth:qi.Report.KLine.DistanceWidth},this.CheckBoxConfig=P(qi.Report.CheckBox),this.LinkConfig=P(qi.Report.Link),this.ProgressBarConfig=P(qi.Report.ProgressBar),this.ButtonConfig=P(qi.Report.Button),this.ItemSymbolFontConfig={Size:qi.Report.Item.SymbolFont.Size,Name:qi.Report.Item.SymbolFont.Name},this.ItemNameFontConfg={Size:qi.Report.Item.NameFont.Size,Name:qi.Report.Item.NameFont.Name},this.NameSymbolV2Config=P(qi.Report.NameSymbolV2),this.HeaderFont=12*F()+"px 微软雅黑",this.SortFont=null,this.ItemFont=15*F()+"px 微软雅黑",this.ItemFontHeight=0,this.ItemFixedFont=15*F()+"px 微软雅黑",this.ItemSymbolFont=12*F()+"px 微软雅黑",this.ItemNameFont=15*F()+"px 微软雅黑",this.ItemNameHeight=0,this.ItemSymbolHeight=0,this.NameSymbolFont={Symbol:null,Name:null},this.RowCount=0,this.HeaderHeight=0,this.HeaderFontHeight=0,this.FixedRowHeight=0,this.RowHeight=0,this.ItemTextLines=1,this.BottomToolbarHeight=0,this.IsShowAllColumn=!1,this.DevicePixelRatio=F(),this.AryFullSelectedRow=[],this.Column=[{Type:Hn.INDEX_ID,Title:"序号",TextAlign:"center",Width:null,TextColor:qi.Report.FieldColor.Index,MaxText:"8888"},{Type:Hn.SYMBOL_ID,Title:"代码",TextAlign:"left",Width:null,TextColor:qi.Report.FieldColor.Symbol,MaxText:"888888"},{Type:Hn.NAME_ID,Title:"名称",TextAlign:"left",Width:null,TextColor:qi.Report.FieldColor.Name,MaxText:"擎擎擎擎"},{Type:Hn.INCREASE_ID,Title:"涨幅%",TextAlign:"right",Width:null,MaxText:"-888.88"}],this.RectClient={},this.TooltipRect=[],this.ButtonRect=[],this.LastMouseStatus,this.ReloadResource=function(t){this.DevicePixelRatio=F(),this.UpColor=qi.Report.UpTextColor,this.DownColor=qi.Report.DownTextColor,this.UnchagneColor=qi.Report.UnchagneTextColor,this.BorderColor=qi.Report.BorderColor,this.SelectedColor=qi.Report.SelectedColor,this.HeaderFontConfig={Size:qi.Report.Header.Font.Size,Name:qi.Report.Header.Font.Name},this.HeaderColor=qi.Report.Header.Color,this.HeaderMergin={Left:qi.Report.Header.Mergin.Left,Right:qi.Report.Header.Mergin.Right,Top:qi.Report.Header.Mergin.Top,Bottom:qi.Report.Header.Mergin.Bottom},this.ItemFontConfig={Size:qi.Report.Item.Font.Size,Name:qi.Report.Item.Font.Name},this.ItemMergin={Left:qi.Report.Item.Mergin.Left,Right:qi.Report.Item.Mergin.Right,Top:qi.Report.Item.Mergin.Top,Bottom:qi.Report.Item.Mergin.Bottom},this.BarMergin={Top:qi.Report.Item.BarMergin.Top,Left:qi.Report.Item.BarMergin.Left,Right:qi.Report.Item.BarMergin.Right,Bottom:qi.Report.Item.BarMergin.Bottom},this.LimitBorderColor=qi.Report.LimitBorder.Color,this.LimitMergin={Top:qi.Report.LimitBorder.Mergin.Top,Left:qi.Report.LimitBorder.Mergin.Left,Right:qi.Report.LimitBorder.Mergin.Right,Bottom:qi.Report.LimitBorder.Mergin.Bottom},this.DragRowColor=qi.Report.DragRow.Color,this.DragRowTextColor=qi.Report.DragRow.TextColor,this.DragMoveRowColor=qi.Report.DragRow.MoveRowColor,this.DragSrcRowColor=qi.Report.DragRow.SrcRowColor,this.SortConfig={Size:qi.Report.SortIcon.Size,Family:qi.Report.SortIcon.Family,Arrow:qi.Report.SortIcon.Arrow.slice(),Color:qi.Report.SortIcon.Color.slice(),Margin:{Left:qi.Report.SortIcon.Margin.Left,Bottom:qi.Report.SortIcon.Margin.Bottom}};for(var e=0;e<this.Column.length;++e){var a=this.Column[e];a.Type==Hn.INDEX_ID?a.TextColor=qi.Report.FieldColor.Index:a.Type==Hn.SYMBOL_ID?a.TextColor=qi.Report.FieldColor.Symbol:a.Type==Hn.NAME_ID?a.TextColor=qi.Report.FieldColor.Name:a.Type==Hn.VOL_ID||a.Type==Hn.BUY_VOL_ID||a.Type==Hn.SELL_VOL_ID?a.TextColor=qi.Report.FieldColor.Vol:a.Type==Hn.AMOUNT_ID?a.TextColor=qi.Report.FieldColor.Amount:a.Type==Hn.VOL_IN_ID?a.TextColor=qi.Report.DownTextColor:a.Type==Hn.VOL_OUT_ID?a.TextColor=qi.Report.UpTextColor:a.TextColor=qi.Report.FieldColor.Text}this.Tab&&this.Tab.ReloadResource(t),this.VScrollbar&&this.VScrollbar.ReloadResource(t),this.CheckBoxConfig=P(qi.Report.CheckBox),this.LinkConfig=P(qi.Report.Link),this.ProgressBarConfig=P(qi.Report.ProgressBar)},this.CreateColumnItem=function(t){var e=this.GetDefaultColunm(t.Type);if(!e)return null;if(t.Title&&(e.Title=t.Title),sa.IsNonEmptyArray(t.AryTitle)&&(e.AryTitle=t.AryTitle),t.TextAlign&&(e.TextAlign=t.TextAlign),t.TextColor&&(e.TextColor=t.TextColor),t.HeaderColor&&(e.HeaderColor=t.HeaderColor),t.MaxText&&(e.MaxText=t.MaxText),t.MaxText2&&(e.MaxText=t.MaxText2),sa.IsNumber(t.Space)&&(e.Space=t.Space),t.ID&&(e.ID=t.ID),t.FullColBGColor&&(e.FullColBGColor=t.FullColBGColor),t.HeaderBGColor&&(e.HeaderBGColor=t.HeaderBGColor),sa.IsNumber(t.Sort)&&(e.Sort=t.Sort),sa.IsNumber(t.FixedWidth)&&(e.FixedWidth=t.FixedWidth),sa.IsBool(t.EnableDragWidth)&&(e.EnableDragWidth=t.EnableDragWidth),e.IsDrawCallback=!1,sa.IsBool(t.IsDrawCallback)&&(e.IsDrawCallback=t.IsDrawCallback),sa.IsBool(t.EnableFormatDrawInfoEvent)&&(e.EnableFormatDrawInfoEvent=t.EnableFormatDrawInfoEvent),sa.IsNumber(t.FloatPrecision)&&(e.FloatPrecision=t.FloatPrecision),sa.IsNumber(t.ColorType)&&(e.ColorType=t.ColorType),t.Icon&&(e.Icon=t.Icon),sa.IsBool(t.EnableChartTooltip)&&(e.ChartTooltip={Enable:t.EnableChartTooltip,Type:20}),t.ChartTooltip&&(e.ChartTooltip={Enable:t.ChartTooltip.Enable,Type:t.ChartTooltip.Type}),sa.IsBool(t.EnablePopupHeaderMenu)&&(e.EnablePopupHeaderMenu=t.EnablePopupHeaderMenu),1!=t.Sort&&2!=t.Sort||(e.SortType=[1,2],sa.IsNonEmptyArray(t.SortType)&&(e.SortType=t.SortType.slice())),t.Type==Hn.CUSTOM_STRING_TEXT_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;e.FormatType=0,sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),sa.IsNumber(t.FormatType)&&(e.FormatType=t.FormatType)}else if(t.Type==Hn.CUSTOM_NUMBER_TEXT_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),e.Decimal=2,e.FormatType=0,e.ColorType=0,sa.IsNumber(t.Decimal)&&(e.Decimal=t.Decimal),sa.IsNumber(t.FormatType)&&(e.FormatType=t.FormatType),sa.IsNumber(t.ColorType)&&(e.ColorType=t.ColorType)}else if(t.Type==Hn.CUSTOM_DATETIME_TEXT_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),e.FormatType=0,e.ValueType=0,sa.IsNumber(t.FormatType)&&(e.FormatType=t.FormatType),sa.IsNumber(t.ValueType)&&(e.FormatType=t.ValueType)}else if(t.Type==Hn.CUSTOM_CHECKBOX_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),t.CheckBox?e.CheckBox=P(t.CheckBox):e.CheckBox=this.CheckBoxConfig}else if(t.Type==Hn.CUSTOM_BUTTON_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),t.Button?e.Button=P(t.Button):e.Button=this.ButtonConfig}else if(this.IsReserveButtonColumn(t.Type))t.Button?e.Button=P(t.Button):e.Button=this.ButtonConfig;else if(this.IsReserveNumber(t.Type))t.Format&&(e.Format=t.Format);else if(t.Type==Hn.CUSTOM_PROGRESS_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),t.ProgressBar?e.ProgressBar=P(t.ProgressBar):e.ProgressBar=this.ProgressBarConfig}else if(this.IsReserveProgressBarColumn(t.Type))t.ProgressBar?e.ProgressBar=P(t.ProgressBar):e.ProgressBar=this.ProgressBarConfig;else if(t.Type==Hn.CUSTOM_LINK_ID){if(!sa.IsNumber(t.DataIndex)&&!sa.IsNumber(t.BlockIndex))return null;sa.IsNumber(t.DataIndex)&&(e.DataIndex=t.DataIndex),sa.IsNumber(t.BlockIndex)&&(e.BlockIndex=t.BlockIndex),t.Link?e.Link=P(t.Link):e.Link=this.LinkConfig}else t.Type==Hn.CUSTOM_ICON_ID||(t.Type==Hn.CLOSE_LINE_ID?sa.IsBool(t.IsDrawArea)&&(e.IsDrawArea=t.IsDrawArea):t.Type==Hn.TIME_ID?sa.IsNumber(t.ValueType)&&(e.ValueType=t.ValueType):t.Type==Hn.DATE_ID?sa.IsNumber(t.FormatType)&&(e.FormatType=t.FormatType):t.Type==Hn.MULTI_LINE_CONTAINER&&sa.IsNonEmptyArray(t.AryField)&&(e.AryField=t.AryField.slice()));return e},this.SetColumn=function(t){if(sa.IsNonEmptyArray(t)){this.Column=[];for(var e=0;e<t.length;++e){var a=t[e],i=this.CreateColumnItem(a);i&&this.Column.push(i)}}},this.SwapColumn=function(t,e){if(!sa.IsNumber(t)||!sa.IsNumber(e))return!1;var a=this.Column.length;if(t<0||t>=a)return!1;if(e<0||e>=a)return!1;if(t!=e){var i=this.Column[t];return this.Column[t]=this.Column[e],this.Column[e]=i,!0}},this.DeleteColumn=function(t){return!!sa.IsNonEmptyArray(this.Column)&&(!(t<0||t>=this.Column.length)&&(this.Column.splice(t,1),!0))},this.ChangeColumn=function(t,e){if(t<0||t>=this.Column.length)return!1;var a=this.CreateColumnItem(e);return!!a&&(this.Column[t]=a,!0)},this.GetXScrollPos=function(){return this.Data.XOffset},this.GetXScrollRange=function(){var t=this.Column.length-this.FixedColumn-3;return t<0?0:t},this.GetYScrollRange=function(){if(!sa.IsNonEmptyArray(this.Data.Data))return 0;var t=this.GetAllRowCount(),e=t-this.RowCount;return e},this.GetDefaultColunm=function(t){for(var e=[{Type:Hn.INDEX_ID,Title:"序号",TextAlign:"center",Width:null,TextColor:qi.Report.FieldColor.Index,MaxText:"8888"},{Type:Hn.SYMBOL_ID,Title:"代码",TextAlign:"left",Width:null,TextColor:qi.Report.FieldColor.Symbol,MaxText:"888888"},{Type:Hn.NAME_ID,Title:"名称",TextAlign:"left",Width:null,TextColor:qi.Report.FieldColor.Name,MaxText:"擎擎擎擎0"},{Type:Hn.NAME_EX_ID,Title:"名称",TextAlign:"left",Width:null,TextColor:qi.Report.FieldColor.Name,MaxText:"擎擎擎擎擎擎"},{Type:Hn.SYMBOL_NAME_ID,Title:"股票名称",TextAlign:"left",Width:null,TextColor:qi.Report.FieldColor.Name,MaxText:"擎擎擎擎0"},{Type:Hn.SYMBOL_NAME_V2_ID,Title:"名称/代码",TextAlign:"left",Width:null,TextColor:qi.Report.NameSymbolV2.Name.Color,MaxText:"擎擎擎擎*",MaxText2:"999999",Space:5,TextColor2:qi.Report.NameSymbolV2.Symbol.Color},{Type:Hn.INCREASE_ID,Title:"涨幅%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.PRICE_ID,Title:"现价",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.UPDOWN_ID,Title:"涨跌",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.AMPLITUDE_ID,Title:"振幅%",TextAlign:"right",Width:null,MaxText:"888.88"},{Type:Hn.BUY_PRICE_ID,Title:"买价",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.SELL_PRICE_ID,Title:"卖价",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.AVERAGE_PRICE_ID,Title:"均价",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.OPEN_ID,Title:"今开",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.HIGH_ID,Title:"最高",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.LOW_ID,Title:"最低",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.YCLOSE_ID,Title:"昨收",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:Hn.VOL_ID,Title:"总量",TextAlign:"right",TextColor:qi.Report.FieldColor.Vol,Width:null,MaxText:"8888.8擎"},{Type:Hn.AMOUNT_ID,Title:"总金额",TextAlign:"right",TextColor:qi.Report.FieldColor.Amount,Width:null,MaxText:"8888.8擎"},{Type:Hn.EXCHANGE_RATE_ID,Title:"换手%",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"88.88擎"},{Type:Hn.OUTSTANDING_SHARES_ID,Title:"流通股本",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"8888.8擎"},{Type:Hn.TOTAL_SHARES_ID,Title:"总股本",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"8888.8擎"},{Type:Hn.CIRC_MARKET_VALUE_ID,Title:"流通市值",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"8888.8擎"},{Type:Hn.MARKET_VALUE_ID,Title:"总市值",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"8888.8擎"},{Type:Hn.VOL_IN_ID,Title:"内盘",TextAlign:"right",TextColor:qi.Report.DownTextColor,Width:null,MaxText:"8888.8擎"},{Type:Hn.VOL_OUT_ID,Title:"外盘",TextAlign:"right",TextColor:qi.Report.UpTextColor,Width:null,MaxText:"8888.8擎"},{Type:Hn.CLOSE_LINE_ID,Title:"走势",TextAlign:"center",TextColor:qi.Report.CloseLineColor,Width:null,MaxText:"88888.88888"},{Type:Hn.BUY_VOL_ID,Title:"买量",TextAlign:"right",TextColor:qi.Report.FieldColor.Vol,Width:null,MaxText:"8888.8擎"},{Type:Hn.SELL_VOL_ID,Title:"卖量",TextAlign:"right",TextColor:qi.Report.FieldColor.Vol,Width:null,MaxText:"8888.8擎"},{Type:Hn.CUSTOM_STRING_TEXT_ID,Title:"自定义",TextAlign:"center",Width:null,TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎"},{Type:Hn.CUSTOM_NUMBER_TEXT_ID,Title:"自定义",TextAlign:"center",Width:null,TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎"},{Type:Hn.CUSTOM_DATETIME_TEXT_ID,Title:"自定义",TextAlign:"center",Width:null,TextColor:qi.Report.FieldColor.Text,MaxText:"9999-99-99"},{Type:Hn.CUSTOM_ICON_ID,Title:"  ",TextAlign:"left",FixedWidth:20,TextColor:qi.Report.FieldColor.Text},{Type:Hn.KLINE_ID,Title:"K线",TextAlign:"left",FixedWidth:50,TextColor:qi.Report.FieldColor.Text},{Type:Hn.TIME_ID,Title:"时间",TextAlign:"left",ValueType:0,TextColor:qi.Report.FieldColor.Text,MaxText:"99:99:99.999"},{Type:Hn.DATE_ID,Title:"日期",TextAlign:"left",FormatType:0,TextColor:qi.Report.FieldColor.Text,MaxText:"9999-99-99"},{Type:Hn.CHECKBOX_ID,Title:"",TextAlign:"center",FixedWidth:20*F()},{Type:Hn.CUSTOM_CHECKBOX_ID,Title:"",TextAlign:"center",FixedWidth:20*F()},{Type:Hn.CUSTOM_BUTTON_ID,Title:"",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.CUSTOM_PROGRESS_ID,Title:"进度条",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.CUSTOM_LINK_ID,Title:"链接地址",TextAlign:"center",MaxText:"擎擎擎擎擎"},{Type:Hn.FUTURES_POSITION_ID,Title:"持仓量",TextAlign:"right",TextColor:qi.Report.FieldColor.Vol,Width:null,MaxText:"8888888"},{Type:Hn.FUTURES_CLOSE_ID,Title:"结算价",TextAlign:"right",Width:null,MaxText:"8888888"},{Type:Hn.FUTURES_YCLOSE_ID,Title:"昨结算价",TextAlign:"right",Width:null,MaxText:"8888888"},{Type:Hn.FUTURES_OPEN_POSITION_ID,Title:"开仓量",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"8888888"},{Type:Hn.FUTURES_CLOSE_POSITION_ID,Title:"平仓量",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,Width:null,MaxText:"8888888"},{Type:Hn.RISING_SPEED_1M_ID,Title:"涨速%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.RISING_SPEED_3M_ID,Title:"3分涨速%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.RISING_SPEED_5M_ID,Title:"5分涨速%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.RISING_SPEED_10M_ID,Title:"10分涨速%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.RISING_SPEED_15M_ID,Title:"15分涨速%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:Hn.MULTI_LINE_CONTAINER,Title:"涨幅",TextAlign:"right",MaxText:"1000.00%",AryField:[{Type:Hn.PRICE_ID},{Type:Hn.INCREASE_ID,DynamicFormat:"{Value}%"}]},{Type:Hn.RESERVE_NUMBER1_ID,Title:"数值1",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER2_ID,Title:"数值2",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER3_ID,Title:"数值3",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER4_ID,Title:"数值4",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER5_ID,Title:"数值5",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER6_ID,Title:"数值6",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER7_ID,Title:"数值7",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER8_ID,Title:"数值8",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER9_ID,Title:"数值9",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_NUMBER10_ID,Title:"数值10",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"9999.99",FloatPrecision:2},{Type:Hn.RESERVE_STRING1_ID,Title:"文字1",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING2_ID,Title:"文字2",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING3_ID,Title:"文字3",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING4_ID,Title:"文字4",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING5_ID,Title:"文字5",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING6_ID,Title:"文字6",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING7_ID,Title:"文字7",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING8_ID,Title:"文字8",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING9_ID,Title:"文字9",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_STRING10_ID,Title:"文字10",TextAlign:"right",TextColor:qi.Report.FieldColor.Text,MaxText:"擎擎擎擎擎擎"},{Type:Hn.RESERVE_PROGRESS_BAR1_ID,Title:"进度条1",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR2_ID,Title:"进度条2",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR3_ID,Title:"进度条3",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR4_ID,Title:"进度条4",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR5_ID,Title:"进度条5",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR6_ID,Title:"进度条6",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR7_ID,Title:"进度条7",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR8_ID,Title:"进度条8",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR9_ID,Title:"进度条9",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_PROGRESS_BAR10_ID,Title:"进度条10",TextAlign:"center",FixedWidth:100*F()},{Type:Hn.RESERVE_BUTTON1_ID,Title:"按钮1",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON2_ID,Title:"按钮2",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON3_ID,Title:"按钮3",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON4_ID,Title:"按钮4",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON5_ID,Title:"按钮5",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON6_ID,Title:"按钮6",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON7_ID,Title:"按钮7",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON8_ID,Title:"按钮8",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON9_ID,Title:"按钮9",TextAlign:"center",FixedWidth:50*F()},{Type:Hn.RESERVE_BUTTON10_ID,Title:"按钮10",TextAlign:"center",FixedWidth:50*F()}],a=0;a<e.length;++a){var i=e[a];if(i.Type==t)return i}return null},this.ClipClient=function(){this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(this.RectClient.Left,this.RectClient.Top,this.RectClient.Right-this.RectClient.Left,this.RectClient.Bottom-this.RectClient.Top),this.Canvas.clip()},this.Draw=function(t){if(this.ShowSymbol=[],this.TooltipRect=[],this.ButtonRect=[],this.AryFullSelectedRow=[],this.DevicePixelRatio=F(),this.LastMouseStatus=t,this.GlobalOption&&(this.GlobalOption.FlashBGCount=0),this.SizeChange?this.CalculateSize():this.UpdateCacheData(),this.ClipClient(),this.DrawDragHeaderBG(),this.DrawHeader(),this.DrawBody(),this.Canvas.restore(),this.Tab&&this.BottomToolbarHeight>0){var e=this.ChartBorder.GetBottom();this.Tab.DrawTab(this.RectClient.Left,e-this.BottomToolbarHeight,this.RectClient.Right,e),this.Tab.DrawScrollbar(this.RectClient.Left,e-this.BottomToolbarHeight,this.RectClient.Right,e)}if(this.ClipClient(),this.DrawBorder(),this.DrawSelectedRow(),this.Canvas.restore(),this.DrawDragRow(),this.DrawDragHeader(),this.VScrollbar){e=this.ChartBorder.GetBottom();this.VScrollbar.DrawScrollbar(this.RectClient.Left,this.RectClient.Top+this.HeaderHeight,this.RectClient.Right,e-this.BottomToolbarHeight-4)}this.LastMouseStatus=null,this.SizeChange=!1,this.AryFullSelectedRow=[]},this.DrawDragHeaderBG=function(){if(this.DragHeader){for(var t=this.RectClient.Left,e=(this.RectClient.Right,this.RectClient.Top),a=e+this.HeaderHeight+this.RowHeight*this.RowCount+this.FixedRowHeight*this.FixedRowCount,i=t,r=0;r<this.FixedColumn&&r<this.Column.length;++r){var n=this.Column[r];i+=n.Width}for(r=this.FixedColumn+this.Data.XOffset;r<this.Column.length;++r){n=this.Column[r];if(this.DragHeader){if(this.DragHeader.ClickData){var o=this.DragHeader.ClickData;if(o.Header.Index==r){var s={Left:i,Top:e,Bottom:a,Right:i+n.Width};s.Width=s.Right-s.Left,s.Height=s.Bottom-s.Top,this.Canvas.fillStyle=this.DragSrcRowColor,this.Canvas.fillRect(s.Left,s.Top,s.Width,s.Height)}}if(this.DragHeader.MoveToData){var h=this.DragHeader.MoveToData;if(h.Header.Index==r){s={Left:i,Top:e,Bottom:a,Right:i+n.Width};s.Width=s.Right-s.Left,s.Height=s.Bottom-s.Top,this.Canvas.fillStyle=this.DragMoveRowColor,this.Canvas.fillRect(s.Left,s.Top,s.Width,s.Height)}}}i+=n.Width}}},this.UpdateCacheData=function(){this.RectClient.Left=this.ChartBorder.GetLeft(),this.RectClient.Right=this.ChartBorder.GetRight(),this.RectClient.Top=this.ChartBorder.GetTop(),this.RectClient.Bottom=this.ChartBorder.GetBottom()-this.BottomToolbarHeight},this.GetPageSize=function(t){t&&this.CalculateSize();var e=this.RowCount;return e},this.GetCurrentPageStatus=function(){var t={Start:this.Data.YOffset,PageSize:this.RowCount,IsEnd:!1,SelectedRow:this.SelectedRow,IsSinglePage:!1,DataCount:0,MultiSelectModel:this.MultiSelectModel};return 1==this.MultiSelectModel&&(t.SelectedRow=-1,t.MultiSelectedRow=this.MultiSelectedRow.slice(),t.MultiSelectedRow.sort((function(t,e){return t>e}))),sa.IsNonEmptyArray(this.Data.Data)?(t.End=this.Data.YOffset+this.RowCount-1,t.IsSinglePage=this.Data.Data.length<=this.RowCount,t.DataCount=this.Data.Data.length,t.End>=this.Data.Data.length-1&&(t.IsEnd=!0),t.End>=this.Data.Data.length&&(t.End=this.Data.Data.length-1)):(t.Start=0,t.End=0,t.IsEnd=!0,t.IsSinglePage=!0),t},this.CalculateSize=function(){this.Tab&&this.Tab.IsShow?(this.Tab.CalculateSize(),this.BottomToolbarHeight=this.Tab.Height):this.BottomToolbarHeight=0,this.VScrollbar&&this.VScrollbar.Enable&&this.VScrollbar.CalculateSize(),this.UpdateCacheData();var t=F();this.HeaderFont="".concat(this.HeaderFontConfig.Size*t,"px ").concat(this.HeaderFontConfig.Name),this.ItemFont="".concat(this.ItemFontConfig.Size*t,"px ").concat(this.ItemFontConfig.Name),this.ItemFixedFont="".concat(this.ItemFixedFontConfg.Size*t,"px ").concat(this.ItemFixedFontConfg.Name),this.ItemSymbolFont="".concat(this.ItemSymbolFontConfig.Size*t,"px ").concat(this.ItemSymbolFontConfig.Name),this.ItemNameFont="".concat(this.ItemNameFontConfg.Size*t,"px ").concat(this.ItemNameFontConfg.Name),this.NameSymbolFont.Symbol="".concat(this.NameSymbolV2Config.Symbol.Size*t,"px ").concat(this.NameSymbolV2Config.Symbol.Name),this.NameSymbolFont.Name="".concat(this.ItemSymbolFontConfig.Name.Size*t,"px ").concat(this.NameSymbolV2Config.Name.Name),this.ItemFontHeight=this.GetFontHeight(this.ItemFont,"擎"),this.RowHeight=this.ItemFontHeight+this.ItemMergin.Top+this.ItemMergin.Bottom,this.ItemTextLines=1,this.FixedRowHeight=this.GetFontHeight(this.ItemFixedFont,"擎")+this.ItemMergin.Top+this.ItemMergin.Bottom,this.SortFont="".concat(this.SortConfig.Size*t,"px ").concat(this.SortConfig.Family),this.Canvas.font=this.ItemFont;for(var e=0,a=0;a<this.Column.length;++a){var i=this.Column[a];if(i.Type==Hn.SYMBOL_NAME_ID){this.Canvas.font=this.ItemNameFont;var r=this.Canvas.measureText(i.MaxText).width,n=this.GetFontHeight(this.ItemNameFont,"擎");this.ItemNameHeight=n,this.Canvas.font=this.ItemSymbolFont;var o=this.Canvas.measureText(i.MaxText).width,s=this.GetFontHeight(this.ItemSymbolFont,"擎");this.ItemSymbolHeight=s,this.Canvas.font=this.ItemFont,e=Math.max(r,o),i.Width=e+4+this.ItemMergin.Left+this.ItemMergin.Right;var h=n+s+this.ItemMergin.Top+this.ItemMergin.Bottom;this.ItemTextLines=2,h>this.RowHeight&&(this.RowHeight=h),h>this.FixedRowHeight&&(this.FixedRowHeight=h)}else if(i.Type==Hn.MULTI_LINE_CONTAINER){e=sa.IsNumber(i.FixedWidth)?i.FixedWidth:this.Canvas.measureText(i.MaxText).width,i.Width=e+4+this.ItemMergin.Left+this.ItemMergin.Right,this.ItemTextLines=i.AryField.length;h=this.ItemFontHeight*i.AryField.length+this.ItemMergin.Top+this.ItemMergin.Bottom;h>this.RowHeight&&(this.RowHeight=h),h>this.FixedRowHeight&&(this.FixedRowHeight=h)}else if(i.Type==Hn.SYMBOL_NAME_V2_ID){this.Canvas.font,this.NameSymbolFont.Name;r=this.Canvas.measureText(i.MaxText).width,n=this.GetFontHeight(this.ItemNameFont,"擎");this.Canvas.font,this.NameSymbolFont.Symbol;o=this.Canvas.measureText(i.MaxText2).width,s=this.GetFontHeight(this.ItemSymbolFont,"擎");this.ItemNameHeight=Math.abs(n,s);var l=2;sa.IsNumber(i.Space)&&(l=i.Space),e=r+o+l,i.Width=e+4+this.ItemMergin.Left+this.ItemMergin.Right}else e=sa.IsNumber(i.FixedWidth)?i.FixedWidth:this.Canvas.measureText(i.MaxText).width,i.Width=e+4+this.ItemMergin.Left+this.ItemMergin.Right;if(i.Icon&&i.Icon.Symbol&&(i.Width+=i.Icon.Size,i.Icon.Margin)){var u=i.Icon.Margin;sa.IsNumber(u.Left)&&(i.Width+=u.Left),sa.IsNumber(u.Right)&&(i.Width+=u.Right)}}this.Canvas.font=this.HeaderFont;for(a=0;a<this.Column.length;++a){i=this.Column[a];if(i.Title&&!(i.Title.length<=0)){var C=i.Title;e=this.Canvas.measureText(C).width,i.Sort>0&&(e+=this.SortConfig.Size*t),e+=4+this.HeaderMergin.Left+this.HeaderMergin.Right,i.Width<e&&(i.Width=e)}}this.HeaderFontHeight=this.GetFontHeight(this.HeaderFont,"擎"),this.HeaderRowCount<=1?this.HeaderHeight=this.HeaderFontHeight+(this.HeaderMergin.Top+this.HeaderMergin.Bottom):this.HeaderHeight=this.HeaderFontHeight*this.HeaderRowCount+(this.HeaderMergin.Top+this.HeaderMergin.Bottom),this.IsShowHeader||(this.HeaderHeight=0),this.FixedRowCount<=0&&(this.FixedRowHeight=0),this.RowCount=parseInt((this.RectClient.Bottom-this.RectClient.Top-this.HeaderHeight-this.FixedRowHeight*this.FixedRowCount)/this.RowHeight);var D=0,f=this.RectClient.Right-this.RectClient.Left;for(a=0;a<this.Column.length;++a){i=this.Column[a];D+=i.Width}this.IsShowAllColumn=D<f},this.DrawHeaderItem=function(t,e,a,i){t.HeaderBGColor&&this.DrawItemBG({Rect:e,BGColor:t.HeaderBGColor});var r=e.Width-this.HeaderMergin.Left-this.HeaderMergin.Right,n={Rect:e,AryText:[{Text:null}],YText:e.Bottom-this.HeaderMergin.Bottom,Index:a,TextWidth:r};if(this.HeaderRowCount>1)if(sa.IsNonEmptyArray(t.AryTitle)){n.AryText=[];for(var o=0;o<t.AryTitle.length&&o<this.HeaderRowCount;++o){var s=t.AryTitle[o];n.AryText.push({Text:s})}n.YText-=(this.HeaderRowCount-1)*this.HeaderFontHeight}else t.Title&&(n.AryText[0].Text=t.Title),n.YText=e.Bottom-this.HeaderMergin.Bottom-this.HeaderRowCount*this.HeaderFontHeight/2+this.HeaderFontHeight/2;else t.Title&&(n.AryText[0].Text=t.Title);var h=n.AryText[n.AryText.length-1],l=this.IsDrawSortBGIcon();this.SortInfo&&this.SortInfo.Field==a&&this.SortInfo.Sort>0?h.Sort={Type:this.SortInfo.Sort}:t.Sort>0&&l&&sa.IsNonEmptyArray(t.SortType)&&t.SortType.length>=2&&(h.Sort={Type:0}),t.Icon&&(h.Icon=t.Icon),i&&i.HeaderColor&&(n.HeaderColor=i.HeaderColor),this.DrawHeaderText(t,n)},this.DrawHeaderText=function(t,e){e.HeaderColor?this.Canvas.fillStyle=e.HeaderColor:t.HeaderColor?this.Canvas.fillStyle=t.HeaderColor:this.Canvas.fillStyle=this.HeaderColor;for(var a=F(),i=e.Rect.Width,r=this.IsDrawSortBGIcon(),n=e.YText,o=0;o<e.AryText.length;++o){var s=e.Rect.Left+this.HeaderMergin.Left,h=e.AryText[o],l={TextMaxWidth:e.TextWidth},u=0;if(h.Icon&&h.Icon.Symbol){u=h.Icon.Size;if(h.Icon.Margin){var C=h.Icon.Margin;sa.IsNumber(C.Left)&&(u+=C.Left),sa.IsNumber(C.Right)&&(u+=C.Right)}}u>0&&(l.TextMaxWidth-=u);var D=0;if(h.Sort&&this.SortConfig&&sa.IsPlusNumber(this.SortConfig.Size)&&(D=this.SortConfig.Size*a,this.SortConfig.Margin)){C=this.SortConfig.Margin;sa.IsNumber(C.Left)&&(D+=C.Left),sa.IsNumber(C.Right)&&(D+=C.Right)}D>0&&(l.TextMaxWidth-=D);var f=0;if(h.Text&&(this.Canvas.font=this.HeaderFont,f=this.Canvas.measureText(h.Text).width),"center"==t.TextAlign?s+=(i-f)/2:"right"==t.TextAlign&&(s=s+l.TextMaxWidth-f),h.Text&&(this.Canvas.fillText(h.Text,s,n),s+=f),D>1){this.Canvas.font=this.SortFont;var c=s;if(this.SortConfig.Margin&&sa.IsNumber(this.SortConfig.Margin.Left)&&(c+=this.SortConfig.Margin.Left),0!=h.Sort.Type&&r){var m=this.SortConfig.Arrow[0],d=this.SortConfig.Color[0];this.Canvas.fillStyle=d,this.Canvas.fillText(m,c,n-this.SortConfig.Margin.Bottom)}m=this.SortConfig.Arrow[h.Sort.Type],d=this.SortConfig.Color[h.Sort.Type];this.Canvas.fillStyle=d,this.Canvas.fillText(m,c,n-this.SortConfig.Margin.Bottom),s+=D}if(u>1){var I=h.Icon,S="".concat(I.Size,"px ").concat(I.Family);this.Canvas.font=S,I.Color&&(this.Canvas.fillStyle=I.Color);var T=0,v=0;if(I.Margin&&sa.IsNumber(I.Margin.Left)&&(v=I.Margin.Left),I.Margin&&sa.IsNumber(I.Margin.Bottom)&&(T=-I.Margin.Bottom),this.Canvas.fillText(I.Symbol,s+v,n+T),I.Tooltip){var p={Left:s+v,Bottom:n+T,Width:I.Size,Height:I.Size};p.Right=p.Left+p.Width,p.Top=p.Bottom-p.Height;var g={Rect:p,Type:2,Column:t,Index:e.Index,Data:I.Tooltip.Data};this.TooltipRect.push(g)}}n+=this.HeaderFontHeight}},this.DrawHeader=function(){if(this.IsShowHeader){var t=this.RectClient.Left,e=this.RectClient.Top;this.Canvas.font=this.HeaderFont;var a=t;this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";for(var i=0;i<this.FixedColumn&&i<this.Column.length;++i){var r=this.Column[i],n=r.Width,o={Left:a,Width:n,Top:e,Height:this.HeaderHeight};o.Right=o.Left+o.Width,o.Bottom=o.Top+o.Height,this.DrawHeaderItem(r,o,i),a+=r.Width}for(i=this.FixedColumn+this.Data.XOffset;i<this.Column.length;++i){r=this.Column[i],n=r.Width,o={Left:a,Width:n,Top:e,Height:this.HeaderHeight};o.Right=o.Left+o.Width,o.Bottom=o.Top+o.Height,this.DrawHeaderItem(r,o,i),a+=r.Width}}},this.IsDrawSortBGIcon=function(){return!!sa.IsNonEmptyArray(this.SortConfig.Arrow)&&(!!this.SortConfig.Arrow[0]&&(!!sa.IsNonEmptyArray(this.SortConfig.Color)&&!!this.SortConfig.Color[0]))},this.DrawBorder=function(){if(this.IsDrawBorder){var t=this.RectClient.Left,e=this.RectClient.Right,a=this.RectClient.Top;this.RectClient.Bottom;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,A(a+this.HeaderHeight)),this.Canvas.lineTo(e,A(a+this.HeaderHeight));for(var i=a+this.HeaderHeight+this.RowHeight,r=i,n=0;n<this.FixedRowCount;++n){var o=A(i);this.Canvas.moveTo(t,o),this.Canvas.lineTo(e,o),r=i,i+=this.FixedRowHeight}for(i=a+this.HeaderHeight+this.RowHeight+this.FixedRowHeight*this.FixedRowCount,r=i,n=0;n<this.RowCount;++n){o=A(i);this.Canvas.moveTo(t,o),this.Canvas.lineTo(e,o),r=i,i+=this.RowHeight}var s=t;for(n=0;n<this.FixedColumn&&n<this.Column.length;++n){var h=this.Column[n],l=A(s+h.Width);this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,r),s+=h.Width}for(n=this.FixedColumn+this.Data.XOffset;n<this.Column.length;++n){h=this.Column[n],l=A(s+h.Width);this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,r),s+=h.Width}this.Canvas.stroke()}},this.GetAllRowCount=function(){var t=this.Data.Data.length;return this.Data.Virtual&&this.Data.Virtual.Enable&&(t=this.Data.Virtual.Count),t},this.DrawBody=function(){if(this.Data&&(sa.IsNonEmptyArray(this.Data.Data)||this.Data.Virtual.Enable)){this.Canvas.font=this.ItemFont;var t=this.RectClient.Top+this.HeaderHeight,e=this.RectClient.Left,a=this.RectClient.Right-this.RectClient.Left,i=t;this.Canvas.font=this.ItemFixedFont;for(var r=0;r<this.FixedRowCount;++r)this.SelectedFixedRow==r&&(this.Canvas.fillStyle=this.SelectedColor,this.Canvas.fillRect(e,i,a,this.FixedRowHeight)),1==this.FixedRowData.Type?this.DrawFixedSymbolRow(i,r):this.DrawFixedRow(i,r),i+=this.FixedRowHeight;i=t+this.FixedRowHeight*this.FixedRowCount,this.Canvas.font=this.ItemFont;var n,o=this.GetEventCallback(m.ON_DRAW_REPORT_ROW_BG),s=this.GetSelectedSymbol();1==this.MultiSelectModel&&(n=new Set(this.MultiSelectedRow));for(var h=this.GetAllRowCount(),l=(r=this.Data.YOffset,0);r<h&&l<this.RowCount;++r,++l){var u=this.Data.Data[r],C=!1;if(1==this.MultiSelectModel?n.has(r)&&(C=!0):0==this.SelectedModel?l==this.SelectedRow&&(C=!0):r==this.SelectedRow&&(C=!0),this.DragRow){if(this.DragRow.Data){var D=this.DragRow.Data.Row.DataIndex;D==r&&(this.Canvas.fillStyle=this.DragSrcRowColor,this.Canvas.fillRect(e,i,a,this.RowHeight))}if(this.DragRow.MoveRow){D=this.DragRow.MoveRow.Data.DataIndex;D==r&&(this.Canvas.fillStyle=this.DragMoveRowColor,this.Canvas.fillRect(e,i,a,this.RowHeight))}C=!1}if(o&&o.Callback){var f={RowIndex:r,Symbol:u,Out:null,Selected:s,MultiSelectModel:this.MultiSelectModel};o.Callback(o,f,this),f.Out&&f.Out.BGColor&&(this.Canvas.fillStyle=f.Out.BGColor,this.Canvas.fillRect(e,i,a,this.RowHeight))}if(C){var c={Left:e,Top:i,Width:a,Height:this.RowHeight};c.Right=c.Left+c.Width,c.Bottom=c.Top+c.Height,this.AryFullSelectedRow.push(c),1===this.SelectedStyle&&(this.Canvas.fillStyle=this.SelectedColor,this.Canvas.fillRect(c.Left,c.Top,c.Width,c.Height))}this.DrawRow(u,i,r),this.ShowSymbol.push({Index:r,Symbol:u}),i+=this.RowHeight}}},this.DrawSelectedRow=function(){if(2===this.SelectedStyle&&sa.IsNonEmptyArray(this.AryFullSelectedRow)){this.Canvas.fillStyle=this.SelectedLineConfig.Color;for(var t=this.SelectedLineConfig.Width,e=0;e<this.AryFullSelectedRow.length;++e){var a=this.AryFullSelectedRow[e];this.Canvas.fillRect(a.Left,a.Bottom-t,a.Width,t)}}},this.GetSelectedSymbol=function(){if(1==this.MultiSelectModel){if(!sa.IsNonEmptyArray(this.MultiSelectedRow))return null;for(var t=[],e=0;e<this.MultiSelectedRow.length;++e){var a=this.Data.Data[this.MultiSelectedRow[e]];a&&t.push(a)}return t}if(this.SelectedRow<0)return null;var i=this.SelectedRow;0==this.SelectedModel&&(i=this.Data.YOffset+this.SelectedRow);var r=this.Data.Data[i];return[r]},this.DrawFixedSymbolRow=function(t,e){this.RectClient.Left,this.RectClient.Right;if(this.FixedRowData&&sa.IsNonEmptyArray(this.FixedRowData.Symbol)){var a=this.FixedRowData.Symbol[e];a&&(this.DrawRow(a,t,e,1),this.ShowSymbol.push({Index:e,Symbol:a,RowType:1}))}},this.DrawFixedRow=function(t,e){for(var a=this.RectClient.Left,i=this.RectClient.Right,r=0;r<this.FixedColumn&&r<this.Column.length;++r){var n=this.Column[r];if(this.DrawFixedItem(e,r,n,a,t),a+=n.Width,a>=i)break}for(r=this.FixedColumn+this.Data.XOffset;r<this.Column.length;++r){n=this.Column[r];if(this.DrawFixedItem(e,r,n,a,t),a+=n.Width,a>=i)break}},this.DrawFixedItem=function(t,e,a,i,r){var n=i+this.ItemMergin.Left,o=a.Width-this.ItemMergin.Left-this.ItemMergin.Right,s={Text:null,TextColor:a.TextColor,TextAlign:a.TextAlign};if(this.GetFixedRowTextDrawInfo(t,e,a,s))this.DrawItemText(s.Text,s.TextColor,s.TextAlign,n,r,o);else if(this.FixedRowData&&sa.IsNonEmptyArray(this.FixedRowData.Data)){var h=this.FixedRowData.Data,l=h[t];if(sa.IsNonEmptyArray(l)){var u=l[e];u&&u.Text&&(s.Text=u.Text,u.Color&&(s.TextColor=u.Color),u.TextAlign&&(s.TextAlign=u.TextAlign),this.DrawItemText(s.Text,s.TextColor,s.TextAlign,n,r,o))}}},this.DrawRow=function(t,e,a,i){var r=this.RectClient.Left,n=this.RectClient.Right,o={Symbol:t,Stock:null,Block:null};this.GetStockDataCallback&&(o.Stock=this.GetStockDataCallback(t)),this.GetBlockDataCallback&&(o.Block=this.GetBlockDataCallback(t)),this.GetFlashBGDataCallback&&(o.FlashBG=this.GetFlashBGDataCallback(t,Date.now())),o.Decimal=Jr(t);for(var s=0;s<this.FixedColumn&&s<this.Column.length;++s){var h=this.Column[s];if(this.DrawItem(a,o,h,r,e,i,s),r+=h.Width,r>=n)break}for(s=this.FixedColumn+this.Data.XOffset;s<this.Column.length;++s){h=this.Column[s];if(this.DrawItem(a,o,h,r,e,i,s),r+=h.Width,r>=n)break}},this.BuildSubCellTextData=function(t,e,a,i,r,n){switch(t.Type){case Hn.NAME_ID:a&&a.Name?i.Text=a.Name:i.Text=r.Name;break;case Hn.SYMBOL_ID:a&&a.Symbol?i.Text=a.Symbol:i.Text=r.Symbol;break;case Hn.PRICE_ID:case Hn.OPEN_ID:case Hn.HIGH_ID:case Hn.LOW_ID:case Hn.YCLOSE_ID:case Hn.BUY_PRICE_ID:case Hn.SELL_PRICE_ID:case Hn.AVERAGE_PRICE_ID:case Hn.FUTURES_CLOSE_ID:case Hn.FUTURES_YCLOSE_ID:var o=Yn.get(t.Type);a&&sa.IsNumber(a[o])&&this.GetPriceDrawInfo(a[o],a,r,i,n);break;case Hn.INCREASE_ID:case Hn.AMPLITUDE_ID:case Hn.UPDOWN_ID:case Hn.RISING_SPEED_1M_ID:case Hn.RISING_SPEED_3M_ID:case Hn.RISING_SPEED_5M_ID:case Hn.RISING_SPEED_10M_ID:case Hn.RISING_SPEED_15M_ID:o=Yn.get(t.Type);if(a&&sa.IsNumber(a[o])){var s=a[o],h=s.toFixed(2);t.DynamicFormat&&(h=t.DynamicFormat.replace("{Value}",h)),i.Text=h,i.TextColor=this.GetUpDownColor(s,0)}break}},this.DrawSubCellText=function(t,e,a){if(t.Text){var i=t.Text,r=a.Left;"center"==t.TextAlign?(r=a.Left+a.Width/2,this.Canvas.textAlign="center"):"right"==t.TextAlign?(r=a.Left+a.Width-2,this.Canvas.textAlign="right"):(r+=2,this.Canvas.textAlign="left");this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(i,r,a.Bottom)}},this.DrawItem=function(t,e,a,i,r,n,o){var s=a.Width,h=i+this.ItemMergin.Left,l=a.Width-this.ItemMergin.Left-this.ItemMergin.Right,u=e.Stock,C={Text:null,TextColor:a.TextColor,TextAlign:a.TextAlign,Tooltip:null,Index:t,ColumnIndex:o},D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight};if(D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,C.Rect=D,a.FullColBGColor&&this.DrawItemBG({Rect:D,BGColor:a.FullColBGColor}),a.Type==Hn.INDEX_ID){if(1==n)return;C.Text=(t+1).toString()}else if(a.Type==Hn.SYMBOL_ID)u&&u.Symbol?C.Text=u.Symbol:C.Text=e.Symbol,this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.SYMBOL_NAME_ID)this.DrawSymbolName(e,a,i,r,n),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.SYMBOL_NAME_V2_ID)this.DrawSymbolNameV2(e,a,i,r,n),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.NAME_ID)u&&u.Name&&sa.IsString(u.Name)&&(C.Text=this.TextEllipsis(u.Name,l,a.MaxText),C.TextColor=this.GetNameColor(a,e.Symbol,n)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.NAME_EX_ID){if(u&&u.NameEx){var f=u.NameEx;C.Text=this.TextEllipsis(f.Text,l,a.MaxText),C.TextColor=this.GetNameColor(a,e.Symbol,n),f.Symbol&&(C.Symbol=f.Symbol)}}else if(a.Type==Hn.PRICE_ID)u&&this.GetPriceDrawInfo(u.Price,u,e,C,{LimitBG:!0}),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.OPEN_ID)u&&(this.DrawLimitPriceBorder(u.Open,u,i,r,a.Width),this.GetPriceDrawInfo(u.Open,u,e,C,{LimitBG:!0})),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.HIGH_ID)u&&(this.DrawLimitPriceBorder(u.High,u,i,r,a.Width),this.GetPriceDrawInfo(u.High,u,e,C,{LimitBG:!0})),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.LOW_ID)u&&(this.DrawLimitPriceBorder(u.Low,u,i,r,a.Width),this.GetPriceDrawInfo(u.Low,u,e,C,{LimitBG:!0})),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.YCLOSE_ID)u&&this.GetPriceDrawInfo(u.YClose,u,e,C),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.BUY_PRICE_ID)u&&this.GetPriceDrawInfo(u.BuyPrice,u,e,C),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.FUTURES_CLOSE_ID||a.Type==Hn.FUTURES_YCLOSE_ID){var c=Yn.get(a.Type);if(u&&sa.IsNumber(u[c])){var m=u[c];this.GetPriceDrawInfo(m,u,e,C)}this.FormatDrawInfo(a,u,C,e)}else if(a.Type==Hn.SELL_PRICE_ID)u&&this.GetPriceDrawInfo(u.SellPrice,u,e,C),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.AVERAGE_PRICE_ID)u&&this.GetPriceDrawInfo(u.AvPrice,u,e,C),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.EXCHANGE_RATE_ID)u&&sa.IsNumber(u.Exchange)&&(C.Text=u.Exchange.toFixed(2)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.BUY_VOL_ID)u&&sa.IsNumber(u.BuyVol)&&(C.Text=this.FormatVolString(u.BuyVol)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.SELL_VOL_ID)u&&sa.IsNumber(u.SellVol)&&(C.Text=this.FormatVolString(u.SellVol)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.VOL_ID)u&&sa.IsNumber(u.Vol)&&(C.Text=this.FormatVolString(u.Vol)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.VOL_IN_ID)u&&sa.IsNumber(u.VolIn)&&(C.Text=this.FormatVolString(u.VolIn)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.VOL_OUT_ID)u&&sa.IsNumber(u.VolOut)&&(C.Text=this.FormatVolString(u.VolOut)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.TOTAL_SHARES_ID)u&&sa.IsNumber(u.TotalShares)&&(C.Text=this.FormatVolString(u.TotalShares)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.OUTSTANDING_SHARES_ID)u&&sa.IsNumber(u.OutShares)&&(C.Text=this.FormatVolString(u.OutShares)),this.FormatDrawInfo(a,u,C,e);else if(a.Type==Hn.CIRC_MARKET_VALUE_ID||a.Type==Hn.MARKET_VALUE_ID||a.Type==Hn.AMOUNT_ID){c=Yn.get(a.Type);u&&sa.IsNumber(u[c])&&(C.Text=this.FormatVolString(u[c])),this.FormatDrawInfo(a,u,C,e)}else if(a.Type==Hn.INCREASE_ID||a.Type==Hn.AMPLITUDE_ID||a.Type==Hn.UPDOWN_ID||a.Type==Hn.RISING_SPEED_1M_ID||a.Type==Hn.RISING_SPEED_3M_ID||a.Type==Hn.RISING_SPEED_5M_ID||a.Type==Hn.RISING_SPEED_10M_ID||a.Type==Hn.RISING_SPEED_15M_ID){c=Yn.get(a.Type);if(u&&sa.IsNumber(u[c])){m=u[c];C.Text=m.toFixed(2),C.TextColor=this.GetUpDownColor(m,0)}this.FormatDrawInfo(a,u,C,e)}else if(a.Type==Hn.FUTURES_POSITION_ID||a.Type==Hn.FUTURES_OPEN_POSITION_ID||a.Type==Hn.FUTURES_CLOSE_POSITION_ID){c=Yn.get(a.Type);if(u&&sa.IsNumber(u[c])){m=u[c];C.Text=m.toFixed(0)}this.FormatDrawInfo(a,u,C,e)}else if(a.Type==Hn.CUSTOM_STRING_TEXT_ID)this.GetCustomStringDrawInfo(e,a,C);else if(a.Type==Hn.CUSTOM_NUMBER_TEXT_ID)this.GetCustomNumberDrawInfo(e,a,C),this.FormatDrawInfoEvent(u,e,a,C);else if(a.Type==Hn.CUSTOM_DATETIME_TEXT_ID)this.GetCustomDateTimeDrawInfo(e,a,C),this.FormatDrawInfoEvent(u,e,a,C);else if(a.Type==Hn.CUSTOM_ICON_ID)this.GetCustomIconDrawInfo(e,a,C);else if(a.Type==Hn.CLOSE_LINE_ID){D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight};D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,u&&this.DrawLine(u.CloseLine,a,D)}else if(a.Type==Hn.KLINE_ID){D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight};D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,this.DrawKLine(u.KLine,a,D,e)}else if(a.Type==Hn.TIME_ID)this.FormaTimeDrawInfo(a,u,C,e),this.FormatDrawInfoEvent(u,e,a,C);else if(a.Type==Hn.DATE_ID)this.FormaDateDrawInfo(a,u,C,e),this.FormatDrawInfoEvent(u,e,a,C);else if(a.Type==Hn.CHECKBOX_ID)D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight},D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,C.Rect=D,C.Checked=!1,C.Enable=!0,C.CheckBox=this.CheckBoxConfig,C.Data=u,u&&sa.IsBool(u.Checked)&&(C.Checked=u.Checked);else if(a.Type==Hn.CUSTOM_CHECKBOX_ID)D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight},D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,C.Rect=D,this.GetCustomCheckBoxDrawInfo(e,a,C);else if(a.Type==Hn.CUSTOM_BUTTON_ID)D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight},D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,C.Rect=D,this.GetCustomButtonDrawInfo(e,a,C);else if(a.Type==Hn.CUSTOM_PROGRESS_ID)D={Left:i,Top:r,Width:a.Width,Height:this.RowHeight},D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,C.Rect=D,this.GetCustomProgressBarDrawInfo(e,a,C);else if(a.Type==Hn.CUSTOM_LINK_ID)this.GetCustomLinkDrawInfo(e,a,C);else if(this.IsReserveNumber(a.Type))this.FormatReserveNumber(a,u,C),this.FormatDrawInfoEvent(u,e,a,C);else if(this.IsReserveString(a.Type))this.FormatReserveString(a,u,C),this.FormatDrawInfoEvent(u,e,a,C);else if(this.IsReserveProgressBarColumn(a.Type))this.FormatReserveProgressBar(a,u,C);else if(this.IsReserveButtonColumn(a.Type))this.FormatReserveButton(a,u,C);else if(a.Type==Hn.MULTI_LINE_CONTAINER&&sa.IsNonEmptyArray(a.AryField)){var d=D.Bottom-this.ItemMergin.Bottom-(a.AryField.length-1)*this.ItemFontHeight,I={Left:i+this.ItemMergin.Left,Width:l,Height:this.ItemFontHeight,Bottom:d};I.Right=I.Left+I.Width,I.Top=I.Bottom-I.Height;for(var S=0;S<a.AryField.length;++S){C.Text=null;var T=a.AryField[S];this.BuildSubCellTextData(T,a,u,C,e),this.DrawSubCellText(C,a,I),I.Bottom+=this.ItemFontHeight,I.Top+=this.ItemFontHeight}}if(3==n&&(C.TextColor=this.DragRowTextColor),C.Symbol)this.DrawItemTextEx(C,h,r,l);else if(a.Type==Hn.CUSTOM_ICON_ID)this.DrawIconItem(C,h,r,l);else if(a.Type==Hn.CHECKBOX_ID||a.Type==Hn.CUSTOM_CHECKBOX_ID)this.DrawCheckbox(C,i,r,s);else if(a.Type==Hn.CUSTOM_BUTTON_ID||this.IsReserveButtonColumn(a.Type))this.DrawButton(C,i,r,s);else if(a.Type==Hn.CUSTOM_PROGRESS_ID||this.IsReserveProgressBarColumn(a.Type))this.DrawProgressBar(C,i,r,s);else if(a.Type==Hn.CUSTOM_LINK_ID)this.DrawLinkText(C,h,r,l);else if(a.Type==Hn.MULTI_LINE_CONTAINER);else{if(e.FlashBG&&e.FlashBG.Data&&void 0!=a.ID&&e.FlashBG.Data.has(a.ID)){var v=e.FlashBG.Data.get(a.ID),p={Rect:C.Rect,BGColor:v.Color};--v.Count,this.DrawItemBG(p),this.GlobalOption&&++this.GlobalOption.FlashBGCount}this.DrawItemBG(C),a.Type==Hn.CUSTOM_STRING_TEXT_ID||this.IsReserveString(a.Type)?this.DrawCustomText(C,a,h,r,l):this.DrawItemText(C.Text,C.TextColor,C.TextAlign,h,r,l,C.BGColor)}if(C.Tooltip){var g={Rect:D,Stock:u,Index:t,Column:a,RowType:n,Type:C.Tooltip.Type,Data:C.Tooltip.Data};this.TooltipRect.push(g)}else if(a.ChartTooltip&&a.ChartTooltip.Enable&&sa.IsNumber(a.ChartTooltip.Type)){g={Rect:D,Stock:u,Index:t,Column:a,RowType:n,Type:a.ChartTooltip.Type};this.TooltipRect.push(g)}if(C.Botton){var x={Stock:u,Index:t,ColumnIndex:o,Column:a,Rect:C.Botton.Rect,Type:C.Botton.Type,Data:C.Data};this.ButtonRect.push(x)}},this.FormatDrawInfoEvent=function(t,e,a,i){if(a.EnableFormatDrawInfoEvent){var r=this.GetEventCallback(m.ON_REPORT_FORMAT_DRAW_INFO);if(r&&r.Callback){var n={Stock:t,Column:a,Data:e,DrawInfo:i};r.Callback(r,n,this)}}},this.IsReserveProgressBarColumn=function(t){var e=[Hn.RESERVE_PROGRESS_BAR1_ID,Hn.RESERVE_PROGRESS_BAR2_ID,Hn.RESERVE_PROGRESS_BAR3_ID,Hn.RESERVE_PROGRESS_BAR4_ID,Hn.RESERVE_PROGRESS_BAR5_ID,Hn.RESERVE_PROGRESS_BAR6_ID,Hn.RESERVE_PROGRESS_BAR7_ID,Hn.RESERVE_PROGRESS_BAR8_ID,Hn.RESERVE_PROGRESS_BAR9_ID,Hn.RESERVE_PROGRESS_BAR10_ID];return e.includes(t)},this.IsReserveButtonColumn=function(t){var e=[Hn.RESERVE_BUTTON1_ID,Hn.RESERVE_BUTTON2_ID,Hn.RESERVE_BUTTON3_ID,Hn.RESERVE_BUTTON4_ID,Hn.RESERVE_BUTTON5_ID,Hn.RESERVE_BUTTON6_ID,Hn.RESERVE_BUTTON7_ID,Hn.RESERVE_BUTTON8_ID,Hn.RESERVE_BUTTON9_ID,Hn.RESERVE_BUTTON10_ID];return e.includes(t)},this.IsReserveNumber=function(t){var e=[Hn.RESERVE_NUMBER1_ID,Hn.RESERVE_NUMBER2_ID,Hn.RESERVE_NUMBER3_ID,Hn.RESERVE_NUMBER4_ID,Hn.RESERVE_NUMBER5_ID,Hn.RESERVE_NUMBER6_ID,Hn.RESERVE_NUMBER7_ID,Hn.RESERVE_NUMBER8_ID,Hn.RESERVE_NUMBER9_ID,Hn.RESERVE_NUMBER10_ID];return e.includes(t)},this.IsReserveString=function(t){var e=[Hn.RESERVE_STRING1_ID,Hn.RESERVE_STRING2_ID,Hn.RESERVE_STRING3_ID,Hn.RESERVE_STRING4_ID,Hn.RESERVE_STRING5_ID,Hn.RESERVE_STRING6_ID,Hn.RESERVE_STRING7_ID,Hn.RESERVE_STRING8_ID,Hn.RESERVE_STRING9_ID,Hn.RESERVE_STRING10_ID];return e.includes(t)},this.DrawCustomText=function(t,e,a,i,r){if(t.Text){var n=t.Text,o=a;"center"==t.TextAlign?(o=a+r/2,this.Canvas.textAlign="center"):"right"==t.TextAlign?(o=a+r-2,this.Canvas.textAlign="right"):(o+=2,this.Canvas.textAlign="left");var s=this.Canvas.measureText(n).width+1,h=!1;if(s>=r){if(2==e.FormatType){var l=n.length+5;n="";for(var u=0;u<l;++u)n+="#"}else 1==e.FormatType&&(n=this.TextEllipsis(n,r,e.MaxText));this.Canvas.save(),h=!0;var C={Left:a,Top:i+this.ItemMergin.Top,Width:r,Height:this.RowHeight};this.Canvas.beginPath(),this.Canvas.rect(C.Left,C.Top,C.Width,C.Height),this.Canvas.clip(),t.Tooltip={Type:1,Data:{AryText:[{Text:t.Text}]}}}this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(n,o,i+this.RowHeight-this.ItemMergin.Bottom),h&&this.Canvas.restore()}},this.DrawSymbolName=function(t,e,a,i,r){var n,o=t.Stock,s=sa.RemoveMarketSuffix(t.Symbol);if(o&&(s=o.Symbol,n=o.Name),s||n){var h=i+this.ItemMergin.Top+this.ItemNameHeight,l=a+this.ItemMergin.Left,u=l,C=e.Width-this.ItemMergin.Left-this.ItemMergin.Right,D=e.TextAlign;"center"==D?(u=l+C/2,this.Canvas.textAlign="center"):"right"==D?(u=l+C-2,this.Canvas.textAlign="right"):(u+=2,this.Canvas.textAlign="left");var f=this.GetNameColor(e,s,r),c=n;c&&(this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=f,this.Canvas.font=this.ItemNameFont,c=this.TextEllipsis(c,C,e.MaxText),c&&this.Canvas.fillText(c,u,h)),c=s,c&&(this.Canvas.textBaseline="bottom",this.Canvas.font=this.ItemSymbolFont,this.Canvas.fillStyle=f,this.Canvas.fillText(c,u,h+this.ItemSymbolHeight)),this.Canvas.font=this.ItemFont}},this.DrawSymbolNameV2=function(t,e,a,i,r){var n,o=t.Stock,s=sa.RemoveMarketSuffix(t.Symbol);if(o&&(s=o.Symbol,n=o.Name),s||n){var h=i+this.ItemMergin.Top+this.ItemNameHeight,l=a+this.ItemMergin.Left,u=l,C=e.Width-this.ItemMergin.Left-this.ItemMergin.Right,D=e.TextAlign;"center"==D?(u=l+C/2,this.Canvas.textAlign="center"):"right"==D?(u=l+C-2,this.Canvas.textAlign="right"):(u+=2,this.Canvas.textAlign="left"),this.Canvas.textBaseline="bottom";var f=e.TextColor,c=n;if(c&&(this.Canvas.fillStyle=f,this.Canvas.font=this.NameSymbolFont.Name,c=this.TextEllipsis(c,C,e.MaxText),c)){this.Canvas.fillText(c,u,h);var m=this.Canvas.measureText(c).width,d=2;sa.IsNumber(e.Space)&&(d=e.Space),u+=m+d}f=e.TextColor2;c=s,c&&(this.Canvas.font=this.NameSymbolFont.Symbol,this.Canvas.fillStyle=f,this.Canvas.fillText(c,u,h)),this.Canvas.font=this.ItemFont}},this.DrawLimitPriceBorder=function(t,e,a,i,r){if(sa.IsNumber(t)&&e){var n=!1;if(sa.IsNumber(e.LimitHigh)&&t>=e.LimitHigh&&(n=!0),sa.IsNumber(e.LimitLow)&&t<=e.LimitLow&&(n=!0),n){var o=a+this.ItemMergin.Left+this.LimitMergin.Left,s=r-this.ItemMergin.Left-this.ItemMergin.Right-this.LimitMergin.Left-this.LimitMergin.Right,h=i+this.ItemMergin.Top+this.LimitMergin.Top,l=this.RowHeight-this.ItemMergin.Top-this.ItemMergin.Bottom-this.LimitMergin.Top-this.LimitMergin.Bottom;this.Canvas.strokeStyle=this.LimitBorderColor,this.Canvas.strokeRect(A(o),A(h),b(s),b(l))}}},this.GetExtendData=function(t,e){if(sa.IsNumber(e.DataIndex)){if(!t.Stock||!t.Stock.ExtendData)return null;if(e.DataIndex<0)return;return t.Stock.ExtendData[e.DataIndex]}if(sa.IsNumber(e.BlockIndex)){if(!t.Block)return;if(e.BlockIndex<0)return;return t.Block[e.BlockIndex]}return null},this.GetCustomStringDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);sa.IsString(i)&&(a.Text=i)},this.GetCustomNumberDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);if(sa.IsNumber(i)){switch(e.FormatType){case 1:a.Text=i.toFixed(e.Decimal);break;case 2:a.Text=sa.FormatValueThousandsString(i,e.Decimal);break;case 3:a.Text=this.FormatVolString(i);break;default:a.Text=sa.FormatValueString(i,e.Decimal);break}switch(e.ColorType){case 1:a.TextColor=this.GetUpDownColor(i,0);break;case 2:sa.IsNumber(t.Stock.YClose)?a.TextColor=this.GetUpDownColor(i,t.Stock.YClose):a.TextColor=this.UnchagneColor;break;default:break}}},this.GetCustomDateTimeDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);sa.IsNumber(i)&&0==e.ValueType&&(1==e.FormatType?a.Text=sa.FormatDateString(i,"YYYY/MM/DD"):a.Text=sa.FormatDateString(i))},this.GetCustomIconDrawInfo=function(t,e,a){e.IsDrawCallback&&this.GetCustomIconData(e,t.Symbol,a,t)},this.GetCustomCheckBoxDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);i&&sa.IsBool(i.Checked)&&(a.Checked=i.Checked,a.Enable=!0,a.Data=i,sa.IsBool(i.DisableCheckBox)&&(a.Enable=!i.DisableCheckBox),a.CheckBox=e.CheckBox)},this.GetCustomButtonDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);i&&(a.Text=i.Title,a.Button=e.Button,a.Font=e.Button.Font,a.Enable=!0,a.Data=i,sa.IsBool(i.Enable)&&(a.Enable=i.Enable))},this.GetCustomProgressBarDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);i&&(a.Text=i.Title,a.ProgressBar=e.ProgressBar,a.Enable=!0,a.Value=i.Value,a.Data=i,sa.IsBool(i.Enable)&&(a.Enable=i.Enable),i.TextColor&&(a.TextColor=i.TextColor),i.BarColor&&(a.BarColor=i.BarColor),i.BGColor&&(a.BGColor=i.BGColor))},this.GetCustomLinkDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);i&&(a.Text=i.Title,a.Link=e.Link,a.Enable=!0,a.Data=i,a.MaxText=e.MaxText,sa.IsBool(i.Enable)&&(a.Enable=i.Enable),i.TextColor&&(a.TextColor=i.TextColor))},this.FormatReserveNumber=function(t,e,a){t.DefaultText&&(a.Text=t.DefaultText);var i=Yn.get(t.Type);if(e&&i){var r=e[i];if(sa.IsNumber(r)){sa.IsNumber(t.ColorType)&&(1==t.ColorType?a.TextColor=this.GetUpDownColor(r,0):2==t.ColorType&&(a.TextColor=this.GetUpDownColorV2(r,0)));var n=r.toFixed(t.FloatPrecision);if(t.Format&&sa.IsNumber(t.Format.Type)){var o=t.Format;switch(o.Type){case 1:n=r.toFixed(t.FloatPrecision);break;case 2:n=sa.FormatValueThousandsString(r,t.FloatPrecision);break;case 3:var s=1;sa.IsNumber(o.ExFloatPrecision)&&(s=o.ExFloatPrecision),n=sa.FormatValueStringV2(r,t.FloatPrecision,s);break}}a.Text=n}}},this.FormatReserveString=function(t,e,a){t.DefaultText&&(a.Text=t.DefaultText);var i=Yn.get(t.Type);if(e&&i){var r=e[i];sa.IsObject(r)?(r.Text&&(a.Text=r.Text),r.TextColor&&(a.TextColor=r.TextColor),r.BGColor&&(a.BGColor=r.BGColor)):sa.IsString(r)&&(a.Text=r)}},this.FormatReserveProgressBar=function(t,e,a){var i=Yn.get(t.Type);if(e&&i){var r=e[i];sa.IsNumber(r)?(a.ProgressBar=t.ProgressBar,a.Enable=!0,a.Value=r,a.Data={Value:r}):sa.IsObject(r)&&(r.Title&&(a.Text=r.Title),a.ProgressBar=t.ProgressBar,a.Enable=!0,a.Value=r.Value,a.Data=r,sa.IsBool(r.Enable)&&(a.Enable=r.Enable),r.TextColor&&(a.TextColor=r.TextColor),r.BarColor&&(a.BarColor=r.BarColor),r.BGColor&&(a.BGColor=r.BGColor))}},this.FormatReserveButton=function(t,e,a){var i=Yn.get(t.Type);if(e&&i){var r=e[i];r&&(a.Text=r.Title,a.Button=t.Button,a.Font=t.Button.Font,a.Enable=!0,a.Data=r,sa.IsBool(r.Enable)&&(a.Enable=r.Enable))}},this.FormaTimeDrawInfo=function(t,e,a,i){sa.IsNumber(e.Time)&&(0==t.ValueType?a.Text=sa.FormatTimeString(e.Time,"HH:MM"):1==t.ValueType?a.Text=sa.FormatTimeString(e.Time,"HH:MM:SS"):2==t.ValueType&&(a.Text=sa.FormatTimeString(e.Time,"HH:MM:SS.fff")))},this.FormaDateDrawInfo=function(t,e,a,i){sa.IsNumber(e.Date)&&(0==t.FormatType?a.Text=sa.FormatDateString(e.Date,"YYYY-MM-DD"):1==t.FormatType?a.Text=sa.FormatDateString(e.Date,"YYYY/MM/DD"):2==t.FormatType?a.Text=sa.FormatDateString(e.Date,"YYYY/MM/DD/W"):3==t.FormatType?a.Text=sa.FormatDateString(e.Date,"YYYY-MM"):4==t.FormatType?a.Text=sa.FormatDateString(e.Date,"MM/DD"):4==t.FormatType&&(a.Text=sa.FormatDateString(e.Date,"MM-DD")))},this.GetCustomIconData=function(t,e,a,i){var r=this.GetEventCallback(m.ON_REPORT_DRAW_CUSTOM_ICON);if(!r||!r.Callback)return!1;var n={Symbol:e,Column:t,Data:i,Out:{Text:null,TextColor:null,TextAlign:null,Font:null}};return r.Callback(r,n,this),n.Out.Text&&(a.Text=n.Out.Text),n.Out.TextColor&&(a.TextColor=n.Out.TextColor),n.Out.TextAlign&&(a.TextAlign=n.Out.TextAlign),n.Out.BGColor&&(a.BGColor=n.Out.BGColor),n.Out.Font&&(a.Font=n.Out.Font),!0},this.GetPriceDrawInfo=function(t,e,a,i,r){if(!sa.IsNumber(t))return!1;i.Text=t.toFixed(a.Decimal);var n=null;1===e.PriceColorType?sa.IsNumber(e.YFClose)&&(n=e.YFClose):sa.IsNumber(e.YClose)&&(n=e.YClose),sa.IsNumber(n)?i.TextColor=this.GetUpDownColor(t,n):i.TextColor=this.UnchagneColor,r&&r.LimitBG&&(sa.IsNumber(e.LimitHigh)&&t>=e.LimitHigh&&(i.BGColor=this.LimitUpBGColor,i.TextColor=this.LimitTextColor),sa.IsNumber(e.LimitLow)&&t<=e.LimitLow&&(i.BGColor=this.LimitDownBGColor,i.TextColor=this.LimitTextColor))},this.GetUpDownColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.GetUpDownColorV2=function(t,e){return t>=e?this.UpColor:this.DownColor},this.FormatVolString=function(t,e){return sa.FormatVolString(t,e)},this.DrawItemBG=function(t){if(t.BGColor){var e=t.Rect;t.RectBG&&(e=t.RectBG),e&&(this.Canvas.fillStyle=t.BGColor,this.Canvas.fillRect(e.Left,e.Top,e.Width,e.Height))}},this.DrawItemText=function(t,e,a,i,r,n,o){if(t){var s=i;"center"==a?(s=i+n/2,this.Canvas.textAlign="center"):"right"==a?(s=i+n-2,this.Canvas.textAlign="right"):(s+=2,this.Canvas.textAlign="left");var h=this.Canvas.measureText(t).width+1,l=!1;if(h>=n){this.Canvas.save(),l=!0;var u={Left:i,Top:r+this.ItemMergin.Top,Width:n,Height:this.RowHeight};if(this.Canvas.beginPath(),this.Canvas.rect(u.Left,u.Top,u.Width,u.Height),this.Canvas.clip(),1==this.TextOverflowStyle){var C=t.length+5;t="";for(var D=0;D<C;++D)t+="#"}}if(this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=e,this.ItemTextLines>1){var f=(this.RowHeight-this.ItemMergin.Bottom-this.ItemMergin.Top-this.ItemFontHeight)/2,c=r+this.RowHeight-this.ItemMergin.Bottom-f;this.Canvas.fillText(t,s,c)}else this.Canvas.fillText(t,s,r+this.RowHeight-this.ItemMergin.Bottom);l&&this.Canvas.restore()}},this.DrawItemTextEx=function(t,e,a,i){var r=t.Text,n=t.TextColor,o=t.Symbol,s=t.TextAlign,h=this.Canvas.measureText(r).width+1,l=h,u="".concat(o.Size*F(),"px ").concat(o.Family);this.Canvas.font=u;for(var C=[],D=0;D<o.Data.length;++D){var f=o.Data[D],c=this.Canvas.measureText(f.Text).width+1;if(l+c>i)break;l+=c,C[D]=c}var m=e,d=a+this.ItemMergin.Top+this.RowHeight/2;"center"==s?m=e+(i-l)/2:"right"==s?m=e+(i-l):m+=2,this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=this.ItemFont,this.Canvas.fillStyle=n,this.Canvas.fillText(r,m,d),m+=h,this.Canvas.font=u;for(D=0;D<C.length;++D){f=o.Data[D];this.Canvas.fillStyle=f.Color,this.Canvas.fillText(f.Text,m,d),m+=C[D]}this.Canvas.font=this.ItemFont},this.DrawIconItem=function(t,e,a,i){if(t&&t.Font&&t.Text){var r=t.Text,n=t.TextColor,o=t.TextAlign;this.Canvas.font=t.Font;var s=this.Canvas.measureText(r).width+1,h=e,l=a+this.ItemMergin.Top+this.RowHeight/2;"center"==o?h=e+(i-s)/2:"right"==o?h=e+(i-s):h+=2,this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillStyle=n,this.Canvas.fillText(r,h,l),this.Canvas.font=this.ItemFont}},this.DrawCheckbox=function(t,e,a,i){if(sa.IsBool(t.Checked)&&t.CheckBox){var r=t.CheckBox;t.Font="".concat(r.Size*this.DevicePixelRatio,"px ").concat(r.Family);var n=t.TextAlign,o=t.CheckBox.Size*this.DevicePixelRatio,s=e+t.CheckBox.Margin.Left,h=a+this.RowHeight-t.CheckBox.Margin.Bottom;"center"==n?s=e+i/2-o/2:"right"==n&&(s=e+i-r.Margin.Right);var l={Left:s,Bottom:h,Width:o,Height:o};l.Right=l.Left+l.Width,l.Top=l.Bottom-l.Height;var u=!1;if(t.Enable&&this.LastMouseStatus&&this.LastMouseStatus.OnMouseMove){var C=this.LastMouseStatus.OnMouseMove.X,D=this.LastMouseStatus.OnMouseMove.Y;C>l.Left&&C<l.Right&&D>l.Top&&D<l.Bottom&&(u=!0,this.LastMouseStatus.MouseOnStatus={Index:t.Index,ColumnIndex:t.ColumnIndex,Type:0})}if(this.Canvas.font=t.Font,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",!0===t.Checked){var f=r.Checked.Color;!1===t.Enable?f=r.Checked.DisableColor:u&&(f=r.Checked.MouseOnColor),this.Canvas.fillStyle=f,this.Canvas.fillText(r.Checked.Symbol,s,h)}else if(!1===t.Checked){f=r.Unchecked.Color;!1===t.Enable?f=r.Unchecked.DisableColor:u&&(f=r.Unchecked.MouseOnColor),this.Canvas.fillStyle=f,this.Canvas.fillText(r.Unchecked.Symbol,s,h)}t.Enable&&(t.Botton={Rect:l,Type:0})}},this.DrawButton=function(t,e,a,i){if(t.Button){var r=t.Button,n={Left:e+t.Button.Margin.Left,Top:a+t.Button.Margin.Top,Height:this.RowHeight-t.Button.Margin.Top-t.Button.Margin.Bottom,Width:i-t.Button.Margin.Left-t.Button.Margin.Right};n.Right=n.Left+n.Width,n.Bottom=n.Top+n.Height;var o=r.BGColor,s=r.TextColor;if(!1===t.Enable)o=r.Disable.BGColor,s=r.Disable.TextColor;else if(this.LastMouseStatus&&this.LastMouseStatus.OnMouseMove&&r.MouseOn){var h=this.LastMouseStatus.OnMouseMove.X,l=this.LastMouseStatus.OnMouseMove.Y;h>n.Left&&h<n.Right&&l>n.Top&&l<n.Bottom&&(o=r.MouseOn.BGColor,s=r.MouseOn.TextColor,this.LastMouseStatus.MouseOnStatus={Index:t.Index,ColumnIndex:t.ColumnIndex,Type:1})}this.Canvas.fillStyle=o,this.Canvas.fillRect(n.Left,n.Top,n.Width,n.Height),this.Canvas.font=t.Font,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=s;var u=this.Canvas.measureText(t.Text).width;h=n.Left;u<n.Width&&(h+=(n.Width-u)/2);l=n.Bottom-t.Button.TextMargin.Bottom;this.Canvas.fillText(t.Text,h,l),t.Enable&&(t.Botton={Rect:n,Type:1})}},this.DrawProgressBar=function(t,e,a,i){if(t.ProgressBar){var r=t.ProgressBar,n={Left:e+r.Margin.Left,Top:a+r.Margin.Top,Height:this.RowHeight-r.Margin.Top-r.Margin.Bottom,Width:i-r.Margin.Left-r.Margin.Right};n.Right=n.Left+n.Width,n.Bottom=n.Top+n.Height;var o=r.BGColor,s=r.BarColor,h=r.TextColor;!1===t.Enable&&(o=r.Disable.BGColor,s=r.Disable.BarColor,h=r.Disable.TextColor),t.BGColor&&(o=t.BGColor),t.TextColor&&(h=t.TextColor),t.BarColor&&(s=t.BarColor),o&&(this.Canvas.fillStyle=o,this.Canvas.fillRect(n.Left,n.Top,n.Width,n.Height));var l=n.Width-r.BarMargin.Left-r.BarMargin.Right,u=t.Value,C={Left:n.Left+r.BarMargin.Left,Top:n.Top+r.BarMargin.Top,Bottom:n.Bottom-r.BarMargin.Bottom,Width:0};if(u>0&&(u>1&&(u=1),C.Width=l*u,C.Height=C.Bottom-C.Top,C.Width<1&&(n.Width=1),Array.isArray(s)?this.Canvas.fillStyle=this.CreateLinearGradient(s,n.Left,n.Top,n.Right,n.Top):this.Canvas.fillStyle=s,this.Canvas.fillRect(C.Left,C.Top,C.Width,C.Height)),h&&t.Text){this.Canvas.font=r.Font,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=h;var D=C.Left+r.TextMargin.Left,f=C.Bottom-r.TextMargin.Bottom;this.Canvas.fillText(t.Text,D,f)}}},this.CreateLinearGradient=function(t,e,a,i,r){for(var n=this.Canvas.createLinearGradient(e,a,i,r),o=1/(t.length-1),s=0;s<t.length;++s){var h=s*o;n.addColorStop(h,t[s])}return n},this.DrawLinkText=function(t,e,a,i){if(t.Link&&t.Text){var r=t.Link,n=t.Text,o=t.TextAlign,s=r.Font,h=r.TextColor;this.Canvas.font=s;var l=this.Canvas.measureText(n).width,u=this.Canvas.measureText("擎").width,C=e;i>=l?"center"==o?C=e+(i-l)/2:"right"==o&&(C=e+i-l):(n=this.TextEllipsis(n,i,t.MaxText),l=this.Canvas.measureText(n).width,t.Tooltip={Type:2,Data:{AryText:[{Text:t.Text}]}});var D={Left:C,Bottom:a+this.RowHeight-this.ItemMergin.Bottom,Height:u,Width:l};D.Right=D.Left+D.Width,D.Top=D.Bottom-D.Height;var f=!1;if(!1===t.Enable)h=r.Disable.TextColor;else if(this.LastMouseStatus&&this.LastMouseStatus.OnMouseMove&&r.MouseOn){C=this.LastMouseStatus.OnMouseMove.X;var c=this.LastMouseStatus.OnMouseMove.Y;C>D.Left&&C<D.Right&&c>D.Top&&c<D.Bottom&&(h=r.MouseOn.TextColor,f=!0,this.LastMouseStatus.MouseOnStatus={Index:t.Index,ColumnIndex:t.ColumnIndex,Type:2})}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=h,this.Canvas.fillText(n,D.Left,D.Bottom),f&&(this.Canvas.strokeStyle=h,this.Canvas.beginPath(),this.Canvas.moveTo(D.Left,D.Bottom),this.Canvas.lineTo(D.Right,D.Bottom),this.Canvas.stroke()),t.Enable&&(t.Botton={Rect:D,Type:2})}},this.TextEllipsis=function(t,e,a){if(!t)return null;if(t.length<a.length)return t;var i=a.length-3;if(i<0)return null;for(var r=t.slice(0,i),n=i;n<t.length;++n){var o=r+t[n]+"...",s=this.Canvas.measureText(o).width;if(s>e){r+="...";break}r+=t[n]}return r},this.DrawMultiBar=function(t,e,a){if(!e.Source||!sa.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!sa.IsNonEmptyArray(i.Value))return!1;for(var r=a.Width-this.BarMergin.Left-this.BarMergin.Right,n=a.Left+this.BarMergin.Left,o=a.Top+this.RowMergin.Top+this.BarMergin.Top,s=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,h=n+r,l=0;l<i.Value.length;++l){var u=i.Value[l];if(!(u<=0)){if(n>=h)break;var C=r*u;C<1&&(C=1),n+C>h&&(C=h-n);var D=l;sa.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=qi.DealList.FieldColor.Bar[D],this.Canvas.fillRect(n,o,C,s),n+=C}}return!0},this.DrawCenterBar=function(t,e,a){if(!e.Source||!sa.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!sa.IsNonEmptyArray(i.Value))return!1;for(var r=(a.Width-this.BarMergin.Left-this.BarMergin.Right)/2,n=a.Left+this.BarMergin.Left,o=n+r,s=a.Top+this.RowMergin.Top+this.BarMergin.Top,h=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,l=0;l<i.Value.length&&l<2;++l){var u=i.Value[l];if(!(u<=0)){u>1&&(u=1);var C=r*u;C<1&&(C=1);var D=l;sa.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=qi.DealList.FieldColor.Bar[D],0==l?this.Canvas.fillRect(o,s,-C,h):this.Canvas.fillRect(o,s,C,h)}}},this.DrawLine=function(t,e,a){if(!t)return!1;if(!sa.IsNonEmptyArray(t.Data))return!1;var i=a.Width-this.ItemMergin.Left-this.ItemMergin.Right,r=a.Left+this.ItemMergin.Left,n=a.Top+this.ItemMergin.Top,o=a.Height-this.ItemMergin.Top-this.ItemMergin.Bottom,s=r+i,h=n+o,l=function(e){var a=t.Count;if(1==a)return 0==e?r:s;if(a<=0)return r;if(e>=a)return s;var n=r+i*e/a;return n},u=t.Max,C=t.Min;if(sa.IsNumber(t.YClose))if(t.YClose==u&&t.YClose==C)u=t.YClose+.1*t.YClose,C=t.YClose-.1*t.YClose;else{var D=Math.max(Math.abs(t.YClose-u),Math.abs(t.YClose-C));u=t.YClose+D,C=t.YClose-D}var f=function(t){if(t<=C)return h;if(t>=u)return n;t=o*(t-C)/(u-C);return h-t};this.Canvas.save();var c=null;if(sa.IsNumber(t.YClose)){var m=f(t.YClose);m=A(m),c=m,this.Canvas.setLineDash([2,2]),this.Canvas.strokeStyle=this.CloseLineConfig.YCloseColor,this.Canvas.beginPath(),this.Canvas.moveTo(r,m),this.Canvas.lineTo(s,m),this.Canvas.stroke(),this.Canvas.setLineDash([])}t.Color?this.Canvas.strokeStyle=t.Color:this.Canvas.strokeStyle=this.CloseLineConfig.CloseColor;for(var d,I=!0,S={},T=0,v=0;v<t.Data.length;++v){var p=t.Data[v];sa.IsNumber(p)&&(d=l(v),m=f(p),I?(this.Canvas.beginPath(),this.Canvas.moveTo(d,m),I=!1,S={X:d,Y:m}):this.Canvas.lineTo(d,m),++T)}if(T>0&&(this.Canvas.stroke(),e.IsDrawArea&&sa.IsNumber(c))){this.Canvas.lineTo(d,c),this.Canvas.lineTo(S.X,c),this.Canvas.closePath();var g=this.CloseLineConfig.AreaColor;t.AreaColor&&(g=t.AreaColor),this.SetFillStyle(g,r,n,r,h),this.Canvas.fill()}this.Canvas.restore()},this.DrawKLine=function(t,e,a,i){if(e.IsDrawCallback){var r=this.GetEventCallback(m.ON_REPORT_DRAW_KLINE);if(r||r.Callback){var n={Column:e,Data:i,KLineData:t,Rect:a,PreventDefault:!1};if(r.Callback(r,n,this),n.PreventDefault)return}}if(t&&sa.IsNonEmptyArray(t.Data)){var o=t.Data[1],s=t.Data[2],h=[{Open:t.Data[0],High:o,Low:s,Close:t.Data[3]}];this.DrawKLineBar(h,o,s,a)}},this.DrawKLineBar=function(t,e,a,i){for(var r,n,o=(i.Left,this.ItemMergin.Left),s=i.Width-this.ItemMergin.Left-this.ItemMergin.Right,h=(o=i.Left+this.ItemMergin.Left,i.Top+this.ItemMergin.Top+4),l=i.Height-this.ItemMergin.Top-this.ItemMergin.Bottom-8,u=o+s,C=h+l,D=function(t){if(t<=a)return C;if(t>=e)return h;t=l*(t-a)/(e-a);return C-t},f=this.KLineConfig.DataWidth,c=this.KLineConfig.DistanceWidth,m=o,d=0;d<t.length;++d,m+=f+c){var I=t[d];if(r=m,n=m+f,r+(n-r)/2,n>u)break;var S=D(I.Low),T=D(I.High),v=D(I.Open),p=D(I.Close);I.Open<I.Close?this.DrawKBarItem(I,f,this.KLineConfig.UpColor,1,r,n,S,T,v,p):I.Open>I.Close?this.DrawKBarItem(I,f,this.KLineConfig.DownColor,0,r,n,S,T,v,p):this.DrawKBarItem(I,f,this.KLineConfig.UnchagneColor,0,r,n,S,T,v,p)}},this.DrawKBarItem=function(t,e,a,i,r,n,o,s,h,l){var u=!1;1==i&&(u=!0);var C=Math.min(h,l),D=Math.max(h,l),f=Math.max(t.Open,t.Close),c=Math.min(t.Open,t.Close);this.Canvas.fillStyle=a,this.Canvas.strokeStyle=a;var m=r+(n-r)/2;if(u&&e%2!=0&&(e-=1),e>=4){if(t.High>f){this.Canvas.beginPath();var d=m;u&&(d=r+e/2),this.Canvas.moveTo(A(d),A(C)),this.Canvas.lineTo(A(d),A(s)),this.Canvas.stroke()}if(Math.abs(D-C)<1?this.Canvas.fillRect(b(r),b(C),b(e),1):u?(this.Canvas.beginPath(),this.Canvas.rect(A(r),A(C),b(e),b(D-C)),this.Canvas.stroke()):this.Canvas.fillRect(b(r),b(C),b(e),b(D-C)),t.Low<c){this.Canvas.beginPath();d=m;u&&(d=r+e/2),this.Canvas.moveTo(A(d),A(D)),this.Canvas.lineTo(A(d),A(o)),this.Canvas.stroke()}}},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){var n=this.Canvas.createLinearGradient(e,a,i,r),o=1/t.length;for(var s in t)n.addColorStop(s*o,t[s]);this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t},this.FormatDrawInfo=function(t,e,a,i){this.FormatDrawInfoEvent(e,i,t,a)},this.GetFixedRowTextDrawInfo=function(t,e,a,i){var r=this.GetEventCallback(m.ON_DRAW_REPORT_FIXEDROW_TEXT);if(!r||!r.Callback)return!1;var n={RowIndex:t,ColIndex:e,Column:a,Data:this.FixedRowData,Out:{Text:null,TextColor:null,TextAlign:null}};return r.Callback(r,n,this),n.Out.Text&&(i.Text=n.Out.Text),n.Out.TextColor&&(i.TextColor=n.Out.TextColor),n.Out.TextAlign&&(i.TextAlign=n.Out.TextAlign),!0},this.GetVolColor=function(t,e){var a=this.GetEventCallback(m.ON_DRAW_DEAL_VOL_COLOR);if(a&&a.Callback){var i={Data:e,TextColor:null};if(a.Callback(a,i,this),i.TextColor)return i.TextColor}return t.TextColor},this.GetNameColor=function(t,e,a){var i=this.GetEventCallback(m.ON_DRAW_REPORT_NAME_COLOR);if(i&&i.Callback){var r={Symbol:e,TextColor:null,RowType:a};if(i.Callback(i,r,this),r.TextColor)return r.TextColor}return t.TextColor},this.GetFontHeight=function(t,e){return E(this.Canvas,t,e)},this.OnMouseDown=function(t,e,a){if(!this.Data)return null;if(this.Tab){var i=this.Tab.OnMouseDown(t,e,a);if(i)return{Type:1,Tab:i}}if(this.VScrollbar){var r=this.VScrollbar.OnMouseDown(t,e,a);if(r)return{Type:5,VScrollbar:r}}var n=F(),o={X:t/n,Y:e/n};if(this.UIElement)var s={Left:this.UIElement.getBoundingClientRect().left,Top:this.UIElement.getBoundingClientRect().top};else s={Left:null,Top:null};var h=this.PtInFixedBody(t,e);if(h){var l=!0,u=m.ON_CLICK_REPORT_FIXEDROW;return 2==a.button&&(u=m.ON_RCLICK_REPORT_FIXEDROW),this.SendClickEvent(u,{Data:h,X:t,Y:e,e:a,Inside:o,UIElement:s}),this.SelectedFixedRow=h.Index,this.SelectedRow=-1,this.MultiSelectedRow=[],{Type:4,Redraw:l,Row:h}}h=this.PtInBody(t,e);if(h){var C={Redraw:!1};this.OnClickButton(t,e,a,C);l=!0;if(1==this.MultiSelectModel){if(a&&a.ctrlKey){var D=this.MultiSelectedRow.indexOf(h.DataIndex);D>=0?this.MultiSelectedRow.splice(D,1):this.MultiSelectedRow.push(h.DataIndex)}else a&&a.shiftKey?this.OnShiftClickRow(h):1==this.MultiSelectedRow.length&&this.MultiSelectedRow[0]==h.DataIndex?l=!1:this.MultiSelectedRow=[h.DataIndex];this.SelectedFixedRow=-1}else 0==this.SelectedModel?(this.SelectedRow==h.Index&&(l=!1),this.SelectedRow=h.Index,this.SelectedFixedRow=-1):(this.SelectedRow==h.DataIndex&&(l=!1),this.SelectedRow=h.DataIndex,this.SelectedFixedRow=-1);u=m.ON_CLICK_REPORT_ROW;return 2==a.button&&(u=m.ON_RCLICK_REPORT_ROW),this.SendClickEvent(u,{Data:h,X:t,Y:e,e:a,Inside:o,UIElement:s}),{Type:2,Redraw:l||C.Redraw,Row:h}}var f=this.PtInHeader(t,e);if(f){u=m.ON_CLICK_REPORT_HEADER;return 2==a.button?u=m.ON_RCLICK_REPORT_HEADER:0==a.button&&(u=m.ON_CLICK_REPORT_HEADER),this.SendClickEvent(u,{Data:h,X:t,Y:e,e:a,Inside:o,UIElement:s}),{Type:3,Redraw:l,Header:f}}return null},this.OnShiftClickRow=function(t){if(this.MultiSelectedRow.length<=0)this.MultiSelectedRow.push(t.DataIndex);else{for(var e=null,a=null,i=0;i<this.MultiSelectedRow.length;++i){var r=this.MultiSelectedRow[i];if((null==e||e<r)&&(e=r),(null==a||a>r)&&(a=r),r==t.DataIndex)return void this.MultiSelectedRow.splice(i,1)}if(e==a){var n=t.DataIndex,o=e;n>o&&(n=e,o=t.DataIndex),this.MultiSelectedRow=[];for(i=n;i<=o;++i)this.MultiSelectedRow.push(i)}else if(t.DataIndex<=e&&t.DataIndex>=a)this.MultiSelectedRow.push(t.DataIndex);else{n=Math.min(t.DataIndex,a),o=Math.max(t.DataIndex,e);this.MultiSelectedRow=[];for(i=n;i<=o;++i)this.MultiSelectedRow.push(i)}}},this.OnDragRow=function(t,e,a){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;var i=this.RowHeight/2,r=this.RectClient.Top+this.HeaderHeight,n=this.ChartBorder.GetChartWidth(),o=r+this.FixedRowHeight*this.FixedRowCount;if(e<o+i)return{Type:5};for(var s=this.Data.YOffset,h=0;s<this.Data.Data.length&&h<this.RowCount;++s,++h){var l=this.Data.Data[s],u={Left:0,Top:o,Right:n,Bottom:o+this.RowHeight};if(u.Top+=i,u.Bottom+=i,t>=u.Left&&t<=u.Right&&e>=u.Top&&e<=u.Bottom){var C={DataIndex:s,Index:h,Symbol:l,Pos:0};return 0==h?C.Pos=1:h==this.RowCount-1&&(C.Pos=2),{Type:2,Data:C}}o+=this.RowHeight}return h<this.RowCount?{Type:6}:{Type:7}},this.OnDragHeader=function(t,e,a){if(!this.IsShowHeader)return null;var i=this.RectClient.Left,r=this.RectClient.Right,n=this.RectClient.Top,o=n+this.HeaderHeight;if(t<i)return{Type:2};if(t>r)return{Type:3};var s=this.PtInItem(t,n+2,n,o);return s?s.IsFixed?{Type:5}:{Type:1,Header:s}:{Type:4}},this.OnClickButton=function(t,e,a,i){if(0!=a.button)return!1;var r=this.GetButtonData(t,e);if(!r)return!0;if(0===r.Type){var n={Column:r.Column,Index:r.Index,Stock:r.Stock,ColumnIndex:r.ColumnIndex,Data:r.Data,Value:!0,PreventDefault:!1};return sa.IsBool(r.Data.Checked)&&(n.Value=!r.Data.Checked),this.SendClickEvent(m.ON_CLICK_REPORT_CHECKBOX,n),n.PreventDefault||(sa.IsBool(r.Data.Checked)?r.Data.Checked=!r.Data.Checked:r.Data.Checked=!0),i.Redraw=!0,!0}if(1===r.Type){n={Column:r.Column,Index:r.Index,Stock:r.Stock,ColumnIndex:r.ColumnIndex,Data:r.Data};return this.SendClickEvent(m.ON_CLICK_REPORT_BUTTON,n),i.Redraw=!0,!0}if(2===r.Type){n={Column:r.Column,Index:r.Index,Stock:r.Stock,ColumnIndex:r.ColumnIndex,Data:r.Data};return this.SendClickEvent(m.ON_CLICK_REPORT_LINK,n),i.Redraw=!0,!0}return!1},this.OnDblClick=function(t,e,a){if(!this.Data)return!1;var i=this.PtInHeaderDragBorder(t,e);if(i)return this.SendClickEvent(m.ON_DBCLICK_REPORT_DRAG_COLUMN_WIDTH,{Data:i,X:t,Y:e}),!0;var r=this.PtInBody(t,e);return!!r&&(this.SendClickEvent(m.ON_DBCLICK_REPORT_ROW,{Data:r,X:t,Y:e}),!0)},this.PtInClient=function(t,e){return t>this.RectClient.Left&&t<this.RectClient.Right&&e>this.RectClient.Top&&e<this.RectClient.Bottom},this.PtInBody=function(t,e){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;for(var a=this.RectClient.Top+this.HeaderHeight,i=this.RectClient.Left,r=this.RectClient.Right,n=(this.RectClient.Right,this.RectClient.Left,a+this.FixedRowHeight*this.FixedRowCount),o=this.Data.YOffset,s=0;o<this.Data.Data.length&&s<this.RowCount;++o,++s){var h=this.Data.Data[o],l={Left:i,Top:n,Right:r,Bottom:n+this.RowHeight};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom){var u={Rect:l,DataIndex:o,Index:s,Symbol:h};return u.Item=this.PtInItem(t,e,l.Top,l.Bottom),u}n+=this.RowHeight}return null},this.PtInFixedBody=function(t,e){if(this.FixedRowCount<=0)return null;for(var a=this.RectClient.Top+this.HeaderHeight,i=this.RectClient.Left,r=this.RectClient.Right,n=(this.RectClient.Right,this.RectClient.Left,a),o=0;o<this.FixedRowCount;++o){var s={Left:i,Top:n,Right:r,Bottom:n+this.FixedRowHeight};if(t>=s.Left&&t<=s.Right&&e>=s.Top&&e<=s.Bottom){var h={Rect:s,Index:o};return h.Item=this.PtInItem(t,e,s.Top,s.Bottom),h}n+=this.FixedRowHeight}return null},this.PtInItem=function(t,e,a,i){for(var r=this.RectClient.Left,n=this.RectClient.Right,o=r,s=0;s<this.FixedColumn&&s<this.Column.length;++s){var h=this.Column[s],l={Left:o,Right:o+h.Width,Top:a,Bottom:i};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom)return{Rect:l,Column:h,Index:s,IsFixed:!0};o+=h.Width}for(s=this.FixedColumn+this.Data.XOffset;s<this.Column.length;++s){h=this.Column[s];if(o>=n)break;l={Left:o,Right:o+h.Width,Top:a,Bottom:i};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom)return{Rect:l,Column:h,Index:s,IsFixed:!1};o+=h.Width}return null},this.PtInHeader=function(t,e){if(!this.IsShowHeader)return null;var a=this.RectClient.Left,i=this.RectClient.Right,r=this.RectClient.Top,n=r+this.HeaderHeight;return t>=a&&t<=i&&e>=r&&e<=n?this.PtInItem(t,e,r,n):null},this.IsPtInBody=function(t,e){var a=this.RectClient.Top+this.HeaderHeight,i=this.RectClient.Left,r=this.RectClient.Right,n=this.RectClient.Bottom;return t>=i&&t<=r&&e>=a&&e<=n},this.IsPtInHeader=function(t,e){if(!this.IsShowHeader)return!1;var a=this.RectClient.Left,i=this.RectClient.Right,r=this.RectClient.Top,n=r+this.HeaderHeight;return t>=a&&t<=i&&e>=r&&e<=n},this.SendClickEvent=function(t,e){var a=this.GetEventCallback(t);a&&a.Callback&&a.Callback(a,e,this)},this.DrawDragRow=function(){if(this.DragRow){var t=this.DragRow;if(t.Data&&t.Inside&&t.Data.Row){var e=t.Data.Row.DataIndex;if(sa.IsNumber(e)&&!(e<0)){var a=t.Inside.Y-this.RowHeight/2,i=a,r=this.RectClient.Left,n=this.RectClient.Right-this.RectClient.Left;this.Canvas.fillStyle=this.DragRowColor,this.Canvas.fillRect(r,a,n,this.RowHeight);var o=this.Data.Data[e],s={Symbol:o,Stock:null,Block:null};this.GetStockDataCallback&&(s.Stock=this.GetStockDataCallback(o)),this.GetBlockDataCallback&&(s.Block=this.GetBlockDataCallback(o)),s.Decimal=Jr(o);var h=this.RectClient.Right;this.Canvas.font=this.ItemFont;for(var l=0;l<this.FixedColumn&&l<this.Column.length;++l){var u=this.Column[l];if(this.DrawItem(e,s,u,r,i,3),r+=u.Width,r>=h)break}for(l=this.FixedColumn+this.Data.XOffset;l<this.Column.length;++l){u=this.Column[l];if(this.DrawItem(e,s,u,r,i,3),r+=u.Width,r>=h)break}}}}},this.DrawDragHeader=function(){if(this.DragHeader){var t=this.DragHeader,e=t.ClickData,a=e.Header.Rect,i=a.Right-a.Left,r={Left:t.MovePoint.X-i/2,Top:this.RectClient.Top+this.HeaderHeight,Width:i};r.Bottom=r.Top+this.HeaderHeight+this.RowHeight*this.RowCount+this.FixedRowHeight*this.FixedRowCount,r.Right=r.Left+r.Width,r.Height=r.Bottom-r.Top,this.Canvas.fillStyle=this.DragRowColor,this.Canvas.fillRect(r.Left,r.Top,r.Width,r.Height);var n={Left:r.Left,Top:r.Top,Right:r.Right,Width:r.Width,Height:this.HeaderHeight};n.Bottom=n.Top+n.Height,this.DrawHeaderItem(e.Header.Column,n,e.Header.Index,{HeaderColor:this.DragRowTextColor});var o=n.Bottom+this.FixedRowHeight*this.FixedRowCount;this.Canvas.font=this.ItemFont;for(var s=this.GetAllRowCount(),h=this.Data.YOffset,l=0;h<s&&l<this.RowCount;++h,++l){var u=this.Data.Data[h],C={Symbol:u,Stock:null,Block:null};this.GetStockDataCallback&&(C.Stock=this.GetStockDataCallback(u)),this.GetBlockDataCallback&&(C.Block=this.GetBlockDataCallback(u)),this.GetFlashBGDataCallback&&(C.FlashBG=this.GetFlashBGDataCallback(u,Date.now())),C.Decimal=Jr(u);var D=this.Column[e.Header.Index];this.DrawItem(h,C,D,n.Left,o,3),o+=this.RowHeight}}},this.GetTooltipData=function(t,e){if(!sa.IsNonEmptyArray(this.TooltipRect))return null;for(var a=0;a<this.TooltipRect.length;++a){var i=this.TooltipRect[a],r=i.Rect;if(r&&(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom))return{Rect:i.Rect,Stock:i.Stock,Column:i.Column,Index:i.Index,Type:i.Type,Data:i.Data}}return null},this.GetButtonData=function(t,e){if(!sa.IsNonEmptyArray(this.ButtonRect))return null;for(var a=0;a<this.ButtonRect.length;++a){var i=this.ButtonRect[a],r=i.Rect;if(r&&(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom))return{Rect:i.Rect,Stock:i.Stock,Column:i.Column,Index:i.Index,Type:i.Type,Data:i.Data,ColumnIndex:i.ColumnIndex}}},this.PtInHeaderDragBorder=function(t,e){if(!this.IsShowHeader)return null;var a=this.RectClient.Left,i=this.RectClient.Right,r=this.RectClient.Top,n=r+this.HeaderHeight;if(!(t>=a&&t<=i&&e>=r&&e<=n))return null;for(var o=a,s=5*F(),h=0;h<this.FixedColumn&&h<this.Column.length;++h){var l=this.Column[h];if(!0===l.EnableDragWidth){var u={Right:o+l.Width,Top:r,Bottom:n};if(u.Left=u.Right-s,t>=u.Left&&t<=u.Right&&e>=u.Top&&e<=u.Bottom)return{Rect:u,Column:l,Index:h,IsFixed:!0}}o+=l.Width}for(h=this.FixedColumn+this.Data.XOffset;h<this.Column.length;++h){l=this.Column[h];if(o>=i)break;if(!0===l.EnableDragWidth){u={Right:o+l.Width,Top:r,Bottom:n};if(u.Left=u.Right-s,t>=u.Left&&t<=u.Right&&e>=u.Top&&e<=u.Bottom)return{Rect:u,Column:l,Index:h,IsFixed:!1}}o+=l.Width}return null},this.SetSelectedRow=function(t){if(!t)return!1;if(0===this.SelectedModel)return!1;if(t.Symbol){for(var e=t.Symbol,a=!1,i=0;i<this.Data.Data.length;++i){var r=this.Data.Data[i];if(e==r){this.SelectedRow=i,a=!0;break}}return!!a&&(!0===t.AutoYScroll&&this.UpdatePageYOffset({SelectedRow:this.SelectedRow}),a)}return!1},this.UpdatePageYOffset=function(t){if(t){var e=t.SelectedRow;if(!(e<0)){var a=this.GetCurrentPageStatus();a.IsSinglePage||e>=a.Start&&e<=a.End||(this.Data.YOffset=e)}}}}function Xn(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartReportTab",this.IsDrawFirst=!1,this.GetEventCallback,this.Report,this.IsShow=!0,this.TabList=[],this.SelectedTabIndex=-1,this.MoveOnTabIndex=-1,this.MaxPos=15,this.CurrentPos=15,this.Step=1,this.ScrollBarWidth=qi.Report.Tab.ScrollBarWidth,this.ButtonColor=qi.Report.Tab.ButtonColor,this.BarColor=qi.Report.Tab.BarColor,this.BorderColor=qi.Report.Tab.BorderColor,this.Mergin={Left:2,Right:2,Top:2,Bottom:2},this.TabFontConfig={Size:qi.Report.Tab.Font.Size,Name:qi.Report.Tab.Font.Name},this.TabFont,this.TabTitleColor=qi.Report.Tab.TabTitleColor,this.TabSelectedTitleColor=qi.Report.Tab.TabSelectedTitleColor,this.TabSelectedBGColor=qi.Report.Tab.TabSelectedBGColor,this.TabMoveOnTitleColor=qi.Report.Tab.TabMoveOnTitleColor,this.TabBGColor=qi.Report.Tab.TabBGColor,this.TabMergin={Top:qi.Report.Tab.Mergin.Top,Left:qi.Report.Tab.Mergin.Left,Right:qi.Report.Tab.Mergin.Right,Bottom:qi.Report.Tab.Mergin.Bottom},this.Height,this.ButtonSize=25,this.TabWidth=0,this.RectScroll={Left:null,Right:null,Bar:null,Client:null},this.ReloadResource=function(t){this.ScrollBarWidth=qi.Report.Tab.ScrollBarWidth,this.ButtonColor=qi.Report.Tab.ButtonColor,this.BarColor=qi.Report.Tab.BarColor,this.BorderColor=qi.Report.Tab.BorderColor,this.TabFontConfig={Size:qi.Report.Tab.Font.Size,Name:qi.Report.Tab.Font.Name},this.TabTitleColor=qi.Report.Tab.TabTitleColor,this.TabSelectedTitleColor=qi.Report.Tab.TabSelectedTitleColor,this.TabSelectedBGColor=qi.Report.Tab.TabSelectedBGColor,this.TabMoveOnTitleColor=qi.Report.Tab.TabMoveOnTitleColor,this.TabBGColor=qi.Report.Tab.TabBGColor,this.TabMergin={Top:qi.Report.Tab.Mergin.Top,Left:qi.Report.Tab.Mergin.Left,Right:qi.Report.Tab.Mergin.Right,Bottom:qi.Report.Tab.Mergin.Bottom}},this.SetTabList=function(t){this.TabList=[];for(var e=0;e<t.length;++e){var a=t[e];if(a.Title){var i={Title:a.Title,IsMenu:!1,FixedSymbol:[],FixedRowCount:0};if(a.ID&&(i.ID=a.ID),a.CommandID&&(i.CommandID=a.CommandID),sa.IsBool(a.IsMenu)&&(i.IsMenu=a.IsMenu),sa.IsNonEmptyArray(a.FixedSymbol))for(var r=0;r<a.FixedSymbol.length;++r){var n=a.FixedSymbol[r];n&&n.Symbol&&(i.FixedSymbol.push(n),++i.FixedRowCount)}sa.IsNonEmptyArray(a.ArySubMenu)&&(i.ArySubMenu=a.ArySubMenu.slice()),this.TabList.push(i)}}},this.CalculateSize=function(){var t=F();this.TabFont="".concat(this.TabFontConfig.Size*t,"px ").concat(this.TabFontConfig.Name),this.Height=this.GetFontHeight(this.TabFont,"8")+this.Mergin.Top+this.Mergin.Bottom;var e=Math.min(25,this.Height-this.Mergin.Top-this.Mergin.Bottom);this.ButtonSize=e},this.DrawScrollbar=function(t,e,a,i){this.RectScroll={Left:null,Right:null,Bar:null,Client:null};var r=this.Report.GetXScrollPos(),n=this.Report.GetXScrollRange();if(!(n<=0)&&!this.Report.IsShowAllColumn){t=t+this.TabWidth;if(!(t+2*this.ScrollBarWidth>a)){this.MaxPos=n,this.CurrentPos=r;var o=this.ButtonSize,s={Left:t+this.Mergin.Left,Top:i-o-this.Mergin.Bottom,Width:o,Height:o};s.Right=s.Left+o,s.Bottom=s.Top+o;var h={Left:a-o-this.Mergin.Right,Top:s.Top,Width:o,Height:o};h.Right=h.Left+o,h.Bottom=h.Top+o,this.Canvas.fillStyle=this.ButtonColor,this.Canvas.fillRect(s.Left,s.Top,s.Width,s.Height),this.Canvas.fillRect(h.Left,h.Top,h.Width,h.Height),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(s.Left,s.Top,s.Width,s.Height),this.Canvas.strokeRect(h.Left,h.Top,h.Width,h.Height);var l=h.Left-2-(s.Right+2),u=l-this.ScrollBarWidth,C=u*this.CurrentPos/this.MaxPos,D=s.Right+2+C,f={Left:D,Top:s.Top,Width:this.ScrollBarWidth,Height:s.Height};f.Right=f.Left+this.ScrollBarWidth,f.Bottom=s.Bottom,this.Canvas.fillStyle=this.BarColor,this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height),this.RectScroll.Left=s,this.RectScroll.Right=h,this.RectScroll.Bar=f,this.RectScroll.Client={Left:s.Right,Right:h.Left,Top:s.Top,Bottom:s.Bottom}}}},this.DrawTab=function(t,e,a,i){this.TabWidth=0,this.Canvas.font=this.TabFont,this.Canvas.textBaseline="bottom";var r,n=i-e,o=t+1,s=i-this.TabMergin.Bottom,h=0,l=0,u=0;for(u=0;u<this.TabList.length;++u){var C=this.TabList[u];r=C.Title,C.IsMenu&&(r+="▲"),h=o+this.TabMergin.Left,l=this.Canvas.measureText(r).width;var D={Left:o,Top:e,Width:l+this.TabMergin.Left+this.TabMergin.Right,Height:n};if(D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,D.Right>a)break;var f=this.TabBGColor;u==this.SelectedTabIndex&&(f=this.TabSelectedBGColor),this.Canvas.fillStyle=f,this.Canvas.fillRect(D.Left,D.Top,D.Width,D.Height),this.Canvas.textAlign="left";var c=this.TabTitleColor;u==this.MoveOnTabIndex&&(c=this.TabMoveOnTitleColor),u==this.SelectedTabIndex&&(c=this.TabSelectedTitleColor),this.Canvas.fillStyle=c,this.Canvas.fillText(r,h,s),C.Rect=D,o+=D.Width+1,this.TabWidth+=D.Width+1}for(;u<this.TabList.length;++u){C=this.TabList[u];C.Rect=null}},this.OnMouseDown=function(t,e,a){var i=this.PtInTab(t,e);return i||this.PtInScroll(t,e)},this.PtInScroll=function(t,e){if(!this.RectScroll)return null;if(this.RectScroll.Left){var a=this.RectScroll.Left;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:1,Rect:a}}if(this.RectScroll.Right){a=this.RectScroll.Right;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:2,Rect:a}}if(this.RectScroll.Bar){a=this.RectScroll.Bar;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:3,Rect:a}}if(this.RectScroll.Client){a=this.RectScroll.Client;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:4,Rect:a,Pos:this.GetScrollPostionByPoint(t,e)}}return null},this.PtInTab=function(t,e){for(var a=0;a<this.TabList.length;++a){var i=this.TabList[a];if(i.Rect){var r=i.Rect;if(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom){var n={Type:5,Rect:r,Tab:i,Index:a};return i.IsMenu,n}}}return null},this.GetFontHeight=function(t,e){return E(this.Canvas,t,e)},this.GetScrollPostionByPoint=function(t,e){var a=this.RectScroll.Client,i=a.Right-a.Left-this.ScrollBarWidth,r=parseInt(this.MaxPos*(t-a.Left)/i);return r}}function Wn(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartPageInfo",this.IsDrawFirst=!1,this.IsShow=!1,this.SizeChange=!0,this.Report,this.FontConfig={Size:qi.Report.PageInfo.Font.Size,Name:qi.Report.PageInfo.Font.Name},this.TextColor=qi.Report.PageInfo.TextColor,this.BGColor=qi.Report.PageInfo.BGColor,this.Mergin={Top:qi.Report.PageInfo.Mergin.Top,Left:qi.Report.PageInfo.Mergin.Left,Right:qi.Report.PageInfo.Mergin.Right,Bottom:qi.Report.PageInfo.Mergin.Bottom},this.Font,this.TextHeight=0,this.ReloadResource=function(t){this.FontConfig={Size:qi.Report.PageInfo.Font.Size,Name:qi.Report.PageInfo.Font.Name},this.TextColor=qi.Report.PageInfo.TextColor,this.BGColor=qi.Report.PageInfo.BGColor,this.Mergin={Top:qi.Report.PageInfo.Mergin.Top,Left:qi.Report.PageInfo.Mergin.Left,Right:qi.Report.PageInfo.Mergin.Right,Bottom:qi.Report.PageInfo.Mergin.Bottom}},this.Draw=function(){if(this.IsShow&&this.Report){var t=this.Report.GetCurrentPageStatus();if(!t.IsSinglePage){if(this.SizeChange){var e=F();this.Font="".concat(this.FontConfig.Size*e,"px ").concat(this.FontConfig.Name),this.TextHeight=E(this.Canvas,this.Font,"擎")+this.Mergin.Top+this.Mergin.Bottom}var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight(),r=this.ChartBorder.GetBottom()-2,n=a+(i-a)/2,o="".concat(t.DataCount,"/").concat(t.DataCount);this.Canvas.font=this.Font;var s=this.Canvas.measureText(o).width+4,h=n-s/2-this.Mergin.Left,l=r-this.TextHeight;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(h,l,s+(this.Mergin.Left+this.Mergin.Right),this.TextHeight),o="".concat(t.Start+1,"/").concat(t.DataCount),this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(o,n,r-this.Mergin.Bottom),this.SizeChange=!1}}}}function Un(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartVScrollbar",this.IsDrawFirst=!1,this.GetEventCallback,this.Report,this.MaxPos=15,this.CurrentPos=15,this.Step=1,this.ButtonSize=25,this.Enable=!1,this.LastStatus={Draw:!1},this.GlobalOption,this.Style=0,this.ScrollBarHeight=qi.Report.VScrollbar.ScrollBarHeight,this.ButtonColor=qi.Report.VScrollbar.ButtonColor,this.BarColor=qi.Report.VScrollbar.BarColor,this.BorderColor=qi.Report.VScrollbar.BorderColor,this.BGColor=qi.Report.VScrollbar.BGColor,this.Margin={Left:2,Right:2,Top:2,Bottom:2},this.BarWithConfig={Size:qi.Report.VScrollbar.BarWidth.Size},this.RectScroll={Top:null,Bottom:null,Bar:null,Client:null},this.SetOption=function(t){if(t&&(sa.IsBool(t.Enable)&&(this.Enable=t.Enable),sa.IsNumber(t.Style)&&(this.Style=t.Style),sa.IsNumber(t.BarWidth)&&(this.BarWithConfig.Size=t.BarWidth),t.Margin)){var e=t.Margin;sa.IsNumber(e.Top)&&(this.Margin.Top=e.Top),sa.IsNumber(e.Bottom)&&(this.Margin.Bottom=e.Bottom),sa.IsNumber(e.Left)&&(this.Margin.Left=e.Left),sa.IsNumber(e.Right)&&(this.Margin.Right=e.Right)}},this.ReloadResource=function(t){this.ScrollBarHeight=qi.Report.VScrollbar.ScrollBarHeight,this.ButtonColor=qi.Report.VScrollbar.ButtonColor,this.BarColor=qi.Report.VScrollbar.BarColor,this.BorderColor=qi.Report.VScrollbar.BorderColor,this.BGColor=qi.Report.VScrollbar.BGColor,this.BarWithConfig={Size:qi.Report.VScrollbar.BarWidth.Size}},this.CalculateSize=function(){var t=F(),e=this.BarWithConfig.Size*t+this.Margin.Left+this.Margin.Right;this.ButtonSize=Math.min(25,e)},this.DrawScrollbarStyle2=function(t,e,a,i){if(this.LastStatus.Draw=!1,this.RectScroll={Left:null,Right:null,Bar:null,Client:null},this.Enable){var r=this.IsShowCallback();if(r){var n=this.Report.GetCurrentPageStatus();if(!n.IsSinglePage){var o=n.Start,s=n.DataCount-n.PageSize,h=this.ButtonSize;this.MaxPos=s,this.CurrentPos=o;var l=e+this.Margin.Top+2,u=i-this.Margin.Bottom-2,C=u-l,D=C-this.ScrollBarHeight,f=D*this.CurrentPos/this.MaxPos,c=l+2+f,m={Right:a-this.Margin.Right,Top:c,Width:h,Height:this.ScrollBarHeight};m.Left=m.Right-h,m.Bottom=m.Top+m.Height,m.Bottom>u-2&&(m.Bottom=u-2,m.Top=m.Bottom-m.Height),this.RectScroll.Bar=m,this.RectScroll.Client={Left:m.Left,Right:m.Right,Top:l,Bottom:u};var d={Right:a,Top:e,Bottom:i,Width:h+this.Margin.Right+this.Margin.Left};d.Left=d.Right-d.Width,d.Height=d.Bottom-d.Top,this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(d.Left,d.Top,d.Width,d.Height),this.Canvas.fillStyle=this.BarColor,this.Canvas.fillRect(m.Left,m.Top,m.Width,m.Height),this.LastStatus.Draw=!0}}}},this.DrawScrollbarStyle=function(t,e,a,i){if(this.LastStatus.Draw=!1,this.RectScroll={Left:null,Right:null,Bar:null,Client:null},this.Enable){var r=this.IsShowCallback();if(r){var n=this.Report.GetCurrentPageStatus();if(!n.IsSinglePage){var o=n.Start,s=n.DataCount-n.PageSize,h=this.ButtonSize;this.MaxPos=s,this.CurrentPos=o;var l={Right:a-this.Margin.Right,Top:e+this.Margin.Top,Width:h,Height:h};l.Left=l.Right-h,l.Bottom=l.Top+h;var u={Right:a-this.Margin.Right,Bottom:i-this.Margin.Bottom,Width:h,Height:h};u.Left=u.Right-h,u.Top=u.Bottom-h;var C=u.Top-2-(l.Bottom+2),D=C-this.ScrollBarHeight,f=D*this.CurrentPos/this.MaxPos,c=l.Bottom+2+f,m={Right:a-this.Margin.Right,Top:c,Width:h,Height:this.ScrollBarHeight};m.Left=m.Right-h,m.Bottom=m.Top+m.Height,m.Bottom>u.Top-2&&(m.Bottom=u.Top-2,m.Top=m.Bottom-m.Height),this.RectScroll.Top=l,this.RectScroll.Bottom=u,this.RectScroll.Bar=m,this.RectScroll.Client={Left:l.Left,Right:l.Right,Top:l.Bottom,Bottom:u.Top};var d={Right:a,Top:e,Bottom:i,Width:h+this.Margin.Right+this.Margin.Left};d.Left=d.Right-d.Width,d.Height=d.Bottom-d.Top,this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(d.Left,d.Top,d.Width,d.Height),this.Canvas.fillStyle=this.ButtonColor,this.Canvas.fillRect(l.Left,l.Top,l.Width,l.Height),this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(l.Left,l.Top,l.Width,l.Height),this.Canvas.strokeRect(u.Left,u.Top,u.Width,u.Height),this.Canvas.fillStyle=this.BarColor,this.Canvas.fillRect(m.Left,m.Top,m.Width,m.Height),this.LastStatus.Draw=!0}}}},this.DrawScrollbar=function(t,e,a,i){1==this.Style?this.DrawScrollbarStyle2(t,e,a,i):this.DrawScrollbarStyle(t,e,a,i)},this.OnMouseDown=function(t,e,a){return this.PtInScroll(t,e)},this.PtInScroll=function(t,e){if(!this.RectScroll)return null;if(this.RectScroll.Top){var a=this.RectScroll.Top;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:1,Rect:a}}if(this.RectScroll.Bottom){a=this.RectScroll.Bottom;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:2,Rect:a}}if(this.RectScroll.Bar){a=this.RectScroll.Bar;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:3,Rect:a}}if(this.RectScroll.Client){a=this.RectScroll.Client;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:4,Rect:a,Pos:this.GetScrollPostionByPoint(t,e)}}return null},this.GetScrollPostionByPoint=function(t,e){var a=this.RectScroll.Client,i=a.Bottom-a.Top-this.ScrollBarHeight,r=parseInt(this.MaxPos*(e-a.Top)/i);return r}}function Kn(t){this.DivElement=t,this.JSChartContainer,this.ResizeListener,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jskeyboard-drawing",this.CanvasElement.id=N(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&u.Chart.Log("[JSKeyboardChart::JSRepoJSKeyboardChartrtChart] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OnSize=function(){var t=this.DivElement.offsetHeight,e=this.DivElement.offsetWidth;this.DivElement.style.height&&this.DivElement.style.width&&(this.DivElement.style.height.includes("px")&&(t=parseInt(this.DivElement.style.height.replace("px",""))),this.DivElement.style.width.includes("px")&&(e=parseInt(this.DivElement.style.width.replace("px","")))),this.CanvasElement.height=t,this.CanvasElement.width=e,this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var a=F();this.CanvasElement.height*=a,this.CanvasElement.width*=a,u.Chart.Log("[JSKeyboardChart::OnSize] devicePixelRatio=".concat(window.devicePixelRatio,", height=").concat(this.CanvasElement.height,", width=").concat(this.CanvasElement.width)),this.JSChartContainer&&this.JSChartContainer.OnSize&&this.JSChartContainer.OnSize()},this.SetOption=function(t){var e=this.CreateJSKeyboardChartContainer(t);if(!e)return!1;if(t.OnCreatedCallback&&t.OnCreatedCallback(e),this.JSChartContainer=e,this.DivElement.JSChart=this,t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}1==t.EnableResize&&this.CreateResizeListener(),e.Draw()},this.CreateJSKeyboardChartContainer=function(t){var e=new zn(this.CanvasElement);if(e.Create(t),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),sa.IsNonEmptyArray(t.Column)&&e.SetColumn(t.Column),sa.IsNumber(t.BorderLine)&&(e.Frame.BorderLine=t.BorderLine),this.SetChartBorder(e,t),t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}return e},this.SetChartBorder=function(t,e){if(e.Border){e.Border;sa.IsNumber(e.Border.Left)&&(t.Frame.ChartBorder.Left=e.Border.Left),sa.IsNumber(e.Border.Right)&&(t.Frame.ChartBorder.Right=e.Border.Right),sa.IsNumber(e.Border.Top)&&(t.Frame.ChartBorder.Top=e.Border.Top),sa.IsNumber(e.Border.Bottom)&&(t.Frame.ChartBorder.Bottom=e.Border.Bottom);var a=F();t.Frame.ChartBorder.Left*=a,t.Frame.ChartBorder.Right*=a,t.Frame.ChartBorder.Top*=a,t.Frame.ChartBorder.Bottom*=a}},this.CreateResizeListener=function(){var t=this;this.ResizeListener=new ResizeObserver((function(e){t.OnDivResize(e)})),this.ResizeListener.observe(this.DivElement)},this.OnDivResize=function(t){u.Chart.Log("[JSKeyboardChart::OnDivResize] entries=",t),this.OnSize()},this.SetColumn=function(t,e){this.JSChartContainer&&this.JSChartContainer.SetColumn(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(u.Chart.Log("[JSKeyboardChart:AddEventCallback] obj=",t),this.JSChartContainer.AddEventCallback(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(u.Chart.Log("[JSKeyboardChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.ChartDestroy=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestroy&&this.JSChartContainer.ChartDestroy()},this.Draw=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(u.Chart.Log("[JSKeyboardChart:Draw] "),this.JSChartContainer.Draw())},this.SetSymbolData=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(u.Chart.Log("[JSKeyboardChart:SetSymbolData] ",t),this.JSChartContainer.SetSymbolData(t))},this.Search=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Search&&(u.Chart.Log("[JSKeyboardChart:Search] ",t),this.JSChartContainer.Search(t))},this.OnKeyDown=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.OnKeyDown&&(u.Chart.Log("[JSKeyboardChart:OnKeyDown] ",t),this.JSChartContainer.OnKeyDown(t))},this.ClearSearch=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearSearch&&(u.Chart.Log("[JSKeyboardChart:ClearSearch] ",t),this.JSChartContainer.ClearSearch(t))}}function zn(t){this.ClassName="JSKeyboardChartContainer",this.Frame,this.ChartPaint=[],this.Canvas=t.getContext("2d"),this.ShowCanvas=null,this.NetworkFilter,this.Data={XOffset:0,YOffset:0,Data:[]},this.MapSymbol=new Map,this.SourceData={Data:[]},this.FunctionKeyData=[],this.mapEvent=new Map,this.UIElement=t,this.LastPoint=new V,this.DragYScroll=null,this.IsDestroy=!1,this.ChartDestroy=function(){this.IsDestroy=!0},this.ClearSearch=function(t){this.Data.Data=[],this.Data.XOffset=0,this.Data.YOffset=0,t&&1==t.Redraw&&this.Draw()},this.SearchFunctionKeyData=function(t){if(t.length<=0)return null;if(!sa.IsNonEmptyArray(this.FunctionKeyData))return null;for(var e=[],a=0;a<this.FunctionKeyData.length;++a){var i=this.FunctionKeyData[a];if(i&&sa.IsNonEmptyArray(i.Data)){for(var r=[],n=[],s=[],h=0;h<i.Data.length;++h){var l=i.Data[h];this.SearchSymbol(l,t,r,n,s)}sa.IsNonEmptyArray(s)&&e.push.apply(e,(0,o.default)(s)),sa.IsNonEmptyArray(r)&&e.push.apply(e,(0,o.default)(r)),sa.IsNonEmptyArray(n)&&e.push.apply(e,(0,o.default)(n))}}return e.length>0?e:null},this.Search=function(t){var e,a,i,r,n=[],s=[],h=[],l=null;this.MapSymbol.clear(),this.Data.Data=[],this.Data.XOffset=0,this.Data.YOffset=0;var C=t.trim();if(C.length>0){l=this.SearchFunctionKeyData(C);for(var D=0;D<this.SourceData.Data.length;++D){var f=this.SourceData.Data[D];this.SearchSymbol(f,C,n,s,h)||this.SearchSpell(f,C,n,s)}}sa.IsNonEmptyArray(l)&&(e=this.Data.Data).push.apply(e,(0,o.default)(l)),sa.IsNonEmptyArray(h)&&(a=this.Data.Data).push.apply(a,h),sa.IsNonEmptyArray(n)&&(i=this.Data.Data).push.apply(i,n),sa.IsNonEmptyArray(s)&&(r=this.Data.Data).push.apply(r,s),this.ChartPaint[0].SelectedRow=0,this.ChartPaint[0].SizeChange=!0,u.Chart.Log("[JSKeyboardChart:Search] search=".concat(C,", source=").concat(this.SourceData.Data.length," match=").concat(this.Data.Data.length)),this.Draw()},this.SearchSymbol=function(t,e,a,i,r){var n=t.Symbol.indexOf(e);return!(n<0)&&(t.Symbol==e?r.push(t.Symbol):0==n?a.push(t.Symbol):i.push(t.Symbol),this.MapSymbol.set(t.Symbol,t),!0)},this.SearchSpell=function(t,e,a,i){if(!sa.IsString(t.Spell))return!1;var r=t.Spell.indexOf(e);return 0==r&&(a.push(t.Symbol),this.MapSymbol.set(t.Symbol,t),!0)},this.SetSymbolData=function(t){this.SourceData.Data=[];for(var e=0;e<t.length;++e){var a=t[e];sa.IsNumber(a.Priority)?(this.FunctionKeyData[a.Priority]||(this.FunctionKeyData[a.Priority]={Priority:a.Priority,Data:[]}),this.FunctionKeyData[a.Priority].Data.push(a)):this.SourceData.Data.push(a)}},this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.Frame=new Jn,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas;var a=new Qn;a.Frame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.UIElement=this.UIElement,a.GetEventCallback=function(t){return e.GetEventCallback(t)},a.GetStockDataCallback=function(t){return e.GetStockData(t)},a.Data=this.Data,this.ChartPaint[0]=a,a.VScrollbar=new qn,a.VScrollbar.Frame=this.Frame,a.VScrollbar.Canvas=this.Canvas,a.VScrollbar.ChartBorder=this.Frame.ChartBorder,a.VScrollbar.Report=a;var i=!0,r=!0;t&&(!1===t.KeyDown&&(i=!1,u.Chart.Log("[JSKeyboardChartContainer::Create] not register keydown event.")),!1===t.Wheel&&(r=!1,u.Chart.Log("[JSKeyboardChartContainer::Create] not register wheel event."))),i&&this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),r&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0),this.UIElement.ondblclick=function(t){e.UIOnDblClick(t)},this.UIElement.onmousedown=function(t){e.UIOnMouseDown(t)},this.UIElement.oncontextmenu=function(t){e.UIOnContextMenu(t)},this.UIElement.onmousemove=function(t){e.UIOnMouseMove(t)},this.UIElement.onmouseout=function(t){e.UIOnMounseOut(t)},this.UIElement.onmouseleave=function(t){e.UIOnMouseleave(t)}},this.Draw=function(){if(!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var t=F();this.Canvas.lineWidth=t,this.Frame.Draw(),this.Frame.DrawLogo();for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.IsDrawFirst&&a.Draw()}for(e=0;e<this.ChartPaint.length;++e){a=this.ChartPaint[e];a.IsDrawFirst||a.Draw()}}},this.GetStockData=function(t){return this.MapSymbol.has(t)?this.MapSymbol.get(t):null},this.ResetStatus=function(){this.Data.XOffset=0,this.Data.YOffset=0},this.ResetSelectStatus=function(){var t=this.GetReportChart();t&&(t.SelectedRow=-1,t.SelectedFixedRow=-1)},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.OnSize=function(){this.Frame&&(this.SetSizeChange(!0),this.Draw())},this.SetSizeChange=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&(a.SizeChange=t)}},this.OnWheel=function(t){if(u.Chart.Log("[JSKeyboardChartContainer::OnWheel]",t),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var e,a=t.clientX-this.UIElement.getBoundingClientRect().left,i=t.clientY-this.UIElement.getBoundingClientRect().top;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),e=this.Canvas.isPointInPath(a,i),e){var r=this.ChartPaint[0];if(r){var n=t.wheelDelta;sa.IsObjectExist(t.wheelDelta)||(n=-.01*t.deltaY),n<0?this.GotoNextPage(this.PageUpDownCycle)&&this.Draw():n>0&&this.GotoPreviousPage(this.PageUpDownCycle)&&this.Draw(),t.preventDefault?t.preventDefault():t.returnValue=!1}}}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this.GetReportChart();if(e){var a=t.keyCode?t.keyCode:t.which;switch(a){case 33:this.GotoPreviousPage(this.PageUpDownCycle)&&this.Draw();break;case 34:this.GotoNextPage(this.PageUpDownCycle)&&this.Draw();break;case 38:var i=this.MoveSelectedRow(-1);i&&i.Redraw&&this.Draw();break;case 40:i=this.MoveSelectedRow(1);i&&i.Redraw&&this.Draw();break;case 37:this.MoveXOffset(-1)&&this.Draw();break;case 39:this.MoveXOffset(1)&&this.Draw();break;case 13:this.OnSelectedSymbol();break}t.preventDefault?t.preventDefault():t.returnValue=!1}}},this.OnSelectedSymbol=function(){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var t=this.ChartPaint[0];if(!t)return!1;var e=t.GetSelectedSymbol(),a=this.MapSymbol.get(e.Symbol);if(!a)return!1;var i=this.GetEventCallback(m.ON_KEYBOARD_SELECTED);i&&i.Callback&&i.Callback(i,{Data:e,RowData:a},this)},this.UIOnDblClick=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=this.ChartPaint[0];r&&r.OnDblClick(a,i,t)&&this.OnSelectedSymbol()},this.UIOnMouseDown=function(t){var e=this;this.DragYScroll=null,this.DragMove={Click:{X:t.clientX,Y:t.clientY},Move:{X:t.clientX,Y:t.clientY},PreMove:{X:t.clientX,Y:t.clientY}};var a=F(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a,n=this.ChartPaint[0];if(n){var o=n.OnMouseDown(i,r,t);if(!o)return;if(2!=o.Type||0!=t.button&&2!=t.button){if(5==o.Type&&0==t.button){var s=o.VScrollbar;1==s.Type?this.MoveYOffset(-1)&&this.Draw():2==s.Type?this.MoveYOffset(1)&&this.Draw():3==s.Type?this.DragYScroll={Click:{X:i,Y:r},LastMove:{X:i,Y:r}}:4==s.Type&&this.SetYOffset(s.Pos)&&this.Draw()}}else 1==o.Redraw&&this.Draw()}document.onmousemove=function(t){e.DocOnMouseMove(t)},document.onmouseup=function(t){e.DocOnMouseUp(t)}},this.UIOnContextMenu=function(t){t.preventDefault()},this.UIOnMouseMove=function(t){var e=F();t.clientX,this.UIElement.getBoundingClientRect().left,t.clientY,this.UIElement.getBoundingClientRect().top},this.UIOnMounseOut=function(t){},this.UIOnMouseleave=function(t){},this.DocOnMouseMove=function(t){if(this.DragMove.PreMove.X=this.DragMove.Move.X,this.DragMove.PreMove.Y=this.DragMove.Move.Y,this.DragMove.Move.X=t.clientX,this.DragMove.Move.Y=t.clientX,!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(this.DragYScroll){var r=this.ChartPaint[0];if(!r||!r.VScrollbar)return;this.DragYScroll.LastMove.X=a,this.DragYScroll.LastMove.Y=i;var n=r.VScrollbar.GetScrollPostionByPoint(a,i);this.SetYOffset(n)&&this.Draw()}}},this.DocOnMouseUp=function(t){document.onmousemove=null,document.onmouseup=null,this.DragYScroll=null;var e=this.GetEventCallback(m.ON_KEYBOARD_MOUSEUP);e&&e.Callback&&e.Callback(e,{},this)},this.GetMoveAngle=function(t,e){var a=Math.abs(t.X-e.X),i=Math.abs(t.Y-e.Y),r=180*Math.atan(a/i)/Math.PI;return r},this.PreventTouchEvent=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},this.OnDragYOffset=function(t,e,a,i){if(a<5)return!1;var r=!0;t.LastMove.Y<e[0].clientY&&(r=!1);var n=this.YStepPixel;n<=0&&(n=5);var o=parseInt(a/n);return!(o<=0)&&(0==r&&(o*=-1),this.MoveYOffset(o,this.DragPageCycle)&&(t.IsYMove=!0,this.Draw(),this.DelayUpdateStockData()),!0)},this.OnDragXOffset=function(t,e,a,i){if(a<5)return!1;var r=!0;t.LastMove.X<e[0].clientX&&(r=!1);var n=this.XStepPixel;n<=0&&(n=5);var o=parseInt(a/n);return!(o<=0)&&(r||(o*=-1),this.MoveXOffset(o)&&(t.IsXMove=!0,this.Draw()),!0)},this.GetReportChart=function(){var t=this.ChartPaint[0];return t},this.GotoNextPage=function(t){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize();if(a>this.Data.Data.length)return!1;if(this.Data.YOffset+a>=this.Data.Data.length)return!0===t&&(this.Data.YOffset=0,!0);this.Data.YOffset+=a;this.Data.Data.length,this.Data.YOffset;return e.SelectedRow=this.Data.YOffset,!0},this.GotoPreviousPage=function(t){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize();if(a>this.Data.Data.length)return!1;if(this.Data.YOffset<=0)return!0===t&&(this.Data.YOffset=this.Data.Data.length-a,!0);var i=this.Data.YOffset;return i-=a,i<0&&(i=0),this.Data.YOffset=i,e.SelectedRow=this.Data.YOffset,!0},this.MoveYOffset=function(t,e){if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return!1;var a=this.ChartPaint[0];if(!a)return!1;var i=a.GetCurrentPageStatus();if(i.IsSinglePage)return!1;if(t>0){var r=this.Data.Data.length,n=i.PageSize,o=this.Data.YOffset;if(e)for(var s=0;s<t;++s)++o,o+n>r&&(o=0);else{if(o+n>=r)return!1;for(s=0;s<t;++s){if(o+n+1>r)break;++o}}return this.Data.YOffset=o,!0}if(t<0){t=Math.abs(t);o=this.Data.YOffset;if(e)for(n=i.PageSize,s=0;s<t;++s)--o,o<0&&(o=this.Data.Data.length-n);else{if(this.Data.YOffset<=0)return!1;for(s=0;s<t;++s){if(o-1<0)break;--o}}return this.Data.YOffset=o,!0}return!1},this.GotoLastPage=function(){var t=this.ChartPaint[0];if(t){var e=t.GetPageSize(!0),a=this.Data.Data.length-e;a<0&&(a=0),this.Data.DataOffset=a}},this.SetColumn=function(t,e){var a=this.ChartPaint[0];a&&(a.SetColumn(t),a.SizeChange=!0,e&&e.Redraw&&this.Draw())},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}t&&t.Redraw&&(this.SetSizeChange(!0),this.Draw())},this.MoveSelectedRow=function(t){var e=this.ChartPaint[0];if(!e)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;var a={Redraw:!1},i=e.GetCurrentPageStatus(),r=(i.PageSize,i.SelectedRow);if(t>0){if(r<0||r<i.Start||r>i.End)return e.SelectedRow=i.Start,a.Redraw=!0,a;for(var n=this.Data.YOffset,o=0;o<t;++o){if(++r,r>i.End&&++n,r>=this.Data.Data.length)break;a.Redraw=!0,e.SelectedRow=r,this.Data.YOffset=n}return a}if(t<0){if(r<0||r<i.Start||r>i.End)return e.SelectedRow=i.End,a.Redraw=!0,a;t=Math.abs(t);for(n=this.Data.YOffset,o=0;o<t;++o){if(--r,r<i.Start&&--n,r<0)break;a.Redraw=!0,e.SelectedRow=r,this.Data.YOffset=n}return a}},this.SetYOffset=function(t){if(!sa.IsNumber(t))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetYScrollRange();return t<0&&(t=0),t>a&&(t=a),this.Data.YOffset=t,!0}}function Jn(){this.ChartBorder,this.Canvas,this.BorderLine=null,this.BorderColor=qi.Keyboard.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font,this.ReloadResource=function(t){this.BorderColor=qi.Keyboard.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font},this.Draw=function(){var t=A(this.ChartBorder.GetLeft()),e=A(this.ChartBorder.GetTop()),a=A(this.ChartBorder.GetRight()),i=A(this.ChartBorder.GetBottom()),r=a-t,n=i-e;sa.IsNumber(this.BorderLine)?(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke()):(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,e,r,n))},this.DrawLogo=function(){var t=qi.FrameLogo.Text;if(sa.IsString(t)){this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="right",this.Canvas.textBaseline="bottom";var e=this.ChartBorder.GetRight()-30,a=this.ChartBorder.GetBottom()-5;this.Canvas.fillText(t,e,a)}}}Kn.Init=function(t){var e=new Kn(t);return e.OnSize(),e},Kn.SetStyle=function(t){t&&qi.SetStyle(t)};var Zn={SHORT_SYMBOL_ID:0,SYMBOL_ID:1,NAME_ID:2,TYPE_ID:3,TYPE_NAME_ID:4};function Qn(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartSymbolList",this.UIElement,this.IsDrawFirst=!1,this.GetEventCallback,this.Data,this.SizeChange=!0,this.SelectedRow=-1,this.IsDrawBorder=!1,this.ShowSymbol=[],this.VScrollbar,this.BorderColor=qi.Keyboard.BorderColor,this.SelectedColor=qi.Keyboard.SelectedColor,this.TextColor=qi.Keyboard.TextColor,this.ItemFontConfig={Size:qi.Keyboard.Item.Font.Size,Name:qi.Keyboard.Item.Font.Name},this.ItemMergin={Left:qi.Keyboard.Item.Mergin.Left,Right:qi.Keyboard.Item.Mergin.Right,Top:qi.Keyboard.Item.Mergin.Top,Bottom:qi.Keyboard.Item.Mergin.Bottom},this.ItemFont=15*F()+"px 微软雅黑",this.ItemSymbolFont=12*F()+"px 微软雅黑",this.ItemNameFont=15*F()+"px 微软雅黑",this.ItemNameHeight=0,this.RowCount=0,this.RowHeight=0,this.Column=[{Type:Zn.SHORT_SYMBOL_ID,Title:"代码",TextAlign:"left",Width:null,MaxText:"888888"},{Type:Zn.NAME_ID,Title:"名称",TextAlign:"left",Width:null,MaxText:"擎擎擎擎擎擎"},{Type:Zn.TYPE_NAME_ID,Title:"类型",TextAlign:"right",Width:null,MaxText:"擎擎擎擎"}],this.RectClient={},this.ReloadResource=function(t){this.BorderColor=qi.Keyboard.BorderColor,this.SelectedColor=qi.Keyboard.SelectedColor,this.TextColor=qi.Keyboard.TextColor,this.VScrollbar&&this.VScrollbar.ReloadResource(t)},this.SetColumn=function(t){if(sa.IsNonEmptyArray(t)){this.Column=[];for(var e=0;e<t.length;++e){var a=t[e],i=this.GetDefaultColunm(a.Type);i&&(a.Title&&(i.Title=a.Title),a.TextAlign&&(i.TextAlign=a.TextAlign),a.MaxText&&(i.MaxText=a.MaxText),this.Column.push(i))}}},this.GetDefaultColunm=function(t){for(var e=[{Type:Zn.SHORT_SYMBOL_ID,Title:"代码",TextAlign:"left",Width:null,MaxText:"888888"},{Type:Zn.NAME_ID,Title:"名称",TextAlign:"left",Width:null,MaxText:"擎擎擎擎擎擎"},{Type:Zn.TYPE_NAME_ID,Title:"类型",TextAlign:"right",Width:null,MaxText:"擎擎擎擎"}],a=0;a<e.length;++a){var i=e[a];if(i.Type==t)return i}return null},this.Draw=function(){this.ShowSymbol=[],this.SizeChange?this.CalculateSize():this.UpdateCacheData();var t=this.IsShowVScrollbar();if(this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(this.RectClient.Left,this.RectClient.Top+1,this.RectClient.Right-this.RectClient.Left,this.RectClient.Bottom-(this.RectClient.Top+1)),this.Canvas.clip(),this.DrawBody(),this.Canvas.restore(),this.DrawBorder(),this.VScrollbar&&t){var e=this.ChartBorder.GetBottom();this.VScrollbar.DrawScrollbar(this.RectClient.Left,this.RectClient.Top+2,this.RectClient.Right+this.VScrollbar.ButtonSize+2,e-2)}this.SizeChange=!1},this.UpdateCacheData=function(){this.RectClient.Left=this.ChartBorder.GetLeft(),this.RectClient.Right=this.ChartBorder.GetRight(),this.RectClient.Top=this.ChartBorder.GetTop(),this.RectClient.Bottom=this.ChartBorder.GetBottom();var t=this.IsShowVScrollbar();t&&this.VScrollbar&&this.VScrollbar.Enable&&(this.RectClient.Right-=this.VScrollbar.ButtonSize+2)},this.GetPageSize=function(t){t&&this.CalculateSize();var e=this.RowCount;return e},this.GetCurrentPageStatus=function(){var t={Start:this.Data.YOffset,PageSize:this.RowCount,IsEnd:!1,SelectedRow:this.SelectedRow,IsSinglePage:!1,DataCount:0};return sa.IsNonEmptyArray(this.Data.Data)?(t.End=this.Data.YOffset+this.RowCount-1,t.IsSinglePage=this.Data.Data.length<=this.RowCount,t.DataCount=this.Data.Data.length,t.End>=this.Data.Data.length-1&&(t.IsEnd=!0),t.End>=this.Data.Data.length&&(t.End=this.Data.Data.length-1)):(t.Star=0,t.End=0,t.IsEnd=!0,t.IsSinglePage=!0),t},this.CalculateSize=function(){this.VScrollbar&&this.VScrollbar.Enable&&this.VScrollbar.CalculateSize(),this.UpdateCacheData();var t=F();this.ItemFont="".concat(this.ItemFontConfig.Size*t,"px ").concat(this.ItemFontConfig.Name),this.RowHeight=this.GetFontHeight(this.ItemFont,"擎")+this.ItemMergin.Top+this.ItemMergin.Bottom;var e=this.RectClient.Left,a=this.RectClient.Right;this.Canvas.font=this.ItemFont;for(var i=0,r=0;r<this.Column.length;++r){var n=this.Column[r];i=this.Canvas.measureText(n.MaxText).width,n.Width=i+4+this.ItemMergin.Left+this.ItemMergin.Right,r==this.Column.length-1&&e+n.Width<a&&(n.Width=a-e),e+=n.Width}this.RowCount=parseInt((this.RectClient.Bottom-this.RectClient.Top)/this.RowHeight)},this.DrawText=function(t,e,a,i,r){"center"==e?(a+=r/2,this.Canvas.textAlign="center"):"right"==e?(a+=r,this.Canvas.textAlign="right"):this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(t,a,i)},this.DrawBorder=function(){if(this.IsDrawBorder){var t=this.RectClient.Left,e=this.RectClient.Right,a=this.RectClient.Top;this.RectClient.Bottom;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,A(a)),this.Canvas.lineTo(e,A(a));for(var i=a+this.RowHeight,r=i,n=0;n<this.RowCount;++n){var o=A(i);this.Canvas.moveTo(t,o),this.Canvas.lineTo(e,o),r=i,i+=this.RowHeight}var s=t;for(n=this.Data.XOffset;n<this.Column.length;++n){var h=this.Column[n],l=A(s+h.Width);this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,r),s+=h.Width}this.Canvas.stroke()}},this.GetSelectedSymbol=function(){return this.SelectedRow<0||this.SelectedRow>=this.Data.Data.length?null:{Symbol:this.Data.Data[this.SelectedRow],RowID:this.SelectedRow}},this.DrawBody=function(){if(this.Data&&sa.IsNonEmptyArray(this.Data.Data)){this.Canvas.font=this.ItemFont;var t=this.RectClient.Top,e=this.RectClient.Left,a=this.RectClient.Right-this.RectClient.Left,i=t;this.Canvas.font=this.ItemFont;for(var r=this.Data.YOffset,n=0;r<this.Data.Data.length&&n<this.RowCount;++r,++n){var o=this.Data.Data[r],s=!1;r==this.SelectedRow&&(s=!0),s&&(this.Canvas.fillStyle=this.SelectedColor,this.Canvas.fillRect(e+1,i,a,this.RowHeight)),this.DrawRow(o,i,r),this.ShowSymbol.push({Index:r,Symbol:o}),i+=this.RowHeight}}},this.DrawRow=function(t,e,a,i){var r=this.RectClient.Left,n=this.RectClient.Right,o={Symbol:t,Stock:null,Block:null};this.GetStockDataCallback&&(o.Stock=this.GetStockDataCallback(t));for(var s=this.Data.XOffset;s<this.Column.length;++s){var h=this.Column[s];if(this.DrawItem(a,o,h,r,e,i),r+=h.Width,r>=n)break}},this.DrawItem=function(t,e,a,i,r,n){a.Width;var o=i+this.ItemMergin.Left,s=a.Width-this.ItemMergin.Left-this.ItemMergin.Right,h=e.Stock,l={Text:null,TextColor:this.TextColor,TextAlign:a.TextAlign};a.Type==Zn.SHORT_SYMBOL_ID?(h&&h.ShortSymbol?l.Text=h.ShortSymbol:l.Text=e.Symbol,h.Color&&(l.TextColor=h.Color)):a.Type==Zn.NAME_ID?h&&h.Name&&(l.Text=this.TextEllipsis(h.Name,s,a.MaxText),h.Color&&(l.TextColor=h.Color)):a.Type==Zn.TYPE_NAME_ID&&h&&h.TypeName&&(l.Text=this.TextEllipsis(h.TypeName,s,a.MaxText),h.Color&&(l.TextColor=h.Color)),this.DrawItemText(l.Text,l.TextColor,l.TextAlign,o,r,s)},this.DrawItemText=function(t,e,a,i,r,n){if(t){var o=i;"center"==a?(o=i+n/2,this.Canvas.textAlign="center"):"right"==a?(o=i+n-2,i+n-2>this.RectClient.Right&&(o=this.RectClient.Right-2),this.Canvas.textAlign="right"):(o+=2,this.Canvas.textAlign="left"),this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e,this.Canvas.fillText(t,o,r+this.ItemMergin.Top+this.RowHeight/2)}},this.TextEllipsis=function(t,e,a){if(!t)return null;if(t.length<a.length)return t;var i=a.length-3;if(i<0)return null;for(var r=t.slice(0,i),n=i;n<t.length;++n){var o=r+t[n]+"...",s=this.Canvas.measureText(o).width;if(s>e){r+="...";break}r+=t[n]}return r},this.GetFontHeight=function(t,e){return E(this.Canvas,t,e)},this.OnMouseDown=function(t,e,a){if(!this.Data)return null;var i=F(),r={X:t/i,Y:e/i};if(this.UIElement)var n={Left:this.UIElement.getBoundingClientRect().left,Top:this.UIElement.getBoundingClientRect().top};else n={Left:null,Top:null};if(this.VScrollbar){var o=this.VScrollbar.OnMouseDown(t,e,a);if(o)return{Type:5,VScrollbar:o}}var s=this.PtInBody(t,e);if(s){var h=!0;0==this.SelectedModel?(this.SelectedRow==s.Index&&(h=!1),this.SelectedRow=s.Index,this.SelectedFixedRow=-1):(this.SelectedRow==s.DataIndex&&(h=!1),this.SelectedRow=s.DataIndex,this.SelectedFixedRow=-1);var l=m.ON_CLICK_REPORT_ROW;return 2==a.button&&(l=m.ON_RCLICK_REPORT_ROW),this.SendClickEvent(l,{Data:s,X:t,Y:e,e:a,Inside:r,UIElement:n}),{Type:2,Redraw:h,Row:s}}return null},this.OnDrawgRow=function(t,e,a){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;var i=this.RowHeight/2,r=this.RectClient.Top+this.HeaderHeight,n=this.ChartBorder.GetChartWidth(),o=r;if(e<o+i)return{Type:5};for(var s=this.Data.YOffset,h=0;s<this.Data.Data.length&&h<this.RowCount;++s,++h){var l=this.Data.Data[s],u={Left:0,Top:o,Right:n,Bottom:o+this.RowHeight};if(u.Top+=i,u.Bottom+=i,t>=u.Left&&t<=u.Right&&e>=u.Top&&e<=u.Bottom){var C={DataIndex:s,Index:h,Symbol:l,Pos:0};return 0==h?C.Pos=1:h==this.RowCount-1&&(C.Pos=2),{Type:2,Data:C}}o+=this.RowHeight}return h<this.RowCount?{Type:6}:{Type:7}},this.OnDblClick=function(t,e,a){if(!this.Data)return!1;var i=this.PtInBody(t,e);return!!i},this.PtInBody=function(t,e){if(!this.Data)return null;if(!sa.IsNonEmptyArray(this.Data.Data))return null;for(var a=this.RectClient.Top,i=this.RectClient.Left,r=this.RectClient.Right,n=(this.RectClient.Right,this.RectClient.Left,a),o=this.Data.YOffset,s=0;o<this.Data.Data.length&&s<this.RowCount;++o,++s){var h=this.Data.Data[o],l={Left:i,Top:n,Right:r,Bottom:n+this.RowHeight};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom){var u={Rect:l,DataIndex:o,Index:s,Symbol:h};return u.Item=this.PtInItem(t,e,l.Top,l.Bottom),u}n+=this.RowHeight}return null},this.PtInItem=function(t,e,a,i){for(var r=this.RectClient.Left,n=this.RectClient.Right,o=r,s=0;s<this.FixedColumn&&s<this.Column.length;++s){var h=this.Column[s],l={Left:o,Right:o+h.Width,Top:a,Bottom:i};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom)return{Rect:l,Column:h,Index:s};o+=h.Width}for(s=this.FixedColumn+this.Data.XOffset;s<this.Column.length;++s){h=this.Column[s];if(o>=n)break;l={Left:o,Right:o+h.Width,Top:a,Bottom:i};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom)return{Rect:l,Column:h,Index:s};o+=h.Width}return null},this.IsPtInBody=function(t,e){var a=this.RectClient.Top,i=this.RectClient.Left,r=this.RectClient.Right,n=this.RectClient.Bottom;return t>=i&&t<=r&&e>=a&&e<=n},this.SendClickEvent=function(t,e){var a=this.GetEventCallback(t);a&&a.Callback&&a.Callback(a,e,this)},this.GetYScrollRange=function(){if(!sa.IsNonEmptyArray(this.Data.Data))return 0;var t=this.Data.Data.length-this.RowCount;return t},this.IsShowVScrollbar=function(){return!!sa.IsNonEmptyArray(this.Data.Data)&&this.Data.Data.length>this.RowCount}}function qn(){this.newMethod=Un,this.newMethod(),delete this.newMethod,this.ClassName="ChartKeyboardVScrollbar",this.Enable=!0,this.ScrollBarHeight=qi.Keyboard.VScrollbar.ScrollBarHeight,this.ButtonColor=qi.Keyboard.VScrollbar.ButtonColor,this.BarColor=qi.Keyboard.VScrollbar.BarColor,this.BorderColor=qi.Keyboard.VScrollbar.BorderColor,this.BGColor=qi.Keyboard.VScrollbar.BGColor,this.Mergin={Left:2,Right:2,Top:2,Bottom:2},this.BarWithConfig={Size:qi.Keyboard.VScrollbar.BarWidth.Size},this.ReloadResource=function(t){this.ScrollBarHeight=qi.Keyboard.VScrollbar.ScrollBarHeight,this.ButtonColor=qi.Keyboard.VScrollbar.ButtonColor,this.BarColor=qi.Keyboard.VScrollbar.BarColor,this.BorderColor=qi.Keyboard.VScrollbar.BorderColor,this.BGColor=qi.Keyboard.VScrollbar.BGColor,this.BarWithConfig={Size:qi.Keyboard.VScrollbar.BarWidth.Size}},this.IsShowCallback=function(){return!0}}function jn(t){this.DivElement=t,this.JSChartContainer,this.ResizeListener,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jsscrollbar-drawing",this.CanvasElement.id=N(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&u.Chart.Log("[JSScrollBarChart::JSScrollBarChart] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OnSize=function(){var t=this.DivElement.offsetHeight,e=this.DivElement.offsetWidth;this.DivElement.style.height&&this.DivElement.style.width&&(this.DivElement.style.height.includes("px")&&(t=parseInt(this.DivElement.style.height.replace("px",""))),this.DivElement.style.width.includes("px")&&(e=parseInt(this.DivElement.style.width.replace("px","")))),this.CanvasElement.height=t,this.CanvasElement.width=e,this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var a=F();this.CanvasElement.height*=a,this.CanvasElement.width*=a,u.Chart.Log("[JSScrollBarChart::OnSize] devicePixelRatio=".concat(window.devicePixelRatio,", height=").concat(this.CanvasElement.height,", width=").concat(this.CanvasElement.width)),this.JSChartContainer&&this.JSChartContainer.OnSize&&this.JSChartContainer.OnSize()},this.SetOption=function(t){var e=this.CreateJSScrollBarChartContainer(t);if(!e)return!1;this.JSChartContainer=e,this.DivElement.JSChart=this,1==t.EnableResize&&this.CreateResizeListener(),t.OnCreatedCallback&&t.OnCreatedCallback(e),e.Draw()},this.CreateJSScrollBarChartContainer=function(t){var e=new $n(this.CanvasElement);if(e.Create(t),sa.IsNumber(t.DelayDragFrequency)&&(e.DelayDragFrequency=t.DelayDragFrequency),this.SetChartBorder(e,t),t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}return e},this.SetChartBorder=function(t,e){if(e.Border){var a=e.Border;sa.IsNumber(e.Border.Left)&&(t.Frame.ChartBorder.Left=e.Border.Left),sa.IsNumber(e.Border.Right)&&(t.Frame.ChartBorder.Right=e.Border.Right),sa.IsNumber(e.Border.Top)&&(t.Frame.ChartBorder.Top=e.Border.Top),sa.IsNumber(e.Border.Bottom)&&(t.Frame.ChartBorder.Bottom=e.Border.Bottom);var i=F();t.Frame.ChartBorder.Left*=i,t.Frame.ChartBorder.Right*=i,t.Frame.ChartBorder.Top*=i,t.Frame.ChartBorder.Bottom*=i,sa.IsBool(a.AutoLeft)&&(t.AutoMargin.Left=a.AutoLeft),sa.IsBool(a.AutoRight)&&(t.AutoMargin.Right=a.AutoRight)}},this.CreateResizeListener=function(){var t=this;this.ResizeListener=new ResizeObserver((function(e){t.OnDivResize(e)})),this.ResizeListener.observe(this.DivElement)},this.OnDivResize=function(t){u.Chart.Log("[JSScrollBarChart::OnDivResize] entries=",t),this.OnSize()},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(u.Chart.Log("[JSScrollBarChart:AddEventCallback] obj=",t),this.JSChartContainer.AddEventCallback(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(u.Chart.Log("[JSScrollBarChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.ChartDestroy=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestroy&&this.JSChartContainer.ChartDestroy()},this.Draw=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(u.Chart.Log("[JSScrollBarChart:Draw] "),this.JSChartContainer.Draw())},this.RecvData=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.RecvData&&(u.Chart.Log("[JSScrollBarChart:RecvData] "),this.JSChartContainer.RecvData(t,e))},this.UpdateSlider=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.UpdateSlider&&(u.Chart.Log("[JSScrollBarChart:UpdateSlider] "),this.JSChartContainer.UpdateSlider(t))},this.Reset=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Reset&&(u.Chart.Log("[JSScrollBarChart:Reset] "),this.JSChartContainer.Reset(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(u.Chart.Log("[JSScrollBarChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))}}function $n(t){this.ClassName="JSScrollBarChartContainer",this.Frame,this.ChartPaint=[],this.ChartSplashPaint=null,this.LoadDataSplashTitle="无数据",this.Canvas=t.getContext("2d"),this.ShowCanvas=null,this.XOffsetData={Start:-1,End:-1,Count:0},this.SourceData,this.SliderChart,this.DragMove,this.DragSlider,this.DragTimer,this.DelayDragFrequency=150,this.AutoMargin={Left:!1,Right:!1},this.mapEvent=new Map,this.UIElement=t,this.LastPoint=new V,this.IsDestroy=!1,this.HQChart=null,this.ChartDestroy=function(){this.IsDestroy=!0},this.GetHQChart=function(){return this.HQChart},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.IsEnableSplash=!0,this.Frame=new to,this.Frame.ChartBorder=new X,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame;var a=new ao;a.ChartFrame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartPaint.push(a);a=new eo;a.ChartFrame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.OffsetData=this.XOffsetData,a.GetEventCallback=function(t){return e.GetEventCallback(t)},this.SliderChart=a,this.ChartPaint.push(a),this.UIElement.onmousedown=function(t){e.UIOnMouseDown(t)},this.UIElement.oncontextmenu=function(t){e.UIOnContextMenu(t)},this.UIElement.onmousemove=function(t){e.UIOnMouseMove(t)},this.UIElement.onmouseout=function(t){e.UIOnMounseOut(t)},this.UIElement.onmouseleave=function(t){e.UIOnMouseleave(t)}},this.CreateChartPaint=function(t){var e=this,a=xt.Create(t);return a?(a.ChartFrame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.Data=this.Frame.Data,a.GetEventCallback=function(t){return e.GetEventCallback(t)},a.GetHQChartCallback=function(){return e.GetHQChart()},a):null},this.GetChartPaintByClassName=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];if(a.ClassName==t)return{Chart:a,Index:e}}return null},this.Draw=function(){if(!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var t=F();if(this.Canvas.lineWidth=t,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw();this.Frame.Draw(),this.Frame.DrawLogo();for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.IsDrawFirst&&a.Draw()}for(e=0;e<this.ChartPaint.length;++e){a=this.ChartPaint[e];a.IsDrawFirst||a.Draw()}}},this.OnSize=function(){this.Frame&&(this.SetSizeChange(!0),this.Draw())},this.SetSizeChange=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&(a.SizeChange=t)}},this.UpdateFrameMaxMin=function(){for(var t=null,e=null,a=0;a<this.ChartPaint.length;++a){var i=this.ChartPaint[a];if(i.GetMaxMin){var r=i.GetMaxMin();null!=r&&null!=r.Max&&null!=r.Min&&((null==t||t<r.Max)&&(t=r.Max),(null==e||e>r.Min)&&(e=r.Min))}}sa.IsNumber(t)&&sa.IsNumber(e)&&(this.Frame.HorizontalMax=t,this.Frame.HorizontalMin=e)},this.UIOnDblClick=function(t){},this.CancelDragTimer=function(){this.DragTimer&&(clearTimeout(this.DragTimer),this.DragTimer=null)},this.UIOnMouseDown=function(t){var e=this;this.CancelDragTimer(),this.DragSlider=null,this.DragMove={Click:{X:t.clientX,Y:t.clientY},Move:{X:t.clientX,Y:t.clientY},PreMove:{X:t.clientX,Y:t.clientY}};var a=F(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a;if(this.SliderChart){var n=this.SliderChart.PtInChart(i,r);if(!n){if(!this.Frame.PtInClient(i,r))return;var o=this.Frame.GetXData(i);o=Math.round(o);var s=this.GetPageRange(),h=s.ShowCount,l=o-parseInt(h/2);l<0&&(l=0);var u=l+h;u>=this.Frame.XPointCount&&(u=this.Frame.XPointCount-1,l=u-h);var C={UpdateData:{StartIndex:l,EndIndex:u,Type:3}};return void this.DragUpdate(C)}this.DragSlider={Click:{X:t.clientX,Y:t.clientY},LastMove:{X:t.clientX,Y:t.clientY},Data:n},this.DragSlider.DrawCount=0}document.onmousemove=function(t){e.DocOnMouseMove(t)},document.onmouseup=function(t){e.DocOnMouseUp(t)}},this.UIOnContextMenu=function(t){t.preventDefault()},this.UIOnMouseMove=function(t){var e=F(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(!this.DragSlider){var r=r={Cursor:"default"},n=this.SliderChart.PtInChart(a,i);if(n)switch(n.Data.Type){case 0:r={Cursor:"grab",Name:"SliderChart"};break;case 1:case 2:r={Cursor:"col-resize",Name:"SliderChart"};break}r&&(this.UIElement.style.cursor=r.Cursor)}},this.UIOnMounseOut=function(t){},this.UIOnMouseleave=function(t){},this.DocOnMouseMove=function(t){var e=this;if(this.DragMove.PreMove.X=this.DragMove.Move.X,this.DragMove.PreMove.Y=this.DragMove.Move.Y,this.DragMove.Move.X=t.clientX,this.DragMove.Move.Y=t.clientX,!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=F(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a;if(u.Chart.Log("[JSScrollBarChartContainer::DocOnMouseMove] x=".concat(i,", y=").concat(r)),this.DragSlider){var n=this.DragSlider,o=(t.clientX-n.LastMove.X)*a;if(Math.abs(o)<1)return;var s=this.GetPageRange(),h=this.Frame.ChartBorder.GetLeft(),l=this.Frame.ChartBorder.GetRight();this.SliderChart.DragMode=!0;var C=n.Data.Data.Type,D=this.SliderChart.XStart+o,f=this.SliderChart.XEnd+o;0==C?(D<h?(D=s.First.XStart,f=s.First.XEnd):f>=l&&(D=s.Last.XStart,f=s.Last.XEnd),this.SliderChart.XStart=D,this.SliderChart.XEnd=f):1==C?(D<=h?D=s.First.XStart:D>=l&&(D=s.Last.XEnd),this.SliderChart.XStart=D):2==C&&(f>=l?f=s.Last.XEnd:f<=h&&(f=s.First.XStart),this.SliderChart.XEnd=f),n.UpdateData={XStart:D,XEnd:f,Type:C},n.LastMove.X=t.clientX,n.LastMove.Y=t.clientY,0==n.DrawCount?this.DragUpdate(n):this.DragTimer=setTimeout((function(){e.DragUpdate(e.DragSlider)}),this.DelayDragFrequency)}}},this.DocOnMouseUp=function(t){document.onmousemove=null,document.onmouseup=null,this.CancelDragTimer();var e=this.DragSlider;this.DragMove=null,this.DragSlider=null,this.SliderChart.DragMode=!1,this.DragUpdate(e)},this.DragUpdate=function(t){t&&t.UpdateData&&(this.UpdateXDataOffset(t.UpdateData),this.Draw(),++t.DrawCount)},this.Reset=function(t){this.SourceData=null,this.XOffsetData.Start=-1,this.XOffsetData.End=-1,this.XOffsetData.Count=0,this.Frame.Data=null;for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.Data=null}this.ChartSplashPaint&&(this.ChartSplashPaint.IsEnableSplash=!0),t.Draw&&this.Draw()},this.UpdateSlider=function(t){if(!this.SliderChart.DragMode){var e=!1;(this.AutoMargin.Left||this.AutoMargin.Right)&&t.Border&&(this.AutoMargin.Left&&this.Frame.ChartBorder.Left!=t.Border.Left&&(e=!0),this.AutoMargin.Right&&this.Frame.ChartBorder.Right!=t.Border.Right&&(e=!0));var a=t.Data;if(this.XOffsetData.Start!=t.Start||this.XOffsetData.End!=t.End||this.SourceData!=a||e){this.SourceData=a;var i=a.Data.length;sa.IsNumber(t.RightSpaceCount)&&(i+=t.RightSpaceCount),this.Frame.XPointCount=i,this.Frame.Data=a,this.XOffsetData.Count=i,this.XOffsetData.Start=t.Start,this.XOffsetData.End=t.End;for(var r=0;r<this.ChartPaint.length;++r){var n=this.ChartPaint[r];n.Data=a}this.AutoMargin.Left&&t.Border&&sa.IsNumber(t.Border.Left)&&(this.Frame.ChartBorder.Left=t.Border.Left),this.AutoMargin.Right&&t.Border&&sa.IsNumber(t.Border.Right)&&(this.Frame.ChartBorder.Right=t.Border.Right),this.UpdateFrameMaxMin(),this.ChartSplashPaint&&(this.ChartSplashPaint.IsEnableSplash=!1),t.Draw&&this.Draw()}}},this.UpdateXDataOffset=function(t){if(t){var e=t.Type;if(0==t.Type){var a=this.Frame.GetXData(t.XStart);a=parseInt(a+.5);var i=a-this.XOffsetData.Start;this.XOffsetData.Start=a,this.XOffsetData.End+=i}else if(1==t.Type){a=this.Frame.GetXData(t.XStart);a=parseInt(a),this.XOffsetData.Start=a}else if(2==t.Type){var r=this.Frame.GetXData(t.XEnd);r=parseInt(r),this.XOffsetData.End=r}else 3==t.Type&&(this.XOffsetData.End=t.EndIndex,this.XOffsetData.Start=t.StartIndex,e=0);var n=this.SourceData.Data[this.XOffsetData.End],o=this.SourceData.Data[this.XOffsetData.Start],s={Type:e,Count:this.XOffsetData.Count};if(this.XOffsetData.End>this.XOffsetData.Start?(s.Start={Index:this.XOffsetData.Start,Item:o},s.End={Index:this.XOffsetData.End,Item:n}):(s.Start={Index:this.XOffsetData.End,Item:n},s.End={Index:this.XOffsetData.Start,Item:o}),this.HQChart&&this.HQChart.JSChartContainer){var h=this.HQChart.JSChartContainer;if(h.ChartOperator){t={ID:d.OP_SCROOLBAR_SLIDER_CHANGED,Start:s.Start,End:s.End,Type:s.Type};h.ChartOperator(t)}}var l=this.GetEventCallback(m.ON_SCROLLBAR_SLIDER_CHANGED);l&&l.Callback(l,s,this)}},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}t&&t.Redraw&&(this.SetSizeChange(!0),this.Draw())},this.GetPageRange=function(){var t={},e=Math.abs(this.XOffsetData.Start-this.XOffsetData.End);t.ShowCount=e;var a=this.Frame.GetXFromIndex(0),i=this.Frame.GetXFromIndex(e);t.First={XStart:a,XEnd:i};var r=this.Frame.XPointCount-1;i=this.Frame.GetXFromIndex(r),a=this.Frame.GetXFromIndex(r-e);return t.Last={XStart:a,XEnd:i},t},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}1==t.Draw&&this.Draw()}}function to(){this.ChartBorder,this.Canvas,this.BorderLine=null,this.Data,this.Count=0,this.ClassName="JSScrollBarFrame",this.HorizontalMax=10,this.HorizontalMin=5,this.XPointCount=0,this.XSplitTextFont=qi.ScrollBar.XSplitTextFont,this.XSplitTextColor=qi.ScrollBar.XSplitTextColor,this.XSplitLineColor=qi.ScrollBar.XSplitLineColor,this.BorderColor=qi.ScrollBar.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font,this.ReloadResource=function(t){this.BorderColor=qi.ScrollBar.BorderColor,this.LogoTextColor=qi.FrameLogo.TextColor,this.LogoTextFont=qi.FrameLogo.Font},this.Draw=function(){this.DrawBorder(),this.DrawLogo(),this.DrawVertical()},this.DrawLogo=function(){var t=qi.FrameLogo.Text;if(sa.IsString(t)){this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="left",this.Canvas.textBaseline="top";var e=this.ChartBorder.GetLeft()+2,a=this.ChartBorder.GetTop()+2;this.Canvas.fillText(t,e,a)}},this.DrawBorder=function(){var t=A(this.ChartBorder.GetLeft()),e=A(this.ChartBorder.GetTop()),a=A(this.ChartBorder.GetRight()),i=A(this.ChartBorder.GetBottom()),r=a-t,n=i-e;sa.IsNumber(this.BorderLine)?(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke()):(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,e,r,n))},this.GetXFromIndex=function(t){var e=this.XPointCount;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();var e=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-e},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.GetPreSetpWidth=function(){return 1*this.XPointCount/this.ChartBorder.GetWidth()},this.DrawVertical=function(){if(!(this.ChartBorder.Bottom<=5)&&this.Data&&sa.IsNonEmptyArray(this.Data.Data)){var t=this.Data.Data[0],e=parseInt(t.Date/1e4),a=t.Date%1e4;this.Canvas.font=this.XSplitTextFont,this.Canvas.fillStyle=this.XSplitTextColor,this.Canvas.textBaseline="top";var i=this.ChartBorder.GetBottom()+2,r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetBottom(),o=0;if(dt.IsMilliSecondPeriod(this.Data.Period))for(var s=null,h=0;h<this.Data.Data.length;++h){t=this.Data.Data[h];var l=t.Date%1e4,u=parseInt(t.Time/1e3),C=parseInt(u/1e4);if(0!=h){if(C!=s){D=sa.FormatTimeString(t.Time,"HH:MM:SS.fff"),f=this.GetXFromIndex(h),c=this.Canvas.measureText(D).width+2;f-c/2>o&&(this.Canvas.textAlign="center",this.Canvas.fillText(D,f,i),o=f+c/2),f=A(f),this.Canvas.strokeStyle=this.XSplitLineColor,this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),s=C}}else{var D=sa.FormatDateString(t.Date,"MM-DD"),f=this.ChartBorder.GetLeft();this.Canvas.textAlign="left",this.Canvas.fillText(D,f,i);var c=this.Canvas.measureText(D).width+2;o=f+c,a=l,s=C}}else if(dt.IsMinutePeriod(this.Data.Period,!0))for(h=0;h<this.Data.Data.length;++h){t=this.Data.Data[h],l=t.Date%1e4;if(0!=h){if(l!=a){D=sa.FormatDateString(t.Date,"MM-DD"),f=this.GetXFromIndex(h),c=this.Canvas.measureText(D).width+2;f-c/2>o&&(this.Canvas.textAlign="center",this.Canvas.fillText(D,f,i),o=f+c/2),f=A(f),this.Canvas.strokeStyle=this.XSplitLineColor,this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),a=l}}else{var D=sa.FormatDateString(t.Date,"MM-DD"),f=this.ChartBorder.GetLeft();this.Canvas.textAlign="left",this.Canvas.fillText(D,f,i);var c=this.Canvas.measureText(D).width+2;o=f+c,a=l}}else for(h=0;h<this.Data.Data.length;++h){t=this.Data.Data[h];var m=parseInt(t.Date/1e4);if(0!=h){if(m!=e){D="".concat(m),f=this.GetXFromIndex(h),c=this.Canvas.measureText(D).width+2;f-c/2>o&&(this.Canvas.textAlign="center",this.Canvas.fillText(D,f,i),o=f+c/2),f=A(f),this.Canvas.strokeStyle=this.XSplitLineColor,this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),e=m}}else{D="".concat(m),f=this.ChartBorder.GetLeft(),c=this.Canvas.measureText(D).width+2;this.Canvas.textAlign="left",this.Canvas.fillText(D,f,i),o=f+c,e=m}}}},this.PtInClient=function(t,e){var a=A(this.ChartBorder.GetLeft()),i=A(this.ChartBorder.GetTop()),r=A(this.ChartBorder.GetRight()),n=A(this.ChartBorder.GetBottom());return t>=a&&t<=r&&e>=i&&e<=n}}function eo(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="SliderChart",this.OffsetData,this.Color=qi.ScrollBar.Slider.BarAreaColor,this.BarColor=qi.ScrollBar.Slider.BarColor,this.BarWidth=qi.ScrollBar.Slider.BarWidth,this.BarPadding=qi.ScrollBar.Slider.BarPadding,this.MinCenterWidth=qi.ScrollBar.Slider.MinCenterWidth,this.DateFont=qi.ScrollBar.Slider.DateFont,this.DateColor=qi.ScrollBar.Slider.DateColor,this.AryRect=[],this.XStart,this.XEnd,this.SizeChange=!0,this.DragMode=!1,this.ReloadResource=function(t){this.Color=qi.ScrollBar.Slider.BarAreaColor,this.BarColor=qi.ScrollBar.Slider.BarColor,this.DateFont=qi.ScrollBar.Slider.DateFont,this.DateColor=qi.ScrollBar.Slider.DateColor},this.Draw=function(){if(this.AryRect=[],this.OffsetData&&sa.IsPlusNumber(this.OffsetData.Count)&&sa.IsNumber(this.OffsetData.Start)&&sa.IsNumber(this.OffsetData.End)){var t,e,a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom();if(this.DragMode){var r=this.XStart,n=this.XEnd,o=this.ChartFrame.GetXData(r),s=this.ChartFrame.GetXData(n);o=parseInt(o),s=parseInt(s),t={Data:this.Data.Data[this.OffsetData.Start],X:r,Type:o<s?0:1},e={Data:this.Data.Data[this.OffsetData.End],X:n,Type:s>o?1:0}}else{var h=this.OffsetData.Start,l=this.OffsetData.End;r=this.ChartFrame.GetXFromIndex(h),n=this.ChartFrame.GetXFromIndex(l);this.XStart=r,this.XEnd=n,t={Data:this.Data.Data[this.OffsetData.Start],X:r,Type:r<n?0:1},e={Data:this.Data.Data[this.OffsetData.End],X:n,Type:n>r?1:0}}this.Canvas.fillStyle=this.Color;var u={Left:Math.min(r,n),Top:a,Width:Math.abs(n-r),Height:i-a};u.Right=u.Left+u.Width,u.Bottom=u.Top+u.Height,u.Width<this.MinCenterWidth&&(u.Left-=(this.MinCenterWidth-u.Width)/2,u.Width=this.MinCenterWidth,u.Right=u.Left+u.Width),this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height),this.AryRect.push({Rect:u,Type:0});var C=F(),D=this.BarWidth*C,f=i-a-2*this.BarPadding*C,c=r-this.BarWidth/2,m=a+this.BarPadding*C;this.Canvas.fillStyle=this.BarColor;u={Left:c,Top:m,Width:D,Height:f};u.Right=u.Left+u.Width,u.Bottom=u.Top+u.Height,this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height),this.AryRect.push({Rect:u,Type:1});c=n-this.BarWidth/2,u={Left:c,Top:m,Width:D,Height:f};if(u.Right=u.Left+u.Width,u.Bottom=u.Top+u.Height,this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height),this.AryRect.push({Rect:u,Type:2}),1==e.Type){var d=this.OffsetData.End;d>=this.Data.Data.length&&(e.Data=this.Data.Data[this.Data.Data.length-1])}this.DrawDateTime(t),this.DrawDateTime(e)}},this.DrawDateTime=function(t){if(t&&t.Data){var e=sa.FormatDateString(t.Data.Date),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=null;if(dt.IsMilliSecondPeriod(this.Data.Period)){var n=parseInt(t.Data.Time/1e3);e=sa.FormatTimeString(n,"HH:MM:SS")}else dt.IsSecondPeriod(this.Data.Period)?e=sa.FormatTimeString(n,"HH:MM:SS"):dt.IsMinutePeriod(this.Data.Period,!0)&&(r=sa.FormatTimeString(t.Data.Time,"HH:MM"));if(0==t.Type){this.Canvas.textAlign="right";var o=t.X-this.BarWidth/2}else if(1==t.Type){this.Canvas.textAlign="left";o=t.X+this.BarWidth/2}this.Canvas.font=this.DateFont;var s=this.Canvas.measureText("擎").width;this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.DateColor;var h=a+(i-a)/2;this.Canvas.fillText(e,o,h),r&&(h+=s,this.Canvas.fillText(r,o,h))}},this.PtInChart=function(t,e){if(!sa.IsNonEmptyArray(this.AryRect))return null;for(var a=this.AryRect.length-1;a>=0;--a){var i=this.AryRect[a],r=i.Rect;if(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom)return{Data:i}}return null}}function ao(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ScrollBarBGChart",this.SizeChange=!0,this.Data,this.Color=qi.ScrollBar.BGChart.Color,this.LineWidth=qi.ScrollBar.BGChart.LineWidth,this.AreaColor=qi.ScrollBar.BGChart.AreaColor,this.ReloadResource=function(t){this.Color=qi.ScrollBar.BGChart.Color,this.LineWidth=qi.ScrollBar.BGChart.LineWidth,this.AreaColor=qi.ScrollBar.BGChart.AreaColor},this.Draw=function(){if(this.Data&&sa.IsNonEmptyArray(this.Data.Data)){this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*F());var t=this.ChartBorder.GetBottom();this.Canvas.strokeStyle=this.Color;for(var e,a,i=!0,r=0,n={},o=0;o<this.Data.Data.length;++o){var s=this.Data.Data[o],h=s.Close;sa.IsNumber(h)&&(e=this.ChartFrame.GetXFromIndex(o),a=this.ChartFrame.GetYFromData(h),i?(this.Canvas.beginPath(),this.Canvas.moveTo(e,a),i=!1,n={X:e,Y:a}):this.Canvas.lineTo(e,a),++r)}r>0&&(this.Canvas.stroke(),this.Canvas.lineTo(e,t),this.Canvas.lineTo(n.X,t),this.Canvas.closePath(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.fill()),this.Canvas.restore()}},this.GetMaxMin=function(){var t={Max:null,Min:null};if(!this.Data||!sa.IsNonEmptyArray(this.Data.Data))return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e],i=a.Close;sa.IsNumber(i)&&((null==t.Max||t.Max<i)&&(t.Max=i),(null==t.Min||t.Min>i)&&(t.Min=i))}return t}}jn.Init=function(t){var e=new jn(t);return e.OnSize(),e},jn.SetStyle=function(t){t&&qi.SetStyle(t)},jn.GetResource=function(){return qi};function io(){}(function(){var t="\n\n*************************************************************************************************************************************************************************** \n*                                                                                                                                                                                                                                                                                                                                        \n*                                                                                           :%@@-                                                                        \n*                                                                                          :@@@@-                                                                        \n*            =@@@@          :#@@@           .:+#@@@#=:                    :=*@@@@@@#+-.    *@@@@.                                                                        \n*           :@@@@@         .@@@@@         .#@@@@@@@@@@@-                +@@@@@@@@@@@@@+    @@@@@                                                     -%@@*               \n*           +@@@@%         #@@@@#        *@@@@@@@@@@@@@@%.            =@@@@@@@@@@@@@@@-    @@@@@                                                    -@@@@+               \n*           %@@@@*         @@@@@+      .%@@@@@@@@@@@@@@@@%:          #@@@@@@@@@@@@@@@%     @@@@#                                                    *@@@@=               \n*           @@@@@=         @@@@@-     .%@@@@@@@*++*%@@@@@@%        .%@@@@@@@%*+==+**=     -@@@@+                                                    #@@@@-               \n*           @@@@@.         @@@@@.     #@@@@@%=      =@@@@@@*       %@@@@@@#:              *@@@@-   :::.           .-+*###+:          :::  .+##+: -%%@@@@@%%%%            \n*          .@@@@@         .@@@@@.    +@@@@@%         .@@@@@@      *@@@@@@:                %@@@@: +@@@@@%.       :%@@@@@@@@@@:       *@@@ :@@@@@* @@@@@@@@@@@@            \n*          :@@@@@         :@@@@@     @@@@@%           :@@@@@+     @@@@@@:                 %@@@@-@@@@@@@@@.      @@@@@@@@@@@@@.     :@@@%-@@@@@@.:@@@@@@@@@@@#            \n*          -@@@@%         -@@@@@    =@@@@@.            %@@@@%    %@@@@@-                  %@@@@@@@@@@@@@@*      %@@@@@@@@@@@@+     -@@@@@@@@@@# -@@@@@@@@@@@.            \n*          +@@@@%=========#@@@@%    @@@@@#             :@@@@@   .@@@@@%                   @@@@@@@@%@@@@@@@      -%+:.  .#@@@@*     +@@@@@@@%%@. .::+@@@@#::              \n*          #@@@@@@@@@@@@@@@@@@@#   .@@@@@              .@@@@@   :@@@@@.                   @@@@@@#.  #@@@@@.             -@@@@*     #@@@@@@:        *@@@@+                \n*          %@@@@@@@@@@@@@@@@@@@+   :@@@@@              .@@@@@   -@@@@@                    @@@@@+     @@@@@.             :@@@@*     @@@@@%          #@@@@-                \n*          @@@@@@@@@@@@@@@@@@@@:   :@@@@%              :@@@@@   +@@@@%                   -@@@@+      @@@@@              -@@@@+     @@@@@.          @@@@@.                \n*         .@@@@@@@@@@@@@@@@@@@@    :@@@@%              -@@@@%   *@@@@%                   #@@@@.      @@@@@       .=*#%%%@@@@@=    :@@@@#           @@@@@.                \n*         -@@@@@:::::::::=@@@@@    :@@@@@              @@@@@*   +@@@@%                   @@@@@       @@@@%     -#@@@@@@@@@@@@:    -@@@@*           @@@@@                 \n*         =@@@@%         =@@@@%    .@@@@@             :@@@@@.   -@@@@%                   @@@@@      .@@@@*    +@@@@@@@@@@@@@@.    =@@@@+          .@@@@@                 \n*         +@@@@#         +@@@@#     @@@@@#            %@@@@%    :@@@@@                  .@@@@%      =@@@@=   -@@@@@*-:..%@@@@     +@@@@=          :@@@@#                 \n*         *@@@@*         *@@@@*     +@@@@@:          #@@@@@+    .@@@@@@                 :@@@@%      *@@@@-   @@@@@.     @@@@%     #@@@@:          =@@@@+                 \n*         %@@@@=         %@@@@+      @@@@@@-       .%@@@@@#      #@@@@@#                :@@@@%      #@@@@:   @@@@%      @@@@*     %@@@@.          #@@@@-                 \n*         @@@@@-         @@@@@=      =@@@@@@#=...-*@@@@@@@:       @@@@@@%=.    :+**.    :@@@@*      %@@@@.  .@@@@*     *@@@@=     @@@@@           %@@@@+                 \n*        .@@@@@:        .@@@@@:       *@@@@@@@@@@@@@@@@@@@#       =@@@@@@@@%%%@@@@@@    +@@@@-      @@@@@   .@@@@@:  :%@@@@@-    .@@@@%           %@@@@@*+-              \n*        :@@@@@         :@@@@@         +@@@@@@@@@@@@@@@@@@@#       =@@@@@@@@@@@@@@@@%   %@@@@       @@@@@    @@@@@@@@@@@@@@@:    -@@@@*           *@@@@@@@@-             \n*        =@@@@@         -@@@@@          :@@@@@@@@@@@@@@@@@@@#       :@@@@@@@@@@@@@@@%   @@@@@       %@@@%    #@@@@@@@@@#@@@@.    +@@@@-           .@@@@@@@@#             \n*        *@@@@#         =@@@@%            :#@@@@@@@#: :@@@@@=         =@@@@@@@@@@@+.    @@@@@       :@@@+     *@@@@@@@- %@@@     *@@@=             =@@@@@@@*             \n*        =++++-         -++++=               .:::.     .=*+:            :-=+++=:.       ****=        .=+.      .-++=:   :+++     -+=:               .-=+=:.     \n*        \n*        \n*        HQChart       \n*        Ver: ".concat("1.1.14767","  \n*        License: Apache License 2.0                                                                              \n*        Source: https://github.com/jones2000/HQChart\n*\n**************************************************************************************************************************************************************************                                                                                                                                                                      \n    ");console.log(t)})(),io.HttpRequest=function(t){var e=t.type.toUpperCase();uni.request({url:t.url,data:t.data,method:e,success:function(e){t.success(e.data)},fail:t.error})};var ro=(n={JSChart:c,ChartData:dt,MARKET_SUFFIX_NAME:Pr,IFrameSplitOperator:sa,FrameSplitKLinePriceY:ha,FrameSplitKLineX:ua,JSKLineInfoMap:pr,JSCHART_EVENT_ID:m,JSCHART_OPERATOR_ID:d,JSAlgorithm:ln,JSComplier:In,JSIndexScript:f,GetDevicePixelRatio:F},(0,h.default)(n,"GetDevicePixelRatio",F),(0,h.default)(n,"ScriptIndexConsole",En),(0,h.default)(n,"STYLE_TYPE_ID",yn),(0,h.default)(n,"HQChartStyle",Rn),(0,h.default)(n,"JSConsole",u),(0,h.default)(n,"KLineTooltipPaint",Ye),(0,h.default)(n,"MinuteTooltipPaint",ke),(0,h.default)(n,"CoordinateInfo",Y),(0,h.default)(n,"IChartPainting",Ft),(0,h.default)(n,"IExtendChartPainting",He),(0,h.default)(n,"IChartTitlePainting",Oa),(0,h.default)(n,"IChartDrawPicture",Ha),(0,h.default)(n,"DynamicTitleData",_a),(0,h.default)(n,"JSDealChart",Nn),(0,h.default)(n,"DEAL_COLUMN_ID",On),(0,h.default)(n,"JSReportChart",Pn),(0,h.default)(n,"REPORT_COLUMN_ID",Hn),(0,h.default)(n,"JSKeyboardChart",Kn),(0,h.default)(n,"KEYBOARD_COLUMN_ID",Zn),(0,h.default)(n,"JSScrollBarChart",jn),(0,h.default)(n,"JSCHART_WORKER_MESSAGE_ID",{EXECUTE_SCRIPT:1,FINISH_EXECUTE_SCRIPT:2,ERROR_EXECUTE_SCRIPT:3}),n);e.default=ro},"9f46":function(t,e,a){"use strict";a.r(e);var i=a("93f1"),r=a("8d89");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("0bcc");var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"65c09f26",null,!1,i["a"],void 0);e["default"]=s.exports},a2ad:function(t,e,a){var i=a("1289");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("967d").default;r("4e90c62d",i,!0,{sourceMap:!1,shadowMode:!1})},aa55:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c223"),a("aa9c");var r=i(a("2030")),n=i(a("6831")),o=i(a("aecf")),s=i(a("5a47")),h=i(a("69c9")),l=i(a("9be4")),u=a("8733"),C=a("af56"),D=i(a("f855")),f=l.default.JSCHART_EVENT_ID,c=l.default.JSChart.GetDevicePixelRatio,m={components:{HQChartControl:r.default,StockInfoView:n.default,HQPeriodTabView:s.default,KLineToolbarView:o.default,BuySellInfoView:h.default},data:function(){return{Symbol:"600000.sh",KLine:{Width:350,Height:500,IsShow:!1,IsShowLastTitle:!0},Minute:{Width:350,Height:400,IsShow:!0},MultiMinute:{Width:350,Height:500,IsShow:!1},HistoryMinute:{Width:350,Height:250,IsShow:!1,Date:null},DelayDrawConfig:{Timer:null,Delay:300}}},onReady:function(){this.InitalComponents()},onLoad:function(){var t=this;uni.getSystemInfo({success:function(e){var a=e.windowWidth;e.windowHeight;t.KLine.Width=a,t.Minute.Width=.6*a,t.MultiMinute.Width=a,t.HistoryMinute.Width=a,t.$nextTick((function(){t.CreateMultiMinuteChart(),t.CreateKLineChart(),t.CreateMinuteChart(),t.CreateHistoryMinuteChart(),t.ShowDivChart("Minute"),t.RequestStockData()}))}})},onShow:function(){},onHide:function(){},onUnload:function(){this.ClearHQChart()},methods:{InitalComponents:function(){var t=this;this.$refs.KLineToolbar.GetKLineCtrlCallback=function(){return t.GetKLineCtrl()},this.$refs.PeriodTab.ClickTabCallback=function(e){return t.ClickPeriodTab(e)},this.InitalCustomIndexScript()},InitalCustomIndexScript:function(){l.default.JSIndexScript.AddIndex([{ID:"MA_888",Name:"MA",Description:"均线",IsMainIndex:!0,OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"}],Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:120},{Name:"M6",Value:180},{Name:"M7",Value:240}],Script:"MA1:MA(CLOSE,M1),RGB(138, 138, 138);\nMA2:MA(CLOSE,M2),RGB(204, 179, 67);\nMA3:MA(CLOSE,M3),RGB(196, 107, 141);\nMA4:MA(CLOSE,M4),RGB(111, 64, 113);\nMA5:MA(CLOSE,M5),RGB(171, 111, 96);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);\n"},{ID:"VOL_888",Name:"VOL",Description:"成交量",IsMainIndex:!1,FloatPrecision:0,Script:"额:VOL,VOLSTICK;"}])},CreateKLineChart:function(){var t=this,e=this.$refs.HQKLineCtrl;e.SetHQChartStyle=this.SetHQChartStyle;var a=e.KLine.Option;a.EnableScrollUpDown=!0,e.NetworkFilter=this.KLineNetworkFilter,a.Windows=[{Index:"MA_888",Modify:!1,Change:!1,IsShortTitle:!0,IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1},{Index:"VOL",IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1},{Index:"MACD",IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1}],a.Border.Top=2,a.Border.Bottom=2,a.KLine.DrawType=3,a.ExtendChart=[{Name:"KLineXAxisPaint"}],a.CorssCursorInfo.Bottom=8,a.CorssCursorInfo.HPenType=1,a.CorssCursorInfo.VPenType=1,a.CorssCursorTouchEnd=!0,a.IsClickShowCorssCursor=!0,a.KLineTitle.IsTitleShowLatestData=!0,a.Frame=[{SplitCount:3,IsShowRightText:!1,BottomSpace:30},{SplitCount:2,IsShowRightText:!1,IsShowLeftText:!1},{SplitCount:3,IsShowRightText:!1,IsShowLeftText:!1}],a.BottomButton={Enable:!0},a.OnCreatedCallback=function(e){t.OnCreateKLine(e)},a.EventCallback=[{event:f.ON_CUSTOM_CORSSCURSOR_POSITION,callback:function(t,e,a){u.KLineXAxisPaint.CustomCorssCursorPosition(t,e,a)}},{event:f.ON_TITLE_DRAW,callback:function(e,a,i){t.OnDrawKLineTitle(e,a,i)}},{event:f.ON_SPLIT_XCOORDINATE,callback:function(e,a,i){t.OnSplitKLineXCoordinate(e,a,i)}},{event:f.ON_FORMAT_CORSSCURSOR_X_TEXT,callback:function(e,a,i){t.OnFormatKLineCorssCursorXText(e,a,i)}},{event:f.ON_CLICK_CROSSCURSOR_BOTTOM,callback:function(e,a,i){t.OnClickKLineCorssCursorX(e,a,i)}},{event:f.ON_PHONE_TOUCH,callback:function(e,a,i){t.OnTouchKLine(e,a,i)}}],e.SetSize(this.KLine.Width,this.KLine.Height),e.OnSize(),this.$nextTick((function(){e.CreateHQChart()}))},CreateMinuteChart:function(){var t=this,e=this.$refs.HQMinuteCtrl;e.SetHQChartStyle=this.SetHQChartStyle;var a=e.Minute.Option;a.EnableScrollUpDown=!0,e.NetworkFilter=this.MinuteNetworkFilter,a.Windows=[{Index:"VOL",IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1,TitleHeight:0}],a.Border.Top=2,a.Border.Bottom=2,a.MinuteTitle={IsTitleShowLatestData:!0},a.MinuteLine={IsDrawAreaPrice:!1},a.ExtendChart=[{Name:"MinuteXAxisPaint"}],a.CorssCursorInfo={Left:2,Right:2,IsShowCorss:!0,Bottom:8,HPenType:1,VPenType:1},a.CorssCursorTouchEnd=!0,a.IsClickShowCorssCursor=!0,a.BeforeOpen={IsShow:!0,Width:80},a.AfterClose={IsShow:!0,Width:40},a.Frame=[{SplitCount:5,BottomSpace:25},{SplitCount:2,Height:0},{SplitCount:3,IsShowLeftText:!1}],a.OnCreatedCallback=function(e){t.OnCreateMinute(e)},a.EventCallback=[{event:f.ON_CUSTOM_CORSSCURSOR_POSITION,callback:function(t,e,a){C.MinuteXAxisPaint.CustomCorssCursorPosition(t,e,a)}},{event:f.ON_SPLIT_YCOORDINATE,callback:function(e,a,i){t.OnMinuteSplitYCoordinate(e,a,i)}},{event:f.ON_SPLIT_XCOORDINATE,callback:function(e,a,i){t.OnMinuteSplitXCoordinate(e,a,i)}},{event:f.ON_TITLE_DRAW,callback:function(e,a,i){t.OnDrawMinuteTitle(e,a,i)}},{event:f.ON_PHONE_TOUCH,callback:function(e,a,i){t.OnTouchMinute(e,a,i)}},{event:f.ON_FORMAT_CORSSCURSOR_X_TEXT,callback:function(e,a,i){t.OnFormatMinuteCorssCursorXText(e,a,i,1)}}],e.SetSize(this.Minute.Width,this.Minute.Height),e.OnSize(),this.$nextTick((function(){e.CreateHQChart()}))},CreateMultiMinuteChart:function(){var t=this,e=this.$refs.HQMultiMinuteCtrl;e.SetHQChartStyle=this.SetHQChartStyle;var a=e.Minute.Option;a.DayCount=5,a.EnableScrollUpDown=!0,e.NetworkFilter=this.MinuteNetworkFilter,a.Windows=[{Index:"VOL",IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1},{Index:"MACD",IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1}],a.Border.Top=2,a.Border.Bottom=2,a.CorssCursorTouchEnd=!0,a.IsClickShowCorssCursor=!0,a.MinuteTitle={IsTitleShowLatestData:!0},a.MinuteLine={IsDrawAreaPrice:!1},a.ExtendChart=[{Name:"MinuteXAxisPaint"}],a.CorssCursorInfo={Left:2,Right:2,IsShowCorss:!0,Bottom:8,HPenType:1,VPenType:1},a.Frame=[{SplitCount:5,BottomSpace:25},{SplitCount:2,Height:0},{SplitCount:3,IsShowLeftText:!1},{SplitCount:3,IsShowLeftText:!1}],a.OnCreatedCallback=function(e){t.OnCreateMultiMinute(e)},a.EventCallback=[{event:f.ON_CUSTOM_CORSSCURSOR_POSITION,callback:function(t,e,a){C.MinuteXAxisPaint.CustomCorssCursorPosition(t,e,a)}},{event:f.ON_SPLIT_YCOORDINATE,callback:function(e,a,i){t.OnMinuteSplitYCoordinate(e,a,i)}},{event:f.ON_TOUCH_FAST_SLIDE,callback:function(e,a,i){t.OnTouchFastSlide(e,a,i)}},{event:f.ON_TITLE_DRAW,callback:function(e,a,i){t.OnDrawMultiMinuteTitle(e,a,i)}},{event:f.ON_PHONE_TOUCH,callback:function(e,a,i){t.OnTouchMinute(e,a,i)}},{event:f.ON_FORMAT_CORSSCURSOR_X_TEXT,callback:function(e,a,i){t.OnFormatMinuteCorssCursorXText(e,a,i,3)}}],e.SetSize(this.MultiMinute.Width,this.MultiMinute.Height),e.OnSize(),this.$nextTick((function(){e.CreateHQChart()}))},CreateHistoryMinuteChart:function(){var t=this,e=this.$refs.HQHistoryMinuteCtrl;e.SetHQChartStyle=this.SetHQChartStyle,e.Symbol=null;var a=e.Minute.Option;a.EnableScrollUpDown=!0,e.NetworkFilter=this.HistoryMinuteNetworkFilter,a.Windows=[{Index:"VOL",IsDrawTitleBG:!0,IsShowNameArrow:!0,IsShowTitleArrow:!1}],a.Border.Top=22,a.Border.Bottom=2,a.MinuteTitle={IsTitleShowLatestData:!0,IsShowName:!1,IsShowTime:!1},a.MinuteLine={IsDrawAreaPrice:!1},a.ExtendChart=[{Name:"MinuteXAxisPaint"}],a.CorssCursorInfo={Left:2,Right:2,IsShowCorss:!0,Bottom:8},a.CorssCursorTouchEnd=!0,a.IsClickShowCorssCursor=!0,a.Frame=[{SplitCount:5,BottomSpace:25},{SplitCount:2,Height:0},{SplitCount:3,IsShowLeftText:!1}],a.OnCreatedCallback=function(e){t.OnCreateHistoryMinute(e)},a.EventCallback=[{event:f.ON_CUSTOM_CORSSCURSOR_POSITION,callback:function(t,e,a){C.MinuteXAxisPaint.CustomCorssCursorPosition(t,e,a)}},{event:f.ON_SPLIT_YCOORDINATE,callback:function(e,a,i){t.OnMinuteSplitYCoordinate(e,a,i)}}],e.SetSize(this.HistoryMinute.Width,this.HistoryMinute.Height),e.OnSize(),this.$nextTick((function(){e.CreateHQChart()}))},OnCreateKLine:function(t){t.EnableClickModel=!0,t.ChartPaint[0].UnchangeBarType=1,t.ChartPaint[0].EnableColorBar=!0},OnCreateMinute:function(t){t.CreateChartPaintExtendV2("ChartMinuteBarCallAuction",null,2);var e=t.TitlePaint[3];e.CustomLocation={IsShow:!0,Top:5*c(),TitleHeight:20},e.MerginLeft=3*c()},OnCreateMultiMinute:function(t){},OnCreateHistoryMinute:function(t){var e=this,a=t.TitlePaint[0];a.GetFormatTitle=function(t){return e.GetFormatHistoryMinuteTitle(a,t)}},ClearHQChart:function(){for(var t=[this.$refs.HQKLineCtrl,this.$refs.HQMinuteCtrl,this.$refs.HQMultiMinuteCtrl,this.$refs.HQHistoryMinuteCtrl],e=0;e<t.length;++e){var a=t[e];a.ClearChart()}},SetHQChartStyle:function(){this.SetHQChartStyle_h5()},SetHQChartStyle_h5:function(){l.default.JSChart.GetResource()},ClickPeriodTab:function(t){if(t){var e=t.TabItem,a=e.Command;a&&("Minute"==a.ChartName?(this.ResetKLineChartCorssCursor(),this.ChangeMinuteDay(a.DayCount),t.SelectedTabID=e.ID):"KLine"==a.ChartName&&(this.ResetKLineChartCorssCursor(),this.ChangeKLinePeriod(a.Period),t.SelectedTabID=e.ID))}},ResetKLineChartCorssCursor:function(){var t=this.$refs.HQKLineCtrl,e=t.GetJSChart();e&&e.JSChartContainer&&(e.JSChartContainer.ClickModel.IsShowCorssCursor=!1),this.KLine.IsShowLastTitle=!0,this.$refs.StockInfo&&this.$refs.StockInfo.EnableShowRangeData(!1)},ChangeMinuteDay:function(t){1==t?(this.ShowDivChart("Minute"),this.EnableShowHistoryMinuteChart(!1)):5==t&&(this.ShowDivChart("MultiMinute"),this.EnableShowHistoryMinuteChart(!1))},ChangeKLinePeriod:function(t){var e=this.$refs.HQKLineCtrl;e.ChangeKLinePeriod(t);var a=!1;0!=t?(this.EnableShowHistoryMinuteChart(!1),a=!1):a=!0;var i=e.GetJSChart();i&&i.JSChartContainer&&i.JSChartContainer.ChartCorssCursor&&(i.JSChartContainer.ChartCorssCursor.BottomButton.Enable=a),this.ShowDivChart("KLine")},ChangeSymbol:function(t){},StopDelayDrawTimer:function(){this.DelayDrawConfig.Timer&&(clearTimeout(this.DelayDrawConfig.Timer),this.DelayDrawConfig.Timer=null)},StartDelayDrawTimer:function(t,e){var a=this;this.StopDelayDrawTimer(),this.DelayDrawConfig.Timer=setTimeout((function(){a.HQChartRedraw(t)}),this.DelayDrawConfig.Delay)},HQChartRedraw:function(t){var e=null;switch(t){case"KLine":e=this.$refs.HQKLineCtrl;break;case"Minute":e=this.$refs.HQMinuteCtrl;break;case"MultiMinute":e=this.$refs.HQMultiMinuteCtrl;break;case"HisMinute":e=this.$refs.HQHistoryMinuteCtrl;break}e&&e.Draw()},ShowDivChart:function(t){var e=this,a=!1;"KLine"==t?(this.KLine.IsShow||(a=!0),this.KLine.IsShow=!0,this.Minute.IsShow=!1,this.MultiMinute.IsShow=!1):"Minute"==t?(this.Minute.IsShow||(a=!0),this.Minute.IsShow=!0,this.KLine.IsShow=!1,this.MultiMinute.IsShow=!1):"MultiMinute"==t&&(this.MultiMinute.IsShow||(a=!0),this.MultiMinute.IsShow=!0,this.Minute.IsShow=!1,this.KLine.IsShow=!1),this.$nextTick((function(){a&&(e.HQChartRedraw(t),e.StartDelayDrawTimer(t,300))}))},IsShowCorssCursor:function(t){return!(!t.HQChart||!t.HQChart.ChartCorssCursor)&&0!==t.HQChart.ChartCorssCursor.Status},MinuteNetworkFilter:function(t,e){switch(console.log("[App:KLineNetworkFilter] Name=".concat(t.Name," Explain=").concat(t.Explain)),t.Name){case"APIScriptIndex::ExecuteScript":return this.GetExecuteScript(t,e);default:D.default.HQData.NetworkFilter(t,e);break}},OnMinuteSplitXCoordinate:function(t,e,a){for(var i=e.Frame,r=0;r<i.VerticalInfo.length;++r){var n=i.VerticalInfo[r];1!=r&&3!=r||(n.Message[0]=null)}},OnMinuteSplitYCoordinate:function(t,e,a){if(0==e.ID){var i=e.Frame;if(i.HorizontalInfo.length<3)return;for(var r=c(),n=0;n<i.HorizontalInfo.length;++n){var o=i.HorizontalInfo[n];o.Value==i.HorizontalMin?o.YOffset=[{Offset:-7*r},{Offset:-7*r}]:1==n||3==n?(o.Message[0]=null,o.Message[1]=null):2==n&&(o.LineDash=[2*r,2*r],o.TextColor="rgb(129,129,129)")}if(!i.ChartBorder.IsShowAfterClose())return;for(n=0;n<i.HorizontalInfo.length;++n){o=i.HorizontalInfo[n];if(0==n||2==n||4==n){var s=new l.default.CoordinateInfo;s.Value=o.Value,s.Message[2]=o.Message[0],s.Message[3]=o.Message[1],s.LineType=8,s.TextColor=o.TextColor,o.YOffset&&(s.YOffset=[null,null,{Offset:-7*r},{Offset:-7*r}]),i.HorizontalInfo.push(s),o.Message[0]=null,o.Message[1]=null}}}else if(2==e.ID){i=e.Frame;if(!i.ChartBorder.IsShowAfterClose())return;for(n=0;n<i.HorizontalInfo.length;++n){o=i.HorizontalInfo[n];8==o.LineType&&(o.Message=[null,null])}}},OnDrawMinuteTitle:function(t,e,a){if(this.Minute.IsShow&&(console.log("[App:OnDrawMinuteTitle] Name=".concat(e.Name," Explain=").concat(e.Explain)),e.Draw)){var i=this.IsShowCorssCursor(a);if("BeforeOpen"!=e.Draw.Explain&&"AfterClose"!=e.Draw.Explain){var r=e.Draw,n={Price:r.Close,YClose:r.YClose,Risefall:r.Close-r.YClose,Increase:(r.Close-r.YClose)/r.YClose*100,High:r.High,Low:r.Low,Open:r.Open,Vol:r.Vol,Amount:r.Amount,DateTime:{Date:r.Date,Time:r.Time}};this.$refs.StockInfo&&(this.$refs.StockInfo.SetCorssCursorStatus(i?1:0),this.$refs.StockInfo.UpdateStockData(n))}}},OnDrawMultiMinuteTitle:function(t,e,a){if(this.MultiMinute.IsShow&&(console.log("[App:OnDrawMultiMinuteTitle] Name=".concat(e.Name," Explain=").concat(e.Explain)),e.Draw)){var i=e.Draw,r=this.IsShowCorssCursor(a),n={Price:i.Close,YClose:i.YClose,Risefall:i.Close-i.YClose,Increase:(i.Close-i.YClose)/i.YClose*100,High:i.High,Low:i.Low,Open:i.Open,Vol:i.Vol,Amount:i.Amount,DateTime:{Date:i.Date,Time:i.Time}};this.$refs.StockInfo&&(this.$refs.StockInfo.SetCorssCursorStatus(r?3:0),this.$refs.StockInfo.UpdateStockData(n))}},OnTouchMinute:function(t,e,a){e.FunctionName},OnFormatMinuteCorssCursorXText:function(t,e,a,i){console.log("[App:OnFormatMinuteCorssCursorXText] data",e),this.$refs.StockInfo&&this.$refs.StockInfo.SetCorssCursorStatus(i)},KLineNetworkFilter:function(t,e){switch(console.log("[App:KLineNetworkFilter] Name=".concat(t.Name," Explain=").concat(t.Explain)),t.Name){case"APIScriptIndex::ExecuteScript":return this.GetExecuteScript(t,e);default:D.default.HQData.NetworkFilter(t,e);break}},GetKLineCtrl:function(){var t=this.$refs.HQKLineCtrl;return t?t.GetJSChart():null},OnSplitKLineXCoordinate:function(t,e,a){console.log("[App:OnSplitKLineYCoordinate] data",e);var i=e.Frame;if(!(i.VerticalInfo.length<=0)){var r=i.Data;if(r&&r.Data){i.VerticalInfo=[];var n=r.DataOffset,o=i.XPointCount,s=n+o-1;s>=r.Data.length&&(s=r.Data.length-1);var h=r.Data[n],u=r.Data[s],C=l.default.ChartData.IsMinutePeriod(r.Period,!0),D=new l.default.CoordinateInfo;D.LineType=-1,D.Value=0,D.Message[0]=C?"".concat(l.default.IFrameSplitOperator.FormatDateString(h.Date)," ").concat(l.default.IFrameSplitOperator.FormatTimeString(h.Time,"HH:MM")):l.default.IFrameSplitOperator.FormatDateString(h.Date),i.VerticalInfo.push(D);D=new l.default.CoordinateInfo;D.LineType=-1,D.Value=s-n,D.Message[0]=C?"".concat(l.default.IFrameSplitOperator.FormatDateString(u.Date)," ").concat(l.default.IFrameSplitOperator.FormatTimeString(u.Time,"HH:MM")):l.default.IFrameSplitOperator.FormatDateString(u.Date),i.VerticalInfo.push(D)}}},OnDrawKLineTitle:function(t,e,a){if(this.KLine.IsShow){this.IsShowCorssCursor(a);var i=a.HQChart.GetKData();if(i&&l.default.IFrameSplitOperator.IsNonEmptyArray(i.Data)){if(this.KLine.IsShowLastTitle)var r=i.Data[i.Data.length-1];else{if(!e.Draw)return;if(!a.HQChart||!a.HQChart.ClickModel)return;if(!a.HQChart.ClickModel.IsShowCorssCursor)return void(this.$refs.StockInfo&&this.$refs.StockInfo.EnableShowRangeData(!1));r=e.Draw}var n={Price:r.Close,YClose:r.YClose,Risefall:r.YClose,Increase:r.YClose/r.YClose*100,High:r.High,Low:r.Low,Open:r.Open,Vol:r.Vol,Amount:r.Amount,DateTime:{Date:r.Date,Time:r.Time}};if(this.$refs.StockInfo&&this.$refs.StockInfo.UpdateStockData(n),1==a.HQChart.ClickModel.IsShowCorssCursor){var o=i.Data[i.Data.length-1],s={Start:{Date:r.Date,Time:r.Time},End:{Date:o.Date,Time:o.Time},IsShow:!0};s.Increase=(o.Close-r.Close)/r.Close*100,s.Count=e.DataCount-e.DataIndex,this.$refs.StockInfo&&this.$refs.StockInfo.UpdateRangeData(s)}else this.$refs.StockInfo&&this.$refs.StockInfo.EnableShowRangeData(!1)}}},OnFormatKLineCorssCursorXText:function(t,e,a){console.log("[App:OnFormatKLineCorssCursorXText] data",e),0===e.Period&&(a.Text+=" 分时")},OnClickKLineCorssCursorX:function(t,e,a){if(console.log("[App:OnClickKLineCorssCursorX] data",e),e.Button&&e.Button.Data){var i=e.Button.Data.KItem;i&&!this.HistoryMinute.IsShow&&(a.ClickModel.PreventHide=!0,this.EnableShowHistoryMinuteChart(!0),this.ChangeHistoryMinuteDate(i.Date))}},OnTouchKLine:function(t,e,a){if(this.KLine.IsShowLastTitle=!1,"OnTouchEnd"==e.FunctionName){if(0!=a.Period||!this.HistoryMinute.IsShow)return;if(1==a.ClickModel.IsShowCorssCursor&&a.ClickModel.PreventHide)return;if(1==a.ClickModel.IsShowCorssCursor&&a.TouchDrawCount>0){var i=a.ChartCorssCursor.StringFormatX.KItem;i&&this.ChangeHistoryMinuteDate(i.Date)}}},HistoryMinuteNetworkFilter:function(t,e){switch(console.log("[App:HistoryMinuteNetworkFilter] Name=".concat(t.Name," Explain=").concat(t.Explain)),t.Name){case"APIScriptIndex::ExecuteScript":return this.GetExecuteScript(t,e);case"MinuteChartContainer::RequestMinuteData":t.Request.Data.date=this.HistoryMinute.Date,D.default.HQData.Minute_RequestPopMinuteData(t,e);break;default:D.default.HQData.NetworkFilter(t,e);break}},GetFormatHistoryMinuteTitle:function(t,e){if(e&&e.Data){var a=e.Data,i=(t.Data,l.default.JSChart.GetfloatPrecision(t.Symbol)),r=[],n={AryText:r};r.push({Text:"".concat(l.default.IFrameSplitOperator.FormatDateString(a.Date)),Color:"rgb(128,128,128)"}),r.push({Text:"均价:".concat(a.AvPrice.toFixed(i)),Color:"rgb(255,165,0)"}),r.push({Text:"价格:".concat(a.Close.toFixed(i)),Color:s(a.Close,a.YClose)});var o=a.Close-a.YClose;r.push({Text:"".concat(o>0?"+":"").concat(o.toFixed(i)),Color:s(o,0)});o=(a.Close-a.YClose)/a.YClose*100;return r.push({Text:"".concat(o>0?"+":"").concat(o.toFixed(2),"%"),Color:s(o,0)}),n}function s(t,e){return t>e?"rgb(238,21,21)":t<e?"rgb(25,158,0)":"rgb(128,128,128)"}},EnableShowHistoryMinuteChart:function(t){var e=this,a=!1;this.HistoryMinute.IsShow!=t&&(this.HistoryMinute.IsShow=t,t&&(a=!0)),this.$nextTick((function(){if(a){e.HQChartRedraw("HisMinute"),e.StartDelayDrawTimer("HisMinute",300)}}))},ChangeHistoryMinuteDate:function(t){if(!this.HistoryMinute.IsShow)return!1;if(this.HistoryMinute.Date==t)return!1;this.HistoryMinute.Date=t;var e=this.$refs.HQHistoryMinuteCtrl;e.ChangeSymbol(this.Symbol)},MoveHistoryMinuteDay:function(t){if(0!=t){if(!this.HistoryMinute.IsShow)return!1;if(!l.default.IFrameSplitOperator.IsNumber(this.HistoryMinute.Date))return!1;var e=this.$refs.HQKLineCtrl,a=e.GetJSChart();if(!a||!a.JSChartContainer)return!1;a.JSChartContainer.ClickModel.IsShowCorssCursor=!0;var i={ID:l.default.JSCHART_OPERATOR_ID.OP_MOVE_CORSSCURSOR,Step:t,Start:{Date:this.HistoryMinute.Date}};return!!a.JSChartContainer.ChartOperator(i)&&(this.ChangeHistoryMinuteDate(i.KItem.Date),!0)}},RequestStockData:function(){this.$refs.StockInfo.UpdateStockData({Price:9.19,YClose:9.19-.48,Risefall:.48,Increase:5.51,High:9.47,Low:7.85,Open:8.45,MarketValue:9443e6,Vol:155e5,SharesValue:7653e5,ChangeRate:16.63,PE:149.52,Amount:149e5})}}};e.default=m},aecf:function(t,e,a){"use strict";a.r(e);var i=a("5e60"),r=a("edf1");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("5559");var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"358783c7",null,!1,i["a"],void 0);e["default"]=s.exports},af03:function(t,e,a){"use strict";a.r(e);var i=a("410e"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},af56:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.MinuteXAxisPaint=C;var r=i(a("9be4")),n=r.default.JSChart.ToFixedRect,o=r.default.JSChart.ToFixedPoint,s=r.default.JSChart,h=r.default.IExtendChartPainting,l=r.default.IFrameSplitOperator,u=r.default.JSChart.GetDevicePixelRatio;r.default.JSChart.GetMinuteTimeStringData();function C(){this.newMethod=h,this.newMethod(),delete this.newMethod,this.ClassName="MinuteXAxisPaint",this.BGColor="rgb(255,255,255)",this.BorderColor="#A3A8AC",this.MinuteFrame=null,this.Font="".concat(12*u(),"px 微软雅黑"),this.Config={Height:25*u(),Margin:{Top:6*u()},Spliter:{LineColor:"rgb(225,236,242)",Font:"".concat(12*u(),"px 微软雅黑"),Day:{Color:"rgb(145,145,145)",BGColor:null,BorderColor:"rgb(218,218,218)",Margin:{Left:5,Top:2,Bottom:2,Right:5}},Night:{Color:"rgb(145,145,145)",BGColor:"rgb(218,218,218)",BorderColor:"rgb(218,218,218)",Margin:{Left:5,Top:2,Bottom:2,Right:5}},NightBGColor:"rgba(121,175,246,0.05)"}},this.SetOption=function(t){},this.GetVerticalInfoData=function(){if(!this.ChartFrame.SubFrame)return null;if(!l.IsNonEmptyArray(this.ChartFrame.SubFrame))return null;var t=this.ChartFrame.SubFrame[this.ChartFrame.SubFrame.length-1];return t.Frame?t.Frame.VerticalInfo:null},this.Draw=function(){if(this.HQChart&&this.ChartFrame.SubFrame[0]&&(this.MinuteFrame=this.ChartFrame.SubFrame[0].Frame,this.MinuteFrame)){var t=!0===this.MinuteFrame.IsHScreen,e=this.MinuteFrame.GetBorder();if(!0===t){var a={Left:e.Left,Top:e.Top,Bottom:e.Bottom,Width:this.Config.Height};a.Right=a.Left+a.Width,a.Height=a.Bottom-a.Top,this.DrawXAxisHScreen(a)}else{a={Left:e.Left+1,Right:e.Right,Bottom:e.Bottom,Height:this.Config.Height};a.Width=a.Right-a.Left,a.Top=a.Bottom-a.Height,this.Canvas.save(),this.DrawXAxis(a),this.Canvas.restore()}}},this.DrawXAxis=function(t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(n(t.Left),n(t.Top),n(t.Width),n(t.Height)),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(o(t.Left),o(t.Top)),this.Canvas.lineTo(o(t.Right),o(t.Top)),this.Canvas.moveTo(o(t.Left),o(t.Bottom)),this.Canvas.lineTo(o(t.Right),o(t.Bottom)),this.Canvas.stroke();var e=this.GetVerticalInfoData();if(e){this.Canvas.textBaseline="top",this.Canvas.font=this.Font;for(var a=0;a<e.length;++a){var i=e[a];if(i.Message[0]){var r=i.Message[0],s=this.MinuteFrame.GetXFromIndex(i.Value);this.Canvas.fillStyle=i.TextColor;var h=this.Canvas.measureText(r).width;s<h/2?(this.Canvas.textAlign="left",s+h,s):s+h/2>=t.Right?(this.Canvas.textAlign="right",s+h,s):(this.Canvas.textAlign="center",s+h/2,s-h/2),this.Canvas.fillText(r,s,t.Top+this.Config.Margin.Top)}}}},this.DrawXAxisHScreen=function(t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(n(t.Left),n(t.Top),n(t.Width),n(t.Height)),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(o(t.Right),o(t.Top)),this.Canvas.lineTo(o(t.Right),o(t.Bottom)),this.Canvas.stroke();var e=this.GetVerticalInfoData();if(e){this.Canvas.textBaseline="top",this.Canvas.font=this.Font;for(var a=0;a<e.length;++a){var i=e[a];if(i.Message[0]){var r=i.Message[0],s=this.MinuteFrame.GetXFromIndex(i.Value);this.Canvas.fillStyle=i.TextColor;var h=this.Canvas.measureText(r).width;s<h/2?this.Canvas.textAlign="left":s+h/2>=t.Bottom?this.Canvas.textAlign="right":this.Canvas.textAlign="center";var l=t.Right-this.Config.Margin.Top,u=s;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(r,0,0),this.Canvas.restore()}}}}}C.Register=function(){s.RegisterExtendChartClass("MinuteXAxisPaint",{Create:function(){return new C}})},C.CustomCorssCursorPosition=function(t,e,a){var i=a.Frame.SubFrame[0].Frame;if(!0===a.Frame.IsHScreen){var r=i.ChartBorder.GetLeft();e.XText=r+e.Height}else{var n=i.ChartBorder.GetBottom(),o=e.RectText;o.Bottom=n,o.Top=o.Bottom-o.Height}},C.Register()},b03b:function(t,e,a){"use strict";var i=a("4bf4"),r=a.n(i);r.a},b533:function(t,e,a){t.exports=a.p+"assets/iconfont.1a4f1e20.woff"},b6e0:function(t,e,a){t.exports=a.p+"assets/noticePng.6b78a53a.png"},b7c7:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,i.default)(t)||(0,r.default)(t)||(0,n.default)(t)||(0,o.default)()};var i=s(a("4733")),r=s(a("d14d")),n=s(a("5d6b")),o=s(a("30f7"));function s(t){return t&&t.__esModule?t:{default:t}}},bf7a:function(t,e,a){t.exports=a.p+"assets/iconfont.552d02e6.woff2"},bf7ad:function(t,e,a){"use strict";a.r(e);var i=a("2aa0"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},c190:function(t,e,a){var i=a("c86c"),r=a("2ec5"),n=a("bf7a"),o=a("b533"),s=a("8b56");e=i(!1);var h=r(n),l=r(o),u=r(s);e.push([t.i,"@font-face{font-family:iconfont; /* Project id 1040563 */src:url("+h+') format("woff2"),url('+l+') format("woff"),url('+u+') format("truetype")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-accountbox:before{content:"\\e6b0"}.icon-checked:before{content:"\\e6af"}.icon-eye:before{content:"\\e78f"}.icon-eye-close:before{content:"\\e6ae"}.icon-fangxiangsanjiao-xiangshang:before{content:"\\e6ad"}.icon-fangxiangsanjiao-xiangshang-copy:before{content:"\\e86d"}.icon-jiantou-shang:before{content:"\\e86b"}.icon-jiantou-xia:before{content:"\\e86c"}.icon-sanjiaoxing:before{content:"\\e6ac"}.icon-sanjiaoxing-xia:before{content:"\\e710"}.icon-banner:before{content:"\\e6ab"}.icon-location1:before{content:"\\e6aa"}.icon-export:before{content:"\\e6a9"}.icon-lingxing:before{content:"\\e6a8"}.icon-location:before{content:"\\e6a7"}.icon-Title:before{content:"\\e6a6"}.icon-maxmize-:before{content:"\\e6a5"}.icon-HQchart:before{content:"\\e6a4"}.icon-button_add:before{content:"\\e6a3"}.icon-draw_hlinesegment:before{content:"\\e6a2"}.icon-draw_p_rays_lines:before{content:"\\e6a1"}.icon-draw_head_shoulders_bt:before{content:"\\e6a0"}.icon-drawicon_49:before{content:"\\e69f"}.icon-drawicon_48:before{content:"\\e69e"}.icon-drawicon_47:before{content:"\\e69d"}.icon-drawicon_46:before{content:"\\e69c"}.icon-drawicon_45:before{content:"\\e69b"}.icon-drawicon_44:before{content:"\\e69a"}.icon-drawicon_43:before{content:"\\e699"}.icon-drawicon_42:before{content:"\\e698"}.icon-drawicon_41:before{content:"\\e697"}.icon-drawicon_40:before{content:"\\e696"}.icon-drawicon_39:before{content:"\\e695"}.icon-drawicon_38:before{content:"\\e694"}.icon-drawicon_37:before{content:"\\e693"}.icon-drawicon_36:before{content:"\\e692"}.icon-drawicon_35:before{content:"\\e691"}.icon-drawicon_34:before{content:"\\e690"}.icon-drawicon_33:before{content:"\\e68f"}.icon-drawicon_32:before{content:"\\e67f"}.icon-drawicon_31:before{content:"\\e67e"}.icon-drawicon_30:before{content:"\\e67d"}.icon-drawicon_28:before{content:"\\e67b"}.icon-drawicon_29:before{content:"\\e67c"}.icon-drawicon_27:before{content:"\\e67a"}.icon-drawicon_26:before{content:"\\e679"}.icon-drawicon_25:before{content:"\\e678"}.icon-drawicon_24:before{content:"\\e677"}.icon-drawicon_23:before{content:"\\e676"}.icon-drawicon_22:before{content:"\\e675"}.icon-drawicon_21:before{content:"\\e674"}.icon-drawicon_20:before{content:"\\e673"}.icon-drawicon_19:before{content:"\\e672"}.icon-drawicon_18:before{content:"\\e671"}.icon-drawicon_17:before{content:"\\e670"}.icon-drawicon_16:before{content:"\\e66f"}.icon-drawicon_15:before{content:"\\e66e"}.icon-drawicon_14:before{content:"\\e66d"}.icon-drawicon_13:before{content:"\\e66c"}.icon-drawicon_12:before{content:"\\e66b"}.icon-drawicon_11:before{content:"\\e66a"}.icon-drawicon_10:before{content:"\\e669"}.icon-drawicon_9:before{content:"\\e668"}.icon-drawicon_8:before{content:"\\e667"}.icon-drawicon_7:before{content:"\\e666"}.icon-drawicon_6:before{content:"\\e665"}.icon-drawicon_5:before{content:"\\e664"}.icon-drawicon_4:before{content:"\\e663"}.icon-drawicon_3:before{content:"\\e662"}.icon-drawicon_2:before{content:"\\e661"}.icon-drawicon_1:before{content:"\\e660"}.icon-draw_box:before{content:"\\e65f"}.icon-waveruler:before{content:"\\e65e"}.icon-vertical_line:before{content:"\\e65d"}.icon-price_line:before{content:"\\e65c"}.icon-ruler:before{content:"\\e65b"}.icon-linear_3:before{content:"\\e65a"}.icon-linear_2:before{content:"\\e659"}.icon-linear_1:before{content:"\\e657"}.icon-stockStar:before{content:"\\e658"}.icon-camera:before{content:"\\e654"}.icon-change_index:before{content:"\\e656"}.icon-overlay_index:before{content:"\\e655"}.icon-houtui:before{content:"\\e651"}.icon-qianjin:before{content:"\\e652"}.icon-exit:before{content:"\\e653"}.icon-refresh:before{content:"\\e650"}.icon-sub:before{content:"\\e64e"}.icon-add:before{content:"\\e64f"}.icon-guanbi:before{content:"\\e62b"}.icon-sousuo:before{content:"\\e62a"}.icon-margin:before{content:"\\e629"}.icon-shhk:before{content:"\\e628"}.icon-hk:before{content:"\\e627"}.icon-drawicon_message:before{content:"\\e64d"}.icon-drawicon_s:before{content:"\\e64c"}.icon-drawicon_b:before{content:"\\e70f"}.icon-drawicon_close:before{content:"\\e68c"}.icon-drawicon_dollar:before{content:"\\e626"}.icon-drawicon_up:before{content:"\\e625"}.icon-drawicon_down-copy:before{content:"\\e68b"}.icon-drawicon_bad:before{content:"\\e600"}.icon-drawicon_good:before{content:"\\e624"}.icon-kline_train_buy:before{content:"\\e64a"}.icon-kline_train_sell:before{content:"\\e64b"}.icon-bianji:before{content:"\\e623"}.icon-info_num_more:before{content:"\\e649"}.icon-info_num_11:before{content:"\\e635"}.icon-info_num_10:before{content:"\\e636"}.icon-info_num_12:before{content:"\\e637"}.icon-info_num_13:before{content:"\\e638"}.icon-info_num_14:before{content:"\\e639"}.icon-info_num_15:before{content:"\\e63a"}.icon-info_num_1:before{content:"\\e63b"}.icon-info_num_16:before{content:"\\e63c"}.icon-info_num_3:before{content:"\\e63d"}.icon-info_num_17:before{content:"\\e63e"}.icon-info_num_4:before{content:"\\e63f"}.icon-info_num_2:before{content:"\\e640"}.icon-info_num_6:before{content:"\\e641"}.icon-info_num_18:before{content:"\\e642"}.icon-info_num_20:before{content:"\\e643"}.icon-info_num_19:before{content:"\\e644"}.icon-info_num_5:before{content:"\\e645"}.icon-info_num_9:before{content:"\\e646"}.icon-info_num_7:before{content:"\\e647"}.icon-info_num_8:before{content:"\\e648"}.icon-info_quarter_announcement-copy:before{content:"\\e686"}.icon-info_block_trading:before{content:"\\e630"}.icon-info_investor:before{content:"\\e631"}.icon-info_research:before{content:"\\e632"}.icon-info_announcement:before{content:"\\e633"}.icon-info_quarter_announcement:before{content:"\\e634"}.icon-info_research_hscreen:before{content:"\\e688"}.icon-info_block_trading_hscreen:before{content:"\\e689"}.icon-info_investor_hscreen:before{content:"\\e684"}.icon-info_announcement-copy:before{content:"\\e685"}.icon-info_trade_detail_hscreen:before{content:"\\e68a"}.icon-info_trade_detail:before{content:"\\e62f"}.icon-info_pforecast_hscreen:before{content:"\\e687"}.icon-info_pforecast:before{content:"\\e62e"}.icon-jiacu:before{content:"\\e61f"}.icon-shezhi:before{content:"\\e620"}.icon-qingxieL:before{content:"\\e622"}.icon-xia:before{content:"\\e618"}.icon-shang:before{content:"\\e619"}.icon-drawicon_up2:before{content:"\\e68d"}.icon-drawicon_down2:before{content:"\\e68e"}.icon-menu_arraw_right:before{content:"\\e60b"}.icon-menu_arraw_left:before{content:"\\e60d"}.icon-right:before{content:"\\e601"}.icon-left:before{content:"\\e603"}.icon-draw_fibonacci:before{content:"\\e62d"}.icon-draw_quadrangle:before{content:"\\e62c"}.icon-arrow_down:before{content:"\\e681"}.icon-arrow_left:before{content:"\\e680"}.icon-arrow_right:before{content:"\\e682"}.icon-arrow_up:before{content:"\\e683"}.icon-chip_default:before{content:"\\e621"}.icon-draw_hline:before{content:"\\e61e"}.icon-draw_symangle:before{content:"\\e61d"}.icon-draw_circle:before{content:"\\e61c"}.icon-draw_pricechannel:before{content:"\\e61b"}.icon-draw_triangle:before{content:"\\e61a"}.icon-chip_date:before{content:"\\e617"}.icon-draw_wavemw:before{content:"\\e616"}.icon-draw_parallelchannel:before{content:"\\e615"}.icon-draw_text:before{content:"\\e614"}.icon-draw_resline:before{content:"\\e613"}.icon-draw_waveband:before{content:"\\e612"}.icon-draw_percentage:before{content:"\\e611"}.icon-draw_gannfan:before{content:"\\e610"}.icon-draw_goldensection:before{content:"\\e60f"}.icon-draw_trendline:before{content:"\\e60e"}.icon-close:before{content:"\\e60c"}.icon-recycle_bin:before{content:"\\e60a"}.icon-setting:before{content:"\\e609"}.icon-draw_parallel_lines:before{content:"\\e608"}.icon-rectangle:before{content:"\\e607"}.icon-draw_rays:before{content:"\\e606"}.icon-draw_line:before{content:"\\e605"}.icon-index_param:before{content:"\\e604"}.icon-draw_arc:before{content:"\\e602"}',""]),t.exports=e},c1a3:function(t,e,a){"use strict";a("15ab")},c238:function(t,e,a){"use strict";var i=a("af9e");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},c540:function(t,e,a){var i=a("5971");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("967d").default;r("52eb2d54",i,!0,{sourceMap:!1,shadowMode:!1})},cfb4:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"KLineToolbarView",data:function(){return{GetKLineCtrlCallback:null,isExpanded:!1,LongPress:{Timer:null,IsPress:!1}}},mounted:function(){},methods:{toggleButtons:function(){this.isExpanded=!this.isExpanded},GetKLineCtrl:function(){if(!this.GetKLineCtrlCallback)return null;var t=this.GetKLineCtrlCallback();return t||null},KLineZoom:function(t){var e=this.GetKLineCtrl();if(!e)return!1;var a=null;if(t>0)a={ID:4};else{if(!(t<0))return!1;a={ID:3}}return e.JSChartContainer.ChartOperator(a),!0},KLineMove:function(t){var e=this.GetKLineCtrl();if(!e)return!1;var a=null;if(t>0)a={ID:1,Step:t};else{if(!(t<0))return!1;a={ID:2,Step:Math.abs(t)}}return e.JSChartContainer.ChartOperator(a),!0},InvokeButton:function(t){switch(t){case 1:this.KLineZoom(1);break;case 2:this.KLineZoom(-1);break;case 3:this.KLineMove(-1);break;case 4:this.KLineMove(1);break;default:return!1}return!0},StartTouchButton:function(t){this.StopLongPress(),this.InvokeButton(t)&&(this.LongPress.IsPress=!0,this.StartLongPress(t))},EndTouchButton:function(){this.LongPress.IsPress=!1,this.StopLongPress()},StopLongPress:function(){this.LongPress.Timer&&(clearInterval(this.LongPress.Timer),this.LongPress.Timer=null)},StartLongPress:function(t){var e=this;this.StopLongPress(),this.LongPress.Timer=setInterval((function(){e.LongPress.IsPress&&e.InvokeButton(t)}),300)}}};e.default=i},d0b1:function(t,e,a){"use strict";var i=a("8bdb"),r=a("bb80"),n=a("11bf"),o=a("1c06"),s=a("338c"),h=a("d6b1").f,l=a("80bb"),u=a("8449"),C=a("1ea2"),D=a("d7b4"),f=a("c238"),c=!1,m=D("meta"),d=0,I=function(t){h(t,m,{value:{objectID:"O"+d++,weakData:{}}})},S=t.exports={enable:function(){S.enable=function(){},c=!0;var t=l.f,e=r([].splice),a={};a[m]=1,t(a).length&&(l.f=function(a){for(var i=t(a),r=0,n=i.length;r<n;r++)if(i[r]===m){e(i,r,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,m)){if(!C(t))return"F";if(!e)return"E";I(t)}return t[m].objectID},getWeakData:function(t,e){if(!s(t,m)){if(!C(t))return!0;if(!e)return!1;I(t)}return t[m].weakData},onFreeze:function(t){return f&&c&&C(t)&&!s(t,m)&&I(t),t}};n[m]=!0},d14d:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},a("01a2"),a("e39c"),a("bf0f"),a("844d"),a("18f7"),a("de6c"),a("08eb")},d937:function(t,e,a){"use strict";var i=a("8bdb"),r=a("bb80"),n=a("497b"),o=a("83fa"),s=a("f298"),h=a("2e7f"),l=a("af9e"),u=RangeError,C=String,D=isFinite,f=Math.abs,c=Math.floor,m=Math.pow,d=Math.round,I=r(1..toExponential),S=r(s),T=r("".slice),v="-6.9000e-11"===I(-69e-12,4)&&"1.25e+0"===I(1.255,2)&&"1.235e+4"===I(12345,3)&&"3e+1"===I(25,0),p=!v||!function(){return l((function(){I(1,1/0)}))&&l((function(){I(1,-1/0)}))}()||!function(){return!l((function(){I(1/0,1/0),I(NaN,1/0)}))}();i({target:"Number",proto:!0,forced:p},{toExponential:function(t){var e=o(this);if(void 0===t)return I(e);var a=n(t);if(!D(e))return String(e);if(a<0||a>20)throw new u("Incorrect fraction digits");if(v)return I(e,a);var i="",r="",s=0,l="",p="";if(e<0&&(i="-",e=-e),0===e)s=0,r=S("0",a+1);else{var g=h(e);s=c(g);var x=0,F=m(10,s-a);x=d(e/F),2*e>=(2*x+1)*F&&(x+=1),x>=m(10,a+1)&&(x/=10,s+=1),r=C(x)}return 0!==a&&(r=T(r,0,1)+"."+T(r,1)),0===s?(l="+",p="0"):(l=s>0?"+":"-",p=C(f(s))),r+="e"+l+p,i+r}})},dd6e:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"kline",staticClass:"kline",style:{width:this.ChartWidth+"px",height:this.ChartHeight+"px"},attrs:{id:this.KLineID}})},r=[]},df30:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAkCAYAAAD/yagrAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAUoSURBVFhH1ZdnTxxJEIb9/79hwCSTMcFgwORggggiCpMxOeecbHKfnpLeUXt2OIa1he5KKs3sdnfVW7nnnfuf0LvwH/9VejXQp6cn4z+ll2RIjzg2UF+wLyBqPYoeHx+DPeGzUfRHQF+jSBTeG/U7ipIGCvkH7+7u3MnJidva2nIrKytuYWHBzc/PJ/Dy8rJbXV013tvbcz9//gyLjaS/AvTq6sqNj4+7iooK9/HjR5efn+9ycnJcVlZWAvN/Xl6ecXl5uevo6HD7+/u/pUIUJQ305ubGnr9+/XI/fvwwgCkpKe7Dhw8uOzvbZWZmJoCEc3NzzZCMjIwA+JcvX9zZ2ZlFBQ6DiuJYQP0DhO/Tp0/u/fv35tHJyUm3uLhooV1bW0vgjY0Ne5IGXV1dZhiABwYG3P39/d8FSpgQCg8ODrr09HTz4NzcnK1BCIsiKYIIOd4kGsXFxW57e9s9PDwkgIriWEDZCEgUlZWVWTi/fv3qLi4uAkEvKcQgGO8DMjU11fX19QW5+hLHBorA9vZ2A1lQUOB2d3cNvADKs8+R1m9vb11tba0rLCx0JSUlJicO2GeBsqgnTJsBIMXQ2tpquQX5nvTTQOcxJiyLkNMFKMJv37658/Pz4PxzoCOBSqGetCNCTeUStuPjY1sDJMQTPjo6suLq7++3XKbA6Js+UEWhra3NogNYCo3//ajEAirBshDlai1Uq9YFFDAzMzPWDSgymBzEawBiMMhTAkS+V1ZWmvGkgr/HZ2GIBAoJDF7Cmyj//PmztSd/D2Cnp6ddaWmpdQO8xDv5J+Oam5uD8AKUPIUwmh6L7O/fvyekzotAtQFiAuEZAIyMjCTsuby8tJYDqKqqKgsjxm1ubhpATSVSAYCcUd4eHBy4mpoaM4azGMOaL/9FoKKmpiYLD2ECgNZkMQ2dvoiy4eHhIF8Rfnh4aEMBIwiv5rzOUpATExN2FkcsLS39Jj82UDaQdyR8Z2dnMEW0h3WaPvmIIopHY1EKAJiWlmapcH19bed8Y9bX183jhH90dDSQHQuoiDAQEjxCeEl4nxAGONoWQMfGxgIgEKEmXwFBZPgtAJp0FCFAiQpFK7mxgUohylFEoZCvupxoz+npqRUbiphaXPcIOde/7u5uiwYFQ8HhafVd3qn8+vp6O0uh4giBjAWUBTZisfKMPKU4JEyhw0tTU1PmVTzPkygQAd65hNTV1dk5zqiPchYPYgTR6O3tDfRKvs+RQNkIyRqAkPAwyY9Xfav5jbcZi3gQo4gC+1taWsy7AiGZDA3yF2/iCBWqWKkh/legEsxkIqx4jCdelkKNUjzLaKTyGbFMJ1oV91fIjxLvPT09QW5yvxUgpUZsoGGws7OzwXwm9zgMKYy+h/Vba1Ku/+mfRUVFJqu6utqMCcuJBRQKg8VjjY2Nlk+wf8XTPhT5XgkD50kvxVByl1TBm74x2hcbqE8CQitSX6VaURq+dIQZpSLe+RAkd8lhejMOCBcOnBRQSFaTW5okvjf8sIWByhDaEfnLAKCAdnZ2bC0MMmmgUoRSComQUQR4lxYDAKqWZ5gpMJhRyzcTBYk36c+adGGQSQOFJBSwKNHEwbP6AmWUhhnv0a5IFzEFxFeoHBAGmTRQP5QIoW8ODQ1Z5epCAgD1Wp9ZxxjA0jUaGhrM08jxZYY5KaBRhGcZn3yiEH4uJzzDzOiEyWcaP91CnUAcBqaLjc9JA1XYICmLQ0qfNwOq0L2W3hyoCEXQc6DD/7850CgAcShZoP8Az0BBVVimRIEAAAAASUVORK5CYII="},edf1:function(t,e,a){"use strict";a.r(e);var i=a("cfb4"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},f163:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c9b5"),a("bf0f"),a("ab80"),a("c1a3"),a("18f7"),a("de6c"),a("5c47"),a("c223");var r=i(a("9be4"));function n(){}function o(){}a("70fc"),n.MarkRaw=function(t){return t},o.GetKLineOption=function(){return{Type:"历史K线图",Windows:[{Index:"MA",Modify:!1,Change:!1},{Index:"VOL",Modify:!1,Change:!1}],IsAutoUpdate:!0,IsCorssOnlyDrawKLine:!0,CorssCursorTouchEnd:!0,IsClickShowCorssCursor:!0,CorssCursorInfo:{Left:2,Right:2,Bottom:1,IsShowCorss:!0},Border:{Left:1,Right:1,Top:25,Bottom:25},KLine:{DragMode:1,Right:1,Period:0,PageSize:6,IsShowTooltip:!1,DrawType:0,DataWidth:10},KLineTitle:{DateTimeSpace:1,PeriodSpace:1,NameSpace:1},ExtendChart:[{Name:"KLineTooltip"}],Frame:[{SplitCount:3,Custom:[{Type:0,Position:"right"}]},{SplitCount:2},{SplitCount:3}]}},o.GetMinuteOption=function(){return{Type:"分钟走势图",Windows:[],IsAutoUpdate:!0,DayCount:1,IsShowRightMenu:!1,CorssCursorTouchEnd:!0,IsClickShowCorssCursor:!0,MinuteLine:{},Border:{Left:1,Right:1,Top:20,Bottom:20},Frame:[{SplitCount:3},{SplitCount:2},{SplitCount:3}],ExtendChart:[{Name:"MinuteTooltip"}]}},o.CreateGuid=function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"guid"+(t()+t())+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()};var s=new Map,h={name:"HQChartControl",props:["DefaultSymbol","DefaultChart"],data:function(){var t={Symbol:"600000.sh",ChartWidth:550,ChartHeight:1e3,KLineID:"HQChart_"+o.CreateGuid(),KLine:{Option:o.GetKLineOption()},Minute:{Option:o.GetMinuteOption()},ChartType:"Minute",CanvasNode:null};return t},created:function(){this.DefaultSymbol&&(this.Symbol=this.DefaultSymbol),this.DefaultChart&&("Minute"==this.DefaultChart.Type?this.ChartType="Minute":this.ChartType="KLine")},methods:{SetSize:function(t,e){this.ChartWidth=t,this.ChartHeight=e},GetJSChart:function(){return s.has(this.KLineID)?s.get(this.KLineID):null},SetJSChart:function(t){s.set(this.KLineID,t)},ClearChart:function(){console.log("[ClearChart] clear");var t=this.GetJSChart();t&&(t.ChartDestroy(),this.SetJSChart(null));var e=document.getElementById(this.KLineID);while(e.hasChildNodes())e.removeChild(e.lastChild)},Draw:function(t){console.log("[HQChartControl::Draw]");var e=this.GetJSChart();e&&e.JSChartContainer&&e.JSChartContainer.Draw()},OnSize:function(t){this.OnSize_h5(t)},OnSize_h5:function(t){var e=this.ChartHeight,a=this.ChartWidth,i=this.$refs.kline;i.style.width=a+"px",i.style.height=e+"px";var r=this.GetJSChart();r&&r.OnSize(t)},OnSize_app:function(t){var e=this.GetJSChart();e&&(e.CanvasElement.Width=this.ChartWidth,e.CanvasElement.Height=this.ChartHeight,e.OnSize(t))},SetHQChartStyle:function(){this.SetHQChartStyle_h5()},SetHQChartStyle_h5:function(){var t=r.default.HQChartStyle.GetStyleConfig(r.default.STYLE_TYPE_ID.BLACK_ID);r.default.JSChart.SetStyle(t)},SetHQChartStyle_app:function(){var t=JSCommonHQStyle.GetStyleConfig(JSCommonHQStyle.STYLE_TYPE_ID.BLACK_ID);JSCommon.JSChart.SetStyle(t)},CreateHQChart:function(){return this.SetHQChartStyle(),"Minute"==this.ChartType?this.CreateMinuteChart():this.CreateKLineChart()},CreateKLineChart_h5:function(){this.ClearChart();var t=r.default.JSChart.Init(this.$refs.kline);return this.KLine.Option.Symbol=this.Symbol,this.KLine.Option.NetworkFilter=this.NetworkFilter,t.SetOption(this.KLine.Option),this.SetJSChart(t),t},CreateKLineChart_app:function(){this.ClearChart();var t=new JSCommon.JSCanvasElement;t.ID=this.KLineID,t.Height=this.ChartHeight,t.Width=this.ChartWidth;var e=JSCommon.JSChart.Init(t);return this.KLine.Option.NetworkFilter=this.NetworkFilter,this.KLine.Option.Symbol=this.Symbol,this.KLine.Option.IsFullDraw=!0,e.SetOption(this.KLine.Option),this.SetJSChart(e),e},CreateKLineChart_WeChat:function(){var t=this;this.ClearChart();var e="#".concat(this.KLineID);wx.createSelectorQuery().in(this).select(e).fields({node:!0,size:!0}).exec((function(e){console.log("[HQChartControl::CreateKLineChart_WeChat] 2"),t.CanvasNode=n.MarkRaw(e[0]);var a=new JSCommon.JSCanvasElement;a.ID=t.KLineID,a.CanvasNode=t.CanvasNode,a.Height=t.ChartHeight,a.Width=t.ChartWidth,console.log("[HQChartControl::CreateKLineChart_WeChat] 3",t.ChartHeight,t.ChartWidth,e);var i=JSCommon.JSChart.Init(a);t.KLine.Option.NetworkFilter=t.NetworkFilter,t.KLine.Option.Symbol=t.Symbol,t.KLine.Option.IsFullDraw=!0,i.SetOption(t.KLine.Option),t.SetJSChart(i)}))},CreateKLineChart:function(){return this.ChartType="KLine",this.CreateKLineChart_h5()},CreateMinuteChart_h5:function(){this.ClearChart();var t=r.default.JSChart.Init(this.$refs.kline);return this.Minute.Option.Symbol=this.Symbol,this.Minute.Option.NetworkFilter=this.NetworkFilter,t.SetOption(this.Minute.Option),this.SetJSChart(t),t},CreateMinuteChart_app:function(){this.ClearChart();var t=new JSCommon.JSCanvasElement;t.ID=this.KLineID,t.Height=this.ChartHeight,t.Width=this.ChartWidth;var e=JSCommon.JSChart.Init(t);return this.Minute.Option.NetworkFilter=this.NetworkFilter,this.Minute.Option.Symbol=this.Symbol,this.Minute.Option.IsFullDraw=!0,e.SetOption(this.Minute.Option),this.SetJSChart(e),e},CreateMinuteChart_WeChat:function(){var t=this;this.ClearChart();var e="#".concat(this.KLineID);wx.createSelectorQuery().in(this).select(e).fields({node:!0,size:!0}).exec((function(e){t.CanvasNode=n.MarkRaw(e[0]);var a=new JSCommon.JSCanvasElement;a.ID=t.KLineID,a.CanvasNode=t.CanvasNode,a.Height=t.ChartHeight,a.Width=t.ChartWidth,console.log("[HQChartControl::CreateMinuteChart_WeChat] 3",t.ChartHeight,t.ChartWidth,e);var i=JSCommon.JSChart.Init(a);t.Minute.Option.NetworkFilter=t.NetworkFilter,t.Minute.Option.Symbol=t.Symbol,t.Minute.Option.IsFullDraw=!0,i.SetOption(t.Minute.Option),t.SetJSChart(i)}))},CreateMinuteChart:function(){return this.ChartType="Minute",this.CreateMinuteChart_h5()},IsKLineChart:function(){var t=this.GetJSChart();if(!t)return!1;var e=t.JSChartContainer.ClassName;return"KLineChartContainer"==e||"KLineChartHScreenContainer"==e},IsMinuteChart:function(){var t=this.GetJSChart();if(!t)return!1;var e=t.JSChartContainer.ClassName;return"MinuteChartContainer"==e||"MinuteChartHScreenContainer"==e},ChangeKLinePeriod:function(t){var e=this.GetJSChart();this.KLine.Option.KLine.Period=t,this.IsKLineChart()&&e?e.ChangePeriod(t):this.CreateKLineChart()},ChangeMinutePeriod:function(t){var e=this.GetJSChart();this.Minute.Option.DayCount=t,this.IsMinuteChart()&&e?e.ChangeDayCount(t):this.CreateMinuteChart()},ChangeKLineIndex:function(t,e){var a=this.GetJSChart();this.IsKLineChart()&&a&&a.ChangeIndex(t,e)},ChangeSymbol:function(t){this.Symbol=t;var e=this.GetJSChart();e&&e.ChangeSymbol(t)},ChangeRight:function(t){var e=this.GetJSChart();this.IsKLineChart()&&e&&e.ChangeRight(t)},ChangeKLineDrawType:function(t){var e=this.GetJSChart();this.IsKLineChart()&&e&&e.ChangeKLineDrawType(t)},KLineTouchStart:function(t){var e=this.GetJSChart();if(e){var a=this.ConvertTouchEventData(t);e.OnTouchStart(t),this.RestoreTouchEventData(a,t)}},KLineTouchMove:function(t){var e=this.GetJSChart();if(e){var a=this.ConvertTouchEventData(t);e.OnTouchMove(t),this.RestoreTouchEventData(a,t)}},KLineTouchEnd:function(t){var e=this.GetJSChart();if(e){var a=this.ConvertTouchEventData(t);e.OnTouchEnd(t),this.RestoreTouchEventData(a,t)}},ConvertTouchEventData:function(t){if(Array.isArray(t.touches))return null;for(var e=t.touches,a=[],i=0;i<10;++i){var r=i.toString(),n=t.touches[r];if(!n)break;a[i]=n}t.touches=a;var o=t.changedTouches,s=[];for(i=0;i<10;++i){r=i.toString(),n=t.changedTouches[r];if(!n)break;s[i]=n}return t.changedTouches=s,{Touches:e,ChangedTouches:o}},RestoreTouchEventData:function(t,e){t&&(e.touches=t.Touches,e.changedTouches=t.ChangedTouches)},NetworkFilter:function(t,e){console.log("[HQChartTemplate:NetworkFilter] Name=".concat(t.Name," Explain=").concat(t.Explain))}}};e.default=h},f298:function(t,e,a){"use strict";var i=a("497b"),r=a("9e70"),n=a("862c"),o=RangeError;t.exports=function(t){var e=r(n(this)),a="",s=i(t);if(s<0||s===1/0)throw new o("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(a+=e);return a}},f3f7:function(t,e,a){"use strict";a("53f7")},f855:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("d4b5"),a("e966"),a("aa9c"),a("c223");var i={stock:[{time:150002,date:20230829,price:7.07,open:7.2,yclose:7.15,high:7.5,low:7.03,vol:50437460,amount:357554848,symbol:"600000.sh",name:"浦发银行"}],start:0,end:100,count:1,ticket:0,version:"HQ.Stock 2.0",message:null,code:0,servertime:"2023-08-29 15:03:34"},r={code:0,data:[[20230829,7.09,7.07,7.09,7.07,7.08,1512692,8873760,1500]],ver:2,symbol:"xxx",name:"xxxx"},n={symbol:"600000.sh",name:"xxxxxxx",data:[{minute:[[925,7.21,7.21,7.21,7.21,42500,306425,7.21,20230707],[930,7.21,7.21,7.21,7.21,42500,306425,7.21,20230707],[931,7.19,7.19,7.19,7.19,269400,1939823,7.202,20230707],[932,7.2,7.2,7.2,7.2,231900,1672034,7.205,20230707],[933,7.21,7.21,7.21,7.21,144300,1041820,7.208,20230707],[934,7.22,7.22,7.22,7.22,87300,630341,7.21,20230707],[935,7.22,7.22,7.22,7.22,49600,358287,7.211,20230707],[936,7.2,7.2,7.2,7.2,106700,769942,7.211,20230707],[937,7.2,7.2,7.2,7.2,38400,276864,7.211,20230707],[938,7.2,7.2,7.2,7.2,31e3,223473,7.211,20230707],[939,7.2,7.2,7.2,7.2,38500,277594,7.211,20230707],[940,7.21,7.21,7.21,7.21,17400,125526,7.211,20230707],[941,7.21,7.21,7.21,7.21,20400,147115,7.211,20230707],[942,7.21,7.21,7.21,7.21,29300,211273,7.211,20230707],[943,7.21,7.21,7.21,7.21,154e3,1111381,7.212,20230707],[944,7.21,7.21,7.21,7.21,33300,240129,7.212,20230707],[945,7.21,7.21,7.21,7.21,198400,1432724,7.213,20230707],[946,7.22,7.22,7.22,7.22,56200,405804,7.213,20230707],[947,7.22,7.22,7.22,7.22,187400,1353030,7.214,20230707],[948,7.21,7.21,7.21,7.21,35900,258878,7.214,20230707],[949,7.21,7.21,7.21,7.21,38e3,274313,7.214,20230707],[950,7.21,7.21,7.21,7.21,15500,111781,7.214,20230707],[951,7.2,7.2,7.2,7.2,264900,1909460,7.213,20230707],[952,7.21,7.21,7.21,7.21,372800,2690957,7.214,20230707],[953,7.22,7.22,7.22,7.22,83100,599982,7.214,20230707],[954,7.22,7.22,7.22,7.22,18600,134301,7.214,20230707],[955,7.22,7.22,7.22,7.22,11900,85968,7.214,20230707],[956,7.22,7.22,7.22,7.22,43900,317337,7.215,20230707],[957,7.22,7.22,7.22,7.22,19300,139534,7.215,20230707],[958,7.22,7.22,7.22,7.22,11900,86027,7.215,20230707],[959,7.22,7.22,7.22,7.22,25800,186293,7.215,20230707],[1e3,7.22,7.22,7.22,7.22,77800,561725,7.215,20230707],[1001,7.22,7.22,7.22,7.22,53400,385801,7.215,20230707],[1002,7.22,7.22,7.22,7.22,65e3,469650,7.215,20230707],[1003,7.22,7.22,7.22,7.22,945700,6843184,7.221,20230707],[1004,7.23,7.23,7.23,7.23,130900,947953,7.221,20230707],[1005,7.23,7.23,7.23,7.23,118800,859986,7.222,20230707],[1006,7.24,7.24,7.24,7.24,14200,102846,7.222,20230707],[1007,7.23,7.23,7.23,7.23,173300,1253355,7.222,20230707],[1008,7.23,7.23,7.23,7.23,42200,305229,7.222,20230707],[1009,7.23,7.23,7.23,7.23,3100,22413,7.222,20230707],[1010,7.23,7.23,7.23,7.23,30900,223680,7.222,20230707],[1011,7.23,7.23,7.23,7.23,11500,83220,7.222,20230707],[1012,7.23,7.23,7.23,7.23,11400,82498,7.223,20230707],[1013,7.23,7.23,7.23,7.23,10300,74525,7.223,20230707],[1014,7.23,7.23,7.23,7.23,12200,88303,7.223,20230707],[1015,7.23,7.23,7.23,7.23,12900,93374,7.223,20230707],[1016,7.23,7.23,7.23,7.23,8800,63667,7.223,20230707],[1017,7.23,7.23,7.23,7.23,26800,193995,7.223,20230707],[1018,7.23,7.23,7.23,7.23,10200,73817,7.223,20230707],[1019,7.23,7.23,7.23,7.23,8900,64429,7.223,20230707],[1020,7.23,7.23,7.23,7.23,30600,221404,7.223,20230707],[1021,7.23,7.23,7.23,7.23,17e3,122956,7.223,20230707],[1022,7.23,7.23,7.23,7.23,8600,62247,7.223,20230707],[1023,7.23,7.23,7.23,7.23,18100,130921,7.223,20230707],[1024,7.23,7.23,7.23,7.23,50800,367521,7.223,20230707],[1025,7.23,7.23,7.23,7.23,57800,417975,7.223,20230707],[1026,7.23,7.23,7.23,7.23,44e3,318132,7.223,20230707],[1027,7.22,7.22,7.22,7.22,54600,394343,7.223,20230707],[1028,7.22,7.22,7.22,7.22,32500,234662,7.223,20230707],[1029,7.22,7.22,7.22,7.22,23200,167633,7.223,20230707],[1030,7.22,7.22,7.22,7.22,14400,104077,7.223,20230707],[1031,7.22,7.22,7.22,7.22,62900,454640,7.223,20230707],[1032,7.22,7.22,7.22,7.22,40100,289608,7.223,20230707],[1033,7.21,7.21,7.21,7.21,87100,628610,7.223,20230707],[1034,7.21,7.21,7.21,7.21,33700,243016,7.223,20230707],[1035,7.2,7.2,7.2,7.2,330100,2379824,7.222,20230707],[1036,7.2,7.2,7.2,7.2,16900,121686,7.222,20230707],[1037,7.2,7.2,7.2,7.2,119100,858705,7.222,20230707],[1038,7.21,7.21,7.21,7.21,300,2163,7.222,20230707],[1039,7.2,7.2,7.2,7.2,51900,374198,7.222,20230707],[1040,7.2,7.2,7.2,7.2,31e3,223356,7.222,20230707],[1041,7.2,7.2,7.2,7.2,51900,373939,7.222,20230707],[1042,7.19,7.19,7.19,7.19,256100,1843735,7.221,20230707],[1043,7.19,7.19,7.19,7.19,4300,30958,7.221,20230707],[1044,7.19,7.19,7.19,7.19,27800,200149,7.221,20230707],[1045,7.19,7.19,7.19,7.19,20900,150472,7.221,20230707],[1046,7.19,7.19,7.19,7.19,49900,359227,7.22,20230707],[1047,7.2,7.2,7.2,7.2,51800,372985,7.22,20230707],[1048,7.2,7.2,7.2,7.2,26900,193695,7.22,20230707],[1049,7.2,7.2,7.2,7.2,8900,64080,7.22,20230707],[1050,7.19,7.19,7.19,7.19,91300,657209,7.22,20230707],[1051,7.19,7.19,7.19,7.19,40700,292820,7.22,20230707],[1052,7.19,7.19,7.19,7.19,45300,325905,7.219,20230707],[1053,7.19,7.19,7.19,7.19,3200,23037,7.219,20230707],[1054,7.19,7.19,7.19,7.19,559300,4021484,7.217,20230707],[1055,7.18,7.18,7.18,7.18,394400,2835733,7.215,20230707],[1056,7.19,7.19,7.19,7.19,135100,971369,7.215,20230707],[1057,7.19,7.19,7.19,7.19,33100,238104,7.215,20230707],[1058,7.19,7.19,7.19,7.19,14100,101415,7.215,20230707],[1059,7.19,7.19,7.19,7.19,5800,41706,7.215,20230707],[1100,7.19,7.19,7.19,7.19,5100,36681,7.215,20230707],[1101,7.19,7.19,7.19,7.19,900,6474,7.215,20230707],[1102,7.19,7.19,7.19,7.19,3200,23010,7.215,20230707],[1103,7.19,7.19,7.19,7.19,19200,138067,7.215,20230707],[1104,7.19,7.19,7.19,7.19,27900,200727,7.215,20230707],[1105,7.19,7.19,7.19,7.19,17e3,122358,7.215,20230707],[1106,7.19,7.19,7.19,7.19,13500,97178,7.215,20230707],[1107,7.19,7.19,7.19,7.19,34400,247348,7.215,20230707],[1108,7.19,7.19,7.19,7.19,7700,55414,7.215,20230707],[1109,7.19,7.19,7.19,7.19,20600,148215,7.214,20230707],[1110,7.19,7.19,7.19,7.19,8400,60424,7.214,20230707],[1111,7.19,7.19,7.19,7.19,16900,121632,7.214,20230707],[1112,7.2,7.2,7.2,7.2,462900,3332833,7.214,20230707],[1113,7.2,7.2,7.2,7.2,68300,492052,7.213,20230707],[1114,7.2,7.2,7.2,7.2,32500,234074,7.213,20230707],[1115,7.2,7.2,7.2,7.2,41600,299530,7.213,20230707],[1116,7.2,7.2,7.2,7.2,47600,342831,7.213,20230707],[1117,7.2,7.2,7.2,7.2,39700,285861,7.213,20230707],[1118,7.2,7.2,7.2,7.2,1600,11522,7.213,20230707],[1119,7.2,7.2,7.2,7.2,7500,54024,7.213,20230707],[1120,7.21,7.21,7.21,7.21,22800,164385,7.213,20230707],[1121,7.2,7.2,7.2,7.2,33200,239043,7.213,20230707],[1122,7.2,7.2,7.2,7.2,49400,355686,7.213,20230707],[1123,7.19,7.19,7.19,7.19,58800,423288,7.213,20230707],[1124,7.19,7.19,7.19,7.19,54e3,388421,7.213,20230707],[1125,7.19,7.19,7.19,7.19,100500,722700,7.213,20230707],[1126,7.19,7.19,7.19,7.19,21300,153237,7.213,20230707],[1127,7.19,7.19,7.19,7.19,46200,332341,7.212,20230707],[1128,7.19,7.19,7.19,7.19,55600,399881,7.212,20230707],[1129,7.21,7.21,7.21,7.21,100,721,7.212,20230707],[1130,7.19,7.19,7.19,7.19,41900,301635,7.212,20230707],[1300,7.2,7.2,7.2,7.2,63700,458986,7.212,20230707],[1301,7.2,7.2,7.2,7.2,63700,458986,7.212,20230707],[1302,7.19,7.19,7.19,7.19,59400,427703,7.212,20230707],[1303,7.19,7.19,7.19,7.19,5400,38832,7.212,20230707],[1304,7.19,7.19,7.19,7.19,73900,531570,7.212,20230707],[1305,7.19,7.19,7.19,7.19,32900,236603,7.212,20230707],[1306,7.19,7.19,7.19,7.19,48500,349204,7.212,20230707],[1307,7.19,7.19,7.19,7.19,63900,459717,7.212,20230707],[1308,7.19,7.19,7.19,7.19,36300,261304,7.212,20230707],[1309,7.2,7.2,7.2,7.2,10600,76354,7.212,20230707],[1310,7.21,7.21,7.21,7.21,56700,408814,7.212,20230707],[1311,7.21,7.21,7.21,7.21,42300,305040,7.212,20230707],[1312,7.21,7.21,7.21,7.21,16800,121186,7.212,20230707],[1313,7.21,7.21,7.21,7.21,45600,328982,7.212,20230707],[1314,7.21,7.21,7.21,7.21,16600,119741,7.212,20230707],[1315,7.21,7.21,7.21,7.21,5200,37537,7.212,20230707],[1316,7.21,7.21,7.21,7.21,24200,174491,7.212,20230707],[1317,7.21,7.21,7.21,7.21,66e3,476005,7.212,20230707],[1318,7.21,7.21,7.21,7.21,24800,178833,7.212,20230707],[1319,7.21,7.21,7.21,7.21,40300,290581,7.212,20230707],[1320,7.21,7.21,7.21,7.21,31900,230090,7.212,20230707],[1321,7.21,7.21,7.21,7.21,233100,1682955,7.212,20230707],[1322,7.22,7.22,7.22,7.22,32e3,231174,7.212,20230707],[1323,7.22,7.22,7.22,7.22,59700,431228,7.212,20230707],[1324,7.22,7.22,7.22,7.22,40100,289677,7.212,20230707],[1325,7.23,7.23,7.23,7.23,54600,394757,7.212,20230707],[1326,7.22,7.22,7.22,7.22,11300,81697,7.212,20230707],[1327,7.22,7.22,7.22,7.22,11500,83123,7.212,20230707],[1328,7.22,7.22,7.22,7.22,3600,26027,7.212,20230707],[1329,7.22,7.22,7.22,7.22,105400,761145,7.212,20230707],[1330,7.22,7.22,7.22,7.22,53100,383397,7.212,20230707],[1331,7.22,7.22,7.22,7.22,4e3,28895,7.212,20230707],[1332,7.22,7.22,7.22,7.22,81e3,584858,7.212,20230707],[1333,7.21,7.21,7.21,7.21,49100,354218,7.212,20230707],[1334,7.22,7.22,7.22,7.22,26900,194198,7.212,20230707],[1335,7.22,7.22,7.22,7.22,14e3,101118,7.212,20230707],[1336,7.22,7.22,7.22,7.22,2e3,14459,7.212,20230707],[1337,7.22,7.22,7.22,7.22,35200,254229,7.212,20230707],[1338,7.22,7.22,7.22,7.22,2700,19504,7.212,20230707],[1339,7.23,7.23,7.23,7.23,3500,25304,7.212,20230707],[1340,7.22,7.22,7.22,7.22,28300,204359,7.212,20230707],[1341,7.22,7.22,7.22,7.22,8600,62165,7.212,20230707],[1342,7.22,7.22,7.22,7.22,4200,30339,7.212,20230707],[1343,7.22,7.22,7.22,7.22,7800,56355,7.212,20230707],[1344,7.22,7.22,7.22,7.22,18400,132977,7.213,20230707],[1345,7.22,7.22,7.22,7.22,166900,1204938,7.213,20230707],[1346,7.21,7.21,7.21,7.21,33500,241721,7.213,20230707],[1347,7.21,7.21,7.21,7.21,27800,200484,7.213,20230707],[1348,7.21,7.21,7.21,7.21,14300,103140,7.213,20230707],[1349,7.21,7.21,7.21,7.21,2e3,14439,7.213,20230707],[1350,7.21,7.21,7.21,7.21,25200,181702,7.213,20230707],[1351,7.21,7.21,7.21,7.21,66100,476590,7.213,20230707],[1352,7.21,7.21,7.21,7.21,39100,281913,7.213,20230707],[1353,7.21,7.21,7.21,7.21,152500,1100990,7.213,20230707],[1354,7.21,7.21,7.21,7.21,17800,128505,7.213,20230707],[1355,7.21,7.21,7.21,7.21,22e3,158632,7.213,20230707],[1356,7.21,7.21,7.21,7.21,11100,80075,7.213,20230707],[1357,7.21,7.21,7.21,7.21,36900,266075,7.213,20230707],[1358,7.21,7.21,7.21,7.21,36600,263917,7.213,20230707],[1359,7.22,7.22,7.22,7.22,7600,54871,7.213,20230707],[1400,7.21,7.21,7.21,7.21,35400,255556,7.213,20230707],[1401,7.21,7.21,7.21,7.21,20600,148635,7.213,20230707],[1402,7.21,7.21,7.21,7.21,9800,70691,7.213,20230707],[1403,7.21,7.21,7.21,7.21,17800,128497,7.213,20230707],[1404,7.22,7.22,7.22,7.22,4400,31741,7.213,20230707],[1405,7.21,7.21,7.21,7.21,73500,529941,7.213,20230707],[1406,7.21,7.21,7.21,7.21,11200,80761,7.213,20230707],[1407,7.21,7.21,7.21,7.21,78300,564696,7.213,20230707],[1408,7.21,7.21,7.21,7.21,43300,312082,7.213,20230707],[1409,7.21,7.21,7.21,7.21,137700,992983,7.213,20230707],[1410,7.21,7.21,7.21,7.21,1100,7941,7.213,20230707],[1411,7.21,7.21,7.21,7.21,2700,19491,7.213,20230707],[1412,7.21,7.21,7.21,7.21,10500,75798,7.213,20230707],[1413,7.21,7.21,7.21,7.21,28100,202811,7.213,20230707],[1414,7.21,7.21,7.21,7.21,12500,90194,7.213,20230707],[1415,7.21,7.21,7.21,7.21,8600,62090,7.213,20230707],[1416,7.21,7.21,7.21,7.21,132200,954669,7.213,20230707],[1417,7.21,7.21,7.21,7.21,87900,634466,7.213,20230707],[1418,7.21,7.21,7.21,7.21,34700,250223,7.213,20230707],[1419,7.21,7.21,7.21,7.21,92700,668380,7.213,20230707],[1420,7.21,7.22,7.21,7.22,32600,235105,7.213,20230707]],date:20230707,yclose:7.21},{minute:[[925,7.25,7.25,7.25,7.25,108600,787350,7.25,20230706],[930,7.25,7.25,7.25,7.25,108600,787350,7.25,20230706],[931,7.23,7.23,7.23,7.23,285600,2069218,7.247,20230706],[932,7.24,7.24,7.24,7.24,51200,371108,7.247,20230706],[933,7.24,7.24,7.24,7.24,67800,491579,7.247,20230706],[934,7.24,7.24,7.24,7.24,75700,548526,7.247,20230706],[935,7.24,7.24,7.24,7.24,43100,312555,7.248,20230706],[936,7.24,7.24,7.24,7.24,19800,143509,7.248,20230706],[937,7.24,7.24,7.24,7.24,126200,915178,7.248,20230706],[938,7.24,7.24,7.24,7.24,119200,864231,7.249,20230706],[939,7.25,7.25,7.25,7.25,190300,1380168,7.249,20230706],[940,7.25,7.25,7.25,7.25,27400,198890,7.249,20230706],[941,7.25,7.25,7.25,7.25,2e4,145011,7.249,20230706],[942,7.25,7.25,7.25,7.25,37400,271214,7.25,20230706],[943,7.24,7.24,7.24,7.24,32200,233343,7.249,20230706],[944,7.25,7.25,7.25,7.25,14500,105153,7.25,20230706],[945,7.24,7.24,7.24,7.24,43100,312385,7.249,20230706],[946,7.24,7.24,7.24,7.24,41500,300897,7.25,20230706],[947,7.24,7.24,7.24,7.24,36100,261677,7.249,20230706],[948,7.25,7.25,7.25,7.25,23700,171883,7.25,20230706],[949,7.25,7.25,7.25,7.25,67100,487028,7.25,20230706],[950,7.25,7.25,7.25,7.25,35600,257891,7.25,20230706],[951,7.24,7.24,7.24,7.24,100400,728183,7.25,20230706],[952,7.25,7.25,7.25,7.25,73900,535912,7.25,20230706],[953,7.24,7.24,7.24,7.24,19500,141383,7.25,20230706],[954,7.25,7.25,7.25,7.25,29300,212666,7.25,20230706],[955,7.25,7.25,7.25,7.25,37100,269189,7.25,20230706],[956,7.25,7.25,7.25,7.25,21200,153873,7.25,20230706],[957,7.25,7.25,7.25,7.25,75e3,544509,7.251,20230706],[958,7.26,7.26,7.26,7.26,51e3,370361,7.251,20230706],[959,7.25,7.25,7.25,7.25,6600,47892,7.251,20230706],[1e3,7.25,7.25,7.25,7.25,53500,388288,7.251,20230706],[1001,7.25,7.25,7.25,7.25,9600,69663,7.251,20230706],[1002,7.25,7.25,7.25,7.25,383e3,2777011,7.251,20230706],[1003,7.25,7.25,7.25,7.25,61e3,442742,7.252,20230706],[1004,7.26,7.26,7.26,7.26,19500,141710,7.252,20230706],[1005,7.26,7.26,7.26,7.26,47300,343608,7.252,20230706],[1006,7.26,7.26,7.26,7.26,76900,558452,7.252,20230706],[1007,7.26,7.26,7.26,7.26,43700,317664,7.253,20230706],[1008,7.26,7.26,7.26,7.26,51500,374309,7.253,20230706],[1009,7.26,7.26,7.26,7.26,22100,160567,7.253,20230706],[1010,7.26,7.26,7.26,7.26,16400,119187,7.253,20230706],[1011,7.26,7.26,7.26,7.26,29e3,210825,7.253,20230706],[1012,7.26,7.26,7.26,7.26,56800,412850,7.254,20230706],[1013,7.26,7.26,7.26,7.26,18300,133031,7.254,20230706],[1014,7.26,7.26,7.26,7.26,62100,451046,7.254,20230706],[1015,7.26,7.26,7.26,7.26,30900,224506,7.254,20230706],[1016,7.26,7.26,7.26,7.26,30700,223024,7.254,20230706],[1017,7.26,7.26,7.26,7.26,17800,129330,7.254,20230706],[1018,7.26,7.26,7.26,7.26,35900,260828,7.254,20230706],[1019,7.26,7.26,7.26,7.26,50600,367455,7.254,20230706],[1020,7.26,7.26,7.26,7.26,29e3,210660,7.254,20230706],[1021,7.25,7.25,7.25,7.25,153e3,1110925,7.255,20230706],[1022,7.25,7.25,7.25,7.25,75800,550576,7.255,20230706],[1023,7.25,7.25,7.25,7.25,7700,55930,7.255,20230706],[1024,7.25,7.25,7.25,7.25,40800,296198,7.255,20230706],[1025,7.25,7.25,7.25,7.25,37800,274459,7.255,20230706],[1026,7.25,7.25,7.25,7.25,11200,81305,7.255,20230706],[1027,7.25,7.25,7.25,7.25,24100,174817,7.255,20230706],[1028,7.25,7.25,7.25,7.25,15400,111789,7.255,20230706],[1029,7.25,7.25,7.25,7.25,35900,260558,7.255,20230706],[1030,7.25,7.25,7.25,7.25,27200,197464,7.255,20230706],[1031,7.25,7.25,7.25,7.25,78100,566999,7.255,20230706],[1032,7.25,7.25,7.25,7.25,13500,98006,7.255,20230706],[1033,7.25,7.25,7.25,7.25,13e3,94343,7.255,20230706],[1034,7.25,7.25,7.25,7.25,29400,213355,7.255,20230706],[1035,7.25,7.25,7.25,7.25,21100,153181,7.255,20230706],[1036,7.25,7.25,7.25,7.25,11500,83468,7.255,20230706],[1037,7.25,7.25,7.25,7.25,28500,206725,7.255,20230706],[1038,7.25,7.25,7.25,7.25,12900,93647,7.255,20230706],[1039,7.25,7.25,7.25,7.25,22300,161794,7.255,20230706],[1040,7.25,7.25,7.25,7.25,10100,73279,7.255,20230706],[1041,7.25,7.25,7.25,7.25,110200,799136,7.255,20230706],[1042,7.25,7.25,7.25,7.25,38600,280035,7.255,20230706],[1043,7.25,7.25,7.25,7.25,31800,230608,7.255,20230706],[1044,7.24,7.24,7.24,7.24,475200,3442872,7.254,20230706],[1045,7.23,7.23,7.23,7.23,11e4,796334,7.254,20230706],[1046,7.23,7.23,7.23,7.23,125600,908387,7.253,20230706],[1047,7.22,7.22,7.22,7.22,177800,1285519,7.252,20230706],[1048,7.23,7.23,7.23,7.23,20400,147510,7.252,20230706],[1049,7.22,7.22,7.22,7.22,69400,501596,7.252,20230706],[1050,7.22,7.22,7.22,7.22,15e3,108395,7.252,20230706],[1051,7.22,7.22,7.22,7.22,185500,1339673,7.251,20230706],[1052,7.22,7.22,7.22,7.22,57400,414670,7.25,20230706],[1053,7.22,7.22,7.22,7.22,13e3,93930,7.25,20230706],[1054,7.22,7.22,7.22,7.22,23400,169501,7.25,20230706],[1055,7.22,7.22,7.22,7.22,21100,152457,7.25,20230706],[1056,7.22,7.22,7.22,7.22,56400,407025,7.25,20230706],[1057,7.22,7.22,7.22,7.22,9300,67236,7.25,20230706],[1058,7.22,7.22,7.22,7.22,61900,447531,7.25,20230706],[1059,7.22,7.22,7.22,7.22,34200,247174,7.249,20230706],[1100,7.22,7.22,7.22,7.22,42200,305124,7.249,20230706],[1101,7.22,7.22,7.22,7.22,60700,438857,7.249,20230706],[1102,7.22,7.22,7.22,7.22,17300,124906,7.249,20230706],[1103,7.22,7.22,7.22,7.22,24600,177848,7.249,20230706],[1104,7.22,7.22,7.22,7.22,38500,278271,7.249,20230706],[1105,7.22,7.22,7.22,7.22,12100,87477,7.249,20230706],[1106,7.22,7.22,7.22,7.22,558800,4038799,7.247,20230706],[1107,7.22,7.22,7.22,7.22,41700,301411,7.247,20230706],[1108,7.22,7.22,7.22,7.22,32300,233496,7.247,20230706],[1109,7.22,7.22,7.22,7.22,87100,629868,7.246,20230706],[1110,7.23,7.23,7.23,7.23,32100,232313,7.246,20230706],[1111,7.23,7.23,7.23,7.23,22900,165794,7.246,20230706],[1112,7.23,7.23,7.23,7.23,17800,128869,7.246,20230706],[1113,7.23,7.23,7.23,7.23,139800,1010711,7.246,20230706],[1114,7.23,7.23,7.23,7.23,10400,75245,7.246,20230706],[1115,7.23,7.23,7.23,7.23,17300,125146,7.246,20230706],[1116,7.22,7.22,7.22,7.22,75300,544267,7.246,20230706],[1117,7.22,7.22,7.22,7.22,25300,182933,7.246,20230706],[1118,7.22,7.22,7.22,7.22,42e3,303537,7.245,20230706],[1119,7.22,7.22,7.22,7.22,60700,438685,7.245,20230706],[1120,7.22,7.22,7.22,7.22,7600,54872,7.245,20230706],[1121,7.22,7.22,7.22,7.22,18600,134355,7.245,20230706],[1122,7.22,7.22,7.22,7.22,249200,1799234,7.244,20230706],[1123,7.21,7.21,7.21,7.21,414e3,2987122,7.243,20230706],[1124,7.21,7.21,7.21,7.21,155100,1118314,7.242,20230706],[1125,7.21,7.21,7.21,7.21,13400,96731,7.242,20230706],[1126,7.21,7.21,7.21,7.21,33400,240832,7.242,20230706],[1127,7.21,7.21,7.21,7.21,57300,413316,7.242,20230706],[1128,7.21,7.21,7.21,7.21,106300,766480,7.241,20230706],[1129,7.2,7.2,7.2,7.2,598400,4311845,7.239,20230706],[1130,7.2,7.2,7.2,7.2,160200,1153686,7.238,20230706],[1300,7.19,7.19,7.19,7.19,598800,4310197,7.235,20230706],[1301,7.19,7.19,7.19,7.19,598800,4310197,7.235,20230706],[1302,7.19,7.19,7.19,7.19,84200,605686,7.235,20230706],[1303,7.19,7.19,7.19,7.19,69e3,496141,7.235,20230706],[1304,7.19,7.19,7.19,7.19,94700,680953,7.234,20230706],[1305,7.19,7.19,7.19,7.19,10800,77706,7.234,20230706],[1306,7.19,7.19,7.19,7.19,66700,479668,7.234,20230706],[1307,7.19,7.19,7.19,7.19,17400,125233,7.234,20230706],[1308,7.19,7.19,7.19,7.19,33200,238721,7.234,20230706],[1309,7.19,7.19,7.19,7.19,68200,490667,7.233,20230706],[1310,7.19,7.19,7.19,7.19,36900,265662,7.233,20230706],[1311,7.19,7.19,7.19,7.19,47500,341769,7.233,20230706],[1312,7.19,7.19,7.19,7.19,47400,340919,7.233,20230706],[1313,7.19,7.19,7.19,7.19,69700,501733,7.233,20230706],[1314,7.19,7.19,7.19,7.19,125300,902259,7.232,20230706],[1315,7.2,7.2,7.2,7.2,24900,179522,7.232,20230706],[1316,7.2,7.2,7.2,7.2,32300,232875,7.232,20230706],[1317,7.2,7.2,7.2,7.2,39e3,281120,7.232,20230706],[1318,7.2,7.2,7.2,7.2,8200,59105,7.232,20230706],[1319,7.2,7.2,7.2,7.2,154500,1112551,7.231,20230706],[1320,7.2,7.2,7.2,7.2,28300,203835,7.231,20230706],[1321,7.2,7.2,7.2,7.2,5600,40343,7.231,20230706],[1322,7.2,7.2,7.2,7.2,26700,192479,7.231,20230706],[1323,7.2,7.2,7.2,7.2,12e3,86515,7.231,20230706],[1324,7.2,7.2,7.2,7.2,20400,147063,7.231,20230706],[1325,7.2,7.2,7.2,7.2,114e3,821937,7.231,20230706],[1326,7.2,7.2,7.2,7.2,90100,649619,7.231,20230706],[1327,7.2,7.2,7.2,7.2,15100,108765,7.231,20230706],[1328,7.2,7.2,7.2,7.2,21100,152363,7.231,20230706],[1329,7.2,7.2,7.2,7.2,19100,137654,7.231,20230706],[1330,7.2,7.2,7.2,7.2,21500,155008,7.231,20230706],[1331,7.2,7.2,7.2,7.2,14900,107350,7.231,20230706],[1332,7.2,7.2,7.2,7.2,131600,947635,7.23,20230706],[1333,7.2,7.2,7.2,7.2,39100,281798,7.23,20230706],[1334,7.2,7.2,7.2,7.2,2900,20892,7.23,20230706],[1335,7.2,7.2,7.2,7.2,7700,55776,7.23,20230706],[1336,7.2,7.2,7.2,7.2,30700,221205,7.23,20230706],[1337,7.2,7.2,7.2,7.2,26400,190154,7.23,20230706],[1338,7.2,7.2,7.2,7.2,16200,116700,7.23,20230706],[1339,7.2,7.2,7.2,7.2,44300,319292,7.23,20230706],[1340,7.2,7.2,7.2,7.2,140300,1011233,7.23,20230706],[1341,7.2,7.2,7.2,7.2,19200,138424,7.23,20230706],[1342,7.2,7.2,7.2,7.2,29e3,208946,7.229,20230706],[1343,7.19,7.19,7.19,7.19,336500,2422962,7.229,20230706],[1344,7.19,7.19,7.19,7.19,66300,477157,7.228,20230706],[1345,7.19,7.19,7.19,7.19,67400,485339,7.228,20230706],[1346,7.2,7.2,7.2,7.2,34200,246321,7.228,20230706],[1347,7.2,7.2,7.2,7.2,85700,617097,7.228,20230706],[1348,7.2,7.2,7.2,7.2,146200,1053793,7.228,20230706],[1349,7.2,7.2,7.2,7.2,17300,124728,7.228,20230706],[1350,7.2,7.2,7.2,7.2,17600,126887,7.228,20230706],[1351,7.2,7.2,7.2,7.2,48800,351406,7.228,20230706],[1352,7.2,7.2,7.2,7.2,32300,232926,7.228,20230706],[1353,7.2,7.2,7.2,7.2,41400,298471,7.227,20230706],[1354,7.2,7.2,7.2,7.2,26400,190365,7.227,20230706],[1355,7.2,7.2,7.2,7.2,15600,112506,7.227,20230706],[1356,7.21,7.21,7.21,7.21,6900,49815,7.227,20230706],[1357,7.21,7.21,7.21,7.21,18300,132114,7.227,20230706],[1358,7.21,7.21,7.21,7.21,7300,52699,7.227,20230706],[1359,7.21,7.21,7.21,7.21,33500,241826,7.227,20230706],[1400,7.21,7.21,7.21,7.21,23600,170337,7.227,20230706],[1401,7.21,7.21,7.21,7.21,44700,322489,7.227,20230706],[1402,7.21,7.21,7.21,7.21,50700,365725,7.227,20230706],[1403,7.21,7.21,7.21,7.21,22900,165218,7.227,20230706],[1404,7.21,7.21,7.21,7.21,30600,220631,7.227,20230706],[1405,7.21,7.21,7.21,7.21,14700,106069,7.227,20230706],[1406,7.21,7.21,7.21,7.21,12900,93132,7.227,20230706],[1407,7.21,7.21,7.21,7.21,40900,295033,7.227,20230706],[1408,7.21,7.21,7.21,7.21,23300,168073,7.227,20230706],[1409,7.21,7.21,7.21,7.21,4100,29578,7.227,20230706],[1410,7.21,7.21,7.21,7.21,191e3,1377579,7.227,20230706],[1411,7.21,7.21,7.21,7.21,35100,253158,7.227,20230706],[1412,7.21,7.21,7.21,7.21,14700,106125,7.227,20230706],[1413,7.21,7.21,7.21,7.21,3100,22352,7.227,20230706],[1414,7.21,7.21,7.21,7.21,23e3,165939,7.227,20230706],[1415,7.21,7.21,7.21,7.21,16300,117621,7.227,20230706],[1416,7.21,7.21,7.21,7.21,15900,114671,7.227,20230706],[1417,7.21,7.21,7.21,7.21,11700,84469,7.227,20230706],[1418,7.21,7.21,7.21,7.21,50200,362078,7.227,20230706],[1419,7.21,7.21,7.21,7.21,2400,17304,7.227,20230706],[1420,7.21,7.21,7.21,7.21,26400,190536,7.227,20230706],[1421,7.2,7.2,7.2,7.2,109300,788038,7.227,20230706],[1422,7.2,7.2,7.2,7.2,15700,113119,7.227,20230706],[1423,7.2,7.2,7.2,7.2,40900,294824,7.226,20230706],[1424,7.2,7.2,7.2,7.2,41800,301294,7.226,20230706],[1425,7.2,7.2,7.2,7.2,50500,364143,7.226,20230706],[1426,7.21,7.21,7.21,7.21,13900,100285,7.226,20230706],[1427,7.21,7.21,7.21,7.21,7200,51950,7.226,20230706],[1428,7.21,7.21,7.21,7.21,33900,244578,7.226,20230706],[1429,7.21,7.21,7.21,7.21,14900,107482,7.226,20230706],[1430,7.21,7.21,7.21,7.21,28400,204765,7.226,20230706],[1431,7.21,7.21,7.21,7.21,112e3,808056,7.226,20230706],[1432,7.2,7.2,7.2,7.2,99100,714625,7.226,20230706],[1433,7.21,7.21,7.21,7.21,19800,142769,7.226,20230706],[1434,7.21,7.21,7.21,7.21,34e3,245149,7.226,20230706],[1435,7.21,7.21,7.21,7.21,36200,261007,7.226,20230706],[1436,7.21,7.21,7.21,7.21,14400,103874,7.226,20230706],[1437,7.21,7.21,7.21,7.21,88300,636761,7.226,20230706],[1438,7.21,7.21,7.21,7.21,28600,206211,7.226,20230706],[1439,7.2,7.2,7.2,7.2,78700,567259,7.226,20230706],[1440,7.2,7.2,7.2,7.2,20600,148440,7.226,20230706],[1441,7.2,7.2,7.2,7.2,64100,462182,7.226,20230706],[1442,7.2,7.2,7.2,7.2,60900,438928,7.225,20230706],[1443,7.2,7.2,7.2,7.2,29500,212770,7.225,20230706],[1444,7.21,7.21,7.21,7.21,27300,197030,7.225,20230706],[1445,7.21,7.21,7.21,7.21,11600,83685,7.225,20230706],[1446,7.21,7.21,7.21,7.21,27600,199208,7.225,20230706],[1447,7.21,7.21,7.21,7.21,34900,251849,7.225,20230706],[1448,7.21,7.21,7.21,7.21,15500,111759,7.225,20230706],[1449,7.21,7.21,7.21,7.21,18100,130502,7.225,20230706],[1450,7.21,7.21,7.21,7.21,41100,296546,7.225,20230706],[1451,7.2,7.2,7.2,7.2,131500,948231,7.225,20230706],[1452,7.21,7.21,7.21,7.21,14300,103118,7.225,20230706],[1453,7.2,7.2,7.2,7.2,161400,1163922,7.225,20230706],[1454,7.21,7.21,7.21,7.21,20800,150022,7.225,20230706],[1455,7.21,7.21,7.21,7.21,77800,561617,7.225,20230706],[1456,7.21,7.21,7.21,7.21,118900,858627,7.225,20230706],[1457,7.21,7.21,7.21,7.21,46100,332538,7.225,20230706],[1458,7.22,7.22,7.22,7.22,0,0,7.225,20230706],[1459,7.22,7.22,7.22,7.22,0,0,7.225,20230706],[1500,7.21,7.21,7.21,7.21,369300,2662444,7.225,20230706]],date:20230706,yclose:7.24},{minute:[[925,7.26,7.26,7.26,7.26,55600,403656,7.26,20230705],[930,7.26,7.26,7.26,7.26,55600,403656,7.26,20230705],[931,7.27,7.27,7.27,7.27,100200,728734,7.268,20230705],[932,7.27,7.27,7.27,7.27,60500,440077,7.27,20230705],[933,7.27,7.27,7.27,7.27,31700,230675,7.271,20230705],[934,7.27,7.27,7.27,7.27,47800,347806,7.272,20230705],[935,7.27,7.27,7.27,7.27,128700,936755,7.274,20230705],[936,7.26,7.26,7.26,7.26,38600,280626,7.273,20230705],[937,7.26,7.26,7.26,7.26,56600,411513,7.273,20230705],[938,7.27,7.27,7.27,7.27,48600,353762,7.274,20230705],[939,7.27,7.27,7.27,7.27,15300,111338,7.274,20230705],[940,7.27,7.27,7.27,7.27,121700,884900,7.273,20230705],[941,7.26,7.26,7.26,7.26,53400,388049,7.273,20230705],[942,7.26,7.26,7.26,7.26,53200,386477,7.272,20230705],[943,7.26,7.26,7.26,7.26,4e4,290548,7.272,20230705],[944,7.26,7.26,7.26,7.26,129500,941729,7.272,20230705],[945,7.26,7.26,7.26,7.26,100300,728605,7.271,20230705],[946,7.25,7.25,7.25,7.25,194100,1408507,7.269,20230705],[947,7.24,7.24,7.24,7.24,248100,1798331,7.266,20230705],[948,7.25,7.25,7.25,7.25,91300,661933,7.265,20230705],[949,7.24,7.24,7.24,7.24,128600,931879,7.263,20230705],[950,7.24,7.24,7.24,7.24,65700,475876,7.263,20230705],[951,7.24,7.24,7.24,7.24,269100,1948582,7.26,20230705],[952,7.23,7.23,7.23,7.23,137e3,991768,7.259,20230705],[953,7.24,7.24,7.24,7.24,52500,380523,7.258,20230705],[954,7.23,7.23,7.23,7.23,160800,1164030,7.257,20230705],[955,7.23,7.23,7.23,7.23,45200,326924,7.257,20230705],[956,7.23,7.23,7.23,7.23,57600,416496,7.256,20230705],[957,7.23,7.23,7.23,7.23,199100,1441323,7.255,20230705],[958,7.23,7.23,7.23,7.23,79600,575906,7.254,20230705],[959,7.21,7.21,7.21,7.21,702400,5075559,7.249,20230705],[1e3,7.21,7.21,7.21,7.21,163500,1179290,7.247,20230705],[1001,7.21,7.21,7.21,7.21,107700,777433,7.246,20230705],[1002,7.22,7.22,7.22,7.22,31900,230382,7.246,20230705],[1003,7.22,7.22,7.22,7.22,44900,324556,7.246,20230705],[1004,7.23,7.23,7.23,7.23,80300,580642,7.246,20230705],[1005,7.22,7.22,7.22,7.22,98100,708877,7.245,20230705],[1006,7.23,7.23,7.23,7.23,37300,269696,7.245,20230705],[1007,7.22,7.22,7.22,7.22,135e3,975928,7.244,20230705],[1008,7.22,7.22,7.22,7.22,77500,560084,7.244,20230705],[1009,7.22,7.22,7.22,7.22,32400,234215,7.244,20230705],[1010,7.23,7.23,7.23,7.23,42700,308988,7.244,20230705],[1011,7.23,7.23,7.23,7.23,18700,135245,7.244,20230705],[1012,7.24,7.24,7.24,7.24,140600,1017938,7.244,20230705],[1013,7.24,7.24,7.24,7.24,37700,273155,7.244,20230705],[1014,7.24,7.24,7.24,7.24,68900,498866,7.244,20230705],[1015,7.23,7.23,7.23,7.23,57200,413602,7.244,20230705],[1016,7.23,7.23,7.23,7.23,26600,192946,7.244,20230705],[1017,7.23,7.23,7.23,7.23,20200,146243,7.244,20230705],[1018,7.23,7.23,7.23,7.23,29900,216473,7.244,20230705],[1019,7.23,7.23,7.23,7.23,62500,452149,7.244,20230705],[1020,7.24,7.24,7.24,7.24,7700,55798,7.244,20230705],[1021,7.23,7.23,7.23,7.23,45300,327813,7.243,20230705],[1022,7.23,7.23,7.23,7.23,14e3,101251,7.243,20230705],[1023,7.23,7.23,7.23,7.23,59300,429317,7.243,20230705],[1024,7.23,7.23,7.23,7.23,51100,369575,7.243,20230705],[1025,7.24,7.24,7.24,7.24,13800,100026,7.243,20230705],[1026,7.24,7.24,7.24,7.24,7900,57265,7.243,20230705],[1027,7.24,7.24,7.24,7.24,27500,199256,7.243,20230705],[1028,7.24,7.24,7.24,7.24,63500,460240,7.243,20230705],[1029,7.24,7.24,7.24,7.24,56100,406408,7.243,20230705],[1030,7.23,7.23,7.23,7.23,145e3,1049786,7.243,20230705],[1031,7.23,7.23,7.23,7.23,46700,338245,7.243,20230705],[1032,7.23,7.23,7.23,7.23,36600,264802,7.243,20230705],[1033,7.23,7.23,7.23,7.23,17700,128022,7.243,20230705],[1034,7.23,7.23,7.23,7.23,9900,71673,7.243,20230705],[1035,7.23,7.23,7.23,7.23,42e3,304063,7.243,20230705],[1036,7.23,7.23,7.23,7.23,28800,208510,7.243,20230705],[1037,7.24,7.24,7.24,7.24,19500,141215,7.243,20230705],[1038,7.23,7.23,7.23,7.23,25e3,181011,7.243,20230705],[1039,7.24,7.24,7.24,7.24,14700,106458,7.243,20230705],[1040,7.24,7.24,7.24,7.24,4300,31167,7.243,20230705],[1041,7.24,7.24,7.24,7.24,26800,194204,7.243,20230705],[1042,7.24,7.24,7.24,7.24,26300,190646,7.243,20230705],[1043,7.24,7.24,7.24,7.24,30300,219670,7.243,20230705],[1044,7.24,7.24,7.24,7.24,30400,220359,7.243,20230705],[1045,7.24,7.24,7.24,7.24,28600,207357,7.243,20230705],[1046,7.24,7.24,7.24,7.24,32300,233914,7.243,20230705],[1047,7.23,7.23,7.23,7.23,104e3,752882,7.243,20230705],[1048,7.24,7.24,7.24,7.24,20700,149867,7.243,20230705],[1049,7.23,7.23,7.23,7.23,17200,124514,7.243,20230705],[1050,7.23,7.23,7.23,7.23,12e3,86908,7.243,20230705],[1051,7.24,7.24,7.24,7.24,14300,103543,7.243,20230705],[1052,7.24,7.24,7.24,7.24,5600,40567,7.243,20230705],[1053,7.25,7.25,7.25,7.25,8600,62349,7.243,20230705],[1054,7.24,7.24,7.24,7.24,14e3,101423,7.243,20230705],[1055,7.24,7.24,7.24,7.24,11100,80469,7.243,20230705],[1056,7.24,7.24,7.24,7.24,13900,100757,7.243,20230705],[1057,7.24,7.24,7.24,7.24,13100,94969,7.243,20230705],[1058,7.24,7.24,7.24,7.24,14200,102918,7.243,20230705],[1059,7.24,7.24,7.24,7.24,19800,143472,7.243,20230705],[1100,7.24,7.24,7.24,7.24,10600,76837,7.243,20230705],[1101,7.24,7.24,7.24,7.24,12600,91343,7.243,20230705],[1102,7.24,7.24,7.24,7.24,20400,147818,7.243,20230705],[1103,7.24,7.24,7.24,7.24,4900,35524,7.243,20230705],[1104,7.24,7.24,7.24,7.24,6700,48545,7.243,20230705],[1105,7.24,7.24,7.24,7.24,5800,42046,7.243,20230705],[1106,7.24,7.24,7.24,7.24,4400,31864,7.243,20230705],[1107,7.24,7.24,7.24,7.24,4200,30408,7.243,20230705],[1108,7.24,7.24,7.24,7.24,10900,78978,7.243,20230705],[1109,7.24,7.24,7.24,7.24,17400,126111,7.243,20230705],[1110,7.24,7.24,7.24,7.24,7200,52166,7.243,20230705],[1111,7.24,7.24,7.24,7.24,7700,55793,7.243,20230705],[1112,7.23,7.23,7.23,7.23,80200,580647,7.243,20230705],[1113,7.23,7.23,7.23,7.23,14500,105015,7.243,20230705],[1114,7.23,7.23,7.23,7.23,22200,160727,7.243,20230705],[1115,7.23,7.23,7.23,7.23,15e3,108677,7.243,20230705],[1116,7.24,7.24,7.24,7.24,14e3,101441,7.243,20230705],[1117,7.24,7.24,7.24,7.24,9700,70274,7.243,20230705],[1118,7.24,7.24,7.24,7.24,12300,89155,7.243,20230705],[1119,7.25,7.25,7.25,7.25,15700,113824,7.243,20230705],[1120,7.25,7.25,7.25,7.25,16700,121075,7.243,20230705],[1121,7.24,7.24,7.24,7.24,13200,95680,7.243,20230705],[1122,7.25,7.25,7.25,7.25,8600,62350,7.243,20230705],[1123,7.25,7.25,7.25,7.25,4700,34068,7.243,20230705],[1124,7.24,7.24,7.24,7.24,30300,219671,7.243,20230705],[1125,7.24,7.24,7.24,7.24,13700,99296,7.243,20230705],[1126,7.24,7.24,7.24,7.24,1200,8690,7.243,20230705],[1127,7.24,7.24,7.24,7.24,18400,133283,7.243,20230705],[1128,7.24,7.24,7.24,7.24,5200,37667,7.243,20230705],[1129,7.24,7.24,7.24,7.24,9200,66675,7.243,20230705],[1130,7.24,7.24,7.24,7.24,33300,241284,7.243,20230705],[1300,7.24,7.24,7.24,7.24,83100,601556,7.243,20230705],[1301,7.24,7.24,7.24,7.24,83100,601556,7.243,20230705],[1302,7.24,7.24,7.24,7.24,4700,34028,7.243,20230705],[1303,7.24,7.24,7.24,7.24,1300,9402,7.243,20230705],[1304,7.24,7.24,7.24,7.24,144100,1043394,7.243,20230705],[1305,7.24,7.24,7.24,7.24,8400,60818,7.243,20230705],[1306,7.24,7.24,7.24,7.24,17200,124527,7.243,20230705],[1307,7.23,7.23,7.23,7.23,14e3,101342,7.243,20230705],[1308,7.23,7.23,7.23,7.23,12900,93378,7.243,20230705],[1309,7.24,7.24,7.24,7.24,1300,9424,7.243,20230705],[1310,7.25,7.25,7.25,7.25,1100,7975,7.243,20230705],[1311,7.24,7.24,7.24,7.24,15300,110924,7.243,20230705],[1312,7.24,7.24,7.24,7.24,28e3,202978,7.243,20230705],[1313,7.24,7.24,7.24,7.24,29400,212961,7.243,20230705],[1314,7.24,7.24,7.24,7.24,32700,236758,7.243,20230705],[1315,7.24,7.24,7.24,7.24,18500,134092,7.243,20230705],[1316,7.23,7.23,7.23,7.23,46100,333824,7.243,20230705],[1317,7.24,7.24,7.24,7.24,2600,19121,7.243,20230705],[1318,7.23,7.23,7.23,7.23,44100,319259,7.243,20230705],[1319,7.24,7.24,7.24,7.24,14e3,101368,7.243,20230705],[1320,7.24,7.24,7.24,7.24,11e3,79647,7.243,20230705],[1321,7.23,7.23,7.23,7.23,27600,199980,7.243,20230705],[1322,7.24,7.24,7.24,7.24,11900,86149,7.243,20230705],[1323,7.24,7.24,7.24,7.24,25100,181901,7.243,20230705],[1324,7.24,7.24,7.24,7.24,13400,97135,7.243,20230705],[1325,7.24,7.24,7.24,7.24,27600,200097,7.243,20230705],[1326,7.24,7.24,7.24,7.24,42500,308154,7.243,20230705],[1327,7.24,7.24,7.24,7.24,1e4,72498,7.243,20230705],[1328,7.24,7.24,7.24,7.24,25e3,181433,7.243,20230705],[1329,7.25,7.25,7.25,7.25,15900,115401,7.243,20230705],[1330,7.25,7.25,7.25,7.25,12400,89920,7.243,20230705],[1331,7.25,7.25,7.25,7.25,19700,142912,7.244,20230705],[1332,7.25,7.25,7.25,7.25,1800,13053,7.244,20230705],[1333,7.25,7.25,7.25,7.25,9900,71808,7.244,20230705],[1334,7.25,7.25,7.25,7.25,13200,95719,7.244,20230705],[1335,7.25,7.25,7.25,7.25,27e3,195945,7.244,20230705],[1336,7.25,7.25,7.25,7.25,19e3,137844,7.244,20230705],[1337,7.25,7.25,7.25,7.25,19800,143571,7.244,20230705],[1338,7.25,7.25,7.25,7.25,81500,590921,7.244,20230705],[1339,7.25,7.25,7.25,7.25,234400,1701514,7.244,20230705],[1340,7.25,7.25,7.25,7.25,16900,122720,7.244,20230705],[1341,7.26,7.26,7.26,7.26,31500,228802,7.244,20230705],[1342,7.26,7.26,7.26,7.26,35700,259334,7.244,20230705],[1343,7.26,7.26,7.26,7.26,6e3,43610,7.244,20230705],[1344,7.26,7.26,7.26,7.26,8900,64664,7.244,20230705],[1345,7.26,7.26,7.26,7.26,25400,184439,7.245,20230705],[1346,7.25,7.25,7.25,7.25,8200,59502,7.245,20230705],[1347,7.25,7.25,7.25,7.25,15700,113920,7.245,20230705],[1348,7.25,7.25,7.25,7.25,6400,46406,7.245,20230705],[1349,7.25,7.25,7.25,7.25,21400,155339,7.245,20230705],[1350,7.25,7.25,7.25,7.25,12500,90700,7.245,20230705],[1351,7.25,7.25,7.25,7.25,14e3,101627,7.245,20230705],[1352,7.25,7.25,7.25,7.25,86300,626030,7.245,20230705],[1353,7.25,7.25,7.25,7.25,14100,102364,7.245,20230705],[1354,7.25,7.25,7.25,7.25,35900,260627,7.245,20230705],[1355,7.26,7.26,7.26,7.26,86800,630594,7.245,20230705],[1356,7.26,7.26,7.26,7.26,15e3,108922,7.245,20230705],[1357,7.25,7.25,7.25,7.25,1900,13791,7.245,20230705],[1358,7.25,7.25,7.25,7.25,8700,63140,7.245,20230705],[1359,7.25,7.25,7.25,7.25,13600,98621,7.245,20230705],[1400,7.25,7.25,7.25,7.25,13200,95829,7.245,20230705],[1401,7.25,7.25,7.25,7.25,57600,417900,7.245,20230705],[1402,7.25,7.25,7.25,7.25,17400,126305,7.245,20230705],[1403,7.25,7.25,7.25,7.25,18500,134308,7.245,20230705],[1404,7.25,7.25,7.25,7.25,26800,194621,7.245,20230705],[1405,7.25,7.25,7.25,7.25,31100,225847,7.245,20230705],[1406,7.25,7.25,7.25,7.25,85200,618598,7.246,20230705],[1407,7.26,7.26,7.26,7.26,79e3,573610,7.246,20230705],[1408,7.25,7.25,7.25,7.25,9600,69693,7.246,20230705],[1409,7.26,7.26,7.26,7.26,71800,521282,7.246,20230705],[1410,7.25,7.25,7.25,7.25,37300,270559,7.246,20230705],[1411,7.25,7.25,7.25,7.25,23500,170599,7.246,20230705],[1412,7.25,7.25,7.25,7.25,81100,588838,7.246,20230705],[1413,7.26,7.26,7.26,7.26,44200,320982,7.246,20230705],[1414,7.25,7.25,7.25,7.25,36800,267271,7.246,20230705],[1415,7.26,7.26,7.26,7.26,48700,353688,7.246,20230705],[1416,7.25,7.25,7.25,7.25,7200,52279,7.246,20230705],[1417,7.25,7.25,7.25,7.25,19800,143768,7.246,20230705],[1418,7.25,7.25,7.25,7.25,22300,161974,7.246,20230705],[1419,7.25,7.25,7.25,7.25,54700,396928,7.246,20230705],[1420,7.25,7.25,7.25,7.25,100100,726016,7.247,20230705],[1421,7.25,7.25,7.25,7.25,59500,431741,7.247,20230705],[1422,7.25,7.25,7.25,7.25,54200,393335,7.247,20230705],[1423,7.25,7.25,7.25,7.25,1100,8294,7.247,20230705],[1424,7.25,7.25,7.25,7.25,23600,171297,7.247,20230705],[1425,7.25,7.25,7.25,7.25,122600,890088,7.247,20230705],[1426,7.25,7.25,7.25,7.25,7e3,50771,7.247,20230705],[1427,7.25,7.25,7.25,7.25,12e3,87097,7.247,20230705],[1428,7.25,7.25,7.25,7.25,41800,303281,7.247,20230705],[1429,7.25,7.25,7.25,7.25,24200,175658,7.247,20230705],[1430,7.25,7.25,7.25,7.25,23400,169845,7.247,20230705],[1431,7.25,7.25,7.25,7.25,87200,633494,7.247,20230705],[1432,7.25,7.25,7.25,7.25,48400,351563,7.247,20230705],[1433,7.25,7.25,7.25,7.25,15100,109619,7.247,20230705],[1434,7.25,7.25,7.25,7.25,24400,177067,7.247,20230705],[1435,7.25,7.25,7.25,7.25,59200,429440,7.247,20230705],[1436,7.25,7.25,7.25,7.25,59500,431845,7.247,20230705],[1437,7.25,7.25,7.25,7.25,108400,786277,7.247,20230705],[1438,7.25,7.25,7.25,7.25,51600,374482,7.247,20230705],[1439,7.25,7.25,7.25,7.25,58200,422219,7.248,20230705],[1440,7.24,7.24,7.24,7.24,449300,3254149,7.247,20230705],[1441,7.24,7.24,7.24,7.24,44e3,318916,7.247,20230705],[1442,7.24,7.24,7.24,7.24,14900,108060,7.247,20230705],[1443,7.24,7.24,7.24,7.24,72e3,521478,7.247,20230705],[1444,7.24,7.24,7.24,7.24,19e3,137643,7.247,20230705],[1445,7.24,7.24,7.24,7.24,82800,600268,7.247,20230705],[1446,7.24,7.24,7.24,7.24,52200,378604,7.247,20230705],[1447,7.24,7.24,7.24,7.24,29300,212142,7.247,20230705],[1448,7.24,7.24,7.24,7.24,14900,108105,7.247,20230705],[1449,7.24,7.24,7.24,7.24,60400,438060,7.247,20230705],[1450,7.25,7.25,7.25,7.25,24e3,174158,7.247,20230705],[1451,7.25,7.25,7.25,7.25,32400,235032,7.247,20230705],[1452,7.24,7.24,7.24,7.24,102300,741636,7.247,20230705],[1453,7.24,7.24,7.24,7.24,72600,526358,7.247,20230705],[1454,7.25,7.25,7.25,7.25,2e4,145084,7.247,20230705],[1455,7.24,7.24,7.24,7.24,74e3,536269,7.247,20230705],[1456,7.25,7.25,7.25,7.25,90300,654864,7.248,20230705],[1457,7.24,7.24,7.24,7.24,32500,235520,7.247,20230705],[1458,7.24,7.24,7.24,7.24,21200,153488,7.247,20230705],[1459,7.24,7.24,7.24,7.24,0,0,7.247,20230705],[1500,7.25,7.25,7.25,7.25,231900,1681137,7.248,20230705]],date:20230705,yclose:7.18},{minute:[[925,7.3,7.3,7.3,7.3,86500,631450,7.3,20230704],[930,7.3,7.3,7.3,7.3,86500,631450,7.3,20230704],[931,7.29,7.29,7.29,7.29,254800,1858930,7.297,20230704],[932,7.3,7.3,7.3,7.3,119200,871431,7.3,20230704],[933,7.29,7.29,7.29,7.29,84600,617344,7.3,20230704],[934,7.29,7.29,7.29,7.29,155e3,1130713,7.299,20230704],[935,7.29,7.29,7.29,7.29,184600,1346782,7.298,20230704],[936,7.28,7.28,7.28,7.28,376600,2745504,7.296,20230704],[937,7.28,7.28,7.28,7.28,154100,1122549,7.295,20230704],[938,7.28,7.28,7.28,7.28,200500,1460433,7.293,20230704],[939,7.28,7.28,7.28,7.28,144100,1049578,7.293,20230704],[940,7.28,7.28,7.28,7.28,133400,971626,7.292,20230704],[941,7.28,7.28,7.28,7.28,136800,996543,7.291,20230704],[942,7.28,7.28,7.28,7.28,147700,1076304,7.291,20230704],[943,7.28,7.28,7.28,7.28,177400,1292819,7.291,20230704],[944,7.28,7.28,7.28,7.28,234600,1709667,7.291,20230704],[945,7.28,7.28,7.28,7.28,262600,1913473,7.29,20230704],[946,7.28,7.28,7.28,7.28,142200,1035687,7.29,20230704],[947,7.28,7.28,7.28,7.28,275e3,2003684,7.29,20230704],[948,7.28,7.28,7.28,7.28,170300,1240858,7.289,20230704],[949,7.29,7.29,7.29,7.29,101e3,736295,7.289,20230704],[950,7.28,7.28,7.28,7.28,190400,1386528,7.289,20230704],[951,7.27,7.27,7.27,7.27,331800,2415453,7.288,20230704],[952,7.27,7.27,7.27,7.27,139300,1014019,7.288,20230704],[953,7.27,7.27,7.27,7.27,107300,780855,7.288,20230704],[954,7.27,7.27,7.27,7.27,88800,646047,7.288,20230704],[955,7.28,7.28,7.28,7.28,105300,766102,7.287,20230704],[956,7.27,7.27,7.27,7.27,111900,813964,7.287,20230704],[957,7.27,7.27,7.27,7.27,97900,711944,7.287,20230704],[958,7.27,7.27,7.27,7.27,126900,924038,7.286,20230704],[959,7.28,7.28,7.28,7.28,135400,986272,7.286,20230704],[1e3,7.27,7.27,7.27,7.27,164400,1197360,7.286,20230704],[1001,7.27,7.27,7.27,7.27,120600,877791,7.286,20230704],[1002,7.27,7.27,7.27,7.27,115700,841731,7.286,20230704],[1003,7.27,7.27,7.27,7.27,86400,628203,7.286,20230704],[1004,7.27,7.27,7.27,7.27,93600,680622,7.285,20230704],[1005,7.27,7.27,7.27,7.27,121300,882199,7.285,20230704],[1006,7.26,7.26,7.26,7.26,461200,3353137,7.284,20230704],[1007,7.26,7.26,7.26,7.26,114100,828510,7.284,20230704],[1008,7.26,7.26,7.26,7.26,165200,1199640,7.283,20230704],[1009,7.26,7.26,7.26,7.26,144600,1050306,7.283,20230704],[1010,7.26,7.26,7.26,7.26,202700,1471755,7.282,20230704],[1011,7.25,7.25,7.25,7.25,89900,652536,7.282,20230704],[1012,7.26,7.26,7.26,7.26,130700,949130,7.281,20230704],[1013,7.26,7.26,7.26,7.26,88300,641094,7.281,20230704],[1014,7.26,7.26,7.26,7.26,94e3,682579,7.281,20230704],[1015,7.26,7.26,7.26,7.26,104800,760959,7.281,20230704],[1016,7.26,7.26,7.26,7.26,200600,1456506,7.28,20230704],[1017,7.25,7.25,7.25,7.25,117800,854333,7.28,20230704],[1018,7.25,7.25,7.25,7.25,96400,699392,7.279,20230704],[1019,7.25,7.25,7.25,7.25,91100,660997,7.279,20230704],[1020,7.26,7.26,7.26,7.26,29700,215713,7.279,20230704],[1021,7.26,7.26,7.26,7.26,6700,48703,7.279,20230704],[1022,7.26,7.26,7.26,7.26,92500,672445,7.279,20230704],[1023,7.26,7.26,7.26,7.26,13200,95921,7.279,20230704],[1024,7.26,7.26,7.26,7.26,5900,42909,7.279,20230704],[1025,7.27,7.27,7.27,7.27,4700,34211,7.279,20230704],[1026,7.27,7.27,7.27,7.27,22600,164407,7.279,20230704],[1027,7.27,7.27,7.27,7.27,5800,42202,7.279,20230704],[1028,7.27,7.27,7.27,7.27,10200,74200,7.279,20230704],[1029,7.27,7.27,7.27,7.27,12200,88724,7.279,20230704],[1030,7.26,7.26,7.26,7.26,254200,1848023,7.278,20230704],[1031,7.26,7.26,7.26,7.26,31200,226765,7.278,20230704],[1032,7.26,7.26,7.26,7.26,9800,71206,7.278,20230704],[1033,7.26,7.26,7.26,7.26,25900,188443,7.278,20230704],[1034,7.26,7.26,7.26,7.26,33e3,239864,7.278,20230704],[1035,7.26,7.26,7.26,7.26,45900,333389,7.278,20230704],[1036,7.26,7.26,7.26,7.26,234700,1704005,7.278,20230704],[1037,7.25,7.25,7.25,7.25,179600,1302684,7.277,20230704],[1038,7.25,7.25,7.25,7.25,125700,911444,7.277,20230704],[1039,7.25,7.25,7.25,7.25,153100,1109999,7.276,20230704],[1040,7.25,7.25,7.25,7.25,156900,1137659,7.276,20230704],[1041,7.24,7.24,7.24,7.24,552400,4004183,7.274,20230704],[1042,7.24,7.24,7.24,7.24,141900,1027437,7.274,20230704],[1043,7.23,7.23,7.23,7.23,346800,2510875,7.273,20230704],[1044,7.23,7.23,7.23,7.23,17e4,1229907,7.272,20230704],[1045,7.24,7.24,7.24,7.24,87900,636719,7.272,20230704],[1046,7.24,7.24,7.24,7.24,1900,13774,7.272,20230704],[1047,7.24,7.24,7.24,7.24,36300,263146,7.272,20230704],[1048,7.25,7.25,7.25,7.25,29500,213936,7.272,20230704],[1049,7.26,7.26,7.26,7.26,31600,229456,7.272,20230704],[1050,7.26,7.26,7.26,7.26,9600,69785,7.272,20230704],[1051,7.26,7.26,7.26,7.26,47500,345118,7.272,20230704],[1052,7.26,7.26,7.26,7.26,58600,425446,7.272,20230704],[1053,7.26,7.26,7.26,7.26,301500,2188958,7.271,20230704],[1054,7.26,7.26,7.26,7.26,94500,686170,7.271,20230704],[1055,7.26,7.26,7.26,7.26,8e3,58100,7.271,20230704],[1056,7.26,7.26,7.26,7.26,66e3,478944,7.271,20230704],[1057,7.25,7.25,7.25,7.25,18900,137181,7.271,20230704],[1058,7.25,7.25,7.25,7.25,24300,176268,7.271,20230704],[1059,7.25,7.25,7.25,7.25,15400,111768,7.271,20230704],[1100,7.25,7.25,7.25,7.25,4300,31176,7.271,20230704],[1101,7.25,7.25,7.25,7.25,38900,282393,7.271,20230704],[1102,7.25,7.25,7.25,7.25,25100,182194,7.271,20230704],[1103,7.25,7.25,7.25,7.25,14200,103029,7.271,20230704],[1104,7.26,7.26,7.26,7.26,61300,444963,7.271,20230704],[1105,7.25,7.25,7.25,7.25,13300,96557,7.271,20230704],[1106,7.25,7.25,7.25,7.25,25500,185054,7.271,20230704],[1107,7.26,7.26,7.26,7.26,13800,100188,7.271,20230704],[1108,7.25,7.25,7.25,7.25,26900,195282,7.271,20230704],[1109,7.25,7.25,7.25,7.25,33200,241003,7.271,20230704],[1110,7.25,7.25,7.25,7.25,20200,146667,7.271,20230704],[1111,7.26,7.26,7.26,7.26,27900,202572,7.271,20230704],[1112,7.27,7.27,7.27,7.27,6e3,43606,7.271,20230704],[1113,7.26,7.26,7.26,7.26,13200,95882,7.271,20230704],[1114,7.26,7.26,7.26,7.26,18200,132292,7.271,20230704],[1115,7.26,7.26,7.26,7.26,20100,146099,7.271,20230704],[1116,7.27,7.27,7.27,7.27,7500,54525,7.271,20230704],[1117,7.26,7.26,7.26,7.26,16e3,116302,7.271,20230704],[1118,7.26,7.26,7.26,7.26,179400,1304343,7.271,20230704],[1119,7.27,7.27,7.27,7.27,3e4,218108,7.271,20230704],[1120,7.26,7.26,7.26,7.26,45e3,326866,7.271,20230704],[1121,7.27,7.27,7.27,7.27,5100,37078,7.271,20230704],[1122,7.26,7.26,7.26,7.26,4100,29799,7.271,20230704],[1123,7.26,7.26,7.26,7.26,9600,69738,7.271,20230704],[1124,7.26,7.26,7.26,7.26,20300,147530,7.271,20230704],[1125,7.26,7.26,7.26,7.26,20800,151156,7.271,20230704],[1126,7.26,7.26,7.26,7.26,20800,151213,7.271,20230704],[1127,7.26,7.26,7.26,7.26,7900,57426,7.271,20230704],[1128,7.26,7.26,7.26,7.26,23600,171537,7.271,20230704],[1129,7.26,7.26,7.26,7.26,20300,147446,7.271,20230704],[1130,7.26,7.26,7.26,7.26,21700,157737,7.271,20230704],[1300,7.26,7.26,7.26,7.26,302700,2200588,7.271,20230704],[1301,7.26,7.26,7.26,7.26,302700,2200588,7.271,20230704],[1302,7.26,7.26,7.26,7.26,45500,330532,7.271,20230704],[1303,7.25,7.25,7.25,7.25,84700,614894,7.271,20230704],[1304,7.26,7.26,7.26,7.26,28300,205507,7.271,20230704],[1305,7.26,7.26,7.26,7.26,9300,67562,7.271,20230704],[1306,7.25,7.25,7.25,7.25,53e3,384776,7.271,20230704],[1307,7.26,7.26,7.26,7.26,48200,349967,7.271,20230704],[1308,7.25,7.25,7.25,7.25,22200,161152,7.27,20230704],[1309,7.25,7.25,7.25,7.25,7400,53679,7.27,20230704],[1310,7.25,7.25,7.25,7.25,12800,92836,7.27,20230704],[1311,7.25,7.25,7.25,7.25,8900,64560,7.27,20230704],[1312,7.25,7.25,7.25,7.25,16100,116816,7.27,20230704],[1313,7.25,7.25,7.25,7.25,10200,74048,7.27,20230704],[1314,7.25,7.25,7.25,7.25,13500,97948,7.27,20230704],[1315,7.25,7.25,7.25,7.25,5400,39202,7.27,20230704],[1316,7.25,7.25,7.25,7.25,7e3,50808,7.27,20230704],[1317,7.25,7.25,7.25,7.25,89900,652528,7.27,20230704],[1318,7.26,7.26,7.26,7.26,81300,591030,7.27,20230704],[1319,7.26,7.26,7.26,7.26,600,4669,7.27,20230704],[1320,7.26,7.26,7.26,7.26,7600,55223,7.27,20230704],[1321,7.26,7.26,7.26,7.26,16e3,116317,7.27,20230704],[1322,7.26,7.26,7.26,7.26,10200,74102,7.27,20230704],[1323,7.26,7.26,7.26,7.26,4700,34133,7.27,20230704],[1324,7.25,7.25,7.25,7.25,368e3,2668851,7.27,20230704],[1325,7.26,7.26,7.26,7.26,7600,55193,7.27,20230704],[1326,7.26,7.26,7.26,7.26,34600,251195,7.27,20230704],[1327,7.26,7.26,7.26,7.26,27100,196875,7.27,20230704],[1328,7.25,7.25,7.25,7.25,28800,209083,7.27,20230704],[1329,7.26,7.26,7.26,7.26,13100,95123,7.27,20230704],[1330,7.25,7.25,7.25,7.25,31900,231618,7.27,20230704],[1331,7.25,7.25,7.25,7.25,17900,129880,7.27,20230704],[1332,7.25,7.25,7.25,7.25,72300,524851,7.27,20230704],[1333,7.25,7.25,7.25,7.25,12300,89297,7.27,20230704],[1334,7.25,7.25,7.25,7.25,8600,62428,7.27,20230704],[1335,7.25,7.25,7.25,7.25,12400,90018,7.27,20230704],[1336,7.25,7.25,7.25,7.25,15600,113237,7.27,20230704],[1337,7.25,7.25,7.25,7.25,8400,60929,7.27,20230704],[1338,7.25,7.25,7.25,7.25,16e3,116059,7.27,20230704],[1339,7.25,7.25,7.25,7.25,22800,165328,7.27,20230704],[1340,7.25,7.25,7.25,7.25,88600,643199,7.27,20230704],[1341,7.25,7.25,7.25,7.25,19900,144449,7.269,20230704],[1342,7.25,7.25,7.25,7.25,7600,55175,7.269,20230704],[1343,7.25,7.25,7.25,7.25,11700,84921,7.269,20230704],[1344,7.25,7.25,7.25,7.25,21200,153761,7.269,20230704],[1345,7.25,7.25,7.25,7.25,23900,173393,7.269,20230704],[1346,7.25,7.25,7.25,7.25,13700,99460,7.269,20230704],[1347,7.26,7.26,7.26,7.26,58700,426167,7.269,20230704],[1348,7.26,7.26,7.26,7.26,9100,66066,7.269,20230704],[1349,7.26,7.26,7.26,7.26,49600,360111,7.269,20230704],[1350,7.25,7.25,7.25,7.25,37300,270730,7.269,20230704],[1351,7.25,7.25,7.25,7.25,6200,45007,7.269,20230704],[1352,7.25,7.25,7.25,7.25,14900,108146,7.269,20230704],[1353,7.25,7.25,7.25,7.25,12600,91424,7.269,20230704],[1354,7.25,7.25,7.25,7.25,93200,675891,7.269,20230704],[1355,7.25,7.25,7.25,7.25,13800,100143,7.269,20230704],[1356,7.25,7.25,7.25,7.25,19100,138641,7.269,20230704],[1357,7.25,7.25,7.25,7.25,19100,138341,7.269,20230704],[1358,7.25,7.25,7.25,7.25,15400,111700,7.269,20230704],[1359,7.25,7.25,7.25,7.25,15500,112427,7.269,20230704],[1400,7.25,7.25,7.25,7.25,29600,214556,7.269,20230704],[1401,7.25,7.25,7.25,7.25,6200,44970,7.269,20230704],[1402,7.26,7.26,7.26,7.26,15e3,108900,7.269,20230704],[1403,7.25,7.25,7.25,7.25,117400,851242,7.269,20230704],[1404,7.25,7.25,7.25,7.25,13700,99434,7.269,20230704],[1405,7.25,7.25,7.25,7.25,12700,92189,7.269,20230704],[1406,7.26,7.26,7.26,7.26,8800,63888,7.269,20230704],[1407,7.26,7.26,7.26,7.26,107400,779966,7.269,20230704],[1408,7.26,7.26,7.26,7.26,21300,154758,7.269,20230704],[1409,7.26,7.26,7.26,7.26,16e3,116165,7.269,20230704],[1410,7.26,7.26,7.26,7.26,51200,371821,7.269,20230704],[1411,7.26,7.26,7.26,7.26,24200,175694,7.269,20230704],[1412,7.26,7.26,7.26,7.26,34100,247712,7.269,20230704],[1413,7.26,7.26,7.26,7.26,23e3,167201,7.269,20230704],[1414,7.26,7.26,7.26,7.26,24100,175044,7.269,20230704],[1415,7.26,7.26,7.26,7.26,35800,259957,7.269,20230704],[1416,7.26,7.26,7.26,7.26,41100,298796,7.269,20230704],[1417,7.26,7.26,7.26,7.26,5e4,363495,7.269,20230704],[1418,7.27,7.27,7.27,7.27,92300,671254,7.269,20230704],[1419,7.27,7.27,7.27,7.27,32600,237249,7.269,20230704],[1420,7.27,7.27,7.27,7.27,24900,181158,7.269,20230704],[1421,7.27,7.27,7.27,7.27,129300,940286,7.269,20230704],[1422,7.27,7.27,7.27,7.27,16400,119350,7.269,20230704],[1423,7.28,7.28,7.28,7.28,21e3,152875,7.269,20230704],[1424,7.26,7.26,7.26,7.26,65500,476106,7.269,20230704],[1425,7.27,7.27,7.27,7.27,93500,680607,7.269,20230704],[1426,7.27,7.27,7.27,7.27,12600,91627,7.269,20230704],[1427,7.27,7.27,7.27,7.27,15300,111340,7.269,20230704],[1428,7.27,7.27,7.27,7.27,14300,104092,7.269,20230704],[1429,7.27,7.27,7.27,7.27,36e3,262005,7.269,20230704],[1430,7.27,7.27,7.27,7.27,29300,213196,7.269,20230704],[1431,7.27,7.27,7.27,7.27,11400,82927,7.269,20230704],[1432,7.27,7.27,7.27,7.27,7e3,50951,7.269,20230704],[1433,7.28,7.28,7.28,7.28,10700,77896,7.269,20230704],[1434,7.27,7.27,7.27,7.27,46700,339965,7.269,20230704],[1435,7.27,7.27,7.27,7.27,24400,177560,7.269,20230704],[1436,7.27,7.27,7.27,7.27,1100,8003,7.269,20230704],[1437,7.27,7.27,7.27,7.27,64900,472470,7.269,20230704],[1438,7.27,7.27,7.27,7.27,17400,126661,7.269,20230704],[1439,7.27,7.27,7.27,7.27,33300,242328,7.269,20230704],[1440,7.27,7.27,7.27,7.27,224400,1633562,7.269,20230704],[1441,7.28,7.28,7.28,7.28,204800,1491408,7.269,20230704],[1442,7.27,7.27,7.27,7.27,41700,303628,7.269,20230704],[1443,7.28,7.28,7.28,7.28,26500,192958,7.269,20230704],[1444,7.28,7.28,7.28,7.28,20900,152206,7.269,20230704],[1445,7.28,7.28,7.28,7.28,49600,361099,7.27,20230704],[1446,7.28,7.28,7.28,7.28,8900,64818,7.27,20230704],[1447,7.28,7.28,7.28,7.28,46400,338138,7.27,20230704],[1448,7.28,7.28,7.28,7.28,26500,193161,7.27,20230704],[1449,7.28,7.28,7.28,7.28,25800,188008,7.27,20230704],[1450,7.28,7.28,7.28,7.28,59e3,429926,7.27,20230704],[1451,7.27,7.27,7.27,7.27,98200,714737,7.27,20230704],[1452,7.27,7.27,7.27,7.27,31500,229303,7.27,20230704],[1453,7.27,7.27,7.27,7.27,56200,408966,7.27,20230704],[1454,7.27,7.27,7.27,7.27,259e3,1883109,7.27,20230704],[1455,7.27,7.27,7.27,7.27,133800,972744,7.27,20230704],[1456,7.26,7.26,7.26,7.26,45700,332309,7.27,20230704],[1457,7.27,7.27,7.27,7.27,109100,793412,7.27,20230704],[1458,7.27,7.27,7.27,7.27,4400,31988,7.27,20230704],[1459,7.27,7.27,7.27,7.27,0,0,7.27,20230704],[1500,7.28,7.28,7.28,7.28,339700,2473016,7.27,20230704]],date:20230704,yclose:7.2},{minute:[[925,7.25,7.25,7.25,7.25,42300,306682,7.25,20230703],[930,7.25,7.25,7.25,7.25,42300,306682,7.25,20230703],[931,7.25,7.25,7.25,7.25,281900,2047598,7.262,20230703],[932,7.26,7.26,7.26,7.26,204e3,1482637,7.264,20230703],[933,7.25,7.25,7.25,7.25,95400,692691,7.264,20230703],[934,7.25,7.25,7.25,7.25,80900,587030,7.263,20230703],[935,7.25,7.25,7.25,7.25,117700,854657,7.263,20230703],[936,7.27,7.27,7.27,7.27,205300,1492925,7.264,20230703],[937,7.27,7.27,7.27,7.27,667500,4858990,7.27,20230703],[938,7.28,7.28,7.28,7.28,324700,2367328,7.274,20230703],[939,7.27,7.27,7.27,7.27,234600,1707964,7.274,20230703],[940,7.27,7.27,7.27,7.27,87e3,632895,7.274,20230703],[941,7.27,7.27,7.27,7.27,144500,1051954,7.275,20230703],[942,7.27,7.27,7.27,7.27,100400,730911,7.275,20230703],[943,7.28,7.28,7.28,7.28,212400,1547187,7.276,20230703],[944,7.27,7.27,7.27,7.27,108600,790710,7.276,20230703],[945,7.27,7.27,7.27,7.27,198600,1446546,7.276,20230703],[946,7.27,7.27,7.27,7.27,94300,686446,7.276,20230703],[947,7.27,7.27,7.27,7.27,201300,1464318,7.276,20230703],[948,7.27,7.27,7.27,7.27,96300,700487,7.276,20230703],[949,7.27,7.27,7.27,7.27,51e3,370937,7.276,20230703],[950,7.27,7.27,7.27,7.27,184900,1345309,7.276,20230703],[951,7.25,7.25,7.25,7.25,535100,3887071,7.275,20230703],[952,7.26,7.26,7.26,7.26,77800,565608,7.275,20230703],[953,7.26,7.26,7.26,7.26,70200,510357,7.275,20230703],[954,7.26,7.26,7.26,7.26,94300,685829,7.275,20230703],[955,7.26,7.26,7.26,7.26,53900,391985,7.274,20230703],[956,7.26,7.26,7.26,7.26,62100,451377,7.274,20230703],[957,7.26,7.26,7.26,7.26,44300,321804,7.274,20230703],[958,7.25,7.25,7.25,7.25,357200,2594561,7.273,20230703],[959,7.25,7.25,7.25,7.25,93400,678095,7.273,20230703],[1e3,7.25,7.25,7.25,7.25,248e3,1799419,7.272,20230703],[1001,7.27,7.27,7.27,7.27,145500,1058187,7.272,20230703],[1002,7.26,7.26,7.26,7.26,149100,1084909,7.273,20230703],[1003,7.26,7.26,7.26,7.26,44600,324216,7.273,20230703],[1004,7.27,7.27,7.27,7.27,47e3,341742,7.273,20230703],[1005,7.26,7.26,7.26,7.26,40900,297319,7.272,20230703],[1006,7.26,7.26,7.26,7.26,32800,238449,7.272,20230703],[1007,7.26,7.26,7.26,7.26,42900,311789,7.272,20230703],[1008,7.26,7.26,7.26,7.26,84700,615812,7.272,20230703],[1009,7.26,7.26,7.26,7.26,34900,253572,7.272,20230703],[1010,7.26,7.26,7.26,7.26,58e3,421574,7.272,20230703],[1011,7.26,7.26,7.26,7.26,82200,597757,7.272,20230703],[1012,7.27,7.27,7.27,7.27,38400,279279,7.272,20230703],[1013,7.26,7.26,7.26,7.26,74800,544122,7.272,20230703],[1014,7.27,7.27,7.27,7.27,404200,2942491,7.273,20230703],[1015,7.28,7.28,7.28,7.28,47600,346854,7.273,20230703],[1016,7.28,7.28,7.28,7.28,22e3,160289,7.273,20230703],[1017,7.27,7.27,7.27,7.27,127700,929404,7.273,20230703],[1018,7.26,7.26,7.26,7.26,278e3,2022768,7.273,20230703],[1019,7.27,7.27,7.27,7.27,11600,84417,7.273,20230703],[1020,7.27,7.27,7.27,7.27,64700,470664,7.273,20230703],[1021,7.27,7.27,7.27,7.27,23300,169430,7.273,20230703],[1022,7.27,7.27,7.27,7.27,33800,245957,7.273,20230703],[1023,7.27,7.27,7.27,7.27,28400,206733,7.273,20230703],[1024,7.27,7.27,7.27,7.27,146900,1068140,7.273,20230703],[1025,7.27,7.27,7.27,7.27,66100,481063,7.273,20230703],[1026,7.27,7.27,7.27,7.27,74600,543332,7.273,20230703],[1027,7.27,7.27,7.27,7.27,81400,593028,7.273,20230703],[1028,7.27,7.27,7.27,7.27,50900,370503,7.274,20230703],[1029,7.27,7.27,7.27,7.27,35500,258438,7.274,20230703],[1030,7.27,7.27,7.27,7.27,34600,251904,7.274,20230703],[1031,7.27,7.27,7.27,7.27,20900,152175,7.274,20230703],[1032,7.27,7.27,7.27,7.27,45500,331264,7.274,20230703],[1033,7.28,7.28,7.28,7.28,37800,275325,7.274,20230703],[1034,7.27,7.27,7.27,7.27,56400,410538,7.274,20230703],[1035,7.27,7.27,7.27,7.27,10700,77885,7.274,20230703],[1036,7.27,7.27,7.27,7.27,12800,93183,7.274,20230703],[1037,7.27,7.27,7.27,7.27,51700,375892,7.274,20230703],[1038,7.27,7.27,7.27,7.27,33600,244543,7.274,20230703],[1039,7.27,7.27,7.27,7.27,95e3,691661,7.274,20230703],[1040,7.27,7.27,7.27,7.27,77200,562006,7.274,20230703],[1041,7.28,7.28,7.28,7.28,47200,343770,7.274,20230703],[1042,7.28,7.28,7.28,7.28,6300,45873,7.274,20230703],[1043,7.28,7.28,7.28,7.28,5100,37159,7.274,20230703],[1044,7.28,7.28,7.28,7.28,8700,63422,7.274,20230703],[1045,7.28,7.28,7.28,7.28,19200,139935,7.274,20230703],[1046,7.28,7.28,7.28,7.28,23400,170508,7.274,20230703],[1047,7.28,7.28,7.28,7.28,35100,255811,7.274,20230703],[1048,7.28,7.28,7.28,7.28,8500,61939,7.274,20230703],[1049,7.28,7.28,7.28,7.28,69600,507141,7.274,20230703],[1050,7.28,7.28,7.28,7.28,52200,380188,7.274,20230703],[1051,7.29,7.29,7.29,7.29,42e3,306031,7.274,20230703],[1052,7.28,7.28,7.28,7.28,28e3,203863,7.274,20230703],[1053,7.28,7.28,7.28,7.28,114100,830680,7.274,20230703],[1054,7.28,7.28,7.28,7.28,22100,160954,7.274,20230703],[1055,7.28,7.28,7.28,7.28,25800,187868,7.275,20230703],[1056,7.28,7.28,7.28,7.28,13e3,94656,7.275,20230703],[1057,7.28,7.28,7.28,7.28,42400,308890,7.275,20230703],[1058,7.28,7.28,7.28,7.28,18700,136552,7.275,20230703],[1059,7.28,7.28,7.28,7.28,13500,98327,7.275,20230703],[1100,7.28,7.28,7.28,7.28,16900,123144,7.275,20230703],[1101,7.28,7.28,7.28,7.28,5300,38618,7.275,20230703],[1102,7.28,7.28,7.28,7.28,165400,1204125,7.275,20230703],[1103,7.27,7.27,7.27,7.27,281600,2049670,7.275,20230703],[1104,7.28,7.28,7.28,7.28,14e3,101919,7.275,20230703],[1105,7.27,7.27,7.27,7.27,133100,967666,7.275,20230703],[1106,7.26,7.26,7.26,7.26,188500,1370406,7.275,20230703],[1107,7.26,7.26,7.26,7.26,130200,946004,7.275,20230703],[1108,7.27,7.27,7.27,7.27,171300,1245543,7.275,20230703],[1109,7.27,7.27,7.27,7.27,200900,1460676,7.274,20230703],[1110,7.27,7.27,7.27,7.27,287200,2090369,7.275,20230703],[1111,7.27,7.27,7.27,7.27,117900,857420,7.275,20230703],[1112,7.27,7.27,7.27,7.27,228700,1663784,7.275,20230703],[1113,7.27,7.27,7.27,7.27,115700,841167,7.275,20230703],[1114,7.27,7.27,7.27,7.27,150200,1092286,7.274,20230703],[1115,7.27,7.27,7.27,7.27,61600,448323,7.274,20230703],[1116,7.28,7.28,7.28,7.28,17800,129587,7.275,20230703],[1117,7.27,7.27,7.27,7.27,17100,124370,7.275,20230703],[1118,7.27,7.27,7.27,7.27,17800,129475,7.275,20230703],[1119,7.27,7.27,7.27,7.27,30200,219807,7.275,20230703],[1120,7.28,7.28,7.28,7.28,18200,132581,7.275,20230703],[1121,7.28,7.28,7.28,7.28,9800,71441,7.275,20230703],[1122,7.27,7.27,7.27,7.27,67300,489871,7.275,20230703],[1123,7.27,7.27,7.27,7.27,15400,112064,7.275,20230703],[1124,7.27,7.27,7.27,7.27,147100,1070783,7.275,20230703],[1125,7.27,7.27,7.27,7.27,48800,355153,7.275,20230703],[1126,7.27,7.27,7.27,7.27,45400,330332,7.275,20230703],[1127,7.28,7.28,7.28,7.28,359700,2618814,7.275,20230703],[1128,7.28,7.28,7.28,7.28,85100,620377,7.275,20230703],[1129,7.28,7.28,7.28,7.28,125200,912587,7.275,20230703],[1130,7.29,7.29,7.29,7.29,124500,907603,7.275,20230703],[1300,7.29,7.29,7.29,7.29,355800,2596831,7.276,20230703],[1301,7.29,7.29,7.29,7.29,355800,2596831,7.276,20230703],[1302,7.29,7.29,7.29,7.29,74800,545509,7.276,20230703],[1303,7.29,7.29,7.29,7.29,265600,1936651,7.276,20230703],[1304,7.28,7.28,7.28,7.28,43400,316258,7.276,20230703],[1305,7.28,7.28,7.28,7.28,14800,107897,7.276,20230703],[1306,7.29,7.29,7.29,7.29,62300,454669,7.276,20230703],[1307,7.29,7.29,7.29,7.29,61300,447361,7.277,20230703],[1308,7.29,7.29,7.29,7.29,16500,120319,7.277,20230703],[1309,7.29,7.29,7.29,7.29,56600,412946,7.277,20230703],[1310,7.29,7.29,7.29,7.29,22600,164925,7.277,20230703],[1311,7.29,7.29,7.29,7.29,1e4,72950,7.277,20230703],[1312,7.29,7.29,7.29,7.29,999900,7305534,7.279,20230703],[1313,7.31,7.31,7.31,7.31,38300,280002,7.279,20230703],[1314,7.3,7.3,7.3,7.3,36100,263779,7.279,20230703],[1315,7.3,7.3,7.3,7.3,112700,824079,7.279,20230703],[1316,7.3,7.3,7.3,7.3,16200,118368,7.279,20230703],[1317,7.3,7.3,7.3,7.3,18600,135797,7.279,20230703],[1318,7.3,7.3,7.3,7.3,92500,676218,7.279,20230703],[1319,7.31,7.31,7.31,7.31,10400,76071,7.28,20230703],[1320,7.31,7.31,7.31,7.31,44400,324678,7.28,20230703],[1321,7.31,7.31,7.31,7.31,53400,390761,7.28,20230703],[1322,7.31,7.31,7.31,7.31,304500,2226059,7.28,20230703],[1323,7.3,7.3,7.3,7.3,38900,284250,7.28,20230703],[1324,7.3,7.3,7.3,7.3,38300,279826,7.281,20230703],[1325,7.3,7.3,7.3,7.3,15400,112493,7.281,20230703],[1326,7.3,7.3,7.3,7.3,8900,65028,7.281,20230703],[1327,7.3,7.3,7.3,7.3,67600,493804,7.281,20230703],[1328,7.3,7.3,7.3,7.3,65400,478063,7.281,20230703],[1329,7.31,7.31,7.31,7.31,2200,16082,7.281,20230703],[1330,7.3,7.3,7.3,7.3,23300,170279,7.281,20230703],[1331,7.31,7.31,7.31,7.31,15400,112564,7.281,20230703],[1332,7.31,7.31,7.31,7.31,163100,1192474,7.281,20230703],[1333,7.31,7.31,7.31,7.31,27200,199050,7.281,20230703],[1334,7.31,7.31,7.31,7.31,8300,60702,7.281,20230703],[1335,7.31,7.31,7.31,7.31,450800,3299813,7.282,20230703],[1336,7.31,7.31,7.31,7.31,141800,1037947,7.283,20230703],[1337,7.32,7.32,7.32,7.32,45900,336009,7.283,20230703],[1338,7.32,7.32,7.32,7.32,7300,53436,7.283,20230703],[1339,7.31,7.31,7.31,7.31,23400,171235,7.283,20230703],[1340,7.31,7.31,7.31,7.31,17200,125818,7.283,20230703],[1341,7.31,7.31,7.31,7.31,10100,73905,7.283,20230703],[1342,7.31,7.31,7.31,7.31,32100,234819,7.283,20230703],[1343,7.31,7.31,7.31,7.31,141800,1037897,7.283,20230703],[1344,7.33,7.33,7.33,7.33,23500,172255,7.283,20230703],[1345,7.32,7.32,7.32,7.32,16e3,117155,7.283,20230703],[1346,7.31,7.31,7.31,7.31,120900,885003,7.284,20230703],[1347,7.31,7.31,7.31,7.31,14900,109011,7.284,20230703],[1348,7.31,7.31,7.31,7.31,23200,169740,7.284,20230703],[1349,7.31,7.31,7.31,7.31,12900,94394,7.284,20230703],[1350,7.31,7.31,7.31,7.31,19e3,139045,7.284,20230703],[1351,7.31,7.31,7.31,7.31,36600,267905,7.284,20230703],[1352,7.31,7.31,7.31,7.31,313100,2288790,7.284,20230703],[1353,7.31,7.31,7.31,7.31,83200,608907,7.285,20230703],[1354,7.31,7.31,7.31,7.31,74700,547081,7.285,20230703],[1355,7.31,7.31,7.31,7.31,23800,174204,7.285,20230703],[1356,7.32,7.32,7.32,7.32,31500,230576,7.285,20230703],[1357,7.32,7.32,7.32,7.32,19300,141280,7.285,20230703],[1358,7.32,7.32,7.32,7.32,9700,71030,7.285,20230703],[1359,7.32,7.32,7.32,7.32,39e3,285698,7.285,20230703],[1400,7.32,7.32,7.32,7.32,15700,114957,7.285,20230703],[1401,7.32,7.32,7.32,7.32,162700,1191430,7.285,20230703],[1402,7.32,7.32,7.32,7.32,10700,78327,7.285,20230703],[1403,7.31,7.31,7.31,7.31,111e3,811858,7.286,20230703],[1404,7.31,7.31,7.31,7.31,33e3,241485,7.286,20230703],[1405,7.31,7.31,7.31,7.31,8400,61454,7.286,20230703],[1406,7.31,7.31,7.31,7.31,7100,51656,7.286,20230703],[1407,7.31,7.31,7.31,7.31,59200,433201,7.286,20230703],[1408,7.31,7.31,7.31,7.31,45600,333736,7.286,20230703],[1409,7.31,7.31,7.31,7.31,16700,122188,7.286,20230703],[1410,7.31,7.31,7.31,7.31,16e3,117042,7.286,20230703],[1411,7.3,7.3,7.3,7.3,185e3,1352612,7.286,20230703],[1412,7.31,7.31,7.31,7.31,129800,949495,7.286,20230703],[1413,7.3,7.3,7.3,7.3,24300,177802,7.286,20230703],[1414,7.31,7.31,7.31,7.31,4400,32173,7.286,20230703],[1415,7.31,7.31,7.31,7.31,11e3,80414,7.286,20230703],[1416,7.31,7.31,7.31,7.31,48100,351718,7.287,20230703],[1417,7.31,7.31,7.31,7.31,9800,71670,7.287,20230703],[1418,7.31,7.31,7.31,7.31,31200,228086,7.287,20230703],[1419,7.31,7.31,7.31,7.31,19500,142559,7.287,20230703],[1420,7.31,7.31,7.31,7.31,18900,138188,7.287,20230703],[1421,7.31,7.31,7.31,7.31,11500,84069,7.287,20230703],[1422,7.31,7.31,7.31,7.31,13600,99429,7.287,20230703],[1423,7.31,7.31,7.31,7.31,31200,228285,7.287,20230703],[1424,7.31,7.31,7.31,7.31,71800,525520,7.287,20230703],[1425,7.31,7.31,7.31,7.31,99500,728002,7.287,20230703],[1426,7.31,7.31,7.31,7.31,15600,114099,7.287,20230703],[1427,7.31,7.31,7.31,7.31,15100,110429,7.287,20230703],[1428,7.31,7.31,7.31,7.31,37300,272947,7.287,20230703],[1429,7.31,7.31,7.31,7.31,27600,201998,7.287,20230703],[1430,7.31,7.31,7.31,7.31,42100,308133,7.287,20230703],[1431,7.31,7.31,7.31,7.31,42800,312933,7.287,20230703],[1432,7.31,7.31,7.31,7.31,9900,72408,7.287,20230703],[1433,7.31,7.31,7.31,7.31,16500,120674,7.287,20230703],[1434,7.31,7.31,7.31,7.31,8e3,58492,7.287,20230703],[1435,7.31,7.31,7.31,7.31,7300,53399,7.287,20230703],[1436,7.31,7.31,7.31,7.31,15900,116306,7.287,20230703],[1437,7.31,7.31,7.31,7.31,11100,81176,7.287,20230703],[1438,7.31,7.31,7.31,7.31,37800,276382,7.287,20230703],[1439,7.31,7.31,7.31,7.31,240500,1760239,7.288,20230703],[1440,7.31,7.31,7.31,7.31,8200,59964,7.288,20230703],[1441,7.31,7.31,7.31,7.31,22300,163057,7.288,20230703],[1442,7.31,7.31,7.31,7.31,22300,163068,7.288,20230703],[1443,7.31,7.31,7.31,7.31,21100,154379,7.288,20230703],[1444,7.31,7.31,7.31,7.31,23800,174158,7.288,20230703],[1445,7.31,7.31,7.31,7.31,13400,97991,7.288,20230703],[1446,7.31,7.31,7.31,7.31,137100,1002261,7.288,20230703],[1447,7.31,7.31,7.31,7.31,89200,652090,7.288,20230703],[1448,7.31,7.31,7.31,7.31,12900,94374,7.288,20230703],[1449,7.31,7.31,7.31,7.31,95200,695967,7.288,20230703],[1450,7.31,7.31,7.31,7.31,115200,842354,7.289,20230703],[1451,7.31,7.31,7.31,7.31,190800,1396309,7.289,20230703],[1452,7.31,7.31,7.31,7.31,75400,551635,7.289,20230703],[1453,7.31,7.31,7.31,7.31,208200,1522926,7.289,20230703],[1454,7.3,7.3,7.3,7.3,132200,966344,7.289,20230703],[1455,7.3,7.3,7.3,7.3,83300,608805,7.289,20230703],[1456,7.3,7.3,7.3,7.3,175100,1278946,7.29,20230703],[1457,7.3,7.3,7.3,7.3,170500,1245036,7.29,20230703],[1458,7.3,7.3,7.3,7.3,5500,40150,7.29,20230703],[1459,7.3,7.3,7.3,7.3,0,0,7.29,20230703],[1500,7.32,7.32,7.32,7.32,421e3,3081720,7.29,20230703]],date:20230703,yclose:7.25}],code:0},o={stock:[{count:41,stockday:[{date:20140320,capital:{a:14922777132}},{date:20140814,capital:{a:14922777132}},{date:20150319,capital:{a:14922777132}},{date:20150820,capital:{a:14922777132}},{date:20160322,capital:{a:18653471415}},{date:20160407,capital:{a:18653471415}},{date:20160616,capital:{a:20518818557}},{date:20160811,capital:{a:20518818557}},{date:20170314,capital:{a:21618279922}},{date:20170519,capital:{a:28103763899}},{date:20170830,capital:{a:28103763899}},{date:20170906,capital:{a:28103763899}},{date:20180830,capital:{a:28103763899}},{date:20190326,capital:{a:28103763899}},{date:20190823,capital:{a:28103763899}},{date:20200424,capital:{a:28103763899}},{date:20200702,capital:{a:28103794812}},{date:20200703,capital:{a:28103794812}},{date:20200715,capital:{a:28103805551}},{date:20200716,capital:{a:28103805551}},{date:20200828,capital:{a:28103794812}},{date:20200831,capital:{a:29352131712}},{date:20200901,capital:{a:29352131712}},{date:20201009,capital:{a:29352134127}},{date:20201012,capital:{a:29352134127}},{date:20210702,capital:{a:29352156163}},{date:20210712,capital:{a:29352160584}},{date:20210713,capital:{a:29352160584}},{date:20211008,capital:{a:29352165582}},{date:20220105,capital:{a:29352168006}},{date:20220106,capital:{a:29352168006}},{date:20220401,capital:{a:29352171861}},{date:20221011,capital:{a:29352173656}},{date:20230104,capital:{a:29352174170}},{date:20230105,capital:{a:29352174170}},{date:20230403,capital:{a:29352174759}},{date:20230404,capital:{a:29352174759}},{date:20230703,capital:{a:29352175421}},{date:20230704,capital:{a:29352175421}},{date:20230712,capital:{a:29352175642}},{date:20230713,capital:{a:29352175642}}],symbol:"600000.sh",name:null}],start:0,end:0,count:1,ticket:266,version:"HQ.StockHistoryDay 2.0",message:null,code:0,servertime:"2023-08-29 14:55:58"},s={data:[[20110429,14.62,14.7,14.74,14,14.28,101688583,1452649693],[20110503,14.28,14.24,14.41,14.12,14.29,47035506,673472605],[20110504,14.29,14.2,14.37,13.74,13.83,81001236,1132838506],[20110505,13.83,13.75,13.99,13.63,13.88,46974559,650093903],[20110506,13.88,13.72,13.97,13.66,13.82,36757391,508740035],[20110509,13.82,13.8,13.97,13.7,13.76,30554676,422490266],[20110510,13.76,13.8,13.99,13.71,13.97,36795361,511163677],[20110511,13.97,13.97,14.05,13.81,13.88,27344003,380898283],[20110512,13.88,13.81,13.94,13.64,13.65,37059483,511077951],[20110513,13.65,13.68,13.83,13.49,13.83,52149614,712045065],[20110516,13.83,13.75,13.91,13.68,13.69,37488832,517163716],[20110517,13.69,13.7,14,13.62,13.91,48282261,669260989],[20110518,13.91,13.89,14.22,13.84,14.15,54624469,770723084],[20110519,14.15,14.18,14.32,14.1,14.14,44471117,632129346],[20110520,14.14,14.13,14.35,14.1,14.24,51652211,736778833],[20110523,14.24,14.17,14.23,13.8,13.86,49529764,690545338],[20110524,13.86,13.82,13.94,13.79,13.85,33302192,462259457],[20110525,13.85,13.82,13.86,13.58,13.6,30456437,417290094],[20110526,13.6,13.71,13.75,13.56,13.65,32165477,439304202],[20110527,13.65,13.68,13.89,13.57,13.69,42690707,586884307],[20110530,13.69,13.65,13.86,13.57,13.8,32773527,450312962],[20110531,13.8,13.81,13.87,13.64,13.86,54862272,754258699],[20110601,13.86,13.8,13.88,13.69,13.74,43373105,597661115],[20110602,13.74,13.6,13.65,13.07,13.21,78054220,1039092746],[20110603,10.04,10.02,10.14,10,10.09,38481953,387260340],[20110607,10.09,10.04,10.13,9.98,10.1,32112692,322851680],[20110608,10.1,10.11,10.12,9.78,9.92,71399603,705901472],[20110609,9.92,9.9,9.9,9.67,9.69,50650154,494816808],[20110610,9.69,9.71,9.8,9.68,9.74,41514189,403650864],[20110613,9.74,9.7,9.83,9.62,9.79,33499528,325257133],[20110614,9.79,9.78,10.04,9.73,9.92,59763717,594459887],[20110615,9.92,9.9,9.9,9.69,9.72,50642541,494521264],[20110616,9.72,9.67,9.71,9.59,9.61,43684110,420806039],[20110617,9.61,9.61,9.69,9.55,9.56,38151775,367427557],[20110620,9.56,9.55,9.67,9.51,9.65,49155845,471826236],[20110621,9.65,9.66,9.72,9.63,9.68,44032371,426182669],[20110622,9.68,9.73,9.73,9.57,9.63,44402682,428768703],[20110623,9.63,9.62,9.79,9.5,9.74,51462993,496177923],[20110624,9.74,9.69,10.18,9.67,10.1,108608292,1083590773],[20110627,10.1,10.1,10.21,10,10.07,61879841,624566437],[20110628,10.07,10.07,10.08,9.89,10,48625916,485148836],[20110629,10,10,10.04,9.74,9.76,92115792,906629869],[20110630,9.76,9.78,9.97,9.74,9.84,89477914,880212562],[20110701,9.84,9.85,9.86,9.65,9.74,84950358,829257826],[20110704,9.74,9.79,10.12,9.78,10.1,137704167,1372265445],[20110705,10.1,10.1,10.18,9.99,10.05,79844236,803065821],[20110706,10.05,10.01,10.01,9.8,9.92,78083396,771582190],[20110707,9.92,10.09,10.15,9.9,9.93,110306181,1107281017],[20110708,9.93,9.95,10.25,9.93,10.14,96178652,973144633],[20110711,10.14,10.05,10.13,9.96,10.05,77297565,774789745],[20110712,10.05,9.97,10.02,9.84,9.88,73779698,730710128],[20110713,9.88,9.93,10.08,9.87,10.01,60517246,605053186],[20110714,10.01,10,10.1,9.97,10.1,72244581,725394120],[20110715,10.1,10.05,10.14,9.99,10.09,66656003,672068536],[20110718,10.09,10.1,10.1,9.93,10,88296134,883661214],[20110719,10,9.94,9.96,9.82,9.85,77790440,768616582],[20110720,9.85,9.9,9.94,9.77,9.84,63761031,626819364],[20110721,9.84,9.83,9.85,9.64,9.73,73648903,716204441],[20110722,9.73,9.75,9.78,9.67,9.7,52488395,509417136],[20110725,9.7,9.65,9.67,9.37,9.43,88189088,838678395],[20110726,9.43,9.43,9.55,9.38,9.42,45125010,426214467],[20110727,9.42,9.38,9.42,9.35,9.39,48213160,452508637],[20110728,9.39,9.33,9.34,9.15,9.22,65663811,605993962],[20110729,9.22,9.25,9.61,9.13,9.4,95487760,894864393],[20110801,9.4,9.33,9.46,9.27,9.32,44930056,420409959],[20110802,9.32,9.25,9.31,9.13,9.26,41364988,380816089],[20110803,9.26,9.19,9.31,9.17,9.26,31523822,291253828],[20110804,9.26,9.31,9.4,9.27,9.28,30410552,283911226],[20110805,9.28,9.09,9.15,9,9.03,71952165,651685202],[20110808,9.03,8.95,9.09,8.62,8.73,98624718,871891979],[20110809,8.73,8.52,8.95,8.47,8.87,110925176,968666716],[20110810,8.87,9.02,9.08,8.87,8.91,67295852,605242196],[20110811,8.91,8.73,9.15,8.71,9.1,74782511,673428896],[20110812,9.1,9.12,9.15,8.98,9.03,51162640,463907926],[20110815,9.03,9.07,9.39,8.99,9.37,89493443,825023455],[20110816,9.37,9.35,9.51,9.27,9.35,92194078,866602343],[20110817,9.35,9.34,9.41,9.28,9.28,44535594,415370550],[20110818,9.28,9.32,9.33,9.09,9.12,40832235,375402155],[20110819,9.12,8.99,9.08,8.94,9.02,55545006,500195838],[20110822,9.02,9.04,9.15,8.95,8.98,42762550,385779149],[20110823,8.98,9.03,9.19,8.93,9.18,48210876,438712166],[20110824,9.18,9.21,9.34,9.08,9.1,53322202,490717794],[20110825,9.1,9.15,9.53,9.11,9.48,121038880,1135191015],[20110826,9.48,9.42,9.51,9.32,9.46,61998169,584450251],[20110829,9.46,9.29,9.29,9.13,9.18,75330948,693917105],[20110830,9.18,9.25,9.4,9.15,9.19,49166774,456223295],[20110831,9.19,9.18,9.35,9.16,9.29,34349428,318100885],[20110901,9.29,9.31,9.43,9.28,9.37,58506018,548068833],[20110902,9.37,9.35,9.4,9.2,9.29,32039819,297248797],[20110905,9.29,9.2,9.22,9.11,9.15,30840689,282591754],[20110906,9.15,9.09,9.22,9.03,9.11,42139539,384694366],[20110907,9.11,9.13,9.38,9.08,9.29,40598521,374413883],[20110908,9.29,9.3,9.33,9.2,9.26,28413650,263397211],[20110909,9.26,9.3,9.41,9.22,9.3,38055811,354331602],[20110913,9.3,9.18,9.22,9.12,9.15,27627217,252939806],[20110914,9.15,9.2,9.21,8.94,9.1,50592099,457967156],[20110915,9.1,9.1,9.17,8.94,8.95,56765027,512651845],[20110916,8.95,9.02,9.07,8.95,8.98,42224050,380213995],[20110919,8.98,8.91,8.92,8.79,8.81,41510239,366080582],[20110920,8.81,8.8,8.92,8.73,8.86,34551618,305251347],[20110921,8.86,8.86,9.22,8.76,9.09,70353056,635069866],[20110922,9.09,9.01,9.02,8.8,8.82,53791988,479557639],[20110923,8.82,8.71,8.81,8.61,8.73,54164832,470756862],[20110926,8.73,8.65,8.72,8.4,8.44,81748380,697436150],[20110927,8.44,8.52,8.58,8.48,8.52,40252611,343008396],[20110928,8.52,8.59,8.6,8.4,8.43,42407399,360008943],[20110929,8.43,8.39,8.52,8.33,8.45,43757787,369392508],[20110930,8.45,8.48,8.64,8.44,8.54,60468787,515663929],[20111010,8.54,8.52,8.56,8.41,8.42,32428434,274365576],[20111011,8.42,8.78,8.78,8.48,8.57,59130344,511050472],[20111012,8.57,8.54,8.92,8.49,8.85,89412222,787072851],[20111013,8.85,8.82,8.94,8.76,8.87,51298778,453963294],[20111014,8.87,8.84,8.88,8.73,8.83,40504198,356399899],[20111017,8.83,8.84,9.05,8.82,8.92,46009758,410848342],[20111018,8.92,8.85,8.9,8.75,8.78,41115344,362177732],[20111019,8.78,8.78,8.92,8.75,8.84,36188377,319545731],[20111020,8.84,8.77,8.86,8.64,8.73,50658455,443175230],[20111021,8.73,8.75,8.97,8.7,8.89,59306969,526976700],[20111024,8.89,8.91,9.21,8.87,9.16,94932084,864185495],[20111025,9.16,9.18,9.25,9.08,9.16,66314936,608223062],[20111026,9.16,9.13,9.3,9.05,9.18,68454846,631301579],[20111027,9.18,9.26,9.35,9.21,9.26,45585827,422360453],[20111028,9.26,9.4,9.55,9.26,9.38,82502754,775731742],[20111031,9.38,9.35,9.35,9.16,9.21,50778832,468747732],[20111101,9.21,9.15,9.34,9.11,9.18,57198902,527513052],[20111102,9.18,9.08,9.37,9.04,9.36,59397848,546059796],[20111103,9.36,9.38,9.39,9.22,9.24,84349601,785658964],[20111104,9.24,9.35,9.36,9.23,9.31,42565042,395922342],[20111107,9.31,9.25,9.28,9.16,9.18,32870037,302777625],[20111108,9.18,9.24,9.3,9.14,9.21,31693301,291603574],[20111109,9.21,9.24,9.29,9.18,9.27,27951632,257975143],[20111110,9.27,9.2,9.25,9.04,9.05,46636157,426657140],[20111111,9.05,9.06,9.17,9.05,9.08,25261827,230005502],[20111114,9.08,9.18,9.27,9.13,9.21,42296963,389371091],[20111115,9.21,9.2,9.22,9.13,9.18,30013432,275179280],[20111116,9.18,9.18,9.18,8.87,8.92,64028631,576115159],[20111117,8.92,8.94,8.97,8.84,8.86,32007465,284590451],[20111118,8.86,8.8,8.89,8.76,8.8,36819930,324198795],[20111121,8.8,8.84,8.85,8.67,8.74,32355327,281903843],[20111122,8.74,8.7,8.81,8.68,8.75,30669913,268099631],[20111123,8.75,8.76,8.77,8.62,8.69,26370231,228822392],[20111124,8.69,8.62,8.76,8.6,8.7,24460075,212634673],[20111125,8.7,8.7,8.72,8.6,8.62,21366538,184856605],[20111128,8.62,8.63,8.68,8.57,8.6,23967739,206431563],[20111129,8.6,8.66,8.74,8.62,8.73,25960610,225388356],[20111130,8.73,8.69,8.73,8.47,8.5,44971839,384658393],[20111201,8.5,8.74,8.95,8.73,8.81,89049077,787219129],[20111202,8.81,8.78,8.85,8.71,8.8,38638133,339557364],[20111205,8.8,8.84,8.91,8.63,8.8,40188321,354439402],[20111206,8.8,8.76,8.84,8.7,8.73,26440305,232129306],[20111207,8.73,8.74,8.83,8.7,8.78,23350899,204935333],[20111208,8.78,8.78,8.83,8.68,8.78,21909676,191759965],[20111209,8.78,8.73,8.78,8.64,8.7,29514e3,257109793],[20111212,8.7,8.68,8.74,8.64,8.66,23035328,200109781],[20111213,8.66,8.64,8.72,8.56,8.58,47600711,412160766],[20111214,8.58,8.57,8.65,8.54,8.6,27334982,235202167],[20111215,8.6,8.56,8.62,8.48,8.49,41518789,354799723],[20111216,8.49,8.51,8.65,8.49,8.62,37730295,322463285],[20111219,8.62,8.57,8.64,8.37,8.61,45264959,384672669],[20111220,8.61,8.58,8.75,8.56,8.59,38376971,331731071],[20111221,8.59,8.66,8.72,8.5,8.53,41637650,359681306],[20111222,8.53,8.49,8.59,8.45,8.53,42682705,363453847],[20111223,8.53,8.54,8.61,8.49,8.54,23263186,198890329],[20111226,8.54,8.52,8.56,8.42,8.47,31788769,269877056],[20111227,8.47,8.47,8.53,8.4,8.44,31075676,262876940],[20111228,8.44,8.43,8.46,8.25,8.38,42011046,351109636],[20111229,8.38,8.35,8.38,8.29,8.35,40055045,333839370],[20111230,8.35,8.39,8.51,8.38,8.49,52982530,448339738],[20120104,8.49,8.54,8.56,8.39,8.41,34201379,290229551],[20120105,8.41,8.47,8.82,8.47,8.65,132116203,1144753023],[20120106,8.65,8.63,8.78,8.62,8.71,61778687,537043761],[20120109,8.71,8.72,8.99,8.68,8.95,80136249,711429611],[20120110,8.95,8.95,9.1,8.88,9.07,72004632,647206633],[20120111,9.07,9.05,9.1,8.98,9,49261157,444366552],[20120112,9,9,9.21,8.99,9.09,60486981,551261471],[20120113,9.09,9.11,9.18,8.97,9.04,56725332,514638094],[20120116,9.04,9,9.12,8.96,8.97,33100160,299225053],[20120117,8.97,9,9.26,8.79,9.2,97357263,876457391],[20120118,9.2,9.16,9.23,9,9.04,58089289,529288104],[20120119,9.04,9.05,9.22,9.02,9.2,68645571,628781817],[20120120,9.2,9.25,9.43,9.17,9.42,95052703,883450355],[20120130,9.42,9.4,9.41,9.2,9.22,71883155,668276691],[20120131,9.22,9.24,9.28,9.16,9.22,35464104,326763252],[20120201,9.22,9.2,9.26,9.05,9.08,39647888,362716575],[20120202,9.08,9.12,9.42,9.08,9.4,87973331,816297537],[20120203,9.4,9.35,9.5,9.32,9.44,97135312,914988444],[20120206,9.44,9.46,9.51,9.29,9.39,63691281,599080983],[20120207,9.39,9.32,9.36,9.18,9.24,51391402,475945766],[20120208,9.24,9.23,9.48,9.23,9.45,64270717,602796522],[20120209,9.45,9.45,9.48,9.36,9.4,50273854,473358227],[20120210,9.4,9.36,9.48,9.32,9.37,51836488,487049474],[20120213,9.37,9.25,9.37,9.18,9.27,49204966,456411669],[20120214,9.27,9.24,9.28,9.13,9.19,53024869,487049233],[20120215,9.19,9.16,9.29,9.14,9.23,55064760,507511353],[20120216,9.23,9.25,9.28,9.14,9.19,47501799,437494063],[20120217,9.19,9.25,9.31,9.2,9.26,41743292,386595857],[20120220,9.26,9.41,9.41,9.25,9.26,57740009,539245887],[20120221,9.26,9.27,9.31,9.2,9.28,42757386,395923924],[20120222,9.28,9.28,9.36,9.2,9.32,81447790,755732387],[20120223,9.32,9.32,9.4,9.28,9.33,87754888,818404842],[20120224,9.33,9.35,9.53,9.31,9.51,128341832,1207795585],[20120227,9.51,9.57,9.62,9.45,9.48,126664015,1206459798],[20120228,9.48,9.48,9.7,9.46,9.66,136121116,1308533877],[20120229,9.66,9.67,9.67,9.51,9.54,77757837,745267161],[20120301,9.54,9.5,9.59,9.49,9.55,46237868,441399342],[20120302,9.55,9.55,9.7,9.54,9.69,74013187,711842953],[20120305,9.69,9.74,9.75,9.58,9.58,66098035,638459411],[20120306,9.58,9.53,9.61,9.41,9.44,68450355,650629551],[20120307,9.44,9.39,9.44,9.33,9.34,51077237,479615280],[20120308,9.34,9.39,9.5,9.37,9.46,54828552,517039328],[20120309,9.46,9.47,9.51,9.42,9.47,47510501,449318745],[20120312,9.47,9.44,9.45,9.33,9.38,52784386,494779980],[20120313,9.38,9.39,9.53,9.35,9.47,61430150,582028877],[20120314,9.47,9.53,9.61,9.32,9.36,99280321,940852511],[20120315,9.36,9.36,9.45,9.16,9.19,70673894,661561276],[20120316,9.19,9.25,9.34,9.2,9.25,72584563,672304027],[20120319,9.25,9.26,9.32,9.24,9.28,50228036,466395766],[20120320,9.28,9.25,9.26,9.12,9.12,62725576,575220524],[20120321,9.12,9.18,9.19,9.02,9.08,51867060,471579975],[20120322,9.08,9.09,9.21,9.03,9.12,38651197,352251184],[20120323,9.12,9.1,9.12,9.02,9.06,35268448,319927048],[20120326,9.06,9.05,9.17,9.05,9.13,33692849,306941853],[20120327,9.13,9.15,9.17,9.08,9.12,27294640,249025233],[20120328,9.12,9.12,9.14,8.93,8.97,43565307,394701420],[20120329,8.97,8.94,9,8.85,8.87,48391415,432068893],[20120330,8.87,8.92,8.97,8.88,8.93,50587012,451335933],[20120405,8.93,8.9,8.95,8.81,8.93,76352001,677374501],[20120406,8.93,8.93,8.96,8.84,8.94,56682481,504458934],[20120409,8.94,8.89,8.94,8.83,8.84,34889828,309720486],[20120410,8.84,8.86,8.93,8.78,8.92,45147e3,399088179],[20120411,8.92,8.87,8.95,8.85,8.89,39397074,350489715],[20120412,8.89,8.89,9.14,8.87,9.12,64571634,581979210],[20120413,9.12,9.11,9.15,9.02,9.14,61175666,556243010],[20120416,9.14,9.08,9.12,9.04,9.06,38614798,350462999],[20120417,9.06,9.06,9.09,8.93,8.93,49466011,444391607],[20120418,8.93,8.93,9.14,8.92,9.12,67117990,607091633],[20120419,9.12,9.1,9.16,9.06,9.12,48488e3,441712581],[20120420,9.12,9.1,9.32,9.09,9.31,77240835,714085575],[20120423,9.31,9.27,9.33,9.21,9.24,41839068,387763897],[20120424,9.24,9.23,9.55,9.22,9.38,113165453,1065629977],[20120425,9.38,9.34,9.44,9.33,9.35,66489024,623235371],[20120426,9.35,9.42,9.46,9.3,9.37,53826936,503917233],[20120427,9.37,9.39,9.45,9.35,9.41,47114993,443152186],[20120502,9.41,9.48,9.59,9.41,9.56,107696972,1023491921],[20120503,9.56,9.51,9.55,9.42,9.46,60560075,574341330],[20120504,9.46,9.47,9.5,9.39,9.49,71659892,677231238],[20120507,9.49,9.43,9.48,9.34,9.42,82225733,773477051],[20120508,9.42,9.41,9.42,9.28,9.36,86721348,810233956],[20120509,9.36,9.3,9.31,9.18,9.2,65066893,600930021],[20120510,9.2,9.21,9.24,9.11,9.16,67576254,619397962],[20120511,9.16,9.16,9.23,9.12,9.16,35532729,325856898],[20120514,9.16,9.21,9.23,9.06,9.08,70896633,648414480],[20120515,9.08,9,9.05,8.98,9.04,60429994,544604567],[20120516,9.04,9.03,9.03,8.89,8.91,75535741,676147543],[20120517,8.91,8.93,9.02,8.9,8.97,43092663,386025718],[20120518,8.97,8.92,8.92,8.82,8.86,61950167,549225590],[20120521,8.86,8.86,8.91,8.83,8.87,46679612,413635877],[20120522,8.87,8.9,8.97,8.88,8.96,67549651,602839656],[20120523,8.96,8.95,8.96,8.85,8.89,61979794,552097474],[20120524,8.89,8.88,8.94,8.81,8.85,49757216,441704165],[20120525,8.85,8.85,8.86,8.77,8.79,45887776,404197693],[20120528,8.79,8.8,8.88,8.77,8.87,52347656,461949299],[20120529,8.87,8.86,8.98,8.82,8.95,93478648,831085291],[20120530,8.95,8.92,8.93,8.79,8.82,88036486,779244023],[20120531,8.82,8.79,8.8,8.75,8.77,67011196,587833136],[20120601,8.77,8.78,8.84,8.75,8.78,42401677,372673966],[20120604,8.78,8.71,8.71,8.58,8.59,69367973,599453523],[20120605,8.59,8.62,8.64,8.55,8.56,69666907,598110567],[20120606,8.56,8.59,8.68,8.55,8.62,49918846,429065873],[20120607,8.62,8.68,8.7,8.53,8.56,48026408,413324686],[20120608,8.56,8.51,8.53,8.31,8.34,140389731,1176530441],[20120611,8.34,8.36,8.38,8.31,8.34,71644862,597652524],[20120612,8.34,8.31,8.35,8.19,8.29,82431224,680814847],[20120613,8.29,8.29,8.29,8.29,8.29,0,0],[20120614,8.29,8.3,8.34,8.25,8.27,80017463,664166685],[20120615,8.27,8.31,8.53,8.29,8.47,134216053,1129580248],[20120618,8.47,8.47,8.48,8.42,8.46,50212960,424346827],[20120619,8.46,8.47,8.54,8.43,8.49,47008304,398791959],[20120620,8.49,8.54,8.61,8.48,8.5,50000107,427039914],[20120621,8.5,8.51,8.51,8.4,8.44,39423884,332932086],[20120625,8.44,8.42,8.48,8.34,8.35,52706596,443526592],[20120626,8.05,8.07,8.12,8.03,8.06,39982538,323089664],[20120627,8.06,8.06,8.09,8.03,8.05,26966055,217422022],[20120628,8.05,8.05,8.07,8.01,8.01,28876449,232014025],[20120629,8.01,8.04,8.16,8.02,8.13,50974236,412653792],[20120702,8.13,8.15,8.15,8.05,8.09,43691987,353033253],[20120703,8.09,8.09,8.15,8.07,8.09,40080965,324895958],[20120704,8.09,8.1,8.18,8.08,8.12,39552477,321375929],[20120705,8.12,8.11,8.12,8.05,8.07,33635896,271555077],[20120706,8.07,7.92,7.97,7.88,7.97,115797069,917011451],[20120709,7.97,7.93,7.94,7.65,7.67,106535413,829804094],[20120710,7.67,7.67,7.76,7.66,7.7,45089773,347540683],[20120711,7.7,7.69,7.74,7.67,7.71,32425638,249889719],[20120712,7.71,7.71,7.72,7.58,7.67,100909326,770420629],[20120713,7.67,7.66,7.79,7.64,7.73,45202381,349346441],[20120716,7.73,7.75,7.75,7.62,7.63,46584899,358037212],[20120717,7.63,7.65,7.73,7.62,7.69,30224255,232272374],[20120718,7.69,7.69,7.69,7.6,7.67,47630983,363638278],[20120719,7.67,7.65,7.73,7.61,7.69,77344589,594527735],[20120720,7.69,7.67,7.68,7.6,7.61,55545514,423521040],[20120723,7.61,7.57,7.57,7.42,7.45,64501900,480841537],[20120724,7.45,7.43,7.5,7.41,7.46,48389405,360293105],[20120725,7.46,7.43,7.5,7.39,7.41,47580447,353247490],[20120726,7.41,7.4,7.45,7.37,7.4,30350495,224778997],[20120727,7.4,7.42,7.56,7.4,7.49,58500797,438293389],[20120730,7.49,7.52,7.65,7.49,7.56,62142486,470732267],[20120731,7.56,7.57,7.69,7.56,7.66,70118950,535947136],[20120801,7.66,7.67,7.71,7.59,7.65,62270863,476495464],[20120802,7.65,7.68,7.77,7.65,7.75,75444190,581966475],[20120803,7.75,7.74,7.75,7.68,7.74,44045380,339338689],[20120806,7.74,7.73,7.74,7.69,7.72,46411105,358235336],[20120807,7.72,7.72,7.73,7.65,7.69,34912528,268267939],[20120808,7.69,7.7,7.77,7.69,7.73,53821168,416624081],[20120809,7.73,7.75,7.76,7.69,7.75,32490296,251340987],[20120810,7.75,7.79,7.85,7.78,7.8,46782980,365500895],[20120813,7.8,7.8,7.83,7.74,7.75,47282079,368478427],[20120814,7.75,7.76,7.8,7.73,7.8,39743689,308683311],[20120815,7.8,7.8,7.8,7.55,7.58,89555247,683068987],[20120816,7.58,7.59,7.59,7.5,7.53,40630297,306256972],[20120817,7.53,7.52,7.58,7.51,7.55,33322665,251555254],[20120820,7.55,7.52,7.56,7.46,7.52,27038216,202877230],[20120821,7.52,7.51,7.56,7.49,7.51,36268940,272732527],[20120822,7.51,7.52,7.53,7.47,7.52,35326454,264640473],[20120823,7.52,7.51,7.55,7.47,7.52,36366406,273444020],[20120824,7.52,7.52,7.53,7.45,7.49,36963616,277056694],[20120827,7.49,7.45,7.49,7.39,7.4,40334510,300069736],[20120828,7.4,7.43,7.62,7.4,7.6,54763743,411991622],[20120829,7.6,7.56,7.57,7.52,7.55,38419444,289895904],[20120830,7.55,7.5,7.62,7.5,7.61,44804211,339823939],[20120831,7.61,7.58,7.68,7.57,7.61,37255105,284745594],[20120903,7.61,7.63,7.63,7.53,7.58,55393324,419440943],[20120904,7.58,7.56,7.59,7.43,7.46,44361378,332534233],[20120905,7.46,7.44,7.45,7.28,7.32,73135906,536590326],[20120906,7.32,7.34,7.39,7.3,7.38,38370245,281996026],[20120907,7.38,7.42,7.78,7.4,7.6,145971941,1108956749],[20120910,7.6,7.59,7.61,7.53,7.56,63799021,482615575],[20120911,7.56,7.54,7.54,7.43,7.49,50981388,381041955],[20120912,7.49,7.53,7.56,7.42,7.48,41199392,308089937],[20120913,7.48,7.47,7.5,7.44,7.45,28598526,213621171],[20120914,7.45,7.5,7.56,7.44,7.52,60553998,454887764],[20120917,7.52,7.52,7.52,7.4,7.41,39495794,294478234],[20120918,7.41,7.39,7.4,7.34,7.35,29556474,217783066],[20120919,7.35,7.35,7.38,7.33,7.34,35316266,259404103],[20120920,7.34,7.32,7.34,7.22,7.23,48072062,349808077],[20120921,7.23,7.22,7.26,7.18,7.21,37540673,271098089],[20120924,7.21,7.18,7.21,7.11,7.17,44280628,316830860],[20120925,7.17,7.16,7.18,7.13,7.16,23528437,168346308],[20120926,7.16,7.15,7.18,7.1,7.11,28344266,202126616],[20120927,7.11,7.11,7.36,7.1,7.32,74565209,540842730],[20120928,7.32,7.28,7.39,7.24,7.38,62930106,460162691],[20121008,7.38,7.38,7.42,7.28,7.32,32324563,237702592],[20121009,7.32,7.35,7.48,7.34,7.45,48620078,361695652],[20121010,7.45,7.43,7.46,7.4,7.44,27147361,201761964],[20121011,7.44,7.41,7.43,7.37,7.41,29564294,218797754],[20121012,7.41,7.43,7.5,7.41,7.45,37953795,283061227],[20121015,7.45,7.46,7.47,7.37,7.41,22249339,164793074],[20121016,7.41,7.41,7.52,7.39,7.46,43952520,328313924],[20121017,7.46,7.48,7.58,7.44,7.55,52658490,395714435],[20121018,7.55,7.55,7.65,7.54,7.62,51397333,390882250],[20121019,7.62,7.62,7.63,7.55,7.58,40185550,305185395],[20121022,7.58,7.54,7.68,7.53,7.65,36799861,280112259],[20121023,7.65,7.66,7.68,7.55,7.57,32189190,245356334],[20121024,7.57,7.55,7.63,7.54,7.59,28328508,215116946],[20121025,7.59,7.58,7.62,7.5,7.53,29807495,225449545],[20121026,7.53,7.54,7.57,7.42,7.46,49611207,370899603],[20121029,7.46,7.44,7.49,7.42,7.47,28176827,210091716],[20121030,7.47,7.47,7.53,7.4,7.48,37082866,276344872],[20121031,7.48,7.49,7.53,7.43,7.51,36411101,273109830],[20121101,7.51,7.52,7.7,7.51,7.64,57205114,436219680],[20121102,7.64,7.65,7.7,7.61,7.68,47587494,364830180],[20121105,7.68,7.7,7.78,7.66,7.73,56974001,439602346],[20121106,7.73,7.74,7.74,7.59,7.68,42177128,323024801],[20121107,7.68,7.67,7.73,7.64,7.69,26193792,201366783],[20121108,7.69,7.63,7.66,7.53,7.54,38667163,293900674],[20121109,7.54,7.53,7.59,7.5,7.53,26921255,202868999],[20121112,7.53,7.54,7.64,7.53,7.63,43645487,331521946],[20121113,7.63,7.62,7.62,7.48,7.49,37691617,283805513],[20121114,7.49,7.49,7.53,7.47,7.5,21823216,163644374],[20121115,7.5,7.49,7.5,7.41,7.42,29220009,217739719],[20121116,7.42,7.41,7.41,7.34,7.36,33266319,245149918],[20121119,7.36,7.36,7.4,7.33,7.37,24785310,182453735],[20121120,7.37,7.4,7.41,7.33,7.35,20252986,149215097],[20121121,7.35,7.35,7.48,7.34,7.47,28957627,214374137],[20121122,7.47,7.45,7.48,7.4,7.44,22784842,169442910],[20121123,7.44,7.46,7.56,7.43,7.51,35819826,268999532],[20121126,7.51,7.5,7.54,7.43,7.47,28167480,210337432],[20121127,7.47,7.44,7.52,7.42,7.46,40827533,304729094],[20121128,7.46,7.44,7.5,7.42,7.44,41978767,312815519],[20121129,7.44,7.46,7.47,7.4,7.41,39279397,291914537],[20121130,7.41,7.41,7.48,7.37,7.46,38822287,288486299],[20121203,7.46,7.46,7.47,7.34,7.35,53769233,396827583],[20121204,7.35,7.33,7.46,7.33,7.43,34974819,258840206],[20121205,7.43,7.43,7.92,7.41,7.88,227002022,1764021567],[20121206,7.88,7.87,7.97,7.83,7.89,115134979,910874057],[20121207,7.89,7.93,8.28,7.92,8.26,229249195,1863056888],[20121210,8.26,8.35,8.42,8.26,8.33,215254803,1796312749],[20121211,8.33,8.32,8.37,8.25,8.28,114930761,955761506],[20121212,8.28,8.29,8.49,8.29,8.4,174126970,1463952981],[20121213,8.4,8.35,8.45,8.28,8.29,124094525,1038553776],[20121214,8.29,8.32,8.99,8.32,8.9,344394455,3002867566],[20121217,8.9,9,9.11,8.94,9.07,254783070,2298528870],[20121218,9.07,9.01,9.29,8.97,9.14,234880214,2144833795],[20121219,9.14,9.11,9.16,8.98,9.05,176670647,1601205282],[20121220,9.05,8.99,9.07,8.88,9.06,149750877,1346132252],[20121221,9.06,9.06,9.11,8.88,8.97,130820092,1174200111],[20121224,8.97,8.94,9.26,8.94,9.09,134642726,1224943518],[20121225,9.09,9.07,9.56,9.04,9.45,234226689,2200438398],[20121226,9.45,9.46,9.49,9.37,9.46,96013021,904988194],[20121227,9.46,9.46,9.64,9.32,9.39,127847946,1211244239],[20121228,9.39,9.37,9.64,9.37,9.59,119599842,1140200526],[20121231,9.59,9.64,9.96,9.63,9.92,198451648,1956467612],[20130104,9.92,10.1,10.26,9.93,10.02,261436810,2633796691],[20130107,10.02,10.05,10.34,10.01,10.32,248200915,2534161998],[20130108,10.32,10.34,10.35,10.06,10.12,154851189,1573240155],[20130109,10.12,10.09,10.18,9.98,10.14,175906181,1774560423],[20130110,10.14,10.11,10.21,9.99,10.04,121226794,1224888956],[20130111,10.04,10.07,10.12,9.77,9.82,171547464,1709899032],[20130114,9.82,9.75,10.36,9.75,10.35,228634872,2326609986],[20130115,10.35,10.35,10.41,10.22,10.33,134039003,1383536241],[20130116,10.33,10.28,10.32,9.98,10.12,156691872,1588121377],[20130117,10.12,10.05,10.17,9.88,10.03,116672023,1163327254],[20130118,10.03,10.08,10.25,9.97,10.16,129872645,1315677034],[20130121,10.16,10.2,10.44,10.05,10.4,178154882,1826584603],[20130122,10.4,10.38,10.76,10.25,10.48,242222065,2546398122],[20130123,10.48,10.44,10.62,10.37,10.6,155968498,1637582752],[20130124,10.6,10.6,11.04,10.53,10.61,320210498,3446063883],[20130125,10.61,10.6,10.68,10.53,10.66,89716806,951423104],[20130128,10.66,10.66,11.21,10.65,11.18,263089195,2903989341],[20130129,11.18,11.21,11.47,11.11,11.3,191067344,2155684299],[20130130,11.3,11.29,11.36,11.09,11.24,172171454,1933404997],[20130131,11.24,11.24,11.5,11.12,11.48,181147190,2051351346],[20130201,11.48,11.41,11.97,11.31,11.95,223157195,2595572299],[20130204,11.95,11.98,12.27,11.83,12.07,271540507,3269293147],[20130205,12.07,11.91,12,11.65,11.87,176944688,2098278652],[20130206,11.87,11.85,12.05,11.72,12,133748186,1595335908],[20130207,12,12,12.02,11.17,11.43,315193605,3634915098],[20130208,11.43,11.4,11.45,11.06,11.34,195904902,2214211012],[20130218,11.34,11.42,11.5,11.19,11.26,119051849,1348960810],[20130219,11.26,11.23,11.31,11.07,11.1,114565262,1279590709],[20130220,11.1,11.1,11.12,10.58,10.81,264523040,2849978249],[20130221,10.81,10.65,10.68,10,10.22,290791316,2996527715],[20130222,10.22,10.19,10.34,10.08,10.14,143226433,1463429410],[20130225,10.14,10.21,10.4,10.2,10.32,116274545,1198145581],[20130226,10.32,10.2,10.76,10.15,10.33,238592674,2515148260],[20130227,10.33,10.36,10.7,10.31,10.39,158815735,1662077351],[20130228,10.39,10.55,11.07,10.39,11.06,224658466,2416913062],[20130301,11.06,11.07,11.31,10.8,11.17,223208905,2475460511],[20130304,11.17,10.86,10.9,10.27,10.39,261002023,2758781288],[20130305,10.39,10.36,11.22,10.36,11.07,233607734,2525017018],[20130306,11.07,11.16,11.31,10.96,11.11,205631621,2289024741],[20130307,11.11,11.02,11.1,10.51,10.76,191555154,2072717387],[20130308,10.76,10.81,10.88,10.6,10.71,103046487,1106726782],[20130311,10.71,10.67,10.67,10.41,10.47,94081221,990803399],[20130312,10.47,10.46,10.65,10.18,10.29,132298619,1371021517],[20130313,10.29,10.29,10.42,10.11,10.25,105764431,1083876595],[20130314,10.25,10.4,10.56,10.27,10.45,163419368,1707645843],[20130315,10.45,10.47,10.93,10.38,10.51,214299272,2283442403],[20130318,10.51,10.44,10.64,10.39,10.48,142604467,1499673028],[20130319,10.48,10.47,10.66,10.43,10.65,114470221,1207222485],[20130320,10.65,10.68,11.2,10.65,11.19,253698290,2793678441],[20130321,11.19,11.2,11.28,10.94,11.1,193267919,2143848514],[20130322,11.1,11.01,11.11,10.95,11.06,122824527,1356165867],[20130325,11.06,11.13,11.24,11,11.04,89020579,986945885],[20130326,11.04,10.98,10.99,10.65,10.7,126327261,1358261944],[20130327,10.7,10.71,10.95,10.63,10.76,113814685,1225592652],[20130328,10.76,10.2,10.25,9.68,10.02,298069476,2992135427],[20130329,10.02,10.03,10.21,9.91,10.13,131028762,1315731616],[20130401,10.13,10.06,10.2,10.03,10.05,76052116,767292300],[20130402,10.05,10.07,10.17,9.94,10.03,83681538,840890523],[20130403,10.03,10.05,10.15,9.95,10.06,88765772,892637729],[20130408,10.06,9.87,9.99,9.7,9.92,89499064,883268138],[20130409,9.92,9.96,10.12,9.96,10.04,65806596,660726025],[20130410,10.04,10.03,10.04,9.92,10,54586848,544630505],[20130411,10,10.08,10.12,10,10.02,43303750,435013681],[20130412,10.02,10.03,10.06,9.9,9.94,41832297,417375283],[20130415,9.94,9.94,9.99,9.79,9.83,75763623,747795127],[20130416,9.83,9.75,9.83,9.6,9.74,126274720,1224441887],[20130417,9.74,9.74,9.74,9.52,9.59,86278542,829038302],[20130418,9.59,9.46,9.66,9.42,9.63,103421937,985199538],[20130419,9.63,9.65,10.19,9.62,10.14,178675031,1778831224],[20130422,10.14,10.11,10.22,10.1,10.22,123343744,1254891723],[20130423,10.22,10.28,10.29,9.8,9.84,108826815,1083711298],[20130424,9.84,9.86,10.15,9.77,10.03,105005043,1045917590],[20130425,10.03,10,10.07,9.82,9.91,74320334,737540033],[20130426,9.91,9.96,10.01,9.85,9.88,52806428,524919890],[20130502,9.88,9.77,9.86,9.66,9.82,80667825,786928394],[20130503,9.82,9.87,10.17,9.83,10.01,109373480,1097528959],[20130506,10.01,10.03,10.21,9.97,10.13,87865272,888293829],[20130507,10.13,10.09,10.1,9.98,10.06,60095952,603143645],[20130508,10.06,10.12,10.2,10.01,10.05,72153519,728615180],[20130509,10.05,10.06,10.08,9.89,9.97,64667334,644949072],[20130510,9.97,9.93,10.06,9.89,10.03,63127003,630968308],[20130513,10.03,10.02,10.11,9.93,10.02,66994306,670319776],[20130514,10.02,10.03,10.05,9.93,9.97,67348057,671548085],[20130515,9.97,9.98,10.02,9.93,9.99,47275904,471747480],[20130516,9.99,9.99,10.16,9.84,10.15,111647303,1120193847],[20130517,10.15,10.15,10.28,10.05,10.24,122955149,1250713166],[20130520,10.24,10.26,10.54,10.2,10.41,156851179,1632285383],[20130521,10.41,10.38,10.42,10.24,10.34,91775245,946356975],[20130522,10.34,10.33,10.38,10.28,10.36,71207689,734819190],[20130523,10.36,10.29,10.33,10.15,10.15,82484743,845485658],[20130524,10.15,10.2,10.28,10.1,10.2,63230983,644944802],[20130527,10.2,10.21,10.33,10.18,10.29,69546991,714504542],[20130528,10.29,10.3,10.56,10.25,10.55,111377099,1160468763],[20130529,10.55,10.58,10.62,10.51,10.52,91459014,966132051],[20130530,10.52,10.48,10.62,10.47,10.54,89454796,942531006],[20130531,10.54,10.56,10.62,10.46,10.47,101875600,1074952868],[20130603,9.92,9.97,10.01,9.81,9.84,83186090,823621313],[20130604,9.84,9.89,9.89,9.7,9.74,60164557,587136100],[20130605,9.74,9.74,9.77,9.6,9.65,56405768,545296050],[20130606,9.65,9.61,9.67,9.42,9.45,72417597,688813179],[20130607,9.45,9.51,9.57,9.32,9.35,72344081,682011573],[20130613,9.35,9.25,9.25,8.91,9.02,127820275,1152185130],[20130614,9.02,9.07,9.07,8.98,9.02,77530686,699500719],[20130617,9.02,9.05,9.1,8.96,9.01,52039165,469144449],[20130618,9.01,9.05,9.12,9.01,9.07,40358845,365844138],[20130619,9.07,9.05,9.05,8.82,8.89,53104791,473179675],[20130620,8.89,8.86,8.86,8.4,8.42,137571510,1178952736],[20130621,8.42,8.31,8.47,8.22,8.28,147442615,1229287083],[20130624,8.28,8.29,8.29,7.5,7.52,249977361,1942163889],[20130625,7.52,7.45,7.84,7.18,7.8,246601203,1856925606],[20130626,7.8,7.9,7.95,7.63,7.77,130788936,1016856736],[20130627,7.77,7.85,7.92,7.7,7.88,125823284,982597070],[20130628,7.88,7.82,8.3,7.76,8.28,157753950,1276035956],[20130701,8.28,8.22,8.27,8.07,8.17,86027064,702497388],[20130702,8.17,8.18,8.22,7.95,8.15,84019573,677872934],[20130703,8.15,8.1,8.11,7.97,8.04,69690313,560255121],[20130704,8.04,8.06,8.28,8.02,8.12,85794489,697456116],[20130705,8.12,8.11,8.22,8.08,8.11,58764344,477728564],[20130708,8.11,8,8.05,7.9,7.91,63977579,508688886],[20130709,7.91,7.92,7.96,7.88,7.92,40964528,324418293],[20130710,7.92,7.95,8.13,7.9,8.11,60829122,488041464],[20130711,8.11,8.17,8.92,8.17,8.86,274152438,2369026958],[20130712,8.86,8.76,8.85,8.43,8.49,162211373,1400965676],[20130715,8.49,8.55,8.71,8.41,8.56,103850924,891216119],[20130716,8.56,8.52,8.55,8.41,8.54,78430472,664317070],[20130717,8.54,8.52,8.55,8.38,8.45,79489709,673336873],[20130718,8.45,8.41,8.45,8.16,8.2,99044377,818192316],[20130719,8.2,8.22,8.24,8.02,8.03,76242268,619426708],[20130722,8.03,7.9,7.99,7.82,7.95,95552055,754153139],[20130723,7.95,7.99,8.23,7.94,8.14,115906521,942643003],[20130724,8.14,8.04,8.09,7.9,8,87410550,697536435],[20130725,8,8.02,8.11,7.96,8.02,62010839,497968427],[20130726,8.02,7.98,8.01,7.94,7.97,42800503,341110312],[20130729,7.97,7.9,7.9,7.71,7.74,84518514,655293169],[20130730,7.74,7.78,7.96,7.74,7.84,68907635,540970736],[20130731,7.84,7.91,8.02,7.82,7.86,50335414,397874860],[20130801,7.86,7.92,8.02,7.87,7.99,58959381,469433179],[20130802,7.99,8.06,8.12,7.97,7.98,57767151,463891788],[20130805,7.98,7.98,8.07,7.95,8.06,53056118,425459707],[20130806,8.06,8.03,8.08,7.98,8.03,82798496,664260262],[20130807,8.03,8.03,8.14,8,8.01,68679917,553785268],[20130808,8.01,8.01,8.07,7.95,7.99,54611350,436833724],[20130809,7.99,8.05,8.08,7.96,8.01,55483572,444645232],[20130812,8.01,8.04,8.32,8.01,8.31,142760853,1171789122],[20130813,8.31,8.3,8.43,8.27,8.42,118672580,991814171],[20130814,8.42,8.44,8.53,8.3,8.31,121903670,1025898643],[20130815,8.31,8.31,8.37,8.2,8.22,67134769,556547154],[20130816,8.22,8.17,9.04,8.15,8.31,264712593,2254296108],[20130819,8.31,8.24,8.5,8.23,8.45,124704778,1044624757],[20130820,8.45,8.42,8.78,8.39,8.51,153605678,1314061899],[20130821,8.51,8.53,8.58,8.37,8.45,65732224,554832999],[20130822,8.45,8.41,8.62,8.4,8.44,60326480,513025402],[20130823,8.44,8.54,8.63,8.25,8.42,117530030,995509250],[20130826,8.42,8.45,8.78,8.4,8.74,161720147,1399048031],[20130827,8.74,8.75,9.05,8.7,8.95,224672933,2001682217],[20130828,8.95,8.88,9.15,8.79,9,243574963,2194823813],[20130829,9,9.11,9.21,8.86,8.92,146496955,1320039144],[20130830,8.92,8.86,9.05,8.76,8.99,129143351,1152526345],[20130902,8.99,9.11,9.29,8.95,8.97,141236900,1281805081],[20130903,8.97,8.96,9.12,8.89,9.09,140383661,1269355850],[20130904,9.09,9.04,9.24,9.03,9.14,142450054,1305299487],[20130905,9.14,9.19,9.19,9.06,9.13,93544409,852833065],[20130906,9.13,9.15,9.87,9.12,9.57,301015112,2850092331],[20130909,9.57,10.28,10.53,10.18,10.53,580189224,6069489608],[20130910,10.53,11,11.49,10.77,11.4,1198024109,13328930206],[20130911,11.4,11.21,11.47,11.2,11.27,603551016,6834516257],[20130912,11.27,11.3,12.4,11.16,12.25,1041527543,12498180262],[20130913,12.25,12.08,12.27,11.73,11.91,661646551,7947104255],[20130916,11.91,12,12.02,11.23,11.49,699493335,8064946319],[20130917,11.49,11.41,11.48,10.77,10.83,511737943,5694768142],[20130918,10.83,10.95,11.19,10.83,11,400172137,4413153554],[20130923,11,11.05,11.2,10.8,11.18,453630138,4987201249],[20130924,11.18,11.19,11.2,10.57,10.81,476900620,5154101324],[20130925,10.81,10.74,11.18,10.69,10.78,384146137,4206311478],[20130926,10.78,10.75,10.76,10.07,10.17,448493838,4639913820],[20130927,10.17,10.11,10.33,10.05,10.24,243782409,2485876805],[20130930,10.24,10.34,10.37,10.02,10.09,256510906,2609512399],[20131008,10.09,10.03,10.33,9.88,10.23,258444174,2618477427],[20131009,10.23,10.1,10.46,10.07,10.27,244015218,2503190590],[20131010,10.27,10.3,10.35,9.93,9.98,249225016,2508885945],[20131011,9.98,10.1,10.65,10,10.55,441961264,4582589758],[20131014,10.55,10.45,10.5,10.25,10.29,274009307,2834786588],[20131015,10.29,10.3,10.35,10.02,10.11,212323978,2155489652],[20131016,10.11,10.09,10.09,9.82,9.91,217322904,2160308473],[20131017,9.91,10.01,10.07,9.81,9.82,145253461,1440499464],[20131018,9.82,9.82,10.06,9.8,9.88,129849775,1290361115],[20131021,9.88,9.95,10.16,9.8,10.12,211850917,2123854885],[20131022,10.12,10.11,10.11,9.86,9.93,156011435,1554175494],[20131023,9.93,9.95,10.35,9.91,10.02,260513178,2639944209],[20131024,10.02,9.96,10.16,9.82,9.98,170003394,1700451825],[20131025,9.98,10.01,10.26,9.99,10.07,256524257,2593128919],[20131028,10.07,10.08,10.22,9.92,10.15,164098118,1650688533],[20131029,10.15,10.22,10.69,10.18,10.48,494214050,5150564497],[20131030,10.48,10.48,10.62,10.31,10.59,301165849,3162162382],[20131031,10.59,10.58,10.6,10.31,10.33,211637554,2206625469],[20131101,10.33,10.32,10.53,10.23,10.42,164057262,1704932182],[20131104,10.42,10.48,10.54,10.26,10.3,138786390,1438550559],[20131105,10.3,10.22,10.25,10.04,10.2,172536527,1747250983],[20131106,10.2,10.07,10.2,10,10.03,151026564,1522867126],[20131107,10.03,10.08,10.19,9.97,10.05,114983822,1158380382],[20131108,10.05,10.02,10.1,9.93,9.98,110388788,1104891677],[20131111,9.98,9.99,10.02,9.9,9.97,79759246,793983216],[20131112,9.97,10.01,10.19,10,10.12,119655182,1209294436],[20131113,10.12,10.04,10.05,9.63,9.64,208714474,2049839119],[20131114,9.64,9.6,9.68,9.39,9.49,169111025,1601513585],[20131115,9.49,9.49,9.85,9.48,9.68,180564555,1753424283],[20131118,9.68,9.75,10.11,9.66,10.1,231275931,2289354073],[20131119,10.1,10.1,10.1,9.95,9.97,128516630,1286050557],[20131120,9.97,10.01,10.18,9.97,10.05,125986570,1265362952],[20131121,10.05,10,10.08,9.78,10.07,172340745,1708643966],[20131122,10.07,10.05,10.11,9.98,10.06,131116961,1317526601],[20131125,10.06,9.99,10.11,9.92,9.93,96767050,967272350],[20131126,9.93,9.9,10.03,9.88,9.9,72857686,724350734],[20131127,9.9,9.87,10.08,9.76,9.93,134357122,1332415710],[20131128,9.93,9.95,10.06,9.9,9.96,121839005,1217508434],[20131129,9.96,10.06,10.12,9.96,9.99,112491968,1128740871],[20131202,9.99,10.1,10.34,9.99,10.32,408952609,4162905229],[20131203,10.32,10.27,10.34,10.14,10.26,178953713,1832350266],[20131204,10.26,10.24,10.57,10.2,10.4,283303320,2951386526],[20131205,10.4,10.4,10.44,10.28,10.35,150565456,1557557550],[20131206,10.35,10.34,10.34,10.13,10.22,157734044,1611228726],[20131209,10.22,10.21,10.25,10.08,10.11,111336390,1127426955],[20131210,10.11,10.12,10.21,10.08,10.14,89476538,907205499],[20131211,10.14,10.11,10.13,9.91,9.93,127176728,1268123946],[20131212,9.93,9.91,9.96,9.87,9.88,89839025,889730892],[20131213,9.88,9.84,9.85,9.77,9.83,98124624,963431279],[20131216,9.83,9.85,9.97,9.72,9.74,119802106,1177159749],[20131217,9.74,9.76,9.77,9.66,9.69,78126226,758108126],[20131218,9.69,9.71,9.8,9.68,9.71,55191766,536799930],[20131219,9.71,9.75,9.78,9.6,9.61,71003510,687152711],[20131220,9.61,9.63,9.64,9.34,9.36,107593841,1018130466],[20131223,9.36,9.41,9.48,9.31,9.34,63014853,590896792],[20131224,9.34,9.37,9.41,9.25,9.34,71802936,671259994],[20131225,9.34,9.33,9.35,9.15,9.27,89003265,821820569],[20131226,9.27,9.26,9.27,9.06,9.09,82518650,753839548],[20131227,9.09,9.09,9.32,9.08,9.24,88052311,811334784],[20131230,9.24,9.3,9.32,9.19,9.2,70408751,650877060],[20131231,9.2,9.21,9.53,9.17,9.43,107237045,1006340928],[20140102,9.43,9.44,9.45,9.29,9.33,69821037,652410783],[20140103,9.33,9.28,9.3,9.08,9.14,88351969,807094466],[20140106,9.14,9.31,9.34,9.13,9.19,117267700,1079925474],[20140107,9.19,9.17,9.21,9.01,9.14,72150947,657895513],[20140108,9.14,9.14,9.32,9.11,9.2,78603481,724415950],[20140109,9.2,9.2,9.44,9.16,9.29,109976763,1025797662],[20140110,9.29,9.28,9.45,9.24,9.41,93379978,875061947],[20140113,9.41,9.44,9.47,9.33,9.39,65935363,618500138],[20140114,9.39,9.4,9.43,9.25,9.4,79710266,744481149],[20140115,9.4,9.39,9.4,9.16,9.23,77606643,717370004],[20140116,9.23,9.22,9.26,9.17,9.18,67204743,618488788],[20140117,9.18,9.17,9.17,9.07,9.12,66047496,601804105],[20140120,9.12,9.1,9.13,9.04,9.07,42094792,382309899],[20140121,9.07,9.1,9.26,9.09,9.16,47596032,436604867],[20140122,9.16,9.18,9.38,9.17,9.34,91387277,849733125],[20140123,9.34,9.31,9.34,9.21,9.22,63055407,583623058],[20140124,9.22,9.17,9.32,9.14,9.23,70757205,653717695],[20140127,9.23,9.19,9.2,9.1,9.12,69858649,637844251],[20140128,9.12,9.12,9.29,9.12,9.19,57333618,527187516],[20140129,9.19,9.24,9.31,9.2,9.29,71042825,659122848],[20140130,9.29,9.27,9.3,9.15,9.17,52508927,485399532],[20140207,9.17,9.13,9.18,9.07,9.18,51136921,466080896],[20140210,9.18,9.18,9.3,9.16,9.29,91573113,848138382],[20140211,9.29,9.31,9.68,9.22,9.54,212392409,2017636446],[20140212,9.54,9.5,9.64,9.44,9.5,106449343,1012082707],[20140213,9.5,9.48,9.84,9.41,9.6,197765140,1901282553],[20140214,9.6,9.6,9.63,9.51,9.59,80503230,770860231],[20140217,9.59,9.62,9.66,9.48,9.52,107916285,1029473517],[20140218,9.52,9.51,9.51,9.23,9.26,131972251,1231564459],[20140219,9.26,9.25,9.57,9.2,9.49,150729704,1420983509],[20140220,9.49,9.53,9.73,9.36,9.39,144607391,1379086315],[20140221,9.39,9.39,9.43,9.22,9.29,82312549,765984708],[20140224,9.29,9.2,9.21,8.97,9.01,135269196,1223507891],[20140225,9.01,9.01,9.08,8.81,8.83,112988180,1012070329],[20140226,8.83,8.81,8.89,8.77,8.85,79811062,704799663],[20140227,8.85,8.9,9.03,8.81,8.94,112556009,1005356244],[20140228,8.94,8.9,9.01,8.8,8.91,75427866,671034442],[20140303,8.91,8.91,8.92,8.81,8.85,81389991,720619849],[20140304,8.85,8.84,8.91,8.68,8.87,113473857,994582737],[20140305,8.87,8.86,8.88,8.68,8.7,66776262,585846336],[20140306,8.7,8.7,8.86,8.62,8.8,105221671,920528165],[20140307,8.8,8.8,8.91,8.71,8.73,85996638,757643571],[20140310,8.73,8.67,8.71,8.42,8.44,100335990,859115769],[20140311,8.44,8.43,8.53,8.39,8.46,71119520,600753236],[20140312,8.46,8.47,8.67,8.39,8.56,110468613,942803798],[20140313,8.56,8.76,9.13,8.68,8.84,198115864,1758751742],[20140314,8.84,8.78,9.03,8.72,8.99,179769247,1602451090],[20140317,8.99,8.99,8.99,8.99,8.99,0,0],[20140318,8.99,9.22,9.23,8.87,8.89,167965350,1523657836],[20140319,8.89,8.85,9.07,8.76,9.05,93838218,832057181],[20140320,9.05,8.96,9.2,8.95,8.99,166058733,1510412577],[20140321,8.99,8.98,9.89,8.97,9.89,577730146,5543459714],[20140324,9.89,9.89,10.01,9.74,9.8,550938112,5438997560],[20140325,9.8,9.76,9.86,9.68,9.75,225324449,2201589731],[20140326,9.75,9.78,9.83,9.51,9.58,188654730,1813592755],[20140327,9.58,9.53,9.94,9.48,9.69,310183453,3020967368],[20140328,9.69,9.64,9.92,9.6,9.67,235609623,2299182855],[20140331,9.67,9.7,9.77,9.57,9.72,117957984,1139701358],[20140401,9.72,9.66,9.84,9.63,9.73,121142230,1177869503],[20140402,9.73,9.75,10.04,9.71,9.94,221487036,2188083753],[20140403,9.94,9.94,10,9.64,9.67,202589136,1988726346],[20140404,9.67,9.62,9.75,9.57,9.73,103710191,1003039509],[20140408,9.73,9.71,10.31,9.71,10.14,389948091,3925146601],[20140409,10.14,10.12,10.19,10.03,10.1,166971745,1686236313],[20140410,10.1,10.14,10.41,10.03,10.23,251774137,2565192729],[20140411,10.23,10.18,10.32,10.14,10.25,187981794,1923682586],[20140414,10.25,10.25,10.29,10.09,10.12,133566631,1356868494],[20140415,10.12,10.07,10.08,9.82,9.85,176166147,1746784882],[20140416,9.85,9.82,9.97,9.81,9.9,100765541,997304842],[20140417,9.9,9.93,9.97,9.74,9.76,147878398,1453030914],[20140418,9.76,9.73,9.81,9.63,9.78,115394462,1120720917],[20140421,9.78,9.74,9.96,9.68,9.71,131392321,1292829716],[20140422,9.71,9.68,9.92,9.66,9.9,141231411,1385544270],[20140423,9.9,9.85,10,9.83,9.88,136419564,1352733686],[20140424,9.88,9.9,9.98,9.85,9.87,82309479,815388785],[20140425,9.87,9.92,10.06,9.82,9.84,180573527,1794439412],[20140428,9.84,9.82,9.87,9.65,9.67,123425122,1198581012],[20140429,9.67,9.67,9.82,9.65,9.8,88443328,859931423],[20140430,9.8,9.98,10.02,9.76,9.77,142558919,1407065796],[20140505,9.77,9.77,9.79,9.58,9.74,103509079,1001815675],[20140506,9.74,9.7,9.8,9.67,9.7,58797626,572224197],[20140507,9.7,9.69,9.75,9.64,9.66,55972788,542274520],[20140508,9.66,9.66,9.87,9.64,9.75,95225892,930740681],[20140509,9.75,9.75,9.82,9.69,9.76,74829332,731563193],[20140512,9.76,9.85,9.96,9.79,9.93,129589586,1282666102],[20140513,9.93,9.9,9.94,9.83,9.9,66182545,653997051],[20140514,9.9,9.89,9.92,9.78,9.81,114355129,1124734340],[20140515,9.81,9.79,9.83,9.71,9.73,70426925,688077256],[20140516,9.73,9.7,9.8,9.7,9.75,57142230,556664624],[20140519,9.75,9.72,9.72,9.47,9.52,137405978,1314192261],[20140520,9.52,9.56,9.6,9.48,9.55,64057749,610778785],[20140521,9.55,9.52,9.61,9.41,9.6,54298040,517810696],[20140522,9.6,9.59,9.73,9.57,9.6,71688611,692799602],[20140523,9.6,9.61,9.7,9.59,9.7,47057342,454096750],[20140526,9.7,9.76,9.78,9.69,9.74,54108963,526560774],[20140527,9.74,9.73,9.74,9.62,9.66,74436155,720820152],[20140528,9.66,9.66,9.72,9.6,9.68,92478303,892246146],[20140529,9.68,9.68,9.72,9.6,9.62,75258524,726796770],[20140530,9.62,9.62,9.63,9.55,9.57,69096841,662738428],[20140603,9.57,9.59,9.64,9.53,9.54,70641283,677281784],[20140604,9.54,9.55,9.56,9.4,9.45,86246408,816293703],[20140605,9.45,9.45,9.63,9.43,9.62,56500335,538639270],[20140606,9.62,9.6,9.62,9.45,9.51,53426017,509267444],[20140609,9.51,9.46,9.67,9.46,9.54,58231714,557813036],[20140610,9.54,9.59,9.65,9.52,9.63,68256823,655798665],[20140611,9.63,9.59,9.63,9.55,9.59,46334806,444252120],[20140612,9.59,9.57,9.59,9.52,9.54,42917693,410062037],[20140613,9.54,9.55,9.78,9.54,9.73,129624894,1256394771],[20140616,9.73,9.73,9.87,9.69,9.81,118477367,1159724313],[20140617,9.81,9.83,9.83,9.71,9.73,91317081,892676102],[20140618,9.73,9.73,9.77,9.71,9.73,66459996,647470882],[20140619,9.73,9.74,9.81,9.6,9.64,68906460,668029792],[20140620,9.64,9.64,9.71,9.62,9.7,57665733,557096336],[20140623,9.7,9.71,9.77,9.63,9.66,86019554,834638557],[20140624,9,9.05,9.09,9.01,9.04,83305537,753572842],[20140625,9.04,9.05,9.05,8.97,8.98,46797781,421074930],[20140626,8.98,8.98,9.04,8.98,8.99,43052470,387941139],[20140627,8.99,8.99,9.02,8.96,8.97,42713239,383829267],[20140630,8.97,8.98,9.08,8.98,9.05,52645089,476195578],[20140701,9.05,9.08,9.1,9.01,9.06,42584500,385288815],[20140702,9.06,9.06,9.09,9.02,9.06,41262790,373724765],[20140703,9.06,9.06,9.09,9.03,9.07,64553232,585009384],[20140704,9.07,9.08,9.09,9.05,9.07,47263941,428330850],[20140707,9.07,9.07,9.08,9.03,9.05,42831405,387738016],[20140708,9.05,9.05,9.06,9.01,9.05,52592964,475316192],[20140709,9.05,9.05,9.05,8.91,8.92,75829647,680803744],[20140710,8.92,8.92,8.95,8.9,8.92,43284795,386256083],[20140711,8.92,8.92,8.99,8.91,8.94,58461216,523490703],[20140714,8.94,8.93,9.01,8.9,9,50192334,449273967],[20140715,9,9.01,9.02,8.98,9.01,57331618,515793884],[20140716,9.01,9.01,9.05,9,9.02,57758013,521218620],[20140717,9.02,9.03,9.04,8.97,8.99,43076122,387416765],[20140718,8.99,8.98,9.05,8.96,9.02,60143570,542519442],[20140721,9.02,9.01,9.02,8.97,8.98,43394538,390236857],[20140722,8.98,8.96,9.1,8.96,9.06,101186449,915202973],[20140723,9.06,9.04,9.14,9.04,9.08,95071892,864070613],[20140724,9.08,9.09,9.38,9.09,9.32,235007435,2179260251],[20140725,9.32,9.38,9.44,9.3,9.39,134460946,1259192307],[20140728,9.39,9.44,9.83,9.44,9.76,315856664,3067199388],[20140729,9.76,9.8,9.88,9.72,9.78,203049428,1989649789],[20140730,9.78,9.89,9.92,9.67,9.71,182728243,1785992158],[20140731,9.71,9.69,9.81,9.66,9.8,113003643,1098506207],[20140801,9.8,9.77,9.96,9.74,9.76,199316283,1966817233],[20140804,9.76,9.82,9.94,9.73,9.92,167001355,1646470442],[20140805,9.92,9.92,9.95,9.8,9.87,116942080,1154644403],[20140806,9.87,9.83,9.83,9.66,9.74,134531042,1309646598],[20140807,9.74,9.75,9.78,9.55,9.56,141244203,1363312806],[20140808,9.56,9.56,9.6,9.5,9.54,120982762,1154961190],[20140811,9.54,9.57,9.73,9.57,9.7,99902317,966146824],[20140812,9.7,9.69,9.7,9.6,9.64,80856190,779243625],[20140813,9.64,9.64,9.68,9.53,9.61,97201687,932751444],[20140814,9.61,9.63,9.68,9.58,9.6,102325664,986409896],[20140815,9.6,9.63,9.7,9.58,9.68,83507836,806096135],[20140818,9.68,9.69,9.81,9.67,9.72,96111663,933999548],[20140819,9.72,9.78,9.78,9.64,9.71,99796164,968114276],[20140820,9.71,9.71,9.71,9.63,9.64,70135543,677452354],[20140821,9.64,9.64,9.65,9.43,9.5,118057183,1123688998],[20140822,9.5,9.5,9.58,9.47,9.54,76885741,733185581],[20140825,9.54,9.52,9.53,9.42,9.44,90596114,856940044],[20140826,9.44,9.43,9.5,9.41,9.46,85213616,804802442],[20140827,9.46,9.45,9.5,9.43,9.45,54628769,516864196],[20140828,9.45,9.45,9.45,9.36,9.36,70289162,661133087],[20140829,9.36,9.4,9.48,9.36,9.47,53881605,507394707],[20140901,9.47,9.49,9.52,9.44,9.49,68578076,650654489],[20140902,9.49,9.51,9.63,9.46,9.6,128705724,1227884244],[20140903,9.6,9.63,9.74,9.62,9.68,128588110,1244849632],[20140904,9.68,9.7,9.72,9.63,9.71,98919202,956753811],[20140905,9.71,9.73,9.78,9.69,9.74,126925907,1234561990],[20140909,9.74,9.75,9.82,9.68,9.7,123866063,1205605803],[20140910,9.7,9.65,9.66,9.57,9.59,111659515,1073076812],[20140911,9.59,9.6,9.73,9.57,9.6,119763193,1152958001],[20140912,9.6,9.61,9.61,9.53,9.6,80296496,768304362],[20140915,9.6,9.56,9.64,9.51,9.6,99444466,950656348],[20140916,9.6,9.65,9.76,9.59,9.62,222751521,2154511976],[20140917,9.62,9.63,9.66,9.53,9.57,116577448,1116528160],[20140918,9.57,9.56,9.75,9.53,9.73,218993865,2119148592],[20140919,9.73,9.72,9.91,9.7,9.85,286004782,2816151314],[20140922,9.85,9.83,9.83,9.61,9.61,155546883,1505934022],[20140923,9.61,9.61,9.69,9.6,9.63,88224150,850252148],[20140924,9.63,9.61,9.79,9.59,9.76,152637326,1480725849],[20140925,9.76,9.79,9.83,9.68,9.71,137216320,1340440535],[20140926,9.71,9.69,9.74,9.64,9.72,80598327,781818068],[20140929,9.72,9.75,9.81,9.72,9.76,121763013,1188241034],[20140930,9.76,9.78,9.8,9.7,9.75,105093276,1023862494],[20141008,9.75,9.78,9.85,9.73,9.84,142724444,1398725077],[20141009,9.84,9.85,9.94,9.81,9.85,130968217,1293022527],[20141010,9.85,9.8,9.91,9.77,9.83,133030186,1308626408],[20141013,9.83,9.79,9.83,9.68,9.73,109831220,1069089803],[20141014,9.73,9.72,9.82,9.69,9.72,84002904,818017648],[20141015,9.72,9.72,9.85,9.64,9.79,133922265,1304901629],[20141016,9.79,9.74,10.04,9.7,9.89,296366859,2936900132],[20141017,9.89,9.88,10,9.75,9.85,161019857,1588282410],[20141020,9.85,9.93,9.95,9.82,9.9,114718758,1133473887],[20141021,9.9,9.89,9.91,9.76,9.78,105290636,1034461912],[20141022,9.78,9.79,9.88,9.75,9.78,91092137,893481676],[20141023,9.78,9.78,9.88,9.72,9.75,118416324,1159897472],[20141024,9.75,9.77,9.79,9.66,9.68,108312657,1054022659],[20141027,9.68,9.62,9.63,9.4,9.47,138929487,1323460330],[20141028,9.47,9.5,9.61,9.5,9.59,101044054,965189350],[20141029,9.59,9.61,9.75,9.57,9.7,161050635,1555124009],[20141030,9.7,9.72,9.85,9.65,9.81,176780522,1722710639],[20141031,9.81,9.88,10.38,9.85,10.2,491064711,4953082712],[20141103,10.2,10.25,10.28,10.1,10.16,248371619,2525984147],[20141104,10.16,10.2,10.2,10.02,10.07,163212641,1645394573],[20141105,10.07,10.08,10.11,9.96,9.99,157561422,1578932517],[20141106,9.99,10.01,10.04,9.95,10.03,101863094,1018619320],[20141107,10.03,10.01,10.39,9.98,10.18,407114119,4155058255],[20141110,10.18,10.53,10.81,10.42,10.55,489376864,5168943744],[20141111,10.55,10.62,11.26,10.62,10.92,653738973,7163875483],[20141112,10.92,10.85,11.07,10.74,11.05,271038574,2961655250],[20141113,11.05,11.1,11.38,10.86,10.94,371263986,4115769395],[20141114,10.94,10.88,10.98,10.75,10.9,198414346,2154897404],[20141117,10.9,10.94,11.08,10.73,10.75,214519835,2329015774],[20141118,10.75,10.75,10.8,10.43,10.45,254900899,2687326957],[20141119,10.45,10.43,10.54,10.39,10.47,145326646,1518565385],[20141120,10.47,10.45,10.66,10.37,10.57,162402495,1709647461],[20141121,10.57,10.58,10.82,10.46,10.79,209997641,2234174865],[20141124,10.79,10.57,10.99,10.45,10.86,474049927,5090821659],[20141125,10.86,10.81,11.09,10.75,11.08,289490093,3159162410],[20141126,11.08,11.25,11.43,11.1,11.32,452263345,5092828904],[20141127,11.32,11.48,11.72,11.28,11.48,439738276,5062406815],[20141128,11.48,11.53,12.48,11.48,12.4,832183256,9950390236],[20141201,12.4,12.45,12.98,12.12,12.16,607270363,7590567304],[20141202,12.16,12.03,13.08,12.03,12.87,589371031,7404591089],[20141203,12.87,12.84,13.29,12.32,12.58,730561448,9380076839],[20141204,12.58,12.58,13.3,12.37,13.27,720041669,9307946036],[20141205,13.27,13.42,14,12.9,13.53,859647616,11553890777],[20141208,13.53,13.39,14.04,13.2,13.81,703922500,9622363300],[20141209,13.81,13.56,14.16,12.46,12.65,869193775,11788051418],[20141210,12.65,12.7,13.25,12.21,13.16,620272395,7901267906],[20141211,13.16,12.96,13.55,12.85,13.05,442571181,5847503446],[20141212,13.05,13.05,13.38,12.78,12.98,310558743,4067040277],[20141215,12.98,12.8,12.82,12.46,12.76,335025414,4232421865],[20141216,12.76,12.7,13.3,12.65,13.29,438688005,5706439860],[20141217,13.29,13.49,14.39,13.33,14.11,869703585,12037657249],[20141218,14.11,14.22,14.34,13.71,13.89,499627853,7010664184],[20141219,13.89,13.96,14.2,13.63,14.09,436244208,6099396161],[20141222,14.09,14.18,15.2,14.14,14.68,683449513,10043569171],[20141223,14.68,14.4,14.98,14.08,14.11,441578783,6398625351],[20141224,14.11,14.11,14.2,13.31,13.46,417579539,5715187854],[20141225,13.46,13.75,14.27,13.53,14.25,455721907,6359588287],[20141226,14.25,14.3,14.84,14.19,14.77,466983121,6790353352],[20141229,14.77,15.4,15.88,14.71,14.95,625216146,9556435997],[20141230,14.95,14.95,15.5,14.83,15.36,443655559,6774519460],[20141231,15.36,15.45,15.79,15.11,15.69,468832339,7271524766],[20150105,15.69,15.88,16.25,15.56,16.07,513568709,8182820911],[20150106,16.07,16,16.68,15.82,16.13,511684535,8311084820],[20150107,16.13,15.9,16.17,15.53,15.81,385716820,6114241100],[20150108,15.81,15.87,15.88,15.2,15.25,330627172,5101310595],[20150109,15.25,15.2,16.25,15.11,15.43,491999937,7692348549],[20150112,15.43,15.5,15.71,14.95,15.22,367787269,5625726993],[20150113,15.22,15.13,15.41,15.1,15.18,178404956,2712026682],[20150114,15.18,15.31,15.79,15.31,15.49,309018855,4812472304],[20150115,15.49,15.49,16.15,15.39,16.12,329826849,5216166778],[20150116,16.12,16.24,16.75,16.16,16.47,480245887,7938757902],[20150119,16.47,15.38,15.73,14.82,14.82,623520880,9496942743],[20150120,14.82,14.88,15.17,14.58,15,479215741,7142638836],[20150121,15,15.1,15.87,14.81,15.74,487540369,7489943294],[20150122,15.74,15.73,15.76,15.35,15.63,294738261,4592022934],[20150123,15.63,15.74,16.04,15.54,15.63,320042992,5044685774],[20150126,15.63,15.56,15.59,15.13,15.43,268566922,4122351608],[20150127,15.43,15.44,15.44,14.75,15.01,351914010,5286301699],[20150128,15.01,14.82,15.11,14.66,14.81,242203054,3592645043],[20150129,14.81,14.58,14.68,14.32,14.42,266968083,3864614152],[20150130,14.42,14.58,14.69,14.36,14.47,207865327,3021747775],[20150202,14.47,14.06,14.26,13.99,14.04,211617677,2989272548],[20150203,14.04,14.21,14.46,14.02,14.45,196263569,2792706733],[20150204,14.45,14.5,14.59,14.12,14.18,167896219,2421384723],[20150205,14.18,14.75,14.8,14.17,14.18,394332692,5742890408],[20150206,14.18,14.09,14.32,13.95,14.09,186547522,2637143942],[20150209,14.09,14.06,14.27,13.85,14.16,224585511,3155932084],[20150210,14.16,14.15,14.48,14.08,14.43,183693513,2629916390],[20150211,14.43,14.43,14.54,14.31,14.42,124127097,1789572963],[20150212,14.42,14.42,14.43,14.11,14.35,148954152,2121808297],[20150213,14.35,14.5,14.67,14.35,14.43,208366810,3023274166],[20150216,14.43,14.43,14.46,14.26,14.4,139220024,1995677496],[20150217,14.4,14.42,14.58,14.41,14.47,120665263,1747213085],[20150225,14.47,14.48,14.5,14.18,14.28,140932583,2025174378],[20150226,14.28,14.25,14.68,14.11,14.62,215013978,3104052166],[20150227,14.62,14.6,14.8,14.48,14.53,195606870,2861206457],[20150302,14.53,14.58,14.58,14.36,14.48,218763276,3159377729],[20150303,14.48,14.44,14.44,13.98,14,266372415,3766071237],[20150304,14,14.05,14.07,13.85,13.91,156595995,2183814569],[20150305,13.91,13.84,13.84,13.51,13.58,226504580,3090569665],[20150306,13.58,13.58,13.78,13.54,13.63,128036367,1750570352],[20150309,13.63,13.81,14.7,13.61,14.51,434801476,6170955159],[20150310,14.51,14.32,14.37,14.07,14.1,254844764,3623305559],[20150311,14.1,14.17,14.56,14.17,14.25,215069722,3087509382],[20150312,14.25,14.65,15.56,14.58,15.12,632781877,9512030471],[20150313,15.12,15.19,15.8,15.08,15.29,440178379,6789040866],[20150316,15.29,15.56,15.61,15.2,15.47,316116667,4867224356],[20150317,15.47,15.6,15.68,15.36,15.54,309677645,4797833475],[20150318,15.54,15.57,15.88,15.43,15.88,354655138,5558613435],[20150319,15.88,15.88,15.89,15.58,15.64,316770912,4978776033],[20150320,15.64,15.62,16.09,15.37,15.75,456531222,7180731346],[20150323,15.75,15.82,16.04,15.77,15.91,357592740,5692415845],[20150324,15.91,15.89,16,15.6,15.69,324657542,5114146783],[20150325,15.69,15.6,15.72,15.15,15.24,331730332,5108990851],[20150326,15.24,15.15,15.58,15.04,15.36,282340713,4326755744],[20150327,15.36,15.32,15.55,15.17,15.36,218174978,3350088365],[20150330,15.36,15.55,16.2,15.44,16.02,487442660,7735007517],[20150331,16.02,16.48,16.58,15.74,15.79,494049254,7990395333],[20150401,15.79,15.79,16.14,15.75,15.95,305878383,4868332118],[20150402,15.95,16.3,16.38,15.87,16.18,410087652,6611462332],[20150403,16.18,16,16.29,15.93,16.2,320361507,5171219071],[20150407,16.2,16.5,16.87,16.45,16.71,502260203,8372655104],[20150408,16.71,16.73,17.04,16.45,17.02,514816375,8633478020],[20150409,17.02,17.05,17.48,16.8,16.87,497335458,8497436086],[20150410,16.87,16.86,17.57,16.76,17.53,451543445,7772119507],[20150413,17.53,17.99,18.48,17.62,18.03,581406595,10470524484],[20150414,18.03,18.03,18.04,17.56,17.89,372837061,6640484668],[20150415,17.89,17.8,18.45,17.71,17.96,449643905,8170773646],[20150416,17.96,17.97,18.67,17.85,18.65,415984573,7577393009],[20150417,18.65,18.95,19.05,18.47,18.6,490159321,9167362860],[20150420,18.6,18.72,18.72,17.6,17.9,572435809,10446728565],[20150421,17.9,17.75,18.19,17.75,18.16,368194681,6615540644],[20150422,18.16,18.3,18.55,18.08,18.5,420766743,7712130682],[20150423,18.5,18.5,18.64,18.11,18.22,363593631,6675541987],[20150424,18.22,17.8,18.03,17.46,17.68,422927109,7509013285],[20150427,17.68,17.72,18.25,17.72,18.17,384541412,6942247859],[20150428,18.17,18.24,19,18,18.3,600053990,11100683779],[20150429,18.3,18.27,18.66,18.06,18.53,358393731,6591914895],[20150430,18.53,18.28,18.46,18.05,18.07,412760522,7523663257],[20150504,18.07,18,18,17.6,17.81,258064565,4597698886],[20150505,17.81,17.73,17.75,16.85,17.08,375386437,6483575960],[20150506,17.08,17.08,17.51,16.97,17.06,303607877,5225100162],[20150507,17.06,17.03,17.28,16.98,17.07,214390703,3674226153],[20150508,17.07,17.19,17.3,16.82,17.11,18456e4,3151167765],[20150511,17.11,16.98,17.31,16.79,17.27,277153427,4711900631],[20150512,17.27,17.25,17.4,17.04,17.24,219176341,3768388795],[20150513,17.24,17.33,17.39,16.9,17.07,245244498,4198950106],[20150514,17.07,17.1,17.25,16.94,16.99,192361949,3283133222],[20150515,16.99,16.91,17.07,16.59,16.78,209597267,3526291462],[20150518,16.78,16.62,16.76,16.34,16.38,187555204,3106379587],[20150519,16.38,16.37,17.09,16.35,17.04,242251271,4080429264],[20150520,17.04,17.04,17.49,16.97,17.15,265675717,4567803884],[20150521,17.15,17.25,17.4,17.1,17.32,166403483,2873100257],[20150522,17.32,17.46,17.79,17.34,17.76,248087543,4379120076],[20150525,17.76,17.85,18.18,17.84,18.14,273874763,4942207005],[20150526,18.14,18.22,18.45,17.91,18.39,301665297,5504873384],[20150527,18.39,18.44,18.65,18.05,18.07,296942307,5444651111],[20150528,18.07,18.1,18.14,17.01,17.04,334032210,5908534663],[20150529,17.04,17.08,17.35,16.71,17.04,256087315,4370819052],[20150601,17.04,17.04,18.08,16.86,17.93,286379255,5015007440],[20150602,17.93,17.93,17.97,17.5,17.84,224935535,4001574466],[20150603,17.84,17.89,18.05,17.54,17.9,244139688,4338757668],[20150604,17.9,18,18.8,17.58,18.63,471864928,8635099296],[20150605,18.63,19,19.17,18.02,18.43,362420155,6742853974],[20150608,18.43,18.43,18.43,18.43,18.43,0,0],[20150609,18.43,18.43,18.43,18.43,18.43,0,0],[20150610,18.43,18.43,18.43,18.43,18.43,0,0],[20150611,18.43,18.43,18.43,18.43,18.43,0,0],[20150612,18.43,18.43,18.43,18.43,18.43,0,0],[20150615,18.43,18.43,18.43,18.43,18.43,0,0],[20150616,18.43,18.43,18.43,18.43,18.43,0,0],[20150617,18.43,18.49,18.98,17.95,18.2,513118652,9419105681],[20150618,18.2,18.09,18.25,17.64,17.72,278296731,4980064847],[20150619,17.72,17.58,17.95,16.84,17.07,278090221,4894778628],[20150623,16.31,16.45,17.09,16.24,17.02,297748888,4966949468],[20150624,17.02,17.03,17.3,16.58,17.25,257825317,4364353264],[20150625,17.25,17.6,17.74,16.65,16.71,271649032,4704733126],[20150626,16.71,16.43,17.08,15.33,15.85,361776730,5893832505],[20150629,15.85,16.3,16.53,14.81,15.91,420675691,6723071040],[20150630,15.91,15.93,16.98,15.91,16.96,375411270,6204981732],[20150701,16.96,16.81,16.93,16.2,16.32,250555997,4180149244],[20150702,16.32,16.5,16.83,15.81,16.37,322264859,5297602404],[20150703,16.37,16.39,16.64,15.1,15.87,312701072,5041249946],[20150706,15.87,17.4,17.46,16.63,17.22,659421895,11195522994],[20150707,17.22,16.94,17.82,16.46,17.57,713763502,12379048406],[20150708,17.57,16.2,17.5,15.81,15.95,837950419,13833635468],[20150709,15.95,15.95,17.4,15.38,16.95,545237273,8927542091],[20150710,16.95,16.76,18.15,16.65,17.28,647768569,11376342740],[20150713,17.28,16.99,17.48,16.81,17.04,372594650,6364720151],[20150714,17.04,16.78,16.98,16.36,16.75,305725800,5111292893],[20150715,16.75,16.7,17.13,16.51,17.07,348253550,5845359e3],[20150716,17.07,17.07,17.12,16.71,16.96,181402598,3069471172],[20150717,16.96,17.03,17.19,16.88,17.02,195927578,3336786144],[20150720,17.02,17,17.03,16.65,16.68,172918155,2908824607],[20150721,16.68,16.58,16.72,16.3,16.38,156268261,2572676436],[20150722,16.38,16.33,16.38,16.15,16.16,120352700,1956978868],[20150723,16.16,16.24,16.51,16.18,16.43,114525468,1878869159],[20150724,16.43,16.43,16.49,16.13,16.14,123609179,2016987556],[20150727,16.14,16,16.1,14.84,14.91,225091581,3515372642],[20150728,14.91,14.68,15.4,14.62,15.24,246095094,3717225976],[20150729,15.24,15.22,15.3,15.12,15.29,135858697,2063868116],[20150730,15.29,15.29,15.36,14.88,14.9,118921723,1807407771],[20150731,14.9,14.97,15.16,14.65,15.07,234941266,3516273899],[20150803,15.07,14.99,15.6,14.86,15.55,212367132,3246435574],[20150804,15.55,15.48,15.67,15.38,15.62,85154364,1320992960],[20150805,15.62,15.6,15.64,15.27,15.31,58185882,899150924],[20150806,15.31,15.16,15.57,15.14,15.38,65377995,1007550209],[20150807,15.38,15.58,15.64,15.39,15.47,65302258,1014250620],[20150810,15.47,15.45,15.86,15.35,15.78,116938205,1823776978],[20150811,15.78,15.7,15.75,15.51,15.57,105104123,1642256846],[20150812,15.57,15.4,15.6,15.38,15.39,79184358,1225370347],[20150813,15.39,15.47,15.56,15.29,15.45,74034209,1141661419],[20150814,15.45,15.47,15.54,15.37,15.49,66356010,1025758702],[20150817,15.49,15.41,15.41,15.22,15.32,120892083,1851641790],[20150818,15.32,15.35,15.52,14.83,14.87,198445221,3032249668],[20150819,14.87,14.87,15.17,14.5,15,199062097,2952584751],[20150820,15,14.94,14.99,14.66,14.68,88124782,1309322551],[20150821,14.68,14.61,14.74,14.2,14.22,123792817,1794884637],[20150824,14.22,13.93,13.95,12.8,12.87,334859429,4407389496],[20150825,12.87,12.54,13.08,11.91,12.39,289470686,3659079619],[20150826,12.39,12.65,13.35,12.4,13.02,235214588,3028238686],[20150827,13.02,13.16,14.09,12.98,13.98,212008806,2835655224],[20150828,13.98,14.1,14.32,13.85,14.24,208950955,2942159406],[20150831,14.24,14.2,14.98,13.96,14.96,202628515,2902670628],[20150901,14.96,14.66,15.34,14.41,15.33,304904688,4572547207],[20150902,15.33,14.9,15.37,14.72,14.89,255045273,3831534739],[20150907,14.89,14.73,15.01,14.16,14.5,287948628,4206785571],[20150908,14.5,14.52,15.16,14.22,15.06,330814193,4893450790],[20150909,15.06,14.91,15.27,14.91,15.16,241917533,3653652169],[20150910,15.16,15.06,15.27,14.96,15.25,205749026,3113080980],[20150911,15.25,15.35,15.66,15.3,15.56,288708558,4469128138],[20150914,15.56,15.5,15.95,14.93,15.93,183936607,2836987910],[20150915,15.93,15.53,15.55,15.24,15.46,107602458,1658227600],[20150916,15.46,15.31,15.8,15.03,15.43,74128982,1135218748],[20150917,15.43,15.34,15.46,15.1,15.11,50848655,778452708],[20150918,15.11,15.16,15.29,15.02,15.03,40899248,619915754],[20150921,15.03,14.96,15.08,14.84,14.97,40488316,604842e3],[20150922,14.97,14.97,15.23,14.97,15.05,38673835,584644943],[20150923,15.05,14.91,15,14.68,14.95,54580634,810914239],[20150924,14.95,14.95,15.3,14.87,15.27,78862572,1192962812],[20150925,15.27,15.15,15.62,15.15,15.59,136070895,2096781866],[20150928,15.59,15.55,15.96,15.42,15.92,91425816,1436492503],[20150929,15.92,15.79,15.99,15.67,15.97,114190253,1807681575],[20150930,15.97,15.95,16.65,15.9,16.63,211038123,3452096800],[20151008,16.63,16.8,16.8,15.83,15.87,140057148,2277284657],[20151009,15.87,15.97,16.15,15.85,15.9,41525835,663144753],[20151012,15.9,15.9,16.25,15.73,16.06,93633306,1497165793],[20151013,16.06,15.98,16.11,15.85,15.97,54698799,873290852],[20151014,15.97,15.81,16.09,15.81,15.9,44297812,706211867],[20151015,15.9,15.9,15.9,15.9,15.9,0,0],[20151016,15.9,15.9,15.9,15.9,15.9,0,0],[20151019,15.9,15.9,15.9,15.9,15.9,0,0],[20151020,15.9,15.9,15.9,15.9,15.9,0,0],[20151021,15.9,15.9,15.9,15.9,15.9,0,0],[20151022,15.9,15.9,15.9,15.9,15.9,0,0],[20151023,15.9,15.9,15.9,15.9,15.9,0,0],[20151026,15.9,16.03,16.57,16.03,16.28,101041055,1648965008],[20151027,16.28,16.23,16.45,16.15,16.32,74933996,1223267248],[20151028,16.32,16.26,16.54,16.09,16.31,74226285,1217460775],[20151029,16.31,16.3,16.63,16.23,16.59,75760565,1251114542],[20151030,16.59,16.5,16.68,16.38,16.39,45465414,750144861],[20151102,16.39,16.3,16.52,16.22,16.41,38122791,625014482],[20151103,16.41,16.4,16.77,16.37,16.46,60485065,1005503941],[20151104,16.46,16.43,16.92,16.43,16.84,65053992,1086409869],[20151105,16.84,16.85,18.07,16.75,17.71,231799691,4077390381],[20151106,17.71,17.52,18.18,17.51,17.88,127594225,2277276146],[20151109,17.88,17.92,19.19,17.88,18.15,157820058,2925510320],[20151110,18.15,18,18.69,17.82,18.37,140427138,2575229758],[20151111,18.37,18.41,18.49,17.5,17.73,92130221,1643831042],[20151112,17.73,17.8,17.83,17.15,17.36,77790159,1353612961],[20151113,17.36,17.2,17.6,17.15,17.58,73433156,1283306200],[20151116,17.58,17.34,17.58,17.2,17.42,45144666,785563829],[20151117,17.42,17.46,17.81,17.42,17.44,63539278,1119712536],[20151118,17.44,17.47,17.68,17.24,17.39,57584578,1003785434],[20151119,17.39,17.3,17.99,17.3,17.9,102543449,1821483172],[20151120,17.9,17.81,18.63,17.78,18.47,148206210,2733449298],[20151123,18.47,18.51,19.13,18.44,19.06,171203791,3235638652],[20151124,19.06,18.9,19.12,18.59,19.05,129389144,2437634483],[20151125,19.05,18.9,19.68,18.44,19.67,326524776,6295983533],[20151126,19.67,19.5,19.7,19.2,19.37,214944239,4187889901],[20151127,19.37,19.16,19.42,18.4,18.53,105608733,1999981226],[20151130,18.53,18.44,18.81,17.6,18.65,97633827,1779188257],[20151201,18.65,18.35,19,18.08,18.66,63430576,1179526363],[20151202,18.66,18.51,20,18.48,19.85,153608076,2972238980],[20151203,19.85,19.7,19.77,19.22,19.25,110346329,2147606954],[20151204,19.25,19.27,19.27,18.69,18.71,70275848,1331588236],[20151207,18.71,18.71,19.5,18.71,19.45,83346816,1592198369],[20151208,19.45,19.28,20.12,18.81,20.1,239884949,4764109259],[20151209,20.1,19.58,19.58,19.11,19.23,92049465,1776578423],[20151210,19.23,19.34,19.88,19.11,19.27,57091310,1108934588],[20151211,19.27,19.01,19.22,18.43,18.6,87066826,1630390309],[20151214,18.6,18.31,18.63,18.03,18.45,70736958,1290712912],[20151215,18.45,18.44,18.82,18.17,18.31,51685772,950672911],[20151216,18.31,18.36,18.45,18.11,18.18,38700640,705621171],[20151217,18.18,18.26,18.61,18.2,18.49,53304071,983362559],[20151218,18.49,18.49,19.8,18.43,18.81,92211924,1753311888],[20151221,18.81,18.79,19.4,18.54,19.14,82490082,1567681249],[20151222,19.14,19.01,19.29,18.77,18.9,53122744,1006796481],[20151223,18.9,18.91,19.13,18.61,18.88,66128171,1249610550],[20151224,18.88,18.85,19.14,18.67,19.04,57171554,1083459057],[20151225,19.04,19.02,19.48,18.93,19.32,55427897,1069153871],[20151228,19.32,19.37,19.43,18.62,18.7,49980698,945164680],[20151229,18.7,18.63,18.92,18.39,18.74,47288465,883333858],[20151230,18.74,18.71,18.78,18.31,18.57,35687385,660326971],[20151231,18.57,18.52,18.52,18.26,18.27,27936138,513758894],[20160104,18.27,18.28,18.28,17.55,17.8,42240610,754425783],[20160105,17.8,17.51,18.06,17.4,17.96,58054793,1034181474],[20160106,17.96,17.9,18.14,17.69,18.1,46772653,838667398],[20160107,18.1,17.8,17.9,17.4,17.51,11350479,199502702],[20160108,17.51,17.74,17.88,16.91,17.49,71918296,1262105060],[20160111,17.49,17.21,17.45,16.96,17.05,90177135,1550155933],[20160112,17.05,17.17,17.52,17.08,17.45,55374454,964061502],[20160113,17.45,17.57,17.9,17.35,17.39,47869312,843717365],[20160114,17.39,17,17.99,16.89,17.92,54838833,966117848],[20160115,17.92,17.8,18.15,17.52,17.58,46723139,836146426],[20160118,17.58,17.43,17.99,17.32,17.68,32729006,583291559],[20160119,17.68,17.78,17.88,17.5,17.77,29807159,527753175],[20160120,17.77,17.61,17.7,17.08,17.25,35968636,623546924],[20160121,17.25,17.22,17.46,16.5,16.58,34197115,582845476],[20160122,16.58,16.84,17.11,16.49,17.02,42007318,708179241],[20160125,17.02,17,17.17,16.72,17.03,23558971,400445071],[20160126,17.03,16.96,17.14,16.4,16.66,38279766,643611762],[20160127,16.66,16.75,16.98,16.51,16.68,44291307,742640743],[20160128,16.68,16.76,16.82,15.88,16.58,38902180,643984171],[20160129,16.58,16.52,17.05,16.41,16.9,47429e3,799493381],[20160201,16.9,16.99,17,16.41,16.5,29139596,485275132],[20160202,16.5,16.5,16.94,16.46,16.76,25380981,425396889],[20160203,16.76,16.6,16.66,16.45,16.61,27779183,459255616],[20160204,16.61,16.84,17.32,16.63,17.3,47162860,799283799],[20160205,17.3,17.24,18.39,17.15,18.38,78413454,1401156041],[20160215,18.38,17.98,18.48,17.8,18.45,67296317,1221398339],[20160216,18.45,18.45,18.45,18.45,18.45,0,0],[20160217,18.45,18.45,18.45,18.45,18.45,0,0],[20160218,18.45,18.45,18.45,18.45,18.45,0,0],[20160219,18.45,18.45,18.45,18.45,18.45,0,0],[20160222,18.45,18.45,18.45,18.45,18.45,0,0],[20160223,18.45,18.45,18.45,18.45,18.45,0,0],[20160224,18.45,18.45,18.45,18.45,18.45,0,0],[20160225,18.45,18.45,18.45,18.45,18.45,0,0],[20160226,18.45,18.45,18.45,18.45,18.45,0,0],[20160229,18.45,18.45,18.45,18.45,18.45,0,0],[20160301,18.45,18.45,18.45,18.45,18.45,0,0],[20160302,18.45,18.45,18.45,18.45,18.45,0,0],[20160303,18.45,18.45,18.45,18.45,18.45,0,0],[20160304,18.45,18.45,18.45,18.45,18.45,0,0],[20160307,18.45,18.45,18.45,18.45,18.45,0,0],[20160308,18.45,18.45,18.45,18.45,18.45,0,0],[20160309,18.45,18.45,18.45,18.45,18.45,0,0],[20160310,18.45,18.45,18.45,18.45,18.45,0,0],[20160311,18.45,17.51,17.53,16.61,16.97,98240322,1657158636],[20160314,16.97,16.88,17.47,16.82,16.86,56922239,973317374],[20160315,16.86,16.95,17.19,16.81,17.02,37540932,638223050],[20160316,17.02,16.92,18.07,16.91,18.03,108404378,1924212601],[20160317,18.03,17.81,18.19,17.45,17.7,68635812,1219236346],[20160318,17.7,17.79,18,17.65,17.84,55987968,996332597],[20160321,17.84,17.78,18.25,17.78,18.06,42001532,756966797],[20160322,18.06,18.09,18.63,18.02,18.15,43760811,800814893],[20160323,18.15,18.16,18.35,18.06,18.13,27830795,506023215],[20160324,18.13,18.11,18.11,17.68,17.72,27448272,488313660],[20160325,17.72,17.72,17.87,17.68,17.74,13619185,241971869],[20160328,17.74,17.78,18,17.37,17.45,24521696,433449200],[20160329,17.45,17.53,17.66,17.37,17.45,19151152,335806206],[20160330,17.45,17.65,17.95,17.65,17.87,35562148,634175207],[20160331,17.87,17.98,18.08,17.72,17.93,23762112,425380429],[20160401,17.93,17.98,18.25,17.61,18.18,35790541,643979468],[20160405,18.18,17.94,18.29,17.76,18.17,42622297,768010128],[20160406,18.17,18.03,18.14,17.87,17.96,23428724,421234846],[20160407,17.96,17.95,18,17.63,17.69,29047713,516129852],[20160408,17.69,17.56,17.76,17.53,17.6,17132244,301704521],[20160411,17.6,17.6,17.82,17.55,17.67,24117635,426862387],[20160412,17.67,17.69,17.7,17.53,17.62,14100759,248002295],[20160413,17.62,17.73,17.99,17.69,17.74,35189716,627667715],[20160414,17.74,17.9,18.01,17.75,17.8,15796208,281977244],[20160415,17.8,17.95,18.06,17.8,17.89,34773526,623836222],[20160418,17.89,17.75,18.03,17.66,17.81,28084133,501790676],[20160419,17.81,17.95,17.98,17.78,17.9,27246371,487095912],[20160420,17.9,17.89,17.99,17.31,17.96,46614611,825437834],[20160421,17.96,17.82,18.35,17.75,18.12,48212915,872382605],[20160422,18.12,18,18.36,17.94,18.24,28178162,513194655],[20160425,18.24,18.15,18.16,17.82,17.88,24294360,435467860],[20160426,17.88,17.87,18.08,17.75,17.92,15739400,281501388],[20160427,17.92,17.97,17.97,17.8,17.86,13838875,247622905],[20160428,17.86,17.93,18.1,17.83,17.9,15728417,282201353],[20160429,17.9,17.83,17.94,17.75,17.83,23065933,412460987],[20160503,17.83,17.95,18.24,17.83,18.12,27776723,501830132],[20160504,18.12,18.06,18.23,18.02,18.08,23118959,418592994],[20160505,18.08,18.06,18.12,17.98,18.06,14936632,269576075],[20160506,18.06,18.07,18.1,17.71,17.73,23406763,418454827],[20160509,17.73,17.71,17.8,17.4,17.51,21947591,386423417],[20160510,17.51,17.38,17.56,17.38,17.48,16846648,294675478],[20160511,17.48,17.55,17.57,17.4,17.45,11941164,208655785],[20160512,17.45,17.43,17.5,17.2,17.41,14668954,254410730],[20160513,17.41,17.37,17.46,17.22,17.24,11013829,190929402],[20160516,17.24,17.23,17.35,17.21,17.29,11045624,190872655],[20160517,17.29,17.29,17.34,17.16,17.25,9765153,168387277],[20160518,17.25,17.25,17.62,17.02,17.56,30962453,536935470],[20160519,17.56,17.44,17.49,17.33,17.35,10380826,180686332],[20160520,17.35,17.31,17.5,17.27,17.45,11140621,194223009],[20160523,17.45,17.5,17.68,17.44,17.55,14080659,247441303],[20160524,17.55,17.48,17.6,17.43,17.55,10725938,187905438],[20160525,17.55,17.68,17.73,17.6,17.67,13766238,243549455],[20160526,17.67,17.65,17.86,17.65,17.7,11065062,196266938],[20160527,17.7,17.69,17.77,17.63,17.74,11621242,205801175],[20160530,17.74,17.84,17.97,17.68,17.95,17538184,313324795],[20160531,17.95,17.93,18.4,17.92,18.29,35631526,650177320],[20160601,18.29,18.3,18.35,18.13,18.19,18312424,333790682],[20160602,18.19,18.2,18.3,17.93,18.02,17786525,321768768],[20160603,18.02,18.12,18.13,17.9,18.01,18003512,323746001],[20160606,18.01,18.05,18.11,17.97,18.02,17856247,321865763],[20160607,18.02,18.1,18.13,17.97,18.02,16533983,298145352],[20160608,18.02,18.01,18.07,17.97,17.99,23758300,427741583],[20160613,17.99,17.86,17.94,17.77,17.78,30051583,536281150],[20160614,17.78,17.77,17.83,17.7,17.79,18773357,333449719],[20160615,17.79,17.61,17.76,17.55,17.74,26332177,464557383],[20160616,17.74,17.67,17.93,17.6,17.8,30871127,549171213],[20160617,17.8,17.75,17.99,17.74,17.77,17412233,311113072],[20160620,17.77,17.93,17.93,17.75,17.85,9681495,172507202],[20160621,17.85,17.88,17.95,17.75,17.78,15852873,282663680],[20160622,17.78,17.8,17.9,17.78,17.89,14227501,253800359],[20160623,15.8,15.9,15.9,15.71,15.72,12882295,203560849],[20160624,15.72,15.7,15.79,15.08,15.28,30575522,470756348],[20160627,15.28,15.29,15.39,15.18,15.31,19163499,292488228],[20160628,15.31,15.27,15.3,15.18,15.28,12559826,191346962],[20160629,15.28,15.29,15.54,15.28,15.5,21253351,326320213],[20160630,15.5,15.5,15.66,15.44,15.57,20735886,323223547],[20160701,15.57,15.57,15.96,15.54,15.92,25106479,394802033],[20160704,15.92,15.86,16.03,15.8,15.93,21411650,341120776],[20160705,15.93,15.94,15.95,15.75,15.79,16171615,255727223],[20160706,15.79,15.71,15.76,15.61,15.64,22976510,360070168],[20160707,15.64,15.63,15.64,15.45,15.57,24498042,380536334],[20160708,15.57,15.55,15.56,15.44,15.45,14901331,230568191],[20160711,15.45,15.56,15.57,15.4,15.43,22852491,354003568],[20160712,15.43,15.48,15.65,15.45,15.64,25545130,397267013],[20160713,15.64,15.65,15.97,15.64,15.79,36238056,573546775],[20160714,15.79,15.77,15.84,15.64,15.7,16883421,265364888],[20160715,15.7,15.71,15.75,15.65,15.71,15998100,251152944],[20160718,15.71,15.73,15.91,15.66,15.77,27766982,438169692],[20160719,15.77,15.77,15.8,15.65,15.73,17179816,269908287],[20160720,15.73,15.7,15.76,15.63,15.75,14866526,233284416],[20160721,15.75,15.74,15.87,15.7,15.83,22020445,348156592],[20160722,15.83,15.81,15.82,15.58,15.63,16711700,262066573],[20160725,15.63,15.63,15.76,15.63,15.69,11441970,179598105],[20160726,15.69,15.69,15.79,15.65,15.74,20462397,321598665],[20160727,15.74,15.73,15.88,15.45,15.87,40697330,637937308],[20160728,15.87,15.77,15.79,15.65,15.68,17451372,274345301],[20160729,15.68,15.65,15.71,15.61,15.7,14348301,224747562],[20160801,15.7,15.68,15.85,15.65,15.8,22909943,361191350],[20160802,15.8,15.79,15.85,15.68,15.75,10877815,171311340],[20160803,15.75,15.64,15.72,15.62,15.67,10583990,165699514],[20160804,15.67,15.69,15.69,15.49,15.59,15610498,243122631],[20160805,15.59,15.6,15.8,15.59,15.73,17648517,277447198],[20160808,15.73,15.76,15.76,15.66,15.74,13129367,206333087],[20160809,15.74,15.75,15.8,15.71,15.79,15480879,243949588],[20160810,15.79,15.8,15.85,15.73,15.83,18499535,292534452],[20160811,15.83,15.75,16.4,15.74,16.07,52689421,852413099],[20160812,16.07,16.12,16.39,16,16.36,46991632,763634354],[20160815,16.36,16.5,17.02,16.45,16.94,77333862,1299618491],[20160816,16.94,16.94,16.99,16.67,16.7,49384036,829743468],[20160817,16.7,16.72,16.85,16.52,16.64,36446597,606581272],[20160818,16.64,16.55,16.77,16.35,16.44,37110139,612294413],[20160819,16.44,16.43,16.5,16.36,16.42,19927300,327521631],[20160822,16.42,16.42,16.47,16.31,16.41,19768630,324280093],[20160823,16.41,16.41,16.56,16.32,16.4,31754370,521794934],[20160824,16.4,16.41,16.51,16.34,16.39,17085424,280402637],[20160825,16.39,16.36,16.41,16.2,16.34,24749915,403472216],[20160826,16.34,16.36,16.4,16.29,16.34,14688056,240035889],[20160829,16.34,16.31,16.37,16.08,16.23,30202023,489414008],[20160830,16.23,16.24,16.49,16.24,16.4,36396993,597418078],[20160831,16.4,16.35,16.56,16.32,16.48,22003438,362526025],[20160901,16.48,16.48,16.55,16.38,16.41,21272047,349934548],[20160902,16.41,16.38,16.5,16.35,16.48,23147001,380418559],[20160905,16.48,16.49,16.58,16.42,16.49,25677035,423399290],[20160906,16.49,16.49,16.53,16.37,16.41,20282647,333206432],[20160907,16.41,16.41,16.5,16.35,16.48,17975558,295519896],[20160908,16.48,16.47,16.61,16.43,16.6,24406900,403801797],[20160909,16.6,16.62,16.66,16.5,16.56,18739471,310623908],[20160912,16.56,16.38,16.47,16.26,16.4,36509177,597895474],[20160913,16.4,16.4,16.46,16.39,16.45,14234378,233969071],[20160914,16.45,16.43,16.48,16.38,16.4,23981413,393967822],[20160919,16.4,16.45,16.51,16.42,16.46,14465955,238091122],[20160920,16.46,16.47,16.48,16.42,16.46,17396811,286078658],[20160921,16.46,16.47,16.51,16.43,16.45,9416102,154918234],[20160922,16.45,16.49,16.59,16.47,16.53,11527832,190442429],[20160923,16.53,16.55,16.55,16.48,16.48,10200460,168270146],[20160926,16.48,16.45,16.57,16.41,16.48,20769186,342748706],[20160927,16.48,16.42,16.52,16.42,16.48,17025470,280852907],[20160928,16.48,16.48,16.53,16.46,16.48,12841990,211844619],[20160929,16.48,16.52,16.55,16.49,16.5,10997408,181620111],[20160930,16.5,16.5,16.53,16.48,16.49,12190268,201085204],[20161010,16.49,16.53,16.6,16.48,16.55,18666854,308450225],[20161011,16.55,16.57,16.58,16.5,16.57,12690366,209785537],[20161012,16.57,16.54,16.54,16.48,16.51,10643884,175594201],[20161013,16.51,16.51,16.52,16.42,16.43,14504356,238973130],[20161014,16.43,16.43,16.47,16.38,16.46,10660114,175020225],[20161017,16.46,16.41,16.44,16.22,16.27,16424904,268130860],[20161018,16.27,16.28,16.39,16.24,16.34,18251833,298064113],[20161019,16.34,16.35,16.39,16.24,16.27,11143167,181631901],[20161020,16.27,16.27,16.34,16.25,16.29,8985794,146255319],[20161021,16.29,16.29,16.34,16.22,16.3,10884798,177155062],[20161024,16.3,16.3,16.58,16.27,16.47,24757241,406980667],[20161025,16.47,16.48,16.5,16.36,16.42,13309321,218721453],[20161026,16.42,16.4,16.42,16.3,16.32,12436805,203174010],[20161027,16.32,16.3,16.31,16.18,16.19,19517454,316513318],[20161028,16.19,16.19,16.34,16.18,16.29,15067204,244739683],[20161031,16.29,16.23,16.31,16.01,16.27,14673298,237635070],[20161101,16.27,16.26,16.33,16.21,16.3,13028259,212179107],[20161102,16.3,16.21,16.3,16.18,16.2,25051160,406667269],[20161103,16.2,16.19,16.38,16.19,16.35,25864110,421412550],[20161104,16.35,16.3,16.53,16.29,16.4,21516475,353348691],[20161107,16.4,16.39,16.45,16.38,16.42,21351658,350381736],[20161108,16.42,16.45,16.54,16.44,16.47,17307155,285419770],[20161109,16.47,16.47,16.53,16.36,16.46,39826582,655055488],[20161110,16.46,16.55,16.64,16.48,16.57,20484554,339602785],[20161111,16.57,16.56,16.63,16.45,16.59,21539188,356740636],[20161114,16.59,16.53,16.7,16.52,16.6,18124496,301208006],[20161115,16.6,16.59,16.61,16.5,16.59,15714142,260648299],[20161116,16.59,16.59,16.63,16.54,16.6,12395504,205688793],[20161117,16.6,16.58,16.63,16.52,16.6,22718556,376599274],[20161118,16.6,16.59,16.64,16.55,16.6,29274383,485488349],[20161121,16.6,16.59,16.73,16.54,16.64,21432453,356612260],[20161122,16.64,16.67,16.72,16.63,16.68,21080968,351666631],[20161123,16.68,16.68,17.23,16.66,16.93,45036427,765689745],[20161124,16.93,16.93,17.12,16.86,16.89,21043140,356783606],[20161125,16.89,16.89,17.1,16.81,17.09,23335230,396231886],[20161128,17.09,17.15,17.49,17.15,17.21,33835281,584558233],[20161129,17.21,17.21,17.35,17.11,17.26,29530098,509203656],[20161130,17.26,17.28,17.45,17.1,17.16,20135026,346784527],[20161201,17.16,17.15,17.27,17.05,17.15,18449219,316391192],[20161202,17.15,17.1,17.18,16.8,17.1,33895875,576329869],[20161205,17.1,16.95,17.32,16.91,17.3,38201368,655302810],[20161206,17.3,17.28,17.42,17.2,17.22,20948075,362989434],[20161207,17.22,17.17,17.2,17.06,17.07,15550748,265825550],[20161208,17.07,17.15,17.2,17.04,17.14,13234569,226759229],[20161209,17.14,17.14,17.46,17.12,17.34,28835648,500164630],[20161212,17.34,17.34,17.57,17.19,17.49,48359554,841905183],[20161213,17.49,17.36,17.44,17.16,17.17,15602869,270112439],[20161214,17.17,17.17,17.42,17.12,17.18,17860552,309185673],[20161215,17.18,17.13,17.13,16.7,16.7,30809613,517398943],[20161216,16.7,16.7,16.83,16.63,16.66,14531366,242842108],[20161219,16.66,16.65,16.7,16.51,16.52,8483493,140430889],[20161220,16.52,16.52,16.56,16.12,16.28,22525817,366213562],[20161221,16.28,16.26,16.37,16.25,16.32,12638809,206022869],[20161222,16.32,16.32,16.33,16.14,16.19,11499190,186428629],[20161223,16.19,16.17,16.22,16.07,16.19,11187906,180365980],[20161226,16.19,16.13,16.28,16.01,16.25,14482456,233999583],[20161227,16.25,16.25,16.32,16.13,16.14,10665824,172900199],[20161228,16.14,16.14,16.19,16.03,16.09,14441526,232406679],[20161229,16.09,16.09,16.15,15.99,16.07,11851308,190400022],[20161230,16.07,16.07,16.23,16.04,16.21,12262167,197653917],[20170103,16.21,16.21,16.44,16.17,16.3,16237125,265043268],[20170104,16.3,16.29,16.35,16.18,16.33,29658734,482612222],[20170105,16.33,16.3,16.38,16.24,16.3,26437646,431449126],[20170106,16.3,16.3,16.3,16.13,16.18,17195598,278864536],[20170109,16.18,16.24,16.29,16.13,16.2,14908745,241579598],[20170110,16.2,16.18,16.24,16.14,16.19,7996756,129458363],[20170111,16.19,16.24,16.24,16.15,16.16,9193332,148793816],[20170112,16.16,16.18,16.2,16.11,16.12,8296150,134057682],[20170113,16.12,16.1,16.29,16.1,16.27,19034143,308468975],[20170116,16.27,16.23,16.6,16.1,16.56,53304724,876414508],[20170117,16.56,16.46,16.54,16.37,16.4,12555292,206230538],[20170118,16.4,16.42,16.55,16.36,16.48,11478663,189191354],[20170119,16.48,16.43,16.64,16.43,16.54,12180687,201675871],[20170120,16.54,16.58,16.66,16.5,16.6,14288268,236958622],[20170123,16.6,16.66,16.69,16.51,16.57,14616540,242945923],[20170124,16.57,16.58,16.7,16.58,16.69,14985241,249503391],[20170125,16.69,16.69,16.74,16.61,16.69,11284869,188172530],[20170126,16.69,16.69,16.84,16.61,16.74,8602907,144343272],[20170203,16.74,16.82,16.85,16.62,16.63,8174289,136532939],[20170206,16.63,16.75,16.78,16.66,16.66,13455850,225037394],[20170207,16.66,16.65,16.74,16.63,16.67,14759284,246037892],[20170208,16.67,16.63,16.69,16.54,16.67,11238867,186815177],[20170209,16.67,16.68,16.77,16.59,16.72,11393034,190339364],[20170210,16.72,16.76,16.84,16.7,16.78,13985262,234489132],[20170213,16.78,16.88,16.9,16.78,16.85,19992872,336932200],[20170214,16.85,16.87,16.88,16.74,16.75,12987235,217924152],[20170215,16.75,16.82,16.93,16.75,16.84,25688032,433573962],[20170216,16.84,16.88,16.91,16.76,16.78,16327832,274241728],[20170217,16.78,16.78,16.82,16.59,16.64,13863642,231623672],[20170220,16.64,16.62,16.98,16.62,16.91,29949984,503858485],[20170221,16.91,16.88,17.08,16.81,16.88,17509118,296489045],[20170222,16.88,16.88,16.9,16.73,16.75,17032277,285870629],[20170223,16.75,16.78,16.83,16.64,16.69,15011148,250909254],[20170224,16.69,16.67,16.75,16.66,16.71,11594971,193610637],[20170227,16.71,16.69,16.72,16.53,16.59,13732273,228302043],[20170228,16.59,16.58,16.67,16.53,16.59,12097943,200661656],[20170301,16.59,16.58,16.62,16.52,16.56,16226984,268840218],[20170302,16.56,16.62,16.62,16.39,16.41,18996632,312626391],[20170303,16.41,16.42,16.43,16.32,16.35,12429467,203315662],[20170306,16.35,16.37,16.53,16.35,16.41,15703751,258165904],[20170307,16.41,16.38,16.45,16.37,16.43,9319842,152969168],[20170308,16.43,16.4,16.44,16.35,16.39,10109647,165715073],[20170309,16.39,16.37,16.4,16.22,16.22,17366025,282644706],[20170310,16.22,16.23,16.28,16.17,16.23,16396375,265663459],[20170313,16.23,16.23,16.34,16.16,16.34,17950147,291999358],[20170314,16.34,16.34,16.35,16.24,16.26,16988979,276642688],[20170315,16.26,16.24,16.28,16.17,16.24,18900324,306175990],[20170316,16.24,16.27,16.35,16.25,16.29,19036545,310417986],[20170317,16.29,16.3,16.32,16.14,16.2,21560354,350179470],[20170320,16.2,16.24,16.25,16.13,16.14,15017806,242775930],[20170321,16.14,16.15,16.16,15.98,16,31124617,499206643],[20170322,16,15.98,15.98,15.7,15.78,43811429,691677895],[20170323,15.78,15.8,15.92,15.79,15.88,22225660,352635979],[20170324,15.88,15.85,16,15.83,15.96,19902006,316984958],[20170327,15.96,15.97,16.13,15.9,16.04,18997369,304990151],[20170328,16.04,16.11,16.13,15.97,16.01,13212969,211750766],[20170329,16.01,16.01,16.11,15.8,15.87,23446792,372794465],[20170330,15.87,15.88,15.9,15.72,15.81,23645144,373665115],[20170331,15.81,15.78,16.05,15.77,16.01,24187120,385793421],[20170405,16.01,16.05,16.2,15.89,16.16,31036271,499121565],[20170406,16.16,16.09,16.18,16.03,16.1,22335442,359361840],[20170407,16.1,16.06,16.16,16.02,16.1,20126948,323821647],[20170410,16.1,16.12,16.12,15.94,15.97,16154024,258662668],[20170411,15.97,15.97,15.99,15.81,15.89,18611375,295381671],[20170412,15.89,15.88,15.96,15.75,15.89,22210541,352357729],[20170413,15.89,15.88,15.89,15.73,15.75,23426650,369388222],[20170414,15.75,15.76,15.78,15.42,15.51,40156553,625510632],[20170417,15.51,15.53,15.6,15.3,15.56,36739448,566536789],[20170418,15.56,15.5,15.52,15.3,15.3,22889980,351624622],[20170419,15.3,15.25,15.27,15.11,15.11,24455407,371021507],[20170420,15.11,15.12,15.14,14.9,14.91,41061406,614436383],[20170421,14.91,14.92,15.07,14.85,15.05,22688358,340453104],[20170424,15.05,15.05,15.11,14.91,15,17627803,264649933],[20170425,15,15.02,15.1,14.99,15.05,12975919,195296862],[20170426,15.05,15.06,15.11,15,15.05,14939871,225022668],[20170427,15.05,15.05,15.25,15.03,15.21,22887645,345791526],[20170428,15.21,15.15,15.22,15.08,15.21,15718509,238419161],[20170502,15.21,15.21,15.22,15.13,15.16,12607509,191225527],[20170503,15.16,15.16,15.16,15.05,15.08,14247943,215130847],[20170504,15.08,15.07,15.07,14.9,14.98,19477788,291839737],[20170505,14.98,14.95,14.98,14.52,14.92,40194577,592160198],[20170508,14.92,14.78,14.9,14.51,14.86,43568576,638781010],[20170509,14.86,14.69,14.84,14.66,14.76,19225492,283864640],[20170510,14.76,14.76,14.85,14.55,14.61,28359413,418201400],[20170511,14.61,14.57,14.79,14.55,14.75,27312908,400313949],[20170512,14.75,14.75,15.23,14.73,15.21,45733426,687468466],[20170515,15.21,15.27,15.43,15.16,15.27,29965820,458298668],[20170516,15.27,15.23,15.29,15.08,15.27,24875396,377908567],[20170517,15.27,15.24,15.26,15.07,15.21,33434411,505883672],[20170518,15.21,15.1,15.14,14.95,15.01,30657927,460669387],[20170519,15.01,15.04,15.08,14.91,15.02,28610626,428236200],[20170522,15.02,15.02,15.06,14.93,15.04,30227245,453230616],[20170523,15.04,15,15.57,14.98,15.43,75400428,1154524439],[20170524,15.43,15.38,15.52,15.21,15.47,70439028,1081376996],[20170525,11.75,11.75,12.93,11.72,12.93,222373433,2803027082],[20170526,12.93,12.81,12.91,12.54,12.84,176456630,2246593329],[20170531,12.84,12.75,13.05,12.66,12.84,113009809,1450286642],[20170601,12.84,12.78,12.97,12.69,12.92,96217055,1235216028],[20170602,12.92,12.93,13.01,12.74,12.89,80197701,1034450236],[20170605,12.89,12.79,12.88,12.51,12.85,75876475,963227274],[20170606,12.85,12.8,12.84,12.66,12.8,36104406,460469437],[20170607,12.8,12.81,12.99,12.78,12.84,64395191,827766620],[20170608,12.84,12.76,12.86,12.67,12.84,48194843,615876297],[20170609,12.84,12.79,13.2,12.77,12.93,114434319,1489264558],[20170612,12.93,12.9,13.14,12.76,12.78,73931192,955965931],[20170613,12.78,12.78,12.78,12.56,12.59,52716070,665205801],[20170614,12.59,12.6,12.64,12.31,12.46,55306982,687620409],[20170615,12.46,12.41,12.46,12.28,12.38,37492860,462612620],[20170616,12.38,12.38,12.46,12.27,12.35,47351062,586081485],[20170619,12.35,12.36,12.43,12.3,12.4,32941278,407834844],[20170620,12.4,12.41,12.44,12.22,12.29,44645196,548932358],[20170621,12.29,12.4,12.4,12.26,12.34,34000062,418820218],[20170622,12.34,12.33,12.84,12.29,12.57,110259441,1392278622],[20170623,12.57,12.55,12.65,12.36,12.64,68579079,858095944],[20170626,12.64,12.64,12.82,12.55,12.64,60509162,766551256],[20170627,12.64,12.64,12.73,12.53,12.7,46687475,589020019],[20170628,12.7,12.66,12.91,12.6,12.79,75349557,963202799],[20170629,12.79,12.81,12.86,12.7,12.76,38994542,497489975],[20170630,12.76,12.7,12.73,12.59,12.65,36566479,462244023],[20170703,12.65,12.64,12.65,12.47,12.56,38778949,486264674],[20170704,12.56,12.55,12.58,12.41,12.55,36659128,458434427],[20170705,12.55,12.5,12.65,12.47,12.62,26470507,332542458],[20170706,12.62,12.62,12.72,12.51,12.66,37414241,471582088],[20170707,12.66,12.62,12.69,12.55,12.6,24667294,311101536],[20170710,12.6,12.59,12.64,12.52,12.53,26411530,331940512],[20170711,12.53,12.51,12.94,12.51,12.8,96835349,1238626601],[20170712,12.8,12.8,13.06,12.74,12.86,80469025,1039614032],[20170713,12.86,12.82,13.29,12.77,13.27,110219238,1436784310],[20170714,13.27,13.34,13.8,13.34,13.59,146865370,1991795315],[20170717,13.59,13.62,14.02,13.28,13.76,178661221,2448349167],[20170718,13.76,13.65,13.72,13.4,13.55,69895876,946717556],[20170719,13.55,13.56,13.78,13.48,13.69,66108709,900014392],[20170720,13.69,13.67,13.7,13.53,13.62,40017492,544175215],[20170721,13.62,13.61,13.63,13.38,13.45,52272375,702999237],[20170724,13.45,13.45,13.74,13.36,13.67,65820954,892033686],[20170725,13.67,13.62,13.75,13.41,13.51,58478099,795769078],[20170726,13.51,13.45,13.7,13.36,13.38,57495388,775489074],[20170727,13.38,13.38,13.47,13.28,13.38,33612097,449548317],[20170728,13.38,13.37,13.49,13.3,13.47,24954961,334111573],[20170731,13.47,13.45,13.52,13.31,13.36,45083081,602638872],[20170801,13.36,13.42,13.49,13.32,13.43,64198064,860914609],[20170802,13.43,13.44,13.6,13.39,13.44,61644148,830433621],[20170803,13.44,13.42,13.42,13.04,13.08,78581867,1036842141],[20170804,13.08,13.09,13.1,12.85,12.87,63181971,818014678],[20170807,12.87,12.87,12.95,12.83,12.93,29528429,380518686],[20170808,12.93,12.91,12.93,12.83,12.87,23570298,303469941],[20170809,12.87,12.84,12.88,12.75,12.76,32303821,413575784],[20170810,12.76,12.74,12.88,12.7,12.79,44056044,563372040],[20170811,12.79,12.72,12.73,12.46,12.68,88890056,1118537328],[20170814,12.68,12.62,12.63,12.52,12.56,45562027,572465225],[20170815,12.56,12.58,12.76,12.56,12.59,62591905,792887783],[20170816,12.59,12.56,12.56,12.47,12.49,33886531,423706578],[20170817,12.49,12.49,12.55,12.47,12.53,39091156,488847378],[20170818,12.53,12.5,12.57,12.46,12.51,35976632,450071386],[20170821,12.51,12.5,12.57,12.46,12.51,33810237,422478328],[20170822,12.51,12.51,12.53,12.41,12.43,58829999,731959991],[20170823,12.43,12.44,12.66,12.41,12.57,96871587,1215804709],[20170824,12.57,12.58,12.66,12.45,12.47,62153175,779043383],[20170825,12.47,12.47,12.8,12.47,12.78,145590666,1842766907],[20170828,12.78,12.83,12.96,12.75,12.89,104113170,1339965987],[20170829,12.89,12.85,12.98,12.77,12.96,60063956,772995364],[20170830,12.96,12.91,12.98,12.82,12.87,60479990,779708165],[20170831,12.87,12.83,12.84,12.65,12.71,44790313,570138136],[20170901,12.71,12.68,12.87,12.68,12.77,39264131,501796405],[20170904,12.77,12.78,12.84,12.65,12.78,35667447,454951467],[20170905,12.78,12.78,13.09,12.78,13.03,73493027,954528907],[20170906,13.03,12.99,13.05,12.9,12.96,33823576,438219617],[20170907,12.96,12.94,13.02,12.82,12.85,38224782,494212416],[20170908,12.85,12.85,13.12,12.83,13.03,64778087,842285784],[20170911,13.03,13.15,13.15,12.95,12.99,52234735,683194002],[20170912,12.99,13,13.04,12.91,13.04,51012322,661471546],[20170913,13.04,13.01,13.01,12.86,12.87,31972897,412327510],[20170914,12.87,12.88,12.98,12.81,12.85,24160832,311079246],[20170915,12.85,12.82,12.86,12.75,12.83,24874312,318464945],[20170918,12.83,12.82,12.96,12.8,12.91,35747529,461032051],[20170919,12.91,12.93,12.95,12.82,12.9,30170124,388627660],[20170920,12.9,12.88,12.93,12.83,12.88,19867148,255856510],[20170921,12.88,12.86,12.95,12.83,12.87,20140268,259643727],[20170922,12.87,12.84,12.92,12.79,12.89,24192687,311178548],[20170925,12.89,12.89,12.95,12.71,12.94,50687628,650703773],[20170926,12.94,12.89,12.93,12.85,12.86,22163311,285364898],[20170927,12.86,12.83,12.91,12.76,12.85,26374752,339097277],[20170928,12.85,12.85,12.88,12.77,12.84,24124934,309223171],[20170929,12.84,12.82,12.91,12.81,12.87,19822263,255341342],[20171009,12.87,13.27,13.29,13,13.04,52149081,684274104],[20171010,13.04,13.05,13.1,12.98,13.1,27493986,359114767],[20171011,13.1,13.08,13.11,13.03,13.06,18706308,244440298],[20171012,13.06,13.05,13.09,12.97,13.05,17125284,223204024],[20171013,13.05,13.01,13.08,12.92,12.94,20857578,271308478],[20171016,12.94,12.98,13.06,12.94,13.04,23611164,307206532],[20171017,13.04,13.04,13.06,12.94,12.99,14692320,190770505],[20171018,12.99,12.99,13.1,12.93,13.07,45458736,592125606],[20171019,13.07,13.03,13.16,12.98,13.13,52881168,690607546],[20171020,13.13,13.09,13.1,13.01,13.01,17228409,224781272],[20171023,13.01,13.02,13.03,12.83,12.84,31563834,406941717],[20171024,12.84,12.84,12.95,12.82,12.86,27236042,350864968],[20171025,12.86,12.86,12.94,12.82,12.9,20743829,267109744],[20171026,12.9,12.87,12.88,12.78,12.82,25275166,324110141],[20171027,12.82,12.85,12.94,12.82,12.85,32673820,420972314],[20171030,12.85,12.84,12.84,12.59,12.7,74713617,947820344],[20171031,12.7,12.6,12.66,12.58,12.61,20120724,253737598],[20171101,12.61,12.63,12.72,12.53,12.54,35368712,446287606],[20171102,12.54,12.52,12.57,12.43,12.53,48267038,602955872],[20171103,12.53,12.53,12.6,12.43,12.58,32848169,411198265],[20171106,12.58,12.56,12.56,12.45,12.47,20016827,249788208],[20171107,12.47,12.49,12.6,12.41,12.54,38677337,482986126],[20171108,12.54,12.54,12.68,12.49,12.58,37134146,468242270],[20171109,12.58,12.57,12.63,12.53,12.55,17463373,219541345],[20171110,12.55,12.54,12.63,12.46,12.63,49925359,626756843],[20171113,12.63,12.65,12.85,12.63,12.8,78009337,996962275],[20171114,12.8,12.76,12.77,12.58,12.6,33754928,426955935],[20171115,12.6,12.6,12.63,12.55,12.6,28076530,353327083],[20171116,12.6,12.57,12.57,12.38,12.39,35680762,444238625],[20171117,12.39,12.38,12.8,12.38,12.78,109336535,1378873267],[20171120,12.78,12.7,12.86,12.61,12.85,61495420,783077227],[20171121,12.85,12.81,13.17,12.75,12.94,116179412,1512638142],[20171122,12.94,13,13.44,13,13.23,114576266,1513356223],[20171123,13.23,13.24,13.32,12.91,13.06,81912602,1076890039],[20171124,13.06,13.11,13.18,12.93,13.09,59612483,777699709],[20171127,13.09,13.09,13.12,12.81,13.1,79250273,1028510255],[20171128,13.1,13.03,13.07,12.92,12.94,34031908,441466983],[20171129,12.94,12.95,13.04,12.81,12.94,41846783,540439739],[20171130,12.94,12.91,12.95,12.8,12.91,39916356,513785829],[20171201,12.91,12.93,12.95,12.81,12.91,38577445,496330241],[20171204,12.91,12.87,12.94,12.84,12.92,36479233,470155474],[20171205,12.92,12.92,13.27,12.91,13.17,123796797,1623138207],[20171206,13.17,13.12,13.16,12.91,12.96,43564931,566372423],[20171207,12.96,12.95,13.03,12.91,12.96,34802229,451233524],[20171208,12.96,12.98,12.99,12.87,12.93,31296221,404411517],[20171211,12.93,12.92,13.04,12.85,12.97,36649902,474566888],[20171212,12.97,12.97,12.97,12.74,12.75,30370097,390113096],[20171213,12.75,12.8,12.81,12.63,12.74,19345338,246331123],[20171214,12.74,12.79,12.79,12.66,12.69,16141678,205219487],[20171215,12.69,12.69,12.73,12.61,12.62,16210108,205323767],[20171218,12.62,12.71,12.71,12.61,12.65,13445648,170140035],[20171219,12.65,12.65,12.76,12.62,12.75,18399603,233884666],[20171220,12.75,12.76,12.76,12.6,12.73,26639844,337603451],[20171221,12.73,12.67,12.78,12.6,12.7,21052388,267624195],[20171222,12.7,12.68,12.72,12.61,12.62,16076938,203468779],[20171225,12.62,12.61,12.68,12.56,12.59,19306662,243553698],[20171226,12.59,12.57,12.66,12.56,12.64,15225722,192219131],[20171227,12.64,12.65,12.66,12.53,12.62,32731881,412197987],[20171228,12.62,12.6,12.66,12.53,12.54,23870824,300834017],[20171229,12.54,12.52,12.62,12.51,12.59,16351826,205752875],[20180102,12.59,12.61,12.77,12.6,12.72,31323053,398614966],[20180103,12.72,12.73,12.8,12.66,12.66,37839101,480954809],[20180104,12.66,12.7,12.73,12.62,12.66,27883804,353205838],[20180105,12.66,12.67,12.71,12.62,12.69,31026744,393058250],[20180108,12.69,12.69,12.71,12.63,12.68,31389887,397842209],[20180109,12.68,12.68,12.74,12.66,12.7,26215432,332848333],[20180110,12.7,12.7,13.09,12.68,13.02,90679990,1174202006],[20180111,13.02,12.95,13.04,12.87,12.94,37816412,489588906],[20180112,12.94,12.97,13,12.9,12.91,24203419,313215088],[20180115,12.91,12.88,13.08,12.85,13.02,61320680,796861091],[20180116,13.02,12.97,13.06,12.78,12.9,74892652,963701144],[20180117,12.9,12.91,13.42,12.89,13.1,127132813,1675235171],[20180118,13.1,13.14,13.25,13.05,13.24,111608076,1465159094],[20180119,13.24,13.33,13.61,13.18,13.24,171648871,2300220633],[20180122,13.24,12.93,13.15,12.71,12.77,272513801,3514775144],[20180123,12.77,12.75,12.92,12.68,12.9,217827457,2791828653],[20180124,12.9,12.97,14,12.89,13.57,379653629,5099364114],[20180125,13.57,13.54,13.76,13.36,13.65,176989631,2400208784],[20180126,13.65,13.65,13.72,13.36,13.41,218419685,2954019925],[20180129,13.41,13.48,13.53,13.32,13.46,153783104,2065139247],[20180130,13.46,13.45,13.49,13.09,13.11,107804018,1429924976],[20180131,13.11,13.05,13.19,12.98,13.17,117703264,1541960901],[20180201,13.17,13.14,13.33,12.94,13.3,173573331,2289044601],[20180202,13.3,13.19,13.19,13.01,13.14,71796780,941467191],[20180205,13.14,13,13.54,12.98,13.49,150149657,2006361757],[20180206,13.49,13.29,13.5,13.2,13.48,244358992,3270199180],[20180207,13.48,13.58,13.9,13.24,13.45,200770115,2720519687],[20180208,13.45,13.34,13.4,12.95,13.1,109426872,1438198801],[20180209,13.1,12.89,12.98,12.24,12.78,149257356,1877264356],[20180212,12.78,12.66,12.68,12.43,12.49,64799197,811027710],[20180213,12.49,12.55,12.68,12.5,12.51,54900214,690054113],[20180214,12.51,12.5,12.55,12.38,12.46,32597811,406060202],[20180222,12.46,12.6,12.68,12.53,12.63,42012285,529856471],[20180223,12.63,12.66,12.78,12.59,12.72,38736515,491768409],[20180226,12.72,12.77,12.84,12.61,12.73,48806055,620261080],[20180227,12.73,12.75,12.76,12.61,12.69,48561087,615622149],[20180228,12.69,12.61,12.66,12.44,12.46,39888938,499258844],[20180301,12.46,12.4,12.5,12.38,12.47,34491031,429574072],[20180302,12.47,12.4,12.46,12.36,12.41,23024132,285473130],[20180305,12.41,12.41,12.48,12.34,12.42,29343464,363849705],[20180306,12.42,12.48,12.51,12.38,12.49,27222668,339015159],[20180307,12.49,12.51,12.6,12.46,12.49,38817575,487036820],[20180308,12.49,12.55,12.55,12.4,12.47,22164132,276013913],[20180309,12.47,12.49,12.51,12.42,12.48,23558287,293550899],[20180312,12.48,12.53,12.54,12.46,12.5,25161821,314544074],[20180313,12.5,12.5,12.58,12.43,12.49,25145e3,314545358],[20180314,12.49,12.45,12.45,12.38,12.39,22804603,282970086],[20180315,12.39,12.35,12.41,12.34,12.39,17287774,213972089],[20180316,12.39,12.36,12.4,12.3,12.3,26781399,330778426],[20180319,12.3,12.31,12.33,12.26,12.31,16896048,207819310],[20180320,12.31,12.28,12.39,12.25,12.32,20672283,254187843],[20180321,12.32,12.34,12.4,12.28,12.29,23878465,294872209],[20180322,12.29,12.35,12.35,12.25,12.25,22948484,281975042],[20180323,12.25,12,12.06,11.64,11.71,57106391,676679666],[20180326,11.71,11.71,11.75,11.5,11.61,36425054,422233460],[20180327,11.61,11.7,11.77,11.56,11.62,27332809,318586664],[20180328,11.62,11.53,11.75,11.52,11.57,22911282,266121467],[20180329,11.57,11.57,11.71,11.45,11.62,33108805,383064999],[20180330,11.62,11.63,11.69,11.61,11.65,23271965,270987701],[20180402,11.65,11.68,11.82,11.65,11.71,27719599,325667590],[20180403,11.71,11.66,11.67,11.54,11.56,18303514,211906876],[20180404,11.56,11.61,11.65,11.53,11.53,19637509,227689712],[20180409,11.53,11.53,11.59,11.49,11.5,16722481,192709506],[20180410,11.5,11.52,11.79,11.51,11.77,28748298,336076808],[20180411,11.77,11.79,12.02,11.75,11.91,31298519,372471249],[20180412,11.91,11.91,11.96,11.76,11.78,18824289,222769476],[20180413,11.78,11.83,11.89,11.69,11.69,14094853,166015524],[20180416,11.69,11.8,11.8,11.54,11.55,23720095,275070676],[20180417,11.55,11.56,11.7,11.55,11.55,25469983,296234022],[20180418,11.55,11.75,11.79,11.66,11.73,26295275,308485462],[20180419,11.73,11.8,11.89,11.76,11.8,16553270,195771190],[20180420,11.8,11.74,11.79,11.57,11.61,18377407,213965166],[20180423,11.61,11.56,11.75,11.53,11.6,18181610,211046456],[20180424,11.6,11.56,11.78,11.56,11.78,23032861,269871844],[20180425,11.78,11.71,11.77,11.65,11.66,16082634,188149247],[20180426,11.66,11.73,11.78,11.55,11.57,18205794,211987526],[20180427,11.57,11.58,11.67,11.55,11.61,23450783,272328553],[20180502,11.61,11.33,11.33,10.97,11.03,69325684,769050164],[20180503,11.03,10.99,11.01,10.83,10.92,34665572,378055362],[20180504,10.92,10.91,10.94,10.8,10.83,22253089,241749748],[20180507,10.83,10.82,10.89,10.76,10.84,27425378,297162770],[20180508,10.84,10.84,10.97,10.81,10.95,28796453,314537694],[20180509,10.95,10.95,11,10.89,10.93,18510621,202375456],[20180510,10.93,10.98,11,10.91,10.95,16030500,175546224],[20180511,10.95,11,11.01,10.94,10.95,22015135,241676135],[20180514,10.95,10.97,11.05,10.96,11,23763310,261553535],[20180515,11,11.03,11.05,10.88,10.99,23548459,258018710],[20180516,10.99,10.93,10.96,10.86,10.87,23580345,257351420],[20180517,10.87,10.86,10.91,10.81,10.83,18474690,200668980],[20180518,10.83,10.85,10.9,10.81,10.9,21717105,235717339],[20180521,10.9,10.98,10.98,10.9,10.94,23393724,255891648],[20180522,10.94,10.94,10.95,10.85,10.88,16014501,174138743],[20180523,10.88,10.88,10.89,10.79,10.8,21194469,229712309],[20180524,10.8,10.83,10.84,10.76,10.79,15229580,164430466],[20180525,10.79,10.83,10.83,10.68,10.71,19016226,204634790],[20180528,10.71,10.71,10.79,10.61,10.76,18370343,196979804],[20180529,10.76,10.7,10.74,10.61,10.64,16933980,180559166],[20180530,10.64,10.56,10.6,10.39,10.44,32230788,338274421],[20180531,10.44,10.46,10.69,10.46,10.55,45532670,480871723],[20180601,10.55,10.6,10.69,10.53,10.68,18365527,195167690],[20180604,10.68,10.76,10.83,10.7,10.75,16180325,174154210],[20180605,10.75,10.71,10.75,10.61,10.66,18692609,199025891],[20180606,10.66,10.64,10.64,10.53,10.55,14983603,158227437],[20180607,10.55,10.56,10.66,10.51,10.62,23355633,247771033],[20180608,10.62,10.55,10.57,10.37,10.42,27181997,283822904],[20180611,10.42,10.38,10.43,10.28,10.42,18004293,186272758],[20180612,10.42,10.41,10.41,10.3,10.35,16085667,166400389],[20180613,10.35,10.3,10.33,10.18,10.21,19961576,204624613],[20180614,10.21,10.16,10.26,10.16,10.22,17557528,179339350],[20180615,10.22,10.22,10.34,10.19,10.3,19914990,204800278],[20180619,10.3,10.23,10.24,9.81,9.92,42988471,432159776],[20180620,9.92,9.92,9.98,9.87,9.89,18915740,187504468],[20180621,9.89,9.88,9.98,9.75,9.83,23636961,234236776],[20180622,9.83,9.83,9.83,9.67,9.76,25040001,243586307],[20180625,9.76,9.77,9.82,9.55,9.56,24244380,234851670],[20180626,9.56,9.6,9.6,9.35,9.48,24424095,231698549],[20180627,9.48,9.41,9.53,9.36,9.37,24913770,234831869],[20180628,9.37,9.33,9.61,9.32,9.5,30741337,290768015],[20180629,9.5,9.56,9.6,9.45,9.56,19493546,185831802],[20180702,9.56,9.55,9.55,9.23,9.29,22669089,212743905],[20180703,9.29,9.29,9.38,9.2,9.35,24123551,224816757],[20180704,9.35,9.34,9.42,9.28,9.31,14464777,135000876],[20180705,9.31,9.26,9.35,9.22,9.26,16495438,152978661],[20180706,9.26,9.31,9.43,9.17,9.37,22594443,210564106],[20180709,9.37,9.37,9.63,9.37,9.6,22172565,212109327],[20180710,9.6,9.61,9.65,9.5,9.57,12402837,118668133],[20180711,9.57,9.37,9.44,9.32,9.38,15203933,142450919],[20180712,9.38,9.41,9.61,9.39,9.57,19704837,188206858],[20180713,9.47,9.57,9.58,9.46,9.49,15026339,142708347],[20180716,9.49,9.5,9.54,9.34,9.41,14414119,135697106],[20180717,9.41,9.41,9.48,9.38,9.44,13713495,129512091],[20180718,9.44,9.51,9.64,9.48,9.51,18922700,180858003],[20180719,9.51,9.6,9.62,9.53,9.56,18360482,175909129],[20180720,9.56,9.56,9.95,9.47,9.87,33275650,325018010],[20180723,9.87,9.91,10.03,9.74,9.96,31484434,311612051],[20180724,9.96,9.98,10.14,9.97,10.02,36424560,365678865],[20180725,10.02,10.12,10.12,9.96,10.02,15889970,159153073],[20180726,10.02,10.07,10.08,9.95,9.96,15206330,151927483],[20180727,9.96,9.96,10.04,9.93,9.99,12120067,121060815],[20180730,9.99,9.99,10.16,9.97,10.13,20096364,202566237],[20180731,10.13,10.12,10.2,10,10.17,18203008,184265064],[20180801,10.17,10.26,10.27,9.9,9.91,20741884,209512354],[20180802,9.91,9.91,10.03,9.66,9.79,24483871,240792864],[20180803,9.79,9.79,9.98,9.76,9.83,16997939,168026922],[20180806,9.83,9.97,10.03,9.87,9.91,17444492,173559265],[20180807,9.91,9.94,10.12,9.94,10.11,21784661,218926426],[20180808,10.11,10.15,10.15,10.01,10.05,13461992,135623302],[20180809,10.05,10,10.18,9.99,10.14,17689853,179007673],[20180810,10.14,10.14,10.14,10.02,10.07,13172633,132643603],[20180813,10.07,10,10.06,9.9,9.98,17927668,178552668],[20180814,9.98,9.98,10.07,9.95,10.06,15868585,158997523],[20180815,10.06,10.06,10.06,9.9,9.9,14787033,147639905],[20180816,9.9,9.87,10.12,9.84,10.06,24323652,243554060],[20180817,10.06,10.16,10.16,9.93,9.98,15090455,151684025],[20180820,9.98,10.17,10.17,10.01,10.15,26975300,272534557],[20180821,10.15,10.18,10.2,10.09,10.12,19786535,200852851],[20180822,10.12,10.12,10.14,10,10.09,11993541,120615691],[20180823,10.09,10.13,10.14,9.98,10.07,15537812,156583263],[20180824,10.07,10.06,10.43,10.02,10.3,32268837,330331268],[20180827,10.3,10.33,10.35,10.21,10.33,23266645,239467138],[20180828,10.33,10.3,10.38,10.25,10.3,14609685,150677769],[20180829,10.3,10.29,10.32,10.26,10.32,10362e3,106687297],[20180830,10.32,10.3,10.41,10.17,10.17,18621890,191336868],[20180831,10.17,10.16,10.36,10.16,10.33,37311724,383679854],[20180903,10.33,10.27,10.3,10.17,10.24,14309539,146457275],[20180904,10.24,10.21,10.4,10.18,10.37,16353060,168632347],[20180905,10.37,10.31,10.37,10.12,10.12,22729232,232884783],[20180906,10.12,10.12,10.23,10.12,10.14,10546916,107317753],[20180907,10.14,10.15,10.25,10.12,10.19,8995716,91694437],[20180910,10.19,10.16,10.23,10.13,10.18,11822813,120376355],[20180911,10.18,10.22,10.27,9.98,10.02,19689042,199401394],[20180912,10.02,9.99,10.07,9.95,10.04,16506103,165231589],[20180913,10.04,10.17,10.3,10.11,10.29,29417198,300441533],[20180914,10.29,10.36,10.36,10.21,10.26,16450780,169083471],[20180917,10.26,10.26,10.28,10.1,10.15,10535343,107339083],[20180918,10.15,10.16,10.26,10.09,10.26,16684789,170045729],[20180919,10.26,10.28,10.29,10.2,10.24,18550643,190221692],[20180920,10.24,10.26,10.28,10.18,10.22,16307051,166658023],[20180921,10.22,10.24,10.49,10.15,10.49,37571431,388504217],[20180925,10.49,10.38,10.47,10.32,10.35,15879199,164580504],[20180926,10.35,10.39,10.56,10.34,10.41,31175799,326010701],[20180927,10.41,10.45,10.48,10.38,10.48,24182714,252306120],[20180928,10.48,10.49,10.75,10.44,10.62,37430602,396863685],[20181008,10.62,10.39,10.48,10.15,10.16,41957276,432913252],[20181009,10.16,10.08,10.24,10.07,10.15,23159026,234661842],[20181010,10.15,10.14,10.28,10.13,10.17,18124701,184735118],[20181011,10.17,10,10.05,9.71,9.8,39056785,386778863],[20181012,9.8,9.9,10.1,9.83,10.03,25145127,250805638],[20181015,10.03,10.05,10.16,9.97,10.03,13957844,140122866],[20181016,10.03,10.03,10.19,9.97,10.05,15308344,154272073],[20181017,10.05,10.18,10.31,10.14,10.29,26520895,271564080],[20181018,10.29,10.35,10.35,10.16,10.19,22403988,229432798],[20181019,10.19,10.25,10.43,10.07,10.38,40331386,414893373],[20181022,10.38,10.32,10.7,10.32,10.62,47003409,497527573],[20181023,10.62,10.64,10.7,10.45,10.45,38089035,403493088],[20181024,10.45,10.57,11.05,10.52,10.74,59165552,639391016],[20181025,10.74,10.6,10.89,10.54,10.84,36866593,393987422],[20181026,10.84,10.85,10.98,10.74,10.92,27519309,298733755],[20181029,10.92,11.08,11.12,10.71,10.79,35265959,385116491],[20181030,10.79,10.93,11.05,10.89,10.95,33086049,363018055],[20181031,10.95,10.99,11.03,10.87,10.98,21737114,237583046],[20181101,10.98,11.05,11.09,10.86,10.89,23505322,257781673],[20181102,10.89,11.1,11.25,10.94,11.18,47788920,530913675],[20181105,11.18,11.15,11.25,11.08,11.14,17012759,189481162],[20181106,11.14,11.13,11.15,11,11.03,18422477,203565760],[20181107,11.03,11.09,11.1,10.87,10.9,20843864,228836505],[20181108,10.9,11.05,11.1,10.9,11.06,19991683,220506116],[20181109,11.06,10.99,11.03,10.7,10.75,25570050,277004944],[20181112,10.75,10.77,10.95,10.75,10.8,27015827,292478247],[20181113,10.8,10.68,10.9,10.68,10.82,20708729,223541479],[20181114,10.82,10.87,10.87,10.68,10.7,17998183,193809658],[20181115,10.7,10.72,10.81,10.65,10.77,16580059,178144575],[20181116,10.77,10.77,10.85,10.71,10.76,21394417,230509596],[20181119,10.76,10.86,10.9,10.77,10.88,21384793,231999662],[20181120,10.88,10.87,10.89,10.65,10.69,21883780,234959214],[20181121,10.69,10.61,10.72,10.61,10.66,16027458,170915676],[20181122,10.66,10.73,10.73,10.57,10.64,14008305,148745106],[20181123,10.64,10.6,10.66,10.5,10.5,14715010,155566104],[20181126,10.5,10.66,10.66,10.43,10.5,14377396,151609376],[20181127,10.5,10.5,10.61,10.45,10.49,15084666,158853285],[20181128,10.49,10.56,10.62,10.5,10.58,18339621,193914889],[20181129,10.58,10.64,10.75,10.54,10.63,20685685,220670065],[20181130,10.63,10.65,10.75,10.62,10.71,28572651,305468672],[20181203,10.71,10.99,11.05,10.84,11.02,43049070,472438382],[20181204,11.02,11,11.08,10.97,11.08,20811293,229713745],[20181205,11.08,10.99,11.1,10.96,11,25491217,281189602],[20181206,11,10.82,10.93,10.82,10.9,23597997,256533148],[20181207,10.9,10.94,11.03,10.88,10.89,10580550,115760323],[20181210,10.89,10.77,10.9,10.77,10.83,15927563,172346141],[20181211,10.83,10.84,10.9,10.69,10.72,17234222,185675067],[20181212,10.72,10.89,10.89,10.7,10.73,12448791,134006589],[20181213,10.73,10.76,10.86,10.73,10.8,19792340,213866046],[20181214,10.8,10.74,10.8,10.59,10.62,24163831,257441060],[20181217,10.62,10.65,10.78,10.62,10.78,19746228,211971706],[20181218,10.78,10.68,10.82,10.54,10.57,19451677,207318277],[20181219,10.57,10.59,10.65,10.54,10.54,13603633,144342542],[20181220,10.54,10.53,10.59,10.11,10.25,30069914,309207188],[20181221,10.25,10.23,10.24,10,10.07,20885862,209975605],[20181224,10.07,9.98,10.04,9.86,9.91,22779882,225706451],[20181225,9.91,9.77,9.86,9.6,9.79,34810397,337985911],[20181226,9.79,9.81,9.88,9.64,9.67,20569202,200359184],[20181227,9.67,9.77,9.8,9.66,9.66,27347564,266280883],[20181228,9.66,9.72,9.95,9.71,9.8,27404028,269118592],[20190102,9.8,9.74,9.79,9.58,9.7,23762822,229625669],[20190103,9.7,9.7,9.82,9.66,9.81,18654262,181975985],[20190104,9.81,9.73,10,9.7,9.96,27172844,268964563],[20190107,9.96,10.09,10.09,9.92,9.98,23597376,235440197],[20190108,9.98,10.03,10.03,9.91,9.96,15104933,150501650],[20190109,9.96,10.06,10.16,9.98,9.99,23163720,233890281],[20190110,9.99,9.94,10.02,9.92,9.96,15923566,158718755],[20190111,9.96,10.03,10.15,9.96,10.05,19069069,191290102],[20190114,10.05,10.03,10.1,10.01,10.06,20352840,204659052],[20190115,10.06,10.1,10.15,10.05,10.11,15632125,158126136],[20190116,10.11,10.1,10.15,10.07,10.13,12988340,131354721],[20190117,10.13,10.17,10.28,10.07,10.17,22766048,232114667],[20190118,10.17,10.29,10.44,10.22,10.43,29087141,300979124],[20190121,10.43,10.36,10.46,10.3,10.35,18947789,196394076],[20190122,10.35,10.38,10.38,10.23,10.25,16250557,167165417],[20190123,10.25,10.29,10.34,10.25,10.27,16520327,170289907],[20190124,10.27,10.34,10.39,10.27,10.38,15006699,155265972],[20190125,10.38,10.45,10.56,10.38,10.5,19696587,206935398],[20190128,10.5,10.53,10.66,10.39,10.42,21769073,229185387],[20190129,10.42,10.39,10.63,10.38,10.58,23768004,250301612],[20190130,10.58,10.59,10.64,10.47,10.5,16054256,169387635],[20190131,10.5,10.59,10.73,10.51,10.73,25131034,267614893],[20190201,10.73,10.82,10.82,10.62,10.77,19119343,204604273],[20190211,10.77,10.62,10.73,10.62,10.7,20216568,215903077],[20190212,10.7,10.71,10.73,10.63,10.72,16769601,179099038],[20190213,10.72,10.74,10.93,10.68,10.86,30248695,325845959],[20190214,10.86,10.85,10.91,10.8,10.82,19815286,215023175],[20190215,10.82,10.78,10.85,10.66,10.66,17758789,190960435],[20190218,10.66,10.75,10.87,10.7,10.84,20102219,217621153],[20190219,10.84,10.85,10.96,10.78,10.8,25952745,281465131],[20190220,10.8,10.92,10.92,10.81,10.83,22286311,242111573],[20190221,10.83,10.83,10.93,10.75,10.79,25402390,275374197],[20190222,10.79,10.76,11.01,10.76,11.01,25907438,281913760],[20190225,11.01,11.03,11.95,11.03,11.92,93712264,1075040678],[20190226,11.92,11.91,12.15,11.6,11.65,83643265,990289721],[20190227,11.65,11.71,12.07,11.67,11.83,71201603,843023417],[20190228,11.83,11.83,11.92,11.68,11.74,39393414,464139463],[20190301,11.74,11.81,12.06,11.6,12.02,63254621,747753342],[20190304,12.02,12.12,12.38,11.95,12.02,85024777,1030561509],[20190305,12.02,12.01,12.04,11.87,11.98,54564202,652552200],[20190306,11.98,11.99,12.15,11.86,12.02,53693164,644243050],[20190307,12.02,12.03,12.04,11.87,11.88,52618824,628390863],[20190308,11.88,11.72,11.72,11.36,11.5,52670531,609490591],[20190311,11.5,11.44,11.59,11.36,11.47,39922020,457056506],[20190312,11.47,11.59,11.69,11.4,11.44,52211807,602940683],[20190313,11.44,11.41,11.56,11.3,11.44,41373014,472974759],[20190314,11.44,11.46,11.58,11.43,11.46,34337899,395468492],[20190315,11.46,11.47,11.6,11.43,11.43,33769320,388244487],[20190318,11.43,11.45,11.6,11.37,11.59,43879562,503915219],[20190319,11.59,11.63,11.67,11.51,11.55,27500231,318521475],[20190320,11.55,11.52,11.64,11.49,11.55,27325424,315587208],[20190321,11.55,11.56,11.59,11.44,11.46,35037035,403573243],[20190322,11.46,11.49,11.51,11.31,11.39,35436446,403972783],[20190325,11.39,11.28,11.29,11.01,11.03,57716577,642860108],[20190326,11.03,11.11,11.14,11.03,11.09,30795722,341425280],[20190327,11.09,11.11,11.24,11.04,11.08,42124489,469246326],[20190328,11.08,11.03,11.05,10.9,11.03,29296120,321585861],[20190329,11.03,10.98,11.3,10.98,11.28,60526266,678436536],[20190401,11.28,11.36,11.52,11.29,11.44,70637405,808657530],[20190402,11.44,11.5,11.52,11.41,11.44,46714710,534896810],[20190403,11.44,11.37,11.54,11.34,11.5,50271029,575799446],[20190404,11.5,11.55,11.71,11.54,11.71,75232527,876099547],[20190408,11.71,11.79,11.96,11.65,11.72,77870373,920513531],[20190409,11.72,11.72,11.75,11.49,11.54,56895992,660406225],[20190410,11.54,11.5,11.56,11.42,11.48,41027539,470666649],[20190411,11.48,11.47,11.59,11.35,11.47,50172794,575765348],[20190412,11.47,11.47,11.56,11.43,11.49,26273690,301752036],[20190415,11.49,11.67,11.77,11.46,11.47,70509167,823853432],[20190416,11.47,11.46,11.99,11.43,11.95,100665400,1188260123],[20190417,11.95,11.96,12.09,11.88,11.91,68157211,816127043],[20190418,11.91,11.91,12.05,11.84,11.91,43048980,513835270],[20190419,11.91,12.01,12.2,11.86,12.01,56013041,672739660],[20190422,12.01,12.02,12.07,11.68,11.71,53389418,631192357],[20190423,11.71,11.68,11.8,11.63,11.7,33847719,396659664],[20190424,11.7,11.76,11.77,11.51,11.62,38201108,444929313],[20190425,11.62,11.56,11.69,11.48,11.54,40876129,473973527],[20190426,11.54,11.43,11.56,11.28,11.32,42469581,485267261],[20190429,11.32,11.35,11.54,11.34,11.48,38586938,442046727],[20190430,11.48,11.7,12.09,11.7,11.97,123474738,1466714710],[20190506,11.97,11.75,11.86,11.54,11.8,124545414,1460217054],[20190507,11.8,11.82,11.94,11.6,11.8,85489922,1010271124],[20190508,11.8,11.64,11.78,11.49,11.51,58500103,677487368],[20190509,11.51,11.48,11.56,11.1,11.12,64128049,722119098],[20190510,11.12,11.23,11.42,11.06,11.32,48550722,548884302],[20190513,11.32,11.2,11.4,11.15,11.31,40284963,455643057],[20190514,11.31,11.18,11.44,11.17,11.21,41888998,473151522],[20190515,11.21,11.28,11.42,11.23,11.32,34404465,389533437],[20190516,11.32,11.28,11.36,11.22,11.3,34141755,385015233],[20190517,11.3,11.32,11.35,11.2,11.24,38399831,433108021],[20190520,11.24,11.28,11.44,11.25,11.34,34904438,396448397],[20190521,11.34,11.33,11.45,11.31,11.32,32975873,374972621],[20190522,11.32,11.32,11.34,11.12,11.16,40000391,447828812],[20190523,11.16,11.12,11.15,10.95,11.1,36312689,401709177],[20190524,11.1,11.17,11.22,11,11.11,24160265,269312449],[20190527,11.11,11.09,11.26,10.96,11.22,35087915,390018809],[20190528,11.22,11.19,11.3,11.02,11.29,72278135,809741253],[20190529,11.29,11.17,11.29,11.07,11.12,40860970,455620583],[20190530,11.12,11.18,11.18,11.03,11.11,26650033,295267455],[20190531,11.11,11.11,11.23,11.05,11.13,36976728,412819768],[20190603,11.13,11.17,11.29,11.13,11.28,30492063,342326268],[20190604,11.28,11.29,11.37,11.26,11.35,25077393,283826808],[20190605,11.35,11.43,11.52,11.35,11.41,31423641,359479709],[20190606,11.41,11.51,11.51,11.38,11.47,26427215,303162728],[20190610,11.47,11.57,11.7,11.53,11.61,43183779,502599177],[20190611,11.26,11.35,11.45,11.27,11.42,52266217,594464068],[20190612,11.42,11.42,11.7,11.4,11.6,50635228,584680927],[20190613,11.6,11.57,11.79,11.5,11.7,46966016,548219997],[20190614,11.7,11.74,11.87,11.71,11.79,47385174,558641883],[20190617,11.79,11.78,11.92,11.75,11.77,35220103,416594828],[20190618,11.77,11.82,11.9,11.72,11.82,28965124,341904864],[20190619,11.82,12.04,12.07,11.81,11.88,44927745,537339845],[20190620,11.88,11.95,12.32,11.85,12.2,71647496,869024541],[20190621,12.2,12.18,12.3,12.03,12.09,55381180,670759370],[20190624,12.09,12.09,12.13,11.96,12.03,34195336,411172373],[20190625,12.03,11.98,11.98,11.51,11.66,80359367,940465134],[20190626,11.66,11.56,11.73,11.55,11.66,36973199,431115050],[20190627,11.66,11.68,11.84,11.55,11.64,47997783,561472043],[20190628,11.64,11.67,11.68,11.54,11.68,29545173,343056316],[20190701,11.68,11.86,11.92,11.69,11.71,54887882,646405195],[20190702,11.71,11.72,11.74,11.57,11.61,51165729,595072188],[20190703,11.61,11.62,11.63,11.51,11.56,36567085,422580470],[20190704,11.56,11.61,11.67,11.57,11.62,30369201,352968330],[20190705,11.62,11.63,11.64,11.53,11.57,25753241,298158887],[20190708,11.57,11.56,11.57,11.31,11.36,34710676,395611376],[20190709,11.36,11.4,11.43,11.33,11.37,21885404,248524017],[20190710,11.37,11.43,11.43,11.31,11.35,23409890,265773696],[20190711,11.35,11.43,11.46,11.34,11.4,23285835,265672149],[20190712,11.4,11.39,11.62,11.39,11.52,34816996,400591791],[20190715,11.52,11.4,11.54,11.22,11.5,40305603,459022365],[20190716,11.5,11.5,11.57,11.44,11.55,21606007,248901949],[20190717,11.55,11.49,11.57,11.46,11.48,17480372,201420080],[20190718,11.48,11.53,11.53,11.45,11.49,18260034,209938962],[20190719,11.49,11.51,11.63,11.49,11.58,19619622,227078769],[20190722,11.58,11.54,11.63,11.47,11.48,25617875,295840612],[20190723,11.48,11.43,11.56,11.43,11.49,17927898,206511e3],[20190724,11.49,11.54,11.68,11.53,11.59,24112288,279914884],[20190725,11.59,11.57,11.96,11.57,11.88,55900219,660037408],[20190726,11.88,11.83,11.94,11.81,11.87,30368988,360677451],[20190729,11.87,11.9,11.94,11.8,11.86,21465011,254289650],[20190730,11.86,11.84,12,11.84,11.86,33731002,401937925],[20190731,11.86,11.81,11.94,11.73,11.87,30650758,362607630],[20190801,11.87,11.76,11.85,11.63,11.65,32471702,380252159],[20190802,11.65,11.48,11.56,11.41,11.48,38976091,447723838],[20190805,11.48,11.42,11.46,11.23,11.24,42719073,483523857],[20190806,11.24,11.1,11.23,10.97,11.09,45203853,501885625],[20190807,11.09,11.14,11.16,11.05,11.07,31462085,349267412],[20190808,11.07,11.15,11.31,11.11,11.26,33258085,373205583],[20190809,11.26,11.31,11.41,11.26,11.37,40637993,461422060],[20190812,11.37,11.33,11.45,11.31,11.43,34989082,398523209],[20190813,11.43,11.4,11.4,11.29,11.33,18839979,213447653],[20190814,11.33,11.42,11.48,11.28,11.28,19874457,225555663],[20190815,11.28,11.16,11.32,11.12,11.29,19101192,214656224],[20190816,11.29,11.25,11.34,11.21,11.22,24823561,279706602],[20190819,11.22,11.22,11.38,11.08,11.38,38253341,430744321],[20190820,11.38,11.3,11.47,11.28,11.37,23758050,270727986],[20190821,11.37,11.35,11.44,11.34,11.41,14656537,167119481],[20190822,11.41,11.43,11.45,11.37,11.43,15866836,180907933],[20190823,11.43,11.39,11.59,11.38,11.59,33655377,387195405],[20190826,11.59,11.39,11.44,11.15,11.3,41845176,472500378],[20190827,11.3,11.37,11.57,11.3,11.3,66247458,756664142],[20190828,11.3,11.37,11.4,11.3,11.32,25525597,289685352],[20190829,11.32,11.3,11.35,11.18,11.23,28049594,315060610],[20190830,11.23,11.34,11.37,11.22,11.28,25424004,287099396],[20190902,11.28,11.3,11.42,11.24,11.34,27749879,315706922],[20190903,11.34,11.39,11.41,11.31,11.35,16286609,184932344],[20190904,11.35,11.4,11.5,11.36,11.49,30670961,350981214],[20190905,11.49,11.5,11.74,11.5,11.62,46828e3,544694736],[20190906,11.62,11.68,11.7,11.58,11.69,34392057,400477410],[20190909,11.69,11.78,11.79,11.68,11.75,40059368,470186970],[20190910,11.75,11.79,11.86,11.69,11.85,37041097,437072473],[20190911,11.85,11.85,12,11.85,11.95,39063654,466909327],[20190912,11.95,12.08,12.09,11.92,12,26104824,313028158],[20190916,12,11.99,12.01,11.83,11.93,25489116,303225647],[20190917,11.93,11.96,12.01,11.77,11.81,33558932,399569109],[20190918,11.81,11.94,12,11.87,11.93,31387271,375059086],[20190919,11.93,12,12,11.88,11.94,23742171,283084515],[20190920,11.94,11.99,11.99,11.85,11.95,40109279,478010547],[20190923,11.95,11.9,11.92,11.68,11.75,27710795,325475285],[20190924,11.75,11.81,11.86,11.73,11.75,21870962,257910160],[20190925,11.75,11.75,11.95,11.69,11.81,30136356,356897100],[20190926,11.81,11.88,12.18,11.84,11.97,72726461,876687793],[20190927,11.97,11.95,11.99,11.76,11.9,36807878,437372188],[20190930,11.9,11.85,12.07,11.81,11.84,35947577,430109099],[20191008,11.84,11.8,12.03,11.8,11.9,32415886,386027564],[20191009,11.9,11.82,12.13,11.8,11.99,42209602,506474302],[20191010,11.99,12.02,12.04,11.91,11.96,27261229,326023332],[20191011,11.96,12.05,12.45,12,12.45,92030800,1131441679],[20191014,12.45,12.59,13.22,12.52,12.94,123970103,1596408955],[20191015,12.94,12.95,13.14,12.86,13.09,73394591,952804782],[20191016,13.09,13.08,13.33,12.9,13.08,67002223,876221010],[20191017,13.08,13.07,13.25,13.03,13.17,47869313,628571153],[20191018,13.17,13.24,13.29,12.72,12.78,64992896,840281772],[20191021,12.78,12.8,13.03,12.75,12.91,38996287,502880211],[20191022,12.91,13.03,13.05,12.77,12.93,31396257,404182674],[20191023,12.93,12.89,12.95,12.77,12.86,32821414,422141011],[20191024,12.86,12.98,13.24,12.95,13.09,103158806,1347032670],[20191025,13.09,13.09,13.09,12.78,12.9,97876357,1260246484],[20191028,12.9,12.75,12.88,12.65,12.7,72380466,919894887],[20191029,12.7,12.74,12.85,12.62,12.77,52604090,669546625],[20191030,12.77,12.75,12.79,12.52,12.59,53734730,678152770],[20191031,12.59,12.68,12.7,12.5,12.51,33347533,419182995],[20191101,12.51,12.5,12.83,12.44,12.75,62705733,793656950],[20191104,12.75,12.75,12.89,12.69,12.74,49737996,634816416],[20191105,12.74,12.74,13.19,12.69,12.95,74274389,962257376],[20191106,12.95,12.95,13.1,12.86,12.92,46023920,597016896],[20191107,12.92,12.95,12.95,12.71,12.76,46267281,592408771],[20191108,12.76,12.8,12.81,12.56,12.57,48841866,617218205],[20191111,12.57,12.48,12.48,12.29,12.29,38594267,477989511],[20191112,12.29,12.31,12.36,12.17,12.24,39239395,480742763],[20191113,12.24,12.21,12.29,12.15,12.23,32274979,394505189],[20191114,12.23,12.23,12.27,12.1,12.14,28943647,351795388],[20191115,12.14,12.22,12.26,12.12,12.15,27324299,332797325],[20191118,12.15,12.17,12.35,12.13,12.24,28796529,352880166],[20191119,12.24,12.2,12.31,12.18,12.23,29370803,359115488],[20191120,12.23,12.17,12.22,12.01,12.04,38092059,460234691],[20191121,12.04,12,12.04,11.91,11.96,34617175,414077527],[20191122,11.96,12.01,12.06,11.94,11.99,29531099,354250530],[20191125,11.99,12.03,12.14,12,12.07,25153256,303962341],[20191126,12.07,12.15,12.17,11.98,12.06,59633264,719075408],[20191127,12.06,12.07,12.07,11.9,11.99,28703956,343598879],[20191128,11.99,12,12.01,11.92,11.96,17797225,212826181],[20191129,11.96,11.93,12.07,11.89,11.91,24566935,293541788],[20191202,11.91,11.96,11.97,11.82,11.87,22163020,263131788],[20191203,11.87,11.81,11.9,11.77,11.86,19557865,231361399],[20191204,11.86,11.78,11.83,11.7,11.75,24734662,290465763],[20191205,11.75,11.79,11.89,11.76,11.89,24976130,295963968],[20191206,11.89,11.92,11.95,11.83,11.92,20654438,245635919],[20191209,11.92,11.9,11.93,11.85,11.9,17349258,206211639],[20191210,11.9,11.88,11.91,11.86,11.86,15324640,181988682],[20191211,11.86,11.88,11.99,11.85,11.98,33409045,398582360],[20191212,11.98,11.99,11.99,11.88,11.9,27021203,321917933],[20191213,11.9,11.98,12.12,11.94,12.12,59520554,716034787],[20191216,12.12,12.12,12.15,12,12.13,37971632,458170277],[20191217,12.13,12.17,12.51,12.1,12.39,57435605,707895681],[20191218,12.39,12.36,12.5,12.34,12.4,34565268,428827229],[20191219,12.4,12.4,12.5,12.38,12.41,23789907,295686647],[20191220,12.41,12.41,12.55,12.38,12.42,40150148,500592355],[20191223,12.42,12.46,12.46,12.17,12.2,37033891,455979055],[20191224,12.2,12.21,12.29,12.2,12.28,21671029,265496459],[20191225,12.28,12.29,12.29,12.2,12.24,13678175,167407896],[20191226,12.24,12.26,12.32,12.23,12.29,15739054,193083033],[20191227,12.29,12.25,12.43,12.25,12.32,27932109,344832499],[20191230,12.32,12.27,12.36,12.12,12.34,41051555,503090483],[20191231,12.34,12.32,12.38,12.21,12.37,31953628,392736236],[20200102,12.37,12.47,12.64,12.45,12.47,51629079,647446166],[20200103,12.47,12.57,12.63,12.47,12.6,38018810,477053357],[20200106,12.6,12.52,12.65,12.42,12.46,41001193,514432551],[20200107,12.46,12.51,12.6,12.46,12.5,28421482,355811756],[20200108,12.5,12.41,12.45,12.25,12.32,35240536,434980266],[20200109,12.32,12.39,12.43,12.35,12.37,26151448,324168061],[20200110,12.37,12.37,12.42,12.31,12.39,18321252,226580302],[20200113,12.39,12.4,12.41,12.31,12.41,20715566,255982380],[20200114,12.41,12.4,12.69,12.39,12.43,29994561,374971640],[20200115,12.43,12.41,12.45,12.25,12.25,31897217,392531149],[20200116,12.25,12.28,12.31,12.16,12.2,22454876,274130148],[20200117,12.2,12.22,12.29,12.16,12.23,17593111,215028083],[20200120,12.23,12.26,12.27,12.19,12.25,23734609,290296136],[20200121,12.25,12.2,12.25,12.04,12.08,31787474,384580844],[20200122,12.08,11.7,11.84,11.65,11.77,78133556,917203481],[20200123,11.77,11.75,11.75,11.32,11.35,76534796,879151046],[20200203,11.35,10.22,10.69,10.22,10.47,95367382,997686058],[20200204,10.47,10.51,10.74,10.48,10.66,66783767,710434836],[20200205,10.66,10.69,10.78,10.58,10.7,45046658,481639081],[20200206,10.7,10.81,10.86,10.65,10.79,38023801,408101901],[20200207,10.79,10.73,10.91,10.67,10.86,31896956,342581621],[20200210,10.86,10.76,10.84,10.71,10.77,34032121,366391170],[20200211,10.77,10.82,10.95,10.78,10.86,34856302,378583345],[20200212,10.86,10.84,10.88,10.76,10.86,26313927,284693716],[20200213,10.86,10.82,10.88,10.76,10.76,22630613,244794981],[20200214,10.76,10.76,10.88,10.74,10.86,22360549,242102421],[20200217,10.86,10.88,11.21,10.86,11.18,41343320,457641227],[20200218,11.18,11.09,11.18,11.04,11.06,30162703,334474238],[20200219,11.06,11.08,11.24,11.04,11.11,25100157,279375283],[20200220,11.11,11.17,11.27,11.06,11.23,36656416,408938116],[20200221,11.23,11.23,11.39,11.21,11.3,38949418,439706991],[20200224,11.3,11.23,11.34,11.1,11.16,44738622,501186013],[20200225,11.16,11.07,11.15,11.01,11.09,48324564,535241824],[20200226,11.09,11.01,11.33,11.01,11.2,51906287,581437742],[20200227,11.2,11.2,11.3,11.13,11.21,33029824,370549707],[20200228,11.21,11.11,11.18,10.85,10.85,50137988,550529618],[20200302,10.85,10.95,11.1,10.92,11.04,39245056,432698824],[20200303,11.04,11.13,11.23,11.04,11.06,39332460,437422565],[20200304,11.06,11.01,11.1,10.95,11.03,34628358,381014627],[20200305,11.03,11.08,11.32,11.03,11.32,73047882,819311470],[20200306,11.32,11.23,11.28,11.11,11.12,41587820,464404003],[20200309,11.12,11,11,10.75,10.78,59495242,644379973],[20200310,10.78,10.71,10.96,10.7,10.87,44761737,485896696],[20200311,10.87,10.93,10.93,10.77,10.77,31688826,343734180],[20200312,10.77,10.75,10.75,10.61,10.64,32632350,348157969],[20200313,10.64,10.4,10.73,10.28,10.7,57457109,603756305],[20200316,10.7,10.7,10.78,10.5,10.51,47649924,507308318],[20200317,10.51,10.68,10.69,10.29,10.43,42139008,440636619],[20200318,10.43,10.4,10.5,10.2,10.21,33176646,343553119],[20200319,10.21,10.19,10.34,9.86,9.94,55707113,558047012],[20200320,9.94,10.12,10.18,9.96,10.09,42609358,428744766],[20200323,10.09,9.95,9.95,9.82,9.84,28286030,279043930],[20200324,9.84,10.03,10.13,9.98,10.06,28990754,291586379],[20200325,10.06,10.2,10.27,10.12,10.15,32172278,327768574],[20200326,10.15,10.1,10.37,10.08,10.23,30921803,315960382],[20200327,10.23,10.35,10.38,10.2,10.24,27107951,278718751],[20200330,10.24,10.18,10.28,10.11,10.28,26046018,265782024],[20200331,10.28,10.3,10.36,10.13,10.15,26144854,267681227],[20200401,10.15,10.11,10.26,10.09,10.09,22479192,228559545],[20200402,10.09,10.09,10.2,10.07,10.2,17042135,172675321],[20200403,10.2,10.13,10.21,10.12,10.15,14842382,150706819],[20200407,10.15,10.3,10.33,10.23,10.28,23825611,244911012],[20200408,10.28,10.25,10.29,10.18,10.24,17952255,183606904],[20200409,10.24,10.26,10.29,10.18,10.2,13569586,138881044],[20200410,10.2,10.22,10.24,10.15,10.21,16625528,169625912],[20200413,10.21,10.15,10.22,10.1,10.11,11966986,121315470],[20200414,10.11,10.17,10.25,10.12,10.25,17792926,181192027],[20200415,10.25,10.2,10.27,10.15,10.18,14945608,152284659],[20200416,10.18,10.1,10.18,10.1,10.16,14403197,145969853],[20200417,10.16,10.18,10.23,10.15,10.2,22744411,231788988],[20200420,10.2,10.15,10.19,10.09,10.11,23503715,237574344],[20200421,10.11,10.07,10.12,10.01,10.03,17557525,176508085],[20200422,10.03,10.02,10.07,9.98,10.07,15802441,158372535],[20200423,10.07,10.1,10.1,10.01,10.06,16878643,169579075],[20200424,10.06,10.06,10.09,10.01,10.06,16973113,170599170],[20200427,10.06,10.15,10.42,10.15,10.34,50342806,520243997],[20200428,10.34,10.36,10.38,10.22,10.33,29222578,301584635],[20200429,10.33,10.35,10.61,10.33,10.61,35056836,367739389],[20200430,10.61,10.58,10.79,10.56,10.63,30906971,330157488],[20200506,10.63,10.44,10.49,10.36,10.46,41378362,431336740],[20200507,10.46,10.45,10.46,10.37,10.39,26211656,272516386],[20200508,10.39,10.44,10.49,10.4,10.44,20927670,218698514],[20200511,10.44,10.44,10.54,10.42,10.43,21472495,224819916],[20200512,10.43,10.44,10.48,10.34,10.34,19405945,201474588],[20200513,10.34,10.31,10.39,10.28,10.38,15574310,160783648],[20200514,10.38,10.32,10.36,10.27,10.3,15892376,163558192],[20200515,10.3,10.36,10.38,10.26,10.28,13753770,141846602],[20200518,10.28,10.28,10.43,10.25,10.32,15675941,162140715],[20200519,10.32,10.45,10.45,10.34,10.35,12576997,130445254],[20200520,10.35,10.37,10.42,10.33,10.41,20046300,208195248],[20200521,10.41,10.44,10.44,10.33,10.33,14361684,149140643],[20200522,10.33,10.3,10.34,10.14,10.14,23722915,243204611],[20200525,10.14,10.3,10.31,10.13,10.27,15722012,160438358],[20200526,10.27,10.32,10.32,10.25,10.27,14372249,147713417],[20200527,10.27,10.28,10.38,10.25,10.35,20145712,208419130],[20200528,10.35,10.36,10.55,10.36,10.53,38263189,401358593],[20200529,10.53,10.45,10.57,10.45,10.57,30659227,322828566],[20200601,10.57,10.63,10.72,10.57,10.65,28612841,304346423],[20200602,10.65,10.58,10.74,10.58,10.68,25922545,276609954],[20200603,10.68,10.75,10.87,10.7,10.7,27352188,294473001],[20200604,10.7,10.8,10.8,10.64,10.64,17559033,187688384],[20200605,10.64,10.68,10.69,10.56,10.67,20958291,222668156],[20200608,10.67,10.64,10.72,10.6,10.61,18251152,194265349],[20200609,10.61,10.62,10.72,10.58,10.68,17263160,184089097],[20200610,10.68,10.71,10.71,10.58,10.58,16693480,177440922],[20200611,10.58,10.58,10.61,10.45,10.48,25171455,264822302],[20200612,10.48,10.58,10.58,10.43,10.55,25514482,267574331],[20200615,10.55,10.41,10.49,10.35,10.35,25497883,265574307],[20200616,10.35,10.44,10.5,10.4,10.45,17682742,184966297],[20200617,10.45,10.44,10.51,10.43,10.47,16148594,169024390],[20200618,10.47,10.42,10.57,10.39,10.5,20856551,218713603],[20200619,10.5,10.56,10.68,10.5,10.61,39814479,422462428],[20200622,10.61,10.57,10.66,10.53,10.55,24611903,260728901],[20200623,10.55,10.51,10.57,10.47,10.48,19602212,206109220],[20200624,10.48,10.54,10.61,10.5,10.6,22873884,241489165],[20200629,10.6,10.63,10.73,10.49,10.57,27875619,295223647],[20200630,10.57,10.59,10.64,10.54,10.58,22886764,242601910],[20200701,10.58,10.59,10.76,10.55,10.74,36690710,390832225],[20200702,10.74,10.73,11.05,10.7,11.05,60951268,663308323],[20200703,11.05,11.08,11.26,11.02,11.19,82238477,916157920],[20200706,11.19,11.3,12.31,11.29,12.2,149558001,1776417981],[20200707,12.2,12.45,12.69,12.1,12.11,131469759,1621839646],[20200708,12.11,12.17,12.44,12.03,12.14,104879230,1282339816],[20200709,12.14,12.26,12.26,11.94,11.99,91311738,1101713242],[20200710,11.99,11.98,12.09,11.55,11.6,78611864,925839420],[20200713,11.6,11.6,11.85,11.56,11.66,96564333,1128297577],[20200714,11.66,11.61,11.69,11.33,11.38,79944260,919482272],[20200715,11.38,11.47,11.47,11.14,11.18,92438310,1042128861],[20200716,11.18,11.25,11.48,11.2,11.2,96614162,1094090004],[20200717,11.2,11.37,11.39,11.17,11.27,68639480,771657319],[20200720,11.27,11.32,11.57,11.27,11.52,78766518,901216619],[20200721,11.52,11.59,11.61,11.4,11.54,55004587,632576750],[20200722,11.54,11.55,11.75,11.5,11.62,98687637,1147395851],[20200723,11.02,10.99,10.99,10.61,10.84,86806896,937319747],[20200724,10.84,10.78,10.8,10.4,10.42,72886391,769923511],[20200727,10.42,10.55,10.55,10.32,10.37,44655910,465608566],[20200728,10.37,10.46,10.54,10.35,10.39,32599274,339999711],[20200729,10.39,10.35,10.54,10.32,10.51,45256602,474093213],[20200730,10.51,10.51,10.53,10.4,10.4,40443481,422561054],[20200731,10.4,10.41,10.52,10.31,10.36,65368427,679850126],[20200803,10.36,10.4,10.48,10.37,10.41,56272005,586201746],[20200804,10.41,10.46,10.72,10.43,10.66,88522454,937235109],[20200805,10.66,10.64,10.64,10.45,10.51,46011280,483338972],[20200806,10.51,10.57,10.63,10.41,10.53,42484232,445698833],[20200807,10.53,10.51,10.53,10.36,10.43,44271966,461730421],[20200810,10.43,10.42,10.57,10.39,10.52,48973967,514604348],[20200811,10.52,10.58,10.68,10.45,10.47,63673224,676102351],[20200812,10.47,10.49,10.6,10.46,10.56,43268629,455458282],[20200813,10.56,10.6,10.61,10.5,10.51,25798477,271625415],[20200814,10.51,10.53,10.6,10.48,10.59,37584530,396506223],[20200817,10.59,10.59,10.98,10.57,10.84,98742699,1066482968],[20200818,10.84,10.85,10.85,10.63,10.69,54091961,580056196],[20200819,10.69,10.69,10.74,10.57,10.58,43448106,462151805],[20200820,10.58,10.56,10.57,10.43,10.47,53539028,559975457],[20200821,10.47,10.56,10.56,10.45,10.5,31451520,329790601],[20200824,10.5,10.57,10.57,10.44,10.46,38982822,408922475],[20200825,10.46,10.48,10.51,10.41,10.45,37897250,396122405],[20200826,10.45,10.44,10.45,10.35,10.37,39278732,408174292],[20200827,10.37,10.38,10.4,10.32,10.35,30462492,315213297],[20200828,10.35,10.35,10.46,10.31,10.46,53131203,552429111],[20200831,10.46,10.46,10.51,10.32,10.36,80037356,835524366],[20200901,10.36,10.31,10.36,10.26,10.29,53931233,555922099],[20200902,10.29,10.28,10.29,10.12,10.18,56787081,578763479],[20200903,10.18,10.19,10.23,10.11,10.12,40832020,414701608],[20200904,10.12,10.07,10.15,10.01,10.07,38443982,387141418],[20200907,10.07,10.07,10.16,10.01,10.01,58564585,589509231],[20200908,10.01,10.07,10.09,10.01,10.05,52972540,532346433],[20200909,10.05,10.01,10.08,10,10.01,49418500,496009217],[20200910,10.01,10.06,10.06,9.94,9.96,54169916,540727381],[20200911,9.96,9.95,9.96,9.85,9.92,49947642,494619680],[20200914,9.92,9.95,9.95,9.86,9.9,38851230,384257706],[20200915,9.9,9.91,9.92,9.85,9.86,46601549,459933678],[20200916,9.86,9.87,9.9,9.8,9.86,51470657,507227129],[20200917,9.86,9.87,9.89,9.8,9.83,43171675,424496712],[20200918,9.83,9.84,9.94,9.8,9.94,95230581,941630508],[20200921,9.94,9.94,9.97,9.83,9.84,55998716,553037614],[20200922,9.84,9.81,9.84,9.69,9.7,65952098,643194146],[20200923,9.7,9.71,9.72,9.62,9.63,41909587,404393340],[20200924,9.63,9.61,9.62,9.46,9.5,53858739,512493256],[20200925,9.5,9.5,9.53,9.46,9.47,29487505,279750442],[20200928,9.47,9.49,9.53,9.46,9.46,26257827,249063489],[20200929,9.46,9.5,9.52,9.43,9.43,32988266,312583585],[20200930,9.43,9.45,9.49,9.35,9.39,39006807,367745389],[20201009,9.39,9.44,9.48,9.4,9.42,39772687,375559366],[20201012,9.42,9.45,9.63,9.42,9.59,66671637,637356691],[20201013,9.59,9.58,9.59,9.52,9.54,28059097,267595711],[20201014,9.54,9.54,9.56,9.5,9.53,42969217,409511682],[20201015,9.53,9.54,9.72,9.53,9.62,66146732,637856656],[20201016,9.62,9.61,9.77,9.6,9.72,74850236,726361116],[20201019,9.72,9.73,9.93,9.64,9.65,84532385,826077895],[20201020,9.65,9.63,9.65,9.51,9.58,46687029,446894604],[20201021,9.58,9.58,9.7,9.51,9.7,61622129,592503579],[20201022,9.7,9.67,9.76,9.59,9.65,47288884,456765639],[20201023,9.65,9.63,9.79,9.62,9.7,70954476,689493437],[20201026,9.7,9.72,9.75,9.59,9.6,52711443,508770628],[20201027,9.6,9.59,9.59,9.48,9.48,38062780,362632659],[20201028,9.48,9.48,9.52,9.38,9.4,45881367,432093181],[20201029,9.4,9.35,9.45,9.34,9.37,43707348,409990836],[20201030,9.37,9.38,9.45,9.25,9.26,56060864,523487861],[20201102,9.26,9.28,9.33,9.22,9.25,46542251,431202859],[20201103,9.25,9.31,9.4,9.28,9.3,67876111,632973897],[20201104,9.3,9.35,9.4,9.28,9.34,50256088,469008803],[20201105,9.34,9.46,9.46,9.33,9.36,55873229,523812724],[20201106,9.36,9.37,9.43,9.33,9.39,63919592,600129369],[20201109,9.39,9.42,9.48,9.39,9.43,88937655,839142820],[20201110,9.43,9.47,9.59,9.44,9.46,84217864,800256172],[20201111,9.46,9.49,9.58,9.44,9.56,64171805,610306555],[20201112,9.56,9.52,9.53,9.43,9.43,51891050,491018805],[20201113,9.43,9.41,9.41,9.33,9.36,44910112,420337400],[20201116,9.36,9.38,9.46,9.37,9.45,31878052,300508257],[20201117,9.45,9.46,9.53,9.44,9.53,47293970,448873504],[20201118,9.53,9.53,9.77,9.5,9.7,109417513,1059930873],[20201119,9.7,9.7,9.78,9.64,9.74,63840056,620569638],[20201120,9.74,9.68,9.72,9.61,9.67,46631360,450166503],[20201123,9.67,9.66,9.92,9.63,9.9,92618240,909448904],[20201124,9.9,9.92,9.97,9.82,9.85,61221709,605831671],[20201125,9.85,9.9,9.99,9.81,9.81,61216111,606063472],[20201126,9.81,9.84,9.99,9.76,9.98,71595543,709188721],[20201127,9.98,10.01,10.2,9.96,10.2,113388037,1141650217],[20201130,10.2,10.3,10.53,10.06,10.06,203498922,2102112686],[20201201,10.06,10.08,10.35,10.01,10.3,107812159,1099269636],[20201202,10.3,10.26,10.39,10.19,10.25,78702779,808812296],[20201203,10.25,10.23,10.28,10.16,10.24,57195735,584153273],[20201204,10.24,10.24,10.25,10.05,10.17,47336450,479183315],[20201207,10.17,10.11,10.17,9.9,9.99,57810545,577584101],[20201208,9.99,9.97,10.06,9.93,9.98,31522398,315079838],[20201209,9.98,9.98,10.09,9.91,9.91,44090061,440752941],[20201210,9.91,9.91,9.96,9.76,9.82,39400878,388252088],[20201211,9.82,9.84,9.88,9.69,9.7,48386569,471620087],[20201214,9.7,9.75,9.8,9.68,9.75,38743836,376928042],[20201215,9.75,9.73,9.74,9.6,9.71,39323070,379468278],[20201216,9.71,9.72,9.78,9.64,9.65,47998904,465187094],[20201217,9.65,9.64,9.79,9.59,9.77,42901555,415257095],[20201218,9.77,9.74,9.79,9.69,9.76,31884462,310411756],[20201221,9.76,9.7,9.77,9.65,9.75,31965504,310813655],[20201222,9.75,9.75,9.75,9.55,9.61,50418001,485974240],[20201223,9.61,9.6,9.64,9.48,9.55,38656338,368816679],[20201224,9.55,9.55,9.66,9.51,9.55,24871912,238279376],[20201225,9.55,9.56,9.61,9.51,9.58,22420976,214427367],[20201228,9.58,9.55,9.63,9.5,9.57,33765935,322826382],[20201229,9.57,9.59,9.62,9.52,9.53,44150648,421945426],[20201230,9.53,9.52,9.54,9.44,9.5,54885564,519975315],[20201231,9.5,9.51,9.69,9.49,9.68,65992362,635666178],[20210104,9.68,9.64,9.73,9.55,9.69,62906939,606364959],[20210105,9.69,9.68,9.68,9.52,9.68,53859177,517135737],[20210106,9.68,9.62,9.83,9.62,9.82,61881321,604071110],[20210107,9.82,9.83,9.93,9.66,9.81,57090442,557051920],[20210108,9.81,9.83,9.9,9.73,9.83,55801455,547035205],[20210111,9.83,9.83,9.94,9.68,9.69,75984056,745359165],[20210112,9.69,9.7,9.79,9.58,9.78,56732878,548277788],[20210113,9.78,9.75,9.88,9.72,9.84,57145173,560579198],[20210114,9.84,9.83,9.96,9.76,9.87,55338565,545908487],[20210115,9.87,9.98,10.23,9.92,9.92,143067603,1440725952],[20210118,9.92,9.92,10.12,9.87,10.08,96389498,962800689],[20210119,10.08,10.07,10.22,9.98,10.16,82816180,837479675],[20210120,10.16,10.13,10.18,9.96,9.98,66608913,669394442],[20210121,9.98,9.99,10.07,9.93,9.97,53622907,536180004],[20210122,9.97,9.96,9.97,9.76,9.79,61879785,607707949],[20210125,9.79,9.77,9.78,9.67,9.72,51705648,501372368],[20210126,9.72,9.69,9.78,9.66,9.68,39877611,386930899],[20210127,9.68,9.67,9.88,9.66,9.73,55174457,539658292],[20210128,9.73,9.73,9.74,9.61,9.66,52360924,506059207],[20210129,9.66,9.69,10.13,9.65,9.96,115257482,1142597659],[20210201,9.96,9.94,10.48,9.9,10.44,181883788,1867280983],[20210202,10.44,10.35,10.47,10.15,10.22,131403970,1349638625],[20210203,10.22,10.19,10.43,10.06,10.26,131150745,1346692050],[20210204,10.26,10.21,10.41,10.12,10.28,92016450,944124558],[20210205,10.28,10.28,10.82,10.25,10.72,195506162,2078645791],[20210208,10.72,10.71,10.81,10.51,10.72,137089506,1467791360],[20210209,10.72,10.7,10.74,10.54,10.68,99871998,1061301527],[20210210,10.68,10.67,10.85,10.56,10.69,105092241,1123961356],[20210218,10.69,10.8,11.02,10.74,10.83,143397923,1558504811],[20210219,10.83,10.83,11.12,10.77,10.97,122926300,1351290391],[20210222,10.97,10.92,10.95,10.7,10.71,127379414,1373533382],[20210223,10.71,10.71,10.99,10.71,10.78,93327786,1010901316],[20210224,10.78,10.81,10.89,10.55,10.6,97783999,1047470279],[20210225,10.6,10.66,10.85,10.6,10.8,89855495,964732755],[20210226,10.8,10.72,10.82,10.54,10.54,85386093,909298105],[20210301,10.54,10.59,10.64,10.5,10.58,54746126,578491496],[20210302,10.58,10.61,10.7,10.36,10.47,74763149,786616693],[20210303,10.47,10.45,10.92,10.43,10.92,113570860,1224387994],[20210304,10.92,10.8,10.92,10.76,10.88,75412865,817817159],[20210305,10.88,10.87,10.94,10.69,10.86,72154782,778561759],[20210308,10.86,10.98,11.02,10.71,10.75,80153097,869553733],[20210309,10.75,10.78,10.9,10.65,10.73,83584061,900880589],[20210310,10.73,10.76,10.79,10.63,10.72,50512161,542100935],[20210311,10.72,10.8,10.97,10.76,10.9,76816962,836848985],[20210312,10.9,10.89,11.03,10.82,10.9,79235629,866141111],[20210315,10.9,10.88,11.24,10.88,11.12,113524449,1259911417],[20210316,11.12,11.05,11.24,11.01,11.11,65502259,728108285],[20210317,11.11,11.1,11.12,10.89,10.92,57821851,634262121],[20210318,10.92,10.97,11.05,10.9,11.03,50943550,559643203],[20210319,11.03,11.01,11.05,10.56,10.65,103359887,1110156577],[20210322,10.65,10.62,10.88,10.62,10.75,66031003,710176261],[20210323,10.75,10.76,10.83,10.68,10.78,47127710,506263416],[20210324,10.78,10.77,10.81,10.63,10.68,44132642,472480388],[20210325,10.68,10.72,10.78,10.61,10.63,43547662,465464539],[20210326,10.63,10.68,10.73,10.61,10.62,40882734,435739848],[20210329,10.62,10.6,10.6,10.4,10.48,92366772,964797269],[20210330,10.48,10.65,11.01,10.62,11.01,173447215,1882440615],[20210331,11.01,11.01,11.04,10.87,10.99,66813691,731611999],[20210401,10.99,10.99,11.01,10.81,10.89,47781207,519576384],[20210402,10.89,10.94,10.95,10.67,10.76,65365057,704137147],[20210406,10.76,10.76,10.79,10.68,10.7,33911224,363567283],[20210407,10.7,10.74,10.75,10.58,10.65,60988540,648631699],[20210408,10.65,10.63,10.7,10.56,10.66,42047850,447410758],[20210409,10.66,10.64,10.64,10.53,10.59,38683022,409118551],[20210412,10.59,10.58,10.75,10.52,10.73,57023744,608748238],[20210413,10.73,10.74,10.82,10.67,10.76,52756234,566984752],[20210414,10.76,10.82,10.82,10.57,10.59,45686754,486204160],[20210415,10.59,10.58,10.61,10.38,10.43,53172372,555086924],[20210416,10.43,10.45,10.55,10.42,10.54,32895624,345237987],[20210419,10.54,10.55,10.64,10.45,10.58,50203914,529864990],[20210420,10.58,10.55,10.58,10.48,10.5,29450563,309777290],[20210421,10.5,10.47,10.62,10.46,10.58,45439718,480039018],[20210422,10.58,10.6,10.6,10.4,10.43,41793378,437919109],[20210423,10.43,10.42,10.47,10.38,10.43,24825285,259051575],[20210426,10.43,10.45,10.5,10.28,10.3,46387212,482566266],[20210427,10.3,10.33,10.34,10.24,10.27,25042540,257631072],[20210428,10.27,10.33,10.33,10.18,10.25,35321183,361207957],[20210429,10.25,10.28,10.55,10.26,10.54,48194627,503908364],[20210430,10.54,10.28,10.28,9.96,10.05,156103445,1570141012],[20210506,10.05,9.97,10.18,9.97,10.1,61139167,616780672],[20210507,10.1,10.1,10.15,9.99,10.03,72345288,728759605],[20210510,10.03,10.06,10.06,9.88,9.95,61516454,610992515],[20210511,9.95,9.92,10.07,9.9,10.05,42333780,423538345],[20210512,10.05,10.04,10.2,10.02,10.12,52012085,526835923],[20210513,10.12,10.09,10.17,10.01,10.09,47212565,475665503],[20210514,10.09,10.1,10.2,10.03,10.19,47681403,483068527],[20210517,10.19,10.2,10.29,10.13,10.21,46363314,473603666],[20210518,10.21,10.18,10.23,10.15,10.22,19093505,194624788],[20210519,10.22,10.19,10.2,10.07,10.12,29273907,296073789],[20210520,10.12,10.1,10.18,10.02,10.16,35395264,357783848],[20210521,10.16,10.2,10.22,10.07,10.09,28618932,289959893],[20210524,10.09,10.08,10.14,10.05,10.09,23518901,237130459],[20210525,10.09,10.1,10.33,10.06,10.32,75417564,771994298],[20210526,10.32,10.31,10.42,10.28,10.35,54984815,568991552],[20210527,10.35,10.32,10.43,10.26,10.29,52063330,536862488],[20210528,10.29,10.33,10.36,10.25,10.35,34593293,356339747],[20210531,10.35,10.34,10.34,10.22,10.27,37255726,381740400],[20210601,10.27,10.23,10.26,10.18,10.19,41880384,427253269],[20210602,10.19,10.21,10.23,10.13,10.22,35830478,364475986],[20210603,10.22,10.21,10.32,10.18,10.23,52244908,535599653],[20210604,10.23,10.25,10.38,10.19,10.23,71052432,729772587],[20210607,10.23,10.26,10.27,10.2,10.23,36301400,371369102],[20210608,10.23,10.24,10.33,10.18,10.31,50838116,522323155],[20210609,10.31,10.29,10.35,10.21,10.21,56095091,575008507],[20210610,10.21,10.21,10.31,10.2,10.23,45685432,467893685],[20210611,10.23,10.24,10.28,10.11,10.17,58030251,591098508],[20210615,10.17,10.15,10.15,10.01,10.03,46955773,472150826],[20210616,10.03,10.04,10.14,10.01,10.05,32171081,324482532],[20210617,10.05,10.05,10.12,10.03,10.04,29689848,298576626],[20210618,10.04,10.04,10.1,10,10.1,44451210,446813171],[20210621,10.1,10.06,10.09,10.01,10.04,39815744,399756079],[20210622,10.04,10.06,10.12,10,10,45184564,453604604],[20210623,10,10.01,10.03,9.96,9.99,34400099,343745819],[20210624,9.99,10,10.05,9.97,10.02,31652661,316690710],[20210625,10.02,10.02,10.11,10.01,10.08,48335388,486548042],[20210628,10.08,10.06,10.07,9.99,10.01,32597114,326457360],[20210629,10.01,10.01,10.04,9.98,9.98,32733370,327178180],[20210630,9.98,10,10.02,9.97,10,21580051,215772914],[20210701,10,10.01,10.06,9.99,10.03,36999138,370991509],[20210702,10.03,10.01,10.05,9.92,9.93,51535129,513421350],[20210705,9.93,9.95,9.96,9.85,9.92,44806863,442917699],[20210706,9.92,9.91,10.01,9.88,9.99,37737379,375924559],[20210707,9.99,10.01,10.04,9.94,10.03,35666988,356794175],[20210708,10.03,10.05,10.05,9.92,9.94,30745176,306373156],[20210709,9.94,9.93,10.01,9.9,9.91,34590087,343545047],[20210712,9.91,9.96,9.99,9.9,9.91,33415612,332219128],[20210713,9.91,9.94,9.99,9.88,9.96,34611654,344399322],[20210714,9.96,9.97,9.97,9.8,9.83,52207557,514554736],[20210715,9.83,9.83,9.96,9.81,9.94,45903396,454671008],[20210716,9.94,10.01,10.08,9.96,9.98,45557802,455679343],[20210719,9.98,9.98,10.03,9.85,10.01,53049438,527117554],[20210720,10.01,10.01,10.02,9.94,9.99,36834727,367615291],[20210721,9.51,9.51,9.64,9.51,9.55,58450876,558646900],[20210722,9.55,9.58,9.72,9.56,9.64,43977169,424674366],[20210723,9.64,9.6,9.67,9.57,9.58,30090322,289065063],[20210726,9.58,9.57,9.58,9.3,9.34,51742715,486767435],[20210727,9.34,9.36,9.43,9.09,9.15,53279860,494584132],[20210728,9.15,9.16,9.36,9.16,9.21,46335875,428304156],[20210729,9.21,9.25,9.28,9.1,9.12,43587733,398885079],[20210730,9.12,9.13,9.13,9.01,9.03,35697122,323216885],[20210802,9.03,9.03,9.24,8.97,9.13,45713350,416533737],[20210803,9.13,9.13,9.14,9.04,9.12,33014050,300047780],[20210804,9.12,9.12,9.14,9.05,9.07,25214494,229004469],[20210805,9.07,9.06,9.12,9.04,9.05,24267799,220300799],[20210806,9.05,9.05,9.08,9,9.08,22486126,203315738],[20210809,9.08,9.06,9.25,9.05,9.17,37461914,344052120],[20210810,9.17,9.18,9.23,9.1,9.2,34370935,314539916],[20210811,9.2,9.18,9.29,9.16,9.21,37382098,345067502],[20210812,9.21,9.21,9.22,9.16,9.17,22978467,211023250],[20210813,9.17,9.16,9.23,9.14,9.18,21925988,201254904],[20210816,9.18,9.19,9.27,9.16,9.22,27369511,252450157],[20210817,9.22,9.23,9.29,9.17,9.19,38016760,350733815],[20210818,9.19,9.2,9.39,9.16,9.33,43424745,403158874],[20210819,9.33,9.34,9.34,9.19,9.23,36391371,336172105],[20210820,9.23,9.25,9.3,9.18,9.27,35374387,327037545],[20210823,9.27,9.3,9.31,9.2,9.2,32418942,299502501],[20210824,9.2,9.22,9.3,9.17,9.21,40815968,376573366],[20210825,9.21,9.23,9.24,9.16,9.19,34063999,313176527],[20210826,9.19,9.18,9.2,9.13,9.14,29439149,269637951],[20210827,9.14,9.16,9.22,9.14,9.17,27618817,253490156],[20210830,9.17,9.05,9.08,8.92,8.96,80410279,721952836],[20210831,8.96,8.98,9.05,8.93,9.05,44633690,401545634],[20210901,9.05,9.03,9.23,9.01,9.18,58211312,532088406],[20210902,9.18,9.2,9.24,9.16,9.23,40122727,369226846],[20210903,9.23,9.24,9.33,9.16,9.24,50781588,470393997],[20210906,9.24,9.22,9.31,9.2,9.21,35627742,329503566],[20210907,9.21,9.21,9.39,9.16,9.34,64051787,594700224],[20210908,9.34,9.34,9.39,9.29,9.34,40941784,382017869],[20210909,9.34,9.32,9.34,9.25,9.3,31951355,297126954],[20210910,9.3,9.32,9.48,9.31,9.41,57250718,537963809],[20210913,9.41,9.38,9.43,9.34,9.39,29373307,275283515],[20210914,9.39,9.39,9.43,9.17,9.21,53934721,500630063],[20210915,9.21,9.21,9.26,9.13,9.19,38064766,349607328],[20210916,9.19,9.2,9.23,9.11,9.12,49199895,450453204],[20210917,9.12,9.11,9.17,9.08,9.11,30233529,275167575],[20210922,9.11,9,9.08,8.96,9.03,35054148,316134897],[20210923,9.03,9.1,9.15,9.01,9.03,39639967,359242361],[20210924,9.03,9.04,9.08,8.99,9.02,39925596,360045375],[20210927,9.02,9.02,9.05,8.94,9.02,41708355,374465142],[20210928,9.02,8.98,9.09,8.98,9.03,33340762,301762292],[20210929,9.03,9.01,9.09,8.97,9.02,40008268,361288902],[20210930,9.02,9.03,9.05,8.98,9,29190245,262917687],[20211008,9,9.05,9.15,9.03,9.08,39080557,354870725],[20211011,9.08,9.12,9.25,9.1,9.15,46632488,427661681],[20211012,9.15,9.12,9.19,9.09,9.14,35725751,326390581],[20211013,9.14,9.14,9.15,9.05,9.07,22538281,204856494],[20211014,9.07,9.07,9.09,9.02,9.04,22584606,204329607],[20211015,9.04,9.05,9.11,9.02,9.07,27525449,249700096],[20211018,9.07,9.06,9.1,8.98,9.02,25964695,234209597],[20211019,9.02,9.03,9.07,9.01,9.01,28636166,258552846],[20211020,9.01,9.03,9.06,8.99,9.02,27482428,247758529],[20211021,9.02,9.05,9.09,9.01,9.04,44074576,398999704],[20211022,9.04,9.07,9.13,9.02,9.07,38669415,350441991],[20211025,9.07,9.03,9.06,9.02,9.03,26585515,240319367],[20211026,9.03,9.06,9.09,9.01,9.03,30751828,277872449],[20211027,9.03,9.01,9.02,8.96,8.99,34197280,307379956],[20211028,8.99,8.99,9.01,8.95,8.96,28165181,252660140],[20211029,8.96,8.96,9,8.93,8.94,35990731,322416661],[20211101,8.94,8.69,8.78,8.6,8.72,64940974,564516752],[20211102,8.72,8.71,8.75,8.5,8.54,70034623,602023097],[20211103,8.54,8.59,8.59,8.51,8.53,29785185,254382301],[20211104,8.53,8.53,8.54,8.5,8.51,26148859,222785142],[20211105,8.51,8.51,8.54,8.49,8.53,22913355,195212631],[20211108,8.53,8.48,8.53,8.46,8.49,24353008,206985050],[20211109,8.49,8.5,8.55,8.49,8.54,19548518,166547491],[20211110,8.54,8.53,8.53,8.44,8.48,27478869,232796692],[20211111,8.48,8.48,8.62,8.47,8.62,31419321,269103086],[20211112,8.62,8.64,8.65,8.58,8.65,20498205,176737119],[20211115,8.65,8.66,8.75,8.65,8.75,27625801,240602624],[20211116,8.75,8.7,8.74,8.63,8.73,24030066,208943547],[20211117,8.73,8.67,8.72,8.65,8.65,19301599,167446824],[20211118,8.65,8.61,8.66,8.53,8.56,20465395,175306638],[20211119,8.56,8.56,8.7,8.55,8.65,20471995,176572248],[20211122,8.65,8.63,8.66,8.59,8.6,20983745,180823527],[20211123,8.6,8.61,8.7,8.61,8.63,21502374,185927807],[20211124,8.63,8.61,8.69,8.59,8.68,19342692,167133727],[20211125,8.68,8.68,8.69,8.61,8.64,13169070,113743005],[20211126,8.64,8.61,8.62,8.55,8.56,21199061,181698146],[20211129,8.56,8.57,8.59,8.5,8.59,23746400,202736522],[20211130,8.59,8.54,8.59,8.51,8.51,30900124,263703121],[20211201,8.51,8.53,8.58,8.51,8.56,19333856,165443381],[20211202,8.56,8.56,8.61,8.52,8.58,22906201,196509475],[20211203,8.58,8.58,8.6,8.52,8.59,23848744,204050795],[20211206,8.59,8.59,8.64,8.57,8.6,33882029,291593648],[20211207,8.6,8.69,8.7,8.6,8.68,40016290,346582039],[20211208,8.68,8.7,8.7,8.63,8.67,28605916,247833290],[20211209,8.67,8.69,8.8,8.66,8.75,51186201,447467445],[20211210,8.75,8.73,8.78,8.72,8.77,42494890,371969042],[20211213,8.77,8.79,8.81,8.62,8.65,56234006,488480939],[20211214,8.65,8.64,8.65,8.54,8.57,49389318,423738409],[20211215,8.57,8.54,8.58,8.53,8.55,20664239,176754858],[20211216,8.55,8.56,8.61,8.55,8.6,26899524,230865612],[20211217,8.6,8.61,8.62,8.56,8.56,27269580,234082748],[20211220,8.56,8.55,8.61,8.55,8.58,27786123,238630278],[20211221,8.58,8.55,8.65,8.55,8.61,26310957,226526116],[20211222,8.61,8.62,8.64,8.57,8.57,21618063,185663516],[20211223,8.57,8.58,8.6,8.56,8.58,18901873,162106685],[20211224,8.58,8.58,8.59,8.53,8.54,18252048,156027073],[20211227,8.54,8.54,8.57,8.53,8.56,19527735,167009884],[20211228,8.56,8.56,8.59,8.54,8.57,29833707,255590457],[20211229,8.57,8.57,8.58,8.53,8.54,20050130,171393528],[20211230,8.54,8.54,8.58,8.53,8.54,23272484,199031073],[20211231,8.54,8.54,8.57,8.53,8.53,22929621,195941582],[20220104,8.53,8.54,8.58,8.52,8.57,37707647,322145532],[20220105,8.57,8.57,8.68,8.56,8.64,55459135,478834470],[20220106,8.64,8.66,8.66,8.56,8.57,41031062,352720657],[20220107,8.57,8.57,8.73,8.57,8.71,63018297,546456194],[20220110,8.71,8.72,8.78,8.66,8.72,34055312,296601230],[20220111,8.72,8.74,8.78,8.69,8.73,42646106,373093384],[20220112,8.73,8.75,8.75,8.63,8.69,41240670,358535694],[20220113,8.69,8.73,8.85,8.69,8.72,48923692,429003208],[20220114,8.72,8.72,8.72,8.57,8.59,51060652,440215954],[20220117,8.59,8.57,8.63,8.57,8.57,22177975,190459847],[20220118,8.57,8.58,8.66,8.55,8.63,39995195,344181260],[20220119,8.63,8.63,8.66,8.61,8.64,26257662,226931297],[20220120,8.64,8.66,8.82,8.64,8.8,82842044,724160483],[20220121,8.8,8.78,8.8,8.72,8.76,47572539,416684184],[20220124,8.76,8.79,8.79,8.66,8.69,32489722,282465419],[20220125,8.69,8.68,8.68,8.56,8.56,43312412,372488759],[20220126,8.56,8.57,8.59,8.54,8.57,23481959,201130974],[20220127,8.57,8.55,8.56,8.45,8.45,56281031,477716811],[20220128,8.45,8.48,8.51,8.41,8.41,43993766,372256637],[20220207,8.41,8.48,8.55,8.44,8.52,39988312,340086709],[20220208,8.52,8.53,8.67,8.51,8.65,47572520,409206611],[20220209,8.65,8.64,8.71,8.62,8.64,36223235,313861239],[20220210,8.64,8.66,8.71,8.62,8.69,28716174,249045194],[20220211,8.69,8.7,8.76,8.67,8.74,37682874,328719166],[20220214,8.74,8.69,8.71,8.58,8.6,34727078,299136398],[20220215,8.6,8.59,8.63,8.52,8.55,31680750,271300747],[20220216,8.55,8.58,8.64,8.56,8.59,28609574,246064337],[20220217,8.59,8.6,8.63,8.56,8.56,24533221,210822959],[20220218,8.56,8.55,8.67,8.53,8.67,34384620,296119868],[20220221,8.67,8.64,8.64,8.55,8.6,24334270,208998930],[20220222,8.6,8.57,8.59,8.53,8.58,32497174,278140362],[20220223,8.58,8.59,8.59,8.53,8.54,29476392,251902283],[20220224,8.54,8.54,8.55,8.4,8.44,47703559,404232342],[20220225,8.44,8.44,8.48,8.41,8.43,32239910,272095574],[20220228,8.43,8.44,8.45,8.36,8.39,23393262,196216444],[20220301,8.39,8.39,8.46,8.39,8.44,23540305,198243687],[20220302,8.44,8.41,8.46,8.4,8.42,16708051,140817898],[20220303,8.42,8.44,8.5,8.43,8.46,19864647,167938715],[20220304,8.46,8.44,8.44,8.36,8.4,26395729,221531967],[20220307,8.4,8.38,8.4,8.28,8.29,37177243,309677991],[20220308,8.29,8.29,8.3,8.05,8.08,46688059,381542333],[20220309,8.08,8.11,8.13,7.76,7.9,46035702,367319437],[20220310,7.9,8.01,8.05,7.92,7.92,25181489,200622345],[20220311,7.92,7.89,8.02,7.77,8.01,33286005,262318143],[20220314,8.01,7.95,8,7.9,7.91,22770866,180826437],[20220315,7.91,7.92,7.93,7.61,7.63,48962295,379252434],[20220316,7.63,7.69,7.8,7.52,7.77,41520083,318505390],[20220317,7.77,7.85,7.85,7.71,7.74,41495556,322981454],[20220318,7.74,7.73,7.91,7.71,7.9,53179530,417702652],[20220321,7.9,7.84,7.84,7.73,7.76,38823962,302127786],[20220322,7.76,7.77,7.88,7.75,7.83,28224469,220766832],[20220323,7.83,7.83,7.84,7.77,7.8,25553686,199580747],[20220324,7.8,7.78,7.83,7.76,7.8,16687677,130087627],[20220325,7.8,7.8,7.86,7.78,7.8,16474442,128855055],[20220328,7.8,7.8,7.87,7.71,7.86,28783984,224838880],[20220329,7.86,7.83,7.86,7.8,7.82,22516978,176131297],[20220330,7.82,7.84,7.92,7.82,7.92,29854369,235127475],[20220331,7.92,7.89,8.02,7.86,8,25969772,206902404],[20220401,8,7.95,8.07,7.94,8.07,31881345,255823775],[20220406,8.07,8,8.18,8,8.17,42546117,345601825],[20220407,8.17,8.16,8.18,8.06,8.07,31712143,257349868],[20220408,8.07,8.07,8.12,8.02,8.11,24089173,194553785],[20220411,8.11,8.11,8.11,7.97,8.01,30015679,240997448],[20220412,8.01,8.02,8.15,7.98,8.11,31331939,252435318],[20220413,8.11,8.09,8.14,8.05,8.1,18501150,149849342],[20220414,8.1,8.11,8.15,8.1,8.11,18973150,154167548],[20220415,8.11,8.11,8.18,8.09,8.15,21811956,177849450],[20220418,8.15,8.12,8.14,8.01,8.03,21022369,169238879],[20220419,8.03,8.04,8.14,8.03,8.14,24564490,198485790],[20220420,8.14,8.13,8.15,8.08,8.11,19143935,155238284],[20220421,8.11,8.08,8.16,7.99,8.07,29228035,236728146],[20220422,8.07,8.01,8.12,8.01,8.09,27612017,222997628],[20220425,8.09,8.02,8.1,7.81,7.82,53311550,426094148],[20220426,7.82,7.84,7.99,7.79,7.87,38204259,301693698],[20220427,7.87,7.91,7.95,7.81,7.83,38688614,304687721],[20220428,7.83,7.86,7.99,7.86,7.99,45175169,358888163],[20220429,7.99,7.98,8.06,7.86,8.03,44512846,354246100],[20220505,8.03,8.03,8.08,7.96,7.99,29133140,233186177],[20220506,7.99,7.94,7.98,7.82,7.85,31795578,250345903],[20220509,7.85,7.85,7.86,7.8,7.82,16035420,125476461],[20220510,7.82,7.8,7.89,7.71,7.85,32991018,257366422],[20220511,7.85,7.84,7.9,7.81,7.86,25116815,197407269],[20220512,7.86,7.83,7.91,7.83,7.87,22352229,176091168],[20220513,7.87,7.91,8.05,7.9,8.05,37343358,298941533],[20220516,8.05,8.05,8.07,7.93,7.97,20990826,167326392],[20220517,7.97,8.01,8.04,7.95,8.02,18714191,149733543],[20220518,8.02,7.98,8.01,7.92,7.95,19463913,154781980],[20220519,7.95,7.92,7.98,7.89,7.91,19904191,157705909],[20220520,7.91,7.94,8.05,7.92,8.04,32699572,262095154],[20220523,8.04,8.06,8.06,7.95,7.95,25527572,203770116],[20220524,7.95,7.96,7.97,7.87,7.88,26028514,205916168],[20220525,7.88,7.92,7.93,7.85,7.88,21003364,165613957],[20220526,7.88,7.89,7.92,7.84,7.9,23401589,184331253],[20220527,7.9,7.92,8.01,7.88,8,31755338,252802577],[20220530,8,8.01,8.02,7.87,7.88,35696257,282538705],[20220531,7.88,7.9,7.98,7.88,7.94,31750884,251916051],[20220601,7.94,7.94,7.94,7.89,7.91,18401941,145647638],[20220602,7.91,7.89,7.91,7.87,7.89,18931116,149199713],[20220606,7.89,7.87,7.9,7.82,7.86,33010527,259403167],[20220607,7.86,7.84,7.89,7.83,7.88,30623076,240941764],[20220608,7.88,7.87,7.88,7.83,7.86,39555666,310775180],[20220609,7.86,7.86,7.96,7.84,7.95,60606956,480180512],[20220610,7.95,7.93,8.05,7.89,7.93,123446198,984436173],[20220613,7.93,7.91,7.93,7.74,7.77,104597235,816472115],[20220614,7.77,7.74,7.89,7.73,7.87,55047795,428964424],[20220615,7.87,7.86,8.13,7.85,8.03,112759058,906495919],[20220616,8.03,8.05,8.08,7.92,7.92,56889689,453897643],[20220617,7.92,7.91,8,7.89,7.97,35612494,283173437],[20220620,7.97,7.95,7.98,7.91,7.91,30065154,238320268],[20220621,7.91,7.92,7.98,7.92,7.97,23245677,185071903],[20220622,7.97,7.96,7.97,7.91,7.92,20635582,163685601],[20220623,7.92,7.94,7.97,7.91,7.97,23255144,184864875],[20220624,7.97,7.97,7.98,7.93,7.95,23665322,188294113],[20220627,7.95,7.95,8.01,7.94,7.97,24067719,192131006],[20220628,7.97,7.97,8.04,7.96,8.04,25729078,205871662],[20220629,8.04,8.01,8.06,8,8.05,30299747,243477295],[20220630,8.05,8.05,8.06,8,8.01,23369617,187691080],[20220701,8.01,8.01,8.04,7.98,7.99,17846787,142651655],[20220704,7.99,7.99,8,7.94,7.96,18222009,145047089],[20220705,7.96,7.96,8,7.94,7.98,21322243,169924263],[20220706,7.98,7.97,7.98,7.87,7.9,28829658,227963132],[20220707,7.9,7.88,7.92,7.86,7.87,18636395,147034170],[20220708,7.87,7.9,7.9,7.87,7.88,12379190,97665057],[20220711,7.88,7.87,7.9,7.86,7.87,16195472,127636557],[20220712,7.87,7.86,7.94,7.86,7.91,19889798,157433752],[20220713,7.91,7.93,7.94,7.85,7.85,30506523,240374854],[20220714,7.85,7.84,7.86,7.75,7.79,40565878,315441409],[20220715,7.79,7.76,7.8,7.65,7.67,47127632,364457391],[20220718,7.67,7.68,7.79,7.68,7.79,25164232,195287191],[20220719,7.79,7.79,7.82,7.77,7.81,28872304,224891813],[20220720,7.81,7.85,7.85,7.77,7.79,39713402,309465406],[20220721,7.38,7.4,7.41,7.33,7.33,41541585,305408212],[20220722,7.33,7.34,7.38,7.34,7.35,19660796,144713990],[20220725,7.35,7.33,7.38,7.33,7.35,17093960,125744844],[20220726,7.35,7.36,7.39,7.34,7.38,18730569,138030623],[20220727,7.38,7.36,7.37,7.33,7.34,17036417,125085329],[20220728,7.34,7.35,7.37,7.32,7.33,21524372,158047423],[20220729,7.33,7.35,7.35,7.23,7.26,43873316,319838541],[20220801,7.26,7.26,7.28,7.21,7.23,24438011,176997249],[20220802,7.23,7.22,7.22,7.07,7.14,40986083,291570127],[20220803,7.14,7.13,7.17,7.07,7.07,28144846,199887999],[20220804,7.07,7.09,7.1,7.06,7.09,21294463,150760431],[20220805,7.09,7.09,7.18,7.08,7.15,22554203,160555049],[20220808,7.15,7.17,7.18,7.12,7.12,12981219,92667054],[20220809,7.12,7.13,7.15,7.1,7.12,13023820,92757272],[20220810,7.12,7.12,7.13,7.08,7.09,11674742,82872444],[20220811,7.09,7.12,7.19,7.1,7.18,21910821,156858352],[20220812,7.18,7.19,7.26,7.17,7.24,22253354,160666706],[20220815,7.24,7.24,7.29,7.2,7.21,20451392,148015693],[20220816,7.21,7.21,7.26,7.18,7.19,17910142,129120993],[20220817,7.19,7.21,7.3,7.18,7.28,20980840,152061979],[20220818,7.28,7.27,7.27,7.19,7.21,12991819,93820911],[20220819,7.21,7.18,7.28,7.18,7.2,17544569,126989202],[20220822,7.2,7.18,7.24,7.16,7.23,13776616,99353492],[20220823,7.23,7.21,7.22,7.17,7.17,15047471,108111340],[20220824,7.17,7.17,7.22,7.14,7.15,16855765,120996053],[20220825,7.15,7.16,7.22,7.15,7.2,15772556,113287117],[20220826,7.2,7.23,7.26,7.18,7.22,17576235,126876441],[20220829,7.22,7.16,7.21,7.12,7.15,27600324,197253687],[20220830,7.15,7.14,7.2,7.13,7.19,22541928,161534933],[20220831,7.19,7.17,7.28,7.15,7.27,39566130,286509309],[20220901,7.27,7.23,7.29,7.2,7.23,23298388,169134999],[20220902,7.23,7.24,7.27,7.2,7.21,19975499,144236249],[20220905,7.21,7.18,7.27,7.14,7.26,26646247,192171037],[20220906,7.26,7.25,7.3,7.24,7.26,21866681,159009208],[20220907,7.26,7.23,7.26,7.22,7.22,16568470,119766057],[20220908,7.22,7.24,7.27,7.22,7.24,14478347,104930853],[20220909,7.24,7.27,7.34,7.24,7.31,32423037,236986665],[20220913,7.31,7.28,7.36,7.27,7.35,23795140,174338448],[20220914,7.35,7.29,7.34,7.27,7.28,18649011,136014994],[20220915,7.28,7.29,7.37,7.28,7.32,31940343,233945047],[20220916,7.32,7.3,7.32,7.14,7.14,33979138,245252584],[20220919,7.14,7.16,7.2,7.1,7.16,22388073,160021577],[20220920,7.16,7.16,7.18,7.1,7.11,22247046,158496620],[20220921,7.11,7.1,7.16,7.08,7.13,20026161,142605616],[20220922,7.13,7.11,7.14,7.08,7.12,19540404,138786682],[20220923,7.12,7.12,7.18,7.09,7.16,21806262,155805817],[20220926,7.16,7.12,7.17,7.05,7.06,29503476,209607847],[20220927,7.06,7.04,7.09,7.02,7.07,20128163,142035077],[20220928,7.07,7.05,7.12,7.02,7.08,25197590,178257967],[20220929,7.08,7.11,7.13,6.95,6.99,37072647,260386962],[20220930,6.99,7.02,7.07,6.99,7.04,21572691,151907573],[20221010,7.04,7.04,7.09,7.01,7.03,20028296,141308416],[20221011,7.03,7.07,7.08,7,7.01,18613647,130804312],[20221012,7.01,7.01,7.05,6.96,7.05,20354488,142570655],[20221013,7.05,7.03,7.04,6.97,7,24107256,168676264],[20221014,7,7.03,7.07,7.01,7.03,27342763,192757733],[20221017,7.03,7.05,7.05,7,7.02,20616536,144892076],[20221018,7.02,7.04,7.06,7.01,7.02,21908675,154099280],[20221019,7.02,7.02,7.04,6.97,6.97,17988215,125873058],[20221020,6.97,6.97,7,6.96,6.97,19765093,137810613],[20221021,6.97,6.99,7.02,6.91,6.92,24567888,170868903],[20221024,6.92,6.93,6.94,6.8,6.81,38610105,265091388],[20221025,6.81,6.88,6.88,6.8,6.84,26539881,181269047],[20221026,6.84,6.83,6.86,6.8,6.82,20377311,139135071],[20221027,6.82,6.83,6.87,6.81,6.82,21293652,145765770],[20221028,6.82,6.84,6.87,6.75,6.8,28234295,192577660],[20221031,6.8,6.73,6.75,6.63,6.64,32237373,215102268],[20221101,6.64,6.68,6.74,6.65,6.74,27035074,181314549],[20221102,6.74,6.7,6.74,6.66,6.71,24034116,160891463],[20221103,6.71,6.71,6.71,6.64,6.66,21251911,141624735],[20221104,6.66,6.65,6.8,6.64,6.79,32665677,220460181],[20221107,6.79,6.75,6.83,6.74,6.81,16269623,110507706],[20221108,6.81,6.83,6.83,6.77,6.79,15282862,103708977],[20221109,6.79,6.77,6.82,6.77,6.79,13127494,89138502],[20221110,6.79,6.75,6.8,6.74,6.78,12601008,85330919],[20221111,6.78,6.83,6.98,6.83,6.94,40237053,277525770],[20221114,6.94,6.98,7.09,6.96,7.03,43777420,308265881],[20221115,7.03,7.01,7.09,7,7.06,25212063,177876453],[20221116,7.06,7.03,7.06,7.01,7.03,17398102,122332873],[20221117,7.03,7.02,7.02,6.95,6.98,22026825,153691240],[20221118,6.98,6.99,7,6.91,6.91,22662930,157460686],[20221121,6.91,6.9,6.91,6.83,6.88,22374965,153475266],[20221122,6.88,6.89,7.04,6.89,7.02,33424530,233200479],[20221123,7.02,7.01,7.12,6.99,7.05,36694389,259475308],[20221124,7.05,7.06,7.14,7.03,7.03,21534531,152263202],[20221125,7.03,7.04,7.18,7.04,7.17,43033799,307087082],[20221128,7.17,7.1,7.1,6.98,7.07,37873189,266592726],[20221129,7.07,7.1,7.3,7.08,7.27,68171227,492975278],[20221130,7.27,7.24,7.3,7.22,7.22,32346981,234334306],[20221201,7.22,7.28,7.34,7.21,7.22,30040435,217886967],[20221202,7.22,7.25,7.25,7.17,7.23,25722026,185354138],[20221205,7.23,7.28,7.37,7.24,7.36,47367357,346640963],[20221206,7.36,7.32,7.39,7.3,7.36,30550306,224448680],[20221207,7.36,7.35,7.4,7.3,7.34,31176550,229009593],[20221208,7.34,7.32,7.39,7.31,7.38,25551776,187977674],[20221209,7.38,7.37,7.39,7.3,7.32,38192346,280350287],[20221212,7.32,7.31,7.36,7.23,7.26,26708550,194644290],[20221213,7.26,7.27,7.35,7.25,7.32,18253626,133464502],[20221214,7.32,7.37,7.37,7.26,7.32,16180635,118352409],[20221215,7.32,7.28,7.32,7.23,7.24,17471770,126757096],[20221216,7.24,7.25,7.35,7.23,7.35,31704629,232171544],[20221219,7.35,7.37,7.37,7.21,7.24,20432546,148576218],[20221220,7.24,7.23,7.28,7.13,7.14,24800259,178369740],[20221221,7.14,7.22,7.24,7.13,7.19,17252934,124209181],[20221222,7.19,7.28,7.31,7.2,7.24,18662641,135509039],[20221223,7.24,7.19,7.27,7.17,7.19,12958464,93463047],[20221226,7.19,7.19,7.21,7.08,7.1,20138533,143606824],[20221227,7.1,7.13,7.29,7.12,7.22,24065192,173516852],[20221228,7.22,7.22,7.3,7.2,7.3,20901364,152167734],[20221229,7.3,7.27,7.29,7.18,7.24,18367088,132652083],[20221230,7.24,7.23,7.3,7.22,7.28,20352397,147932731],[20230103,7.28,7.27,7.28,7.17,7.23,25892521,187094064],[20230104,7.23,7.27,7.35,7.23,7.31,30947081,226321372],[20230105,7.31,7.37,7.38,7.3,7.35,30162154,221617355],[20230106,7.35,7.35,7.38,7.31,7.34,20312881,149170538],[20230109,7.34,7.38,7.38,7.3,7.34,19612260,143998211],[20230110,7.34,7.35,7.35,7.28,7.28,16194647,118223822],[20230111,7.28,7.31,7.34,7.27,7.3,19215541,140393996],[20230112,7.3,7.33,7.34,7.24,7.27,16849908,122554362],[20230113,7.27,7.29,7.35,7.27,7.34,21770211,159178132],[20230116,7.34,7.35,7.38,7.28,7.33,36816941,270170018],[20230117,7.33,7.34,7.35,7.27,7.3,24222613,176749046],[20230118,7.3,7.31,7.33,7.27,7.31,24494551,178868885],[20230119,7.31,7.31,7.33,7.26,7.33,16713352,121983726],[20230120,7.33,7.34,7.36,7.32,7.36,20986958,154239831],[20230130,7.36,7.43,7.43,7.37,7.4,31810739,235352030],[20230131,7.4,7.42,7.45,7.37,7.37,28438220,210715444],[20230201,7.37,7.4,7.4,7.33,7.36,18659542,137294549],[20230202,7.36,7.39,7.39,7.32,7.36,21900191,160961795],[20230203,7.36,7.33,7.35,7.27,7.27,29885527,217904608],[20230206,7.27,7.25,7.25,7.21,7.25,22786780,164745210],[20230207,7.25,7.27,7.27,7.22,7.24,15481821,112169271],[20230208,7.24,7.24,7.27,7.22,7.23,13095025,94770357],[20230209,7.23,7.23,7.28,7.22,7.26,10895965,79099151],[20230210,7.26,7.25,7.27,7.22,7.24,11944106,86527412],[20230213,7.24,7.22,7.26,7.18,7.23,20449779,147742689],[20230214,7.23,7.24,7.26,7.23,7.24,11929853,86373390],[20230215,7.24,7.24,7.25,7.19,7.2,15467693,111509088],[20230216,7.2,7.21,7.26,7.18,7.19,18798353,135881169],[20230217,7.19,7.19,7.22,7.13,7.13,21148914,151882567],[20230220,7.13,7.16,7.27,7.15,7.26,25613504,184902604],[20230221,7.26,7.26,7.3,7.23,7.29,16234446,118094161],[20230222,7.29,7.28,7.29,7.24,7.24,12971392,94204601],[20230223,7.24,7.25,7.28,7.23,7.23,11436536,82898812],[20230224,7.23,7.22,7.26,7.18,7.18,16681114,120124648],[20230227,7.18,7.16,7.2,7.16,7.16,15800639,113363322],[20230228,7.16,7.18,7.2,7.14,7.18,17448100,125100408],[20230301,7.18,7.17,7.27,7.17,7.26,25661325,185861462],[20230302,7.26,7.23,7.29,7.23,7.27,17070002,124094305],[20230303,7.27,7.29,7.36,7.26,7.35,31094168,227583048],[20230306,7.35,7.35,7.37,7.31,7.33,24939950,182971731],[20230307,7.33,7.32,7.46,7.3,7.31,56642781,417960791],[20230308,7.31,7.3,7.32,7.25,7.31,19059038,138757482],[20230309,7.31,7.31,7.34,7.25,7.27,18993344,138470615],[20230310,7.27,7.24,7.26,7.15,7.15,27843826,200486042],[20230313,7.15,7.05,7.09,7.03,7.06,51314997,362230490],[20230314,7.06,7.06,7.07,7,7.02,32453388,228164818],[20230315,7.02,7.07,7.1,7.06,7.08,25072976,177677435],[20230316,7.08,7.08,7.17,7.05,7.12,28501314,203051784],[20230317,7.12,7.14,7.22,7.1,7.11,36328142,260022748],[20230320,7.11,7.1,7.22,7.1,7.13,26292154,188546316],[20230321,7.13,7.16,7.2,7.13,7.13,18977675,135798122],[20230322,7.13,7.15,7.19,7.14,7.18,16988375,121799289],[20230323,7.18,7.15,7.22,7.14,7.21,21506296,154656983],[20230324,7.21,7.19,7.25,7.18,7.21,25687826,185477856],[20230327,7.21,7.23,7.23,7.15,7.15,19141397,137294386],[20230328,7.15,7.16,7.19,7.14,7.18,16641290,119293209],[20230329,7.18,7.23,7.23,7.16,7.16,12685806,91087594],[20230330,7.16,7.18,7.21,7.12,7.19,22504756,161359032],[20230331,7.19,7.19,7.24,7.17,7.19,20048925,144423998],[20230403,7.19,7.19,7.21,7.16,7.19,20246596,145394356],[20230404,7.19,7.19,7.22,7.16,7.21,25718197,184997550],[20230406,7.21,7.21,7.22,7.18,7.18,14740291,106072546],[20230407,7.18,7.19,7.24,7.16,7.23,17465820,125889350],[20230410,7.23,7.21,7.24,7.19,7.21,17548307,126535779],[20230411,7.21,7.23,7.23,7.18,7.18,20191251,145358007],[20230412,7.18,7.2,7.23,7.17,7.21,19475694,140373570],[20230413,7.21,7.22,7.29,7.2,7.25,25779019,186717624],[20230414,7.25,7.28,7.31,7.25,7.27,25074604,182629852],[20230417,7.27,7.26,7.4,7.26,7.39,36027756,264817275],[20230418,7.39,7.38,7.59,7.37,7.54,77412335,582499848],[20230419,7.54,7.49,7.58,7.43,7.53,52269783,393443029],[20230420,7.53,7.5,7.69,7.5,7.68,72340661,550359766],[20230421,7.68,7.67,7.73,7.57,7.59,50258973,383793225],[20230424,7.59,7.59,7.64,7.47,7.49,43348471,326606926],[20230425,7.49,7.53,7.62,7.52,7.56,42805282,323698545],[20230426,7.56,7.56,7.56,7.42,7.46,50919367,380460213],[20230427,7.46,7.48,7.51,7.42,7.48,49269460,367760167],[20230428,7.48,7.47,7.65,7.47,7.6,38841289,294352873],[20230504,7.6,7.48,7.75,7.35,7.68,75866605,575141257],[20230505,7.68,7.68,7.9,7.66,7.76,67991125,529531597],[20230508,7.76,7.77,8.17,7.76,8.07,143117862,1148389705],[20230509,8.07,8.14,8.22,7.94,7.96,122058988,987860019],[20230510,7.96,7.93,7.95,7.65,7.7,87338919,677598927],[20230511,7.7,7.72,7.8,7.65,7.67,43135406,332304491],[20230512,7.67,7.7,7.71,7.58,7.62,55003725,420040623],[20230515,7.62,7.62,7.71,7.51,7.69,49175572,373081744],[20230516,7.69,7.7,7.78,7.64,7.67,41397733,318997697],[20230517,7.67,7.67,7.69,7.58,7.61,29442573,224614977],[20230518,7.61,7.64,7.75,7.61,7.68,38714402,297590092],[20230519,7.68,7.67,7.67,7.52,7.54,35072548,265388166],[20230522,7.54,7.58,7.6,7.52,7.54,21174297,159997715],[20230523,7.54,7.54,7.59,7.45,7.45,29213715,219372233],[20230524,7.45,7.43,7.44,7.29,7.29,45145900,331690566],[20230525,7.29,7.26,7.33,7.24,7.31,34408974,250361066],[20230526,7.31,7.31,7.36,7.25,7.32,18912850,138237161],[20230529,7.32,7.32,7.46,7.31,7.41,29624085,218780886],[20230530,7.41,7.42,7.44,7.3,7.37,26942819,198416676],[20230531,7.37,7.37,7.37,7.29,7.35,26569353,194680269],[20230601,7.35,7.33,7.35,7.26,7.28,30606250,223217358],[20230602,7.28,7.29,7.36,7.29,7.35,20697156,151681592],[20230605,7.35,7.35,7.43,7.31,7.41,21286683,157069299],[20230606,7.41,7.41,7.53,7.36,7.38,33736363,251262504],[20230607,7.38,7.4,7.5,7.4,7.46,21593403,161137015],[20230608,7.46,7.49,7.59,7.43,7.57,27634633,207840752],[20230609,7.57,7.57,7.6,7.53,7.56,22288077,168547961],[20230612,7.56,7.54,7.54,7.43,7.43,20300133,151516728],[20230613,7.43,7.43,7.48,7.4,7.46,15724325,117086539],[20230614,7.46,7.48,7.51,7.4,7.4,17986091,134018714],[20230615,7.4,7.43,7.49,7.39,7.45,20936996,155705975],[20230616,7.45,7.45,7.47,7.39,7.43,26908579,199680699],[20230619,7.43,7.41,7.42,7.34,7.34,17368652,128045971],[20230620,7.34,7.36,7.37,7.29,7.29,20417397,149411204],[20230621,7.29,7.29,7.37,7.27,7.27,20122147,147098242],[20230626,7.27,7.27,7.28,7.14,7.16,34007942,244185921],[20230627,7.16,7.15,7.23,7.14,7.19,18412655,132407801],[20230628,7.19,7.2,7.22,7.15,7.21,15806614,113547071],[20230629,7.21,7.21,7.25,7.18,7.18,21627405,155944843],[20230630,7.18,7.17,7.27,7.17,7.24,19425283,140653932],[20230703,7.24,7.25,7.33,7.25,7.32,20873751,152174189],[20230704,7.32,7.3,7.33,7.23,7.28,17447358,126841704],[20230705,7.28,7.26,7.28,7.21,7.25,11396554,82596378],[20230706,7.25,7.25,7.27,7.19,7.21,14827400,107119878],[20230707,7.21,7.21,7.25,7.18,7.22,14748837,106398636],[20230710,7.22,7.22,7.25,7.2,7.22,11410653,82406254],[20230711,7.22,7.26,7.29,7.23,7.28,14074191,102272416],[20230712,7.28,7.28,7.32,7.25,7.25,14414543,105021891],[20230713,7.25,7.3,7.4,7.27,7.4,26925447,198390792],[20230714,7.4,7.42,7.45,7.38,7.44,19569658,145348730],[20230717,7.44,7.44,7.45,7.35,7.42,13992076,103339601],[20230718,7.42,7.42,7.42,7.37,7.39,12026567,88895175],[20230719,7.39,7.36,7.43,7.36,7.41,18189577,134677036],[20230720,7.41,7.43,7.48,7.4,7.42,26686817,198503271],[20230721,7.1,7.1,7.15,7.07,7.12,27661416,196813979],[20230724,7.12,7.08,7.16,7.07,7.13,25840210,184072422],[20230725,7.13,7.18,7.29,7.17,7.27,31444763,227784692],[20230726,7.27,7.28,7.34,7.26,7.29,22818033,166416269],[20230727,7.29,7.33,7.4,7.29,7.37,26198753,193006451],[20230728,7.37,7.33,7.52,7.33,7.5,46528827,347454787],[20230731,7.5,7.55,7.64,7.52,7.6,52804227,400087143],[20230801,7.6,7.58,7.63,7.54,7.6,30934266,234625800],[20230802,7.6,7.56,7.59,7.43,7.48,42654533,319717235],[20230803,7.48,7.52,7.58,7.44,7.56,29329503,220449825],[20230804,7.56,7.59,7.65,7.54,7.58,34256817,260297665],[20230807,7.58,7.57,7.57,7.49,7.52,26012874,195449522],[20230808,7.52,7.47,7.55,7.43,7.52,27001247,202344903],[20230809,7.52,7.5,7.55,7.47,7.55,17792571,133937332],[20230810,7.55,7.45,7.46,7.35,7.42,52865300,391107894],[20230811,7.42,7.44,7.44,7.23,7.23,37051127,270665761],[20230814,7.23,7.18,7.2,7.05,7.1,44245535,315007728],[20230815,7.1,7.12,7.19,7.09,7.17,31218657,222582866],[20230816,7.17,7.15,7.19,7.12,7.14,22953985,163923269],[20230817,7.14,7.13,7.14,7.05,7.1,37202484,263598981],[20230818,7.1,7.1,7.17,7.07,7.07,28150555,200372019],[20230821,7.07,7.06,7.11,6.96,6.96,42517681,298419531],[20230822,6.96,6.98,7.04,6.97,7.01,32939985,230491370],[20230823,7.01,7.01,7.09,6.98,7.02,30151367,212210300],[20230824,7.02,7.03,7.06,6.98,6.99,24604979,172413193],[20230825,6.99,6.99,7.09,6.97,7.05,24703830,174021381],[20230829,7.15,7.2,7.2,7.03,7.07,44969042,318887360]],symbol:"600000.sh",name:"xxxxxx",start:5768,end:2769,count:5769,ticket:16,version:"2.0",message:null,code:0,servertime:"2023-08-29 14:38:26"},h={stock:[{symbol:"600000.sh",minute:[{date:20230707,time:925,open:7.21,high:7.21,low:7.21,price:7.21,vol:2500,amount:6425,avprice:7.21},{date:20230707,time:930,open:7.21,high:7.21,low:7.21,price:7.21,vol:42500,amount:306425,avprice:7.21},{date:20230707,time:931,open:7.21,high:7.19,low:7.21,price:7.19,vol:269400,amount:1939823,avprice:7.202},{date:20230707,time:932,open:7.21,high:7.21,low:7.22,price:7.2,vol:231900,amount:1672034,avprice:7.205},{date:20230707,time:933,open:7.21,high:7.23,low:7.23,price:7.21,vol:144300,amount:1041820,avprice:7.208},{date:20230707,time:934,open:7.23,high:7.22,low:7.23,price:7.22,vol:87300,amount:630341,avprice:7.21},{date:20230707,time:935,open:7.23,high:7.22,low:7.23,price:7.22,vol:49600,amount:358287,avprice:7.211},{date:20230707,time:936,open:7.22,high:7.21,low:7.23,price:7.2,vol:106700,amount:769942,avprice:7.211},{date:20230707,time:937,open:7.21,high:7.22,low:7.22,price:7.2,vol:38400,amount:276864,avprice:7.211},{date:20230707,time:938,open:7.22,high:7.2,low:7.22,price:7.2,vol:31e3,amount:223473,avprice:7.211},{date:20230707,time:939,open:7.2,high:7.21,low:7.22,price:7.2,vol:38500,amount:277594,avprice:7.211},{date:20230707,time:940,open:7.22,high:7.21,low:7.22,price:7.21,vol:17400,amount:125526,avprice:7.211},{date:20230707,time:941,open:7.21,high:7.21,low:7.22,price:7.21,vol:20400,amount:147115,avprice:7.211},{date:20230707,time:942,open:7.21,high:7.21,low:7.22,price:7.21,vol:29300,amount:211273,avprice:7.211},{date:20230707,time:943,open:7.22,high:7.21,low:7.22,price:7.21,vol:154e3,amount:1111381,avprice:7.212},{date:20230707,time:944,open:7.22,high:7.22,low:7.22,price:7.21,vol:33300,amount:240129,avprice:7.212},{date:20230707,time:945,open:7.21,high:7.22,low:7.23,price:7.21,vol:198400,amount:1432724,avprice:7.213},{date:20230707,time:946,open:7.22,high:7.23,low:7.23,price:7.22,vol:56200,amount:405804,avprice:7.213},{date:20230707,time:947,open:7.22,high:7.22,low:7.23,price:7.22,vol:187400,amount:1353030,avprice:7.214},{date:20230707,time:948,open:7.22,high:7.22,low:7.22,price:7.21,vol:35900,amount:258878,avprice:7.214},{date:20230707,time:949,open:7.22,high:7.22,low:7.22,price:7.21,vol:38e3,amount:274313,avprice:7.214},{date:20230707,time:950,open:7.22,high:7.22,low:7.22,price:7.21,vol:15500,amount:111781,avprice:7.214},{date:20230707,time:951,open:7.21,high:7.2,low:7.21,price:7.2,vol:264900,amount:1909460,avprice:7.213},{date:20230707,time:952,open:7.21,high:7.22,low:7.23,price:7.21,vol:372800,amount:2690957,avprice:7.214},{date:20230707,time:953,open:7.22,high:7.22,low:7.22,price:7.22,vol:83100,amount:599982,avprice:7.214},{date:20230707,time:954,open:7.22,high:7.22,low:7.22,price:7.22,vol:18600,amount:134301,avprice:7.214},{date:20230707,time:955,open:7.22,high:7.23,low:7.23,price:7.22,vol:11900,amount:85968,avprice:7.214},{date:20230707,time:956,open:7.22,high:7.22,low:7.23,price:7.22,vol:43900,amount:317337,avprice:7.215},{date:20230707,time:957,open:7.23,high:7.23,low:7.23,price:7.22,vol:19300,amount:139534,avprice:7.215},{date:20230707,time:958,open:7.23,high:7.23,low:7.23,price:7.22,vol:11900,amount:86027,avprice:7.215},{date:20230707,time:959,open:7.23,high:7.22,low:7.23,price:7.22,vol:25800,amount:186293,avprice:7.215},{date:20230707,time:1e3,open:7.22,high:7.22,low:7.22,price:7.22,vol:77800,amount:561725,avprice:7.215},{date:20230707,time:1001,open:7.23,high:7.23,low:7.23,price:7.22,vol:53400,amount:385801,avprice:7.215},{date:20230707,time:1002,open:7.22,high:7.23,low:7.23,price:7.22,vol:65e3,amount:469650,avprice:7.215},{date:20230707,time:1003,open:7.22,high:7.24,low:7.25,price:7.22,vol:945700,amount:6843184,avprice:7.221},{date:20230707,time:1004,open:7.25,high:7.23,low:7.25,price:7.23,vol:130900,amount:947953,avprice:7.221},{date:20230707,time:1005,open:7.24,high:7.24,low:7.25,price:7.23,vol:118800,amount:859986,avprice:7.222},{date:20230707,time:1006,open:7.24,high:7.24,low:7.25,price:7.24,vol:14200,amount:102846,avprice:7.222},{date:20230707,time:1007,open:7.24,high:7.23,low:7.24,price:7.23,vol:173300,amount:1253355,avprice:7.222},{date:20230707,time:1008,open:7.23,high:7.23,low:7.23,price:7.23,vol:42200,amount:305229,avprice:7.222},{date:20230707,time:1009,open:7.23,high:7.23,low:7.23,price:7.23,vol:3100,amount:22413,avprice:7.222},{date:20230707,time:1010,open:7.23,high:7.23,low:7.24,price:7.23,vol:30900,amount:223680,avprice:7.222},{date:20230707,time:1011,open:7.24,high:7.23,low:7.24,price:7.23,vol:11500,amount:83220,avprice:7.222},{date:20230707,time:1012,open:7.24,high:7.23,low:7.24,price:7.23,vol:11400,amount:82498,avprice:7.223},{date:20230707,time:1013,open:7.24,high:7.23,low:7.24,price:7.23,vol:10300,amount:74525,avprice:7.223},{date:20230707,time:1014,open:7.24,high:7.23,low:7.24,price:7.23,vol:12200,amount:88303,avprice:7.223},{date:20230707,time:1015,open:7.24,high:7.23,low:7.24,price:7.23,vol:12900,amount:93374,avprice:7.223},{date:20230707,time:1016,open:7.23,high:7.24,low:7.24,price:7.23,vol:8800,amount:63667,avprice:7.223},{date:20230707,time:1017,open:7.24,high:7.23,low:7.24,price:7.23,vol:26800,amount:193995,avprice:7.223},{date:20230707,time:1018,open:7.24,high:7.24,low:7.24,price:7.23,vol:10200,amount:73817,avprice:7.223},{date:20230707,time:1019,open:7.23,high:7.24,low:7.24,price:7.23,vol:8900,amount:64429,avprice:7.223},{date:20230707,time:1020,open:7.24,high:7.23,low:7.24,price:7.23,vol:30600,amount:221404,avprice:7.223},{date:20230707,time:1021,open:7.24,high:7.24,low:7.24,price:7.23,vol:17e3,amount:122956,avprice:7.223},{date:20230707,time:1022,open:7.24,high:7.24,low:7.24,price:7.23,vol:8600,amount:62247,avprice:7.223},{date:20230707,time:1023,open:7.23,high:7.24,low:7.24,price:7.23,vol:18100,amount:130921,avprice:7.223},{date:20230707,time:1024,open:7.23,high:7.23,low:7.24,price:7.23,vol:50800,amount:367521,avprice:7.223},{date:20230707,time:1025,open:7.23,high:7.23,low:7.24,price:7.23,vol:57800,amount:417975,avprice:7.223},{date:20230707,time:1026,open:7.23,high:7.23,low:7.23,price:7.23,vol:44e3,amount:318132,avprice:7.223},{date:20230707,time:1027,open:7.23,high:7.22,low:7.23,price:7.22,vol:54600,amount:394343,avprice:7.223},{date:20230707,time:1028,open:7.23,high:7.22,low:7.23,price:7.22,vol:32500,amount:234662,avprice:7.223},{date:20230707,time:1029,open:7.23,high:7.23,low:7.23,price:7.22,vol:23200,amount:167633,avprice:7.223},{date:20230707,time:1030,open:7.22,high:7.23,low:7.23,price:7.22,vol:14400,amount:104077,avprice:7.223},{date:20230707,time:1031,open:7.23,high:7.23,low:7.23,price:7.22,vol:62900,amount:454640,avprice:7.223},{date:20230707,time:1032,open:7.23,high:7.22,low:7.23,price:7.22,vol:40100,amount:289608,avprice:7.223},{date:20230707,time:1033,open:7.22,high:7.22,low:7.22,price:7.21,vol:87100,amount:628610,avprice:7.223},{date:20230707,time:1034,open:7.22,high:7.22,low:7.22,price:7.21,vol:33700,amount:243016,avprice:7.223},{date:20230707,time:1035,open:7.21,high:7.2,low:7.21,price:7.2,vol:330100,amount:2379824,avprice:7.222},{date:20230707,time:1036,open:7.2,high:7.21,low:7.21,price:7.2,vol:16900,amount:121686,avprice:7.222},{date:20230707,time:1037,open:7.21,high:7.21,low:7.21,price:7.2,vol:119100,amount:858705,avprice:7.222},{date:20230707,time:1038,open:7.21,high:7.21,low:7.21,price:7.21,vol:300,amount:2163,avprice:7.222},{date:20230707,time:1039,open:7.21,high:7.21,low:7.21,price:7.2,vol:51900,amount:374198,avprice:7.222},{date:20230707,time:1040,open:7.21,high:7.2,low:7.21,price:7.2,vol:31e3,amount:223356,avprice:7.222},{date:20230707,time:1041,open:7.21,high:7.2,low:7.21,price:7.2,vol:51900,amount:373939,avprice:7.222},{date:20230707,time:1042,open:7.2,high:7.2,low:7.21,price:7.19,vol:256100,amount:1843735,avprice:7.221},{date:20230707,time:1043,open:7.2,high:7.19,low:7.2,price:7.19,vol:4300,amount:30958,avprice:7.221},{date:20230707,time:1044,open:7.2,high:7.2,low:7.2,price:7.19,vol:27800,amount:200149,avprice:7.221},{date:20230707,time:1045,open:7.2,high:7.19,low:7.2,price:7.19,vol:20900,amount:150472,avprice:7.221},{date:20230707,time:1046,open:7.19,high:7.2,low:7.2,price:7.19,vol:49900,amount:359227,avprice:7.22},{date:20230707,time:1047,open:7.2,high:7.2,low:7.21,price:7.2,vol:51800,amount:372985,avprice:7.22},{date:20230707,time:1048,open:7.21,high:7.21,low:7.21,price:7.2,vol:26900,amount:193695,avprice:7.22},{date:20230707,time:1049,open:7.2,high:7.2,low:7.2,price:7.2,vol:8900,amount:64080,avprice:7.22},{date:20230707,time:1050,open:7.21,high:7.2,low:7.21,price:7.19,vol:91300,amount:657209,avprice:7.22},{date:20230707,time:1051,open:7.19,high:7.21,low:7.21,price:7.19,vol:40700,amount:292820,avprice:7.22},{date:20230707,time:1052,open:7.19,high:7.2,low:7.21,price:7.19,vol:45300,amount:325905,avprice:7.219},{date:20230707,time:1053,open:7.2,high:7.2,low:7.2,price:7.19,vol:3200,amount:23037,avprice:7.219},{date:20230707,time:1054,open:7.2,high:7.19,low:7.2,price:7.19,vol:559300,amount:4021484,avprice:7.217},{date:20230707,time:1055,open:7.19,high:7.19,low:7.2,price:7.18,vol:394400,amount:2835733,avprice:7.215},{date:20230707,time:1056,open:7.19,high:7.19,low:7.19,price:7.19,vol:135100,amount:971369,avprice:7.215},{date:20230707,time:1057,open:7.19,high:7.19,low:7.2,price:7.19,vol:33100,amount:238104,avprice:7.215},{date:20230707,time:1058,open:7.19,high:7.2,low:7.2,price:7.19,vol:14100,amount:101415,avprice:7.215},{date:20230707,time:1059,open:7.2,high:7.19,low:7.2,price:7.19,vol:5800,amount:41706,avprice:7.215},{date:20230707,time:1100,open:7.19,high:7.2,low:7.2,price:7.19,vol:5100,amount:36681,avprice:7.215},{date:20230707,time:1101,open:7.19,high:7.2,low:7.2,price:7.19,vol:900,amount:6474,avprice:7.215},{date:20230707,time:1102,open:7.19,high:7.2,low:7.2,price:7.19,vol:3200,amount:23010,avprice:7.215},{date:20230707,time:1103,open:7.2,high:7.2,low:7.2,price:7.19,vol:19200,amount:138067,avprice:7.215},{date:20230707,time:1104,open:7.2,high:7.2,low:7.2,price:7.19,vol:27900,amount:200727,avprice:7.215},{date:20230707,time:1105,open:7.2,high:7.19,low:7.2,price:7.19,vol:17e3,amount:122358,avprice:7.215},{date:20230707,time:1106,open:7.2,high:7.2,low:7.2,price:7.19,vol:13500,amount:97178,avprice:7.215},{date:20230707,time:1107,open:7.2,high:7.2,low:7.2,price:7.19,vol:34400,amount:247348,avprice:7.215},{date:20230707,time:1108,open:7.2,high:7.2,low:7.2,price:7.19,vol:7700,amount:55414,avprice:7.215},{date:20230707,time:1109,open:7.2,high:7.19,low:7.2,price:7.19,vol:20600,amount:148215,avprice:7.214},{date:20230707,time:1110,open:7.19,high:7.2,low:7.2,price:7.19,vol:8400,amount:60424,avprice:7.214},{date:20230707,time:1111,open:7.2,high:7.2,low:7.2,price:7.19,vol:16900,amount:121632,avprice:7.214},{date:20230707,time:1112,open:7.2,high:7.21,low:7.21,price:7.2,vol:462900,amount:3332833,avprice:7.214},{date:20230707,time:1113,open:7.21,high:7.2,low:7.21,price:7.2,vol:68300,amount:492052,avprice:7.213},{date:20230707,time:1114,open:7.2,high:7.2,low:7.21,price:7.2,vol:32500,amount:234074,avprice:7.213},{date:20230707,time:1115,open:7.2,high:7.21,low:7.21,price:7.2,vol:41600,amount:299530,avprice:7.213},{date:20230707,time:1116,open:7.21,high:7.21,low:7.21,price:7.2,vol:47600,amount:342831,avprice:7.213},{date:20230707,time:1117,open:7.2,high:7.2,low:7.21,price:7.2,vol:39700,amount:285861,avprice:7.213},{date:20230707,time:1118,open:7.21,high:7.21,low:7.21,price:7.2,vol:1600,amount:11522,avprice:7.213},{date:20230707,time:1119,open:7.2,high:7.21,low:7.21,price:7.2,vol:7500,amount:54024,avprice:7.213},{date:20230707,time:1120,open:7.21,high:7.21,low:7.21,price:7.21,vol:22800,amount:164385,avprice:7.213},{date:20230707,time:1121,open:7.2,high:7.2,low:7.2,price:7.2,vol:33200,amount:239043,avprice:7.213},{date:20230707,time:1122,open:7.2,high:7.21,low:7.21,price:7.2,vol:49400,amount:355686,avprice:7.213},{date:20230707,time:1123,open:7.2,high:7.19,low:7.2,price:7.19,vol:58800,amount:423288,avprice:7.213},{date:20230707,time:1124,open:7.2,high:7.2,low:7.2,price:7.19,vol:54e3,amount:388421,avprice:7.213},{date:20230707,time:1125,open:7.19,high:7.2,low:7.2,price:7.19,vol:100500,amount:722700,avprice:7.213},{date:20230707,time:1126,open:7.2,high:7.21,low:7.21,price:7.19,vol:21300,amount:153237,avprice:7.213},{date:20230707,time:1127,open:7.2,high:7.2,low:7.21,price:7.19,vol:46200,amount:332341,avprice:7.212},{date:20230707,time:1128,open:7.2,high:7.2,low:7.2,price:7.19,vol:55600,amount:399881,avprice:7.212},{date:20230707,time:1129,open:7.21,high:7.21,low:7.21,price:7.21,vol:100,amount:721,avprice:7.212},{date:20230707,time:1130,open:7.2,high:7.2,low:7.2,price:7.19,vol:41900,amount:301635,avprice:7.212},{date:20230707,time:1300,open:7.21,high:7.21,low:7.21,price:7.2,vol:700,amount:8986,avprice:7.212},{date:20230707,time:1301,open:7.21,high:7.21,low:7.21,price:7.2,vol:63700,amount:458986,avprice:7.212},{date:20230707,time:1302,open:7.2,high:7.2,low:7.21,price:7.19,vol:59400,amount:427703,avprice:7.212},{date:20230707,time:1303,open:7.19,high:7.2,low:7.21,price:7.19,vol:5400,amount:38832,avprice:7.212},{date:20230707,time:1304,open:7.19,high:7.19,low:7.2,price:7.19,vol:73900,amount:531570,avprice:7.212},{date:20230707,time:1305,open:7.19,high:7.2,low:7.21,price:7.19,vol:32900,amount:236603,avprice:7.212},{date:20230707,time:1306,open:7.21,high:7.19,low:7.21,price:7.19,vol:48500,amount:349204,avprice:7.212},{date:20230707,time:1307,open:7.2,high:7.19,low:7.2,price:7.19,vol:63900,amount:459717,avprice:7.212},{date:20230707,time:1308,open:7.2,high:7.19,low:7.21,price:7.19,vol:36300,amount:261304,avprice:7.212},{date:20230707,time:1309,open:7.2,high:7.21,low:7.21,price:7.2,vol:10600,amount:76354,avprice:7.212},{date:20230707,time:1310,open:7.21,high:7.22,low:7.22,price:7.21,vol:56700,amount:408814,avprice:7.212},{date:20230707,time:1311,open:7.21,high:7.22,low:7.22,price:7.21,vol:42300,amount:305040,avprice:7.212},{date:20230707,time:1312,open:7.22,high:7.22,low:7.22,price:7.21,vol:16800,amount:121186,avprice:7.212},{date:20230707,time:1313,open:7.22,high:7.22,low:7.22,price:7.21,vol:45600,amount:328982,avprice:7.212},{date:20230707,time:1314,open:7.22,high:7.21,low:7.22,price:7.21,vol:16600,amount:119741,avprice:7.212},{date:20230707,time:1315,open:7.22,high:7.21,low:7.22,price:7.21,vol:5200,amount:37537,avprice:7.212},{date:20230707,time:1316,open:7.21,high:7.22,low:7.22,price:7.21,vol:24200,amount:174491,avprice:7.212},{date:20230707,time:1317,open:7.21,high:7.21,low:7.22,price:7.21,vol:66e3,amount:476005,avprice:7.212},{date:20230707,time:1318,open:7.21,high:7.21,low:7.22,price:7.21,vol:24800,amount:178833,avprice:7.212},{date:20230707,time:1319,open:7.22,high:7.21,low:7.22,price:7.21,vol:40300,amount:290581,avprice:7.212},{date:20230707,time:1320,open:7.21,high:7.21,low:7.22,price:7.21,vol:31900,amount:230090,avprice:7.212},{date:20230707,time:1321,open:7.22,high:7.23,low:7.23,price:7.21,vol:233100,amount:1682955,avprice:7.212},{date:20230707,time:1322,open:7.23,high:7.23,low:7.23,price:7.22,vol:32e3,amount:231174,avprice:7.212},{date:20230707,time:1323,open:7.23,high:7.23,low:7.23,price:7.22,vol:59700,amount:431228,avprice:7.212},{date:20230707,time:1324,open:7.23,high:7.22,low:7.23,price:7.22,vol:40100,amount:289677,avprice:7.212},{date:20230707,time:1325,open:7.23,high:7.23,low:7.23,price:7.23,vol:54600,amount:394757,avprice:7.212},{date:20230707,time:1326,open:7.23,high:7.23,low:7.23,price:7.22,vol:11300,amount:81697,avprice:7.212},{date:20230707,time:1327,open:7.23,high:7.23,low:7.23,price:7.22,vol:11500,amount:83123,avprice:7.212},{date:20230707,time:1328,open:7.23,high:7.23,low:7.23,price:7.22,vol:3600,amount:26027,avprice:7.212},{date:20230707,time:1329,open:7.23,high:7.23,low:7.23,price:7.22,vol:105400,amount:761145,avprice:7.212},{date:20230707,time:1330,open:7.22,high:7.23,low:7.23,price:7.22,vol:53100,amount:383397,avprice:7.212},{date:20230707,time:1331,open:7.22,high:7.23,low:7.23,price:7.22,vol:4e3,amount:28895,avprice:7.212},{date:20230707,time:1332,open:7.23,high:7.22,low:7.23,price:7.22,vol:81e3,amount:584858,avprice:7.212},{date:20230707,time:1333,open:7.22,high:7.22,low:7.22,price:7.21,vol:49100,amount:354218,avprice:7.212},{date:20230707,time:1334,open:7.22,high:7.22,low:7.23,price:7.22,vol:26900,amount:194198,avprice:7.212},{date:20230707,time:1335,open:7.22,high:7.23,low:7.23,price:7.22,vol:14e3,amount:101118,avprice:7.212},{date:20230707,time:1336,open:7.23,high:7.23,low:7.23,price:7.22,vol:2e3,amount:14459,avprice:7.212},{date:20230707,time:1337,open:7.22,high:7.22,low:7.23,price:7.22,vol:35200,amount:254229,avprice:7.212},{date:20230707,time:1338,open:7.22,high:7.22,low:7.23,price:7.22,vol:2700,amount:19504,avprice:7.212},{date:20230707,time:1339,open:7.23,high:7.23,low:7.23,price:7.23,vol:3500,amount:25304,avprice:7.212},{date:20230707,time:1340,open:7.22,high:7.22,low:7.23,price:7.22,vol:28300,amount:204359,avprice:7.212},{date:20230707,time:1341,open:7.23,high:7.23,low:7.23,price:7.22,vol:8600,amount:62165,avprice:7.212},{date:20230707,time:1342,open:7.22,high:7.23,low:7.23,price:7.22,vol:4200,amount:30339,avprice:7.212},{date:20230707,time:1343,open:7.23,high:7.23,low:7.23,price:7.22,vol:7800,amount:56355,avprice:7.212},{date:20230707,time:1344,open:7.23,high:7.22,low:7.23,price:7.22,vol:18400,amount:132977,avprice:7.213},{date:20230707,time:1345,open:7.23,high:7.22,low:7.23,price:7.22,vol:166900,amount:1204938,avprice:7.213},{date:20230707,time:1346,open:7.23,high:7.21,low:7.23,price:7.21,vol:33500,amount:241721,avprice:7.213},{date:20230707,time:1347,open:7.22,high:7.21,low:7.22,price:7.21,vol:27800,amount:200484,avprice:7.213},{date:20230707,time:1348,open:7.22,high:7.21,low:7.22,price:7.21,vol:14300,amount:103140,avprice:7.213},{date:20230707,time:1349,open:7.22,high:7.21,low:7.22,price:7.21,vol:2e3,amount:14439,avprice:7.213},{date:20230707,time:1350,open:7.22,high:7.21,low:7.22,price:7.21,vol:25200,amount:181702,avprice:7.213},{date:20230707,time:1351,open:7.22,high:7.21,low:7.22,price:7.21,vol:66100,amount:476590,avprice:7.213},{date:20230707,time:1352,open:7.21,high:7.21,low:7.22,price:7.21,vol:39100,amount:281913,avprice:7.213},{date:20230707,time:1353,open:7.22,high:7.23,low:7.23,price:7.21,vol:152500,amount:1100990,avprice:7.213},{date:20230707,time:1354,open:7.22,high:7.22,low:7.23,price:7.21,vol:17800,amount:128505,avprice:7.213},{date:20230707,time:1355,open:7.22,high:7.21,low:7.22,price:7.21,vol:22e3,amount:158632,avprice:7.213},{date:20230707,time:1356,open:7.22,high:7.22,low:7.22,price:7.21,vol:11100,amount:80075,avprice:7.213},{date:20230707,time:1357,open:7.21,high:7.21,low:7.22,price:7.21,vol:36900,amount:266075,avprice:7.213},{date:20230707,time:1358,open:7.21,high:7.21,low:7.22,price:7.21,vol:36600,amount:263917,avprice:7.213},{date:20230707,time:1359,open:7.22,high:7.22,low:7.22,price:7.22,vol:7600,amount:54871,avprice:7.213},{date:20230707,time:1400,open:7.22,high:7.22,low:7.22,price:7.21,vol:35400,amount:255556,avprice:7.213},{date:20230707,time:1401,open:7.22,high:7.21,low:7.22,price:7.21,vol:20600,amount:148635,avprice:7.213},{date:20230707,time:1402,open:7.22,high:7.22,low:7.22,price:7.21,vol:9800,amount:70691,avprice:7.213},{date:20230707,time:1403,open:7.22,high:7.22,low:7.22,price:7.21,vol:17800,amount:128497,avprice:7.213},{date:20230707,time:1404,open:7.22,high:7.22,low:7.22,price:7.22,vol:4400,amount:31741,avprice:7.213},{date:20230707,time:1405,open:7.22,high:7.21,low:7.22,price:7.21,vol:73500,amount:529941,avprice:7.213},{date:20230707,time:1406,open:7.21,high:7.21,low:7.22,price:7.21,vol:11200,amount:80761,avprice:7.213},{date:20230707,time:1407,open:7.22,high:7.22,low:7.22,price:7.21,vol:78300,amount:564696,avprice:7.213},{date:20230707,time:1408,open:7.22,high:7.21,low:7.22,price:7.21,vol:43300,amount:312082,avprice:7.213},{date:20230707,time:1409,open:7.22,high:7.21,low:7.22,price:7.21,vol:137700,amount:992983,avprice:7.213},{date:20230707,time:1410,open:7.22,high:7.22,low:7.22,price:7.21,vol:1100,amount:7941,avprice:7.213},{date:20230707,time:1411,open:7.22,high:7.22,low:7.22,price:7.21,vol:2700,amount:19491,avprice:7.213},{date:20230707,time:1412,open:7.22,high:7.22,low:7.22,price:7.21,vol:10500,amount:75798,avprice:7.213},{date:20230707,time:1413,open:7.22,high:7.22,low:7.22,price:7.21,vol:28100,amount:202811,avprice:7.213},{date:20230707,time:1414,open:7.22,high:7.21,low:7.22,price:7.21,vol:12500,amount:90194,avprice:7.213},{date:20230707,time:1415,open:7.22,high:7.22,low:7.22,price:7.21,vol:8600,amount:62090,avprice:7.213},{date:20230707,time:1416,open:7.22,high:7.22,low:7.22,price:7.21,vol:132200,amount:954669,avprice:7.213},{date:20230707,time:1417,open:7.22,high:7.21,low:7.22,price:7.21,vol:87900,amount:634466,avprice:7.213},{date:20230707,time:1418,open:7.22,high:7.22,low:7.22,price:7.21,vol:34700,amount:250223,avprice:7.213},{date:20230707,time:1419,open:7.22,high:7.22,low:7.22,price:7.21,vol:92700,amount:668380,avprice:7.213},{date:20230707,time:1420,open:7.21,high:7.21,low:7.22,price:7.21,vol:32600,amount:235105,avprice:7.213},{date:20230707,time:1421,open:7.21,high:7.22,low:7.22,price:7.21,vol:22100,amount:159350,avprice:7.213},{date:20230707,time:1422,open:7.22,high:7.22,low:7.22,price:7.21,vol:10500,amount:75745,avprice:7.213},{date:20230707,time:1423,open:7.22,high:7.22,low:7.22,price:7.22,vol:9500,amount:68590,avprice:7.213},{date:20230707,time:1424,open:7.22,high:7.22,low:7.22,price:7.21,vol:85200,amount:615143,avprice:7.213},{date:20230707,time:1425,open:7.22,high:7.22,low:7.22,price:7.21,vol:14800,amount:106851,avprice:7.213},{date:20230707,time:1426,open:7.22,high:7.22,low:7.23,price:7.21,vol:161100,amount:1162786,avprice:7.213},{date:20230707,time:1427,open:7.23,high:7.22,low:7.23,price:7.22,vol:28800,amount:207943,avprice:7.213},{date:20230707,time:1428,open:7.22,high:7.23,low:7.23,price:7.22,vol:18700,amount:135071,avprice:7.213},{date:20230707,time:1429,open:7.23,high:7.23,low:7.23,price:7.22,vol:7900,amount:57109,avprice:7.213},{date:20230707,time:1430,open:7.23,high:7.23,low:7.23,price:7.22,vol:20600,amount:148827,avprice:7.213},{date:20230707,time:1431,open:7.23,high:7.22,low:7.23,price:7.22,vol:11400,amount:82418,avprice:7.213},{date:20230707,time:1432,open:7.23,high:7.23,low:7.23,price:7.22,vol:43600,amount:315036,avprice:7.213},{date:20230707,time:1433,open:7.23,high:7.22,low:7.23,price:7.22,vol:34e3,amount:245603,avprice:7.213},{date:20230707,time:1434,open:7.23,high:7.23,low:7.23,price:7.22,vol:14300,amount:103384,avprice:7.213},{date:20230707,time:1435,open:7.23,high:7.22,low:7.23,price:7.22,vol:30900,amount:223375,avprice:7.213},{date:20230707,time:1436,open:7.23,high:7.23,low:7.23,price:7.23,vol:19300,amount:139538,avprice:7.213},{date:20230707,time:1437,open:7.23,high:7.23,low:7.23,price:7.23,vol:61600,amount:445359,avprice:7.213},{date:20230707,time:1438,open:7.23,high:7.23,low:7.23,price:7.23,vol:20800,amount:150384,avprice:7.213},{date:20230707,time:1439,open:7.23,high:7.23,low:7.23,price:7.22,vol:39100,amount:282481,avprice:7.213},{date:20230707,time:1440,open:7.23,high:7.22,low:7.23,price:7.22,vol:32800,amount:236945,avprice:7.213},{date:20230707,time:1441,open:7.23,high:7.22,low:7.23,price:7.22,vol:78200,amount:564782,avprice:7.213},{date:20230707,time:1442,open:7.22,high:7.23,low:7.23,price:7.22,vol:46600,amount:336706,avprice:7.213},{date:20230707,time:1443,open:7.22,high:7.22,low:7.23,price:7.22,vol:98100,amount:708461,avprice:7.214},{date:20230707,time:1444,open:7.22,high:7.21,low:7.23,price:7.21,vol:287900,amount:2078569,avprice:7.214},{date:20230707,time:1445,open:7.22,high:7.22,low:7.22,price:7.21,vol:36700,amount:264881,avprice:7.214},{date:20230707,time:1446,open:7.21,high:7.21,low:7.22,price:7.21,vol:22100,amount:159520,avprice:7.214},{date:20230707,time:1447,open:7.22,high:7.22,low:7.22,price:7.21,vol:63400,amount:457538,avprice:7.214},{date:20230707,time:1448,open:7.22,high:7.23,low:7.23,price:7.21,vol:67e3,amount:483977,avprice:7.214},{date:20230707,time:1449,open:7.22,high:7.22,low:7.23,price:7.22,vol:57600,amount:415923,avprice:7.214},{date:20230707,time:1450,open:7.22,high:7.21,low:7.23,price:7.21,vol:79300,amount:572599,avprice:7.214},{date:20230707,time:1451,open:7.21,high:7.22,low:7.22,price:7.21,vol:60800,amount:438804,avprice:7.214},{date:20230707,time:1452,open:7.22,high:7.22,low:7.22,price:7.21,vol:61900,amount:446809,avprice:7.214},{date:20230707,time:1453,open:7.21,high:7.22,low:7.22,price:7.21,vol:234400,amount:1690114,avprice:7.214},{date:20230707,time:1454,open:7.2,high:7.21,low:7.22,price:7.2,vol:64100,amount:462468,avprice:7.214},{date:20230707,time:1455,open:7.21,high:7.21,low:7.22,price:7.21,vol:128500,amount:926945,avprice:7.214},{date:20230707,time:1456,open:7.21,high:7.22,low:7.22,price:7.21,vol:141400,amount:1020555,avprice:7.214},{date:20230707,time:1457,open:7.21,high:7.21,low:7.23,price:7.21,vol:51900,amount:374693,avprice:7.214},{date:20230707,time:1458,open:7.21,high:7.21,low:7.21,price:7.21,vol:0,amount:0,avprice:7.214},{date:20230707,time:1459,open:7.21,high:7.21,low:7.21,price:7.21,vol:0,amount:0,avprice:7.214},{date:20230707,time:1500,open:7.22,high:7.22,low:7.22,price:7.22,vol:540100,amount:3899522,avprice:7.214}],name:"xxxxxx",yclose:7.21,date:20230707}],code:0},l={data:[[20230829,7.15,7.2,7.2,7.2,7.2,400400,2882880,925],[20230829,7.2,7.18,7.18,7.16,7.16,1034200,7416668,930],[20230829,7.16,7.16,7.18,7.16,7.18,460400,3301719,931],[20230829,7.18,7.18,7.18,7.15,7.17,546500,3915399,932],[20230829,7.17,7.17,7.17,7.15,7.16,570362,4083492,933],[20230829,7.16,7.15,7.17,7.15,7.17,179900,1288424,934],[20230829,7.17,7.16,7.17,7.15,7.16,375700,2690676,935],[20230829,7.16,7.16,7.17,7.14,7.15,421468,3015486,936],[20230829,7.15,7.16,7.16,7.14,7.15,270100,1931904,937],[20230829,7.15,7.16,7.16,7.14,7.15,270660,1934274,938],[20230829,7.15,7.15,7.15,7.12,7.13,759200,5409818,939],[20230829,7.13,7.13,7.15,7.13,7.14,379500,2709260,940],[20230829,7.14,7.14,7.16,7.14,7.16,257400,1840404,941],[20230829,7.16,7.15,7.15,7.13,7.15,239900,1714476,942],[20230829,7.15,7.15,7.16,7.14,7.16,420800,3011536,943],[20230829,7.16,7.15,7.16,7.14,7.15,550600,3935324,944],[20230829,7.15,7.15,7.15,7.12,7.14,367100,2619028,945],[20230829,7.14,7.14,7.15,7.12,7.14,707600,5050348,946],[20230829,7.14,7.13,7.14,7.12,7.14,303700,2166520,947],[20230829,7.14,7.14,7.14,7.12,7.13,242800,1730756,948],[20230829,7.13,7.13,7.13,7.11,7.12,324900,2314416,949],[20230829,7.12,7.13,7.13,7.11,7.12,816900,5808896,950],[20230829,7.12,7.11,7.13,7.1,7.12,347700,2473184,951],[20230829,7.12,7.12,7.12,7.11,7.11,168100,1196240,952],[20230829,7.11,7.12,7.13,7.11,7.12,280300,1995568,953],[20230829,7.12,7.12,7.13,7.11,7.12,217462,1547240,954],[20230829,7.12,7.12,7.12,7.11,7.11,343167,2441480,955],[20230829,7.11,7.11,7.11,7.1,7.11,187100,1329824,956],[20230829,7.11,7.11,7.11,7.1,7.11,124400,884440,957],[20230829,7.11,7.11,7.12,7.11,7.12,106172,755336,958],[20230829,7.12,7.12,7.12,7.1,7.11,121228,861760,959],[20230829,7.11,7.11,7.12,7.1,7.12,290900,2068984,1e3],[20230829,7.12,7.11,7.11,7.09,7.1,714800,5072976,1001],[20230829,7.1,7.09,7.1,7.09,7.1,189800,1346760,1002],[20230829,7.1,7.1,7.1,7.08,7.1,371700,2634968,1003],[20230829,7.1,7.09,7.09,7.08,7.08,132800,941384,1004],[20230829,7.08,7.09,7.09,7.08,7.09,276e3,1955488,1005],[20230829,7.09,7.08,7.08,7.07,7.07,955800,6762696,1006],[20230829,7.07,7.06,7.08,7.06,7.07,259118,1832832,1007],[20230829,7.07,7.08,7.08,7.07,7.08,180500,1277368,1008],[20230829,7.08,7.07,7.09,7.07,7.08,735e3,5203624,1009],[20230829,7.08,7.08,7.08,7.07,7.08,240800,1704016,1010],[20230829,7.08,7.07,7.09,7.07,7.09,178200,1261904,1011],[20230829,7.09,7.09,7.09,7.07,7.08,264800,1874400,1012],[20230829,7.08,7.09,7.09,7.07,7.08,200400,1417952,1013],[20230829,7.08,7.09,7.09,7.07,7.08,78300,554064,1014],[20230829,7.08,7.07,7.07,7.06,7.07,632500,4470280,1015],[20230829,7.07,7.07,7.07,7.06,7.07,111800,789968,1016],[20230829,7.07,7.07,7.07,7.06,7.07,97500,689120,1017],[20230829,7.07,7.07,7.07,7.06,7.07,226200,1599152,1018],[20230829,7.07,7.07,7.07,7.06,7.07,194400,1373632,1019],[20230829,7.07,7.07,7.07,7.06,7.07,121600,859648,1020],[20230829,7.07,7.07,7.07,7.06,7.06,109900,776856,1021],[20230829,7.06,7.07,7.07,7.06,7.07,535e3,3781704,1022],[20230829,7.07,7.08,7.08,7.07,7.07,135200,956016,1023],[20230829,7.07,7.07,7.07,7.06,7.07,767300,5417920,1024],[20230829,7.07,7.07,7.07,7.06,7.07,54500,385152,1025],[20230829,7.07,7.07,7.07,7.06,7.07,210700,1489456,1026],[20230829,7.07,7.06,7.08,7.06,7.06,133300,942464,1027],[20230829,7.06,7.07,7.08,7.06,7.07,215200,1521600,1028],[20230829,7.07,7.08,7.08,7.06,7.07,140400,992800,1029],[20230829,7.07,7.07,7.07,7.06,7.06,186900,1320256,1030],[20230829,7.06,7.07,7.07,7.06,7.07,146400,1034912,1031],[20230829,7.07,7.07,7.07,7.06,7.07,123600,873728,1032],[20230829,7.07,7.07,7.07,7.06,7.06,661500,467e4,1033],[20230829,7.06,7.06,7.06,7.05,7.05,514700,3628912,1034],[20230829,7.05,7.06,7.06,7.05,7.06,98900,697840,1035],[20230829,7.06,7.06,7.06,7.04,7.05,794100,5594240,1036],[20230829,7.05,7.04,7.05,7.03,7.05,384900,2708880,1037],[20230829,7.05,7.05,7.05,7.04,7.05,473200,3332960,1038],[20230829,7.05,7.05,7.06,7.04,7.05,379300,2670048,1039],[20230829,7.05,7.04,7.05,7.04,7.05,58500,411632,1040],[20230829,7.05,7.05,7.05,7.04,7.05,168400,1186752,1041],[20230829,7.05,7.06,7.06,7.05,7.06,258500,1823360,1042],[20230829,7.06,7.06,7.06,7.05,7.06,45800,323280,1043],[20230829,7.06,7.06,7.06,7.05,7.06,388800,2745472,1044],[20230829,7.06,7.06,7.07,7.05,7.06,373600,2637152,1045],[20230829,7.06,7.06,7.06,7.05,7.06,254400,1795520,1046],[20230829,7.06,7.06,7.06,7.05,7.05,14e4,987568,1047],[20230829,7.05,7.05,7.06,7.05,7.06,69800,492784,1048],[20230829,7.06,7.06,7.07,7.05,7.07,114400,807712,1049],[20230829,7.07,7.06,7.06,7.05,7.06,61400,433456,1050],[20230829,7.06,7.06,7.06,7.05,7.06,161100,1137088,1051],[20230829,7.06,7.06,7.07,7.05,7.06,190900,1347232,1052],[20230829,7.06,7.06,7.06,7.05,7.06,127100,896848,1053],[20230829,7.06,7.07,7.07,7.05,7.05,95900,676848,1054],[20230829,7.05,7.06,7.06,7.05,7.05,141900,1000832,1055],[20230829,7.05,7.05,7.06,7.05,7.05,63700,449712,1056],[20230829,7.05,7.06,7.06,7.05,7.06,155100,1094960,1057],[20230829,7.06,7.06,7.07,7.05,7.06,181600,1282256,1058],[20230829,7.06,7.06,7.07,7.06,7.07,208700,1474912,1059],[20230829,7.07,7.06,7.07,7.06,7.07,209800,1483088,1100],[20230829,7.07,7.06,7.07,7.05,7.06,286500,2023312,1101],[20230829,7.06,7.06,7.06,7.05,7.06,240300,1695200,1102],[20230829,7.06,7.07,7.07,7.06,7.07,83100,587088,1103],[20230829,7.07,7.07,7.07,7.06,7.07,157600,1113968,1104],[20230829,7.07,7.07,7.07,7.06,7.07,146100,1033008,1105],[20230829,7.07,7.07,7.07,7.06,7.07,269700,1904592,1106],[20230829,7.07,7.07,7.08,7.07,7.08,124100,878256,1107],[20230829,7.08,7.08,7.08,7.07,7.08,24300,172016,1108],[20230829,7.08,7.07,7.08,7.07,7.07,43600,308368,1109],[20230829,7.07,7.08,7.08,7.06,7.07,191900,1356752,1110],[20230829,7.07,7.06,7.08,7.06,7.06,159900,1130416,1111],[20230829,7.06,7.07,7.08,7.06,7.07,107200,758080,1112],[20230829,7.07,7.07,7.08,7.06,7.07,111500,788496,1113],[20230829,7.07,7.07,7.08,7.06,7.07,147500,1043744,1114],[20230829,7.07,7.07,7.08,7.07,7.07,61800,437312,1115],[20230829,7.07,7.08,7.08,7.07,7.07,223400,1579840,1116],[20230829,7.07,7.08,7.08,7.07,7.08,81400,576288,1117],[20230829,7.08,7.08,7.08,7.07,7.08,34500,244256,1118],[20230829,7.08,7.08,7.08,7.07,7.08,45e3,318560,1119],[20230829,7.08,7.08,7.09,7.08,7.08,357600,2532e3,1120],[20230829,7.08,7.08,7.08,7.07,7.08,139600,988176,1121],[20230829,7.08,7.08,7.08,7.07,7.08,46900,332048,1122],[20230829,7.08,7.08,7.08,7.07,7.08,120700,854544,1123],[20230829,7.08,7.08,7.08,7.07,7.08,65e3,460096,1124],[20230829,7.08,7.09,7.09,7.07,7.09,160100,1134016,1125],[20230829,7.09,7.09,7.1,7.08,7.09,211800,1501920,1126],[20230829,7.09,7.09,7.1,7.08,7.09,112100,794944,1127],[20230829,7.09,7.09,7.1,7.08,7.09,105015,744336,1128],[20230829,7.09,7.1,7.1,7.09,7.1,74500,528736,1129],[20230829,7.1,7.1,7.1,7.1,7.1,500,3536,1130],[20230829,7.1,7.1,7.1,7.07,7.08,912185,6469088,1300],[20230829,7.08,7.08,7.08,7.07,7.07,83200,588944,1301],[20230829,7.07,7.08,7.08,7.06,7.06,695300,4913776,1302],[20230829,7.06,7.06,7.07,7.06,7.07,30900,218432,1303],[20230829,7.07,7.06,7.07,7.05,7.07,339500,2397168,1304],[20230829,7.07,7.07,7.07,7.06,7.07,86200,609424,1305],[20230829,7.07,7.07,7.07,7.06,7.07,34700,245232,1306],[20230829,7.07,7.07,7.08,7.07,7.08,158500,1120720,1307],[20230829,7.08,7.08,7.09,7.07,7.08,493283,3492096,1308],[20230829,7.08,7.08,7.09,7.08,7.09,112217,794608,1309],[20230829,7.09,7.09,7.09,7.08,7.09,61600,436576,1310],[20230829,7.09,7.09,7.09,7.08,7.09,62900,445872,1311],[20230829,7.09,7.09,7.09,7.08,7.08,41100,291328,1312],[20230829,7.08,7.08,7.09,7.08,7.08,62e3,439504,1313],[20230829,7.08,7.09,7.09,7.08,7.09,80900,573360,1314],[20230829,7.09,7.08,7.09,7.07,7.07,276800,1960816,1315],[20230829,7.07,7.08,7.08,7.07,7.07,37600,266032,1316],[20230829,7.07,7.08,7.08,7.07,7.08,135100,955744,1317],[20230829,7.08,7.08,7.08,7.07,7.07,53700,380048,1318],[20230829,7.07,7.08,7.09,7.07,7.09,343300,2431072,1319],[20230829,7.09,7.08,7.08,7.07,7.07,46600,329792,1320],[20230829,7.07,7.08,7.08,7.07,7.08,157600,1115344,1321],[20230829,7.08,7.08,7.08,7.07,7.07,80500,569792,1322],[20230829,7.07,7.08,7.08,7.07,7.08,117300,830576,1323],[20230829,7.08,7.08,7.09,7.07,7.08,56e3,396480,1324],[20230829,7.08,7.08,7.08,7.07,7.08,62200,440336,1325],[20230829,7.08,7.08,7.08,7.07,7.08,135700,960816,1326],[20230829,7.08,7.08,7.09,7.07,7.09,108e3,764640,1327],[20230829,7.09,7.09,7.09,7.08,7.08,77500,548880,1328],[20230829,7.08,7.08,7.08,7.07,7.08,71200,504176,1329],[20230829,7.08,7.08,7.08,7.07,7.08,101500,718480,1330],[20230829,7.08,7.08,7.08,7.07,7.08,45e3,318496,1331],[20230829,7.08,7.07,7.08,7.07,7.07,140400,994e3,1332],[20230829,7.07,7.08,7.08,7.07,7.08,13800,97696,1333],[20230829,7.08,7.08,7.09,7.07,7.07,60900,431072,1334],[20230829,7.07,7.08,7.09,7.08,7.08,95900,679424,1335],[20230829,7.08,7.09,7.09,7.08,7.08,105200,745056,1336],[20230829,7.08,7.08,7.1,7.08,7.1,423277,3001056,1337],[20230829,7.1,7.09,7.1,7.09,7.09,54900,389472,1338],[20230829,7.09,7.1,7.1,7.09,7.1,73200,519552,1339],[20230829,7.1,7.1,7.1,7.09,7.09,522300,3705344,1340],[20230829,7.09,7.09,7.1,7.08,7.08,176600,1252320,1341],[20230829,7.08,7.08,7.09,7.08,7.09,95900,679680,1342],[20230829,7.09,7.09,7.09,7.08,7.08,147500,1045728,1343],[20230829,7.08,7.09,7.09,7.08,7.09,103700,735168,1344],[20230829,7.09,7.09,7.09,7.08,7.09,20800,147456,1345],[20230829,7.09,7.09,7.09,7.07,7.08,398500,2821152,1346],[20230829,7.08,7.07,7.08,7.07,7.08,86100,609408,1347],[20230829,7.08,7.08,7.09,7.07,7.08,227200,1608608,1348],[20230829,7.08,7.08,7.09,7.08,7.08,73800,523104,1349],[20230829,7.08,7.09,7.09,7.08,7.08,92100,652384,1350],[20230829,7.08,7.09,7.09,7.08,7.09,71e3,503264,1351],[20230829,7.09,7.08,7.1,7.08,7.09,80828,573024,1352],[20230829,7.09,7.09,7.09,7.08,7.08,45e3,319040,1353],[20230829,7.08,7.09,7.09,7.08,7.09,50800,360064,1354],[20230829,7.09,7.08,7.09,7.08,7.08,36200,256480,1355],[20230829,7.08,7.08,7.09,7.07,7.08,311700,2206784,1356],[20230829,7.08,7.08,7.09,7.07,7.09,58300,412800,1357],[20230829,7.09,7.09,7.09,7.08,7.08,22200,157248,1358],[20230829,7.08,7.08,7.09,7.07,7.08,113500,803648,1359],[20230829,7.08,7.08,7.08,7.07,7.08,117500,831840,1400],[20230829,7.08,7.08,7.08,7.07,7.08,15900,112544,1401],[20230829,7.08,7.08,7.08,7.08,7.08,54600,386432,1402],[20230829,7.08,7.08,7.09,7.07,7.08,220900,1563616,1403],[20230829,7.08,7.08,7.09,7.08,7.08,45900,325152,1404],[20230829,7.08,7.09,7.09,7.08,7.09,43600,309088,1405],[20230829,7.09,7.08,7.09,7.08,7.09,40700,288384,1406],[20230829,7.09,7.09,7.09,7.08,7.08,69600,493056,1407],[20230829,7.08,7.09,7.09,7.08,7.08,55600,393952,1408],[20230829,7.08,7.09,7.09,7.08,7.08,26200,185664,1409],[20230829,7.08,7.08,7.09,7.08,7.08,93542,663040,1410],[20230829,7.08,7.09,7.09,7.07,7.07,485258,3435552,1411],[20230829,7.07,7.07,7.08,7.07,7.07,21300,150688,1412],[20230829,7.07,7.08,7.08,7.07,7.07,58400,413184,1413],[20230829,7.07,7.08,7.08,7.07,7.07,25100,177568,1414],[20230829,7.07,7.08,7.08,7.07,7.07,41700,294976,1415],[20230829,7.07,7.07,7.08,7.07,7.07,56200,397568,1416],[20230829,7.07,7.08,7.08,7.08,7.08,219100,1550592,1417],[20230829,7.08,7.08,7.08,7.07,7.07,51100,361472,1418],[20230829,7.07,7.07,7.08,7.07,7.08,21e3,148576,1419],[20230829,7.08,7.07,7.08,7.07,7.08,64100,453408,1420],[20230829,7.08,7.08,7.08,7.07,7.08,61800,437376,1421],[20230829,7.08,7.08,7.08,7.07,7.08,110400,780704,1422],[20230829,7.08,7.08,7.08,7.07,7.08,15200,107552,1423],[20230829,7.08,7.08,7.08,7.07,7.07,18200,128736,1424],[20230829,7.07,7.08,7.08,7.07,7.08,61500,435008,1425],[20230829,7.08,7.08,7.08,7.07,7.07,40900,289376,1426],[20230829,7.07,7.07,7.08,7.07,7.07,11e3,77792,1427],[20230829,7.07,7.07,7.08,7.07,7.07,36600,258848,1428],[20230829,7.07,7.08,7.08,7.07,7.08,28e3,198112,1429],[20230829,7.08,7.07,7.08,7.07,7.07,107600,761568,1430],[20230829,7.07,7.07,7.08,7.07,7.07,89e3,629376,1431],[20230829,7.07,7.08,7.08,7.07,7.07,42100,297792,1432],[20230829,7.07,7.07,7.08,7.07,7.07,702900,4968352,1433],[20230829,7.07,7.06,7.07,7.06,7.06,28800,203392,1434],[20230829,7.06,7.06,7.07,7.06,7.07,86300,609952,1435],[20230829,7.07,7.07,7.07,7.07,7.07,127700,902528,1436],[20230829,7.07,7.07,7.07,7.06,7.06,37100,262240,1437],[20230829,7.06,7.06,7.07,7.06,7.06,75100,530592,1438],[20230829,7.06,7.06,7.08,7.06,7.07,263400,1861536,1439],[20230829,7.07,7.07,7.07,7.06,7.07,156700,1107360,1440],[20230829,7.07,7.07,7.07,7.06,7.07,79572,562496,1441],[20230829,7.07,7.06,7.07,7.06,7.07,144800,1023488,1442],[20230829,7.07,7.07,7.08,7.07,7.07,175500,1240576,1443],[20230829,7.07,7.07,7.07,7.06,7.07,66243,468256,1444],[20230829,7.07,7.06,7.08,7.06,7.08,626400,4429280,1445],[20230829,7.08,7.07,7.08,7.06,7.07,512100,3624032,1446],[20230829,7.07,7.07,7.08,7.06,7.07,86200,609216,1447],[20230829,7.07,7.07,7.07,7.06,7.07,63900,451712,1448],[20230829,7.07,7.07,7.07,7.06,7.06,84700,598528,1449],[20230829,7.06,7.06,7.07,7.06,7.07,369700,2614144,1450],[20230829,7.07,7.06,7.07,7.06,7.07,358443,2533152,1451],[20230829,7.07,7.07,7.07,7.06,7.06,229300,1620832,1452],[20230829,7.06,7.07,7.08,7.06,7.08,144468,1021440,1453],[20230829,7.08,7.07,7.08,7.07,7.07,140300,992448,1454],[20230829,7.07,7.07,7.08,7.07,7.08,413800,2928416,1455],[20230829,7.08,7.07,7.09,7.07,7.08,182800,1294080,1456],[20230829,7.08,7.09,7.09,7.09,7.09,0,0,1457],[20230829,7.09,7.09,7.09,7.09,7.09,0,0,1458],[20230829,7.09,7.09,7.09,7.09,7.09,0,0,1459],[20230829,7.09,7.07,7.07,7.07,7.07,1212692,8573760,1500]],symbol:"600000.sh",name:"xxxxxxx",version:"2.0",code:0};function u(){}u.Explain="本地测试数据",u.NetworkFilter=function(t,e){switch(console.log("[HQData::NetworkFilter] ".concat(u.Explain),t),t.Name){case"MinuteChartContainer::RequestMinuteData":u.RequestMinuteData(t,e);break;case"MinuteChartContainer::RequestHistoryMinuteData":u.RequestMinuteDaysData(t,e);break;case"MinuteChartContainer::RequestPopMinuteData":u.Minute_RequestPopMinuteData(t,e);break;case"KLineChartContainer::RequestHistoryData":u.RequestHistoryData(t,e);break;case"KLineChartContainer::RequestRealtimeData":u.RequestRealtimeData(t,e);break;case"KLineChartContainer::RequestFlowCapitalData":u.RequestFlowCapitalData(t,e);break;case"KLineChartContainer::ReqeustHistoryMinuteData":u.RequestHistoryMinuteData(t,e);break;case"KLineChartContainer::RequestMinuteRealtimeData":u.RequestMinuteRealtimeData(t,e);break;case"JSSymbolData::GetVariantData":u.RequestIndexVariantData(t,e);break}},u.RequestMinuteData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol[0],i=(t.Request.Data.daycount,t.Request.Data.callcation);console.log("[HQData::RequestMinuteData] Symbol=".concat(a));var r=JSON.parse(JSON.stringify(h)),n=r.stock[0];if(n.symbol=a,n.name=a,i.Before){for(var o=[[7.21,5e4,3e4,1,2e5],[7.21,55e3,4e4,1,8e4],[7.22,4e4,6e4,1,8e4],[7.22,3e4,21e3,2,44e3],[7.22,21e3,25e3,2,4e4],[7.21,36e3,55e3,2,6e4],[7.21,1e4,2e4,2,33e3],[7.2,4e4,6e4,1,8e4],[7.2,3e4,21e3,2,44e3]],s=new Date(parseInt(n.date/1e4),n.date/100%100-1,n.date%100,9,15,0),l=600,u=[],C=0,D=0;C<l;++C){var f=1e4*s.getHours()+100*s.getMinutes()+s.getSeconds(),c=D%o.length,m=o[c],d=[f,null,null,null,null,null];C%20!=0&&C!=l-1||(d=[f,m[0],m[1],m[2],m[3],1.5*(m[1]+m[2])],++D),u.push(d),s.setSeconds(s.getSeconds()+1)}var I={totalcount:l,ver:2};n.before=u,n.beforeinfo=I}if(i.After){var S=[[7.22,4e4,3e4,1,8e4],[7.22,55e3,6e4,1,15e4],[7.22,3e4,6e4,1,16e4],[7.22,35e3,21e3,2,5e4],[7.23,21e3,35e3,2,7e4],[7.23,26e3,55e3,2,1e5],[7.23,3e4,1e4,2,5e4],[7.23,21e3,35e3,2,7e4],[7.23,26e3,55e3,2,1e5],[7.23,3e4,1e4,2,5e4]],T=(s=new Date(parseInt(n.date/1e4),n.date/100%100-1,n.date%100,14,57,0),l=180,[]);for(C=0,D=0;C<l;++C){f=1e4*s.getHours()+100*s.getMinutes()+s.getSeconds(),c=D%S.length,m=S[c],d=[f,null,null,null,null,null];C%10!=0&&C!=l-1||(d=[f,m[0],m[1],m[2],m[3],1.5*(m[1]+m[2])],++D),T.push(d),s.setSeconds(s.getSeconds()+1)}var v={totalcount:l,ver:2};n.after=T,n.afterinfo=v}e(r)},u.Minute_RequestPopMinuteData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol[0],i=t.Request.Data.date;console.log("[HQData::RequestPopMinuteData] Symbol=".concat(a," Date=").concat(i));var r=JSON.parse(JSON.stringify(h)),n=r.stock[0];n.IsHistoryMinute=!0;for(var o=0;o<n.minute.length;++o){var s=n.minute[o];s.date=i}e(r)},u.RequestMinuteDaysData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol;t.Request.Data.daycount;console.log("[HQData::RequestMinuteDaysData] Symbol=".concat(a));var i=n;i.symbol=a,i.name=a,e(i)},u.RequestHistoryData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol,i=t.Request.Data.period;console.log("[HQData::RequestMinuteDaysData] Symbol=".concat(a," period=").concat(i));var r=JSON.parse(JSON.stringify(s));if(r.symbol=a,r.name=a,0==i){var n=r.data[r.data.length-5];n[66]={Type:1,BarColor:"rgb(255,185,0)",Line:{Color:"rgb(255,185,0)"}};n=r.data[r.data.length-11];n[66]={Type:1,BarColor:"rgb(255,185,0)",Line:{Color:"rgb(255,185,0)"}}}e(r)},u.RequestFlowCapitalData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol;console.log("[HQData::RequestFlowCapitalData] Symbol=".concat(a));var i=o;e(i)},u.RequestRealtimeData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol[0];console.log("[HQData::RequestRealtimeData] Symbol=".concat(a));var r=i;r.stock[0].name=a,r.stock[0].symbol=a,e(r)},u.RequestHistoryMinuteData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol;console.log("[HQData::RequestHistoryMinuteData] Symbol=".concat(a));var i=JSON.parse(JSON.stringify(l));i.name=a,i.symbol=a,e(i)},u.RequestMinuteRealtimeData=function(t,e){t.PreventDefault=!0;var a=t.Request.Data.symbol[0];console.log("[HQData::RequestMinuteRealtimeData] Symbol=".concat(a));var i=JSON.parse(JSON.stringify(r)),n=i.data[0],o=n[5],s=Math.ceil(10*Math.random())/1e3*o,h=Math.ceil(10*Math.random())>=5;h?o+=s:o-=s,n[5]=o,n[3]=Math.max(o,n[3]),n[4]=Math.min(o,n[4]),i.name=a,i.symbol=a,e(i)},u.RequestIndexVariantData=function(t,e){var a=t.Request.Data.VariantName;if("FROMOPEN"==a){var i={Data:{Date:20230707,Value:240},DataType:1};e(i)}};var C={HQData:u,KLINE_DAY_DATA:s};e.default=C},fa8b:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".DivHQChart[data-v-65c09f26]{background-color:#fff;width:100%}.DivFloatToolbar[data-v-65c09f26]{position:absolute;left:0;top:350px}.HQHistoryMinuteCtrlTooltip[data-v-65c09f26]{position:fixed;bottom:0;background-color:#fafafa;border-top:2px solid hsla(0,0%,50.2%,.5);background-clip:padding-box}.HistoryMinuteCloseIcon[data-v-65c09f26]{position:fixed;background-color:#fff;right:4px;bottom:258px;font-size:14px;color:#717171}.HistoryMiunteTooltipBtn[data-v-65c09f26]{display:flex;justify-content:space-around;height:30px}.changeDayBtn[data-v-65c09f26]{width:200px;text-align:center;color:#717171}",""]),t.exports=e}}]);